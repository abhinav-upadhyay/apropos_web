<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
VND(4)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">vnd</b> &#8212; <span class="desc">vnode disk driver</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">pseudo-device vnd</b> [<span class="opt"><i class="arg">count</i></span>]</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">vnd</b> driver provides a disk-like interface to a file. This is useful for a variety of applications, such as building miniroot or floppy disk images.<div class="spacer">
</div>
This document assumes familiarity with how to generate kernels and how to properly configure disks and pseudo-devices in a kernel configuration file.<div class="spacer">
</div>
In order to compile in support for <b class="name">vnd</b> devices, a line similar to the following must be present in the kernel configuration file:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
pseudo-device	vnd	4	# vnode disk driver</pre>
<div class="spacer">
</div>
The <i class="arg">count</i> argument is how many <b class="name">vnds</b> memory is allocated for at boot time. In this example, no more than 4 <b class="name">vnds</b> may be configured.<div class="spacer">
</div>
There is a run-time utility that is used for configuring <b class="name">vnds</b>. See <a class="link-man" href="../html8/vnconfig.html">vnconfig(8)</a> for more information.</div>
<div class="section">
<h1 id="x494f43544c20494e54455246414345">IOCTL INTERFACE</h1> The following <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> calls are defined in <b class="includes">&lt;<a class="link-includes">dev/vndioctl.h</a>&gt;</b>:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">VNDIOCSET</span> <i class="farg">struct vnd_ioctl *</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Associate the file <b class="var">vnd_file</b> with a <b class="name">vnd</b> pseudo device, optionally encrypted using the Blowfish cipher and the key specified in <b class="var">vnd_key</b> of length <b class="var">vnd_keylen</b>. The size of the configured device is returned in <b class="var">vnd_size</b>.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct vnd_ioctl { 
	char	*vnd_file; 
	off_t	vnd_size; 
	u_char	*vnd_key; 
	int	vnd_keylen; 
};</pre>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">VNDIOCCLR</span> <i class="farg">struct vnd_ioctl *</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disassociate a <b class="name">vnd</b> device.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">VNDIOCGET</span> <i class="farg">struct vnd_user *</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Get the associated file name, device, inode number, and unit number of a <b class="name">vnd</b> device. If <b class="var">vnu_unit</b> is -1, information on the <b class="name">vnd</b> device corresponding to the file descriptor passed to <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> will be returned. Otherwise, <b class="var">vnu_unit</b> may contain the unit number of another <b class="name">vnd</b> device. This allows for opening just <code class="lit">vnd0</code> and querying all available devices.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct vnd_user { 
	char	vnufile[VNDNLEN]; 
	int	vnu_unit; 
	dev_t	vnu_dev; 
	ino_t	vnu_ino; 
};</pre>
</dd>
</dl>
<div class="spacer">
</div>
Additionally, some <a class="link-man" href="../html8/disklabel.html">disklabel(8)</a> related <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> calls defined in <b class="includes">&lt;<a class="link-includes">sys/dkio.h</a>&gt;</b> are available: <span class="define">DIOCGDINFO</span>, <span class="define">DIOCSDINFO</span>, and <span class="define">DIOCWDINFO</span>. They are documented in <a class="link-man" href="../html4/sd.html">sd(4)</a>.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/{,r}vnd*</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
<b class="name">vnd</b> device special files</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a>, <a class="link-man" href="../html4/sd.html">sd(4)</a>, <a class="link-man" href="../html5/disklabel.html">disklabel(5)</a>, <a class="link-man" href="../html8/config.html">config(8)</a>, <a class="link-man" href="../html8/disklabel.html">disklabel(8)</a>, <a class="link-man" href="../html8/fdisk.html">fdisk(8)</a>, <a class="link-man" href="../html8/fsck.html">fsck(8)</a>, <a class="link-man" href="../html8/MAKEDEV.html">MAKEDEV(8)</a>, <a class="link-man" href="../html8/mount.html">mount(8)</a>, <a class="link-man" href="../html8/newfs.html">newfs(8)</a>, <a class="link-man" href="../html8/vnconfig.html">vnconfig(8)</a></div>
</div>
</body>
</html>

