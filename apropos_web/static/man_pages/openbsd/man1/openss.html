<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
OPENSSL(1)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">openssl</b> &#8212; <span class="desc">OpenSSL command line tool</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 7.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl</td>
<td>
<b class="flag">command</b> [<span class="opt"><i class="arg">command_opts</i></span>] [<span class="opt"><i class="arg">command_args</i></span>]</td>
</tr>
</tbody>
</table>
<div class="spacer">
</div>
<br/>
<table class="synopsis">
<col style="width: 7.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl</td>
<td>
<b class="flag">list-standard-commands</b> | <b class="flag">list-message-digest-commands</b> | <b class="flag">list-cipher-commands</b> | <b class="flag">list-cipher-algorithms</b> | <b class="flag">list-message-digest-algorithms</b> | <b class="flag">list-public-key-algorithms</b></td>
</tr>
</tbody>
</table>
<div class="spacer">
</div>
<br/>
<table class="synopsis">
<col style="width: 7.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl</td>
<td>
<b class="flag">no-</b><i class="arg">XXX</i> [<span class="opt"><i class="arg">arbitrary options</i></span>]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">OpenSSL</b> is a cryptography toolkit implementing the Transport Layer Security (TLS v1) network protocol, as well as related cryptography standards.<div class="spacer">
</div>
The <b class="name">openssl</b> program is a command line tool for using the various cryptography functions of <b class="name">OpenSSL</b><code class="lit">'s</code> <span class="emph">crypto</span> library from the shell. It can be used for<div class="spacer">
</div>
<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-bul">
<li class="list-bul" style="margin-top: 0.00em;">
Creation and management of private keys, public keys, and parameters</li>
<li class="list-bul" style="margin-top: 0.00em;">
Public key cryptographic operations</li>
<li class="list-bul" style="margin-top: 0.00em;">
Creation of X.509 certificates, CSRs and CRLs</li>
<li class="list-bul" style="margin-top: 0.00em;">
Calculation of Message Digests</li>
<li class="list-bul" style="margin-top: 0.00em;">
Encryption and Decryption with Ciphers</li>
<li class="list-bul" style="margin-top: 0.00em;">
SSL/TLS Client and Server Tests</li>
<li class="list-bul" style="margin-top: 0.00em;">
Handling of S/MIME signed or encrypted mail</li>
<li class="list-bul" style="margin-top: 0.00em;">
Time stamp requests, generation, and verification</li>
</ul>
</div>
<div class="section">
<h1 id="x434f4d4d414e442053554d4d415259">COMMAND SUMMARY</h1> The <b class="name">openssl</b> program provides a rich variety of commands (<b class="flag">command</b> in the <i class="link-sec"><a class="link-sec" href="#x53594e4f50534953">SYNOPSIS</a></i> above), each of which often has a wealth of options and arguments (<i class="arg">command_opts</i> and <i class="arg">command_args</i> in the <i class="link-sec"><a class="link-sec" href="#x53594e4f50534953">SYNOPSIS</a></i>).<div class="spacer">
</div>
The pseudo-commands <b class="flag">list-standard-commands</b>, <b class="flag">list-message-digest-commands</b>, and <b class="flag">list-cipher-commands</b> output a list (one entry per line) of the names of all standard commands, message digest commands, or cipher commands, respectively, that are available in the present <b class="name">openssl</b> utility.<div class="spacer">
</div>
The pseudo-commands <b class="flag">list-cipher-algorithms</b> and <b class="flag">list-message-digest-algorithms</b> list all cipher and message digest names, one entry per line. Aliases are listed as:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
from =&gt; to</div>
</blockquote>
<div class="spacer">
</div>
The pseudo-command <b class="flag">list-public-key-algorithms</b> lists all supported public key algorithms.<div class="spacer">
</div>
The pseudo-command <b class="flag">no-</b><i class="arg">XXX</i> tests whether a command of the specified name is available. If no command named <i class="arg">XXX</i> exists, it returns 0 (success) and prints <b class="flag">no-</b><i class="arg">XXX</i>; otherwise it returns 1 and prints <i class="arg">XXX</i>. In both cases, the output goes to <span class="emph">stdout</span> and nothing is printed to <span class="emph">stderr</span>. Additional command line arguments are always ignored. Since for each cipher there is a command of the same name, this provides an easy way for shell scripts to test for the availability of ciphers in the <b class="name">openssl</b> program.<div class="spacer">
</div>
<span class="symb">Note</span>: <b class="flag">no-</b><i class="arg">XXX</i> is not able to detect pseudo-commands such as <b class="flag">quit</b>, <b class="flag">list-</b><i class="arg">...</i><b class="flag">-commands</b>, or <b class="flag">no-</b><i class="arg">XXX</i> itself.</div>
<div class="section">
<h1 id="x5354414e4441524420434f4d4d414e4453">STANDARD COMMANDS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">asn1parse</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Parse an ASN.1 sequence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ca</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Certificate Authority (CA) management.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ciphers</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Cipher suite description determination.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">crl</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Certificate Revocation List (CRL) management.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">crl2pkcs7</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
CRL to PKCS#7 conversion.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">dgst</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Message digest calculation.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">dh</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Diffie-Hellman parameter management. Obsoleted by <b class="flag">dhparam</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">dhparam</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generation and management of Diffie-Hellman parameters. Superseded by <b class="flag">genpkey</b> and <b class="flag">pkeyparam</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">dsa</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
DSA data management.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">dsaparam</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
DSA parameter generation and management. Superseded by <b class="flag">genpkey</b> and <b class="flag">pkeyparam</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ec</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Elliptic curve (EC) key processing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ecparam</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
EC parameter manipulation and generation.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">enc</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Encoding with ciphers.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">errstr</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Error number to error string conversion.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">gendh</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generation of Diffie-Hellman parameters. Obsoleted by <b class="flag">dhparam</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">gendsa</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generation of DSA private key from parameters. Superseded by <b class="flag">genpkey</b> and <b class="flag">pkey</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">genpkey</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generation of private keys or parameters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">genrsa</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generation of RSA private key. Superseded by <b class="flag">genpkey</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">nseq</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Create or examine a Netscape certificate sequence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ocsp</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Online Certificate Status Protocol utility.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">passwd</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generation of hashed passwords.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">pkcs7</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
PKCS#7 data management.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">pkcs8</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
PKCS#8 data management.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">pkcs12</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
PKCS#12 data management.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">pkey</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Public and private key management.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">pkeyparam</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Public key algorithm parameter management.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">pkeyutl</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Public key algorithm cryptographic operation utility.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">prime</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generate prime numbers or test numbers for primality.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rand</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generate pseudo-random bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">req</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
PKCS#10 X.509 Certificate Signing Request (CSR) management.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rsa</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
RSA key management.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rsautl</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
RSA utility for signing, verification, encryption, and decryption. Superseded by <b class="flag">pkeyutl</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">s_client</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
This implements a generic SSL/TLS client which can establish a transparent connection to a remote server speaking SSL/TLS. It's intended for testing purposes only and provides only rudimentary interface functionality but internally uses mostly all functionality of the <b class="name">OpenSSL</b> <span class="emph">ssl</span> library.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">s_server</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
This implements a generic SSL/TLS server which accepts connections from remote clients speaking SSL/TLS. It's intended for testing purposes only and provides only rudimentary interface functionality but internally uses mostly all functionality of the <b class="name">OpenSSL</b> <span class="emph">ssl</span> library. It provides both an own command line oriented protocol for testing SSL functions and a simple HTTP response facility to emulate an SSL/TLS-aware webserver.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">s_time</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
SSL connection timer.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">sess_id</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
SSL session data management.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">smime</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
S/MIME mail processing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">speed</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Algorithm speed measurement.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">spkac</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
SPKAC printing and generating utility.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ts</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Time stamping authority tool (client/server).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">verify</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
X.509 certificate verification.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">version</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<b class="name">OpenSSL</b> version information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">x509</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
X.509 certificate data management.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4d4553534147452044494745535420434f4d4d414e4453">MESSAGE DIGEST COMMANDS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">gost-mac</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
GOST-MAC digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">streebog256</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Streebog-256 digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">streebog512</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Streebog-512 digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">md_gost94</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
GOST R 34.11-94 digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">md4</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
MD4 digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">md5</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
MD5 digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ripemd160</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
RIPEMD-160 digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">sha</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
SHA digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">sha1</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
SHA-1 digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">sha224</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
SHA-224 digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">sha256</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
SHA-256 digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">sha384</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
SHA-384 digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">sha512</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
SHA-512 digest.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">whirlpool</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Whirlpool digest.</dd>
</dl>
</div>
<div class="section">
<h1 id="x454e434f44494e4720414e442043495048455220434f4d4d414e4453">ENCODING AND CIPHER COMMANDS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">aes-128-cbc</b> | <b class="flag">aes-128-ecb</b> | <b class="flag">aes-192-cbc</b> | <b class="flag">aes-192-ecb</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">aes-256-cbc</b> | <b class="flag">aes-256-ecb</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
AES cipher.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">base64</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Base64 encoding.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">bf</b> | <b class="flag">bf-cbc</b> | <b class="flag">bf-cfb</b> | <b class="flag">bf-ecb</b> | <b class="flag">bf-ofb</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Blowfish cipher.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">cast</b> | <b class="flag">cast-cbc</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
CAST cipher.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">cast5-cbc</b> | <b class="flag">cast5-cfb</b> | <b class="flag">cast5-ecb</b> | <b class="flag">cast5-ofb</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
CAST5 cipher.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">des</b> | <b class="flag">des-cbc</b> | <b class="flag">des-cfb</b> | <b class="flag">des-ecb</b> | <b class="flag">des-ede</b> | <b class="flag">des-ede-cbc</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">des-ede-cfb</b> | <b class="flag">des-ede-ofb</b> | <b class="flag">des-ofb</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
DES cipher.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">des3</b> | <b class="flag">desx</b> | <b class="flag">des-ede3</b> | <b class="flag">des-ede3-cbc</b> | <b class="flag">des-ede3-cfb</b> | <b class="flag">des-ede3-ofb</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Triple DES cipher.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">rc2</b> | <b class="flag">rc2-40-cbc</b> | <b class="flag">rc2-64-cbc</b> | <b class="flag">rc2-cbc</b> | <b class="flag">rc2-cfb</b> | <b class="flag">rc2-ecb</b> | <b class="flag">rc2-ofb</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
RC2 cipher.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">rc4</b> | <b class="flag">rc4-40</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
RC4 cipher.</dd>
</dl>
</div>
<div class="section">
<h1 id="x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</h1> Several commands accept password arguments, typically using <b class="flag">-passin</b> and <b class="flag">-passout</b> for input and output passwords, respectively. These allow the password to be obtained from a variety of sources. Both of these options take a single argument whose format is described below. If no password argument is given and a password is required, then the user is prompted to enter one: this will typically be read from the current terminal with echoing turned off.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">pass</i>:<i class="arg">password</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
The actual password is <i class="arg">password</i>. Since the password is visible to utilities (like <a class="link-man" href="../html1/ps.html">ps(1)</a> under <span class="unix">UNIX</span>) this form should only be used where security is not important.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">env</i>:<i class="arg">var</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Obtain the password from the environment variable <i class="arg">var</i>. Since the environment of other processes is visible on certain platforms (e.g. <a class="link-man" href="../html1/ps.html">ps(1)</a> under certain <span class="unix">UNIX</span> OSes) this option should be used with caution.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">file</i>:<i class="arg">path</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
The first line of <i class="arg">path</i> is the password. If the same <i class="arg">path</i> argument is supplied to <b class="flag">-passin</b> and <b class="flag">-passout</b>, then the first line will be used for the input password and the next line for the output password. <i class="arg">path</i> need not refer to a regular file: it could, for example, refer to a device or named pipe.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">fd</i>:<i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Read the password from the file descriptor <i class="arg">number</i>. This can be used to send the data via a pipe for example.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">stdin</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Read the password from standard input.</dd>
</dl>
</div>
<div class="section">
<h1 id="x41534e315041525345">ASN1PARSE</h1><table class="synopsis">
<col style="width: 129.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl asn1parse</td>
<td>
[<span class="opt"><b class="flag">-i</b></span>] [<span class="opt"><b class="flag">-dlimit</b>&#160;<i class="arg">number</i></span>] [<span class="opt"><b class="flag">-dump</b></span>] [<span class="opt"><b class="flag">-genconf</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-genstr</b>&#160;<i class="arg">str</i></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i>&#160;|&#160;<i class="arg">TXT</i></span>] [<span class="opt"><b class="flag">-length</b>&#160;<i class="arg">number</i></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-offset</b>&#160;<i class="arg">number</i></span>] [<span class="opt"><b class="flag">-oid</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-strparse</b>&#160;<i class="arg">offset</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">asn1parse</b> command is a diagnostic utility that can parse ASN.1 structures. It can also be used to extract data from ASN.1 formatted data.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-dlimit</b> <i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Dump the first <i class="arg">number</i> bytes of unknown data in hex form.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-dump</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Dump unknown data in hex form.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-genconf</b> <i class="arg">file</i>, <b class="flag">-genstr</b> <i class="arg">str</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate encoded data based on string <i class="arg">str</i>, file <i class="arg">file</i>, or both using <a class="link-man" href="../html3/ASN1_generate_nconf.html">ASN1_generate_nconf(3)</a> format. If only <i class="arg">file</i> is present then the string is obtained from the default section using the name &#8220;asn1&#8221;. The encoded data is passed through the ASN1 parser and printed out as though it came from a file; the contents can thus be examined and written to a file using the <b class="flag">-out</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-i</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Indents the output according to the &#8220;depth&#8221; of the structures.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The input file; default is standard input.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i> | <i class="arg">TXT</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The input format. <i class="arg">DER</i> (Distinguished Encoding Rules) is binary format and <i class="arg">PEM</i> (Privacy Enhanced Mail), the default, is base64-encoded. <i class="arg">TXT</i> is plain text.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-length</b> <i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Number of bytes to parse; default is until end of file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't output the parsed version of the input file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-offset</b> <i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Starting offset to begin parsing; default is start of file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-oid</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A file containing additional object identifiers (OIDs). The format of this file is described in the <i class="link-sec"><a class="link-sec" href="#x41534e315041525345204e4f544553">ASN1PARSE NOTES</a></i> section below.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Output file to place the DER-encoded data into. If this option is not present, no encoded data will be output. This is most useful when combined with the <b class="flag">-strparse</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-strparse</b> <i class="arg">offset</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Parse the content octets of the ASN.1 object starting at <i class="arg">offset</i>. This option can be used multiple times to &#8220;drill down&#8221; into a nested structure.</dd>
</dl>
</div>
<div class="section">
<h1 id="x41534e315041525345204f5554505554">ASN1PARSE OUTPUT</h1> The output will typically contain lines like this:<div class="spacer">
</div>
<pre style="margin-left: 2.00ex;" class="lit display">
0:d=0  hl=4 l= 681 cons: SEQUENCE 
 
..... 
 
229:d=3  hl=3 l= 141 prim: BIT STRING 
373:d=2  hl=3 l= 162 cons: cont [ 3 ] 
376:d=3  hl=3 l= 159 cons: SEQUENCE 
379:d=4  hl=2 l=  29 cons: SEQUENCE 
381:d=5  hl=2 l=   3 prim: OBJECT        :X509v3 Subject Key Identifier 
386:d=5  hl=2 l=  22 prim: OCTET STRING 
410:d=4  hl=2 l= 112 cons: SEQUENCE 
412:d=5  hl=2 l=   3 prim: OBJECT        :X509v3 Authority Key Identifier 
417:d=5  hl=2 l= 105 prim: OCTET STRING 
524:d=4  hl=2 l=  12 cons: SEQUENCE 
 
.....</pre>
<div class="spacer">
</div>
This example is part of a self-signed certificate. Each line starts with the offset in decimal. <b class="flag">d=XX</b> specifies the current depth. The depth is increased within the scope of any SET or SEQUENCE. <b class="flag">hl=XX</b> gives the header length (tag and length octets) of the current type. <b class="flag">l=XX</b> gives the length of the content octets.<div class="spacer">
</div>
The <b class="flag">-i</b> option can be used to make the output more readable.<div class="spacer">
</div>
Some knowledge of the ASN.1 structure is needed to interpret the output.<div class="spacer">
</div>
In this example, the BIT STRING at offset 229 is the certificate public key. The content octets of this will contain the public key information. This can be examined using the option <b class="flag">-strparse</b> <b class="flag">229</b> to yield:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
    0:d=0  hl=3 l= 137 cons: SEQUENCE 
    3:d=1  hl=3 l= 129 prim: INTEGER           :E5D21E1F5C8D208EA7A2166C7FA 
F9F6BDF2059669C60876DDB70840F1A5AAFA59699FE471F379F1DD6A487E7D5409AB6A88D4A 
9746E24B91D8CF55DB3521015460C8EDE44EE8A4189F7A7BE77D6CD3A9AF2696F486855CF58 
BF0EDF2B4068058C7A947F52548DDF7E15E96B385F86422BEA9064A3EE9 
  135:d=1  hl=2 l=   3 prim: INTEGER           :010001</pre>
</div>
<div class="section">
<h1 id="x41534e315041525345204e4f544553">ASN1PARSE NOTES</h1> If an OID (object identifier) is not part of <b class="name">OpenSSL</b><code class="lit">'s</code> internal table it will be represented in numerical form (for example 1.2.3.4). The file passed to the <b class="flag">-oid</b> option allows additional OIDs to be included. Each line consists of three columns: the first column is the OID in numerical format and should be followed by whitespace. The second column is the &#8220;short name&#8221; which is a single word followed by whitespace. The final column is the rest of the line and is the &#8220;long name&#8221;. <b class="name">asn1parse</b> displays the long name. Example:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">&quot;1.2.3.4	shortname	A long name&quot;</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x41534e31204558414d504c4553">ASN1 EXAMPLES</h1> Parse a file:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl asn1parse -in file.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Parse a DER file:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl asn1parse -inform DER -in file.der</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x41534e3150415253452042554753">ASN1PARSE BUGS</h1> There should be options to change the format of output lines. The output of some ASN.1 types is not well handled (if at all).</div>
<div class="section">
<h1 id="x4341">CA</h1><table class="synopsis">
<col style="width: 196.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl ca</td>
<td>
[<span class="opt"><b class="flag">-batch</b></span>] [<span class="opt"><b class="flag">-cert</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-config</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-crl_CA_compromise</b>&#160;<i class="arg">time</i></span>] [<span class="opt"><b class="flag">-crl_compromise</b>&#160;<i class="arg">time</i></span>] [<span class="opt"><b class="flag">-crl_hold</b>&#160;<i class="arg">instruction</i></span>] [<span class="opt"><b class="flag">-crl_reason</b>&#160;<i class="arg">reason</i></span>] [<span class="opt"><b class="flag">-crldays</b>&#160;<i class="arg">days</i></span>] [<span class="opt"><b class="flag">-crlexts</b>&#160;<i class="arg">section</i></span>] [<span class="opt"><b class="flag">-crlhours</b>&#160;<i class="arg">hours</i></span>] [<span class="opt"><b class="flag">-days</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-enddate</b>&#160;<i class="arg">date</i></span>] [<span class="opt"><b class="flag">-extensions</b>&#160;<i class="arg">section</i></span>] [<span class="opt"><b class="flag">-extfile</b>&#160;<i class="arg">section</i></span>] [<span class="opt"><b class="flag">-gencrl</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-infiles</b></span>] [<span class="opt"><b class="flag">-key</b>&#160;<i class="arg">keyfile</i></span>] [<span class="opt"><b class="flag">-keyfile</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-keyform</b>&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-md</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-msie_hack</b></span>] [<span class="opt"><b class="flag">-name</b>&#160;<i class="arg">section</i></span>] [<span class="opt"><b class="flag">-noemailDN</b></span>] [<span class="opt"><b class="flag">-notext</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outdir</b>&#160;<i class="arg">dir</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-policy</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-preserveDN</b></span>] [<span class="opt"><b class="flag">-revoke</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-spkac</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-ss_cert</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-startdate</b>&#160;<i class="arg">date</i></span>] [<span class="opt"><b class="flag">-status</b>&#160;<i class="arg">serial</i></span>] [<span class="opt"><b class="flag">-subj</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-updatedb</b></span>] [<span class="opt"><b class="flag">-verbose</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">ca</b> command is a minimal CA application. It can be used to sign certificate requests in a variety of forms and generate CRLs. It also maintains a text database of issued certificates and their status.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options descriptions will be divided into each purpose.</div>
<div class="section">
<h1 id="x4341204f5054494f4e53">CA OPTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-batch</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This sets the batch mode. In this mode no questions will be asked and all certificates will be certified automatically.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-cert</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The CA certificate file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-config</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specifies the configuration file to use.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-days</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The number of days to certify the certificate for.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-enddate</b> <i class="arg">date</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This allows the expiry date to be explicitly set. The format of the date is YYMMDDHHMMSSZ (the same as an ASN1 UTCTime structure).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-extensions</b> <i class="arg">section</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The section of the configuration file containing certificate extensions to be added when a certificate is issued (defaults to <span class="emph">x509_extensions</span> unless the <b class="flag">-extfile</b> option is used). If no extension section is present, a V1 certificate is created. If the extension section is present (even if it is empty), then a V3 certificate is created.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-extfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
An additional configuration <i class="arg">file</i> to read certificate extensions from (using the default section unless the <b class="flag">-extensions</b> option is also used).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
An input <i class="arg">file</i> containing a single certificate request to be signed by the CA.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-infiles</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
If present, this should be the last option; all subsequent arguments are assumed to be the names of files containing certificate requests.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-key</b> <i class="arg">keyfile</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The password used to encrypt the private key. Since on some systems the command line arguments are visible (e.g. <span class="unix">UNIX</span> with the <a class="link-man" href="../html1/ps.html">ps(1)</a> utility) this option should be used with caution.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-keyfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The private key to sign requests with.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-keyform</b> <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Private key file format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-md</b> <i class="arg">alg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The message digest to use. Possible values include <i class="arg">md5</i> and <i class="arg">sha1</i>. This option also applies to CRLs.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-msie_hack</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This is a legacy option to make <b class="name">ca</b> work with very old versions of the IE certificate enrollment control &#8220;certenr3&#8221;. It used UniversalStrings for almost everything. Since the old control has various security bugs, its use is strongly discouraged. The newer control &#8220;Xenroll&#8221; does not need this option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-name</b> <i class="arg">section</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specifies the configuration file <i class="arg">section</i> to use (overrides <b class="flag">default_ca</b> in the <b class="flag">ca</b> section).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noemailDN</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The DN of a certificate can contain the EMAIL field if present in the request DN, however it is good policy just having the email set into the <span class="emph">altName</span> extension of the certificate. When this option is set, the EMAIL field is removed from the certificate's subject and set only in the, eventually present, extensions. The <i class="arg">email_in_dn</i> keyword can be used in the configuration file to enable this behaviour.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-notext</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't output the text form of a certificate to the output file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The output file to output certificates to. The default is standard output. The certificate details will also be printed out to this file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outdir</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The <i class="arg">directory</i> to output certificates to. The certificate will be written to a file consisting of the serial number in hex with &#8220;.pem&#8221; appended.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-policy</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option defines the CA &#8220;policy&#8221; to use. This is a section in the configuration file which decides which fields should be mandatory or match the CA certificate. Check out the <i class="link-sec"><a class="link-sec" href="#x434120504f4c49435920464f524d4154">CA POLICY FORMAT</a></i> section for more information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-preserveDN</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Normally, the DN order of a certificate is the same as the order of the fields in the relevant policy section. When this option is set, the order is the same as the request. This is largely for compatibility with the older IE enrollment control which would only accept certificates if their DNs matched the order of the request. This is not needed for Xenroll.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-spkac</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A file containing a single Netscape signed public key and challenge, and additional field values to be signed by the CA. See the <i class="link-sec"><a class="link-sec" href="#x53504b414320464f524d4154">SPKAC FORMAT</a></i> section for information on the required format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-ss_cert</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A single self-signed certificate to be signed by the CA.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-startdate</b> <i class="arg">date</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This allows the start date to be explicitly set. The format of the date is YYMMDDHHMMSSZ (the same as an ASN1 UTCTime structure).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-status</b> <i class="arg">serial</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Show status of certificate with serial number <i class="arg">serial</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-updatedb</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Update database for expired certificates.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verbose</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This prints extra details about the operations being performed.</dd>
</dl>
</div>
<div class="section">
<h1 id="x43524c204f5054494f4e53">CRL OPTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crl_CA_compromise</b> <i class="arg">time</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This is the same as <b class="flag">-crl_compromise</b>, except the revocation reason is set to CACompromise.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crl_compromise</b> <i class="arg">time</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This sets the revocation reason to keyCompromise and the compromise time to <i class="arg">time</i>. <i class="arg">time</i> should be in GeneralizedTime format, i.e. YYYYMMDDHHMMSSZ.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crl_hold</b> <i class="arg">instruction</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This sets the CRL revocation reason code to certificateHold and the hold instruction to <i class="arg">instruction</i> which must be an OID. Although any OID can be used, only holdInstructionNone (the use of which is discouraged by RFC 2459), holdInstructionCallIssuer or holdInstructionReject will normally be used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crl_reason</b> <i class="arg">reason</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Revocation reason, where <i class="arg">reason</i> is one of: unspecified, keyCompromise, CACompromise, affiliationChanged, superseded, cessationOfOperation, certificateHold or removeFromCRL. The matching of <i class="arg">reason</i> is case insensitive. Setting any revocation reason will make the CRL v2. In practice, removeFromCRL is not particularly useful because it is only used in delta CRLs which are not currently implemented.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crldays</b> <i class="arg">num</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The number of days before the next CRL is due. This is the days from now to place in the CRL <span class="emph">nextUpdate</span> field.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crlexts</b> <i class="arg">section</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The <i class="arg">section</i> of the configuration file containing CRL extensions to include. If no CRL extension section is present then a V1 CRL is created; if the CRL extension section is present (even if it is empty) then a V2 CRL is created. The CRL extensions specified are CRL extensions and <span class="emph">not</span> CRL entry extensions. It should be noted that some software (for example Netscape) can't handle V2 CRLs.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crlhours</b> <i class="arg">num</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The number of hours before the next CRL is due.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-gencrl</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option generates a CRL based on information in the index file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-revoke</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A <i class="arg">file</i> containing a certificate to revoke.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-subj</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Supersedes the subject name given in the request. The <i class="arg">arg</i> must be formatted as <i class="arg">/type0=value0/type1=value1/type2=...</i>; characters may be escaped by &#8216;\&#8217; (backslash), no spaces are skipped.</dd>
</dl>
</div>
<div class="section">
<h1 id="x434120434f4e46494755524154494f4e2046494c45204f5054494f4e53">CA CONFIGURATION FILE OPTIONS</h1> The section of the configuration file containing options for <b class="name">ca</b> is found as follows: If the <b class="flag">-name</b> command line option is used, then it names the section to be used. Otherwise the section to be used must be named in the <span class="emph">default_ca</span> option of the <span class="emph">ca</span> section of the configuration file (or in the default section of the configuration file). Besides <span class="emph">default_ca</span>, the following options are read directly from the <span class="emph">ca</span> section:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
preserve</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
msie_hack</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
</dl>
<div class="spacer">
</div>
This is probably a bug and may change in future releases.<div class="spacer">
</div>
Many of the configuration file options are identical to command line options. Where the option is present in the configuration file and the command line, the command line value is used. Where an option is described as mandatory, then it must be present in the configuration file or the command line equivalent (if any) used.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">certificate</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as <b class="flag">-cert</b>. It gives the file containing the CA certificate. Mandatory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">copy_extensions</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Determines how extensions in certificate requests should be handled. If set to <i class="arg">none</i> or this option is not present, then extensions are ignored and not copied to the certificate. If set to <i class="arg">copy</i>, then any extensions present in the request that are not already present are copied to the certificate. If set to <i class="arg">copyall</i>, then all extensions in the request are copied to the certificate: if the extension is already present in the certificate it is deleted first. See the <i class="link-sec"><a class="link-sec" href="#x4341205741524e494e4753">CA WARNINGS</a></i> section before using this option.<div class="spacer">
</div>
The main use of this option is to allow a certificate request to supply values for certain extensions such as <span class="emph">subjectAltName</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">crl_extensions</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as <b class="flag">-crlexts</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">crlnumber</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A text file containing the next CRL number to use in hex. The CRL number will be inserted in the CRLs only if this file exists. If this file is present, it must contain a valid CRL number.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">database</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The text database file to use. Mandatory. This file must be present, though initially it will be empty.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">default_crl_hours</i>, <i class="arg">default_crl_days</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as the <b class="flag">-crlhours</b> and <b class="flag">-crldays</b> options. These will only be used if neither command line option is present. At least one of these must be present to generate a CRL.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">default_days</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as the <b class="flag">-days</b> option. The number of days to certify a certificate for.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">default_enddate</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as the <b class="flag">-enddate</b> option. Either this option or <i class="arg">default_days</i> (or the command line equivalents) must be present.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">default_md</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as the <b class="flag">-md</b> option. The message digest to use. Mandatory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">default_startdate</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as the <b class="flag">-startdate</b> option. The start date to certify a certificate for. If not set, the current time is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">email_in_dn</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as <b class="flag">-noemailDN</b>. If the EMAIL field is to be removed from the DN of the certificate, simply set this to &#8220;no&#8221;. If not present, the default is to allow for the EMAIL field in the certificate's DN.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">msie_hack</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as <b class="flag">-msie_hack</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">name_opt</i>, <i class="arg">cert_opt</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
These options allow the format used to display the certificate details when asking the user to confirm signing. All the options supported by the <b class="name">x509</b> utilities' <b class="flag">-nameopt</b> and <b class="flag">-certopt</b> switches can be used here, except that <i class="arg">no_signame</i> and <i class="arg">no_sigdump</i> are permanently set and cannot be disabled (this is because the certificate signature cannot be displayed because the certificate has not been signed at this point).<div class="spacer">
</div>
For convenience, the value <span class="emph">ca_default</span> is accepted by both to produce a reasonable output.<div class="spacer">
</div>
If neither option is present, the format used in earlier versions of <b class="name">OpenSSL</b> is used. Use of the old format is <span class="emph">strongly</span> discouraged because it only displays fields mentioned in the <i class="arg">policy</i> section, mishandles multicharacter string types and does not display extensions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">new_certs_dir</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as the <b class="flag">-outdir</b> command line option. It specifies the directory where new certificates will be placed. Mandatory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">oid_file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies a file containing additional object identifiers. Each line of the file should consist of the numerical form of the object identifier followed by whitespace, then the short name followed by whitespace and finally the long name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">oid_section</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies a section in the configuration file containing extra object identifiers. Each line should consist of the short name of the object identifier followed by &#8216;=&#8217; and the numerical form. The short and long names are the same when this option is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">policy</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as <b class="flag">-policy</b>. Mandatory. See the <i class="link-sec"><a class="link-sec" href="#x434120504f4c49435920464f524d4154">CA POLICY FORMAT</a></i> section for more information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">preserve</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as <b class="flag">-preserveDN</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">private_key</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Same as the <b class="flag">-keyfile</b> option. The file containing the CA private key. Mandatory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">serial</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A text file containing the next serial number to use in hex. Mandatory. This file must be present and contain a valid serial number.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">unique_subject</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
If the value <i class="arg">yes</i> is given, the valid certificate entries in the database must have unique subjects. If the value <i class="arg">no</i> is given, several valid certificate entries may have the exact same subject. The default value is <i class="arg">yes</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">x509_extensions</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as <b class="flag">-extensions</b>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x434120504f4c49435920464f524d4154">CA POLICY FORMAT</h1> The policy section consists of a set of variables corresponding to certificate DN fields. If the value is &#8220;match&#8221;, then the field value must match the same field in the CA certificate. If the value is &#8220;supplied&#8221;, then it must be present. If the value is &#8220;optional&#8221;, then it may be present. Any fields not mentioned in the policy section are silently deleted, unless the <b class="flag">-preserveDN</b> option is set, but this can be regarded more of a quirk than intended behaviour.</div>
<div class="section">
<h1 id="x53504b414320464f524d4154">SPKAC FORMAT</h1> The input to the <b class="flag">-spkac</b> command line option is a Netscape signed public key and challenge. This will usually come from the <span class="emph">KEYGEN</span> tag in an HTML form to create a new private key. It is, however, possible to create SPKACs using the <b class="name">spkac</b> utility.<div class="spacer">
</div>
The file should contain the variable SPKAC set to the value of the SPKAC and also the required DN components as name value pairs. If it's necessary to include the same component twice, then it can be preceded by a number and a &#8216;.&#8217;.</div>
<div class="section">
<h1 id="x4341204558414d504c4553">CA EXAMPLES</h1> <span class="symb">Note</span>: these examples assume that the <b class="name">ca</b> directory structure is already set up and the relevant files already exist. This usually involves creating a CA certificate and private key with <b class="flag">req</b>, a serial number file and an empty index file and placing them in the relevant directories.<div class="spacer">
</div>
To use the sample configuration file below, the directories <i class="file">demoCA</i>, <i class="file">demoCA/private</i> and <i class="file">demoCA/newcerts</i> would be created. The CA certificate would be copied to <i class="file">demoCA/cacert.pem</i> and its private key to <i class="file">demoCA/private/cakey.pem</i>. A file <i class="file">demoCA/serial</i> would be created containing, for example, &#8220;01&#8221; and the empty index file <i class="file">demoCA/index.txt</i>.<div class="spacer">
</div>
Sign a certificate request:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl ca -in req.pem -out newcert.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Sign a certificate request, using CA extensions:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl ca -in req.pem -extensions v3_ca -out newcert.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Generate a CRL:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl ca -gencrl -out crl.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Sign several requests:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl ca -infiles req1.pem req2.pem req3.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Certify a Netscape SPKAC:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl ca -spkac spkac.txt</code></div>
</blockquote>
<div class="spacer">
</div>
A sample SPKAC file (the SPKAC line has been truncated for clarity):<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
SPKAC=MIG0MGAwXDANBgkqhkiG9w0BAQEFAANLADBIAkEAn7PDhCeV/xIxUg8V70YRxK 
CN=Steve Test 
emailAddress=steve@openssl.org 
0.OU=OpenSSL Group 
1.OU=Another Group</pre>
<div class="spacer">
</div>
A sample configuration file with the relevant sections for <b class="name">ca</b>:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
 [ ca ] 
 default_ca      = CA_default            # The default ca section 
 
 [ CA_default ] 
 
 dir            = ./demoCA              # top dir 
 database       = $dir/index.txt        # index file 
 new_certs_dir  = $dir/newcerts         # new certs dir 
 
 certificate    = $dir/cacert.pem       # The CA cert 
 serial         = $dir/serial           # serial no file 
 private_key    = $dir/private/cakey.pem# CA private key 
 
 default_days   = 365                   # how long to certify for 
 default_crl_days= 30                   # how long before next CRL 
 default_md     = md5                   # md to use 
 
 policy         = policy_any            # default policy 
 email_in_dn    = no                    # Don't add the email into cert DN 
 
 name_opt        = ca_default           # Subject name display option 
 cert_opt        = ca_default           # Certificate display option 
 copy_extensions = none                 #Don't copy extensions from request 
 
 [ policy_any ] 
 countryName            = supplied 
 stateOrProvinceName    = optional 
 organizationName       = optional 
 organizationalUnitName = optional 
 commonName             = supplied 
 emailAddress           = optional</pre>
</div>
<div class="section">
<h1 id="x43412046494c4553">CA FILES</h1> <span class="symb">Note</span>: the location of all files can change either by compile time options, configuration file entries, environment variables, or command line options. The values below reflect the default values.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
/etc/ssl/openssl.cnf           - master configuration file 
./demoCA                       - main CA directory 
./demoCA/cacert.pem            - CA certificate 
./demoCA/private/cakey.pem     - CA private key 
./demoCA/serial                - CA serial number file 
./demoCA/serial.old            - CA serial number backup file 
./demoCA/index.txt             - CA text database file 
./demoCA/index.txt.old         - CA text database backup file 
./demoCA/certs                 - certificate output file</pre>
</div>
<div class="section">
<h1 id="x434120454e5649524f4e4d454e54205641524941424c4553">CA ENVIRONMENT VARIABLES</h1> <span class="env">OPENSSL_CONF</span> reflects the location of the master configuration file; it can be overridden by the <b class="flag">-config</b> command line option.</div>
<div class="section">
<h1 id="x4341205245535452494354494f4e53">CA RESTRICTIONS</h1> The text database index file is a critical part of the process, and if corrupted it can be difficult to fix. It is theoretically possible to rebuild the index file from all the issued certificates and a current CRL; however there is no option to do this.<div class="spacer">
</div>
V2 CRL features like delta CRLs are not currently supported.<div class="spacer">
</div>
Although several requests can be input and handled at once, it is only possible to include one SPKAC or self-signed certificate.</div>
<div class="section">
<h1 id="x43412042554753">CA BUGS</h1> The use of an in-memory text database can cause problems when large numbers of certificates are present because, as the name implies, the database has to be kept in memory.<div class="spacer">
</div>
It is not possible to certify two certificates with the same DN; this is a side effect of how the text database is indexed and it cannot easily be fixed without introducing other problems. Some S/MIME clients can use two certificates with the same DN for separate signing and encryption keys.<div class="spacer">
</div>
The <b class="name">ca</b> command really needs rewriting or the required functionality exposed at either a command or interface level so a more friendly utility (perl script or GUI) can handle things properly.<div class="spacer">
</div>
Any fields in a request that are not present in a policy are silently deleted. This does not happen if the <b class="flag">-preserveDN</b> option is used. To enforce the absence of the EMAIL field within the DN, as suggested by RFCs, regardless of the contents of the request's subject the <b class="flag">-noemailDN</b> option can be used. The behaviour should be more friendly and configurable.<div class="spacer">
</div>
Cancelling some commands by refusing to certify a certificate can create an empty file.</div>
<div class="section">
<h1 id="x4341205741524e494e4753">CA WARNINGS</h1> The <b class="name">ca</b> command is quirky and at times downright unfriendly.<div class="spacer">
</div>
The <b class="name">ca</b> utility was originally meant as an example of how to do things in a CA. It was not supposed to be used as a full blown CA itself: nevertheless some people are using it for this purpose.<div class="spacer">
</div>
The <b class="name">ca</b> command is effectively a single user command: no locking is done on the various files, and attempts to run more than one <b class="name">ca</b> command on the same database can have unpredictable results.<div class="spacer">
</div>
The <i class="arg">copy_extensions</i> option should be used with caution. If care is not taken, it can be a security risk. For example, if a certificate request contains a <span class="emph">basicConstraints</span> extension with CA:TRUE and the <i class="arg">copy_extensions</i> value is set to <i class="arg">copyall</i> and the user does not spot this when the certificate is displayed, then this will hand the requestor a valid CA certificate.<div class="spacer">
</div>
This situation can be avoided by setting <i class="arg">copy_extensions</i> to <i class="arg">copy</i> and including <span class="emph">basicConstraints</span> with CA:FALSE in the configuration file. Then if the request contains a <span class="emph">basicConstraints</span> extension, it will be ignored.<div class="spacer">
</div>
It is advisable to also include values for other extensions such as <i class="arg">keyUsage</i> to prevent a request supplying its own values.<div class="spacer">
</div>
Additional restrictions can be placed on the CA certificate itself. For example if the CA certificate has:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
basicConstraints = CA:TRUE, pathlen:0</div>
</blockquote>
<div class="spacer">
</div>
then even if a certificate is issued with CA:TRUE it will not be valid.</div>
<div class="section">
<h1 id="x43495048455253">CIPHERS</h1> <b class="name">openssl ciphers</b> [<span class="opt"><b class="flag">-hVv</b></span>] [<span class="opt"><b class="flag">-tls1</b></span>] [<span class="opt"><i class="arg">cipherlist</i></span>]<div class="spacer">
</div>
The <b class="name">ciphers</b> command converts <b class="name">OpenSSL</b> cipher lists into ordered SSL cipher preference lists. It can be used as a test tool to determine the appropriate cipherlist.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-h</b>, <b class="flag">-?</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print a brief usage message.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-tls1</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Only include TLS v1 ciphers.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-V</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Like <b class="flag">-v</b>, but include cipher suite codes in output (hex format).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-v</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Verbose option. List ciphers with a complete description of protocol version, key exchange, authentication, encryption and mac algorithms used along with any key size restrictions. Note that without the <b class="flag">-v</b> option, ciphers may seem to appear twice in a cipher list.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">cipherlist</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A cipher list to convert to a cipher preference list. If it is not included, the default cipher list will be used. The format is described below.</dd>
</dl>
</div>
<div class="section">
<h1 id="x43495048455253204c49535420464f524d4154">CIPHERS LIST FORMAT</h1> The cipher list consists of one or more <span class="emph">cipher strings</span> separated by colons. Commas or spaces are also acceptable separators, but colons are normally used.<div class="spacer">
</div>
The actual <span class="emph">cipher string</span> can take several different forms:<div class="spacer">
</div>
It can consist of a single cipher suite such as <span class="emph">RC4-SHA</span>.<div class="spacer">
</div>
It can represent a list of cipher suites containing a certain algorithm, or cipher suites of a certain type. For example <span class="emph">SHA1</span> represents all cipher suites using the digest algorithm SHA1.<div class="spacer">
</div>
Lists of cipher suites can be combined in a single <span class="emph">cipher string</span> using the &#8216;+&#8217; character. This is used as a logical <span class="emph">and</span> operation. For example, <span class="emph">SHA1+DES</span> represents all cipher suites containing the SHA1 and the DES algorithms.<div class="spacer">
</div>
Each cipher string can be optionally preceded by the characters &#8216;!&#8217;, &#8216;-&#8217;, or &#8216;+&#8217;.<div class="spacer">
</div>
If &#8216;!&#8217; is used, then the ciphers are permanently deleted from the list. The ciphers deleted can never reappear in the list even if they are explicitly stated.<div class="spacer">
</div>
If &#8216;-&#8217; is used, then the ciphers are deleted from the list, but some or all of the ciphers can be added again by later options.<div class="spacer">
</div>
If &#8216;+&#8217; is used, then the ciphers are moved to the end of the list. This option doesn't add any new ciphers, it just moves matching existing ones.<div class="spacer">
</div>
If none of these characters is present, the string is just interpreted as a list of ciphers to be appended to the current preference list. If the list includes any ciphers already present, they will be ignored; that is, they will not be moved to the end of the list.<div class="spacer">
</div>
Additionally, the cipher string <span class="emph">@STRENGTH</span> can be used at any point to sort the current cipher list in order of encryption algorithm key length.</div>
<div class="section">
<h1 id="x4349504845525320535452494e4753">CIPHERS STRINGS</h1> The following is a list of all permitted cipher strings and their meanings.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">DEFAULT</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The default cipher list. This is determined at compile time and is currently <i class="arg">ALL:!aNULL:!eNULL:!SSLv2</i>. This must be the first <i class="arg">cipher string</i> specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">COMPLEMENTOFDEFAULT</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The ciphers included in <i class="arg">ALL</i>, but not enabled by default. Currently this is <i class="arg">ADH</i>. Note that this rule does not cover <i class="arg">eNULL</i>, which is not included by <i class="arg">ALL</i> (use <i class="arg">COMPLEMENTOFALL</i> if necessary).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">ALL</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
All cipher suites except the <i class="arg">eNULL</i> ciphers which must be explicitly enabled.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">COMPLEMENTOFALL</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The cipher suites not enabled by <i class="arg">ALL</i>, currently being <i class="arg">eNULL</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">HIGH</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
&#8220;High&#8221; encryption cipher suites. This currently means those with key lengths larger than 128 bits.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">MEDIUM</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
&#8220;Medium&#8221; encryption cipher suites, currently those using 128-bit encryption.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">LOW</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
&#8220;Low&#8221; encryption cipher suites, currently those using 64- or 56-bit encryption algorithms.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">eNULL</i>, <i class="arg">NULL</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The &#8220;NULL&#8221; ciphers; that is, those offering no encryption. Because these offer no encryption at all and are a security risk, they are disabled unless explicitly included.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">aNULL</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The cipher suites offering no authentication. This is currently the anonymous DH algorithms. These cipher suites are vulnerable to a &#8220;man in the middle&#8221; attack, so their use is normally discouraged.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">kRSA</i>, <i class="arg">RSA</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using RSA key exchange.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">kEDH</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using ephemeral DH key agreement.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">aRSA</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using RSA authentication, i.e. the certificates carry RSA keys.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">aDSS</i>, <i class="arg">DSS</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using DSS authentication, i.e. the certificates carry DSS keys.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">TLSv1</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
TLS v1.0 cipher suites.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">DH</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using DH, including anonymous DH.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">ADH</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Anonymous DH cipher suites.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">AES</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using AES.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">3DES</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using triple DES.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">DES</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using DES (not triple DES).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">RC4</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using RC4.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">CAMELLIA</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using Camellia.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">CHACHA20</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using ChaCha20.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">IDEA</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using IDEA.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">MD5</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using MD5.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">SHA1</i>, <i class="arg">SHA</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Cipher suites using SHA1.</dd>
</dl>
</div>
<div class="section">
<h1 id="x43495048455253204558414d504c4553">CIPHERS EXAMPLES</h1> Verbose listing of all <b class="name">OpenSSL</b> ciphers including NULL ciphers:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl ciphers -v 'ALL:eNULL'</code></div>
</blockquote>
<div class="spacer">
</div>
Include all ciphers except NULL and anonymous DH then sort by strength:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl ciphers -v 'ALL:!ADH:@STRENGTH'</code></div>
</blockquote>
<div class="spacer">
</div>
Include only 3DES ciphers and then place RSA ciphers last:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl ciphers -v '3DES:+RSA'</code></div>
</blockquote>
<div class="spacer">
</div>
Include all RC4 ciphers but leave out those without authentication:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl ciphers -v 'RC4:!COMPLEMENTOFDEFAULT'</code></div>
</blockquote>
<div class="spacer">
</div>
Include all ciphers with RSA authentication but leave out ciphers without encryption:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl ciphers -v 'RSA:!COMPLEMENTOFALL'</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x43524c">CRL</h1><table class="synopsis">
<col style="width: 52.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl crl</td>
<td>
[<span class="opt"><b class="flag">-CAfile</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-CApath</b>&#160;<i class="arg">dir</i></span>] [<span class="opt"><b class="flag">-fingerprint</b></span>] [<span class="opt"><b class="flag">-hash</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-issuer</b></span>] [<span class="opt"><b class="flag">-lastupdate</b></span>] [<span class="opt"><b class="flag">-nextupdate</b></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-text</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">crl</b> command processes CRL files in DER or PEM format.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Verify the signature on a CRL by looking up the issuing certificate in <i class="arg">file</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CApath</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Verify the signature on a CRL by looking up the issuing certificate in <i class="arg">dir</i>. This directory must be a standard certificate directory, i.e. a hash of each subject name (using <b class="flag">x509</b> <b class="flag">-hash</b>) should be linked to each certificate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-fingerprint</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print the CRL fingerprint.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-hash</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Output a hash of the issuer name. This can be used to look up CRLs in a directory by issuer name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input file to read from, or standard input if this option is not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input format. <i class="arg">DER</i> format is a DER-encoded CRL structure. <i class="arg">PEM</i> (the default) is a base64-encoded version of the DER form with header and footer lines.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-issuer</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Output the issuer name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-lastupdate</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Output the <i class="arg">lastUpdate</i> field.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nextupdate</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Output the <i class="arg">nextUpdate</i> field.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't output the encoded version of the CRL.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the output file to write to, or standard output by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output format; the options have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print out the CRL in text form.</dd>
</dl>
</div>
<div class="section">
<h1 id="x43524c204e4f544553">CRL NOTES</h1> The PEM CRL format uses the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN X509 CRL----- 
-----END X509 CRL-----</pre>
</div>
<div class="section">
<h1 id="x43524c204558414d504c4553">CRL EXAMPLES</h1> Convert a CRL file from PEM to DER:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl crl -in crl.pem -outform DER -out crl.der</code></div>
</blockquote>
<div class="spacer">
</div>
Output the text form of a DER-encoded certificate:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl crl -in crl.der -inform DER -text -noout</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x43524c2042554753">CRL BUGS</h1> Ideally, it should be possible to create a CRL using appropriate options and files too.</div>
<div class="section">
<h1 id="x43524c32504b435337">CRL2PKCS7</h1><table class="synopsis">
<col style="width: 113.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl crl2pkcs7</td>
<td>
[<span class="opt"><b class="flag">-certfile</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-nocrl</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">crl2pkcs7</b> command takes an optional CRL and one or more certificates and converts them into a PKCS#7 degenerate &#8220;certificates only&#8221; structure.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-certfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies a <i class="arg">file</i> containing one or more certificates in PEM format. All certificates in the file will be added to the PKCS#7 structure. This option can be used more than once to read certificates from multiple files.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input <i class="arg">file</i> to read a CRL from, or standard input if this option is not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the CRL input format. <i class="arg">DER</i> format is a DER-encoded CRL structure. <i class="arg">PEM</i> (the default) is a base64-encoded version of the DER form with header and footer lines.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nocrl</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Normally, a CRL is included in the output file. With this option, no CRL is included in the output file and a CRL is not read from the input file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the output <i class="arg">file</i> to write the PKCS#7 structure to, or standard output by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the PKCS#7 structure output format. <i class="arg">DER</i> format is a DER-encoded PKCS#7 structure. <i class="arg">PEM</i> (the default) is a base64-encoded version of the DER form with header and footer lines.</dd>
</dl>
</div>
<div class="section">
<h1 id="x43524c32504b435337204558414d504c4553">CRL2PKCS7 EXAMPLES</h1> Create a PKCS#7 structure from a certificate and CRL:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl crl2pkcs7 -in crl.pem -certfile cert.pem -out p7.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Create a PKCS#7 structure in DER format with no CRL from several different certificates:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl crl2pkcs7 -nocrl -certfile newcert.pem \ 
	-certfile demoCA/cacert.pem -outform DER -out p7.der</pre>
</div>
<div class="section">
<h1 id="x43524c32504b435337204e4f544553">CRL2PKCS7 NOTES</h1> The output file is a PKCS#7 signed data structure containing no signers and just certificates and an optional CRL.<div class="spacer">
</div>
This utility can be used to send certificates and CAs to Netscape as part of the certificate enrollment process. This involves sending the DER-encoded output as MIME type <span class="emph">application/x-x509-user-cert</span>.<div class="spacer">
</div>
The PEM-encoded form with the header and footer lines removed can be used to install user certificates and CAs in MSIE using the Xenroll control.</div>
<div class="section">
<h1 id="x44475354">DGST</h1><table class="synopsis">
<col style="width: 12.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl dgst</td>
<td>
[<span class="opt"><b class="flag">-gost-mac</b> |&#160;<b class="flag">-streebog256</b>&#160;|&#160;<b class="flag">-streebog512</b>&#160;|&#160;<b class="flag">-md_gost94</b>&#160;|&#160;<b class="flag">-md4</b> |&#160;<b class="flag">-md5</b>&#160;|&#160;<b class="flag">-ripemd160</b>&#160;|&#160;<b class="flag">-sha1</b>&#160;|&#160;<b class="flag">-sha224</b> |&#160;<b class="flag">-sha256</b>&#160;|&#160;<b class="flag">-sha384</b>&#160;|&#160;<b class="flag">-sha512</b>&#160;|&#160;<b class="flag">-whirlpool</b></span>] [<span class="opt"><b class="flag">-binary</b></span>] [<span class="opt"><b class="flag">-cd</b></span>] [<span class="opt"><b class="flag">-hex</b></span>] [<span class="opt"><b class="flag">-hmac</b>&#160;<i class="arg">key</i></span>] [<span class="opt"><b class="flag">-keyform</b>&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-mac</b>&#160;<i class="arg">algorithm</i></span>] [<span class="opt"><b class="flag">-macopt</b>&#160;<i class="arg">nm</i>:<i class="arg">v</i></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-prverify</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-sign</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-signature</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-sigopt</b>&#160;<i class="arg">nm</i>:<i class="arg">v</i></span>] [<span class="opt"><b class="flag">-verify</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><i class="arg">file&#160;...</i></span>]</td>
<div class="spacer">
</div>
<b class="name">openssl</b> <b class="flag">gost-mac</b> | <b class="flag">streebog256</b> | <b class="flag">streebog512</b> | <b class="flag">md_gost94</b> | <b class="flag">md4</b> | <b class="flag">md5</b> | <b class="flag">ripemd160</b> | <b class="flag">sha1</b> | <b class="flag">sha224</b> | <b class="flag">sha256</b> | <b class="flag">sha384</b> | <b class="flag">sha512</b> | <b class="flag">whirlpool</b> [<span class="opt"><b class="flag">-c</b></span>] [<span class="opt"><b class="flag">-d</b></span>] [<span class="opt"><i class="arg">file ...</i></span>]</tr>
</tbody>
</table>
<div class="spacer">
</div>
The digest functions output the message digest of a supplied <i class="arg">file</i> or <i class="arg">files</i> in hexadecimal form. They can also be used for digital signing and verification.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-binary</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Output the digest or signature in binary form.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-c</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print out the digest in two-digit groups separated by colons; only relevant if <span class="emph">hex</span> format output is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print out BIO debugging information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-hex</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Digest is to be output as a hex dump. This is the default case for a &#8220;normal&#8221; digest as opposed to a digital signature.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-hmac</b> <i class="arg">key</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Create a hashed MAC using <i class="arg">key</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-keyform</b> <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the key format to sign the digest with.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-mac</b> <i class="arg">algorithm</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Create a keyed Message Authentication Code (MAC). The most popular MAC algorithm is HMAC (hash-based MAC), but there are other MAC algorithms which are not based on hash. MAC keys and other options should be set via the <b class="flag">-macopt</b> parameter.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-macopt</b> <i class="arg">nm</i>:<i class="arg">v</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Passes options to the MAC algorithm, specified by <b class="flag">-mac</b>. The following options are supported by HMAC:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">key</i>:<i class="arg">string</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the MAC key as an alphanumeric string (use if the key contain printable characters only). String length must conform to any restrictions of the MAC algorithm.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">hexkey</i>:<i class="arg">string</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the MAC key in hexadecimal form (two hex digits per byte). Key length must conform to any restrictions of the MAC algorithm.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The file to output to, or standard output by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-prverify</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Verify the signature using the private key in <i class="arg">file</i>. The output is either &#8220;Verification OK&#8221; or &#8220;Verification Failure&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-sign</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Digitally sign the digest using the private key in <i class="arg">file</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-signature</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The actual signature to verify.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-sigopt</b> <i class="arg">nm</i>:<i class="arg">v</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Pass options to the signature algorithm during sign or verify operations. The names and values of these options are algorithm-specific.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verify</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Verify the signature using the public key in <i class="arg">file</i>. The output is either &#8220;Verification OK&#8221; or &#8220;Verification Failure&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">file ...</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
File or files to digest. If no files are specified then standard input is used.</dd>
</dl>
</div>
<div class="section">
<h1 id="x44475354204e4f544553">DGST NOTES</h1> The digest of choice for all new applications is SHA1. Other digests are, however, still widely used.<div class="spacer">
</div>
If you wish to sign or verify data using the DSA algorithm, the dss1 digest must be used.<div class="spacer">
</div>
A source of random numbers is required for certain signing algorithms, in particular DSA.<div class="spacer">
</div>
The signing and verify options should only be used if a single file is being signed or verified.</div>
<div class="section">
<h1 id="x4448">DH</h1> Diffie-Hellman Parameter Management. The <b class="name">dh</b> command has been replaced by <b class="name">dhparam</b>. See <i class="link-sec"><a class="link-sec" href="#x4448504152414d">DHPARAM</a></i> below.</div>
<div class="section">
<h1 id="x4448504152414d">DHPARAM</h1><table class="synopsis">
<col style="width: 52.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl dhparam</td>
<td>
[<span class="opt"><b class="flag">-2</b> |&#160;<b class="flag">-5</b></span>] [<span class="opt"><b class="flag">-C</b></span>] [<span class="opt"><b class="flag">-check</b></span>] [<span class="opt"><b class="flag">-dsaparam</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-text</b></span>] [<span class="opt"><i class="arg">numbits</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">dhparam</b> command is used to manipulate DH parameter files.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-2</b>, <b class="flag">-5</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The generator to use, either 2 or 5. 2 is the default. If present, the input file is ignored and parameters are generated instead.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-C</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option converts the parameters into C code. The parameters can then be loaded by calling the <b class="flag">get_dh</b><i class="arg">numbits</i><code class="lit">()</code> function.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-check</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Check the DH parameters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-dsaparam</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If this option is used, DSA rather than DH parameters are read or created; they are converted to DH format. Otherwise, &#8220;strong&#8221; primes (such that (p-1)/2 is also prime) will be used for DH parameter generation.<div class="spacer">
</div>
DH parameter generation with the <b class="flag">-dsaparam</b> option is much faster, and the recommended exponent length is shorter, which makes DH key exchange more efficient. Beware that with such DSA-style DH parameters, a fresh DH key should be created for each use to avoid small-subgroup attacks that may be possible otherwise.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input <i class="arg">file</i> to read parameters from, or standard input if this option is not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input format. The argument <i class="arg">DER</i> uses an ASN1 DER-encoded form compatible with the PKCS#3 DHparameter structure. The <i class="arg">PEM</i> form is the default format: it consists of the DER format base64-encoded with additional header and footer lines.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option inhibits the output of the encoded version of the parameters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">numbits</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This argument specifies that a parameter set should be generated of size <i class="arg">numbits</i>. It must be the last option. If not present, a value of 2048 is used. If this value is present, the input file is ignored and parameters are generated instead.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output <i class="arg">file</i> to write parameters to. Standard output is used if this option is not present. The output filename should <span class="emph">not</span> be the same as the input filename.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output format; the options have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option prints out the DH parameters in human readable form.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4448504152414d205741524e494e4753">DHPARAM WARNINGS</h1> The program <b class="name">dhparam</b> combines the functionality of the programs <b class="name">dh</b> and <b class="name">gendh</b> in previous versions of <b class="name">OpenSSL</b> and <b class="name">SSLeay</b>. The <b class="name">dh</b> and <b class="name">gendh</b> programs are retained for now, but may have different purposes in future versions of <b class="name">OpenSSL</b>.</div>
<div class="section">
<h1 id="x4448504152414d204e4f544553">DHPARAM NOTES</h1> PEM format DH parameters use the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN DH PARAMETERS----- 
-----END DH PARAMETERS-----</pre>
<div class="spacer">
</div>
<b class="name">OpenSSL</b> currently only supports the older PKCS#3 DH, not the newer X9.42 DH.<div class="spacer">
</div>
This program manipulates DH parameters not keys.</div>
<div class="section">
<h1 id="x4448504152414d2042554753">DHPARAM BUGS</h1> There should be a way to generate and manipulate DH keys.</div>
<div class="section">
<h1 id="x4448504152414d20484953544f5259">DHPARAM HISTORY</h1> The <b class="name">dhparam</b> command was added in <b class="name">OpenSSL</b> 0.9.5. The <b class="flag">-dsaparam</b> option was added in <b class="name">OpenSSL</b> 0.9.6.</div>
<div class="section">
<h1 id="x445341">DSA</h1><table class="synopsis">
<col style="width: 107.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl dsa</td>
<td>
[<span class="opt"><b class="flag">-aes128</b> |&#160;<b class="flag">-aes192</b>&#160;|&#160;<b class="flag">-aes256</b>&#160;|&#160;<b class="flag">-des</b> |&#160;<b class="flag">-des3</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-modulus</b></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-passout</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-pubin</b></span>] [<span class="opt"><b class="flag">-pubout</b></span>] [<span class="opt"><b class="flag">-text</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">dsa</b> command processes DSA keys. They can be converted between various forms and their components printed out.</tr>
</tbody>
</table>
<div class="spacer">
</div>
<span class="symb">Note</span>: This command uses the traditional <b class="name">SSLeay</b> compatible format for private key encryption: newer applications should use the more secure PKCS#8 format using the <b class="name">pkcs8</b> command.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-aes128</b> | <b class="flag">-aes192</b> | <b class="flag">-aes256</b> | <b class="flag">-des</b> | <b class="flag">-des3</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
These options encrypt the private key with the AES, DES, or the triple DES ciphers, respectively, before outputting it. A pass phrase is prompted for. If none of these options is specified, the key is written in plain text. This means that using the <b class="name">dsa</b> utility to read in an encrypted key with no encryption option can be used to remove the pass phrase from a key, or by setting the encryption options it can be use to add or change the pass phrase. These options can only be used with PEM format output files.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input <i class="arg">file</i> to read a key from, or standard input if this option is not specified. If the key is encrypted, a pass phrase will be prompted for.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input format. The <i class="arg">DER</i> argument with a private key uses an ASN1 DER-encoded form of an ASN.1 SEQUENCE consisting of the values of version (currently zero), P, Q, G, and the public and private key components, respectively, as ASN.1 INTEGERs. When used with a public key it uses a <span class="emph">SubjectPublicKeyInfo</span> structure: it is an error if the key is not DSA.<div class="spacer">
</div>
The <i class="arg">PEM</i> form is the default format: it consists of the DER format base64-encoded with additional header and footer lines. In the case of a private key, PKCS#8 format is also accepted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-modulus</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option prints out the value of the public key component of the key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option prevents output of the encoded version of the key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output <i class="arg">file</i> to write a key to, or standard output if not specified. If any encryption options are set then a pass phrase will be prompted for. The output filename should <span class="emph">not</span> be the same as the input filename.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output format; the options have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passout</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output file password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubin</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default, a private key is read from the input file. With this option a public key is read instead.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default, a private key is output. With this option a public key will be output instead. This option is automatically set if the input is a public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prints out the public/private key components and parameters.</dd>
</dl>
</div>
<div class="section">
<h1 id="x445341204e4f544553">DSA NOTES</h1> The PEM private key format uses the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN DSA PRIVATE KEY----- 
-----END DSA PRIVATE KEY-----</pre>
<div class="spacer">
</div>
The PEM public key format uses the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN PUBLIC KEY----- 
-----END PUBLIC KEY-----</pre>
</div>
<div class="section">
<h1 id="x445341204558414d504c4553">DSA EXAMPLES</h1> To remove the pass phrase on a DSA private key:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl dsa -in key.pem -out keyout.pem</code></div>
</blockquote>
<div class="spacer">
</div>
To encrypt a private key using triple DES:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl dsa -in key.pem -des3 -out keyout.pem</code></div>
</blockquote>
<div class="spacer">
</div>
To convert a private key from PEM to DER format:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl dsa -in key.pem -outform DER -out keyout.der</code></div>
</blockquote>
<div class="spacer">
</div>
To print out the components of a private key to standard output:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl dsa -in key.pem -text -noout</code></div>
</blockquote>
<div class="spacer">
</div>
To just output the public part of a private key:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl dsa -in key.pem -pubout -out pubkey.pem</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x445341504152414d">DSAPARAM</h1><table class="synopsis">
<col style="width: 65.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl dsaparam</td>
<td>
[<span class="opt"><b class="flag">-C</b></span>] [<span class="opt"><b class="flag">-genkey</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-text</b></span>] [<span class="opt"><i class="arg">numbits</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">dsaparam</b> command is used to manipulate or generate DSA parameter files.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-C</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option converts the parameters into C code. The parameters can then be loaded by calling the <b class="flag">get_dsa</b><i class="arg">XXX</i><code class="lit">()</code> function.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-genkey</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option will generate a DSA either using the specified or generated parameters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input <i class="arg">file</i> to read parameters from, or standard input if this option is not specified. If the <i class="arg">numbits</i> parameter is included, then this option will be ignored.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input format. The <i class="arg">DER</i> argument uses an ASN1 DER-encoded form compatible with RFC 2459 (PKIX) DSS-Parms that is a SEQUENCE consisting of p, q and g, respectively. The <i class="arg">PEM</i> form is the default format: it consists of the DER format base64-encoded with additional header and footer lines.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option inhibits the output of the encoded version of the parameters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">numbits</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option specifies that a parameter set should be generated of size <i class="arg">numbits</i>. If this option is included, the input file (if any) is ignored.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output <i class="arg">file</i> to write parameters to. Standard output is used if this option is not present. The output filename should <span class="emph">not</span> be the same as the input filename.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output format; the options have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option prints out the DSA parameters in human readable form.</dd>
</dl>
</div>
<div class="section">
<h1 id="x445341504152414d204e4f544553">DSAPARAM NOTES</h1> PEM format DSA parameters use the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN DSA PARAMETERS----- 
-----END DSA PARAMETERS-----</pre>
<div class="spacer">
</div>
DSA parameter generation is a slow process and as a result the same set of DSA parameters is often used to generate several distinct keys.</div>
<div class="section">
<h1 id="x4543">EC</h1><table class="synopsis">
<col style="width: 228.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl ec</td>
<td>
[<span class="opt"><b class="flag">-conv_form</b> <i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-des</b></span>] [<span class="opt"><b class="flag">-des3</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-param_enc</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-param_out</b></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-passout</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-pubin</b></span>] [<span class="opt"><b class="flag">-pubout</b></span>] [<span class="opt"><b class="flag">-text</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">ec</b> command processes EC keys. They can be converted between various forms and their components printed out. Note: <b class="name">OpenSSL</b> uses the private key format specified in &#8220;SEC 1: Elliptic Curve Cryptography&#8221; (<a class="link-ext" href="http://www.secg.org/">http://www.secg.org/</a>). To convert an <b class="name">OpenSSL</b> EC private key into the PKCS#8 private key format use the <b class="name">pkcs8</b> command.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-conv_form</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies how the points on the elliptic curve are converted into octet strings. Possible values are: <b class="flag">compressed</b> (the default value), <b class="flag">uncompressed</b>, and <b class="flag">hybrid</b>. For more information regarding the point conversion forms please read the X9.62 standard. Note: Due to patent issues the <b class="flag">compressed</b> option is disabled by default for binary curves and can be enabled by defining the preprocessor macro <i class="arg">OPENSSL_EC_BIN_PT_COMP</i> at compile time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-des</b> | <b class="flag">-des3</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
These options encrypt the private key with the DES, triple DES, or any other cipher supported by <b class="name">OpenSSL</b> before outputting it. A pass phrase is prompted for. If none of these options is specified the key is written in plain text. This means that using the <b class="name">ec</b> utility to read in an encrypted key with no encryption option can be used to remove the pass phrase from a key, or by setting the encryption options it can be use to add or change the pass phrase. These options can only be used with PEM format output files.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input filename to read a key from, or standard input if this option is not specified. If the key is encrypted a pass phrase will be prompted for.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input format. DER with a private key uses an ASN.1 DER-encoded SEC1 private key. When used with a public key it uses the SubjectPublicKeyInfo structure as specified in RFC 3280. PEM is the default format: it consists of the DER format base64 encoded with additional header and footer lines. In the case of a private key PKCS#8 format is also accepted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prevents output of the encoded version of the key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the output filename to write a key to, or standard output if none is specified. If any encryption options are set then a pass phrase will be prompted for. The output filename should <span class="emph">not</span> be the same as the input filename.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output format. The options have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-param_enc</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies how the elliptic curve parameters are encoded. Possible value are: <b class="flag">named_curve</b>, i.e. the EC parameters are specified by an OID; or <b class="flag">explicit</b>, where the EC parameters are explicitly given (see RFC 3279 for the definition of the EC parameter structures). The default value is <b class="flag">named_curve</b>. Note: the <b class="flag">implicitlyCA</b> alternative, as specified in RFC 3279, is currently not implemented in <b class="name">OpenSSL</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passout</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output file password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubin</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default a private key is read from the input file; with this option a public key is read instead.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default a private key is output; with this option a public key is output instead. This option is automatically set if the input is a public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prints out the public/private key components and parameters.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4543204e4f544553">EC NOTES</h1> The PEM private key format uses the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN EC PRIVATE KEY----- 
-----END EC PRIVATE KEY-----</pre>
<div class="spacer">
</div>
The PEM public key format uses the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN PUBLIC KEY----- 
-----END PUBLIC KEY-----</pre>
</div>
<div class="section">
<h1 id="x4543204558414d504c4553">EC EXAMPLES</h1> To encrypt a private key using triple DES:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ec -in key.pem -des3 -out keyout.pem</pre>
<div class="spacer">
</div>
To convert a private key from PEM to DER format:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ec -in key.pem -outform DER -out keyout.der</pre>
<div class="spacer">
</div>
To print out the components of a private key to standard output:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ec -in key.pem -text -noout</pre>
<div class="spacer">
</div>
To just output the public part of a private key:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ec -in key.pem -pubout -out pubkey.pem</pre>
<div class="spacer">
</div>
To change the parameter encoding to <b class="flag">explicit</b>:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ec -in key.pem -param_enc explicit -out keyout.pem</pre>
<div class="spacer">
</div>
To change the point conversion form to <b class="flag">compressed</b>:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ec -in key.pem -conv_form compressed -out keyout.pem</pre>
</div>
<div class="section">
<h1 id="x454320484953544f5259">EC HISTORY</h1> The <b class="name">ec</b> command was first introduced in <b class="name">OpenSSL</b> 0.9.8.</div>
<div class="section">
<h1 id="x454320415554484f5253">EC AUTHORS</h1> <span class="author">Nils Larsch</span>.</div>
<div class="section">
<h1 id="x4543504152414d">ECPARAM</h1><table class="synopsis">
<col style="width: 66.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl ecparam</td>
<td>
[<span class="opt"><b class="flag">-C</b></span>] [<span class="opt"><b class="flag">-check</b></span>] [<span class="opt"><b class="flag">-conv_form</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-genkey</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-list_curves</b></span>] [<span class="opt"><b class="flag">-name</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-no_seed</b></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-param_enc</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-text</b></span>]</td>
<div class="spacer">
</div>
This command is used to manipulate or generate EC parameter files.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-C</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Convert the EC parameters into C code. The parameters can then be loaded by calling the <b class="fname">get_ec_group_XXX</b>() function.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-check</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Validate the elliptic curve parameters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-conv_form</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify how the points on the elliptic curve are converted into octet strings. Possible values are: <b class="flag">compressed</b> (the default value), <b class="flag">uncompressed</b>, and <b class="flag">hybrid</b>. For more information regarding the point conversion forms please read the X9.62 standard. Note: Due to patent issues the <b class="flag">compressed</b> option is disabled by default for binary curves and can be enabled by defining the preprocessor macro <i class="arg">OPENSSL_EC_BIN_PT_COMP</i> at compile time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-genkey</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate an EC private key using the specified parameters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the input filename to read parameters from or standard input if this option is not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the input format. DER uses an ASN.1 DER-encoded form compatible with RFC 3279 EcpkParameters. PEM is the default format: it consists of the DER format base64 encoded with additional header and footer lines.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-list_curves</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print out a list of all currently implemented EC parameter names and exit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-name</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the EC parameters with the specified 'short' name. Use <b class="flag">-list_curves</b> to get a list of all currently implemented EC parameters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_seed</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Inhibit that the 'seed' for the parameter generation is included in the ECParameters structure (see RFC 3279).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Inhibit the output of the encoded version of the parameters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the output filename parameters are written to. Standard output is used if this option is not present. The output filename should <span class="emph">not</span> be the same as the input filename.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the output format; the parameters have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-param_enc</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies how the elliptic curve parameters are encoded. Possible value are: <b class="flag">named_curve</b>, i.e. the EC parameters are specified by an OID, or <b class="flag">explicit</b>, where the EC parameters are explicitly given (see RFC 3279 for the definition of the EC parameter structures). The default value is <b class="flag">named_curve</b>. Note: the <b class="flag">implicitlyCA</b> alternative, as specified in RFC 3279, is currently not implemented in <b class="name">OpenSSL</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print out the EC parameters in human readable form.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4543504152414d204e4f544553">ECPARAM NOTES</h1> PEM format EC parameters use the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN EC PARAMETERS----- 
-----END EC PARAMETERS-----</pre>
<div class="spacer">
</div>
<b class="name">OpenSSL</b> is currently not able to generate new groups and therefore <b class="name">ecparam</b> can only create EC parameters from known (named) curves.</div>
<div class="section">
<h1 id="x4543504152414d204558414d504c4553">ECPARAM EXAMPLES</h1> To create EC parameters with the group 'prime192v1':<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ecparam -out ec_param.pem -name prime192v1</pre>
<div class="spacer">
</div>
To create EC parameters with explicit parameters:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ecparam -out ec_param.pem -name prime192v1 \ 
	-param_enc explicit</pre>
<div class="spacer">
</div>
To validate given EC parameters:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ecparam -in ec_param.pem -check</pre>
<div class="spacer">
</div>
To create EC parameters and a private key:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ecparam -out ec_key.pem -name prime192v1 -genkey</pre>
<div class="spacer">
</div>
To change the point encoding to 'compressed':<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ecparam -in ec_in.pem -out ec_out.pem \ 
	-conv_form compressed</pre>
<div class="spacer">
</div>
To print out the EC parameters to standard output:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ecparam -in ec_param.pem -noout -text</pre>
</div>
<div class="section">
<h1 id="x4543504152414d20484953544f5259">ECPARAM HISTORY</h1> The <b class="name">ecparam</b> command was first introduced in <b class="name">OpenSSL</b> 0.9.8.</div>
<div class="section">
<h1 id="x4543504152414d20415554484f5253">ECPARAM AUTHORS</h1> <span class="author">Nils Larsch</span>.</div>
<div class="section">
<h1 id="x454e43">ENC</h1><table class="synopsis">
<col style="width: 273.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl enc</td>
<td>
<b class="flag">-ciphername</b> [<span class="opt"><b class="flag">-AadePp</b></span>] [<span class="opt"><b class="flag">-base64</b></span>] [<span class="opt"><b class="flag">-bufsize</b>&#160;<i class="arg">number</i></span>] [<span class="opt"><b class="flag">-debug</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-iv</b>&#160;<i class="arg">IV</i></span>] [<span class="opt"><b class="flag">-K</b>&#160;<i class="arg">key</i></span>] [<span class="opt"><b class="flag">-k</b>&#160;<i class="arg">password</i></span>] [<span class="opt"><b class="flag">-kfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-md</b>&#160;<i class="arg">digest</i></span>] [<span class="opt"><b class="flag">-none</b></span>] [<span class="opt"><b class="flag">-nopad</b></span>] [<span class="opt"><b class="flag">-nosalt</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-pass</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-S</b>&#160;<i class="arg">salt</i></span>] [<span class="opt"><b class="flag">-salt</b></span>]</td>
<div class="spacer">
</div>
The symmetric cipher commands allow data to be encrypted or decrypted using various block and stream ciphers using keys based on passwords or explicitly provided. Base64 encoding or decoding can also be performed either by itself or in addition to the encryption or decryption.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-A</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If the <b class="flag">-a</b> option is set, then base64 process the data on one line.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-a</b>, <b class="flag">-base64</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Base64 process the data. This means that if encryption is taking place, the data is base64-encoded after encryption. If decryption is set, the input data is base64 decoded before being decrypted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-bufsize</b> <i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the buffer size for I/O.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Decrypt the input data.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-debug</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Debug the BIOs used for I/O.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-e</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Encrypt the input data: this is the default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The input <i class="arg">file</i>; standard input by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-iv</b> <i class="arg">IV</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The actual <i class="arg">IV</i> (initialisation vector) to use: this must be represented as a string comprised only of hex digits. When only the <i class="arg">key</i> is specified using the <b class="flag">-K</b> option, the <i class="arg">IV</i> must explicitly be defined. When a password is being specified using one of the other options, the <i class="arg">IV</i> is generated from this password.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-K</b> <i class="arg">key</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The actual <i class="arg">key</i> to use: this must be represented as a string comprised only of hex digits. If only the key is specified, the <i class="arg">IV</i> must be additionally specified using the <b class="flag">-iv</b> option. When both a <i class="arg">key</i> and a <i class="arg">password</i> are specified, the <i class="arg">key</i> given with the <b class="flag">-K</b> option will be used and the <i class="arg">IV</i> generated from the password will be taken. It probably does not make much sense to specify both <i class="arg">key</i> and <i class="arg">password</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-k</b> <i class="arg">password</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <i class="arg">password</i> to derive the key from. This is for compatibility with previous versions of <b class="name">OpenSSL</b>. Superseded by the <b class="flag">-pass</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-kfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Read the password to derive the key from the first line of <i class="arg">file</i>. This is for compatibility with previous versions of <b class="name">OpenSSL</b>. Superseded by the <b class="flag">-pass</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-md</b> <i class="arg">digest</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use <i class="arg">digest</i> to create a key from a pass phrase. <i class="arg">digest</i> may be one of &#8220;md5&#8221; or &#8220;sha1&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-none</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use NULL cipher (no encryption or decryption of input).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nopad</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable standard block padding.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nosalt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't use a <i class="arg">salt</i> in the key derivation routines. This option should <span class="emph">NEVER</span> be used unless compatibility with previous versions of <b class="name">OpenSSL</b> or <b class="name">SSLeay</b> is required.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output <i class="arg">file</i>, standard output by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-P</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print out the <i class="arg">salt</i>, <i class="arg">key</i>, and <i class="arg">IV</i> used, then immediately exit; don't do any encryption or decryption.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-p</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print out the <i class="arg">salt</i>, <i class="arg">key</i>, and <i class="arg">IV</i> used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pass</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-S</b> <i class="arg">salt</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The actual <i class="arg">salt</i> to use: this must be represented as a string comprised only of hex digits.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-salt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use a <i class="arg">salt</i> in the key derivation routines. This is the default.</dd>
</dl>
</div>
<div class="section">
<h1 id="x454e43204e4f544553">ENC NOTES</h1> The program can be called either as <b class="name">openssl ciphername</b> or <b class="name">openssl enc -ciphername</b>.<div class="spacer">
</div>
A password will be prompted for to derive the <i class="arg">key</i> and <i class="arg">IV</i> if necessary.<div class="spacer">
</div>
The <b class="flag">-nosalt</b> option should <span class="emph">NEVER</span> be used unless compatibility with previous versions of <b class="name">OpenSSL</b> or <b class="name">SSLeay</b> is required.<div class="spacer">
</div>
With the <b class="flag">-nosalt</b> option it is possible to perform efficient dictionary attacks on the password and to attack stream cipher encrypted data. The reason for this is that without the salt the same password always generates the same encryption key. When the salt is being used the first eight bytes of the encrypted data are reserved for the salt: it is generated at random when encrypting a file and read from the encrypted file when it is decrypted.<div class="spacer">
</div>
Some of the ciphers do not have large keys and others have security implications if not used correctly. A beginner is advised to just use a strong block cipher in CBC mode such as bf or des3.<div class="spacer">
</div>
All the block ciphers normally use PKCS#5 padding also known as standard block padding: this allows a rudimentary integrity or password check to be performed. However, since the chance of random data passing the test is better than 1 in 256, it isn't a very good test.<div class="spacer">
</div>
If padding is disabled, the input data must be a multiple of the cipher block length.<div class="spacer">
</div>
All RC2 ciphers have the same key and effective key length.<div class="spacer">
</div>
Blowfish and RC5 algorithms use a 128-bit key.</div>
<div class="section">
<h1 id="x454e4320535550504f525445442043495048455253">ENC SUPPORTED CIPHERS</h1><pre style="margin-left: 5.00ex;" class="lit display">
aes-[128|192|256]-cbc	128/192/256 bit AES in CBC mode 
aes-[128|192|256]	Alias for aes-[128|192|256]-cbc 
aes-[128|192|256]-cfb	128/192/256 bit AES in 128 bit CFB mode 
aes-[128|192|256]-cfb1	128/192/256 bit AES in 1 bit CFB mode 
aes-[128|192|256]-cfb8	128/192/256 bit AES in 8 bit CFB mode 
aes-[128|192|256]-ecb	128/192/256 bit AES in ECB mode 
aes-[128|192|256]-ofb	128/192/256 bit AES in OFB mode 
 
base64			Base 64 
 
bf			Alias for bf-cbc 
bf-cbc			Blowfish in CBC mode 
bf-cfb			Blowfish in CFB mode 
bf-ecb			Blowfish in ECB mode 
bf-ofb			Blowfish in OFB mode 
 
cast			Alias for cast-cbc 
cast-cbc		CAST in CBC mode 
cast5-cbc		CAST5 in CBC mode 
cast5-cfb		CAST5 in CFB mode 
cast5-ecb		CAST5 in ECB mode 
cast5-ofb		CAST5 in OFB mode 
 
des			Alias for des-cbc 
des-cbc			DES in CBC mode 
des-cfb			DES in CBC mode 
des-ecb			DES in ECB mode 
des-ofb			DES in OFB mode 
 
des-ede			Two key triple DES EDE in ECB mode 
des-ede-cbc		Two key triple DES EDE in CBC mode 
des-ede-cfb		Two key triple DES EDE in CFB mode 
des-ede-ofb		Two key triple DES EDE in OFB mode 
 
des3			Alias for des-ede3-cbc 
des-ede3		Three key triple DES EDE in ECB mode 
des-ede3-cbc		Three key triple DES EDE in CBC mode 
des-ede3-cfb		Three key triple DES EDE CFB mode 
des-ede3-ofb		Three key triple DES EDE in OFB mode 
 
desx			DESX algorithm 
 
rc2			Alias for rc2-cbc 
rc2-cbc			128-bit RC2 in CBC mode 
rc2-cfb			128-bit RC2 in CFB mode 
rc2-ecb			128-bit RC2 in ECB mode 
rc2-ofb			128-bit RC2 in OFB mode 
rc2-64-cbc		64-bit RC2 in CBC mode 
rc2-40-cbc		40-bit RC2 in CBC mode 
 
rc4			128-bit RC4 
rc4-40			40-bit RC4</pre>
</div>
<div class="section">
<h1 id="x454e43204558414d504c4553">ENC EXAMPLES</h1> Just base64 encode a binary file:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl base64 -in file.bin -out file.b64</code></div>
</blockquote>
<div class="spacer">
</div>
Decode the same file:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl base64 -d -in file.b64 -out file.bin</code></div>
</blockquote>
<div class="spacer">
</div>
Encrypt a file using triple DES in CBC mode using a prompted password:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl des3 -salt -in file.txt -out file.des3</code></div>
</blockquote>
<div class="spacer">
</div>
Decrypt a file using a supplied password:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl des3 -d -in file.des3 -out file.txt -k mypassword</code></div>
</blockquote>
<div class="spacer">
</div>
Encrypt a file then base64 encode it (so it can be sent via mail for example) using Blowfish in CBC mode:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl bf -a -salt -in file.txt -out file.bf</code></div>
</blockquote>
<div class="spacer">
</div>
Base64 decode a file then decrypt it:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl bf -d -a -in file.bf -out file.txt</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x454e432042554753">ENC BUGS</h1> The <b class="flag">-A</b> option when used with large files doesn't work properly.<div class="spacer">
</div>
There should be an option to allow an iteration count to be included.<div class="spacer">
</div>
The <b class="name">enc</b> program only supports a fixed number of algorithms with certain parameters. Therefore it is not possible to use RC2 with a 76-bit key or RC4 with an 84-bit key with this program.</div>
<div class="section">
<h1 id="x455252535452">ERRSTR</h1> <b class="name">openssl errstr</b> [<span class="opt"><b class="flag">-stats</b></span>] <i class="arg">errno ...</i><div class="spacer">
</div>
The <b class="name">errstr</b> command performs error number to error string conversion, generating a human-readable string representing the error code <i class="arg">errno</i>. The string is obtained through the <a class="link-man" href="../html3/ERR_error_string_n.html">ERR_error_string_n(3)</a> function and has the following format:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">error:[error code]:[library name]:[function name]:[reason string]</code></div>
</blockquote>
<div class="spacer">
</div>
[error code] is an 8-digit hexadecimal number. The remaining fields [library name], [function name], and [reason string] are all ASCII text.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-stats</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print debugging statistics about various aspects of the hash table.</dd>
</dl>
</div>
<div class="section">
<h1 id="x455252535452204558414d504c4553">ERRSTR EXAMPLES</h1> The following error code:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">27594:error:2006D080:lib(32):func(109):reason(128):bss_file.c:107:</code></div>
</blockquote>
<div class="spacer">
</div>
...can be displayed with:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl errstr 2006D080</code></div>
</blockquote>
<div class="spacer">
</div>
...to produce the error message:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">error:2006D080:BIO routines:BIO_new_file:no such file</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x47454e4448">GENDH</h1> Generation of Diffie-Hellman Parameters. Replaced by <b class="name">dhparam</b>. See <i class="link-sec"><a class="link-sec" href="#x4448504152414d">DHPARAM</a></i> above.</div>
<div class="section">
<h1 id="x47454e445341">GENDSA</h1><table class="synopsis">
<col style="width: 114.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl gendsa</td>
<td>
[<span class="opt"><b class="flag">-aes128</b> |&#160;<b class="flag">-aes192</b>&#160;|&#160;<b class="flag">-aes256</b>&#160;|&#160;<b class="flag">-des</b> |&#160;<b class="flag">-des3</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><i class="arg">paramfile</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">gendsa</b> command generates a DSA private key from a DSA parameter file (which will typically be generated by the <b class="name">openssl dsaparam</b> command).</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-aes128</b> | <b class="flag">-aes192</b> | <b class="flag">-aes256</b> | <b class="flag">-des</b> | <b class="flag">-des3</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
These options encrypt the private key with the AES, DES, or the triple DES ciphers, respectively, before outputting it. A pass phrase is prompted for. If none of these options are specified, no encryption is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output <i class="arg">file</i>. If this argument is not specified, standard output is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">paramfile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option specifies the DSA parameter file to use. The parameters in this file determine the size of the private key. DSA parameters can be generated and examined using the <b class="name">openssl dsaparam</b> command.</dd>
</dl>
</div>
<div class="section">
<h1 id="x47454e445341204e4f544553">GENDSA NOTES</h1> DSA key generation is little more than random number generation so it is much quicker than RSA key generation, for example.</div>
<div class="section">
<h1 id="x47454e504b4559">GENPKEY</h1><table class="synopsis">
<col style="width: 157.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl genpkey</td>
<td>
[<span class="opt"><b class="flag">-algorithm</b> <i class="arg">alg</i></span>] [<span class="opt"><i class="arg">cipher</i></span>] [<span class="opt"><b class="flag">-genparam</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-paramfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-pass</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-pkeyopt</b>&#160;<i class="arg">opt</i>:<i class="arg">value</i></span>] [<span class="opt"><b class="flag">-text</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">genpkey</b> command generates private keys. The use of this program is encouraged over the algorithm specific utilities because additional algorithm options can be used.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-algorithm</b> <i class="arg">alg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The public key algorithm to use, such as RSA, DSA, or DH. If used this option must precede any <b class="flag">-pkeyopt</b> options. The options <b class="flag">-paramfile</b> and <b class="flag">-algorithm</b> are mutually exclusive.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">cipher</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Encrypt the private key with the supplied cipher. Any algorithm name accepted by <b class="fname">EVP_get_cipherbyname</b>() is acceptable, such as <b class="flag">des3</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-genparam</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate a set of parameters instead of a private key. If used this option must precede any <b class="flag">-algorithm</b>, <b class="flag">-paramfile</b>, or <b class="flag">-pkeyopt</b> options.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output filename. If this argument is not specified then standard output is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output format, DER or PEM.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-paramfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Some public key algorithms generate a private key based on a set of parameters. They can be supplied using this option. If this option is used the public key algorithm used is determined by the parameters. If used this option must precede any <b class="flag">-pkeyopt</b> options. The options <b class="flag">-paramfile</b> and <b class="flag">-algorithm</b> are mutually exclusive.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pass</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output file password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pkeyopt</b> <i class="arg">opt</i>:<i class="arg">value</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the public key algorithm option <i class="arg">opt</i> to <i class="arg">value</i>. The precise set of options supported depends on the public key algorithm used and its implementation. See <i class="link-sec"><a class="link-sec" href="#x47454e504b4559204b45592047454e45524154494f4e204f5054494f4e53">GENPKEY KEY GENERATION OPTIONS</a></i> below for more details.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print an (unencrypted) text representation of private and public keys and parameters along with the DER or PEM structure.</dd>
</dl>
</div>
<div class="section">
<h1 id="x47454e504b4559204b45592047454e45524154494f4e204f5054494f4e53">GENPKEY KEY GENERATION OPTIONS</h1> The options supported by each algorithm and indeed each implementation of an algorithm can vary. The options for the <b class="name">OpenSSL</b> implementations are detailed below.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
rsa_keygen_bits:<i class="arg">numbits</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
(RSA) The number of bits in the generated key. If not specified 2048 is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
rsa_keygen_pubexp:<i class="arg">value</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
(RSA) The RSA public exponent value. This can be a large decimal or hexadecimal value if preceded by 0x. The default value is 65537.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
dsa_paramgen_bits:<i class="arg">numbits</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
(DSA) The number of bits in the generated parameters. If not specified 1024 is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
dh_paramgen_prime_len:<i class="arg">numbits</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
(DH) The number of bits in the prime parameter <i class="arg">p</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
dh_paramgen_generator:<i class="arg">value</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
(DH) The value to use for the generator <i class="arg">g</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
ec_paramgen_curve:<i class="arg">curve</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
(EC) The EC curve to use.</dd>
</dl>
</div>
<div class="section">
<h1 id="x47454e504b4559204558414d504c4553">GENPKEY EXAMPLES</h1> Generate an RSA private key using default parameters:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl genpkey -algorithm RSA -out key.pem</pre>
<div class="spacer">
</div>
Encrypt and output a private key using 128-bit AES and the passphrase &quot;hello&quot;:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl genpkey -algorithm RSA -out key.pem \ 
	-aes-128-cbc -pass pass:hello</pre>
<div class="spacer">
</div>
Generate a 2048-bit RSA key using 3 as the public exponent:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl genpkey -algorithm RSA -out key.pem \ 
	-pkeyopt rsa_keygen_bits:2048 -pkeyopt rsa_keygen_pubexp:3</pre>
<div class="spacer">
</div>
Generate 1024-bit DSA parameters:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl genpkey -genparam -algorithm DSA \ 
	-out dsap.pem -pkeyopt dsa_paramgen_bits:1024</pre>
<div class="spacer">
</div>
Generate a DSA key from parameters:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl genpkey -paramfile dsap.pem -out dsakey.pem</pre>
<div class="spacer">
</div>
Generate 1024-bit DH parameters:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl genpkey -genparam -algorithm DH \ 
	-out dhp.pem -pkeyopt dh_paramgen_prime_len:1024</pre>
<div class="spacer">
</div>
Generate a DH key from parameters:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl genpkey -paramfile dhp.pem -out dhkey.pem</pre>
</div>
<div class="section">
<h1 id="x47454e525341">GENRSA</h1><table class="synopsis">
<col style="width: 40.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl genrsa</td>
<td>
[<span class="opt"><b class="flag">-3</b> |&#160;<b class="flag">-f4</b></span>] [<span class="opt"><b class="flag">-aes128</b> |&#160;<b class="flag">-aes192</b>&#160;|&#160;<b class="flag">-aes256</b>&#160;|&#160;<b class="flag">-des</b> |&#160;<b class="flag">-des3</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-passout</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><i class="arg">numbits</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">genrsa</b> command generates an RSA private key.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-3</b> | <b class="flag">-f4</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The public exponent to use, either 3 or 65537. The default is 65537.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-aes128</b> | <b class="flag">-aes192</b> | <b class="flag">-aes256</b> | <b class="flag">-des</b> | <b class="flag">-des3</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
These options encrypt the private key with the AES, DES, or the triple DES ciphers, respectively, before outputting it. If none of these options are specified, no encryption is used. If encryption is used, a pass phrase is prompted for, if it is not supplied via the <b class="flag">-passout</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output <i class="arg">file</i>. If this argument is not specified, standard output is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passout</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output file password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">numbits</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The size of the private key to generate in bits. This must be the last option specified. The default is 2048.</dd>
</dl>
</div>
<div class="section">
<h1 id="x47454e525341204e4f544553">GENRSA NOTES</h1> RSA private key generation essentially involves the generation of two prime numbers. When generating a private key, various symbols will be output to indicate the progress of the generation. A &#8216;.&#8217; represents each number which has passed an initial sieve test; &#8216;+&#8217; means a number has passed a single round of the Miller-Rabin primality test. A newline means that the number has passed all the prime tests (the actual number depends on the key size).<div class="spacer">
</div>
Because key generation is a random process, the time taken to generate a key may vary somewhat.</div>
<div class="section">
<h1 id="x47454e5253412042554753">GENRSA BUGS</h1> A quirk of the prime generation algorithm is that it cannot generate small primes. Therefore the number of bits should not be less that 64. For typical private keys this will not matter because for security reasons they will be much larger (typically 2048 bits).</div>
<div class="section">
<h1 id="x4e534551">NSEQ</h1> <b class="name">openssl nseq</b> [<span class="opt"><b class="flag">-in</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-out</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-toseq</b></span>]<div class="spacer">
</div>
The <b class="name">nseq</b> command takes a file containing a Netscape certificate sequence and prints out the certificates contained in it or takes a file of certificates and converts it into a Netscape certificate sequence.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input <i class="arg">file</i> to read, or standard input if this option is not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the output <i class="arg">file</i>, or standard output by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-toseq</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Normally, a Netscape certificate sequence will be input and the output is the certificates contained in it. With the <b class="flag">-toseq</b> option the situation is reversed: a Netscape certificate sequence is created from a file of certificates.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4e534551204558414d504c4553">NSEQ EXAMPLES</h1> Output the certificates in a Netscape certificate sequence:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl nseq -in nseq.pem -out certs.pem</pre>
<div class="spacer">
</div>
Create a Netscape certificate sequence:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl nseq -in certs.pem -toseq -out nseq.pem</pre>
</div>
<div class="section">
<h1 id="x4e534551204e4f544553">NSEQ NOTES</h1> The PEM-encoded form uses the same headers and footers as a certificate:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN CERTIFICATE----- 
-----END CERTIFICATE-----</pre>
<div class="spacer">
</div>
A Netscape certificate sequence is a Netscape specific form that can be sent to browsers as an alternative to the standard PKCS#7 format when several certificates are sent to the browser: for example during certificate enrollment. It is used by the Netscape certificate server, for example.</div>
<div class="section">
<h1 id="x4e5345512042554753">NSEQ BUGS</h1> This program needs a few more options, like allowing DER or PEM input and output files and allowing multiple certificate files to be used.</div>
<div class="section">
<h1 id="x4f435350">OCSP</h1><table class="synopsis">
<col style="width: 109.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl ocsp</td>
<td>
[<span class="opt"><b class="flag">-CA</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-CAfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-CApath</b>&#160;<i class="arg">directory</i></span>] [<span class="opt"><b class="flag">-cert</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-dgst</b>&#160;<i class="arg">alg</i></span>] [<span class="opt"><b class="flag">-host</b> <i class="arg">hostname</i>:<i class="arg">port</i></span>] [<span class="opt"><b class="flag">-index</b>&#160;<i class="arg">indexfile</i></span>] [<span class="opt"><b class="flag">-issuer</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-ndays</b>&#160;<i class="arg">days</i></span>] [<span class="opt"><b class="flag">-nmin</b>&#160;<i class="arg">minutes</i></span>] [<span class="opt"><b class="flag">-no_cert_checks</b></span>] [<span class="opt"><b class="flag">-no_cert_verify</b></span>] [<span class="opt"><b class="flag">-no_certs</b></span>] [<span class="opt"><b class="flag">-no_chain</b></span>] [<span class="opt"><b class="flag">-no_intern</b></span>] [<span class="opt"><b class="flag">-no_nonce</b></span>] [<span class="opt"><b class="flag">-no_signature_verify</b></span>] [<span class="opt"><b class="flag">-nonce</b></span>] [<span class="opt"><b class="flag">-noverify</b></span>] [<span class="opt"><b class="flag">-nrequest</b>&#160;<i class="arg">number</i></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-path</b>&#160;<i class="arg">path</i></span>] [<span class="opt"><b class="flag">-port</b>&#160;<i class="arg">portnum</i></span>] [<span class="opt"><b class="flag">-req_text</b></span>] [<span class="opt"><b class="flag">-reqin</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-reqout</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-resp_key_id</b></span>] [<span class="opt"><b class="flag">-resp_no_certs</b></span>] [<span class="opt"><b class="flag">-resp_text</b></span>] [<span class="opt"><b class="flag">-respin</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-respout</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-rkey</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-rother</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-rsigner</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-serial</b>&#160;<i class="arg">number</i></span>] [<span class="opt"><b class="flag">-sign_other</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-signer</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-signkey</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-status_age</b>&#160;<i class="arg">age</i></span>] [<span class="opt"><b class="flag">-text</b></span>] [<span class="opt"><b class="flag">-trust_other</b></span>] [<span class="opt"><b class="flag">-url</b>&#160;<i class="arg">responder_url</i></span>] [<span class="opt"><b class="flag">-VAfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-validity_period</b>&#160;<i class="arg">nsec</i></span>] [<span class="opt"><b class="flag">-verify_other</b>&#160;<i class="arg">file</i></span>]</td>
<div class="spacer">
</div>
The Online Certificate Status Protocol (OCSP) enables applications to determine the (revocation) state of an identified certificate (RFC 2560).</tr>
</tbody>
</table>
<div class="spacer">
</div>
The <b class="name">ocsp</b> command performs many common OCSP tasks. It can be used to print out requests and responses, create requests and send queries to an OCSP responder, and behave like a mini OCSP server itself.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAfile</b> <i class="arg">file</i>, <b class="flag">-CApath</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<i class="arg">file</i> or <i class="arg">path</i> containing trusted CA certificates. These are used to verify the signature on the OCSP response.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-cert</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Add the certificate <i class="arg">file</i> to the request. The issuer certificate is taken from the previous <b class="flag">-issuer</b> option, or an error occurs if no issuer certificate is specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-dgst</b> <i class="arg">alg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Sets the digest algorithm to use for certificate identification in the OCSP request. By default SHA-1 is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-host</b> <i class="arg">hostname</i>:<i class="arg">port</i>, <b class="flag">-path</b> <i class="arg">path</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If the <b class="flag">-host</b> option is present, then the OCSP request is sent to the host <i class="arg">hostname</i> on port <i class="arg">port</i>. <b class="flag">-path</b> specifies the HTTP path name to use, or &#8216;/&#8217; by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-issuer</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the current issuer certificate. This option can be used multiple times. The certificate specified in <i class="arg">file</i> must be in PEM format. This option <span class="emph">must</span> come before any <b class="flag">-cert</b> options.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_cert_checks</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't perform any additional checks on the OCSP response signer's certificate. That is, do not make any checks to see if the signer's certificate is authorised to provide the necessary status information: as a result this option should only be used for testing purposes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_cert_verify</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't verify the OCSP response signer's certificate at all. Since this option allows the OCSP response to be signed by any certificate, it should only be used for testing purposes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_certs</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't include any certificates in signed request.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_chain</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Do not use certificates in the response as additional untrusted CA certificates.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_intern</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Ignore certificates contained in the OCSP response when searching for the signer's certificate. With this option, the signer's certificate must be specified with either the <b class="flag">-verify_other</b> or <b class="flag">-VAfile</b> options.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_signature_verify</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't check the signature on the OCSP response. Since this option tolerates invalid signatures on OCSP responses, it will normally only be used for testing purposes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nonce</b>, <b class="flag">-no_nonce</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Add an OCSP <span class="emph">nonce</span> extension to a request or disable an OCSP <span class="emph">nonce</span> addition. Normally, if an OCSP request is input using the <b class="flag">-respin</b> option no <span class="emph">nonce</span> is added: using the <b class="flag">-nonce</b> option will force addition of a <span class="emph">nonce</span>. If an OCSP request is being created (using the <b class="flag">-cert</b> and <b class="flag">-serial</b> options) a <span class="emph">nonce</span> is automatically added; specifying <b class="flag">-no_nonce</b> overrides this.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noverify</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't attempt to verify the OCSP response signature or the <span class="emph">nonce</span> values. This option will normally only be used for debugging since it disables all verification of the responder's certificate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify output <i class="arg">file</i>; default is standard output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-req_text</b>, <b class="flag">-resp_text</b>, <b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print out the text form of the OCSP request, response, or both, respectively.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-reqin</b> <i class="arg">file</i>, <b class="flag">-respin</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Read an OCSP request or response file from <i class="arg">file</i>. These options are ignored if an OCSP request or response creation is implied by other options (for example with the <b class="flag">-serial</b>, <b class="flag">-cert</b>, and <b class="flag">-host</b> options).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-reqout</b> <i class="arg">file</i>, <b class="flag">-respout</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Write out the DER-encoded certificate request or response to <i class="arg">file</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-serial</b> <i class="arg">num</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Same as the <b class="flag">-cert</b> option except the certificate with serial number <i class="arg">num</i> is added to the request. The serial number is interpreted as a decimal integer unless preceded by &#8216;0x&#8217;. Negative integers can also be specified by preceding the value with a &#8216;-&#8217; sign.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-sign_other</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Additional certificates to include in the signed request.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-signer</b> <i class="arg">file</i>, <b class="flag">-signkey</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Sign the OCSP request using the certificate specified in the <b class="flag">-signer</b> option and the private key specified by the <b class="flag">-signkey</b> option. If the <b class="flag">-signkey</b> option is not present, then the private key is read from the same file as the certificate. If neither option is specified, the OCSP request is not signed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-trust_other</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The certificates specified by the <b class="flag">-verify_other</b> option should be explicitly trusted and no additional checks will be performed on them. This is useful when the complete responder certificate chain is not available or trusting a root CA is not appropriate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-url</b> <i class="arg">responder_url</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the responder URL. Both HTTP and HTTPS (SSL/TLS) URLs can be specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-VAfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<i class="arg">file</i> containing explicitly trusted responder certificates. Equivalent to the <b class="flag">-verify_other</b> and <b class="flag">-trust_other</b> options.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-validity_period</b> <i class="arg">nsec</i>, <b class="flag">-status_age</b> <i class="arg">age</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
These options specify the range of times, in seconds, which will be tolerated in an OCSP response. Each certificate status response includes a <span class="emph">notBefore</span> time and an optional <span class="emph">notAfter</span> time. The current time should fall between these two values, but the interval between the two times may be only a few seconds. In practice the OCSP responder and clients' clocks may not be precisely synchronised and so such a check may fail. To avoid this the <b class="flag">-validity_period</b> option can be used to specify an acceptable error range in seconds, the default value is 5 minutes.<div class="spacer">
</div>
If the <span class="emph">notAfter</span> time is omitted from a response, then this means that new status information is immediately available. In this case the age of the <span class="emph">notBefore</span> field is checked to see it is not older than <i class="arg">age</i> seconds old. By default, this additional check is not performed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verify_other</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<i class="arg">file</i> containing additional certificates to search when attempting to locate the OCSP response signing certificate. Some responders omit the actual signer's certificate from the response; this option can be used to supply the necessary certificate in such cases.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4f43535020534552564552204f5054494f4e53">OCSP SERVER OPTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CA</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
CA certificate corresponding to the revocation information in <i class="arg">indexfile</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-index</b> <i class="arg">indexfile</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
<i class="arg">indexfile</i> is a text index file in <b class="name">ca</b> format containing certificate revocation information.<div class="spacer">
</div>
If the <b class="flag">-index</b> option is specified, the <b class="name">ocsp</b> utility is in <span class="emph">responder</span> mode, otherwise it is in <span class="emph">client</span> mode. The request(s) the responder processes can be either specified on the command line (using the <b class="flag">-issuer</b> and <b class="flag">-serial</b> options), supplied in a file (using the <b class="flag">-respin</b> option) or via external OCSP clients (if <i class="arg">port</i> or <i class="arg">url</i> is specified).<div class="spacer">
</div>
If the <b class="flag">-index</b> option is present, then the <b class="flag">-CA</b> and <b class="flag">-rsigner</b> options must also be present.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nmin</b> <i class="arg">minutes</i>, <b class="flag">-ndays</b> <i class="arg">days</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Number of <i class="arg">minutes</i> or <i class="arg">days</i> when fresh revocation information is available: used in the <i class="arg">nextUpdate</i> field. If neither option is present, the <span class="emph">nextUpdate</span> field is omitted, meaning fresh revocation information is immediately available.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nrequest</b> <i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The OCSP server will exit after receiving <i class="arg">number</i> requests, default unlimited.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-port</b> <i class="arg">portnum</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Port to listen for OCSP requests on. The port may also be specified using the <b class="flag">-url</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-resp_key_id</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Identify the signer certificate using the key ID; default is to use the subject name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-resp_no_certs</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't include any certificates in the OCSP response.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-rkey</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The private key to sign OCSP responses with; if not present, the file specified in the <b class="flag">-rsigner</b> option is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-rother</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Additional certificates to include in the OCSP response.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-rsigner</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The certificate to sign OCSP responses with.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4f43535020524553504f4e534520564552494649434154494f4e">OCSP RESPONSE VERIFICATION</h1> OCSP Response follows the rules specified in RFC 2560.<div class="spacer">
</div>
Initially the OCSP responder certificate is located and the signature on the OCSP request checked using the responder certificate's public key.<div class="spacer">
</div>
Then a normal certificate verify is performed on the OCSP responder certificate building up a certificate chain in the process. The locations of the trusted certificates used to build the chain can be specified by the <b class="flag">-CAfile</b> and <b class="flag">-CApath</b> options or they will be looked for in the standard <b class="name">OpenSSL</b> certificates directory.<div class="spacer">
</div>
If the initial verify fails, the OCSP verify process halts with an error.<div class="spacer">
</div>
Otherwise the issuing CA certificate in the request is compared to the OCSP responder certificate: if there is a match then the OCSP verify succeeds.<div class="spacer">
</div>
Otherwise the OCSP responder certificate's CA is checked against the issuing CA certificate in the request. If there is a match and the OCSPSigning extended key usage is present in the OCSP responder certificate, then the OCSP verify succeeds.<div class="spacer">
</div>
Otherwise the root CA of the OCSP responder's CA is checked to see if it is trusted for OCSP signing. If it is, the OCSP verify succeeds.<div class="spacer">
</div>
If none of these checks is successful, the OCSP verify fails.<div class="spacer">
</div>
What this effectively means is that if the OCSP responder certificate is authorised directly by the CA it is issuing revocation information about (and it is correctly configured), then verification will succeed.<div class="spacer">
</div>
If the OCSP responder is a <span class="emph">global responder</span> which can give details about multiple CAs and has its own separate certificate chain, then its root CA can be trusted for OCSP signing. For example:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl x509 -in ocspCA.pem -addtrust OCSPSigning \ 
	-out trustedCA.pem</pre>
<div class="spacer">
</div>
Alternatively, the responder certificate itself can be explicitly trusted with the <b class="flag">-VAfile</b> option.</div>
<div class="section">
<h1 id="x4f435350204e4f544553">OCSP NOTES</h1> As noted, most of the verify options are for testing or debugging purposes. Normally, only the <b class="flag">-CApath</b>, <b class="flag">-CAfile</b> and (if the responder is a `global VA') <b class="flag">-VAfile</b> options need to be used.<div class="spacer">
</div>
The OCSP server is only useful for test and demonstration purposes: it is not really usable as a full OCSP responder. It contains only a very simple HTTP request handling and can only handle the POST form of OCSP queries. It also handles requests serially, meaning it cannot respond to new requests until it has processed the current one. The text index file format of revocation is also inefficient for large quantities of revocation data.<div class="spacer">
</div>
It is possible to run the <b class="name">ocsp</b> application in <span class="emph">responder</span> mode via a CGI script using the <b class="flag">-respin</b> and <b class="flag">-respout</b> options.</div>
<div class="section">
<h1 id="x4f435350204558414d504c4553">OCSP EXAMPLES</h1> Create an OCSP request and write it to a file:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ocsp -issuer issuer.pem -cert c1.pem -cert c2.pem \ 
	-reqout req.der</pre>
<div class="spacer">
</div>
Send a query to an OCSP responder with URL <i class="file">http://ocsp.myhost.com/</i>, save the response to a file and print it out in text form:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ocsp -issuer issuer.pem -cert c1.pem -cert c2.pem \ 
	-url http://ocsp.myhost.com/ -resp_text -respout resp.der</pre>
<div class="spacer">
</div>
Read in an OCSP response and print out in text form:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl ocsp -respin resp.der -text</code></div>
</blockquote>
<div class="spacer">
</div>
OCSP server on port 8888 using a standard <b class="name">ca</b> configuration, and a separate responder certificate. All requests and responses are printed to a file:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ocsp -index demoCA/index.txt -port 8888 -rsigner \ 
	rcert.pem -CA demoCA/cacert.pem -text -out log.txt</pre>
<div class="spacer">
</div>
As above, but exit after processing one request:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ocsp -index demoCA/index.txt -port 8888 -rsigner \ 
	rcert.pem -CA demoCA/cacert.pem -nrequest 1</pre>
<div class="spacer">
</div>
Query status information using internally generated request:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ocsp -index demoCA/index.txt -rsigner rcert.pem -CA \ 
	demoCA/cacert.pem -issuer demoCA/cacert.pem -serial 1</pre>
<div class="spacer">
</div>
Query status information using request read from a file and write the response to a second file:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ocsp -index demoCA/index.txt -rsigner rcert.pem -CA \ 
	demoCA/cacert.pem -reqin req.der -respout resp.der</pre>
</div>
<div class="section">
<h1 id="x504153535744">PASSWD</h1><table class="synopsis">
<col style="width: 322.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl passwd</td>
<td>
[<span class="opt"><b class="flag">-1</b> | <b class="flag">-apr1</b> | <b class="flag">-crypt</b></span>] [<span class="opt"><b class="flag">-in</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-noverify</b></span>] [<span class="opt"><b class="flag">-quiet</b></span>] [<span class="opt"><b class="flag">-reverse</b></span>] [<span class="opt"><b class="flag">-salt</b> <i class="arg">string</i></span>] [<span class="opt"><b class="flag">-stdin</b></span>] [<span class="opt"><b class="flag">-table</b></span>] [<span class="opt"><i class="arg">password</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">passwd</b> command computes the hash of a password typed at run-time or the hash of each password in a list. The password list is taken from the named <i class="arg">file</i> for option <b class="flag">-in</b>, from stdin for option <b class="flag">-stdin</b>, or from the command line, or from the terminal otherwise. The <span class="unix">UNIX</span> standard algorithm <span class="emph">crypt</span> and the MD5-based <span class="unix">BSD</span> password algorithm <span class="emph">1</span> and its Apache variant <span class="emph">apr1</span> are available.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-1</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the MD5 based <span class="unix">BSD</span> password algorithm <span class="emph">1</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-apr1</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the <span class="emph">apr1</span> algorithm (Apache variant of the) <span class="unix">BSD</span> algorithm.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crypt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the <span class="emph">crypt</span> algorithm (default).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Read passwords from <i class="arg">file</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noverify</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't verify when reading a password from the terminal.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-quiet</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't output warnings when passwords given on the command line are truncated.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-reverse</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Switch table columns. This only makes sense in conjunction with the <b class="flag">-table</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-salt</b> <i class="arg">string</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the specified <i class="arg">salt</i>. When reading a password from the terminal, this implies <b class="flag">-noverify</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-stdin</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Read passwords from <span class="emph">stdin</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-table</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
In the output list, prepend the cleartext password and a TAB character to each password hash.</dd>
</dl>
</div>
<div class="section">
<h1 id="x504153535744204558414d504c4553">PASSWD EXAMPLES</h1><blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl passwd -crypt -salt xx password</code></div>
</blockquote>
prints &#8220;xxj31ZMTZzkVA&#8221;.<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl passwd -1 -salt xxxxxxxx password</code></div>
</blockquote>
prints &#8220;$1$xxxxxxxx$UYCIxa628.9qXjpQCjM4a.&#8221;.<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl passwd -apr1 -salt xxxxxxxx password</code></div>
</blockquote>
prints &#8220;$apr1$xxxxxxxx$dxHfLAsjHkDRmG83UXe8K0&#8221;.</div>
<div class="section">
<h1 id="x504b435337">PKCS7</h1><table class="synopsis">
<col style="width: 55.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl pkcs7</td>
<td>
[<span class="opt"><b class="flag">-in</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-print_certs</b></span>] [<span class="opt"><b class="flag">-text</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">pkcs7</b> command processes PKCS#7 files in DER or PEM format.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input <i class="arg">file</i> to read from, or standard input if this option is not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input format. <i class="arg">DER</i> format is a DER-encoded PKCS#7 v1.5 structure. <i class="arg">PEM</i> (the default) is a base64-encoded version of the DER form with header and footer lines.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't output the encoded version of the PKCS#7 structure (or certificates if <b class="flag">-print_certs</b> is set).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the output <i class="arg">file</i> to write to, or standard output by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output format; the options have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-print_certs</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prints out any certificates or CRLs contained in the file. They are preceded by their subject and issuer names in a one-line format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prints out certificate details in full rather than just subject and issuer names.</dd>
</dl>
</div>
<div class="section">
<h1 id="x504b435337204558414d504c4553">PKCS7 EXAMPLES</h1> Convert a PKCS#7 file from PEM to DER:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl pkcs7 -in file.pem -outform DER -out file.der</code></div>
</blockquote>
<div class="spacer">
</div>
Output all certificates in a file:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl pkcs7 -in file.pem -print_certs -out certs.pem</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x504b435337204e4f544553">PKCS7 NOTES</h1> The PEM PKCS#7 format uses the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN PKCS7----- 
-----END PKCS7-----</pre>
<div class="spacer">
</div>
For compatibility with some CAs it will also accept:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN CERTIFICATE----- 
-----END CERTIFICATE-----</pre>
</div>
<div class="section">
<h1 id="x504b435337205245535452494354494f4e53">PKCS7 RESTRICTIONS</h1> There is no option to print out all the fields of a PKCS#7 file.<div class="spacer">
</div>
The PKCS#7 routines only understand PKCS#7 v 1.5 as specified in RFC 2315. They cannot currently parse, for example, the new CMS as described in RFC 2630.</div>
<div class="section">
<h1 id="x504b435338">PKCS8</h1><table class="synopsis">
<col style="width: 192.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl pkcs8</td>
<td>
[<span class="opt"><b class="flag">-embed</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-nocrypt</b></span>] [<span class="opt"><b class="flag">-noiter</b></span>] [<span class="opt"><b class="flag">-nooct</b></span>] [<span class="opt"><b class="flag">-nsdb</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-passout</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-topk8</b></span>] [<span class="opt"><b class="flag">-v1</b>&#160;<i class="arg">alg</i></span>] [<span class="opt"><b class="flag">-v2</b>&#160;<i class="arg">alg</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">pkcs8</b> command processes private keys in PKCS#8 format. It can handle both unencrypted PKCS#8 PrivateKeyInfo format and EncryptedPrivateKeyInfo format with a variety of PKCS#5 (v1.5 and v2.0) and PKCS#12 algorithms.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-embed</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option generates DSA keys in a broken format. The DSA parameters are embedded inside the <span class="emph">PrivateKey</span> structure. In this form the OCTET STRING contains an ASN1 SEQUENCE consisting of two structures: a SEQUENCE containing the parameters and an ASN1 INTEGER containing the private key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input <i class="arg">file</i> to read a key from, or standard input if this option is not specified. If the key is encrypted, a pass phrase will be prompted for.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input format. If a PKCS#8 format key is expected on input, then either a DER- or PEM-encoded version of a PKCS#8 key will be expected. Otherwise the DER or PEM format of the traditional format private key is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nocrypt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
PKCS#8 keys generated or input are normally PKCS#8 <span class="emph">EncryptedPrivateKeyInfo</span> structures using an appropriate password-based encryption algorithm. With this option, an unencrypted <span class="emph">PrivateKeyInfo</span> structure is expected or output. This option does not encrypt private keys at all and should only be used when absolutely necessary. Certain software such as some versions of Java code signing software use unencrypted private keys.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noiter</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use an iteration count of 1. See the <i class="link-sec"><a class="link-sec" href="#x504b43533132">PKCS12</a></i> section below for a detailed explanation of this option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nooct</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option generates RSA private keys in a broken format that some software uses. Specifically the private key should be enclosed in an OCTET STRING, but some software just includes the structure itself without the surrounding OCTET STRING.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nsdb</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option generates DSA keys in a broken format compatible with Netscape private key databases. The <span class="emph">PrivateKey</span> contains a SEQUENCE consisting of the public and private keys, respectively.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output <i class="arg">file</i> to write a key to, or standard output by default. If any encryption options are set, a pass phrase will be prompted for. The output filename should <span class="emph">not</span> be the same as the input filename.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output format; the options have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passout</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output file password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-topk8</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Normally, a PKCS#8 private key is expected on input and a traditional format private key will be written. With the <b class="flag">-topk8</b> option the situation is reversed: it reads a traditional format private key and writes a PKCS#8 format key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-v1</b> <i class="arg">alg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option specifies a PKCS#5 v1.5 or PKCS#12 algorithm to use. A complete list of possible algorithms is included below.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-v2</b> <i class="arg">alg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option enables the use of PKCS#5 v2.0 algorithms. Normally, PKCS#8 private keys are encrypted with the password-based encryption algorithm called <span class="emph">pbeWithMD5AndDES-CBC</span>; this uses 56-bit DES encryption but it was the strongest encryption algorithm supported in PKCS#5 v1.5. Using the <b class="flag">-v2</b> option PKCS#5 v2.0 algorithms are used which can use any encryption algorithm such as 168-bit triple DES or 128-bit RC2, however not many implementations support PKCS#5 v2.0 yet. If using private keys with <b class="name">OpenSSL</b> then this doesn't matter.<div class="spacer">
</div>
The <i class="arg">alg</i> argument is the encryption algorithm to use; valid values include <i class="arg">des</i>, <i class="arg">des3</i>, and <i class="arg">rc2</i>. It is recommended that <i class="arg">des3</i> is used.</dd>
</dl>
</div>
<div class="section">
<h1 id="x504b435338204e4f544553">PKCS8 NOTES</h1> The encrypted form of a PEM-encoded PKCS#8 file uses the following headers and footers:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN ENCRYPTED PRIVATE KEY----- 
-----END ENCRYPTED PRIVATE KEY-----</pre>
<div class="spacer">
</div>
The unencrypted form uses:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN PRIVATE KEY----- 
-----END PRIVATE KEY-----</pre>
<div class="spacer">
</div>
Private keys encrypted using PKCS#5 v2.0 algorithms and high iteration counts are more secure than those encrypted using the traditional <b class="name">SSLeay</b> compatible formats. So if additional security is considered important, the keys should be converted.<div class="spacer">
</div>
The default encryption is only 56 bits because this is the encryption that most current implementations of PKCS#8 support.<div class="spacer">
</div>
Some software may use PKCS#12 password-based encryption algorithms with PKCS#8 format private keys: these are handled automatically but there is no option to produce them.<div class="spacer">
</div>
It is possible to write out DER-encoded encrypted private keys in PKCS#8 format because the encryption details are included at an ASN1 level whereas the traditional format includes them at a PEM level.</div>
<div class="section">
<h1 id="x504b435323352056312e3520414e4420504b435323313220414c474f524954484d53">PKCS#5 V1.5 AND PKCS#12 ALGORITHMS</h1> Various algorithms can be used with the <b class="flag">-v1</b> command line option, including PKCS#5 v1.5 and PKCS#12. These are described in more detail below.<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">PBE-MD5-DES</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
These algorithms were included in the original PKCS#5 v1.5 specification. They only offer 56 bits of protection since they both use DES.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">PBE-SHA1-RC2-64</i> | <i class="arg">PBE-MD5-RC2-64</i> | <i class="arg">PBE-SHA1-DES</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
These algorithms are not mentioned in the original PKCS#5 v1.5 specification but they use the same key derivation algorithm and are supported by some software. They are mentioned in PKCS#5 v2.0. They use either 64-bit RC2 or 56-bit DES.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">PBE-SHA1-RC4-128</i> | <i class="arg">PBE-SHA1-RC4-40</i> | <i class="arg">PBE-SHA1-3DES</i> | <i class="arg">PBE-SHA1-2DES</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">PBE-SHA1-RC2-128</i> | <i class="arg">PBE-SHA1-RC2-40</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
These algorithms use the PKCS#12 password-based encryption algorithm and allow strong encryption algorithms like triple DES or 128-bit RC2 to be used.</dd>
</dl>
</div>
<div class="section">
<h1 id="x504b435338204558414d504c4553">PKCS8 EXAMPLES</h1> Convert a private key from traditional to PKCS#5 v2.0 format using triple DES:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl pkcs8 -in key.pem -topk8 -v2 des3 -out enckey.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Convert a private key to PKCS#8 using a PKCS#5 1.5 compatible algorithm (DES):<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl pkcs8 -in key.pem -topk8 -out enckey.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Convert a private key to PKCS#8 using a PKCS#12 compatible algorithm (3DES):<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkcs8 -in key.pem -topk8 -out enckey.pem \ 
	-v1 PBE-SHA1-3DES</pre>
<div class="spacer">
</div>
Read a DER-unencrypted PKCS#8 format private key:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl pkcs8 -inform DER -nocrypt -in key.der -out key.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Convert a private key from any PKCS#8 format to traditional format:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl pkcs8 -in pk8.pem -out key.pem</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x504b435338205354414e4441524453">PKCS8 STANDARDS</h1> Test vectors from this PKCS#5 v2.0 implementation were posted to the pkcs-tng mailing list using triple DES, DES and RC2 with high iteration counts; several people confirmed that they could decrypt the private keys produced and therefore it can be assumed that the PKCS#5 v2.0 implementation is reasonably accurate at least as far as these algorithms are concerned.<div class="spacer">
</div>
The format of PKCS#8 DSA (and other) private keys is not well documented: it is hidden away in PKCS#11 v2.01, section 11.9; <b class="name">OpenSSL</b><code class="lit">'s</code> default DSA PKCS#8 private key format complies with this standard.</div>
<div class="section">
<h1 id="x504b4353382042554753">PKCS8 BUGS</h1> There should be an option that prints out the encryption algorithm in use and other details such as the iteration count.<div class="spacer">
</div>
PKCS#8 using triple DES and PKCS#5 v2.0 should be the default private key format; for <b class="name">OpenSSL</b> compatibility, several of the utilities use the old format at present.</div>
<div class="section">
<h1 id="x504b43533132">PKCS12</h1><table class="synopsis">
<col style="width: 138.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl pkcs12</td>
<td>
[<span class="opt"><b class="flag">-aes128</b> |&#160;<b class="flag">-aes192</b>&#160;|&#160;<b class="flag">-aes256</b>&#160;|&#160;<b class="flag">-des</b> |&#160;<b class="flag">-des3</b></span>] [<span class="opt"><b class="flag">-cacerts</b></span>] [<span class="opt"><b class="flag">-CAfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-caname</b>&#160;<i class="arg">name</i></span>] [<span class="opt"><b class="flag">-CApath</b>&#160;<i class="arg">directory</i></span>] [<span class="opt"><b class="flag">-certfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-certpbe</b>&#160;<i class="arg">alg</i></span>] [<span class="opt"><b class="flag">-chain</b></span>] [<span class="opt"><b class="flag">-clcerts</b></span>] [<span class="opt"><b class="flag">-CSP</b>&#160;<i class="arg">name</i></span>] [<span class="opt"><b class="flag">-descert</b></span>] [<span class="opt"><b class="flag">-export</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-info</b></span>] [<span class="opt"><b class="flag">-inkey</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-keyex</b></span>] [<span class="opt"><b class="flag">-keypbe</b>&#160;<i class="arg">alg</i></span>] [<span class="opt"><b class="flag">-keysig</b></span>] [<span class="opt"><b class="flag">-macalg</b>&#160;<i class="arg">alg</i></span>] [<span class="opt"><b class="flag">-maciter</b></span>] [<span class="opt"><b class="flag">-name</b>&#160;<i class="arg">name</i></span>] [<span class="opt"><b class="flag">-nocerts</b></span>] [<span class="opt"><b class="flag">-nodes</b></span>] [<span class="opt"><b class="flag">-noiter</b></span>] [<span class="opt"><b class="flag">-nokeys</b></span>] [<span class="opt"><b class="flag">-nomac</b></span>] [<span class="opt"><b class="flag">-nomaciter</b></span>] [<span class="opt"><b class="flag">-nomacver</b></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-passout</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-twopass</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">pkcs12</b> command allows PKCS#12 files (sometimes referred to as PFX files) to be created and parsed. PKCS#12 files are used by several programs including Netscape, MSIE and MS Outlook.</tr>
</tbody>
</table>
<div class="spacer">
</div>
There are a lot of options; the meaning of some depends on whether a PKCS#12 file is being created or parsed. By default, a PKCS#12 file is parsed; a PKCS#12 file can be created by using the <b class="flag">-export</b> option (see below).</div>
<div class="section">
<h1 id="x504b435331322050415253494e47204f5054494f4e53">PKCS12 PARSING OPTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-aes128</b> | <b class="flag">-aes192</b> | <b class="flag">-aes256</b> | <b class="flag">-des</b> | <b class="flag">-des3</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Use AES, DES, or triple DES, respectively, to encrypt private keys before outputting. The default is triple DES.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-cacerts</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Only output CA certificates (not client certificates).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-clcerts</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Only output client certificates (not CA certificates).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the <i class="arg">file</i> of the PKCS#12 file to be parsed. Standard input is used by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-info</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Output additional information about the PKCS#12 file structure, algorithms used, and iteration counts.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nocerts</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
No certificates at all will be output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nodes</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't encrypt the private keys at all.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nokeys</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
No private keys will be output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nomacver</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't attempt to verify the integrity MAC before reading the file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option inhibits output of the keys and certificates to the output file version of the PKCS#12 file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The <i class="arg">file</i> to write certificates and private keys to, standard output by default. They are all written in PEM format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passout</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The output file password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-twopass</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Prompt for separate integrity and encryption passwords: most software always assumes these are the same so this option will render such PKCS#12 files unreadable.</dd>
</dl>
</div>
<div class="section">
<h1 id="x504b435331322046494c45204352454154494f4e204f5054494f4e53">PKCS12 FILE CREATION OPTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
CA storage as a file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CApath</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
CA storage as a directory. This directory must be a standard certificate directory: that is, a hash of each subject name (using <b class="flag">x509 -hash</b>) should be linked to each certificate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-caname</b> <i class="arg">name</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the &#8220;friendly name&#8221; for other certificates. This option may be used multiple times to specify names for all certificates in the order they appear. Netscape ignores friendly names on other certificates, whereas MSIE displays them.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-certfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A file to read additional certificates from.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-certpbe</b> <i class="arg">alg</i>, <b class="flag">-keypbe</b> <i class="arg">alg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
These options allow the algorithm used to encrypt the private key and certificates to be selected. Any PKCS#5 v1.5 or PKCS#12 PBE algorithm name can be used (see the <i class="link-sec"><a class="link-sec" href="#x504b43533132204e4f544553">PKCS12 NOTES</a></i> section for more information). If a cipher name (as output by the <b class="flag">list-cipher-algorithms</b> command) is specified then it is used with PKCS#5 v2.0. For interoperability reasons it is advisable to only use PKCS#12 algorithms.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-chain</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
If this option is present, an attempt is made to include the entire certificate chain of the user certificate. The standard CA store is used for this search. If the search fails, it is considered a fatal error.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CSP</b> <i class="arg">name</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Write <i class="arg">name</i> as a Microsoft CSP name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-descert</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Encrypt the certificate using triple DES; this may render the PKCS#12 file unreadable by some &#8220;export grade&#8221; software. By default, the private key is encrypted using triple DES and the certificate using 40-bit RC2.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-export</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option specifies that a PKCS#12 file will be created rather than parsed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The <i class="arg">file</i> to read certificates and private keys from, standard input by default. They must all be in PEM format. The order doesn't matter but one private key and its corresponding certificate should be present. If additional certificates are present, they will also be included in the PKCS#12 file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inkey</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
File to read private key from. If not present, a private key must be present in the input file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-keyex</b> | <b class="flag">-keysig</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specifies that the private key is to be used for key exchange or just signing. This option is only interpreted by MSIE and similar MS software. Normally, &#8220;export grade&#8221; software will only allow 512-bit RSA keys to be used for encryption purposes, but arbitrary length keys for signing. The <b class="flag">-keysig</b> option marks the key for signing only. Signing only keys can be used for S/MIME signing, authenticode (ActiveX control signing) and SSL client authentication; however, due to a bug only MSIE 5.0 and later support the use of signing only keys for SSL client authentication.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-macalg</b> <i class="arg">alg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specify the MAC digest algorithm. If not included then SHA1 is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-maciter</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option is included for compatibility with previous versions; it used to be needed to use MAC iterations counts but they are now used by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-name</b> <i class="arg">name</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the &#8220;friendly name&#8221; for the certificate and private key. This name is typically displayed in list boxes by software importing the file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nomac</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't attempt to provide the MAC integrity.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nomaciter</b>, <b class="flag">-noiter</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
These options affect the iteration counts on the MAC and key algorithms. Unless you wish to produce files compatible with MSIE 4.0, you should leave these options alone.<div class="spacer">
</div>
To discourage attacks by using large dictionaries of common passwords, the algorithm that derives keys from passwords can have an iteration count applied to it: this causes a certain part of the algorithm to be repeated and slows it down. The MAC is used to check the file integrity but since it will normally have the same password as the keys and certificates it could also be attacked. By default, both MAC and encryption iteration counts are set to 2048; using these options the MAC and encryption iteration counts can be set to 1. Since this reduces the file security you should not use these options unless you really have to. Most software supports both MAC and key iteration counts. MSIE 4.0 doesn't support MAC iteration counts, so it needs the <b class="flag">-nomaciter</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies <i class="arg">file</i> to write the PKCS#12 file to. Standard output is used by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passout</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The output file password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
</dl>
</div>
<div class="section">
<h1 id="x504b43533132204e4f544553">PKCS12 NOTES</h1> Although there are a large number of options, most of them are very rarely used. For PKCS#12 file parsing, only <b class="flag">-in</b> and <b class="flag">-out</b> need to be used for PKCS#12 file creation. <b class="flag">-export</b> and <b class="flag">-name</b> are also used.<div class="spacer">
</div>
If none of the <b class="flag">-clcerts</b>, <b class="flag">-cacerts</b>, or <b class="flag">-nocerts</b> options are present, then all certificates will be output in the order they appear in the input PKCS#12 files. There is no guarantee that the first certificate present is the one corresponding to the private key. Certain software which requires a private key and certificate and assumes the first certificate in the file is the one corresponding to the private key: this may not always be the case. Using the <b class="flag">-clcerts</b> option will solve this problem by only outputting the certificate corresponding to the private key. If the CA certificates are required, they can be output to a separate file using the <b class="flag">-nokeys</b> and <b class="flag">-cacerts</b> options to just output CA certificates.<div class="spacer">
</div>
The <b class="flag">-keypbe</b> and <b class="flag">-certpbe</b> algorithms allow the precise encryption algorithms for private keys and certificates to be specified. Normally, the defaults are fine but occasionally software can't handle triple DES encrypted private keys; then the option <b class="flag">-keypbe</b> <i class="arg">PBE-SHA1-RC2-40</i> can be used to reduce the private key encryption to 40-bit RC2. A complete description of all algorithms is contained in the <i class="link-sec"><a class="link-sec" href="#x504b435338">PKCS8</a></i> section above.</div>
<div class="section">
<h1 id="x504b43533132204558414d504c4553">PKCS12 EXAMPLES</h1> Parse a PKCS#12 file and output it to a file:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl pkcs12 -in file.p12 -out file.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Output only client certificates to a file:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl pkcs12 -in file.p12 -clcerts -out file.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Don't encrypt the private key:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl pkcs12 -in file.p12 -out file.pem -nodes</code></div>
</blockquote>
<div class="spacer">
</div>
Print some info about a PKCS#12 file:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl pkcs12 -in file.p12 -info -noout</code></div>
</blockquote>
<div class="spacer">
</div>
Create a PKCS#12 file:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkcs12 -export -in file.pem -out file.p12 \ 
	-name &quot;My Certificate&quot;</pre>
<div class="spacer">
</div>
Include some extra certificates:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkcs12 -export -in file.pem -out file.p12 \ 
	-name &quot;My Certificate&quot; -certfile othercerts.pem</pre>
</div>
<div class="section">
<h1 id="x504b435331322042554753">PKCS12 BUGS</h1> Some would argue that the PKCS#12 standard is one big bug :-)<div class="spacer">
</div>
Versions of <b class="name">OpenSSL</b> before 0.9.6a had a bug in the PKCS#12 key generation routines. Under rare circumstances this could produce a PKCS#12 file encrypted with an invalid key. As a result some PKCS#12 files which triggered this bug from other implementations (MSIE or Netscape) could not be decrypted by <b class="name">OpenSSL</b> and similarly <b class="name">OpenSSL</b> could produce PKCS#12 files which could not be decrypted by other implementations. The chances of producing such a file are relatively small: less than 1 in 256.<div class="spacer">
</div>
A side effect of fixing this bug is that any old invalidly encrypted PKCS#12 files can no longer be parsed by the fixed version. Under such circumstances the <b class="name">pkcs12</b> utility will report that the MAC is OK but fail with a decryption error when extracting private keys.<div class="spacer">
</div>
This problem can be resolved by extracting the private keys and certificates from the PKCS#12 file using an older version of <b class="name">OpenSSL</b> and recreating the PKCS#12 file from the keys and certificates using a newer version of <b class="name">OpenSSL</b>. For example:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ old-openssl -in bad.p12 -out keycerts.pem 
$ openssl -in keycerts.pem -export -name &quot;My PKCS#12 file&quot; \ 
	-out fixed.p12</pre>
</div>
<div class="section">
<h1 id="x504b4559">PKEY</h1><table class="synopsis">
<col style="width: 120.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl pkey</td>
<td>
[<span class="opt"><i class="arg">cipher</i></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-passout</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-pubin</b></span>] [<span class="opt"><b class="flag">-pubout</b></span>] [<span class="opt"><b class="flag">-text</b></span>] [<span class="opt"><b class="flag">-text_pub</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">pkey</b> command processes public or private keys. They can be converted between various forms and their components printed out.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">cipher</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
These options encrypt the private key with the supplied cipher. Any algorithm name accepted by <b class="fname">EVP_get_cipherbyname</b>() is acceptable, such as <b class="flag">des3</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input filename to read a key from, or standard input if this option is not specified. If the key is encrypted a pass phrase will be prompted for.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input format, DER or PEM.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Do not output the encoded version of the key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output filename to write a key to, or standard output if this option is not specified. If any encryption options are set then a pass phrase will be prompted for. The output filename should <span class="emph">not</span> be the same as the input filename.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output format; the options have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passout</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output file password source. For more information about the format of <i class="arg">arg</i> see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubin</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default a private key is read from the input file: with this option a public key is read instead.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default a private key is output: with this option a public key will be output instead. This option is automatically set if the input is a public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print out the various public or private key components in plain text in addition to the encoded version.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text_pub</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print out only public key components even if a private key is being processed.</dd>
</dl>
</div>
<div class="section">
<h1 id="x504b4559204558414d504c4553">PKEY EXAMPLES</h1> To remove the pass phrase on an RSA private key:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkey -in key.pem -out keyout.pem</pre>
<div class="spacer">
</div>
To encrypt a private key using triple DES:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkey -in key.pem -des3 -out keyout.pem</pre>
<div class="spacer">
</div>
To convert a private key from PEM to DER format:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkey -in key.pem -outform DER -out keyout.der</pre>
<div class="spacer">
</div>
To print the components of a private key to standard output:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkey -in key.pem -text -noout</pre>
<div class="spacer">
</div>
To print the public components of a private key to standard output:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkey -in key.pem -text_pub -noout</pre>
<div class="spacer">
</div>
To just output the public part of a private key:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkey -in key.pem -pubout -out pubkey.pem</pre>
</div>
<div class="section">
<h1 id="x504b4559504152414d">PKEYPARAM</h1> <b class="flag">openssl pkeyparam</b> [<span class="opt"><b class="flag">-in</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-text</b></span>]<div class="spacer">
</div>
The <b class="name">pkey</b> command processes public or private keys. They can be converted between various forms and their components printed out.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input filename to read parameters from, or standard input if this option is not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Do not output the encoded version of the parameters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output filename to write parameters to, or standard output if this option is not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prints out the parameters in plain text in addition to the encoded version.</dd>
</dl>
</div>
<div class="section">
<h1 id="x504b4559504152414d204558414d504c4553">PKEYPARAM EXAMPLES</h1> Print out text version of parameters:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkeyparam -in param.pem -text</pre>
</div>
<div class="section">
<h1 id="x504b4559504152414d204e4f544553">PKEYPARAM NOTES</h1> There are no <b class="flag">-inform</b> or <b class="flag">-outform</b> options for this command because only PEM format is supported because the key type is determined by the PEM headers.</div>
<div class="section">
<h1 id="x504b455955544c">PKEYUTL</h1><table class="synopsis">
<col style="width: 85.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl pkeyutl</td>
<td>
[<span class="opt"><b class="flag">-asn1parse</b></span>] [<span class="opt"><b class="flag">-certin</b></span>] [<span class="opt"><b class="flag">-decrypt</b></span>] [<span class="opt"><b class="flag">-derive</b></span>] [<span class="opt"><b class="flag">-encrypt</b></span>] [<span class="opt"><b class="flag">-hexdump</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inkey</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-keyform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-peerform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-peerkey</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-pkeyopt</b>&#160;<i class="arg">opt</i>:<i class="arg">value</i></span>] [<span class="opt"><b class="flag">-pubin</b></span>] [<span class="opt"><b class="flag">-rev</b></span>] [<span class="opt"><b class="flag">-sigfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-sign</b></span>] [<span class="opt"><b class="flag">-verify</b></span>] [<span class="opt"><b class="flag">-verifyrecover</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">pkeyutl</b> command can be used to perform public key operations using any supported algorithm.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-asn1parse</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
ASN1parse the output data. This is useful when combined with the <b class="flag">-verifyrecover</b> option when an ASN1 structure is signed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-certin</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The input is a certificate containing a public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-decrypt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Decrypt the input data using a private key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-derive</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Derive a shared secret using the peer key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-encrypt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Encrypt the input data using a public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-hexdump</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Hex dump the output data.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the input filename to read data from, or standard input if this option is not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inkey</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The input key file. By default it should be a private key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-keyform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The key format DER or PEM.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the output filename to write to, or standard output by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-peerform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The peer key format DER or PEM.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-peerkey</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The peer key file, used by key derivation (agreement) operations.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pkeyopt</b> <i class="arg">opt</i>:<i class="arg">value</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Public key options.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubin</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The input file is a public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-rev</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Reverse the order of the input buffer. This is useful for some libraries (such as CryptoAPI) which represent the buffer in little endian format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-sigfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Signature file (verify operation only).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-sign</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Sign the input data and output the signed result. This requires a private key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verify</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Verify the input data against the signature file and indicate if the verification succeeded or failed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verifyrecover</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Verify the input data and output the recovered data.</dd>
</dl>
</div>
<div class="section">
<h1 id="x504b455955544c204e4f544553">PKEYUTL NOTES</h1> The operations and options supported vary according to the key algorithm and its implementation. The <b class="name">OpenSSL</b> operations and options are indicated below.<div class="spacer">
</div>
Unless otherwise mentioned all algorithms support the <i class="arg">digest</i>:<i class="arg">alg</i> option which specifies the digest in use for sign, verify, and verifyrecover operations. The value <i class="arg">alg</i> should represent a digest name as used in the <b class="fname">EVP_get_digestbyname</b>() function, for example <b class="flag">sha1</b>.<div class="subsection">
<h2 id="x52534120616c676f726974686d">RSA algorithm</h2> The RSA algorithm supports the encrypt, decrypt, sign, verify, and verifyrecover operations in general. Some padding modes only support some of these operations however.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
rsa_padding_mode:<i class="arg">mode</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This sets the RSA padding mode. Acceptable values for <i class="arg">mode</i> are <b class="flag">pkcs1</b> for PKCS#1 padding; <b class="flag">none</b> for no padding; <b class="flag">oaep</b> for OAEP mode; <b class="flag">x931</b> for X9.31 mode; and <b class="flag">pss</b> for PSS.<div class="spacer">
</div>
In PKCS#1 padding if the message digest is not set then the supplied data is signed or verified directly instead of using a DigestInfo structure. If a digest is set then a DigestInfo structure is used and its length must correspond to the digest type.<div class="spacer">
</div>
For oeap mode only encryption and decryption is supported.<div class="spacer">
</div>
For x931 if the digest type is set it is used to format the block data; otherwise the first byte is used to specify the X9.31 digest ID. Sign, verify, and verifyrecover can be performed in this mode.<div class="spacer">
</div>
For pss mode only sign and verify are supported and the digest type must be specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
rsa_pss_saltlen:<i class="arg">len</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
For pss mode only this option specifies the salt length. Two special values are supported: -1 sets the salt length to the digest length. When signing -2 sets the salt length to the maximum permissible value. When verifying -2 causes the salt length to be automatically determined based on the PSS block structure.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x44534120616c676f726974686d">DSA algorithm</h2> The DSA algorithm supports the sign and verify operations. Currently there are no additional options other than <i class="arg">digest</i>. Only the SHA1 digest can be used and this digest is assumed by default.</div>
<div class="subsection">
<h2 id="x444820616c676f726974686d">DH algorithm</h2> The DH algorithm supports the derive operation and no additional options.</div>
<div class="subsection">
<h2 id="x454320616c676f726974686d">EC algorithm</h2> The EC algorithm supports the sign, verify, and derive operations. The sign and verify operations use ECDSA and derive uses ECDH. Currently there are no additional options other than <i class="arg">digest</i>. Only the SHA1 digest can be used and this digest is assumed by default.</div>
</div>
<div class="section">
<h1 id="x504b455955544c204558414d504c4553">PKEYUTL EXAMPLES</h1> Sign some data using a private key:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkeyutl -sign -in file -inkey key.pem -out sig</pre>
<div class="spacer">
</div>
Recover the signed data (e.g. if an RSA key is used):<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkeyutl -verifyrecover -in sig -inkey key.pem</pre>
<div class="spacer">
</div>
Verify the signature (e.g. a DSA key):<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkeyutl -verify -in file -sigfile sig \ 
	-inkey key.pem</pre>
<div class="spacer">
</div>
Sign data using a message digest value (this is currently only valid for RSA):<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkeyutl -sign -in file -inkey key.pem \ 
	-out sig -pkeyopt digest:sha256</pre>
<div class="spacer">
</div>
Derive a shared secret value:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl pkeyutl -derive -inkey key.pem \ 
	-peerkey pubkey.pem -out secret</pre>
</div>
<div class="section">
<h1 id="x5052494d45">PRIME</h1> <b class="flag">openssl prime</b> [<span class="opt"><b class="flag">-bits</b> <i class="arg">n</i></span>] [<span class="opt"><b class="flag">-checks</b> <i class="arg">n</i></span>] [<span class="opt"><b class="flag">-generate</b></span>] [<span class="opt"><b class="flag">-hex</b></span>] [<span class="opt"><b class="flag">-safe</b></span>] <i class="arg">p</i><div class="spacer">
</div>
The <b class="name">prime</b> command is used to generate prime numbers, or to check numbers for primality. Results are probabilistic: they have an exceedingly high likelihood of being correct, but are not guaranteed.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-bits</b> <i class="arg">n</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the number of bits in the generated prime number. Must be used in conjunction with <b class="flag">-generate</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-checks</b> <i class="arg">n</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Perform a Miller-Rabin probabilistic primality test with <i class="arg">n</i> iterations. The default is 20.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-generate</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate a pseudo-random prime number. Must be used in conjunction with <b class="flag">-bits</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-hex</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Output in hex format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-safe</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate only &#8220;safe&#8221; prime numbers (i.e. a prime p so that (p-1)/2 is also prime).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">p</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Test if number <i class="arg">p</i> is prime.</dd>
</dl>
</div>
<div class="section">
<h1 id="x52414e44">RAND</h1><table class="synopsis">
<col style="width: 38.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl rand</td>
<td>
[<span class="opt"><b class="flag">-base64</b></span>] [<span class="opt"><b class="flag">-hex</b></span>] [<span class="opt"><b class="flag">-out</b> <i class="arg">file</i></span>] <i class="arg">num</i></td>
<div class="spacer">
</div>
The <b class="name">rand</b> command outputs <i class="arg">num</i> pseudo-random bytes.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-base64</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Perform <span class="emph">base64</span> encoding on the output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-hex</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify hexadecimal output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Write to <i class="arg">file</i> instead of standard output.</dd>
</dl>
</div>
<div class="section">
<h1 id="x524551">REQ</h1><table class="synopsis">
<col style="width: 166.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl req</td>
<td>
[<span class="opt"><b class="flag">-asn1-kludge</b></span>] [<span class="opt"><b class="flag">-batch</b></span>] [<span class="opt"><b class="flag">-config</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-days</b>&#160;<i class="arg">n</i></span>] [<span class="opt"><b class="flag">-extensions</b>&#160;<i class="arg">section</i></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-key</b>&#160;<i class="arg">keyfile</i></span>] [<span class="opt"><b class="flag">-keyform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-keyout</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-md4</b>&#160;|&#160;<b class="flag">-md5</b>&#160;|&#160;<b class="flag">-sha1</b></span>] [<span class="opt"><b class="flag">-modulus</b></span>] [<span class="opt"><b class="flag">-nameopt</b>&#160;<i class="arg">option</i></span>] [<span class="opt"><b class="flag">-new</b></span>] [<span class="opt"><b class="flag">-newhdr</b></span>] [<span class="opt"><b class="flag">-newkey</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-no-asn1-kludge</b></span>] [<span class="opt"><b class="flag">-nodes</b></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-passout</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-pubkey</b></span>] [<span class="opt"><b class="flag">-reqexts</b>&#160;<i class="arg">section</i></span>] [<span class="opt"><b class="flag">-reqopt</b>&#160;<i class="arg">option</i></span>] [<span class="opt"><b class="flag">-set_serial</b>&#160;<i class="arg">n</i></span>] [<span class="opt"><b class="flag">-subj</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-subject</b></span>] [<span class="opt"><b class="flag">-text</b></span>] [<span class="opt"><b class="flag">-utf8</b></span>] [<span class="opt"><b class="flag">-verbose</b></span>] [<span class="opt"><b class="flag">-verify</b></span>] [<span class="opt"><b class="flag">-x509</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">req</b> command primarily creates and processes certificate requests in PKCS#10 format. It can additionally create self-signed certificates, for use as root CAs, for example.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-asn1-kludge</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default, the <b class="name">req</b> command outputs certificate requests containing no attributes in the correct PKCS#10 format. However certain CAs will only accept requests containing no attributes in an invalid form: this option produces this invalid format.<div class="spacer">
</div>
More precisely, the <span class="emph">Attributes</span> in a PKCS#10 certificate request are defined as a SET OF Attribute. They are <span class="emph">not</span> optional, so if no attributes are present then they should be encoded as an empty SET OF. The invalid form does not include the empty SET OF, whereas the correct form does.<div class="spacer">
</div>
It should be noted that very few CAs still require the use of this option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-batch</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Non-interactive mode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-config</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This allows an alternative configuration file to be specified; this overrides the compile time filename or any specified in the <span class="env">OPENSSL_CONF</span> environment variable.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-days</b> <i class="arg">n</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
When the <b class="flag">-x509</b> option is being used, this specifies the number of days to certify the certificate for. The default is 30 days.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-extensions</b> <i class="arg">section</i>, <b class="flag">-reqexts</b> <i class="arg">section</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
These options specify alternative sections to include certificate extensions (if the <b class="flag">-x509</b> option is present) or certificate request extensions. This allows several different sections to be used in the same configuration file to specify requests for a variety of purposes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input <i class="arg">file</i> to read a request from, or standard input if this option is not specified. A request is only read if the creation options <b class="flag">-new</b> and <b class="flag">-newkey</b> are not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input format. The <i class="arg">DER</i> argument uses an ASN1 DER-encoded form compatible with the PKCS#10. The <i class="arg">PEM</i> form is the default format: it consists of the DER format base64-encoded with additional header and footer lines.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-key</b> <i class="arg">keyfile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the file to read the private key from. It also accepts PKCS#8 format private keys for PEM format files.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-keyform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The format of the private key file specified in the <b class="flag">-key</b> argument. <i class="arg">PEM</i> is the default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-keyout</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This gives the <i class="arg">file</i> to write the newly created private key to. If this option is not specified, the filename present in the configuration file is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-md5</b> | <b class="flag">-sha1</b> | <b class="flag">-sha256</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the message digest to sign the request with. This overrides the digest algorithm specified in the configuration file.<div class="spacer">
</div>
Some public key algorithms may override this choice. For instance, DSA signatures always use SHA1.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-modulus</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option prints out the value of the modulus of the public key contained in the request.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nameopt</b> <i class="arg">option</i>, <b class="flag">-reqopt</b> <i class="arg">option</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
These options determine how the subject or issuer names are displayed. The <i class="arg">option</i> argument can be a single option or multiple options separated by commas. Alternatively, these options may be used more than once to set multiple options. See the <i class="link-sec"><a class="link-sec" href="#x58353039">X509</a></i> section below for details.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-new</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option generates a new certificate request. It will prompt the user for the relevant field values. The actual fields prompted for and their maximum and minimum sizes are specified in the configuration file and any requested extensions.<div class="spacer">
</div>
If the <b class="flag">-key</b> option is not used, it will generate a new RSA private key using information specified in the configuration file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-newhdr</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Adds the word NEW to the PEM file header and footer lines on the outputed request. Some software (Netscape certificate server) and some CAs need this.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-newkey</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option creates a new certificate request and a new private key. The argument takes one of several forms. <i class="arg">rsa</i>:<i class="arg">nbits</i>, where <i class="arg">nbits</i> is the number of bits, generates an RSA key <i class="arg">nbits</i> in size. If <i class="arg">nbits</i> is omitted, i.e. <b class="flag">-newkey rsa</b> specified, the default key size, specified in the configuration file, is used.<div class="spacer">
</div>
All other algorithms support the <i class="arg">alg</i>:<i class="arg">file</i> form, where file may be an algorithm parameter file, created by the <b class="flag">genpkey -genparam</b> command or an X.509 certificate for a key with appropriate algorithm.<div class="spacer">
</div>
<i class="arg">param</i>:<i class="arg">file</i> generates a key using the parameter file or certificate <i class="arg">file</i>; the algorithm is determined by the parameters. <i class="arg">algname</i>:<i class="arg">file</i> use algorithm <i class="arg">algname</i> and parameter file <i class="arg">file</i>: the two algorithms must match or an error occurs. <i class="arg">algname</i> just uses algorithm <i class="arg">algname</i>, and parameters, if necessary, should be specified via the <b class="flag">-pkeyopt</b> option.<div class="spacer">
</div>
<i class="arg">dsa</i>:<i class="arg">file</i> generates a DSA key using the parameters in the file <i class="arg">file</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no-asn1-kludge</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Reverses the effect of <b class="flag">-asn1-kludge</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nodes</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If this option is specified and a private key is created, it will not be encrypted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option prevents output of the encoded version of the request.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output <i class="arg">file</i> to write to, or standard output by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output format; the options have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passout</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output file password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubkey</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Outputs the public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-reqopt</b> <i class="arg">option</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Customise the output format used with <b class="flag">-text</b>. The <i class="arg">option</i> argument can be a single option or multiple options separated by commas.<div class="spacer">
</div>
See the discussion of the <b class="flag">-certopt</b> option in the <b class="name">x509</b> command.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-set_serial</b> <i class="arg">n</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Serial number to use when outputting a self-signed certificate. This may be specified as a decimal value or a hex value if preceded by &#8216;0x&#8217;. It is possible to use negative serial numbers but this is not recommended.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-subj</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Replaces subject field of input request with specified data and outputs modified request. The arg must be formatted as <span class="emph">/type0=value0/type1=value1/type2=...</span>; characters may be escaped by &#8216;\&#8217; (backslash); no spaces are skipped.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-subject</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prints out the request subject (or certificate subject if <b class="flag">-x509</b> is specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prints out the certificate request in text form.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-utf8</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option causes field values to be interpreted as UTF8 strings; by default they are interpreted as ASCII. This means that the field values, whether prompted from a terminal or obtained from a configuration file, must be valid UTF8 strings.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verbose</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print extra details about the operations being performed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verify</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Verifies the signature on the request.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-x509</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option outputs a self-signed certificate instead of a certificate request. This is typically used to generate a test certificate or a self-signed root CA. The extensions added to the certificate (if any) are specified in the configuration file. Unless specified using the <b class="flag">-set_serial</b> option, 0 will be used for the serial number.</dd>
</dl>
</div>
<div class="section">
<h1 id="x52455120434f4e46494755524154494f4e2046494c4520464f524d4154">REQ CONFIGURATION FILE FORMAT</h1> The configuration options are specified in the <span class="emph">req</span> section of the configuration file. As with all configuration files, if no value is specified in the specific section (i.e. <span class="emph">req</span>) then the initial unnamed or <span class="emph">default</span> section is searched too.<div class="spacer">
</div>
The options available are described in detail below.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">attributes</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the section containing any request attributes: its format is the same as <i class="arg">distinguished_name</i>. Typically these may contain the <span class="emph">challengePassword</span> or <span class="emph">unstructuredName</span> types. They are currently ignored by <b class="name">OpenSSL</b><code class="lit">'s</code> request signing utilities, but some CAs might want them.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">default_bits</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the default key size in bits. If not specified, 2048 is used. It is used if the <b class="flag">-new</b> option is used. It can be overridden by using the <b class="flag">-newkey</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">default_keyfile</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This is the default file to write a private key to. If not specified, the key is written to standard output. This can be overridden by the <b class="flag">-keyout</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">default_md</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option specifies the digest algorithm to use. Possible values include <i class="arg">md5</i>, <i class="arg">sha1</i> and <i class="arg">sha256</i>. If not present, SHA256 is used. This option can be overridden on the command line.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">distinguished_name</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the section containing the distinguished name fields to prompt for when generating a certificate or certificate request. The format is described in the next section.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">encrypt_key</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
If this is set to <span class="emph">no</span> and a private key is generated, it is <span class="emph">not</span> encrypted. This is equivalent to the <b class="flag">-nodes</b> command line option. For compatibility, <i class="arg">encrypt_rsa_key</i> is an equivalent option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">input_password</i> | <i class="arg">output_password</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The passwords for the input private key file (if present) and the output private key file (if one will be created). The command line options <b class="flag">-passin</b> and <b class="flag">-passout</b> override the configuration file values.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">oid_file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies a file containing additional OBJECT IDENTIFIERS. Each line of the file should consist of the numerical form of the object identifier, followed by whitespace, then the short name followed by whitespace and finally the long name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">oid_section</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies a section in the configuration file containing extra object identifiers. Each line should consist of the short name of the object identifier followed by &#8216;=&#8217; and the numerical form. The short and long names are the same when this option is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">prompt</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
If set to the value <span class="emph">no</span>, this disables prompting of certificate fields and just takes values from the config file directly. It also changes the expected format of the <span class="emph">distinguished_name</span> and <span class="emph">attributes</span> sections.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">req_extensions</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the configuration file section containing a list of extensions to add to the certificate request. It can be overridden by the <b class="flag">-reqexts</b> command line switch.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">string_mask</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option limits the string types for encoding certain fields. The following values may be used, limiting strings to the indicated types:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">utf8only</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
<span class="emph">UTF8String.</span> This is the default, as recommended by PKIX in RFC 2459.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">default</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
<span class="emph">PrintableString</span>, <span class="emph">IA5String</span>, <span class="emph">T61String</span>, <span class="emph">BMPString</span>, <span class="emph">UTF8String</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">pkix</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
<span class="emph">PrintableString</span>, <span class="emph">IA5String</span>, <span class="emph">BMPString</span>, <span class="emph">UTF8String</span>. This was inspired by the PKIX recommendation in RFC 2459 for certificates generated before 2004, but differs by also permitting <span class="emph">IA5String</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">nombstr</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
<span class="emph">PrintableString</span>, <span class="emph">IA5String</span>, <span class="emph">T61String</span>, <span class="emph">UniversalString</span>. This was a workaround for some ancient software that had problems with the variable-sized <span class="emph">BMPString</span> and <span class="emph">UTF8String</span> types.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">MASK</b>:<i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
This is an explicit bitmask of permitted types, where <i class="arg">number</i> is a C-style hex, decimal, or octal number that's a bit-wise OR of <span class="define">B_ASN1_*</span> values from <b class="includes">&lt;<a class="link-includes">openssl/asn1.h</a>&gt;</b>.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">utf8</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
If set to the value <span class="emph">yes</span>, then field values are interpreted as UTF8 strings; by default they are interpreted as ASCII. This means that the field values, whether prompted from a terminal or obtained from a configuration file, must be valid UTF8 strings.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">x509_extensions</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the configuration file section containing a list of extensions to add to a certificate generated when the <b class="flag">-x509</b> switch is used. It can be overridden by the <b class="flag">-extensions</b> command line switch.</dd>
</dl>
</div>
<div class="section">
<h1 id="x5245512044495354494e47554953484544204e414d4520414e44204154545249425554452053454354494f4e20464f524d4154">REQ DISTINGUISHED NAME AND ATTRIBUTE SECTION FORMAT</h1> There are two separate formats for the distinguished name and attribute sections. If the <b class="flag">-prompt</b> option is set to <span class="emph">no</span>, then these sections just consist of field names and values: for example,<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
CN=My Name 
OU=My Organization 
emailAddress=someone@somewhere.org</pre>
<div class="spacer">
</div>
This allows external programs (e.g. GUI based) to generate a template file with all the field names and values and just pass it to <b class="name">req</b>. An example of this kind of configuration file is contained in the <i class="link-sec"><a class="link-sec" href="#x524551204558414d504c4553">REQ EXAMPLES</a></i> section.<div class="spacer">
</div>
Alternatively if the <b class="flag">-prompt</b> option is absent or not set to <span class="emph">no</span>, then the file contains field prompting information. It consists of lines of the form:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
fieldName=&quot;prompt&quot; 
fieldName_default=&quot;default field value&quot; 
fieldName_min= 2 
fieldName_max= 4</pre>
<div class="spacer">
</div>
&#8220;fieldName&#8221; is the field name being used, for example <span class="emph">commonName</span> (or CN). The &#8220;prompt&#8221; string is used to ask the user to enter the relevant details. If the user enters nothing, the default value is used; if no default value is present, the field is omitted. A field can still be omitted if a default value is present, if the user just enters the &#8216;.&#8217; character.<div class="spacer">
</div>
The number of characters entered must be between the <span class="emph">fieldName_min</span> and <span class="emph">fieldName_max</span> limits: there may be additional restrictions based on the field being used (for example <span class="emph">countryName</span> can only ever be two characters long and must fit in a <span class="emph">PrintableString</span>).<div class="spacer">
</div>
Some fields (such as <span class="emph">organizationName</span>) can be used more than once in a DN. This presents a problem because configuration files will not recognize the same name occurring twice. To avoid this problem, if the <span class="emph">fieldName</span> contains some characters followed by a full stop, they will be ignored. So, for example, a second <span class="emph">organizationName</span> can be input by calling it &#8220;1.organizationName&#8221;.<div class="spacer">
</div>
The actual permitted field names are any object identifier short or long names. These are compiled into <b class="name">OpenSSL</b> and include the usual values such as <span class="emph">commonName</span>, <span class="emph">countryName</span>, <span class="emph">localityName</span>, <span class="emph">organizationName</span>, <span class="emph">organizationUnitName</span>, <span class="emph">stateOrProvinceName</span>. Additionally, <span class="emph">emailAddress</span> is included as well as <span class="emph">name</span>, <span class="emph">surname</span>, <span class="emph">givenName initials</span> and <span class="emph">dnQualifier</span>.<div class="spacer">
</div>
Additional object identifiers can be defined with the <i class="arg">oid_file</i> or <i class="arg">oid_section</i> options in the configuration file. Any additional fields will be treated as though they were a <span class="emph">DirectoryString</span>.</div>
<div class="section">
<h1 id="x524551204558414d504c4553">REQ EXAMPLES</h1> Examine and verify a certificate request:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl req -in req.pem -text -verify -noout</code></div>
</blockquote>
<div class="spacer">
</div>
Create a private key and then generate a certificate request from it:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl genrsa -out key.pem 2048 
$ openssl req -new -key key.pem -out req.pem</pre>
<div class="spacer">
</div>
The same but just using req:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl req -newkey rsa:2048 -keyout key.pem -out req.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Generate a self-signed root certificate:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl req -x509 -newkey rsa:2048 -keyout key.pem -out req.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Example of a file pointed to by the <i class="arg">oid_file</i> option:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
1.2.3.4        shortName       A longer Name 
1.2.3.6        otherName       Other longer Name</pre>
<div class="spacer">
</div>
Example of a section pointed to by <i class="arg">oid_section</i> making use of variable expansion:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
testoid1=1.2.3.5 
testoid2=${testoid1}.6</pre>
<div class="spacer">
</div>
Sample configuration file prompting for field values:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
 [ req ] 
 default_bits           = 1024 
 default_keyfile        = privkey.pem 
 distinguished_name     = req_distinguished_name 
 attributes             = req_attributes 
 x509_extensions        = v3_ca 
 
 dirstring_type = nobmp 
 
 [ req_distinguished_name ] 
 countryName                    = Country Name (2 letter code) 
 countryName_default            = AU 
 countryName_min                = 2 
 countryName_max                = 2 
 
 localityName                   = Locality Name (eg, city) 
 
 organizationalUnitName         = Organizational Unit Name (eg, section) 
 
 commonName                     = Common Name (eg, YOUR name) 
 commonName_max                 = 64 
 
 emailAddress                   = Email Address 
 emailAddress_max               = 40 
 
 [ req_attributes ] 
 challengePassword              = A challenge password 
 challengePassword_min          = 4 
 challengePassword_max          = 20 
 
 [ v3_ca ] 
 
 subjectKeyIdentifier=hash 
 authorityKeyIdentifier=keyid:always,issuer:always 
 basicConstraints = CA:true</pre>
<div class="spacer">
</div>
Sample configuration containing all field values:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
 
 [ req ] 
 default_bits           = 1024 
 default_keyfile        = keyfile.pem 
 distinguished_name     = req_distinguished_name 
 attributes             = req_attributes 
 prompt                 = no 
 output_password        = mypass 
 
 [ req_distinguished_name ] 
 C                      = GB 
 ST                     = Test State or Province 
 L                      = Test Locality 
 O                      = Organization Name 
 OU                     = Organizational Unit Name 
 CN                     = Common Name 
 emailAddress           = test@email.address 
 
 [ req_attributes ] 
 challengePassword              = A challenge password</pre>
</div>
<div class="section">
<h1 id="x524551204e4f544553">REQ NOTES</h1> The header and footer lines in the PEM format are normally:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN CERTIFICATE REQUEST----- 
-----END CERTIFICATE REQUEST-----</pre>
<div class="spacer">
</div>
Some software (some versions of Netscape certificate server) instead needs:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN NEW CERTIFICATE REQUEST----- 
-----END NEW CERTIFICATE REQUEST-----</pre>
<div class="spacer">
</div>
which is produced with the <b class="flag">-newhdr</b> option but is otherwise compatible. Either form is accepted transparently on input.<div class="spacer">
</div>
The certificate requests generated by Xenroll with MSIE have extensions added. It includes the <span class="emph">keyUsage</span> extension which determines the type of key (signature only or general purpose) and any additional OIDs entered by the script in an <span class="emph">extendedKeyUsage</span> extension.</div>
<div class="section">
<h1 id="x52455120444941474e4f5354494353">REQ DIAGNOSTICS</h1> The following messages are frequently asked about:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
Using configuration from /some/path/openssl.cnf 
Unable to load config info</pre>
<div class="spacer">
</div>
This is followed some time later by...<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
unable to find 'distinguished_name' in config 
problems making Certificate Request</pre>
<div class="spacer">
</div>
The first error message is the clue: it can't find the configuration file! Certain operations (like examining a certificate request) don't need a configuration file so its use isn't enforced. Generation of certificates or requests, however, do need a configuration file. This could be regarded as a bug.<div class="spacer">
</div>
Another puzzling message is this:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
Attributes: 
    a0:00</pre>
<div class="spacer">
</div>
This is displayed when no attributes are present and the request includes the correct empty SET OF structure (the DER encoding of which is 0xa0 0x00). If you just see:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
Attributes:</div>
</blockquote>
<div class="spacer">
</div>
then the SET OF is missing and the encoding is technically invalid (but it is tolerated). See the description of the command line option <b class="flag">-asn1-kludge</b> for more information.</div>
<div class="section">
<h1 id="x52455120454e5649524f4e4d454e54205641524941424c4553">REQ ENVIRONMENT VARIABLES</h1> The variable <span class="env">OPENSSL_CONF</span>, if defined, allows an alternative configuration file location to be specified; it will be overridden by the <b class="flag">-config</b> command line switch if it is present.</div>
<div class="section">
<h1 id="x5245512042554753">REQ BUGS</h1> <b class="name">OpenSSL</b><code class="lit">'s</code> handling of T61Strings (aka TeletexStrings) is broken: it effectively treats them as ISO 8859-1 (Latin 1); Netscape and MSIE have similar behaviour. This can cause problems if you need characters that aren't available in <span class="emph">PrintableStrings</span> and you don't want to or can't use <span class="emph">BMPStrings</span>.<div class="spacer">
</div>
As a consequence of the T61String handling, the only correct way to represent accented characters in <b class="name">OpenSSL</b> is to use a <span class="emph">BMPString</span>: unfortunately Netscape currently chokes on these. If you have to use accented characters with Netscape and MSIE then you currently need to use the invalid T61String form.<div class="spacer">
</div>
The current prompting is not very friendly. It doesn't allow you to confirm what you've just entered. Other things, like extensions in certificate requests, are statically defined in the configuration file. Some of these, like an email address in <span class="emph">subjectAltName</span>, should be input by the user.</div>
<div class="section">
<h1 id="x525341">RSA</h1><table class="synopsis">
<col style="width: 107.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl rsa</td>
<td>
[<span class="opt"><b class="flag">-aes128</b> |&#160;<b class="flag">-aes192</b>&#160;|&#160;<b class="flag">-aes256</b>&#160;|&#160;<b class="flag">-des</b> |&#160;<b class="flag">-des3</b></span>] [<span class="opt"><b class="flag">-check</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">NET</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-modulus</b></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">NET</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-passout</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-pubin</b></span>] [<span class="opt"><b class="flag">-pubout</b></span>] [<span class="opt"><b class="flag">-sgckey</b></span>] [<span class="opt"><b class="flag">-text</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">rsa</b> command processes RSA keys. They can be converted between various forms and their components printed out.</tr>
</tbody>
</table>
<div class="spacer">
</div>
<span class="symb">Note</span>: this command uses the traditional <b class="name">SSLeay</b> compatible format for private key encryption: newer applications should use the more secure PKCS#8 format using the <b class="name">pkcs8</b> utility.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-aes128</b> | <b class="flag">-aes192</b> | <b class="flag">-aes256</b> | <b class="flag">-des</b> | <b class="flag">-des3</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
These options encrypt the private key with the AES, DES, or the triple DES ciphers, respectively, before outputting it. A pass phrase is prompted for. If none of these options are specified, the key is written in plain text. This means that using the <b class="name">rsa</b> utility to read in an encrypted key with no encryption option can be used to remove the pass phrase from a key, or by setting the encryption options it can be used to add or change the pass phrase. These options can only be used with PEM format output files.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-check</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option checks the consistency of an RSA private key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input <i class="arg">file</i> to read a key from, or standard input if this option is not specified. If the key is encrypted, a pass phrase will be prompted for.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">NET</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input format. The <i class="arg">DER</i> argument uses an ASN1 DER-encoded form compatible with the PKCS#1 RSAPrivateKey or SubjectPublicKeyInfo format. The <i class="arg">PEM</i> form is the default format: it consists of the DER format base64-encoded with additional header and footer lines. On input PKCS#8 format private keys are also accepted. The <i class="arg">NET</i> form is a format described in the <i class="link-sec"><a class="link-sec" href="#x525341204e4f544553">RSA NOTES</a></i> section.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option prevents output of the encoded version of the key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-modulus</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option prints out the value of the modulus of the key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output <i class="arg">file</i> to write a key to, or standard output if this option is not specified. If any encryption options are set, a pass phrase will be prompted for. The output filename should <span class="emph">not</span> be the same as the input filename.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">NET</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output format; the options have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passout</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output file password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubin</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default, a private key is read from the input file; with this option a public key is read instead.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default, a private key is output; with this option a public key will be output instead. This option is automatically set if the input is a public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-sgckey</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the modified <span class="emph">NET</span> algorithm used with some versions of Microsoft IIS and SGC keys.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prints out the various public or private key components in plain text, in addition to the encoded version.</dd>
</dl>
</div>
<div class="section">
<h1 id="x525341204e4f544553">RSA NOTES</h1> The PEM private key format uses the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN RSA PRIVATE KEY----- 
-----END RSA PRIVATE KEY-----</pre>
<div class="spacer">
</div>
The PEM public key format uses the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN PUBLIC KEY----- 
-----END PUBLIC KEY-----</pre>
<div class="spacer">
</div>
The <span class="emph">NET</span> form is a format compatible with older Netscape servers and Microsoft IIS .key files; this uses unsalted RC4 for its encryption. It is not very secure and so should only be used when necessary.<div class="spacer">
</div>
Some newer version of IIS have additional data in the exported .key files. To use these with the <b class="name">rsa</b> utility, view the file with a binary editor and look for the string &#8220;private-key&#8221;, then trace back to the byte sequence 0x30, 0x82 (this is an ASN1 SEQUENCE). Copy all the data from this point onwards to another file and use that as the input to the <b class="name">rsa</b> utility with the <b class="flag">-inform</b> <i class="arg">NET</i> option. If there is an error after entering the password, try the <b class="flag">-sgckey</b> option.</div>
<div class="section">
<h1 id="x525341204558414d504c4553">RSA EXAMPLES</h1> To remove the pass phrase on an RSA private key:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl rsa -in key.pem -out keyout.pem</code></div>
</blockquote>
<div class="spacer">
</div>
To encrypt a private key using triple DES:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl rsa -in key.pem -des3 -out keyout.pem</code></div>
</blockquote>
<div class="spacer">
</div>
To convert a private key from PEM to DER format:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl rsa -in key.pem -outform DER -out keyout.der</code></div>
</blockquote>
<div class="spacer">
</div>
To print out the components of a private key to standard output:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl rsa -in key.pem -text -noout</code></div>
</blockquote>
<div class="spacer">
</div>
To just output the public part of a private key:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl rsa -in key.pem -pubout -out pubkey.pem</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x5253412042554753">RSA BUGS</h1> The command line password arguments don't currently work with <span class="emph">NET</span> format.<div class="spacer">
</div>
There should be an option that automatically handles .key files, without having to manually edit them.</div>
<div class="section">
<h1 id="x52534155544c">RSAUTL</h1><table class="synopsis">
<col style="width: 88.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl rsautl</td>
<td>
[<span class="opt"><b class="flag">-asn1parse</b></span>] [<span class="opt"><b class="flag">-certin</b></span>] [<span class="opt"><b class="flag">-decrypt</b></span>] [<span class="opt"><b class="flag">-encrypt</b></span>] [<span class="opt"><b class="flag">-hexdump</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inkey</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-keyform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-oaep</b>&#160;|&#160;<b class="flag">-pkcs</b>&#160;|&#160;<b class="flag">-raw</b>&#160;|&#160;<b class="flag">-ssl</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-pubin</b></span>] [<span class="opt"><b class="flag">-sign</b></span>] [<span class="opt"><b class="flag">-verify</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">rsautl</b> command can be used to sign, verify, encrypt and decrypt data using the RSA algorithm.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-asn1parse</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Asn1parse the output data; this is useful when combined with the <b class="flag">-verify</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-certin</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The input is a certificate containing an RSA public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-decrypt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Decrypt the input data using an RSA private key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-encrypt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Encrypt the input data using an RSA public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-hexdump</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Hex dump the output data.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input <i class="arg">file</i> to read data from, or standard input if this option is not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inkey</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The input key file, by default it should be an RSA private key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-keyform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Private ket format. Default is <i class="arg">PEM</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-oaep</b> | <b class="flag">-pkcs</b> | <b class="flag">-raw</b> | <b class="flag">-ssl</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The padding to use: PKCS#1 OAEP, PKCS#1 v1.5 (the default), or no padding, respectively. For signatures, only <b class="flag">-pkcs</b> and <b class="flag">-raw</b> can be used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the output <i class="arg">file</i> to write to, or standard output by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubin</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The input file is an RSA public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-sign</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Sign the input data and output the signed result. This requires an RSA private key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verify</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Verify the input data and output the recovered data.</dd>
</dl>
</div>
<div class="section">
<h1 id="x52534155544c204e4f544553">RSAUTL NOTES</h1> <b class="name">rsautl</b>, because it uses the RSA algorithm directly, can only be used to sign or verify small pieces of data.</div>
<div class="section">
<h1 id="x52534155544c204558414d504c4553">RSAUTL EXAMPLES</h1> Sign some data using a private key:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl rsautl -sign -in file -inkey key.pem -out sig</code></div>
</blockquote>
<div class="spacer">
</div>
Recover the signed data:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl rsautl -verify -in sig -inkey key.pem</code></div>
</blockquote>
<div class="spacer">
</div>
Examine the raw signed data:<div class="spacer">
</div>
<code class="lit">&#160;$ openssl rsautl -verify -in file -inkey key.pem -raw -hexdump</code><div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
 0000 - 00 01 ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................ 
 0010 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................ 
 0020 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................ 
 0030 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................ 
 0040 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................ 
 0050 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................ 
 0060 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff   ................ 
 0070 - ff ff ff ff 00 68 65 6c-6c 6f 20 77 6f 72 6c 64   .....hello world</pre>
<div class="spacer">
</div>
The PKCS#1 block formatting is evident from this. If this was done using encrypt and decrypt, the block would have been of type 2 (the second byte) and random padding data visible instead of the 0xff bytes.<div class="spacer">
</div>
It is possible to analyse the signature of certificates using this utility in conjunction with <b class="name">asn1parse</b>. Consider the self-signed example in <i class="file">certs/pca-cert.pem</i>: running <b class="name">asn1parse</b> as follows yields:<div class="spacer">
</div>
<code class="lit">&#160;$ openssl asn1parse -in pca-cert.pem</code><div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
    0:d=0  hl=4 l= 742 cons: SEQUENCE 
    4:d=1  hl=4 l= 591 cons:  SEQUENCE 
    8:d=2  hl=2 l=   3 cons:   cont [ 0 ] 
   10:d=3  hl=2 l=   1 prim:    INTEGER           :02 
   13:d=2  hl=2 l=   1 prim:   INTEGER           :00 
   16:d=2  hl=2 l=  13 cons:   SEQUENCE 
   18:d=3  hl=2 l=   9 prim:    OBJECT            :md5WithRSAEncryption 
   29:d=3  hl=2 l=   0 prim:    NULL 
   31:d=2  hl=2 l=  92 cons:   SEQUENCE 
   33:d=3  hl=2 l=  11 cons:    SET 
   35:d=4  hl=2 l=   9 cons:     SEQUENCE 
   37:d=5  hl=2 l=   3 prim:      OBJECT            :countryName 
   42:d=5  hl=2 l=   2 prim:      PRINTABLESTRING   :AU 
  .... 
  599:d=1  hl=2 l=  13 cons:  SEQUENCE 
  601:d=2  hl=2 l=   9 prim:   OBJECT            :md5WithRSAEncryption 
  612:d=2  hl=2 l=   0 prim:   NULL 
  614:d=1  hl=3 l= 129 prim:  BIT STRING</pre>
<div class="spacer">
</div>
The final BIT STRING contains the actual signature. It can be extracted with:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl asn1parse -in pca-cert.pem -out sig -noout -strparse 614</code></div>
</blockquote>
<div class="spacer">
</div>
The certificate public key can be extracted with:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl x509 -in test/testx509.pem -pubkey -noout &gt;pubkey.pem</code></div>
</blockquote>
<div class="spacer">
</div>
The signature can be analysed with:<div class="spacer">
</div>
<code class="lit">&#160;$ openssl rsautl -in sig -verify -asn1parse -inkey pubkey.pem -pubin</code><div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
    0:d=0  hl=2 l=  32 cons: SEQUENCE 
    2:d=1  hl=2 l=  12 cons:  SEQUENCE 
    4:d=2  hl=2 l=   8 prim:   OBJECT            :md5 
   14:d=2  hl=2 l=   0 prim:   NULL 
   16:d=1  hl=2 l=  16 prim:  OCTET STRING 
   0000 - f3 46 9e aa 1a 4a 73 c9-37 ea 93 00 48 25 08 b5  .F...Js.7...H%..</pre>
<div class="spacer">
</div>
This is the parsed version of an ASN1 <span class="emph">DigestInfo</span> structure. It can be seen that the digest used was MD5. The actual part of the certificate that was signed can be extracted with:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl asn1parse -in pca-cert.pem -out tbs -noout -strparse 4</code></div>
</blockquote>
<div class="spacer">
</div>
and its digest computed with:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl md5 -c tbs</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
MD5(tbs)= f3:46:9e:aa:1a:4a:73:c9:37:ea:93:00:48:25:08:b5</div>
</blockquote>
<div class="spacer">
</div>
which it can be seen agrees with the recovered value above.</div>
<div class="section">
<h1 id="x535f434c49454e54">S_CLIENT</h1><table class="synopsis">
<col style="width: 138.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl s_client</td>
<td>
[<span class="opt"><b class="flag">-4</b> |&#160;<b class="flag">-6</b></span>] [<span class="opt"><b class="flag">-bugs</b></span>] [<span class="opt"><b class="flag">-CAfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-CApath</b>&#160;<i class="arg">directory</i></span>] [<span class="opt"><b class="flag">-cert</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-check_ss_sig</b></span>] [<span class="opt"><b class="flag">-cipher</b>&#160;<i class="arg">cipherlist</i></span>] [<span class="opt"><b class="flag">-connect</b> <i class="arg">host</i>:<i class="arg">port</i>&#160;|&#160;<i class="arg">host</i>/<i class="arg">port</i></span>] [<span class="opt"><b class="flag">-crl_check</b></span>] [<span class="opt"><b class="flag">-crl_check_all</b></span>] [<span class="opt"><b class="flag">-crlf</b></span>] [<span class="opt"><b class="flag">-debug</b></span>] [<span class="opt"><b class="flag">-extended_crl</b></span>] [<span class="opt"><b class="flag">-ign_eof</b></span>] [<span class="opt"><b class="flag">-ignore_critical</b></span>] [<span class="opt"><b class="flag">-issuer_checks</b></span>] [<span class="opt"><b class="flag">-key</b>&#160;<i class="arg">keyfile</i></span>] [<span class="opt"><b class="flag">-msg</b></span>] [<span class="opt"><b class="flag">-nbio</b></span>] [<span class="opt"><b class="flag">-nbio_test</b></span>] [<span class="opt"><b class="flag">-no_ticket</b></span>] [<span class="opt"><b class="flag">-no_tls1</b></span>] [<span class="opt"><b class="flag">-no_tls1_1</b></span>] [<span class="opt"><b class="flag">-no_tls1_2</b></span>] [<span class="opt"><b class="flag">-pause</b></span>] [<span class="opt"><b class="flag">-policy_check</b></span>] [<span class="opt"><b class="flag">-prexit</b></span>] [<span class="opt"><b class="flag">-proxy</b>&#160;<i class="arg">host</i>:<i class="arg">port</i></span>] [<span class="opt"><b class="flag">-psk</b>&#160;<i class="arg">key</i></span>] [<span class="opt"><b class="flag">-psk_identity</b>&#160;<i class="arg">identity</i></span>] [<span class="opt"><b class="flag">-quiet</b></span>] [<span class="opt"><b class="flag">-reconnect</b></span>] [<span class="opt"><b class="flag">-servername</b>&#160;<i class="arg">name</i></span>] [<span class="opt"><b class="flag">-showcerts</b></span>] [<span class="opt"><b class="flag">-starttls</b>&#160;<i class="arg">protocol</i></span>] [<span class="opt"><b class="flag">-state</b></span>] [<span class="opt"><b class="flag">-tls1</b></span>] [<span class="opt"><b class="flag">-tls1_1</b></span>] [<span class="opt"><b class="flag">-tls1_2</b></span>] [<span class="opt"><b class="flag">-tlsextdebug</b></span>] [<span class="opt"><b class="flag">-verify</b>&#160;<i class="arg">depth</i></span>] [<span class="opt"><b class="flag">-x509_strict</b></span>] [<span class="opt"><b class="flag">-xmpphost</b>&#160;<i class="arg">host</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">s_client</b> command implements a generic SSL/TLS client which connects to a remote host using SSL/TLS. It is a <span class="emph">very</span> useful diagnostic tool for SSL servers.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-4</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify that <b class="name">s_client</b> should attempt connections using IPv4 only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-6</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify that <b class="name">s_client</b> should attempt connections using IPv6 only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-bugs</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
There are several known bugs in SSL and TLS implementations. Adding this option enables various workarounds.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A <i class="arg">file</i> containing trusted certificates to use during server authentication and to use when attempting to build the client certificate chain.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CApath</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <i class="arg">directory</i> to use for server certificate verification. This directory must be in &#8220;hash format&#8221;; see <b class="flag">-verify</b> for more information. These are also used when building the client certificate chain.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-cert</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The certificate to use, if one is requested by the server. The default is not to use a certificate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-check_ss_sig</b>, <b class="flag">-crl_check</b>, <b class="flag">-crl_check_all</b>, <b class="flag">-extended_crl</b>, <b class="flag">-ignore_critical</b>, <b class="flag">-issuer_checks</b>, <b class="flag">-policy_check</b>, <b class="flag">-x509_strict</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set various certificate chain validation options. See the <b class="name">VERIFY</b> command for details.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-cipher</b> <i class="arg">cipherlist</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This allows the cipher list sent by the client to be modified. Although the server determines which cipher suite is used, it should take the first supported cipher in the list sent by the client. See the <i class="link-sec"><a class="link-sec" href="#x43495048455253">CIPHERS</a></i> section above for more information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-connect</b> <i class="arg">host</i>:<i class="arg">port</i> | <i class="arg">host</i>/<i class="arg">port</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the <i class="arg">host</i> and optional <i class="arg">port</i> to connect to. If not specified, an attempt is made to connect to the local host on port 4433. Alternatively, the host and port pair may be separated using a forward-slash character. This form is useful for numeric IPv6 addresses.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crlf</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option translates a line feed from the terminal into CR+LF as required by some servers.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-debug</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print extensive debugging information including a hex dump of all traffic.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-ign_eof</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Inhibit shutting down the connection when end of file is reached in the input.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-key</b> <i class="arg">keyfile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The private key to use. If not specified, the certificate file will be used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-msg</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Show all protocol messages with hex dump.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nbio</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Turns on non-blocking I/O.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nbio_test</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Tests non-blocking I/O.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_tls1</b> | <b class="flag">-no_tls1_1</b> | <b class="flag">-no_tls1_2</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default, the initial handshake uses a method which should be compatible with servers supporting any version of TLS. These options disable the use of TLS1.0, 1.1, and 1.2, respectively.<div class="spacer">
</div>
Unfortunately there are a lot of ancient and broken servers in use which cannot handle this technique and will fail to connect.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_ticket</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable RFC 4507 session ticket support.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pause</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Pauses 1 second between each read and write call.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-prexit</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print session information when the program exits. This will always attempt to print out information even if the connection fails. Normally, information will only be printed out once if the connection succeeds. This option is useful because the cipher in use may be renegotiated or the connection may fail because a client certificate is required or is requested only after an attempt is made to access a certain URL. <span class="symb">Note</span>: the output produced by this option is not always accurate because a connection might never have been established.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-proxy</b> <i class="arg">host</i>:<i class="arg">port</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the HTTP proxy at <i class="arg">host</i> and <i class="arg">port</i>. The connection to the proxy is done in cleartext and the <b class="flag">-connect</b> argument is given to the proxy. If not specified, localhost is used as final destination. After that, switch the connection through the proxy to the destination to TLS.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-psk</b> <i class="arg">key</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the PSK key <i class="arg">key</i> when using a PSK cipher suite. The key is given as a hexadecimal number without the leading 0x, for example -psk 1a2b3c4d.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-psk_identity</b> <i class="arg">identity</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the PSK identity <i class="arg">identity</i> when using a PSK cipher suite.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-quiet</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Inhibit printing of session and certificate information. This implicitly turns on <b class="flag">-ign_eof</b> as well.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-reconnect</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Reconnects to the same server 5 times using the same session ID; this can be used as a test that session caching is working.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-servername</b> <i class="arg">name</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Include the TLS Server Name Indication (SNI) extension in the ClientHello message, using the specified server <i class="arg">name</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-showcerts</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Display the whole server certificate chain: normally only the server certificate itself is displayed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-starttls</b> <i class="arg">protocol</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Send the protocol-specific message(s) to switch to TLS for communication. <i class="arg">protocol</i> is a keyword for the intended protocol. Currently, the supported keywords are &#8220;ftp&#8221;, &#8220;imap&#8221;, &#8220;smtp&#8221;, &#8220;pop3&#8221;, and &#8220;xmpp&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-state</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prints out the SSL session states.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-tls1</b> | <b class="flag">-tls1_1</b> | <b class="flag">-tls1_2</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Permit only TLS1.0, 1.1, or 1.2, respectively.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-tlsextdebug</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print out a hex dump of any TLS extensions received from the server.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verify</b> <i class="arg">depth</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The verify <i class="arg">depth</i> to use. This specifies the maximum length of the server certificate chain and turns on server certificate verification. Currently the verify operation continues after errors so all the problems with a certificate chain can be seen. As a side effect the connection will never fail due to a server certificate verify failure.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-xmpphost</b> <i class="arg">hostname</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option, when used with <b class="flag">-starttls</b> <i class="arg">xmpp</i>, specifies the host for the &quot;to&quot; attribute of the stream element. If this option is not specified then the host specified with <b class="flag">-connect</b> will be used.</dd>
</dl>
</div>
<div class="section">
<h1 id="x535f434c49454e5420434f4e4e454354454420434f4d4d414e4453">S_CLIENT CONNECTED COMMANDS</h1> If a connection is established with an SSL server, any data received from the server is displayed and any key presses will be sent to the server. When used interactively (which means neither <b class="flag">-quiet</b> nor <b class="flag">-ign_eof</b> have been given), the session will be renegotiated if the line begins with an <span class="emph">R</span>; if the line begins with a <span class="emph">Q</span> or if end of file is reached, the connection will be closed down.</div>
<div class="section">
<h1 id="x535f434c49454e54204e4f544553">S_CLIENT NOTES</h1> <b class="name">s_client</b> can be used to debug SSL servers. To connect to an SSL HTTP server the command:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl s_client -connect servername:443</code></div>
</blockquote>
<div class="spacer">
</div>
would typically be used (HTTPS uses port 443). If the connection succeeds, an HTTP command can be given such as &#8220;GET&#8221; to retrieve a web page.<div class="spacer">
</div>
If the handshake fails, there are several possible causes; if it is nothing obvious like no client certificate, then the <b class="flag">-bugs</b>, <b class="flag">-tls1</b>, <b class="flag">-tls1_1,</b> <b class="flag">-tls1_2</b>, <b class="flag">-no_tls1</b>, <b class="flag">-no_tls1_1</b>, and <b class="flag">-no_tls1_2</b> options can be tried in case it is a buggy server.<div class="spacer">
</div>
A frequent problem when attempting to get client certificates working is that a web client complains it has no certificates or gives an empty list to choose from. This is normally because the server is not sending the client's certificate authority in its &#8220;acceptable CA list&#8221; when it requests a certificate. By using <b class="name">s_client</b> the CA list can be viewed and checked. However some servers only request client authentication after a specific URL is requested. To obtain the list in this case it is necessary to use the <b class="flag">-prexit</b> option and send an HTTP request for an appropriate page.<div class="spacer">
</div>
If a certificate is specified on the command line using the <b class="flag">-cert</b> option, it will not be used unless the server specifically requests a client certificate. Therefore merely including a client certificate on the command line is no guarantee that the certificate works.<div class="spacer">
</div>
If there are problems verifying a server certificate, the <b class="flag">-showcerts</b> option can be used to show the whole chain.<div class="spacer">
</div>
Compression methods are only supported for <b class="flag">-tls1</b>.</div>
<div class="section">
<h1 id="x535f434c49454e542042554753">S_CLIENT BUGS</h1> Because this program has a lot of options and also because some of the techniques used are rather old, the C source of <b class="name">s_client</b> is rather hard to read and not a model of how things should be done. A typical SSL client program would be much simpler.<div class="spacer">
</div>
The <b class="flag">-verify</b> option should really exit if the server verification fails.<div class="spacer">
</div>
The <b class="flag">-prexit</b> option is a bit of a hack. We should really report information whenever a session is renegotiated.</div>
<div class="section">
<h1 id="x535f534552564552">S_SERVER</h1><table class="synopsis">
<col style="width: 106.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl s_server</td>
<td>
[<span class="opt"><b class="flag">-accept</b> <i class="arg">port</i></span>] [<span class="opt"><b class="flag">-bugs</b></span>] [<span class="opt"><b class="flag">-CAfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-CApath</b>&#160;<i class="arg">directory</i></span>] [<span class="opt"><b class="flag">-cert</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-cipher</b>&#160;<i class="arg">cipherlist</i></span>] [<span class="opt"><b class="flag">-context</b>&#160;<i class="arg">id</i></span>] [<span class="opt"><b class="flag">-crl_check</b></span>] [<span class="opt"><b class="flag">-crl_check_all</b></span>] [<span class="opt"><b class="flag">-crlf</b></span>] [<span class="opt"><b class="flag">-dcert</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-debug</b></span>] [<span class="opt"><b class="flag">-dhparam</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-dkey</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-hack</b></span>] [<span class="opt"><b class="flag">-HTTP</b></span>] [<span class="opt"><b class="flag">-id_prefix</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-key</b>&#160;<i class="arg">keyfile</i></span>] [<span class="opt"><b class="flag">-msg</b></span>] [<span class="opt"><b class="flag">-nbio</b></span>] [<span class="opt"><b class="flag">-nbio_test</b></span>] [<span class="opt"><b class="flag">-no_dhe</b></span>] [<span class="opt"><b class="flag">-no_tls1</b></span>] [<span class="opt"><b class="flag">-no_tls1_1</b></span>] [<span class="opt"><b class="flag">-no_tls1_2</b></span>] [<span class="opt"><b class="flag">-no_tmp_rsa</b></span>] [<span class="opt"><b class="flag">-nocert</b></span>] [<span class="opt"><b class="flag">-psk</b>&#160;<i class="arg">key</i></span>] [<span class="opt"><b class="flag">-psk_hint</b>&#160;<i class="arg">hint</i></span>] [<span class="opt"><b class="flag">-quiet</b></span>] [<span class="opt"><b class="flag">-serverpref</b></span>] [<span class="opt"><b class="flag">-state</b></span>] [<span class="opt"><b class="flag">-tls1</b></span>] [<span class="opt"><b class="flag">-tls1_1</b></span>] [<span class="opt"><b class="flag">-tls1_2</b></span>] [<span class="opt"><b class="flag">-Verify</b>&#160;<i class="arg">depth</i></span>] [<span class="opt"><b class="flag">-verify</b>&#160;<i class="arg">depth</i></span>] [<span class="opt"><b class="flag">-WWW</b></span>] [<span class="opt"><b class="flag">-www</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">s_server</b> command implements a generic SSL/TLS server which listens for connections on a given port using SSL/TLS.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-accept</b> <i class="arg">port</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The TCP <i class="arg">port</i> to listen on for connections. If not specified, 4433 is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-bugs</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
There are several known bugs in SSL and TLS implementations. Adding this option enables various workarounds.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A file containing trusted certificates to use during client authentication and to use when attempting to build the server certificate chain. The list is also used in the list of acceptable client CAs passed to the client when a certificate is requested.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CApath</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <i class="arg">directory</i> to use for client certificate verification. This directory must be in &#8220;hash format&#8221;; see <b class="flag">-verify</b> for more information. These are also used when building the server certificate chain.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-cert</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The certificate to use; most server's cipher suites require the use of a certificate and some require a certificate with a certain public key type: for example the DSS cipher suites require a certificate containing a DSS (DSA) key. If not specified, the file <i class="file">server.pem</i> will be used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-cipher</b> <i class="arg">cipherlist</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This allows the cipher list used by the server to be modified. When the client sends a list of supported ciphers, the first client cipher also included in the server list is used. Because the client specifies the preference order, the order of the server cipherlist is irrelevant. See the <i class="link-sec"><a class="link-sec" href="#x43495048455253">CIPHERS</a></i> section for more information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-context</b> <i class="arg">id</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Sets the SSL context ID. It can be given any string value. If this option is not present, a default value will be used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crl_check</b>, <b class="flag">-crl_check_all</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Check the peer certificate has not been revoked by its CA. The CRLs are appended to the certificate file. With the <b class="flag">-crl_check_all</b> option, all CRLs of all CAs in the chain are checked.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crlf</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option translates a line feed from the terminal into CR+LF.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-dcert</b> <i class="arg">file</i>, <b class="flag">-dkey</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify an additional certificate and private key; these behave in the same manner as the <b class="flag">-cert</b> and <b class="flag">-key</b> options except there is no default if they are not specified (no additional certificate or key is used). As noted above some cipher suites require a certificate containing a key of a certain type. Some cipher suites need a certificate carrying an RSA key and some a DSS (DSA) key. By using RSA and DSS certificates and keys, a server can support clients which only support RSA or DSS cipher suites by using an appropriate certificate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-debug</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print extensive debugging information including a hex dump of all traffic.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-dhparam</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The DH parameter file to use. The ephemeral DH cipher suites generate keys using a set of DH parameters. If not specified, an attempt is made to load the parameters from the server certificate file. If this fails, a static set of parameters hard coded into the <b class="name">s_server</b> program will be used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-hack</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option enables a further workaround for some early Netscape SSL code (?).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-HTTP</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Emulates a simple web server. Pages will be resolved relative to the current directory; for example if the URL <i class="file">https://myhost/page.html</i> is requested, the file <i class="file">./page.html</i> will be loaded. The files loaded are assumed to contain a complete and correct HTTP response (lines that are part of the HTTP response line and headers must end with CRLF).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-id_prefix</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate SSL/TLS session IDs prefixed by <i class="arg">arg</i>. This is mostly useful for testing any SSL/TLS code (e.g. proxies) that wish to deal with multiple servers, when each of which might be generating a unique range of session IDs (e.g. with a certain prefix).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-key</b> <i class="arg">keyfile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The private key to use. If not specified, the certificate file will be used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-msg</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Show all protocol messages with hex dump.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nbio</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Turns on non-blocking I/O.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nbio_test</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Tests non-blocking I/O.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_dhe</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If this option is set, no DH parameters will be loaded, effectively disabling the ephemeral DH cipher suites.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_tls1</b> | <b class="flag">-no_tls1_1</b> | <b class="flag">-no_tls1_2</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default, the initial handshake uses a method which should be compatible with clients supporting any version of TLS. These options disable the use of TLS1.0, 1.1, and 1.2, respectively.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_tmp_rsa</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Certain export cipher suites sometimes use a temporary RSA key; this option disables temporary RSA key generation.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nocert</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If this option is set, no certificate is used. This restricts the cipher suites available to the anonymous ones (currently just anonymous DH).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-psk</b> <i class="arg">key</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the PSK key <i class="arg">key</i> when using a PSK cipher suite. The key is given as a hexadecimal number without the leading 0x, for example -psk 1a2b3c4d.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-psk_hint</b> <i class="arg">hint</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the PSK identity hint <i class="arg">hint</i> when using a PSK cipher suite.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-quiet</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Inhibit printing of session and certificate information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-serverpref</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use server's cipher preferences.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-state</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prints out the SSL session states.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-tls1</b> | <b class="flag">-tls1_1</b> | <b class="flag">-tls1_2</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Permit only TLS1.0, 1.1, or 1.2, respectively.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-WWW</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Emulates a simple web server. Pages will be resolved relative to the current directory; for example if the URL <i class="file">https://myhost/page.html</i> is requested, the file <i class="file">./page.html</i> will be loaded.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-www</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Sends a status message back to the client when it connects. This includes lots of information about the ciphers used and various session parameters. The output is in HTML format so this option will normally be used with a web browser.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-Verify</b> <i class="arg">depth</i>, <b class="flag">-verify</b> <i class="arg">depth</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The verify <i class="arg">depth</i> to use. This specifies the maximum length of the client certificate chain and makes the server request a certificate from the client. With the <b class="flag">-Verify</b> option, the client must supply a certificate or an error occurs. With the <b class="flag">-verify</b> option, a certificate is requested but the client does not have to send one.</dd>
</dl>
</div>
<div class="section">
<h1 id="x535f53455256455220434f4e4e454354454420434f4d4d414e4453">S_SERVER CONNECTED COMMANDS</h1> If a connection request is established with an SSL client and neither the <b class="flag">-www</b> nor the <b class="flag">-WWW</b> option has been used, then normally any data received from the client is displayed and any key presses will be sent to the client.<div class="spacer">
</div>
Certain single letter commands are also recognized which perform special operations: these are listed below.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">P</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Send some plain text down the underlying TCP connection: this should cause the client to disconnect due to a protocol violation.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">Q</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
End the current SSL connection and exit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">q</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
End the current SSL connection, but still accept new connections.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">R</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Renegotiate the SSL session and request a client certificate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">r</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Renegotiate the SSL session.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">S</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Print out some session cache status information.</dd>
</dl>
</div>
<div class="section">
<h1 id="x535f534552564552204e4f544553">S_SERVER NOTES</h1> <b class="name">s_server</b> can be used to debug SSL clients. To accept connections from a web browser the command:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl s_server -accept 443 -www</code></div>
</blockquote>
<div class="spacer">
</div>
can be used, for example.<div class="spacer">
</div>
Most web browsers (in particular Netscape and MSIE) only support RSA cipher suites, so they cannot connect to servers which don't use a certificate carrying an RSA key or a version of <b class="name">OpenSSL</b> with RSA disabled.<div class="spacer">
</div>
Although specifying an empty list of CAs when requesting a client certificate is strictly speaking a protocol violation, some SSL clients interpret this to mean any CA is acceptable. This is useful for debugging purposes.<div class="spacer">
</div>
The session parameters can printed out using the <b class="name">sess_id</b> program.</div>
<div class="section">
<h1 id="x535f5345525645522042554753">S_SERVER BUGS</h1> Because this program has a lot of options and also because some of the techniques used are rather old, the C source of <b class="name">s_server</b> is rather hard to read and not a model of how things should be done. A typical SSL server program would be much simpler.<div class="spacer">
</div>
The output of common ciphers is wrong: it just gives the list of ciphers that <b class="name">OpenSSL</b> recognizes and the client supports.<div class="spacer">
</div>
There should be a way for the <b class="name">s_server</b> program to print out details of any unknown cipher suites a client says it supports.</div>
<div class="section">
<h1 id="x535f54494d45">S_TIME</h1><table class="synopsis">
<col style="width: 357.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl s_time</td>
<td>
[<span class="opt"><b class="flag">-bugs</b></span>] [<span class="opt"><b class="flag">-CAfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-CApath</b>&#160;<i class="arg">directory</i></span>] [<span class="opt"><b class="flag">-cert</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-cipher</b>&#160;<i class="arg">cipherlist</i></span>] [<span class="opt"><b class="flag">-connect</b>&#160;<i class="arg">host</i>:<i class="arg">port</i></span>] [<span class="opt"><b class="flag">-key</b>&#160;<i class="arg">keyfile</i></span>] [<span class="opt"><b class="flag">-nbio</b></span>] [<span class="opt"><b class="flag">-new</b></span>] [<span class="opt"><b class="flag">-no_shutdown</b></span>] [<span class="opt"><b class="flag">-reuse</b></span>] [<span class="opt"><b class="flag">-time</b>&#160;<i class="arg">seconds</i></span>] [<span class="opt"><b class="flag">-verify</b>&#160;<i class="arg">depth</i></span>] [<span class="opt"><b class="flag">-www</b>&#160;<i class="arg">page</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">s_client</b> command implements a generic SSL/TLS client which connects to a remote host using SSL/TLS. It can request a page from the server and includes the time to transfer the payload data in its timing measurements. It measures the number of connections within a given timeframe, the amount of data transferred (if any), and calculates the average time spent for one connection.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-bugs</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
There are several known bugs in SSL and TLS implementations. Adding this option enables various workarounds.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A file containing trusted certificates to use during server authentication and to use when attempting to build the client certificate chain.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CApath</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The directory to use for server certificate verification. This directory must be in &#8220;hash format&#8221;; see <b class="name">verify</b> for more information. These are also used when building the client certificate chain.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-cert</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The certificate to use, if one is requested by the server. The default is not to use a certificate. The file is in PEM format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-cipher</b> <i class="arg">cipherlist</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This allows the cipher list sent by the client to be modified. Although the server determines which cipher suite is used, it should take the first supported cipher in the list sent by the client. See the <b class="name">ciphers</b> command for more information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-connect</b> <i class="arg">host</i>:<i class="arg">port</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the host and optional port to connect to.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-key</b> <i class="arg">keyfile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The private key to use. If not specified, the certificate file will be used. The file is in PEM format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nbio</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Turns on non-blocking I/O.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-new</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Performs the timing test using a new session ID for each connection. If neither <b class="flag">-new</b> nor <b class="flag">-reuse</b> are specified, they are both on by default and executed in sequence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_shutdown</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Shut down the connection without sending a &#8220;close notify&#8221; shutdown alert to the server.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-reuse</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Performs the timing test using the same session ID; this can be used as a test that session caching is working. If neither <b class="flag">-new</b> nor <b class="flag">-reuse</b> are specified, they are both on by default and executed in sequence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-time</b> <i class="arg">seconds</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies how long (in seconds) <b class="name">s_time</b> should establish connections and optionally transfer payload data from a server. The default is 30 seconds. Server and client performance and the link speed determine how many connections <b class="name">s_time</b> can establish.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verify</b> <i class="arg">depth</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The verify depth to use. This specifies the maximum length of the server certificate chain and turns on server certificate verification. Currently the verify operation continues after errors, so all the problems with a certificate chain can be seen. As a side effect, the connection will never fail due to a server certificate verify failure.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-www</b> <i class="arg">page</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the page to GET from the server. A value of &#8216;/&#8217; gets the index.htm[l] page. If this parameter is not specified, <b class="name">s_time</b> will only perform the handshake to establish SSL connections but not transfer any payload data.</dd>
</dl>
</div>
<div class="section">
<h1 id="x535f54494d45204e4f544553">S_TIME NOTES</h1> <b class="name">s_client</b> can be used to measure the performance of an SSL connection. To connect to an SSL HTTP server and get the default page the command<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl s_time -connect servername:443 -www / -CApath yourdir \ 
	-CAfile yourfile.pem -cipher commoncipher</pre>
<div class="spacer">
</div>
would typically be used (HTTPS uses port 443). &#8220;commoncipher&#8221; is a cipher to which both client and server can agree; see the <b class="name">ciphers</b> command for details.<div class="spacer">
</div>
If the handshake fails, there are several possible causes: if it is nothing obvious like no client certificate, the <b class="flag">-bugs</b> option can be tried in case it is a buggy server.<div class="spacer">
</div>
A frequent problem when attempting to get client certificates working is that a web client complains it has no certificates or gives an empty list to choose from. This is normally because the server is not sending the clients certificate authority in its &#8220;acceptable CA list&#8221; when it requests a certificate. By using <b class="name">s_client</b>, the CA list can be viewed and checked. However some servers only request client authentication after a specific URL is requested. To obtain the list in this case, it is necessary to use the <b class="flag">-prexit</b> option of <b class="name">s_client</b> and send an HTTP request for an appropriate page.<div class="spacer">
</div>
If a certificate is specified on the command line using the <b class="flag">-cert</b> option, it will not be used unless the server specifically requests a client certificate. Therefore merely including a client certificate on the command line is no guarantee that the certificate works.</div>
<div class="section">
<h1 id="x535f54494d452042554753">S_TIME BUGS</h1> Because this program does not have all the options of the <b class="name">s_client</b> program to turn protocols on and off, you may not be able to measure the performance of all protocols with all servers.<div class="spacer">
</div>
The <b class="flag">-verify</b> option should really exit if the server verification fails.</div>
<div class="section">
<h1 id="x534553535f4944">SESS_ID</h1><table class="synopsis">
<col style="width: 268.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl sess_id</td>
<td>
[<span class="opt"><b class="flag">-cert</b></span>] [<span class="opt"><b class="flag">-context</b>&#160;<i class="arg">ID</i></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-text</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">sess_id</b> program processes the encoded version of the SSL session structure and optionally prints out SSL session details (for example the SSL session master key) in human readable format. Since this is a diagnostic tool that needs some knowledge of the SSL protocol to use properly, most users will not need to use it.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-cert</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If a certificate is present in the session, it will be output using this option; if the <b class="flag">-text</b> option is also present, then it will be printed out in text form.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-context</b> <i class="arg">ID</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option can set the session ID so the output session information uses the supplied <i class="arg">ID</i>. The <i class="arg">ID</i> can be any string of characters. This option won't normally be used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input <i class="arg">file</i> to read session information from, or standard input by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input format. The <i class="arg">DER</i> argument uses an ASN1 DER-encoded format containing session details. The precise format can vary from one version to the next. The <i class="arg">PEM</i> form is the default format: it consists of the DER format base64-encoded with additional header and footer lines.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option prevents output of the encoded version of the session.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output <i class="arg">file</i> to write session information to, or standard output if this option is not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the output format; the options have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prints out the various public or private key components in plain text in addition to the encoded version.</dd>
</dl>
</div>
<div class="section">
<h1 id="x534553535f4944204f5554505554">SESS_ID OUTPUT</h1> Typical output:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
SSL-Session: 
    Protocol  : TLSv1 
    Cipher    : 0016 
    Session-ID: 871E62626C554CE95488823752CBD5F3673A3EF3DCE9C67BD916C809914B40ED 
    Session-ID-ctx: 01000000 
    Master-Key: A7CEFC571974BE02CAC305269DC59F76EA9F0B180CB6642697A68251F2D2BB57E51DBBB4C7885573192AE9AEE220FACD 
    Key-Arg   : None 
    Start Time: 948459261 
    Timeout   : 300 (sec) 
    Verify return code 0 (ok)</pre>
<div class="spacer">
</div>
These are described below in more detail.<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">Protocol</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
This is the protocol in use.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">Cipher</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
The cipher used is the actual raw SSL or TLS cipher code; see the SSL or TLS specifications for more information.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">Session-ID</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
The SSL session ID in hex format.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">Session-ID-ctx</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
The session ID context in hex format.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">Master-Key</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
This is the SSL session master key.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">Key-Arg</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
The key argument; this is only used in SSL v2.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">Start Time</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
This is the session start time, represented as an integer in standard <span class="unix">UNIX</span> format.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">Timeout</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
The timeout in seconds.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">Verify return code</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
This is the return code when an SSL client certificate is verified.</dd>
</dl>
</div>
<div class="section">
<h1 id="x534553535f4944204e4f544553">SESS_ID NOTES</h1> The PEM-encoded session format uses the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN SSL SESSION PARAMETERS----- 
-----END SSL SESSION PARAMETERS-----</pre>
<div class="spacer">
</div>
Since the SSL session output contains the master key, it is possible to read the contents of an encrypted session using this information. Therefore appropriate security precautions should be taken if the information is being output by a &#8220;real&#8221; application. This is, however, strongly discouraged and should only be used for debugging purposes.</div>
<div class="section">
<h1 id="x534553535f49442042554753">SESS_ID BUGS</h1> The cipher and start time should be printed out in human readable form.</div>
<div class="section">
<h1 id="x534d494d45">SMIME</h1><table class="synopsis">
<col style="width: 73.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl smime</td>
<td>
[<span class="opt"><b class="flag">-aes128</b> |&#160;<b class="flag">-aes192</b>&#160;|&#160;<b class="flag">-aes256</b>&#160;|&#160;<b class="flag">-des</b>&#160;|&#160;<b class="flag">-des3</b> |&#160;<b class="flag">-rc2-40</b>&#160;|&#160;<b class="flag">-rc2-64</b>&#160;|&#160;<b class="flag">-rc2-128</b></span>] [<span class="opt"><b class="flag">-binary</b></span>] [<span class="opt"><b class="flag">-CAfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-CApath</b>&#160;<i class="arg">directory</i></span>] [<span class="opt"><b class="flag">-certfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-check_ss_sig</b></span>] [<span class="opt"><b class="flag">-content</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-crl_check</b></span>] [<span class="opt"><b class="flag">-crl_check_all</b></span>] [<span class="opt"><b class="flag">-decrypt</b></span>] [<span class="opt"><b class="flag">-encrypt</b></span>] [<span class="opt"><b class="flag">-extended_crl</b></span>] [<span class="opt"><b class="flag">-from</b>&#160;<i class="arg">addr</i></span>] [<span class="opt"><b class="flag">-ignore_critical</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-indef</b></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i>&#160;|&#160;<i class="arg">SMIME</i></span>] [<span class="opt"><b class="flag">-inkey</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-issuer_checks</b></span>] [<span class="opt"><b class="flag">-keyform</b>&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-md</b>&#160;<i class="arg">digest</i></span>] [<span class="opt"><b class="flag">-noattr</b></span>] [<span class="opt"><b class="flag">-nocerts</b></span>] [<span class="opt"><b class="flag">-nochain</b></span>] [<span class="opt"><b class="flag">-nodetach</b></span>] [<span class="opt"><b class="flag">-noindef</b></span>] [<span class="opt"><b class="flag">-nointern</b></span>] [<span class="opt"><b class="flag">-nosigs</b></span>] [<span class="opt"><b class="flag">-noverify</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i>&#160;|&#160;<i class="arg">SMIME</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-pk7out</b></span>] [<span class="opt"><b class="flag">-policy_check</b></span>] [<span class="opt"><b class="flag">-recip</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-resign</b></span>] [<span class="opt"><b class="flag">-sign</b></span>] [<span class="opt"><b class="flag">-signer</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-stream</b></span>] [<span class="opt"><b class="flag">-subject</b>&#160;<i class="arg">s</i></span>] [<span class="opt"><b class="flag">-text</b></span>] [<span class="opt"><b class="flag">-to</b>&#160;<i class="arg">addr</i></span>] [<span class="opt"><b class="flag">-verify</b></span>] [<span class="opt"><b class="flag">-x509_strict</b></span>] [<span class="opt"><i class="arg">cert.pem&#160;...</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">smime</b> command handles <span class="emph">S/MIME</span> mail. It can encrypt, decrypt, sign, and verify <span class="emph">S/MIME</span> messages.</tr>
</tbody>
</table>
<div class="spacer">
</div>
There are six operation options that set the type of operation to be performed. The meaning of the other options varies according to the operation type.<div class="spacer">
</div>
The six operation options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-decrypt</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Decrypt mail using the supplied certificate and private key. Expects an encrypted mail message in <span class="emph">MIME</span> format for the input file. The decrypted mail is written to the output file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-encrypt</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Encrypt mail for the given recipient certificates. Input file is the message to be encrypted. The output file is the encrypted mail in <span class="emph">MIME</span> format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pk7out</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Takes an input message and writes out a PEM-encoded PKCS#7 structure.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-resign</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Resign a message: take an existing message and one or more new signers.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-sign</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Sign mail using the supplied certificate and private key. Input file is the message to be signed. The signed message in <span class="emph">MIME</span> format is written to the output file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verify</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Verify signed mail. Expects a signed mail message on input and outputs the signed data. Both clear text and opaque signing is supported.</dd>
</dl>
<div class="spacer">
</div>
The remaining options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-aes128</b> | <b class="flag">-aes192</b> | <b class="flag">-aes256</b> | <b class="flag">-des</b> | <b class="flag">-des3</b> | <b class="flag">-rc2-40</b> | <b class="flag">-rc2-64</b> | <b class="flag">-rc2-128</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The encryption algorithm to use. 128-, 192-, or 256-bit AES, DES (56 bits), triple DES (168 bits), or 40-, 64-, or 128-bit RC2, respectively; if not specified, 40-bit RC2 is used. Only used with <b class="flag">-encrypt</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-binary</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Normally, the input message is converted to &#8220;canonical&#8221; format which is effectively using CR and LF as end of line - as required by the <span class="emph">S/MIME</span> specification. When this option is present no translation occurs. This is useful when handling binary data which may not be in <span class="emph">MIME</span> format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A <i class="arg">file</i> containing trusted CA certificates; only used with <b class="flag">-verify</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CApath</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A <i class="arg">directory</i> containing trusted CA certificates; only used with <b class="flag">-verify</b>. This directory must be a standard certificate directory: that is, a hash of each subject name (using <b class="name">x509 -hash</b>) should be linked to each certificate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">cert.pem ...</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
One or more certificates of message recipients: used when encrypting a message.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-certfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Allows additional certificates to be specified. When signing, these will be included with the message. When verifying, these will be searched for the signers' certificates. The certificates should be in PEM format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-check_ss_sig</b>, <b class="flag">-crl_check</b>, <b class="flag">-crl_check_all</b>, <b class="flag">-extended_crl</b>, <b class="flag">-ignore_critical</b>, <b class="flag">-issuer_checks</b>, <b class="flag">-policy_check</b>, <b class="flag">-x509_strict</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Set various certificate chain validation options. See the <b class="name">VERIFY</b> command for details.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-content</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies a file containing the detached content. This is only useful with the <b class="flag">-verify</b> command. This is only usable if the PKCS#7 structure is using the detached signature form where the content is not included. This option will override any content if the input format is <span class="emph">S/MIME</span> and it uses the multipart/signed <span class="emph">MIME</span> content type.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-from</b> <i class="arg">addr</i>, <b class="flag">-subject</b> <i class="arg">s</i>, <b class="flag">-to</b> <i class="arg">addr</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The relevant mail headers. These are included outside the signed portion of a message so they may be included manually. When signing, many <span class="emph">S/MIME</span> mail clients check that the signer's certificate email address matches the From: address.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The input message to be encrypted or signed or the <span class="emph">MIME</span> message to be decrypted or verified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-indef</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Enable streaming I/O for encoding operations. This permits single pass processing of data without the need to hold the entire contents in memory, potentially supporting very large files. Streaming is automatically set for S/MIME signing with detached data if the output format is SMIME; it is currently off by default for all other operations.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">PEM</i> | <i class="arg">SMIME</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the input format for the PKCS#7 structure. The default is <span class="emph">SMIME</span>, which reads an <span class="emph">S/MIME</span> format message. <i class="arg">PEM</i> and <i class="arg">DER</i> format change this to expect PEM and DER format PKCS#7 structures instead. This currently only affects the input format of the PKCS#7 structure; if no PKCS#7 structure is being input (for example with <b class="flag">-encrypt</b> or <b class="flag">-sign</b>), this option has no effect.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inkey</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The private key to use when signing or decrypting. This must match the corresponding certificate. If this option is not specified, the private key must be included in the certificate file specified with the <b class="flag">-recip</b> or <b class="flag">-signer</b> file. When signing, this option can be used multiple times to specify successive keys.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-keyform</b> <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Input private key format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-md</b> <i class="arg">digest</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The digest algorithm to use when signing or resigning. If not present then the default digest algorithm for the signing key is used (usually SHA1).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noattr</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Normally, when a message is signed a set of attributes are included which include the signing time and supported symmetric algorithms. With this option they are not included.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nocerts</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
When signing a message, the signer's certificate is normally included; with this option it is excluded. This will reduce the size of the signed message but the verifier must have a copy of the signer's certificate available locally (passed using the <b class="flag">-certfile</b> option, for example).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nochain</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Do not do chain verification of signers' certificates: that is, don't use the certificates in the signed message as untrusted CAs.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nodetach</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
When signing a message use opaque signing: this form is more resistant to translation by mail relays but it cannot be read by mail agents that do not support <span class="emph">S/MIME</span>. Without this option cleartext signing with the <span class="emph">MIME</span> type multipart/signed is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noindef</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Disable streaming I/O where it would produce an encoding of indefinite length. This option currently has no effect. In future streaming will be enabled by default on all relevant operations and this option will disable it.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nointern</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
When verifying a message, normally certificates (if any) included in the message are searched for the signing certificate. With this option, only the certificates specified in the <b class="flag">-certfile</b> option are used. The supplied certificates can still be used as untrusted CAs however.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nosigs</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't try to verify the signatures on the message.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noverify</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Do not verify the signer's certificate of a signed message.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The message text that has been decrypted or verified, or the output <span class="emph">MIME</span> format message that has been signed or verified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">PEM</i> | <i class="arg">SMIME</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the output format for the PKCS#7 structure. The default is <span class="emph">SMIME</span>, which writes an <span class="emph">S/MIME</span> format message. <i class="arg">PEM</i> and <i class="arg">DER</i> format change this to write PEM and DER format PKCS#7 structures instead. This currently only affects the output format of the PKCS#7 structure; if no PKCS#7 structure is being output (for example with <b class="flag">-verify</b> or <b class="flag">-decrypt</b>) this option has no effect.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-recip</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The recipients certificate when decrypting a message. This certificate must match one of the recipients of the message or an error occurs.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-signer</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A signing certificate when signing or resigning a message; this option can be used multiple times if more than one signer is required. If a message is being verified, the signer's certificates will be written to this file if the verification was successful.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-stream</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The same as <b class="flag">-indef</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option adds plain text (text/plain) <span class="emph">MIME</span> headers to the supplied message if encrypting or signing. If decrypting or verifying, it strips off text headers: if the decrypted or verified message is not of <span class="emph">MIME</span> type text/plain then an error occurs.</dd>
</dl>
</div>
<div class="section">
<h1 id="x534d494d45204e4f544553">SMIME NOTES</h1> The <span class="emph">MIME</span> message must be sent without any blank lines between the headers and the output. Some mail programs will automatically add a blank line. Piping the mail directly to an MTA is one way to achieve the correct format.<div class="spacer">
</div>
The supplied message to be signed or encrypted must include the necessary <span class="emph">MIME</span> headers or many <span class="emph">S/MIME</span> clients won't display it properly (if at all). You can use the <b class="flag">-text</b> option to automatically add plain text headers.<div class="spacer">
</div>
A &#8220;signed and encrypted&#8221; message is one where a signed message is then encrypted. This can be produced by encrypting an already signed message: see the <i class="link-sec"><a class="link-sec" href="#x534d494d45204558414d504c4553">SMIME EXAMPLES</a></i> section.<div class="spacer">
</div>
This version of the program only allows one signer per message, but it will verify multiple signers on received messages. Some <span class="emph">S/MIME</span> clients choke if a message contains multiple signers. It is possible to sign messages &#8220;in parallel&#8221; by signing an already signed message.<div class="spacer">
</div>
The options <b class="flag">-encrypt</b> and <b class="flag">-decrypt</b> reflect common usage in <span class="emph">S/MIME</span> clients. Strictly speaking these process PKCS#7 enveloped data: PKCS#7 encrypted data is used for other purposes.<div class="spacer">
</div>
The <b class="flag">-resign</b> option uses an existing message digest when adding a new signer. This means that attributes must be present in at least one existing signer using the same message digest or this operation will fail.<div class="spacer">
</div>
The <b class="flag">-stream</b> and <b class="flag">-indef</b> options enable experimental streaming I/O support. As a result the encoding is BER using indefinite length constructed encoding and no longer DER. Streaming is supported for the <b class="flag">-encrypt</b> and <b class="flag">-sign</b> operations if the content is not detached.<div class="spacer">
</div>
Streaming is always used for the <b class="flag">-sign</b> operation with detached data but since the content is no longer part of the PKCS#7 structure the encoding remains DER.</div>
<div class="section">
<h1 id="x534d494d45204558495420434f444553">SMIME EXIT CODES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">0</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The operation was completely successful.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">1</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
An error occurred parsing the command options.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">2</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
One of the input files could not be read.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">3</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
An error occurred creating the PKCS#7 file or when reading the <span class="emph">MIME</span> message.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">4</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
An error occurred decrypting or verifying the message.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">5</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The message was verified correctly, but an error occurred writing out the signer's certificates.</dd>
</dl>
</div>
<div class="section">
<h1 id="x534d494d45204558414d504c4553">SMIME EXAMPLES</h1> Create a cleartext signed message:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl smime -sign -in message.txt -text -out mail.msg \ 
	-signer mycert.pem</pre>
<div class="spacer">
</div>
Create an opaque signed message:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl smime -sign -in message.txt -text -out mail.msg \ 
	-nodetach -signer mycert.pem</pre>
<div class="spacer">
</div>
Create a signed message, include some additional certificates and read the private key from another file:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl smime -sign -in in.txt -text -out mail.msg \ 
	-signer mycert.pem -inkey mykey.pem -certfile mycerts.pem</pre>
<div class="spacer">
</div>
Create a signed message with two signers:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
openssl smime -sign -in message.txt -text -out mail.msg \ 
	-signer mycert.pem -signer othercert.pem</pre>
<div class="spacer">
</div>
Send a signed message under <span class="unix">UNIX</span> directly to <a class="link-man" href="../html8/sendmail.html">sendmail(8)</a>, including headers:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl smime -sign -in in.txt -text -signer mycert.pem \ 
	-from steve@openssl.org -to someone@somewhere \ 
	-subject &quot;Signed message&quot; | sendmail someone@somewhere</pre>
<div class="spacer">
</div>
Verify a message and extract the signer's certificate if successful:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl smime -verify -in mail.msg -signer user.pem \ 
	-out signedtext.txt</pre>
<div class="spacer">
</div>
Send encrypted mail using triple DES:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl smime -encrypt -in in.txt -from steve@openssl.org \ 
	-to someone@somewhere -subject &quot;Encrypted message&quot; \ 
	-des3 -out mail.msg user.pem</pre>
<div class="spacer">
</div>
Sign and encrypt mail:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl smime -sign -in ml.txt -signer my.pem -text | \ 
	openssl smime -encrypt -out mail.msg \ 
	-from steve@openssl.org -to someone@somewhere \ 
	-subject &quot;Signed and Encrypted message&quot; -des3 user.pem</pre>
<div class="spacer">
</div>
<span class="symb">Note</span>: The encryption command does not include the <b class="flag">-text</b> option because the message being encrypted already has <span class="emph">MIME</span> headers.<div class="spacer">
</div>
Decrypt mail:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl smime -decrypt -in mail.msg -recip mycert.pem \ 
	-inkey key.pem&quot;</pre>
<div class="spacer">
</div>
The output from Netscape form signing is a PKCS#7 structure with the detached signature format. You can use this program to verify the signature by line wrapping the base64-encoded structure and surrounding it with:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN PKCS7----- 
-----END PKCS7-----</pre>
<div class="spacer">
</div>
and using the command:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl smime -verify -inform PEM -in signature.pem \ 
	-content content.txt</pre>
<div class="spacer">
</div>
Alternatively, you can base64 decode the signature and use:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl smime -verify -inform DER -in signature.der \ 
	-content content.txt</pre>
<div class="spacer">
</div>
Create an encrypted message using 128-bit AES:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
openssl smime -encrypt -in plain.txt -aes128 \ 
	-out mail.msg cert.pem</pre>
<div class="spacer">
</div>
Add a signer to an existing message:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
openssl smime -resign -in mail.msg -signer newsign.pem \ 
	-out mail2.msg</pre>
</div>
<div class="section">
<h1 id="x534d494d452042554753">SMIME BUGS</h1> The <span class="emph">MIME</span> parser isn't very clever: it seems to handle most messages that I've thrown at it, but it may choke on others.<div class="spacer">
</div>
The code currently will only write out the signer's certificate to a file: if the signer has a separate encryption certificate this must be manually extracted. There should be some heuristic that determines the correct encryption certificate.<div class="spacer">
</div>
Ideally, a database should be maintained of a certificate for each email address.<div class="spacer">
</div>
The code doesn't currently take note of the permitted symmetric encryption algorithms as supplied in the <span class="emph">SMIMECapabilities</span> signed attribute. This means the user has to manually include the correct encryption algorithm. It should store the list of permitted ciphers in a database and only use those.<div class="spacer">
</div>
No revocation checking is done on the signer's certificate.<div class="spacer">
</div>
The current code can only handle <span class="emph">S/MIME</span> v2 messages; the more complex <span class="emph">S/MIME</span> v3 structures may cause parsing errors.</div>
<div class="section">
<h1 id="x534d494d4520484953544f5259">SMIME HISTORY</h1> The use of multiple <b class="flag">-signer</b> options and the <b class="flag">-resign</b> command were first added in <b class="name">OpenSSL</b> 1.0.0.</div>
<div class="section">
<h1 id="x5350454544">SPEED</h1><table class="synopsis">
<col style="width: 71.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl speed</td>
<td>
[<span class="opt"><b class="flag">aes</b></span>] [<span class="opt"><b class="flag">aes-128-cbc</b></span>] [<span class="opt"><b class="flag">aes-192-cbc</b></span>] [<span class="opt"><b class="flag">aes-256-cbc</b></span>] [<span class="opt"><b class="flag">aes-128-gcm</b></span>] [<span class="opt"><b class="flag">aes-256-gcm</b></span>] [<span class="opt"><b class="flag">blowfish</b></span>] [<span class="opt"><b class="flag">bf-cbc</b></span>] [<span class="opt"><b class="flag">cast</b></span>] [<span class="opt"><b class="flag">cast-cbc</b></span>] [<span class="opt"><b class="flag">chacha20-poly1305</b></span>] [<span class="opt"><b class="flag">des</b></span>] [<span class="opt"><b class="flag">des-cbc</b></span>] [<span class="opt"><b class="flag">des-ede3</b></span>] [<span class="opt"><b class="flag">dsa</b></span>] [<span class="opt"><b class="flag">dsa512</b></span>] [<span class="opt"><b class="flag">dsa1024</b></span>] [<span class="opt"><b class="flag">dsa2048</b></span>] [<span class="opt"><b class="flag">hmac</b></span>] [<span class="opt"><b class="flag">md4</b></span>] [<span class="opt"><b class="flag">md5</b></span>] [<span class="opt"><b class="flag">rc2</b></span>] [<span class="opt"><b class="flag">rc2-cbc</b></span>] [<span class="opt"><b class="flag">rc4</b></span>] [<span class="opt"><b class="flag">rmd160</b></span>] [<span class="opt"><b class="flag">rsa</b></span>] [<span class="opt"><b class="flag">rsa512</b></span>] [<span class="opt"><b class="flag">rsa1024</b></span>] [<span class="opt"><b class="flag">rsa2048</b></span>] [<span class="opt"><b class="flag">rsa4096</b></span>] [<span class="opt"><b class="flag">sha1</b></span>] [<span class="opt"><b class="flag">-decrypt</b></span>] [<span class="opt"><b class="flag">-elapsed</b></span>] [<span class="opt"><b class="flag">-evp</b>&#160;<i class="arg">e</i></span>] [<span class="opt"><b class="flag">-mr</b></span>] [<span class="opt"><b class="flag">-multi</b>&#160;<i class="arg">number</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">speed</b> command is used to test the performance of cryptographic algorithms.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<b class="flag">zero or more test algorithms</b>]</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
If any options are given, <b class="name">speed</b> tests those algorithms, otherwise all of the above are tested.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-decrypt</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Time decryption instead of encryption (only EVP).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-elapsed</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Measure time in real time instead of CPU user time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-evp</b> <i class="arg">e</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Use EVP <i class="arg">e</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-mr</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Produce machine readable output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-multi</b> <i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Run <i class="arg">number</i> benchmarks in parallel.</dd>
</dl>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x5453">TS</h1><table class="synopsis">
<col style="width: 7.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl ts</td>
<td>
<b class="flag">-query</b> [<span class="opt"><b class="flag">-md4</b>&#160;|&#160;<b class="flag">-md5</b>&#160;|&#160;<b class="flag">-ripemd160</b>&#160;|&#160;<b class="flag">-sha1</b></span>] [<span class="opt"><b class="flag">-cert</b></span>] [<span class="opt"><b class="flag">-config</b>&#160;<i class="arg">configfile</i></span>] [<span class="opt"><b class="flag">-data</b>&#160;<i class="arg">file_to_hash</i></span>] [<span class="opt"><b class="flag">-digest</b>&#160;<i class="arg">digest_bytes</i></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">request.tsq</i></span>] [<span class="opt"><b class="flag">-no_nonce</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">request.tsq</i></span>] [<span class="opt"><b class="flag">-policy</b>&#160;<i class="arg">object_id</i></span>] [<span class="opt"><b class="flag">-text</b></span>]</td>
</tr>
</tbody>
</table>
<div class="spacer">
</div>
<br/>
<table class="synopsis">
<col style="width: 7.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl ts</td>
<td>
<b class="flag">-reply</b> [<span class="opt"><b class="flag">-chain</b>&#160;<i class="arg">certs_file.pem</i></span>] [<span class="opt"><b class="flag">-config</b>&#160;<i class="arg">configfile</i></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">response.tsr</i></span>] [<span class="opt"><b class="flag">-inkey</b>&#160;<i class="arg">private.pem</i></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">response.tsr</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-policy</b>&#160;<i class="arg">object_id</i></span>] [<span class="opt"><b class="flag">-queryfile</b>&#160;<i class="arg">request.tsq</i></span>] [<span class="opt"><b class="flag">-section</b>&#160;<i class="arg">tsa_section</i></span>] [<span class="opt"><b class="flag">-signer</b>&#160;<i class="arg">tsa_cert.pem</i></span>] [<span class="opt"><b class="flag">-text</b></span>] [<span class="opt"><b class="flag">-token_in</b></span>] [<span class="opt"><b class="flag">-token_out</b></span>]</td>
</tr>
</tbody>
</table>
<div class="spacer">
</div>
<br/>
<table class="synopsis">
<col style="width: 318.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl ts</td>
<td>
<b class="flag">-verify</b> [<span class="opt"><b class="flag">-CAfile</b>&#160;<i class="arg">trusted_certs.pem</i></span>] [<span class="opt"><b class="flag">-CApath</b>&#160;<i class="arg">trusted_cert_path</i></span>] [<span class="opt"><b class="flag">-data</b>&#160;<i class="arg">file_to_hash</i></span>] [<span class="opt"><b class="flag">-digest</b>&#160;<i class="arg">digest_bytes</i></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">response.tsr</i></span>] [<span class="opt"><b class="flag">-queryfile</b>&#160;<i class="arg">request.tsq</i></span>] [<span class="opt"><b class="flag">-token_in</b></span>] [<span class="opt"><b class="flag">-untrusted</b>&#160;<i class="arg">cert_file.pem</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">ts</b> command is a basic Time Stamping Authority (TSA) client and server application as specified in RFC 3161 (Time-Stamp Protocol, TSP). A TSA can be part of a PKI deployment and its role is to provide long term proof of the existence of a certain datum before a particular time. Here is a brief description of the protocol:<ol style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-enum">
<li class="list-enum" style="margin-top: 1.00em;">
The TSA client computes a one-way hash value for a data file and sends the hash to the TSA.</li>
<li class="list-enum" style="margin-top: 1.00em;">
The TSA attaches the current date and time to the received hash value, signs them and sends the time stamp token back to the client. By creating this token the TSA certifies the existence of the original data file at the time of response generation.</li>
<li class="list-enum" style="margin-top: 1.00em;">
The TSA client receives the time stamp token and verifies the signature on it. It also checks if the token contains the same hash value that it had sent to the TSA.</li>
</ol>
</tr>
</tbody>
</table>
<div class="spacer">
</div>
There is one DER-encoded protocol data unit defined for transporting a time stamp request to the TSA and one for sending the time stamp response back to the client. The <b class="name">ts</b> command has three main functions: creating a time stamp request based on a data file; creating a time stamp response based on a request; and verifying if a response corresponds to a particular request or a data file.<div class="spacer">
</div>
There is no support for sending the requests/responses automatically over HTTP or TCP yet as suggested in RFC 3161. Users must send the requests either by FTP or email.<div class="spacer">
</div>
The <b class="flag">-query</b> switch can be used for creating and printing a time stamp request with the following options:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-cert</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The TSA is expected to include its signing certificate in the response.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-config</b> <i class="arg">configfile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The configuration file to use. This option overrides the <span class="env">OPENSSL_CONF</span> environment variable. Only the OID section of the config file is used with the <b class="flag">-query</b> command.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-data</b> <i class="arg">file_to_hash</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The data file for which the time stamp request needs to be created. stdin is the default if neither the <b class="flag">-data</b> nor the <b class="flag">-digest</b> option is specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-digest</b> <i class="arg">digest_bytes</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
It is possible to specify the message imprint explicitly without the data file. The imprint must be specified in a hexadecimal format, two characters per byte, the bytes optionally separated by colons (e.g. 1A:F6:01:... or 1AF601...). The number of bytes must match the message digest algorithm in use.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">request.tsq</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option specifies a previously created time stamp request in DER format that will be printed into the output file. Useful when you need to examine the content of a request in human-readable format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-md4|md5|ripemd160|sha|sha1</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The message digest to apply to the data file. It supports all the message digest algorithms that are supported by the <b class="name">dgst</b> command. The default is SHA-1.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-no_nonce</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
No nonce is specified in the request if this option is given. Otherwise a 64-bit long pseudo-random none is included in the request. It is recommended to use nonce to protect against replay-attacks.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">request.tsq</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Name of the output file to which the request will be written. The default is stdout.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-policy</b> <i class="arg">object_id</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The policy that the client expects the TSA to use for creating the time stamp token. Either the dotted OID notation or OID names defined in the config file can be used. If no policy is requested the TSA will use its own default policy.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If this option is specified the output is in human-readable text format instead of DER.</dd>
</dl>
<div class="spacer">
</div>
A time stamp response (TimeStampResp) consists of a response status and the time stamp token itself (ContentInfo), if the token generation was successful. The <b class="flag">-reply</b> command is for creating a time stamp response or time stamp token based on a request and printing the response/token in human-readable format. If <b class="flag">-token_out</b> is not specified the output is always a time stamp response (TimeStampResp), otherwise it is a time stamp token (ContentInfo).<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-chain</b> <i class="arg">certs_file.pem</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The collection of certificates, in PEM format, that will be included in the response in addition to the signer certificate if the <b class="flag">-cert</b> option was used for the request. This file is supposed to contain the certificate chain for the signer certificate from its issuer upwards. The <b class="flag">-reply</b> command does not build a certificate chain automatically.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-config</b> <i class="arg">configfile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The configuration file to use. This option overrides the <span class="env">OPENSSL_CONF</span> environment variable. See <i class="link-sec"><a class="link-sec" href="#x545320434f4e46494755524154494f4e2046494c45204f5054494f4e53">TS CONFIGURATION FILE OPTIONS</a></i> for configurable variables.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">response.tsr</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies a previously created time stamp response or time stamp token, if <b class="flag">-token_in</b> is also specified, in DER format that will be written to the output file. This option does not require a request; it is useful, for example, when you need to examine the content of a response or token or you want to extract the time stamp token from a response. If the input is a token and the output is a time stamp response a default &#8220;granted&#8221; status info is added to the token.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inkey</b> <i class="arg">private.pem</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The signer private key of the TSA in PEM format. Overrides the <b class="flag">signer_key</b> config file option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">response.tsr</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The response is written to this file. The format and content of the file depends on other options (see <b class="flag">-text</b> and <b class="flag">-token_out</b>). The default is stdout.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-policy</b> <i class="arg">object_id</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The default policy to use for the response unless the client explicitly requires a particular TSA policy. The OID can be specified either in dotted notation or with its name. Overrides the <b class="flag">default_policy</b> config file option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-queryfile</b> <i class="arg">request.tsq</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The name of the file containing a DER-encoded time stamp request.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-section</b> <i class="arg">tsa_section</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The name of the config file section containing the settings for the response generation. If not specified the default TSA section is used; see <i class="link-sec"><a class="link-sec" href="#x545320434f4e46494755524154494f4e2046494c45204f5054494f4e53">TS CONFIGURATION FILE OPTIONS</a></i> for details.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-signer</b> <i class="arg">tsa_cert.pem</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The signer certificate of the TSA in PEM format. The TSA signing certificate must have exactly one extended key usage assigned to it: timeStamping. The extended key usage must also be critical, otherwise the certificate is going to be refused. Overrides the <b class="flag">signer_cert</b> variable of the config file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If this option is specified the output is human-readable text format instead of DER.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-token_in</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This flag can be used together with the <b class="flag">-in</b> option and indicates that the input is a DER-encoded time stamp token (ContentInfo) instead of a time stamp response (TimeStampResp).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-token_out</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The output is a time stamp token (ContentInfo) instead of time stamp response (TimeStampResp).</dd>
</dl>
<div class="spacer">
</div>
The <b class="flag">-verify</b> command is for verifying if a time stamp response or time stamp token is valid and matches a particular time stamp request or data file. The <b class="flag">-verify</b> command does not use the configuration file.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAfile</b> <i class="arg">trusted_certs.pem</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The name of the file containing a set of trusted self-signed CA certificates in PEM format. See the similar option of <b class="name">verify</b> for additional details. Either this option or <b class="flag">-CApath</b> must be specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CApath</b> <i class="arg">trusted_cert_path</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The name of the directory containing the trused CA certificates of the client. See the similar option of <b class="name">verify</b> for additional details. Either this option or <b class="flag">-CAfile</b> must be specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-data</b> <i class="arg">file_to_hash</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The response or token must be verified against <i class="arg">file_to_hash</i>. The file is hashed with the message digest algorithm specified in the token. The <b class="flag">-digest</b> and <b class="flag">-queryfile</b> options must not be specified with this one.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-digest</b> <i class="arg">digest_bytes</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The response or token must be verified against the message digest specified with this option. The number of bytes must match the message digest algorithm specified in the token. The <b class="flag">-data</b> and <b class="flag">-queryfile</b> options must not be specified with this one.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">response.tsr</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The time stamp response that needs to be verified, in DER format. This option in mandatory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-queryfile</b> <i class="arg">request.tsq</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The original time stamp request, in DER format. The <b class="flag">-data</b> and <b class="flag">-digest</b> options must not be specified with this one.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-token_in</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This flag can be used together with the <b class="flag">-in</b> option and indicates that the input is a DER-encoded time stamp token (ContentInfo) instead of a time stamp response (TimeStampResp).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-untrusted</b> <i class="arg">cert_file.pem</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set of additional untrusted certificates in PEM format which may be needed when building the certificate chain for the TSA's signing certificate. This file must contain the TSA signing certificate and all intermediate CA certificates unless the response includes them.</dd>
</dl>
</div>
<div class="section">
<h1 id="x545320434f4e46494755524154494f4e2046494c45204f5054494f4e53">TS CONFIGURATION FILE OPTIONS</h1> The <b class="flag">-query</b> and <b class="flag">-reply</b> options make use of a configuration file defined by the <span class="env">OPENSSL_CONF</span> environment variable. The <b class="flag">-query</b> option uses only the symbolic OID names section and it can work without it. However, the <b class="flag">-reply</b> option needs the config file for its operation.<div class="spacer">
</div>
When there is a command line switch equivalent of a variable the switch always overrides the settings in the config file.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tsa</b> <i class="arg">section</i>, <b class="flag">default_tsa</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This is the main section and it specifies the name of another section that contains all the options for the <b class="flag">-reply</b> option. This default section can be overridden with the <b class="flag">-section</b> command line switch.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">oid_file</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
See <b class="name">ca</b> for a description.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">oid_section</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
See <b class="name">ca</b> for a description.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">serial</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The name of the file containing the hexadecimal serial number of the last time stamp response created. This number is incremented by 1 for each response. If the file does not exist at the time of response generation a new file is created with serial number 1. This parameter is mandatory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">signer_cert</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
TSA signing certificate, in PEM format. The same as the <b class="flag">-signer</b> command line option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">certs</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A file containing a set of PEM-encoded certificates that need to be included in the response. The same as the <b class="flag">-chain</b> command line option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">signer_key</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The private key of the TSA, in PEM format. The same as the <b class="flag">-inkey</b> command line option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">default_policy</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The default policy to use when the request does not mandate any policy. The same as the <b class="flag">-policy</b> command line option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">other_policies</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Comma separated list of policies that are also acceptable by the TSA and used only if the request explicitly specifies one of them.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">digests</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The list of message digest algorithms that the TSA accepts. At least one algorithm must be specified. This parameter is mandatory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">accuracy</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The accuracy of the time source of the TSA in seconds, milliseconds and microseconds. For example, secs:1, millisecs:500, microsecs:100. If any of the components is missing, zero is assumed for that field.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">clock_precision_digits</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the maximum number of digits, which represent the fraction of seconds, that need to be included in the time field. The trailing zeroes must be removed from the time, so there might actually be fewer digits, or no fraction of seconds at all. The maximum value is 6; the default is 0.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ordering</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If this option is yes, the responses generated by this TSA can always be ordered, even if the time difference between two responses is less than the sum of their accuracies. The default is no.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tsa_name</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set this option to yes if the subject name of the TSA must be included in the TSA name field of the response. The default is no.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ess_cert_id_chain</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The SignedData objects created by the TSA always contain the certificate identifier of the signing certificate in a signed attribute (see RFC 2634, Enhanced Security Services). If this option is set to yes and either the <b class="flag">certs</b> variable or the <b class="flag">-chain</b> option is specified then the certificate identifiers of the chain will also be included in the SigningCertificate signed attribute. If this variable is set to no, only the signing certificate identifier is included. The default is no.</dd>
</dl>
</div>
<div class="section">
<h1 id="x545320454e5649524f4e4d454e54205641524941424c4553">TS ENVIRONMENT VARIABLES</h1> <span class="env">OPENSSL_CONF</span> contains the path of the configuration file and can be overridden by the <b class="flag">-config</b> command line option.</div>
<div class="section">
<h1 id="x5453204558414d504c4553">TS EXAMPLES</h1> All the examples below presume that <span class="env">OPENSSL_CONF</span> is set to a proper configuration file, e.g. the example configuration file <i class="file">openssl/apps/openssl.cnf</i> will do.<div class="spacer">
</div>
To create a time stamp request for design1.txt with SHA-1 without nonce and policy and no certificate is required in the response:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -query -data design1.txt -no_nonce \ 
	-out design1.tsq</pre>
<div class="spacer">
</div>
To create a similar time stamp request but specifying the message imprint explicitly:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -query \ 
	-digest b7e5d3f93198b38379852f2c04e78d73abdd0f4b \ 
	-no_nonce -out design1.tsq</pre>
<div class="spacer">
</div>
To print the content of the previous request in human readable format:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -query -in design1.tsq -text</pre>
<div class="spacer">
</div>
To create a time stamp request which includes the MD5 digest of design2.txt, requests the signer certificate and nonce, specifies a policy ID (assuming the tsa_policy1 name is defined in the OID section of the config file):<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -query -data design2.txt -md5 \ 
	-policy tsa_policy1 -cert -out design2.tsq</pre>
<div class="spacer">
</div>
Before generating a response, a signing certificate must be created for the TSA that contains the <b class="flag">timeStamping</b> critical extended key usage extension without any other key usage extensions. You can add the &#8220;extendedKeyUsage = critical,timeStamping&#8221; line to the user certificate section of the config file to generate a proper certificate. See the <b class="name">req</b>, <b class="name">ca</b>, and <b class="name">x509</b> commands for instructions. The examples below assume that cacert.pem contains the certificate of the CA, tsacert.pem is the signing certificate issued by cacert.pem and tsakey.pem is the private key of the TSA.<div class="spacer">
</div>
To create a time stamp response for a request:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -reply -queryfile design1.tsq -inkey tsakey.pem \ 
	-signer tsacert.pem -out design1.tsr</pre>
<div class="spacer">
</div>
If you want to use the settings in the config file you could just write:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -reply -queryfile design1.tsq -out design1.tsr</pre>
<div class="spacer">
</div>
To print a time stamp reply to stdout in human readable format:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -reply -in design1.tsr -text</pre>
<div class="spacer">
</div>
To create a time stamp token instead of time stamp response:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -reply -queryfile design1.tsq \ 
	-out design1_token.der -token_out</pre>
<div class="spacer">
</div>
To print a time stamp token to stdout in human readable format:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -reply -in design1_token.der -token_in \ 
	-text -token_out</pre>
<div class="spacer">
</div>
To extract the time stamp token from a response:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -reply -in design1.tsr -out design1_token.der \ 
	-token_out</pre>
<div class="spacer">
</div>
To add &#8220;granted&#8221; status info to a time stamp token thereby creating a valid response:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -reply -in design1_token.der \ 
	-token_in -out design1.tsr</pre>
<div class="spacer">
</div>
To verify a time stamp reply against a request:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -verify -queryfile design1.tsq -in design1.tsr \ 
	-CAfile cacert.pem -untrusted tsacert.pem</pre>
<div class="spacer">
</div>
To verify a time stamp reply that includes the certificate chain:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -verify -queryfile design2.tsq -in design2.tsr \ 
	-CAfile cacert.pem</pre>
<div class="spacer">
</div>
To verify a time stamp token against the original data file:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -verify -data design2.txt -in design2.tsr \ 
	-CAfile cacert.pem</pre>
<div class="spacer">
</div>
To verify a time stamp token against a message imprint:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl ts -verify \ 
	-digest b7e5d3f93198b38379852f2c04e78d73abdd0f4b \ 
	-in design2.tsr -CAfile cacert.pem</pre>
</div>
<div class="section">
<h1 id="x54532042554753">TS BUGS</h1> No support for time stamps over SMTP, though it is quite easy to implement an automatic email-based TSA with <a class="link-man" href="../html1/procmail.html">procmail</a> and <a class="link-man" href="../html1/perl.html">perl(1)</a>. Pure TCP/IP is not supported.<div class="spacer">
</div>
The file containing the last serial number of the TSA is not locked when being read or written. This is a problem if more than one instance of <b class="name">OpenSSL</b> is trying to create a time stamp response at the same time.<div class="spacer">
</div>
Look for the FIXME word in the source files.<div class="spacer">
</div>
The source code should really be reviewed by somebody else, too.<div class="spacer">
</div>
More testing is needed.</div>
<div class="section">
<h1 id="x545320415554484f5253">TS AUTHORS</h1> <span class="author">Zoltan Glozik</span> &lt;<a class="link-mail" href="mailto:zglozik@opentsa.org">zglozik@opentsa.org</a>&gt;, OpenTSA project (<a class="link-ext" href="http://www.opentsa.org">http://www.opentsa.org</a>).</div>
<div class="section">
<h1 id="x53504b4143">SPKAC</h1><table class="synopsis">
<col style="width: 176.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl spkac</td>
<td>
[<span class="opt"><b class="flag">-challenge</b> <i class="arg">string</i></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-key</b>&#160;<i class="arg">keyfile</i></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-pubkey</b></span>] [<span class="opt"><b class="flag">-spkac</b>&#160;<i class="arg">spkacname</i></span>] [<span class="opt"><b class="flag">-spksect</b>&#160;<i class="arg">section</i></span>] [<span class="opt"><b class="flag">-verify</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">spkac</b> command processes Netscape signed public key and challenge (SPKAC) files. It can print out their contents, verify the signature, and produce its own SPKACs from a supplied private key.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-challenge</b> <i class="arg">string</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the challenge string if an SPKAC is being created.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the input <i class="arg">file</i> to read from, or standard input if this option is not specified. Ignored if the <b class="flag">-key</b> option is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-key</b> <i class="arg">keyfile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Create an SPKAC file using the private key in <i class="arg">keyfile</i>. The <b class="flag">-in</b>, <b class="flag">-noout</b>, <b class="flag">-spksect</b>, and <b class="flag">-verify</b> options are ignored if present.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't output the text version of the SPKAC (not used if an SPKAC is being created).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the output <i class="arg">file</i> to write to, or standard output by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubkey</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Output the public key of an SPKAC (not used if an SPKAC is being created).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-spkac</b> <i class="arg">spkacname</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Allows an alternative name for the variable containing the SPKAC. The default is &quot;SPKAC&quot;. This option affects both generated and input SPKAC files.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-spksect</b> <i class="arg">section</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Allows an alternative name for the <i class="arg">section</i> containing the SPKAC. The default is the default section.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verify</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Verifies the digital signature on the supplied SPKAC.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53504b4143204558414d504c4553">SPKAC EXAMPLES</h1> Print out the contents of an SPKAC:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl spkac -in spkac.cnf</code></div>
</blockquote>
<div class="spacer">
</div>
Verify the signature of an SPKAC:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl spkac -in spkac.cnf -noout -verify</code></div>
</blockquote>
<div class="spacer">
</div>
Create an SPKAC using the challenge string &#8220;hello&#8221;:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl spkac -key key.pem -challenge hello -out spkac.cnf</code></div>
</blockquote>
<div class="spacer">
</div>
Example of an SPKAC, (long lines split up for clarity):<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
SPKAC=MIG5MGUwXDANBgkqhkiG9w0BAQEFAANLADBIAkEA1cCoq2Wa3Ixs47uI7F\ 
PVwHVIPDx5yso105Y6zpozam135a8R0CpoRvkkigIyXfcCjiVi5oWk+6FfPaD03u\ 
PFoQIDAQABFgVoZWxsbzANBgkqhkiG9w0BAQQFAANBAFpQtY/FojdwkJh1bEIYuc\ 
2EeM2KHTWPEepWYeawvHD0gQ3DngSC75YCWnnDdq+NQ3F+X4deMx9AaEglZtULwV\ 
4=</pre>
</div>
<div class="section">
<h1 id="x53504b4143204e4f544553">SPKAC NOTES</h1> A created SPKAC with suitable DN components appended can be fed into the <b class="name">ca</b> utility.<div class="spacer">
</div>
SPKACs are typically generated by Netscape when a form is submitted containing the <span class="emph">KEYGEN</span> tag as part of the certificate enrollment process.<div class="spacer">
</div>
The challenge string permits a primitive form of proof of possession of private key. By checking the SPKAC signature and a random challenge string, some guarantee is given that the user knows the private key corresponding to the public key being certified. This is important in some applications. Without this it is possible for a previous SPKAC to be used in a &#8220;replay attack&#8221;.</div>
<div class="section">
<h1 id="x564552494659">VERIFY</h1><table class="synopsis">
<col style="width: 39.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl verify</td>
<td>
[<span class="opt"><b class="flag">-CAfile</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-CApath</b>&#160;<i class="arg">directory</i></span>] [<span class="opt"><b class="flag">-check_ss_sig</b></span>] [<span class="opt"><b class="flag">-crl_check</b></span>] [<span class="opt"><b class="flag">-crl_check_all</b></span>] [<span class="opt"><b class="flag">-explicit_policy</b></span>] [<span class="opt"><b class="flag">-extended_crl</b></span>] [<span class="opt"><b class="flag">-help</b></span>] [<span class="opt"><b class="flag">-ignore_critical</b></span>] [<span class="opt"><b class="flag">-inhibit_any</b></span>] [<span class="opt"><b class="flag">-inhibit_map</b></span>] [<span class="opt"><b class="flag">-issuer_checks</b></span>] [<span class="opt"><b class="flag">-policy_check</b></span>] [<span class="opt"><b class="flag">-purpose</b>&#160;<i class="arg">purpose</i></span>] [<span class="opt"><b class="flag">-untrusted</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-verbose</b></span>] [<span class="opt"><b class="flag">-x509_strict</b></span>] [<span class="opt"><b class="flag">-</b></span>] [<span class="opt"><i class="arg">certificates</i></span>]</td>
<div class="spacer">
</div>
The <b class="name">verify</b> command verifies certificate chains.</tr>
</tbody>
</table>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-check_ss_sig</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Verify the signature on the self-signed root CA. This is disabled by default because it doesn't add any security.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A <i class="arg">file</i> of trusted certificates. The <i class="arg">file</i> should contain multiple certificates in PEM format, concatenated together.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CApath</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A <i class="arg">directory</i> of trusted certificates. The certificates should have names of the form <span class="emph">hash.0</span>, or have symbolic links to them of this form (&quot;hash&quot; is the hashed certificate subject name: see the <b class="flag">-hash</b> option of the <b class="name">x509</b> utility). The <b class="name">c_rehash</b> script distributed with OpenSSL will automatically create symbolic links to a directory of certificates.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crl_check</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Checks end entity certificate validity by attempting to look up a valid CRL. If a valid CRL cannot be found an error occurs.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-crl_check_all</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Checks the validity of all certificates in the chain by attempting to look up valid CRLs.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-explicit_policy</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set policy variable require-explicit-policy (see RFC 3280 et al).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-extended_crl</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable extended CRL features such as indirect CRLs and alternate CRL signing keys.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-help</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Prints out a usage message.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-ignore_critical</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Normally if an unhandled critical extension is present which is not supported by <b class="name">OpenSSL</b>, the certificate is rejected (as required by RFC 3280 et al). If this option is set, critical extensions are ignored.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inhibit_any</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set policy variable inhibit-any-policy (see RFC 3280 et al).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inhibit_map</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set policy variable inhibit-policy-mapping (see RFC 3280 et al).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-issuer_checks</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print out diagnostics relating to searches for the issuer certificate of the current certificate. This shows why each candidate issuer certificate was rejected. However the presence of rejection messages does not itself imply that anything is wrong: during the normal verify process several rejections may take place.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-policy_check</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enables certificate policy processing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-purpose</b> <i class="arg">purpose</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The intended use for the certificate. Without this option no chain verification will be done. Currently accepted uses are <i class="arg">sslclient</i>, <i class="arg">sslserver</i>, <i class="arg">nssslserver</i>, <i class="arg">smimesign</i>, <i class="arg">smimeencrypt</i>, <i class="arg">crlsign</i>, <i class="arg">any</i>, and <i class="arg">ocsphelper</i>. See the <i class="link-sec"><a class="link-sec" href="#x564552494659204f5045524154494f4e">VERIFY OPERATION</a></i> section for more information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-untrusted</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A <i class="arg">file</i> of untrusted certificates. The <i class="arg">file</i> should contain multiple certificates.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-verbose</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print extra information about the operations being performed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-x509_strict</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable workarounds for broken certificates which have to be disabled for strict X.509 compliance.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Marks the last option. All arguments following this are assumed to be certificate files. This is useful if the first certificate filename begins with a &#8216;-&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">certificates</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
One or more <i class="arg">certificates</i> to verify. If no certificate files are included, an attempt is made to read a certificate from standard input. They should all be in PEM format.</dd>
</dl>
</div>
<div class="section">
<h1 id="x564552494659204f5045524154494f4e">VERIFY OPERATION</h1> The <b class="name">verify</b> program uses the same functions as the internal SSL and S/MIME verification, therefore this description applies to these verify operations too.<div class="spacer">
</div>
There is one crucial difference between the verify operations performed by the <b class="name">verify</b> program: wherever possible an attempt is made to continue after an error, whereas normally the verify operation would halt on the first error. This allows all the problems with a certificate chain to be determined.<div class="spacer">
</div>
The verify operation consists of a number of separate steps:<div class="spacer">
</div>
Firstly a certificate chain is built up starting from the supplied certificate and ending in the root CA. It is an error if the whole chain cannot be built up. The chain is built up by looking up the issuer's certificate of the current certificate. If a certificate is found which is its own issuer, it is assumed to be the root CA.<div class="spacer">
</div>
The process of &#8220;looking up the issuer's certificate&#8221; itself involves a number of steps. In versions of <b class="name">OpenSSL</b> before 0.9.5a the first certificate whose subject name matched the issuer of the current certificate was assumed to be the issuer's certificate. In <b class="name">OpenSSL</b> 0.9.6 and later all certificates whose subject name matches the issuer name of the current certificate are subject to further tests. The relevant authority key identifier components of the current certificate (if present) must match the subject key identifier (if present) and issuer and serial number of the candidate issuer; in addition the <span class="emph">keyUsage</span> extension of the candidate issuer (if present) must permit certificate signing.<div class="spacer">
</div>
The lookup first looks in the list of untrusted certificates and if no match is found the remaining lookups are from the trusted certificates. The root CA is always looked up in the trusted certificate list: if the certificate to verify is a root certificate, then an exact match must be found in the trusted list.<div class="spacer">
</div>
The second operation is to check every untrusted certificate's extensions for consistency with the supplied purpose. If the <b class="flag">-purpose</b> option is not included, then no checks are done. The supplied or &#8220;leaf&#8221; certificate must have extensions compatible with the supplied purpose and all other certificates must also be valid CA certificates. The precise extensions required are described in more detail in the <i class="link-sec"><a class="link-sec" href="#x582e35303920434552544946494341544520455854454e53494f4e53">X.509 CERTIFICATE EXTENSIONS</a></i> section below.<div class="spacer">
</div>
The third operation is to check the trust settings on the root CA. The root CA should be trusted for the supplied purpose. For compatibility with previous versions of <b class="name">SSLeay</b> and <b class="name">OpenSSL</b>, a certificate with no trust settings is considered to be valid for all purposes.<div class="spacer">
</div>
The final operation is to check the validity of the certificate chain. The validity period is checked against the current system time and the <span class="emph">notBefore</span> and <span class="emph">notAfter</span> dates in the certificate. The certificate signatures are also checked at this point.<div class="spacer">
</div>
If all operations complete successfully, the certificate is considered valid. If any operation fails then the certificate is not valid.</div>
<div class="section">
<h1 id="x56455249465920444941474e4f5354494353">VERIFY DIAGNOSTICS</h1> When a verify operation fails, the output messages can be somewhat cryptic. The general form of the error message is:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
 server.pem: /C=AU/ST=Queensland/O=CryptSoft Pty Ltd/CN=Test CA (1024-bit) 
 error 24 at 1 depth lookup:invalid CA certificate</pre>
<div class="spacer">
</div>
The first line contains the name of the certificate being verified, followed by the subject name of the certificate. The second line contains the error number and the depth. The depth is the number of the certificate being verified when a problem was detected starting with zero for the certificate being verified itself, then 1 for the CA that signed the certificate and so on. Finally a text version of the error number is presented.<div class="spacer">
</div>
An exhaustive list of the error codes and messages is shown below; this also includes the name of the error code as defined in the header file <b class="includes">&lt;<a class="link-includes">openssl/x509_vfy.h</a>&gt;</b>. Some of the error codes are defined but never returned: these are described as &#8220;unused&#8221;.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">0 X509_V_OK: ok</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The operation was successful.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">2 X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT: unable to get issuer certificate</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The issuer certificate could not be found: this occurs if the issuer certificate of an untrusted certificate cannot be found.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">3 X509_V_ERR_UNABLE_TO_GET_CRL: unable to get certificate CRL</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The CRL of a certificate could not be found.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">4 X509_V_ERR_UNABLE_TO_DECRYPT_CERT_SIGNATURE: unable to decrypt certificate's signature</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The certificate signature could not be decrypted. This means that the actual signature value could not be determined rather than it not matching the expected value. This is only meaningful for RSA keys.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">5 X509_V_ERR_UNABLE_TO_DECRYPT_CRL_SIGNATURE: unable to decrypt CRL's signature</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The CRL signature could not be decrypted: this means that the actual signature value could not be determined rather than it not matching the expected value. Unused.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">6 X509_V_ERR_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY: unable to decode issuer public key</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The public key in the certificate <span class="emph">SubjectPublicKeyInfo</span> could not be read.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">7 X509_V_ERR_CERT_SIGNATURE_FAILURE: certificate signature failure</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The signature of the certificate is invalid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">8 X509_V_ERR_CRL_SIGNATURE_FAILURE: CRL signature failure</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The signature of the certificate is invalid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">9 X509_V_ERR_CERT_NOT_YET_VALID: certificate is not yet valid</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The certificate is not yet valid: the <span class="emph">notBefore</span> date is after the current time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">10 X509_V_ERR_CERT_HAS_EXPIRED: certificate has expired</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The certificate has expired; that is, the <span class="emph">notAfter</span> date is before the current time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">11 X509_V_ERR_CRL_NOT_YET_VALID: CRL is not yet valid</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The CRL is not yet valid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">12 X509_V_ERR_CRL_HAS_EXPIRED: CRL has expired</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The CRL has expired.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">13 X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD: format error in certificate's notBefore field</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The certificate <span class="emph">notBefore</span> field contains an invalid time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">14 X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD: format error in certificate's notAfter field</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The certificate <span class="emph">notAfter</span> field contains an invalid time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">15 X509_V_ERR_ERROR_IN_CRL_LAST_UPDATE_FIELD: format error in CRL's lastUpdate field</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The CRL <span class="emph">lastUpdate</span> field contains an invalid time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">16 X509_V_ERR_ERROR_IN_CRL_NEXT_UPDATE_FIELD: format error in CRL's nextUpdate field</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The CRL <span class="emph">nextUpdate</span> field contains an invalid time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">17 X509_V_ERR_OUT_OF_MEM: out of memory</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
An error occurred trying to allocate memory. This should never happen.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">18 X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT: self signed certificate</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The passed certificate is self-signed and the same certificate cannot be found in the list of trusted certificates.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">19 X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN: self signed certificate in certificate chain</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The certificate chain could be built up using the untrusted certificates but the root could not be found locally.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">20 X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY: unable to get local issuer certificate</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The issuer certificate of a locally looked up certificate could not be found. This normally means the list of trusted certificates is not complete.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">21 X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE: unable to verify the first certificate</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
No signatures could be verified because the chain contains only one certificate and it is not self-signed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">22 X509_V_ERR_CERT_CHAIN_TOO_LONG: certificate chain too long</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The certificate chain length is greater than the supplied maximum depth. Unused.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">23 X509_V_ERR_CERT_REVOKED: certificate revoked</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The certificate has been revoked.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">24 X509_V_ERR_INVALID_CA: invalid CA certificate</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A CA certificate is invalid. Either it is not a CA or its extensions are not consistent with the supplied purpose.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">25 X509_V_ERR_PATH_LENGTH_EXCEEDED: path length constraint exceeded</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The <span class="emph">basicConstraints</span> pathlength parameter has been exceeded.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">26 X509_V_ERR_INVALID_PURPOSE: unsupported certificate purpose</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The supplied certificate cannot be used for the specified purpose.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">27 X509_V_ERR_CERT_UNTRUSTED: certificate not trusted</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The root CA is not marked as trusted for the specified purpose.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">28 X509_V_ERR_CERT_REJECTED: certificate rejected</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The root CA is marked to reject the specified purpose.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">29 X509_V_ERR_SUBJECT_ISSUER_MISMATCH: subject issuer mismatch</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The current candidate issuer certificate was rejected because its subject name did not match the issuer name of the current certificate. Only displayed when the <b class="flag">-issuer_checks</b> option is set.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">30 X509_V_ERR_AKID_SKID_MISMATCH: authority and subject key identifier mismatch</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The current candidate issuer certificate was rejected because its subject key identifier was present and did not match the authority key identifier current certificate. Only displayed when the <b class="flag">-issuer_checks</b> option is set.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">31 X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH: authority and issuer serial number mismatch</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The current candidate issuer certificate was rejected because its issuer name and serial number were present and did not match the authority key identifier of the current certificate. Only displayed when the <b class="flag">-issuer_checks</b> option is set.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">32 X509_V_ERR_KEYUSAGE_NO_CERTSIGN:key usage does not include certificate signing</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The current candidate issuer certificate was rejected because its <span class="emph">keyUsage</span> extension does not permit certificate signing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">50 X509_V_ERR_APPLICATION_VERIFICATION: application verification failure</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
An application specific error. Unused.</dd>
</dl>
</div>
<div class="section">
<h1 id="x5645524946592042554753">VERIFY BUGS</h1> Although the issuer checks are a considerable improvement over the old technique, they still suffer from limitations in the underlying X509_LOOKUP API. One consequence of this is that trusted certificates with matching subject name must either appear in a file (as specified by the <b class="flag">-CAfile</b> option) or a directory (as specified by <b class="flag">-CApath</b>). If they occur in both, only the certificates in the file will be recognised.<div class="spacer">
</div>
Previous versions of <b class="name">OpenSSL</b> assumed certificates with matching subject name were identical and mishandled them.</div>
<div class="section">
<h1 id="x56455253494f4e">VERSION</h1> <b class="name">openssl version</b> [<span class="opt"><b class="flag">-abdfopv</b></span>]<div class="spacer">
</div>
The <b class="name">version</b> command is used to print out version information about <b class="name">OpenSSL</b>.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-a</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
All information: this is the same as setting all the other flags.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-b</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The date the current version of <b class="name">OpenSSL</b> was built.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<span class="env">OPENSSLDIR</span> setting.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-f</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Compilation flags.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-o</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Option information: various options set when the library was built.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-p</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Platform setting.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-v</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The current <b class="name">OpenSSL</b> version.</dd>
</dl>
</div>
<div class="section">
<h1 id="x56455253494f4e204e4f544553">VERSION NOTES</h1> The output of <b class="name">openssl version -a</b> would typically be used when sending in a bug report.</div>
<div class="section">
<h1 id="x56455253494f4e20484953544f5259">VERSION HISTORY</h1> The <b class="flag">-d</b> option was added in <b class="name">OpenSSL</b> 0.9.7.</div>
<div class="section">
<h1 id="x58353039">X509</h1><table class="synopsis">
<col style="width: 206.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl x509</td>
<td>
[<span class="opt"><b class="flag">-C</b></span>] [<span class="opt"><b class="flag">-addreject</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-addtrust</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-alias</b></span>] [<span class="opt"><b class="flag">-CA</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-CAcreateserial</b></span>] [<span class="opt"><b class="flag">-CAform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-CAkey</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-CAkeyform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-CAserial</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-certopt</b>&#160;<i class="arg">option</i></span>] [<span class="opt"><b class="flag">-checkend</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-clrext</b></span>] [<span class="opt"><b class="flag">-clrreject</b></span>] [<span class="opt"><b class="flag">-clrtrust</b></span>] [<span class="opt"><b class="flag">-dates</b></span>] [<span class="opt"><b class="flag">-days</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-email</b></span>] [<span class="opt"><b class="flag">-enddate</b></span>] [<span class="opt"><b class="flag">-extensions</b>&#160;<i class="arg">section</i></span>] [<span class="opt"><b class="flag">-extfile</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-fingerprint</b></span>] [<span class="opt"><b class="flag">-hash</b></span>] [<span class="opt"><b class="flag">-in</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-inform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">NET</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-issuer</b></span>] [<span class="opt"><b class="flag">-issuer_hash</b></span>] [<span class="opt"><b class="flag">-issuer_hash_old</b></span>] [<span class="opt"><b class="flag">-keyform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-md5</b>&#160;|&#160;<b class="flag">-sha1</b></span>] [<span class="opt"><b class="flag">-modulus</b></span>] [<span class="opt"><b class="flag">-nameopt</b>&#160;<i class="arg">option</i></span>] [<span class="opt"><b class="flag">-noout</b></span>] [<span class="opt"><b class="flag">-ocsp_uri</b></span>] [<span class="opt"><b class="flag">-ocspid</b></span>] [<span class="opt"><b class="flag">-out</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-outform</b>&#160;<i class="arg">DER</i>&#160;|&#160;<i class="arg">NET</i>&#160;|&#160;<i class="arg">PEM</i></span>] [<span class="opt"><b class="flag">-passin</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-pubkey</b></span>] [<span class="opt"><b class="flag">-purpose</b></span>] [<span class="opt"><b class="flag">-req</b></span>] [<span class="opt"><b class="flag">-serial</b></span>] [<span class="opt"><b class="flag">-set_serial</b>&#160;<i class="arg">n</i></span>] [<span class="opt"><b class="flag">-setalias</b>&#160;<i class="arg">arg</i></span>] [<span class="opt"><b class="flag">-signkey</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-startdate</b></span>] [<span class="opt"><b class="flag">-subject</b></span>] [<span class="opt"><b class="flag">-subject_hash</b></span>] [<span class="opt"><b class="flag">-subject_hash_old</b></span>] [<span class="opt"><b class="flag">-text</b></span>] [<span class="opt"><b class="flag">-trustout</b></span>] [<span class="opt"><b class="flag">-x509toreq</b></span>]</td>
<div class="spacer">
</div>
The <b class="name">x509</b> command is a multi-purpose certificate utility. It can be used to display certificate information, convert certificates to various forms, sign certificate requests like a &#8220;mini CA&#8221;, or edit certificate trust settings.</tr>
</tbody>
</table>
<div class="spacer">
</div>
Since there are a large number of options, they are split up into various sections.</div>
<div class="section">
<h1 id="x5835303920494e5055542c204f55545055542c20414e442047454e4552414c20505552504f5345204f5054494f4e53">X509 INPUT, OUTPUT, AND GENERAL PURPOSE OPTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-in</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the input <i class="arg">file</i> to read a certificate from, or standard input if this option is not specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-inform</b> <i class="arg">DER</i> | <i class="arg">NET</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the input format. Normally, the command will expect an X.509 certificate, but this can change if other options such as <b class="flag">-req</b> are present. The <i class="arg">DER</i> format is the DER encoding of the certificate and <i class="arg">PEM</i> is the base64 encoding of the DER encoding with header and footer lines added. The <i class="arg">NET</i> option is an obscure Netscape server format that is now obsolete.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-md5</b> | <b class="flag">-sha1</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The digest to use. This affects any signing or display option that uses a message digest, such as the <b class="flag">-fingerprint</b>, <b class="flag">-signkey</b>, and <b class="flag">-CA</b> options. If not specified, MD5 is used. If the key being used to sign with is a DSA key, this option has no effect: SHA1 is always used with DSA keys.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-out</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the output <i class="arg">file</i> to write to, or standard output by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-outform</b> <i class="arg">DER</i> | <i class="arg">NET</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This specifies the output format; the options have the same meaning as the <b class="flag">-inform</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-passin</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The key password source. For more information about the format of <i class="arg">arg</i>, see the <i class="link-sec"><a class="link-sec" href="#x504153532050485241534520415247554d454e5453">PASS PHRASE ARGUMENTS</a></i> section above.</dd>
</dl>
</div>
<div class="section">
<h1 id="x5835303920444953504c4159204f5054494f4e53">X509 DISPLAY OPTIONS</h1> <span class="symb">Note</span>: The <b class="flag">-alias</b> and <b class="flag">-purpose</b> options are also display options but are described in the <i class="link-sec"><a class="link-sec" href="#x583530392054525553542053455454494e4753">X509 TRUST SETTINGS</a></i> section.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-C</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This outputs the certificate in the form of a C source file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-certopt</b> <i class="arg">option</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Customise the output format used with <b class="flag">-text</b>. The <i class="arg">option</i> argument can be a single option or multiple options separated by commas. The <b class="flag">-certopt</b> switch may also be used more than once to set multiple options. See the <i class="link-sec"><a class="link-sec" href="#x583530392054455854204f5054494f4e53">X509 TEXT OPTIONS</a></i> section for more information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-dates</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Prints out the start and expiry dates of a certificate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-email</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Outputs the email address(es), if any.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-enddate</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Prints out the expiry date of the certificate; that is, the <span class="emph">notAfter</span> date.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-fingerprint</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Prints out the digest of the DER-encoded version of the whole certificate (see <i class="link-sec"><a class="link-sec" href="#x444947455354204f5054494f4e53">DIGEST OPTIONS</a></i>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-hash</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A synonym for <b class="flag">-subject_hash</b>, for backwards compatibility.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-issuer</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Outputs the issuer name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-issuer_hash</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Outputs the &#8220;hash&#8221; of the certificate issuer name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-issuer_hash_old</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Outputs the &#8220;hash&#8221; of the certificate issuer name using the older algorithm as used by <b class="name">OpenSSL</b> versions before 1.0.0.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-modulus</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option prints out the value of the modulus of the public key contained in the certificate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-nameopt</b> <i class="arg">option</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Option which determines how the subject or issuer names are displayed. The <i class="arg">option</i> argument can be a single option or multiple options separated by commas. Alternatively, the <b class="flag">-nameopt</b> switch may be used more than once to set multiple options. See the <i class="link-sec"><a class="link-sec" href="#x58353039204e414d45204f5054494f4e53">X509 NAME OPTIONS</a></i> section for more information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-noout</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option prevents output of the encoded version of the request.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-ocsp_uri</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Outputs the OCSP responder addresses, if any.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-ocspid</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Print OCSP hash values for the subject name and public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-pubkey</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Output the public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-serial</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Outputs the certificate serial number.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-startdate</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Prints out the start date of the certificate; that is, the <span class="emph">notBefore</span> date.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-subject</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Outputs the subject name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-subject_hash</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Outputs the &#8220;hash&#8221; of the certificate subject name. This is used in <b class="name">OpenSSL</b> to form an index to allow certificates in a directory to be looked up by subject name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-subject_hash_old</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Outputs the &#8220;hash&#8221; of the certificate subject name using the older algorithm as used by <b class="name">OpenSSL</b> versions before 1.0.0.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-text</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Prints out the certificate in text form. Full details are output including the public key, signature algorithms, issuer and subject names, serial number, any extensions present, and any trust settings.</dd>
</dl>
</div>
<div class="section">
<h1 id="x583530392054525553542053455454494e4753">X509 TRUST SETTINGS</h1> Please note these options are currently experimental and may well change.<div class="spacer">
</div>
A <span class="emph">trusted certificate</span> is an ordinary certificate which has several additional pieces of information attached to it such as the permitted and prohibited uses of the certificate and an &#8220;alias&#8221;.<div class="spacer">
</div>
Normally, when a certificate is being verified at least one certificate must be &#8220;trusted&#8221;. By default, a trusted certificate must be stored locally and must be a root CA: any certificate chain ending in this CA is then usable for any purpose.<div class="spacer">
</div>
Trust settings currently are only used with a root CA. They allow a finer control over the purposes the root CA can be used for. For example, a CA may be trusted for an SSL client but not for SSL server use.<div class="spacer">
</div>
See the description of the <b class="name">verify</b> utility for more information on the meaning of trust settings.<div class="spacer">
</div>
Future versions of <b class="name">OpenSSL</b> will recognize trust settings on any certificate: not just root CAs.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-addreject</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Adds a prohibited use. It accepts the same values as the <b class="flag">-addtrust</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-addtrust</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Adds a trusted certificate use. Any object name can be used here, but currently only <i class="arg">clientAuth</i> (SSL client use), <i class="arg">serverAuth</i> (SSL server use), and <i class="arg">emailProtection</i> (S/MIME email) are used. Other <b class="name">OpenSSL</b> applications may define additional uses.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-alias</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Outputs the certificate alias, if any.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-clrreject</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Clears all the prohibited or rejected uses of the certificate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-clrtrust</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Clears all the permitted or trusted uses of the certificate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-purpose</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option performs tests on the certificate extensions and outputs the results. For a more complete description, see the <i class="link-sec"><a class="link-sec" href="#x582e35303920434552544946494341544520455854454e53494f4e53">X.509 CERTIFICATE EXTENSIONS</a></i> section.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-setalias</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Sets the alias of the certificate. This will allow the certificate to be referred to using a nickname, for example &#8220;Steve's Certificate&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-trustout</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This causes <b class="name">x509</b> to output a <span class="emph">trusted certificate</span>. An ordinary or trusted certificate can be input, but by default an ordinary certificate is output and any trust settings are discarded. With the <b class="flag">-trustout</b> option a trusted certificate is output. A trusted certificate is automatically output if any trust settings are modified.</dd>
</dl>
</div>
<div class="section">
<h1 id="x58353039205349474e494e47204f5054494f4e53">X509 SIGNING OPTIONS</h1> The <b class="name">x509</b> utility can be used to sign certificates and requests: it can thus behave like a &#8220;mini CA&#8221;.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CA</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specifies the CA certificate to be used for signing. When this option is present, <b class="name">x509</b> behaves like a &#8220;mini CA&#8221;. The input file is signed by the CA using this option; that is, its issuer name is set to the subject name of the CA and it is digitally signed using the CA's private key.<div class="spacer">
</div>
This option is normally combined with the <b class="flag">-req</b> option. Without the <b class="flag">-req</b> option, the input is a certificate which must be self-signed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAcreateserial</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
With this option the CA serial number file is created if it does not exist: it will contain the serial number &#8216;02&#8217; and the certificate being signed will have &#8216;1&#8217; as its serial number. Normally, if the <b class="flag">-CA</b> option is specified and the serial number file does not exist, it is an error.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The format of the CA certificate file. The default is <i class="arg">PEM</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAkey</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Sets the CA private key to sign a certificate with. If this option is not specified, it is assumed that the CA private key is present in the CA certificate file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAkeyform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The format of the CA private key. The default is <i class="arg">PEM</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-CAserial</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Sets the CA serial number file to use.<div class="spacer">
</div>
When the <b class="flag">-CA</b> option is used to sign a certificate, it uses a serial number specified in a file. This file consists of one line containing an even number of hex digits with the serial number to use. After each use the serial number is incremented and written out to the file again.<div class="spacer">
</div>
The default filename consists of the CA certificate file base name with <i class="file">.srl</i> appended. For example, if the CA certificate file is called <i class="file">mycacert.pem</i>, it expects to find a serial number file called <i class="file">mycacert.srl</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-checkend</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Check whether the certificate expires in the next <i class="arg">arg</i> seconds. If so, exit with return value 1; otherwise exit with return value 0.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-clrext</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Delete any extensions from a certificate. This option is used when a certificate is being created from another certificate (for example with the <b class="flag">-signkey</b> or the <b class="flag">-CA</b> options). Normally, all extensions are retained.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-days</b> <i class="arg">arg</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specifies the number of days to make a certificate valid for. The default is 30 days.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-extensions</b> <i class="arg">section</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The section to add certificate extensions from. If this option is not specified, the extensions should either be contained in the unnamed (default) section or the default section should contain a variable called &#8220;extensions&#8221; which contains the section to use.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-extfile</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
File containing certificate extensions to use. If not specified, no extensions are added to the certificate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-keyform</b> <i class="arg">DER</i> | <i class="arg">PEM</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specifies the format (DER or PEM) of the private key file used in the <b class="flag">-signkey</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-req</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
By default, a certificate is expected on input. With this option a certificate request is expected instead.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-set_serial</b> <i class="arg">n</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specifies the serial number to use. This option can be used with either the <b class="flag">-signkey</b> or <b class="flag">-CA</b> options. If used in conjunction with the <b class="flag">-CA</b> option, the serial number file (as specified by the <b class="flag">-CAserial</b> or <b class="flag">-CAcreateserial</b> options) is not used.<div class="spacer">
</div>
The serial number can be decimal or hex (if preceded by &#8216;0x&#8217;). Negative serial numbers can also be specified but their use is not recommended.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-signkey</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option causes the input file to be self-signed using the supplied private key.<div class="spacer">
</div>
If the input file is a certificate, it sets the issuer name to the subject name (i.e. makes it self-signed), changes the public key to the supplied value, and changes the start and end dates. The start date is set to the current time and the end date is set to a value determined by the <b class="flag">-days</b> option. Any certificate extensions are retained unless the <b class="flag">-clrext</b> option is supplied.<div class="spacer">
</div>
If the input is a certificate request, a self-signed certificate is created using the supplied private key using the subject name in the request.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-x509toreq</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Converts a certificate into a certificate request. The <b class="flag">-signkey</b> option is used to pass the required private key.</dd>
</dl>
</div>
<div class="section">
<h1 id="x58353039204e414d45204f5054494f4e53">X509 NAME OPTIONS</h1> The <b class="flag">-nameopt</b> command line switch determines how the subject and issuer names are displayed. If no <b class="flag">-nameopt</b> switch is present, the default &#8220;oneline&#8221; format is used which is compatible with previous versions of <b class="name">OpenSSL</b>. Each option is described in detail below; all options can be preceded by a &#8216;-&#8217; to turn the option off. Only <i class="arg">compat</i>, <i class="arg">RFC2253</i>, <i class="arg">oneline</i>, and <i class="arg">multiline</i> will normally be used.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">align</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Align field values for a more readable output. Only usable with <i class="arg">sep_multiline</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">compat</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Use the old format. This is equivalent to specifying no name options at all.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">dn_rev</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Reverse the fields of the DN. This is required by RFC 2253. As a side effect, this also reverses the order of multiple AVAs but this is permissible.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">dump_all</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Dump all fields. This option, when used with <i class="arg">dump_der</i>, allows the DER encoding of the structure to be unambiguously determined.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">dump_der</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
When this option is set, any fields that need to be hexdumped will be dumped using the DER encoding of the field. Otherwise just the content octets will be displayed. Both options use the RFC 2253 #XXXX... format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">dump_nostr</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Dump non-character string types (for example OCTET STRING); if this option is not set, non-character string types will be displayed as though each content octet represents a single character.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">dump_unknown</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Dump any field whose OID is not recognised by <b class="name">OpenSSL</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">esc_2253</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Escape the &#8220;special&#8221; characters required by RFC 2253 in a field that is &#8220; ,+&quot;&lt;&gt;;&#8221;. Additionally, &#8216;#&#8217; is escaped at the beginning of a string and a space character at the beginning or end of a string.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">esc_ctrl</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Escape control characters. That is, those with ASCII values less than 0x20 (space) and the delete (0x7f) character. They are escaped using the RFC 2253 \XX notation (where XX are two hex digits representing the character value).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">esc_msb</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Escape characters with the MSB set; that is, with ASCII values larger than 127.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">multiline</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A multiline format. It is equivalent to <i class="arg">esc_ctrl</i>, <i class="arg">esc_msb</i>, <i class="arg">sep_multiline</i>, <i class="arg">space_eq</i>, <i class="arg">lname</i>, and <i class="arg">align</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">no_type</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This option does not attempt to interpret multibyte characters in any way. That is, their content octets are merely dumped as though one octet represents each character. This is useful for diagnostic purposes but will result in rather odd looking output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">nofname</i>, <i class="arg">sname</i>, <i class="arg">lname</i>, <i class="arg">oid</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
These options alter how the field name is displayed. <i class="arg">nofname</i> does not display the field at all. <i class="arg">sname</i> uses the &#8220;short name&#8221; form (CN for <i class="arg">commonName</i>, for example). <i class="arg">lname</i> uses the long form. <i class="arg">oid</i> represents the OID in numerical form and is useful for diagnostic purpose.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">oneline</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A oneline format which is more readable than <i class="arg">RFC2253</i>. It is equivalent to specifying the <i class="arg">esc_2253</i>, <i class="arg">esc_ctrl</i>, <i class="arg">esc_msb</i>, <i class="arg">utf8</i>, <i class="arg">dump_nostr</i>, <i class="arg">dump_der</i>, <i class="arg">use_quote</i>, <i class="arg">sep_comma_plus_spc</i>, <i class="arg">space_eq</i>, and <i class="arg">sname</i> options.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">RFC2253</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Displays names compatible with RFC 2253; equivalent to <i class="arg">esc_2253</i>, <i class="arg">esc_ctrl</i>, <i class="arg">esc_msb</i>, <i class="arg">utf8</i>, <i class="arg">dump_nostr</i>, <i class="arg">dump_unknown</i>, <i class="arg">dump_der</i>, <i class="arg">sep_comma_plus</i>, <i class="arg">dn_rev</i>, and <i class="arg">sname</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sep_comma_plus</i>, <i class="arg">sep_comma_plus_space</i>, <i class="arg">sep_semi_plus_space</i>, <i class="arg">sep_multiline</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
These options determine the field separators. The first character is between RDNs and the second between multiple AVAs (multiple AVAs are very rare and their use is discouraged). The options ending in &#8220;space&#8221; additionally place a space after the separator to make it more readable. The <i class="arg">sep_multiline</i> uses a linefeed character for the RDN separator and a spaced &#8216;+&#8217; for the AVA separator. It also indents the fields by four characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">show_type</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Show the type of the ASN1 character string. The type precedes the field contents. For example &#8220;BMPSTRING: Hello World&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">space_eq</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Places spaces round the &#8216;=&#8217; character which follows the field name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">use_quote</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Escapes some characters by surrounding the whole string with &#8216;&quot;&#8217; characters. Without the option, all escaping is done with the &#8216;\&#8217; character.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">utf8</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Convert all strings to UTF8 format first. This is required by RFC 2253. If you are lucky enough to have a UTF8 compatible terminal, the use of this option (and <span class="emph">not</span> setting <i class="arg">esc_msb</i>) may result in the correct display of multibyte (international) characters. If this option is not present, multibyte characters larger than 0xff will be represented using the format \UXXXX for 16 bits and \WXXXXXXXX for 32 bits. Also, if this option is off, any UTF8Strings will be converted to their character form first.</dd>
</dl>
</div>
<div class="section">
<h1 id="x583530392054455854204f5054494f4e53">X509 TEXT OPTIONS</h1> As well as customising the name output format, it is also possible to customise the actual fields printed using the <b class="flag">-certopt</b> options when the <b class="flag">-text</b> option is present. The default behaviour is to print all fields.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">ca_default</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The value used by the <b class="name">ca</b> utility; equivalent to <i class="arg">no_issuer</i>, <i class="arg">no_pubkey</i>, <i class="arg">no_header</i>, <i class="arg">no_version</i>, <i class="arg">no_sigdump</i>, and <i class="arg">no_signame</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">compatible</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Use the old format. This is equivalent to specifying no output options at all.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">ext_default</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Retain default extension behaviour: attempt to print out unsupported certificate extensions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">ext_dump</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Hex dump unsupported extensions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">ext_error</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Print an error message for unsupported certificate extensions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">ext_parse</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
ASN1 parse unsupported extensions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">no_aux</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't print out certificate trust information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">no_extensions</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't print out any X509V3 extensions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">no_header</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't print header information: that is, the lines saying &#8220;Certificate&#8221; and &#8220;Data&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">no_issuer</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't print out the issuer name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">no_pubkey</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't print out the public key.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">no_serial</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't print out the serial number.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">no_sigdump</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't give a hexadecimal dump of the certificate signature.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">no_signame</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't print out the signature algorithm used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">no_subject</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't print out the subject name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">no_validity</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't print the validity; that is, the <span class="emph">notBefore</span> and <span class="emph">notAfter</span> fields.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">no_version</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't print out the version number.</dd>
</dl>
</div>
<div class="section">
<h1 id="x58353039204558414d504c4553">X509 EXAMPLES</h1> Display the contents of a certificate:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl x509 -in cert.pem -noout -text</code></div>
</blockquote>
<div class="spacer">
</div>
Display the certificate serial number:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl x509 -in cert.pem -noout -serial</code></div>
</blockquote>
<div class="spacer">
</div>
Display the certificate subject name:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl x509 -in cert.pem -noout -subject</code></div>
</blockquote>
<div class="spacer">
</div>
Display the certificate subject name in RFC 2253 form:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl x509 -in cert.pem -noout -subject -nameopt RFC2253</code></div>
</blockquote>
<div class="spacer">
</div>
Display the certificate subject name in oneline form on a terminal supporting UTF8:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl x509 -in cert.pem -noout -subject \ 
	-nameopt oneline,-esc_msb</pre>
<div class="spacer">
</div>
Display the certificate MD5 fingerprint:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl x509 -in cert.pem -noout -fingerprint</code></div>
</blockquote>
<div class="spacer">
</div>
Display the certificate SHA1 fingerprint:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl x509 -sha1 -in cert.pem -noout -fingerprint</code></div>
</blockquote>
<div class="spacer">
</div>
Convert a certificate from PEM to DER format:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl x509 -in cert.pem -inform PEM -out cert.der -outform DER</code></div>
</blockquote>
<div class="spacer">
</div>
Convert a certificate to a certificate request:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl x509 -x509toreq -in cert.pem -out req.pem \ 
	-signkey key.pem</pre>
<div class="spacer">
</div>
Convert a certificate request into a self-signed certificate using extensions for a CA:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl x509 -req -in careq.pem -extfile openssl.cnf -extensions \ 
	v3_ca -signkey key.pem -out cacert.pem</pre>
<div class="spacer">
</div>
Sign a certificate request using the CA certificate above and add user certificate extensions:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl x509 -req -in req.pem -extfile openssl.cnf -extensions \ 
	v3_usr -CA cacert.pem -CAkey key.pem -CAcreateserial</pre>
<div class="spacer">
</div>
Set a certificate to be trusted for SSL client use and set its alias to &#8220;Steve's Class 1 CA&#8221;:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ openssl x509 -in cert.pem -addtrust clientAuth \ 
	-setalias &quot;Steve's Class 1 CA&quot; -out trust.pem</pre>
</div>
<div class="section">
<h1 id="x58353039204e4f544553">X509 NOTES</h1> The PEM format uses the header and footer lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN CERTIFICATE----- 
-----END CERTIFICATE-----</pre>
<div class="spacer">
</div>
It will also handle files containing:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN X509 CERTIFICATE----- 
-----END X509 CERTIFICATE-----</pre>
<div class="spacer">
</div>
Trusted certificates have the lines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
-----BEGIN TRUSTED CERTIFICATE----- 
-----END TRUSTED CERTIFICATE-----</pre>
<div class="spacer">
</div>
The conversion to UTF8 format used with the name options assumes that T61Strings use the ISO 8859-1 character set. This is wrong, but Netscape and MSIE do this, as do many certificates. So although this is incorrect it is more likely to display the majority of certificates correctly.<div class="spacer">
</div>
The <b class="flag">-fingerprint</b> option takes the digest of the DER-encoded certificate. This is commonly called a &#8220;fingerprint&#8221;. Because of the nature of message digests, the fingerprint of a certificate is unique to that certificate and two certificates with the same fingerprint can be considered to be the same.<div class="spacer">
</div>
The Netscape fingerprint uses MD5, whereas MSIE uses SHA1.<div class="spacer">
</div>
The <b class="flag">-email</b> option searches the subject name and the subject alternative name extension. Only unique email addresses will be printed out: it will not print the same address more than once.</div>
<div class="section">
<h1 id="x582e35303920434552544946494341544520455854454e53494f4e53">X.509 CERTIFICATE EXTENSIONS</h1> The <b class="flag">-purpose</b> option checks the certificate extensions and determines what the certificate can be used for. The actual checks done are rather complex and include various hacks and workarounds to handle broken certificates and software.<div class="spacer">
</div>
The same code is used when verifying untrusted certificates in chains, so this section is useful if a chain is rejected by the verify code.<div class="spacer">
</div>
The <span class="emph">basicConstraints</span> extension CA flag is used to determine whether the certificate can be used as a CA. If the CA flag is true, it is a CA; if the CA flag is false, it is not a CA. <span class="emph">All</span> CAs should have the CA flag set to true.<div class="spacer">
</div>
If the <span class="emph">basicConstraints</span> extension is absent, then the certificate is considered to be a &#8220;possible CA&#8221;; other extensions are checked according to the intended use of the certificate. A warning is given in this case because the certificate should really not be regarded as a CA: however, it is allowed to be a CA to work around some broken software.<div class="spacer">
</div>
If the certificate is a V1 certificate (and thus has no extensions) and it is self-signed, it is also assumed to be a CA but a warning is again given: this is to work around the problem of Verisign roots which are V1 self-signed certificates.<div class="spacer">
</div>
If the <span class="emph">keyUsage</span> extension is present, then additional restraints are made on the uses of the certificate. A CA certificate <span class="emph">must</span> have the <span class="emph">keyCertSign</span> bit set if the <span class="emph">keyUsage</span> extension is present.<div class="spacer">
</div>
The extended key usage extension places additional restrictions on the certificate uses. If this extension is present (whether critical or not), the key can only be used for the purposes specified.<div class="spacer">
</div>
A complete description of each test is given below. The comments about <span class="emph">basicConstraints</span> and <span class="emph">keyUsage</span> and V1 certificates above apply to <span class="emph">all</span> CA certificates.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">SSL Client</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The extended key usage extension must be absent or include the &#8220;web client authentication&#8221; OID. <i class="arg">keyUsage</i> must be absent or it must have the <span class="emph">digitalSignature</span> bit set. Netscape certificate type must be absent or it must have the SSL client bit set.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">SSL Client CA</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The extended key usage extension must be absent or include the &#8220;web client authentication&#8221; OID. Netscape certificate type must be absent or it must have the SSL CA bit set: this is used as a work around if the <span class="emph">basicConstraints</span> extension is absent.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">SSL Server</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The extended key usage extension must be absent or include the &#8220;web server authentication&#8221; and/or one of the SGC OIDs. <span class="emph">keyUsage</span> must be absent or it must have the <span class="emph">digitalSignature</span> set, the <span class="emph">keyEncipherment</span> set, or both bits set. Netscape certificate type must be absent or have the SSL server bit set.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">SSL Server CA</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The extended key usage extension must be absent or include the &#8220;web server authentication&#8221; and/or one of the SGC OIDs. Netscape certificate type must be absent or the SSL CA bit must be set: this is used as a work around if the <span class="emph">basicConstraints</span> extension is absent.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">Netscape SSL Server</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
For Netscape SSL clients to connect to an SSL server; it must have the <span class="emph">keyEncipherment</span> bit set if the <span class="emph">keyUsage</span> extension is present. This isn't always valid because some cipher suites use the key for digital signing. Otherwise it is the same as a normal SSL server.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">Common S/MIME Client Tests</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The extended key usage extension must be absent or include the &#8220;email protection&#8221; OID. Netscape certificate type must be absent or should have the <span class="emph">S/MIME</span> bit set. If the <span class="emph">S/MIME</span> bit is not set in Netscape certificate type, then the SSL client bit is tolerated as an alternative but a warning is shown: this is because some Verisign certificates don't set the <span class="emph">S/MIME</span> bit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">S/MIME Signing</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
In addition to the common <span class="emph">S/MIME</span> client tests, the <span class="emph">digitalSignature</span> bit must be set if the <span class="emph">keyUsage</span> extension is present.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">S/MIME Encryption</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
In addition to the common <span class="emph">S/MIME</span> tests, the <span class="emph">keyEncipherment</span> bit must be set if the <span class="emph">keyUsage</span> extension is present.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">S/MIME CA</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The extended key usage extension must be absent or include the &#8220;email protection&#8221; OID. Netscape certificate type must be absent or must have the <span class="emph">S/MIME CA</span> bit set: this is used as a work around if the <span class="emph">basicConstraints</span> extension is absent.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">CRL Signing</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The <span class="emph">keyUsage</span> extension must be absent or it must have the <span class="emph">CRL</span> signing bit set.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">CRL Signing CA</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The normal CA tests apply. Except in this case the <span class="emph">basicConstraints</span> extension must be present.</dd>
</dl>
</div>
<div class="section">
<h1 id="x583530392042554753">X509 BUGS</h1> Extensions in certificates are not transferred to certificate requests and vice versa.<div class="spacer">
</div>
It is possible to produce invalid certificates or requests by specifying the wrong private key or using inconsistent options in some cases: these should be checked.<div class="spacer">
</div>
There should be options to explicitly set such things as start and end dates, rather than an offset from the current time.<div class="spacer">
</div>
The code to implement the verify behaviour described in the <i class="link-sec"><a class="link-sec" href="#x583530392054525553542053455454494e4753">X509 TRUST SETTINGS</a></i> is currently being developed. It thus describes the intended behaviour rather than the current behaviour. It is hoped that it will represent reality in <b class="name">OpenSSL</b> 0.9.5 and later.</div>
<div class="section">
<h1 id="x5835303920484953544f5259">X509 HISTORY</h1> Before <b class="name">OpenSSL</b> 0.9.8, the default digest for RSA keys was MD5.<div class="spacer">
</div>
The hash algorithm used in the <b class="flag">-subject_hash</b> and <b class="flag">-issuer_hash</b> options before <b class="name">OpenSSL</b> 1.0.0 was based on the deprecated MD5 algorithm and the encoding of the distinguished name. In <b class="name">OpenSSL</b> 1.0.0 and later it is based on a canonical version of the DN using SHA1. This means that any directories using the old form must have their links rebuilt using <i class="arg">c_rehash</i> or similar.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/ssl/</i></dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
Default config directory for <b class="name">openssl</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/ssl/lib/</i></dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
Unused.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/ssl/private/</i></dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
Default private key directory.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/ssl/openssl.cnf</i></dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
Default configuration file for <b class="name">openssl</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/ssl/x509v3.cnf</i></dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
Default configuration file for <b class="name">x509</b> certificates.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/nc.html">nc(1)</a>, <a class="link-man" href="../html8/ssl.html">ssl(8)</a>, <a class="link-man" href="../html8/starttls.html">starttls(8)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> <span class="ref"><span class="ref-title">The SSL Protocol</span>, <span class="ref-corp">Netscape Communications Corp.</span>, <span class="ref-date">February 1995</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-title">The SSL 3.0 Protocol</span>, <span class="ref-corp">Netscape Communications Corp.</span>, <span class="ref-date">November 1996</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">T. Dierks</span> and <span class="ref-auth">C. Allen</span>, <span class="ref-title">The TLS Protocol Version 1.0</span>, <span class="ref-rep">RFC 2246</span>, <span class="ref-date">January 1999</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">M. Wahl</span>, <span class="ref-auth">S. Killie</span>, and <span class="ref-auth">T. Howes</span>, <span class="ref-title">Lightweight Directory Access Protocol (v3): UTF-8 String Representation of Distinguished Names</span>, <span class="ref-rep">RFC 2253</span>, <span class="ref-date">December 1997</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">B. Kaliski</span>, <span class="ref-title">PKCS #7: Cryptographic Message Syntax Version 1.5</span>, <span class="ref-rep">RFC 2315</span>, <span class="ref-date">March 1998</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">R. Housley</span>, <span class="ref-auth">W. Ford</span>, <span class="ref-auth">W. Polk</span>, and <span class="ref-auth">D. Solo</span>, <span class="ref-title">Internet X.509 Public Key Infrastructure Certificate and CRL Profile</span>, <span class="ref-rep">RFC 2459</span>, <span class="ref-date">January 1999</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">M. Myers</span>, <span class="ref-auth">R. Ankney</span>, <span class="ref-auth">A. Malpani</span>, <span class="ref-auth">S. Galperin</span>, and <span class="ref-auth">C. Adams</span>, <span class="ref-title">X.509 Internet Public Key Infrastructure Online Certificate Status Protocol &#8211; OCSP</span>, <span class="ref-rep">RFC 2560</span>, <span class="ref-date">June 1999</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">R. Housley</span>, <span class="ref-title">Cryptographic Message Syntax</span>, <span class="ref-rep">RFC 2630</span>, <span class="ref-date">June 1999</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">P. Chown</span>, <span class="ref-title">Advanced Encryption Standard (AES) Ciphersuites for Transport Layer Security (TLS)</span>, <span class="ref-rep">RFC 3268</span>, <span class="ref-date">June 2002</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <a class="link-man" href="../html1/openssl.html">openssl(1)</a> document appeared in <b class="name">OpenSSL</b> 0.9.2. The <b class="flag">list-</b>XXX<b class="flag">-commands</b> pseudo-commands were added in <b class="name">OpenSSL</b> 0.9.3; the <b class="flag">no-</b>XXX pseudo-commands were added in <b class="name">OpenSSL</b> 0.9.5a; the <b class="flag">list-</b>XXX<b class="flag">-algorithms</b> pseudo-commands were added in <b class="name">OpenSSL</b> 1.0.0.</div>
</div>
</body>
</html>

