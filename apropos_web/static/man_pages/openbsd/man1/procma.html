<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
PROCMAP(1)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">procmap</b> &#8212; <span class="desc">display process memory map</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 7.00ex;"/>
<col/>
<tbody>
<tr>
<td>
procmap</td>
<td>
[<span class="opt"><b class="flag">-AadlmPsv</b></span>] [<span class="opt"><b class="flag">-D</b> <i class="arg">number</i></span>] [<span class="opt"><b class="flag">-M</b> <i class="arg">core</i></span>] [<span class="opt"><b class="flag">-N</b> <i class="arg">system</i></span>] [<span class="opt"><b class="flag">-p</b> <i class="arg">pid</i></span>] [<span class="opt"><i class="arg">pid ...</i></span>]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">procmap</b> utility lists the virtual memory mappings underlying the given process. The start address of each entry is always given and, depending on the options given, other information such as the end address, the underlying file's device and inode numbers, and various protection information will be displayed, along with the path to the file, if such data is available.<div class="spacer">
</div>
By default, <b class="name">procmap</b> displays information for its parent process, so that when run from a shell prompt, the shell's memory information is displayed. If other PIDs are given as arguments on the command line, information for those processes will be printed also. If the special PID of 0 is given, then information for the kernel's memory map is printed.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-A</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Print more detailed information on anonymous map usage.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-a</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Display &#8220;all&#8221; information from the process's memory map. This output mode is an amalgam of the contents of the Solaris, Linux, and <span class="unix">OpenBSD</span> style output modes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-D</b> <i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Enable various debug facilities. The <i class="arg">number</i> is a bit mask of the values:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">1</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
dump the process's vmspace structure</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">2</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
dump the process's vm_map structure</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">4</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
dump the vm_map.header structure</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">8</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
dump each vm_map_entry in its entirety</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">16</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
dump the namei cache as it is traversed</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Dumps the vm_map and vm_map_entry structures in a style similar to that of <a class="link-man" href="../html4/ddb.html">ddb(4)</a>. When combined with the <b class="flag">-v</b> option, the device number, inode number, name, vnode addresses, or other identifying information from the vm_map_entry fields will be printed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-l</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Dumps information in a format like the contents of the maps pseudo-file under the <i class="file">/proc</i> file system which was, in turn, modeled after the similarly named entry in the Linux <i class="file">/proc</i> file system. When combined with the <b class="flag">-v</b> option, identifiers for all entries are printed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-M</b> <i class="arg">core</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Extract values associated with the name list from the specified core instead of the default <i class="file">/dev/kmem</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-m</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Dumps information in the same format as the map pseudo-file of the <i class="file">/proc</i> file system. When the <b class="flag">-v</b> option is also given, device number, inode number, and filename or other identifying information is printed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-N</b> <i class="arg">system</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Extract the name list from the specified system instead of the running kernel.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-P</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Causes <b class="name">procmap</b> to print information about itself.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-p</b> <i class="arg">pid</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Tells <b class="name">procmap</b> to print information about the given process. If <b class="flag">-p</b> <i class="arg">pid</i> occurs last on the command line, the <b class="flag">-p</b> is optional.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-s</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The Solaris style output format, modeled after the Solaris command &#8220;pmap&#8221;. This is the default output style.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-v</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Verbose output. When used with <b class="flag">-d</b>, <b class="flag">-l</b>, or <b class="flag">-m</b>, more information is printed, possibly including device and inode numbers, file path names, or other identifying information. If specified more than once, a &#8216;*&#8217; will be printed in between two entries that are not adjacent, making the visual identification of spaces in the process's map easier to see.</dd>
</dl>
<div class="spacer">
</div>
The <b class="flag">-P</b> and <b class="flag">-p</b> options override each other, so the last one to appear on the command line takes effect. If you do wish to see information about <b class="name">procmap</b> and another process as the same time, simply omit the <b class="flag">-p</b> and place the extra PID at the end of the command line.</div>
<div class="section">
<h1 id="x4558495420535441545553">EXIT STATUS</h1> The <b class="utility">procmap</b> utility exits&#160;0 on success, and&#160;&gt;0 if an error occurs.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> While the meaning most of the output is self-evident, some pieces of it may appear to be a little inscrutable.<div class="spacer">
</div>
Here a portion of the default output from <b class="name">procmap</b> being run at a <a class="link-man" href="../html1/sh.html">sh(1)</a> prompt shows the starting address of the map entry, the size of the map entry, the current protection level of the map entry, and either the name of the file backing the entry or some other descriptive text.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ procmap 
08048000    420K read/exec         /bin/sh 
080B1000      8K read/write        /bin/sh 
080B3000     28K read/write          [ anon ] 
080BA000     16K read/write/exec     [ heap ] 
...</pre>
<div class="spacer">
</div>
When the <a class="link-man" href="../html4/ddb.html">ddb(4)</a> output style is selected, the first thing printed is the contents of the vm_map structure, followed by the individual map entries.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ procmap -d 
MAP 0xcf7cac84: [0x0-&gt;0xbfbfe000] 
        #ent=8, sz=34041856, ref=1, version=20, flags=0x21 
        pmap=0xcf44cee0(resident=&lt;unknown&gt;) 
 - 0xcfa3a358: 0x8048000-&gt;0x80b1000: obj=0xcf45a8e8/0x0, amap=0x0/0 
        submap=F, cow=T, nc=T, prot(max)=5/7, inh=1, wc=0, adv=0 
...</pre>
<div class="spacer">
</div>
The value of the flags field (in hexadecimal) is taken from the include file <b class="includes">&lt;<a class="link-includes">uvm/uvm_map.h</a>&gt;</b>:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
VM_MAP_PAGEABLE		0x01	ro: entries are pageable 
VM_MAP_INTRSAFE		0x02	ro: interrupt safe map 
VM_MAP_WIREFUTURE	0x04	rw: wire future mappings 
VM_MAP_BUSY		0x08	rw: map is busy 
VM_MAP_WANTLOCK		0x10	rw: want to write-lock</pre>
<div class="spacer">
</div>
The &#8220;submap&#8221;, &#8220;cow&#8221;, and &#8220;nc&#8221; fields are true or false, and indicate whether the map is a submap, whether it is marked for copy on write, and whether it needs a copy. The &#8220;prot&#8221; (or protection) field, along with &#8220;max&#8221; (maximum protection allowed) are made up of the following flags from <b class="includes">&lt;<a class="link-includes">uvm/uvm_extern.h</a>&gt;</b>:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
PROT_READ	0x01	read allowed 
PROT_WRITE	0x02	write allowed 
PROT_EXEC	0x04	execute allowed</pre>
<div class="spacer">
</div>
The &#8220;obj&#8221; and &#8220;amap&#8221; fields are pointers to, and offsets into, the underlying uvm_object or vm_amap object. The value for resident is always unknown because digging such information out of the kernel is beyond the scope of this application.<div class="spacer">
</div>
The two output styles that mirror the contents of the <i class="file">/proc</i> file system appear as follows:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ procmap -m 
0x8048000 0x80b1000 r-x rwx COW NC 1 0 0 
0x80b1000 0x80b3000 rw- rwx COW NC 1 0 0 
0x80b3000 0x80ba000 rw- rwx COW NNC 1 0 0 
0x80ba000 0x80be000 rwx rwx COW NNC 1 0 0 
... 
 
$ procmap -l 
08048000-080b1000 r-xp 00000000 00:00 70173     /bin/sh 
080b1000-080b3000 rw-p 00068000 00:00 70173     /bin/sh 
080b3000-080ba000 rw-p 00000000 00:00 0 
080ba000-080be000 rwxp 00000000 00:00 0 
...</pre>
<div class="spacer">
</div>
Here the protection and maximum protection values are indicated with &#8216;r&#8217;, &#8216;w&#8217;, and &#8216;x&#8217; characters, indicating read permission, write permission, and execute permission, respectively. The &#8220;COW&#8221;, &#8220;NC&#8221;, and &#8220;NNC&#8221; values that follow indicate, again, that the map is marked for copy on write and either needs or does not need a copy. It is also possible to see the value &#8220;NCOW&#8221; here, which indicates that an entry will not be copied. The three following numbers indicate the inheritance type of the map, the wired count of the map, and any advice value assigned via <a class="link-man" href="../html2/madvise.html">madvise(2)</a>.<div class="spacer">
</div>
In the second form, the permissions indicated are followed by a &#8216;p&#8217; or &#8216;s&#8217; character indicating whether the map entry is private or shared (copy on write or not), and the numbers are the offset into the underlying object, the device and numbers of the object if it is a file, and the path to the file (if available).<div class="spacer">
</div>
As noted above (see section <i class="link-sec"><a class="link-sec" href="#x4445534352495054494f4e">DESCRIPTION</a></i>), the &#8220;all&#8221; output format is an amalgam of the previous output formats.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ procmap -a 
Start    End         Size  Offset   rwxpc  RWX  I/W/A ... 
08048000-080b0fff     420k 00000000 r-xp+ (rwx) 1/0/0 ... 
...</pre>
<div class="spacer">
</div>
In this format, the column labeled &#8220;rwxpc&#8221; contains the permissions for the mapping along with the shared/private flag, and a character indicating whether the mapping needs to be copied on write (&#8216;+&#8217;) or has already been copied (&#8216;-&#8217;) and is followed by a column that indicates the maximum permissions for the map entry. The column labeled &#8220;I/W/A&#8221; indicates the inheritance, wired, and advice values for the map entry, as previously described.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/ls.html">ls(1)</a>, <a class="link-man" href="../html2/madvise.html">madvise(2)</a>, <a class="link-man" href="../html2/mmap.html">mmap(2)</a>, <a class="link-man" href="../html3/kvm.html">kvm(3)</a>, <a class="link-man" href="../html4/ddb.html">ddb(4)</a>, <a class="link-man" href="../html9/namei.html">namei(9)</a>, <a class="link-man" href="../html9/vnode.html">vnode(9)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">procmap</b> utility first appeared in <span class="unix">OpenBSD&#160;3.5</span>. It was derived from the <span class="unix">NetBSD</span> utility known as &#8220;pmap&#8221;.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="name">procmap</b> utility and documentation was written by <span class="author">Andrew Brown</span> &lt;<a class="link-mail" href="mailto:atatat@netbsd.org">atatat@netbsd.org</a>&gt;.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Very little will work unless <b class="name">procmap</b> is reading from the correct kernel in order to retrieve the proper symbol information.<div class="spacer">
</div>
Since processes can change state while <b class="name">procmap</b> is running, some of the information printed may be inaccurate. This is especially important to consider when examining the kernel's map, since merely executing <b class="name">procmap</b> will cause some of the information to change.<div class="spacer">
</div>
The pathnames to files backing certain vnodes (such as the text and data sections of programs and shared libraries) are extracted from the kernel's namei cache which is considerably volatile. If a path is not found there in its entirety, as much information as was available will be printed. In most cases, simply running <a class="link-man" href="../html1/ls.html">ls(1)</a> with the expected path to the file will cause the information to be reentered into the cache.<div class="spacer">
</div>
The Solaris version (&#8220;pmap&#8221;) has some interesting command line flags that would be nice to emulate here. In particular, the <b class="flag">-r</b> option that lists a process's reserved addresses, and the <b class="flag">-x</b> option that prints resident/shared/private mapping details for each entry.<div class="spacer">
</div>
Some of the output modes can be or are wider than the standard 80 columns of a terminal. Some sort of formatting might be nice.</div>
</div>
</body>
</html>

