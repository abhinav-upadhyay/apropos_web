<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
X99TOKEN(1)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">x99token</b> &#8212; <span class="desc">X9.9 software token calculator</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 8.00ex;"/>
<col/>
<tbody>
<tr>
<td>
x99token</td>
<td>
[<span class="opt"><b class="flag">-d</b></span>] [<span class="opt"><b class="flag">-k</b> <i class="arg">keyfile</i></span>] [<span class="opt"><b class="flag">-n</b> <i class="arg">count</i></span>]</td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 8.00ex;"/>
<col/>
<tbody>
<tr>
<td>
x99token</td>
<td>
<b class="flag">-i</b> [<span class="opt"><b class="flag">-k</b> <i class="arg">keyfile</i></span>]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">x99token</b> program is a simple X9.9 software token calculator. The token is initialized by using the <b class="flag">-i</b> option. In this mode, <b class="name">x99token</b> requests a key. The key consists of 8 bytes encoded in either hex or octal. When encoded in hex the key must consist of 16 hex digits, no spaces (e.g., &quot;0123456789abcdef&quot;). When encoded in octal the key must consist of 8 3-digit octets, each separated by exactly one space (e.g., &quot;001 010 100 002 020 200 003 030&quot;). Once the key is entered, a PIN number is requested. The PIN number is used to perturb the key before it is stored in a keyfile. This perturbation is not terribly secure. You should assume that anyone with access to your keyfile will also have access to your key.<div class="spacer">
</div>
When <b class="flag">-i</b> is not specified, <b class="name">x99token</b> is in calculator mode. In this mode you must enter the same PIN as used in the initialization step. The PIN is used to decode the key read from the keyfile. Next you enter the challenge you have been presented with. The <b class="name">x99token</b> program will provide you with a response to the challenge. If the <b class="flag">-d</b> option is used, the response will fold any hex digits to decimal. If a <i class="arg">count</i> is specified by <b class="flag">-n</b>, it indicates the number of challenges to predict. The first challenge is always the entered challenge. By default the value of <i class="arg">count</i> is 1, which implies only the entered challenge is resolved.<div class="spacer">
</div>
Future challenges are predicted by the following algorithm:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
Encrypt the current challenge with the shared secret key</li>
<li class="list-bul" style="margin-top: 1.00em;">
AND each byte of the response with 0x0f</li>
<li class="list-bul" style="margin-top: 1.00em;">
Modulo each byte by 10 (0x0a)</li>
<li class="list-bul" style="margin-top: 1.00em;">
ADD 0x30 (ASCII value of '0') to each byte</li>
</ul>
<div class="spacer">
</div>
The resulting 8 bytes are all ASCII decimal digits and are the predicted challenge. This process may be repeated.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">$HOME/.keyfile.des</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
default keyfile</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html8/tokenadm.html">tokenadm(8)</a>, <a class="link-man" href="../html8/tokeninit.html">tokeninit(8)</a></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Paul Borman</span> &lt;<a class="link-mail" href="mailto:prb@krystal.com">prb@krystal.com</a>&gt;</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> This is a very simple-minded program. The keyfile should be placed on a flash disk which is kept physically secure.<div class="spacer">
</div>
Having not read the X9.9 standard, this may not be a complete or accurate implementation of the standard. This software is provided AS IS with no express or implied warranty.</div>
</div>
</body>
</html>

