<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
ICMP6(4)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">icmp6</b> &#8212; <span class="desc">Internet Control Message Protocol for IPv6</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/socket.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">netinet/in.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">netinet/icmp6.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">socket</b>(<i class="farg" style="white-space:nowrap;">AF_INET6</i>, <i class="farg" style="white-space:nowrap;">SOCK_RAW</i>, <i class="farg" style="white-space:nowrap;">IPPROTO_ICMPV6</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> ICMPv6 is the error and control message protocol used by IPv6 and the IPv6 protocol family (see <a class="link-man" href="../html4/ip6.html">ip6(4)</a> and <a class="link-man" href="../html4/inet6.html">inet6(4)</a>). It may be accessed through a &#8220;raw socket&#8221; for network monitoring and diagnostic functions.<div class="spacer">
</div>
The <i class="farg">proto</i> parameter to the <a class="link-man" href="../html2/socket.html">socket(2)</a> call to create an ICMPv6 socket may be obtained from <a class="link-man" href="../html3/getprotobyname.html">getprotobyname(3)</a>. ICMPv6 sockets are connectionless, and are normally used with the <a class="link-man" href="../html2/sendto.html">sendto(2)</a> and <a class="link-man" href="../html2/recvfrom.html">recvfrom(2)</a> calls, though the <a class="link-man" href="../html2/connect.html">connect(2)</a> call may also be used to fix the destination for future packets (in which case <a class="link-man" href="../html2/read.html">read(2)</a> or <a class="link-man" href="../html2/recv.html">recv(2)</a> and <a class="link-man" href="../html2/write.html">write(2)</a> or <a class="link-man" href="../html2/send.html">send(2)</a> system calls may be used).<div class="spacer">
</div>
Outgoing packets automatically have an IPv6 header prepended to them (based on the destination address). Incoming packets on the socket are received with the IPv6 header and any extension headers removed.<div class="subsection">
<h2 id="x5479706573">Types</h2> ICMPv6 messages are classified according to the type and code fields present in the ICMPv6 header. The abbreviations for the types and codes may be used in rules in <a class="link-man" href="../html5/pf.conf.html">pf.conf(5)</a>. The following types are defined:<table style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-col">
<col style="width: 3.00ex;"/>
<col style="width: 10.00ex;"/>
<col style="min-width: 11.00ex;"/>
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Num</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Abbrev.</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Description</span></td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
1</td>
<td class="list-col" style="margin-top: 1.00em;">
unreach</td>
<td class="list-col" style="margin-top: 1.00em;">
Destination unreachable</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
2</td>
<td class="list-col" style="margin-top: 1.00em;">
toobig</td>
<td class="list-col" style="margin-top: 1.00em;">
Packet too big</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
3</td>
<td class="list-col" style="margin-top: 1.00em;">
timex</td>
<td class="list-col" style="margin-top: 1.00em;">
Time exceeded</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
4</td>
<td class="list-col" style="margin-top: 1.00em;">
paramprob</td>
<td class="list-col" style="margin-top: 1.00em;">
Invalid IPv6 header</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
128</td>
<td class="list-col" style="margin-top: 1.00em;">
echoreq</td>
<td class="list-col" style="margin-top: 1.00em;">
Echo service request</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
129</td>
<td class="list-col" style="margin-top: 1.00em;">
echorep</td>
<td class="list-col" style="margin-top: 1.00em;">
Echo service reply</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
130</td>
<td class="list-col" style="margin-top: 1.00em;">
groupqry</td>
<td class="list-col" style="margin-top: 1.00em;">
Group membership query</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
130</td>
<td class="list-col" style="margin-top: 1.00em;">
listqry</td>
<td class="list-col" style="margin-top: 1.00em;">
Multicast listener query</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
131</td>
<td class="list-col" style="margin-top: 1.00em;">
grouprep</td>
<td class="list-col" style="margin-top: 1.00em;">
Group membership report</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
131</td>
<td class="list-col" style="margin-top: 1.00em;">
listenrep</td>
<td class="list-col" style="margin-top: 1.00em;">
Multicast listener report</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
132</td>
<td class="list-col" style="margin-top: 1.00em;">
groupterm</td>
<td class="list-col" style="margin-top: 1.00em;">
Group membership termination</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
132</td>
<td class="list-col" style="margin-top: 1.00em;">
listendone</td>
<td class="list-col" style="margin-top: 1.00em;">
Multicast listener done</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
133</td>
<td class="list-col" style="margin-top: 1.00em;">
routersol</td>
<td class="list-col" style="margin-top: 1.00em;">
Router solicitation</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
134</td>
<td class="list-col" style="margin-top: 1.00em;">
routeradv</td>
<td class="list-col" style="margin-top: 1.00em;">
Router advertisement</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
135</td>
<td class="list-col" style="margin-top: 1.00em;">
neighbrsol</td>
<td class="list-col" style="margin-top: 1.00em;">
Neighbor solicitation</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
136</td>
<td class="list-col" style="margin-top: 1.00em;">
neighbradv</td>
<td class="list-col" style="margin-top: 1.00em;">
Neighbor advertisement</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
137</td>
<td class="list-col" style="margin-top: 1.00em;">
redir</td>
<td class="list-col" style="margin-top: 1.00em;">
Shorter route exists</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
138</td>
<td class="list-col" style="margin-top: 1.00em;">
routrrenum</td>
<td class="list-col" style="margin-top: 1.00em;">
Route renumbering</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
139</td>
<td class="list-col" style="margin-top: 1.00em;">
fqdnreq</td>
<td class="list-col" style="margin-top: 1.00em;">
FQDN query</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
139</td>
<td class="list-col" style="margin-top: 1.00em;">
niqry</td>
<td class="list-col" style="margin-top: 1.00em;">
Node information query</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
139</td>
<td class="list-col" style="margin-top: 1.00em;">
wrureq</td>
<td class="list-col" style="margin-top: 1.00em;">
Who-are-you request</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
140</td>
<td class="list-col" style="margin-top: 1.00em;">
fqdnrep</td>
<td class="list-col" style="margin-top: 1.00em;">
FQDN reply</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
140</td>
<td class="list-col" style="margin-top: 1.00em;">
nirep</td>
<td class="list-col" style="margin-top: 1.00em;">
Node information reply</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
140</td>
<td class="list-col" style="margin-top: 1.00em;">
wrurep</td>
<td class="list-col" style="margin-top: 1.00em;">
Who-are-you reply</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
200</td>
<td class="list-col" style="margin-top: 1.00em;">
mtraceresp</td>
<td class="list-col" style="margin-top: 1.00em;">
mtrace response</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
201</td>
<td class="list-col" style="margin-top: 1.00em;">
mtrace</td>
<td class="list-col" style="margin-top: 1.00em;">
mtrace messages</td>
</tr>
</tbody>
</table>
<div class="spacer">
</div>
The following codes are defined:<table style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-col">
<col style="width: 3.00ex;"/>
<col style="width: 11.00ex;"/>
<col style="width: 9.00ex;"/>
<col style="min-width: 11.00ex;"/>
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Num</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Abbrev.</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Type</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Description</span></td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
0</td>
<td class="list-col" style="margin-top: 1.00em;">
noroute-unr</td>
<td class="list-col" style="margin-top: 1.00em;">
unreach</td>
<td class="list-col" style="margin-top: 1.00em;">
No route to destination</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
1</td>
<td class="list-col" style="margin-top: 1.00em;">
admin-unr</td>
<td class="list-col" style="margin-top: 1.00em;">
unreach</td>
<td class="list-col" style="margin-top: 1.00em;">
Administratively prohibited</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
2</td>
<td class="list-col" style="margin-top: 1.00em;">
beyond-unr</td>
<td class="list-col" style="margin-top: 1.00em;">
unreach</td>
<td class="list-col" style="margin-top: 1.00em;">
Beyond scope of source address</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
2</td>
<td class="list-col" style="margin-top: 1.00em;">
notnbr-unr</td>
<td class="list-col" style="margin-top: 1.00em;">
unreach</td>
<td class="list-col" style="margin-top: 1.00em;">
Not a neighbor (obsolete)</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
3</td>
<td class="list-col" style="margin-top: 1.00em;">
addr-unr</td>
<td class="list-col" style="margin-top: 1.00em;">
unreach</td>
<td class="list-col" style="margin-top: 1.00em;">
Address unreachable</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
4</td>
<td class="list-col" style="margin-top: 1.00em;">
port-unr</td>
<td class="list-col" style="margin-top: 1.00em;">
unreach</td>
<td class="list-col" style="margin-top: 1.00em;">
Port unreachable</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
0</td>
<td class="list-col" style="margin-top: 1.00em;">
transit</td>
<td class="list-col" style="margin-top: 1.00em;">
timex</td>
<td class="list-col" style="margin-top: 1.00em;">
Time exceeded in transit</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
1</td>
<td class="list-col" style="margin-top: 1.00em;">
reassemb</td>
<td class="list-col" style="margin-top: 1.00em;">
timex</td>
<td class="list-col" style="margin-top: 1.00em;">
Time exceeded in reassembly</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
0</td>
<td class="list-col" style="margin-top: 1.00em;">
badhead</td>
<td class="list-col" style="margin-top: 1.00em;">
paramprob</td>
<td class="list-col" style="margin-top: 1.00em;">
Erroneous header field</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
1</td>
<td class="list-col" style="margin-top: 1.00em;">
nxthdr</td>
<td class="list-col" style="margin-top: 1.00em;">
paramprob</td>
<td class="list-col" style="margin-top: 1.00em;">
Unrecognized next header</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
2</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
paramprob</td>
<td class="list-col" style="margin-top: 1.00em;">
Unrecognized option</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
0</td>
<td class="list-col" style="margin-top: 1.00em;">
redironlink</td>
<td class="list-col" style="margin-top: 1.00em;">
redir</td>
<td class="list-col" style="margin-top: 1.00em;">
Redirection to on-link node</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
1</td>
<td class="list-col" style="margin-top: 1.00em;">
redirrouter</td>
<td class="list-col" style="margin-top: 1.00em;">
redir</td>
<td class="list-col" style="margin-top: 1.00em;">
Redirection to better router</td>
</tr>
</tbody>
</table>
</div>
<div class="subsection">
<h2 id="x48656164657273">Headers</h2> All ICMPv6 messages are prefixed with an ICMPv6 header. This header corresponds to the <span class="type">icmp6_hdr</span> structure and has the following definition:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct icmp6_hdr { 
	u_int8_t	icmp6_type;	/* type field */ 
	u_int8_t	icmp6_code;	/* code field */ 
	u_int16_t	icmp6_cksum;	/* checksum field */ 
	union { 
		u_int32_t icmp6_un_data32[1]; /* type-specific */ 
		u_int16_t icmp6_un_data16[2]; /* type-specific */ 
		u_int8_t  icmp6_un_data8[4];  /* type-specific */ 
	} icmp6_dataun; 
} __packed; 
 
#define icmp6_data32	icmp6_dataun.icmp6_un_data32 
#define icmp6_data16	icmp6_dataun.icmp6_un_data16 
#define icmp6_data8	icmp6_dataun.icmp6_un_data8 
#define icmp6_pptr	icmp6_data32[0]	/* parameter prob */ 
#define icmp6_mtu	icmp6_data32[0]	/* packet too big */ 
#define icmp6_id	icmp6_data16[0]	/* echo request/reply */ 
#define icmp6_seq	icmp6_data16[1]	/* echo request/reply */ 
#define icmp6_maxdelay	icmp6_data16[0]	/* mcast group membership*/</pre>
<div class="spacer">
</div>
<b class="var">icmp6_type</b> describes the type of the message. Suitable values are defined in <b class="includes">&lt;<a class="link-includes">netinet/icmp6.h</a>&gt;</b>. <b class="var">icmp6_code</b> describes the sub-type of the message and depends on <b class="var">icmp6_type</b>. <b class="var">icmp6_cksum</b> contains the checksum for the message and is filled in by the kernel on outgoing messages. The other fields are used for type-specific purposes.</div>
<div class="subsection">
<h2 id="x46696c74657273">Filters</h2> Because of the extra functionality of ICMPv6 in comparison to ICMPv4, a larger number of messages may be potentially received on an ICMPv6 socket. Input filters may therefore be used to restrict input to a subset of the incoming ICMPv6 messages so only interesting messages are returned by the <a class="link-man" href="../html2/recv.html">recv(2)</a> family of calls to an application.<div class="spacer">
</div>
The <span class="type">icmp6_filter</span> structure may be used to refine the input message set according to the ICMPv6 type. By default, all messages types are allowed on newly created raw ICMPv6 sockets. The following macros may be used to refine the input set:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="ftype">void</i> <b class="fname">ICMP6_FILTER_SETPASSALL</b>(<i class="farg">struct icmp6_filter *filterp</i>)</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Allow all incoming messages. <b class="var">filterp</b> is modified to allow all message types.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="ftype">void</i> <b class="fname">ICMP6_FILTER_SETBLOCKALL</b>(<i class="farg">struct icmp6_filter *filterp</i>)</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Ignore all incoming messages. <b class="var">filterp</b> is modified to ignore all message types.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="ftype">void</i> <b class="fname">ICMP6_FILTER_SETPASS</b>(<i class="farg">int type</i>, <i class="farg">struct icmp6_filter *filterp</i>)</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Allow ICMPv6 messages with the given <i class="farg">type</i>. <b class="var">filterp</b> is modified to allow such messages.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="ftype">void</i> <b class="fname">ICMP6_FILTER_SETBLOCK</b>(<i class="farg">int type</i>, <i class="farg">struct icmp6_filter *filterp</i>)</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Ignore ICMPv6 messages with the given <i class="farg">type</i>. <b class="var">filterp</b> is modified to ignore such messages.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="ftype">int</i> <b class="fname">ICMP6_FILTER_WILLPASS</b>(<i class="farg">int type</i>, <i class="farg">const struct icmp6_filter *filterp</i>)</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Determine if the given filter will allow an ICMPv6 message of the given type.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="ftype">int</i> <b class="fname">ICMP6_FILTER_WILLBLOCK</b>(<i class="farg">int type</i>, <i class="farg">const struct icmp6_filter *filterp</i>)</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Determine if the given filter will ignore an ICMPv6 message of the given type.</dd>
</dl>
<div class="spacer">
</div>
The <a class="link-man" href="../html2/getsockopt.html">getsockopt(2)</a> and <a class="link-man" href="../html2/setsockopt.html">setsockopt(2)</a> calls may be used to obtain and install the filter on ICMPv6 sockets at option level <span class="define">IPPROTO_ICMPV6</span> and name <span class="define">ICMPV6_FILTER</span> with a pointer to the <span class="type">icmp6_filter</span> structure as the option value.</div>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/getsockopt.html">getsockopt(2)</a>, <a class="link-man" href="../html2/recv.html">recv(2)</a>, <a class="link-man" href="../html2/send.html">send(2)</a>, <a class="link-man" href="../html2/setsockopt.html">setsockopt(2)</a>, <a class="link-man" href="../html2/socket.html">socket(2)</a>, <a class="link-man" href="../html3/getprotobyname.html">getprotobyname(3)</a>, <a class="link-man" href="../html4/inet6.html">inet6(4)</a>, <a class="link-man" href="../html4/ip6.html">ip6(4)</a>, <a class="link-man" href="../html4/netintro.html">netintro(4)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> <span class="ref"><span class="ref-auth">W. Stevens</span>, <span class="ref-auth">M. Thomas</span>, <span class="ref-auth">E. Nordmark</span>, and <span class="ref-auth">T. Jinmei</span>, <span class="ref-title">Advanced Sockets Application Program Interface (API) for IPv6</span>, <span class="ref-rep">RFC 3542</span>, <span class="ref-date">May 2003</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">A. Conta</span>, <span class="ref-auth">S. Deering</span>, and <span class="ref-auth">M. Gupta</span>, <span class="ref-title">Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification</span>, <span class="ref-rep">RFC 4443</span>, <span class="ref-date">March 2006</span>.</span></div>
</div>
</body>
</html>

