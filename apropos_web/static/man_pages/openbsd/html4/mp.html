<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
MPW(4)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">mpw</b> &#8212; <span class="desc">MPLS pseudowire</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">pseudo-device mpw</b><div class="spacer">
</div>
<br/>
<b class="includes">#include &lt;<a class="link-includes">sys/types.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">netmpls/mpls.h</a>&gt;</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">mpw</b> interface is used to create an MPLS layer 2 tunnel between two points.<div class="spacer">
</div>
A <b class="name">mpw</b> interface can be created at runtime using the <span class="symb">ifconfig</span> <b class="name">mpw</b><i class="arg">N</i> <b class="flag">create</b> command or by setting up a <a class="link-man" href="../html5/hostname.if.html">hostname.if(5)</a> configuration file for <a class="link-man" href="../html8/netstart.html">netstart(8)</a>. The interface itself can be configured with <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a>.<div class="spacer">
</div>
The supported pseudowire operation modes are &#8216;<code class="lit">ethernet</code>&#8217; and &#8216;<code class="lit">ethernet-tagged</code>&#8217;. The &#8216;<code class="lit">ethernet</code>&#8217; operating mode passes all Ethernet packets transparently through the interface, meanwhile the &#8216;<code class="lit">ethernet-tagged</code>&#8217; requires that the client uses at least one VLAN to pass the traffic. The <b class="name">mpw</b> interface labels, neighbor, encapsulation and administrative state are normally configured by <a class="link-man" href="../html8/ldpd.html">ldpd(8)</a>, but it is also possible to configure them manually. The configuration information that will be used by the ioctl are defined below:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
#define IMR_TYPE_NONE                   0 
#define IMR_TYPE_ETHERNET               1 
#define IMR_TYPE_ETHERNET_TAGGED        2 
 
#define IMR_FLAG_CONTROLWORD            0x1 
 
struct ifmpwreq { 
        uint32_t        imr_flags; 
        uint32_t        imr_type; /* pseudowire type */ 
        struct          shim_hdr imr_lshim; /* local label */ 
        struct          shim_hdr imr_rshim; /* remote label */ 
        struct          sockaddr_storage imr_nexthop; 
};</pre>
<div class="spacer">
</div>
<b class="name">mpw</b> interfaces support the following unique ioctls:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SIOCSETMPWCFG</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Configure mpw using the supplied configuration.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SIOCGETMPWCFG</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Report the mpw configuration.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Create a pseudowire to neighbor 10.254.0.1 using Ethernet encapsulation with local label 20 and encapsulate MPLS packets with label 21:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# ifconfig mpw5 neighbor 10.254.0.1 encap ethernet mpwlabel 20 21 up</pre>
<div class="spacer">
</div>
Create a pseudowire to neighbor 10.254.0.3 using Ethernet encapsulation with local label 30 and encapsulate MPLS packets with label 31 and control-word:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# ifconfig mpw5 neighbor 10.254.0.3 encap ethernet mpwlabel 30 31 controlword</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html5/hostname.if.html">hostname.if(5)</a>, <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a>, <a class="link-man" href="../html8/ldpd.html">ldpd(8)</a>, <a class="link-man" href="../html8/netstart.html">netstart(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">mpw</b> kernel interface first appeared in <span class="unix">OpenBSD&#160;5.8</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="name">mpw</b> driver was written by <span class="author">Rafael Zalamena</span> &lt;<a class="link-mail" href="mailto:rzalamena@openbsd.org">rzalamena@openbsd.org</a>&gt;.</div>
</div>
</body>
</html>

