<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
TCP(4)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">tcp</b> &#8212; <span class="desc">Internet Transmission Control Protocol</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/socket.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">netinet/in.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">socket</b>(<i class="farg" style="white-space:nowrap;">AF_INET</i>, <i class="farg" style="white-space:nowrap;">SOCK_STREAM</i>, <i class="farg" style="white-space:nowrap;">0</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">socket</b>(<i class="farg" style="white-space:nowrap;">AF_INET6</i>, <i class="farg" style="white-space:nowrap;">SOCK_STREAM</i>, <i class="farg" style="white-space:nowrap;">0</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The TCP protocol provides a reliable, flow-controlled, two-way transmission of data. It is a byte-stream protocol used to support the <span class="define">SOCK_STREAM</span> abstraction. TCP uses the standard Internet address format and, in addition, provides a per-host collection of &#8220;port addresses&#8221;. Thus, each address is composed of an Internet address specifying the host and network, with a specific TCP port on the host identifying the peer entity.<div class="spacer">
</div>
Sockets utilizing the TCP protocol are either &#8220;active&#8221; or &#8220;passive&#8221;. Active sockets initiate connections to passive sockets. By default TCP sockets are created active; to create a passive socket the <a class="link-man" href="../html2/listen.html">listen(2)</a> system call must be used after binding the socket with the <a class="link-man" href="../html2/bind.html">bind(2)</a> system call. Only passive sockets may use the <a class="link-man" href="../html2/accept.html">accept(2)</a> call to accept incoming connections. Only active sockets may use the <a class="link-man" href="../html2/connect.html">connect(2)</a> call to initiate connections.<div class="spacer">
</div>
Passive sockets may &#8220;underspecify&#8221; their location to match incoming connection requests from multiple networks. This technique, termed &#8220;wildcard addressing&#8221;, allows a single server to provide service to clients on multiple networks. To create a socket which listens on all networks, the Internet address <span class="define">INADDR_ANY</span> must be bound. The TCP port may still be specified at this time; if the port is not specified the system will assign one. Once a connection has been established the socket's address is fixed by the peer entity's location. The address assigned to the socket is the address associated with the network interface through which packets are being transmitted and received. Normally this address corresponds to the peer entity's network.<div class="spacer">
</div>
TCP supports several socket options which are set with <a class="link-man" href="../html2/setsockopt.html">setsockopt(2)</a> and tested with <a class="link-man" href="../html2/getsockopt.html">getsockopt(2)</a>.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-ohang">
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="config">TCP_NODELAY</b></dt>
<dd class="list-ohang">
Under most circumstances, TCP sends data when it is presented; when outstanding data has not yet been acknowledged, it gathers small amounts of output to be sent in a single packet once an acknowledgement is received. For a small number of clients, such as window systems that send a stream of mouse events which receive no replies, this packetization may cause significant delays. Therefore, TCP provides a boolean option, <span class="define">TCP_NODELAY</span> (from <b class="includes">&lt;<a class="link-includes">netinet/tcp.h</a>&gt;</b>), to defeat this algorithm.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="config">TCP_NOPUSH</b></dt>
<dd class="list-ohang">
By convention, the TCP sender will set the &#8220;push&#8221; bit and begin transmission immediately (if permitted) at the end of every user call to <a class="link-man" href="../html2/write.html">write(2)</a> or <a class="link-man" href="../html2/writev.html">writev(2)</a>. When this option is set to a non-zero value, TCP will delay sending any data at all until either the socket is closed, the internal send buffer is filled, or this option is set to a zero value.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="config">TCP_MAXSEG</b></dt>
<dd class="list-ohang">
Set the maximum segment size for this connection. The maximum segment size can only be lowered.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="config">TCP_SACK_ENABLE</b></dt>
<dd class="list-ohang">
Use selective acknowledgements for this connection. See <a class="link-man" href="../html4/options.html">options(4)</a>.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="config">TCP_MD5SIG</b></dt>
<dd class="list-ohang">
Use TCP MD5 signatures per RFC 2385. This requires <span class="emph">Security Associations</span> to be set up, which can be done using <a class="link-man" href="../html8/ipsecctl.html">ipsecctl(8)</a>. When a listening socket has <span class="emph">TCP_MD5SIG</span> set, it accepts connections with MD5 signatures only from sources for which a <span class="emph">Security Association</span> is set up. Connections without MD5 signatures are only accepted from sources for which no <span class="emph">Security Association</span> is set up. The connected socket only has <span class="emph">TCP_MD5SIG</span> set if the connection is protected with MD5 signatures.</dd>
</dl>
<div class="spacer">
</div>
The option level for the <a class="link-man" href="../html2/setsockopt.html">setsockopt(2)</a> call is the protocol number for TCP, available from <a class="link-man" href="../html3/getprotobyname.html">getprotobyname(3)</a>.<div class="spacer">
</div>
Options at the IP transport level may be used with TCP; see <a class="link-man" href="../html4/ip.html">ip(4)</a> or <a class="link-man" href="../html4/ip6.html">ip6(4)</a>. Incoming connection requests that are source-routed are noted, and the reverse source route is used in responding.</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> A socket operation may fail with one of the following errors returned:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EISCONN</span>]</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
when trying to establish a connection on a socket which already has one;</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOBUFS</span>]</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
when the system runs out of memory for an internal data structure;</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ETIMEDOUT</span>]</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
when a connection was dropped due to excessive retransmissions;</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ECONNRESET</span>]</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
when the remote peer forces the connection to be closed;</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ECONNREFUSED</span>]</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
when the remote peer actively refuses connection establishment (usually because no process is listening to the port);</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EADDRINUSE</span>]</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
when an attempt is made to create a socket with a port which has already been allocated;</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EADDRNOTAVAIL</span>]</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
when an attempt is made to create a socket with a network address for which no network interface exists.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/tcpbench.html">tcpbench(1)</a>, <a class="link-man" href="../html2/getsockopt.html">getsockopt(2)</a>, <a class="link-man" href="../html2/socket.html">socket(2)</a>, <a class="link-man" href="../html4/inet.html">inet(4)</a>, <a class="link-man" href="../html4/inet6.html">inet6(4)</a>, <a class="link-man" href="../html4/ip.html">ip(4)</a>, <a class="link-man" href="../html4/ip6.html">ip6(4)</a>, <a class="link-man" href="../html4/netintro.html">netintro(4)</a>, <a class="link-man" href="../html8/ipsecctl.html">ipsecctl(8)</a>, <a class="link-man" href="../html8/tcpdrop.html">tcpdrop(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">tcp</b> protocol stack appeared in <span class="unix">4.2BSD</span>.</div>
</div>
</body>
</html>

