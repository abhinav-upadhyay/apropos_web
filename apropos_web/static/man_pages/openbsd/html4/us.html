<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
USB(4)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">usb</b>, <b class="name">uhub</b> &#8212; <span class="desc">introduction to Universal Serial Bus support</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config"># octeon specific</b><br/>
<b class="config">dwctwo0 at iobus? irq 56</b><br/>
<b class="config"># zaurus specific</b><br/>
<b class="config">ohci0   at pxaip?</b><br/>
<b class="config"># all architectures</b><br/>
<b class="config">ehci*   at cardbus?</b><br/>
<b class="config">ohci*   at cardbus?</b><br/>
<b class="config">uhci*   at cardbus?</b><br/>
<b class="config">ehci*   at pci?</b><br/>
<b class="config">ohci*   at pci?</b><br/>
<b class="config">uhci*   at pci?</b><br/>
<b class="config">xhci*   at pci?</b><br/>
<b class="config">usb*    at dwctwo?</b><br/>
<b class="config">usb*    at ehci? flags 0x00</b><br/>
<b class="config">usb*    at ohci? flags 0x00</b><br/>
<b class="config">usb*    at uhci? flags 0x00</b><br/>
<b class="config">usb*    at xhci? flags 0x00</b><br/>
<b class="config">uhub*   at usb?</b><br/>
<b class="config">uhub*   at uhub?</b><div class="spacer">
</div>
<br/>
<b class="config">option	USBVERBOSE</b><div class="spacer">
</div>
<br/>
<b class="includes">#include &lt;<a class="link-includes">dev/usb/usb.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">dev/usb/usbhid.h</a>&gt;</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <span class="unix">OpenBSD</span> provides machine-independent bus support and drivers for Universal Serial Bus (USB) devices.<div class="spacer">
</div>
The <span class="unix">OpenBSD</span> <b class="name">usb</b> driver has three layers (like <a class="link-man" href="../html4/scsi.html">scsi(4)</a> and <a class="link-man" href="../html4/pcmcia.html">pcmcia(4)</a>): the controller, the bus, and the device layer. The controller attaches to a physical bus (like <a class="link-man" href="../html4/pci.html">pci(4)</a> or <a class="link-man" href="../html4/cardbus.html">cardbus(4)</a>). The USB bus attaches to the controller and the root hub attaches to the USB bus. Devices, which may include further hubs, attach to the root hub. The attachment forms the same tree structure as the physical USB device tree. For each USB device there may be additional drivers attached to it.<div class="spacer">
</div>
The <b class="flag">uhub</b> driver controls USB hubs and must always be present since there is at least one root hub in any USB system.<div class="spacer">
</div>
The <b class="flag">flags</b> are used to specify if the devices on the USB bus should be probed early in the boot process. If the <b class="flag">flags</b> are specified with a value of 1, the USB bus will be probed when the USB host device is attached instead of waiting until kernel processes start running.<div class="spacer">
</div>
<span class="unix">OpenBSD</span> provides support for the following devices. Note that not all architectures support all devices.<div class="subsection">
<h2 id="x53746f726167652064657669636573">Storage devices</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/umass.html">umass(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB Mass Storage Devices, e.g., external disk drives</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x5769726564206e6574776f726b20696e7465726661636573">Wired network interfaces</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/aue.html">aue(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
ADMtek AN986/ADM8511 Pegasus family 10/100 USB Ethernet device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/axe.html">axe(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
ASIX Electronics AX88172/AX88178/AX88772 10/100/Gigabit USB Ethernet device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/axen.html">axen(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
ASIX Electronics AX88179 10/100/Gigabit USB Ethernet device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/cdce.html">cdce(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB Communication Device Class Ethernet device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/cue.html">cue(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
CATC USB-EL1201A USB Ethernet device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/kue.html">kue(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Kawasaki LSI KL5KUSB101B USB Ethernet device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/mos.html">mos(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
MosChip MCS7730/7830/7832 10/100 USB Ethernet device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/smsc.html">smsc(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
SMSC LAN95xx 10/100 USB Ethernet device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/udav.html">udav(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Davicom DM9601 10/100 USB Ethernet device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/url.html">url(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Realtek RTL8150L 10/100 USB Ethernet device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/urndis.html">urndis(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB Remote NDIS Ethernet device</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x576972656c657373206e6574776f726b20696e7465726661636573">Wireless network interfaces</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/athn.html">athn(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Atheros IEEE 802.11a/b/g/n wireless network device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/atu.html">atu(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Atmel AT76C50x IEEE 802.11b wireless network device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/otus.html">otus(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Atheros USB IEEE 802.11a/b/g/n wireless network device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/rsu.html">rsu(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Realtek RTL8188SU/RTL8192SU USB IEEE 802.11b/g/n wireless network device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/rum.html">rum(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Ralink Technology USB IEEE 802.11a/b/g wireless network device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/run.html">run(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Ralink Technology USB IEEE 802.11a/b/g/n wireless network device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uath.html">uath(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Atheros USB IEEE 802.11a/b/g wireless network device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/upgt.html">upgt(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Conexant/Intersil PrismGT SoftMAC USB IEEE 802.11b/g wireless network device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/ural.html">ural(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Ralink Technology USB IEEE 802.11b/g wireless network device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/urtw.html">urtw(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Realtek RTL8187L/RTL8187B USB IEEE 802.11b/g wireless network device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/urtwn.html">urtwn(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Realtek RTL8188CU/RTL8188EU/RTL8192CU USB IEEE 802.11b/g/n wireless network device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/wi.html">wi(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Intersil PRISM 2-3 IEEE 802.11b wireless network device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/zyd.html">zyd(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
ZyDAS ZD1211/ZD1211B USB IEEE 802.11b/g wireless network device</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x53657269616c20616e6420706172616c6c656c20696e7465726661636573">Serial and parallel interfaces</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/moscom.html">moscom(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
MosChip Semiconductor MCS7703 based USB serial adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uark.html">uark(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Arkmicro Technologies ARK3116 based USB serial adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/ubsa.html">ubsa(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Belkin USB serial adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uchcom.html">uchcom(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
WinChipHead CH341/340 based USB serial adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/ucom.html">ucom(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB tty support</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/ucycom.html">ucycom(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Cypress microcontroller based USB serial adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uftdi.html">uftdi(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
FTDI USB serial adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uipaq.html">uipaq(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
iPAQ USB units</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/ulpt.html">ulpt(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB printer support</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/umcs.html">umcs(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
MosChip Semiconductor based USB multiport serial adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/umct.html">umct(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
MCT USB-RS232 USB serial adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/umodem.html">umodem(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB modem support</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/umsm.html">umsm(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Qualcomm MSM modem device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uplcom.html">uplcom(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Prolific PL-2303 USB serial adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uscom.html">uscom(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
simple USB serial adapters</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uslcom.html">uslcom(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Silicon Laboratories CP210x based USB serial adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uslhcom.html">uslhcom(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Silicon Laboratories CP2110 based USB serial adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uticom.html">uticom(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Texas Instruments TUSB3410 USB serial adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uvisor.html">uvisor(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB Handspring Visor</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uvscom.html">uvscom(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
SUNTAC Slipper U VS-10U USB serial adapter</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x417564696f2064657669636573">Audio devices</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uaudio.html">uaudio(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB audio devices</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/umidi.html">umidi(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB MIDI devices</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x566964656f2064657669636573">Video devices</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/udl.html">udl(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
DisplayLink DL-120 / DL-160 USB display devices</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uvideo.html">uvideo(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB video devices</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x54696d652072656365697665722064657669636573">Time receiver devices</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/udcf.html">udcf(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Gude ADS Expert mouseCLOCK USB timedelta sensor</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/umbg.html">umbg(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Meinberg Funkuhren USB5131 timedelta sensor</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x526164696f2072656365697665722064657669636573">Radio receiver devices</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/udsbr.html">udsbr(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
D-Link DSB-R100 USB radio device</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x48756d616e20496e746572666163652044657669636573">Human Interface Devices</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/ubcmtp.html">ubcmtp(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Broadcom trackpad mouse</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uhid.html">uhid(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Generic driver for Human Interface Devices</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uhidev.html">uhidev(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Base driver for all Human Interface Devices</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/ukbd.html">ukbd(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB keyboards that follow the boot protocol</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/ums.html">ums(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB HID mouse, touchscreen and digitiser devices</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uoaklux.html">uoaklux(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Toradex OAK USB illuminance sensor</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uoakrh.html">uoakrh(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Toradex OAK USB temperature and relative humidity sensor</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uoakv.html">uoakv(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Toradex OAK USB +/-10V 8channel ADC interface</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/upd.html">upd(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB Power Devices sensor</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uthum.html">uthum(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
TEMPer HID thermometer and hygrometer</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/utpms.html">utpms(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Apple touchpad mouse</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/utrh.html">utrh(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USBRH temperature and humidity sensor</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/utwitch.html">utwitch(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
YUREX USB twitch/jiggle of knee sensor</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4d697363656c6c616e656f75732064657669636573">Miscellaneous devices</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/ualea.html">ualea(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Araneus Alea II USB TRNG</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uberry.html">uberry(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Research In Motion BlackBerry</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/ugen.html">ugen(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB generic device support</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/ugl.html">ugl(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Genesys Logic based host-to-host adapters</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/ugold.html">ugold(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
TEMPer gold HID thermometer and hygrometer</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uonerng.html">uonerng(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Moonbase Otago OneRNG TRNG</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uow.html">uow(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Maxim/Dallas DS2490 USB 1-Wire adapter</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/upl.html">upl(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Prolific based host-to-host adapters</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/usps.html">usps(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USPS composite AC power and temperature sensor</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/uts.html">uts(4)</a></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
USB touchscreen support</dd>
</dl>
</div>
</div>
<div class="section">
<h1 id="x494e54524f44554354494f4e20544f20555342">INTRODUCTION TO USB</h1> There are different versions of the USB which provide different speeds. USB 3 can operate up to 5.0Gb/s. USB 2 operates at 480Mb/s, while USB versions 1 and 1.1 operate at 12 Mb/s and 1.5 Mb/s for low speed devices. Each USB has a host controller that is the master of the bus; all other devices on the bus only speak when spoken to.<div class="spacer">
</div>
There can be up to 127 devices (apart from the host controller) on a bus, each with its own address. The addresses are assigned dynamically by the host when each device is attached to the bus.<div class="spacer">
</div>
Within each device there can be up to 16 endpoints. Each endpoint is individually addressed and the addresses are static. Each of these endpoints will communicate in one of four different modes: control, isochronous, bulk, or interrupt. A device always has at least one endpoint. This is a control endpoint at address 0 and is used to give commands to the device and extract basic data, such as descriptors, from the device. Each endpoint, except the control endpoint, is unidirectional.<div class="spacer">
</div>
The endpoints in a device are grouped into interfaces. An interface is a logical unit within a device; e.g., a compound device with both a keyboard and a trackball would present one interface for each. An interface can sometimes be set into different modes, called alternate settings, which affects how it operates. Different alternate settings can have different endpoints within it.<div class="spacer">
</div>
A device may operate in different configurations. Depending on the configuration the device may present different sets of endpoints and interfaces.<div class="spacer">
</div>
Each device located on a hub has several <a class="link-man" href="../html8/config.html">config(8)</a> locators:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="config">port</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Number of the port on closest upstream hub.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="config">configuration</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Configuration the device must be in for this driver to attach. This locator does not set the configuration; it is iterated by the bus enumeration.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="config">interface</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Interface number within a device that an interface driver attaches to.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="config">vendor</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
16-bit vendor ID of the device.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="config">product</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
16-bit product ID of the device.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="config">release</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
16-bit release (revision) number of the device.</dd>
</dl>
<div class="spacer">
</div>
The first locator can be used to pin down a particular device according to its physical position in the device tree. The last three locators can be used to pin down a particular device according to what device it actually is.<div class="spacer">
</div>
The bus enumeration of the USB bus proceeds in several steps:<ol style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-enum">
<li class="list-enum" style="margin-top: 1.00em;">
Any device-specific driver can attach to the device.</li>
<li class="list-enum" style="margin-top: 1.00em;">
If none is found, any device class specific driver can attach.</li>
<li class="list-enum" style="margin-top: 1.00em;">
If none is found, all configurations are iterated over. For each configuration all the interfaces are iterated over and interface drivers can attach. If any interface driver attached in a certain configuration, the iteration over configurations is stopped.</li>
<li class="list-enum" style="margin-top: 1.00em;">
If still no drivers have been found, the generic USB driver can attach.</li>
</ol>
</div>
<div class="section">
<h1 id="x55534220434f4e54524f4c4c455220494e54455246414345">USB CONTROLLER INTERFACE</h1> Use the following to get access to the USB specific structures and defines:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
#include &lt;dev/usb/usb.h&gt;</pre>
<div class="spacer">
</div>
The <i class="file">/dev/usbN</i> device can be opened and a few operations can be performed on it. The <a class="link-man" href="../html2/poll.html">poll(2)</a> system call will say that I/O is possible on the controller device when a USB device has been connected or disconnected to the bus.<div class="spacer">
</div>
The following <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> commands are supported on the controller device:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">USB_DEVICEINFO (struct usb_device_info *)</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This command can be used to retrieve some information about a device on the bus. The <b class="var">udi_addr</b> field should be filled before the call and the other fields will be filled by information about the device on that address. Should no such device exist, an error is reported.<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
#define USB_MAX_DEVNAMES 4 
#define USB_MAX_DEVNAMELEN 16 
struct usb_device_info { 
	u_int8_t	udi_bus; 
	u_int8_t	udi_addr;	/* device address */ 
	char		udi_product[USB_MAX_STRING_LEN]; 
	char		udi_vendor[USB_MAX_STRING_LEN]; 
	char		udi_release[8]; 
	u_int16_t	udi_productNo; 
	u_int16_t	udi_vendorNo; 
	u_int16_t	udi_releaseNo; 
	u_int8_t	udi_class; 
	u_int8_t	udi_subclass; 
	u_int8_t	udi_protocol; 
	u_int8_t	udi_config; 
	u_int8_t	udi_speed; 
#define USB_SPEED_LOW  1 
#define USB_SPEED_FULL 2 
#define USB_SPEED_HIGH 3 
	int		udi_power;	/* power consumption */ 
	int		udi_nports; 
	char		udi_devnames[USB_MAX_DEVNAMES] 
			    [USB_MAX_DEVNAMELEN]; 
	u_int8_t	udi_ports[16];	/* hub only */ 
#define USB_PORT_ENABLED 0xff 
#define USB_PORT_SUSPENDED 0xfe 
#define USB_PORT_POWERED 0xfd 
#define USB_PORT_DISABLED 0xfc 
	char		udi_serial[USB_MAX_STRING_LEN]; 
};</pre>
<div class="spacer">
</div>
The <b class="var">udi_bus</b> field contains the device unit number of the device.<div class="spacer">
</div>
The <b class="var">udi_product</b>, <b class="var">udi_vendor</b>, and <b class="var">udi_release</b> fields contain self-explanatory descriptions of the device. The <b class="var">udi_productNo</b>, <b class="var">udi_vendorNo</b>, and <b class="var">udi_releaseNo</b> fields contain numeric identifiers for the device.<div class="spacer">
</div>
The <b class="var">udi_class</b> and <b class="var">udi_subclass</b> fields contain the device class and subclass.<div class="spacer">
</div>
The <b class="var">udi_config</b> field shows the current configuration of the device.<div class="spacer">
</div>
The <b class="var">udi_protocol</b> field contains the device protocol as given from the device.<div class="spacer">
</div>
The <b class="var">udi_speed</b> field contains the speed of the device.<div class="spacer">
</div>
The <b class="var">udi_power</b> field shows the power consumption in milli-amps drawn at 5 volts or is zero if the device is self powered.<div class="spacer">
</div>
The <b class="var">udi_devnames</b> field contains the names and instance numbers of the device drivers for the devices attached to this device.<div class="spacer">
</div>
If the device is a hub, the <b class="var">udi_nports</b> field is non-zero and the <b class="var">udi_ports</b> field contains the addresses of the connected devices. If no device is connected to a port, one of the <span class="define">USB_PORT_*</span> values indicates its status.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">USB_DEVICESTATS (struct usb_device_stats *)</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This command retrieves statistics about the controller.<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
struct usb_device_stats { 
	u_long	uds_requests[4]; 
};</pre>
<div class="spacer">
</div>
The <b class="var">uds_requests</b> field is indexed by the transfer kind, i.e. <span class="define">UE_*</span>, and indicates how many transfers of each kind have been completed by the controller.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">USB_DEVICE_GET_DDESC (struct usb_device_ddesc *)</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This command can be used to retrieve the device descriptor of a device on the bus. The <b class="var">udd_addr</b> field needs to be filled with the bus device address:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
struct usb_device_ddesc { 
	u_int8_t	udd_bus; 
	u_int8_t	udd_addr;	/* device address */ 
	usb_device_descriptor_t udd_desc; 
};</pre>
<div class="spacer">
</div>
The <b class="var">udd_bus</b> field contains the device unit number.<div class="spacer">
</div>
The <b class="var">udd_desc</b> field contains the device descriptor structure.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">USB_DEVICE_GET_CDESC (struct usb_device_cdesc *)</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This command can be used to retrieve the configuration descriptor for the given configuration of a device on the bus. The <b class="var">udc_addr</b> field needs to be filled with the bus device address. The <b class="var">udc_config_index</b> field needs to be filled with the configuration index for the relevant configuration descriptor. For convenience the current configuration can be specified by <span class="define">USB_CURRENT_CONFIG_INDEX</span>:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
struct usb_device_cdesc { 
	u_int8_t	udc_bus; 
	u_int8_t	udc_addr;	/* device address */ 
	int		udc_config_index; 
	usb_config_descriptor_t udc_desc; 
};</pre>
<div class="spacer">
</div>
The <b class="var">udc_bus</b> field contains the device unit number.<div class="spacer">
</div>
The <b class="var">udc_desc</b> field contains the configuration descriptor structure.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">USB_DEVICE_GET_FDESC (struct usb_device_fdesc *)</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This command can be used to retrieve all descriptors for the given configuration of a device on the bus. The <b class="var">udf_addr</b> field needs to be filled with the bus device address. The <b class="var">udf_config_index</b> field needs to be filled with the configuration index for the relevant configuration descriptor. For convenience the current configuration can be specified by <span class="define">USB_CURRENT_CONFIG_INDEX</span>. The <b class="var">udf_data</b> field needs to point to a memory area of the size given in the <b class="var">udf_size</b> field. The proper size can be determined by first issuing a <span class="define">USB_DEVICE_GET_CDESC</span> command and inspecting the <b class="var">wTotalLength</b> field:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
struct usb_device_fdesc { 
	u_int8_t	 udf_bus; 
	u_int8_t	 udf_addr;	/* device address */ 
	int		 udf_config_index; 
	u_int		 udf_size; 
	u_char		*udf_data; 
};</pre>
<div class="spacer">
</div>
The <b class="var">udf_bus</b> field contains the device unit number.<div class="spacer">
</div>
The <b class="var">udf_data</b> field contains all descriptors.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">USB_REQUEST (struct usb_ctl_request *)</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This command can be used to execute arbitrary requests on the control pipe. This is <span class="emph">DANGEROUS</span> and should be used with great care since it can destroy the bus integrity.<div class="spacer">
</div>
The <span class="type">usb_ctl_request</span> structure has the following definition:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
typedef struct { 
        uByte           bmRequestType; 
        uByte           bRequest; 
        uWord           wValue; 
        uWord           wIndex; 
        uWord           wLength; 
} __packed usb_device_request_t; 
 
struct usb_ctl_request { 
	int	ucr_addr; 
	usb_device_request_t ucr_request; 
	void	*ucr_data; 
	int	ucr_flags; 
#define USBD_SHORT_XFER_OK 0x04	/* allow short reads */ 
	int	ucr_actlen;	/* actual length transferred */ 
};</pre>
<div class="spacer">
</div>
The <b class="var">ucr_addr</b> field identifies the device on which to perform the request. The <b class="var">ucr_request</b> field identifies parameters of the request, such as length and type. The <b class="var">ucr_data</b> field contains the location where data will be read from or written to. The <b class="var">ucr_flags</b> field specifies options for the request, and the <b class="var">ucr_actlen</b> field contains the actual length transferred as the result of the request.</dd>
</dl>
<div class="spacer">
</div>
The include file <b class="includes">&lt;<a class="link-includes">dev/usb/usb.h</a>&gt;</b> contains definitions for the types used by the various <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> calls. The naming convention of the fields for the various USB descriptors exactly follows the naming in the USB specification. Byte sized fields can be accessed directly, but word (16-bit) sized fields must be accessed by the <b class="fname">UGETW</b>(<i class="farg">field</i>) and <b class="fname">USETW</b>(<i class="farg">field</i>, <i class="farg">value</i>) macros and double word (32-bit) sized fields must be accessed by the <b class="fname">UGETDW</b>(<i class="farg">field</i>) and <b class="fname">USETDW</b>(<i class="farg">field</i>, <i class="farg">value</i>) macros to handle byte order and alignment properly.<div class="spacer">
</div>
The include file <b class="includes">&lt;<a class="link-includes">dev/usb/usbhid.h</a>&gt;</b> similarly contains the definitions for Human Interface Devices (HID).</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/usbhidaction.html">usbhidaction(1)</a>, <a class="link-man" href="../html1/usbhidctl.html">usbhidctl(1)</a>, <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a>, <a class="link-man" href="../html4/dwctwo.html">dwctwo(4)</a>, <a class="link-man" href="../html4/ehci.html">ehci(4)</a>, <a class="link-man" href="../html4/ohci.html">ohci(4)</a>, <a class="link-man" href="../html4/uhci.html">uhci(4)</a>, <a class="link-man" href="../html4/xhci.html">xhci(4)</a>, <a class="link-man" href="../html8/config.html">config(8)</a>, <a class="link-man" href="../html8/usbdevs.html">usbdevs(8)</a><div class="spacer">
</div>
The USB specifications can be found at <a class="link-ext" href="http://www.usb.org/developers/docs/">http://www.usb.org/developers/docs/</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">usb</b> driver appeared in <span class="unix">OpenBSD&#160;2.6</span>.</div>
</div>
</body>
</html>

