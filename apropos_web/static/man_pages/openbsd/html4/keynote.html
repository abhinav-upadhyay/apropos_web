<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
KEYNOTE(4)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">keynote</b> &#8212; <span class="desc">a trust-management system</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/types.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">regex.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">keynote.h</a>&gt;</b><div class="spacer">
</div>
<b class="macro">Link options: -lkeynote -lm -lcrypto</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> For more details on <b class="name">keynote</b>, see RFC 2704.<div class="spacer">
</div>
Details on the API, assertion syntax, and command-line tool are given in the man pages listed at the end of this manual.<div class="spacer">
</div>
Trust management, introduced in the PolicyMaker system, is a unified approach to specifying and interpreting security policies, credentials, and relationships; it allows direct authorization of security-critical actions. A trust-management system provides standard, general-purpose mechanisms for specifying application security policies and credentials. Trust-management credentials describe a specific delegation of trust and subsume the role of public key certificates; unlike traditional certificates, which bind keys to names, credentials can bind keys directly to the authorization to perform specific tasks.<div class="spacer">
</div>
A trust-management system has five basic components:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
A language for describing &#8216;actions&#8217;, which are operations with security consequences that are to be controlled by the system.</li>
<li class="list-bul" style="margin-top: 1.00em;">
A mechanism for identifying &#8216;principals&#8217;, which are entities that can be authorized to perform actions.</li>
<li class="list-bul" style="margin-top: 1.00em;">
A language for specifying application &#8216;policies&#8217;, which govern the actions that principals are authorized to perform.</li>
<li class="list-bul" style="margin-top: 1.00em;">
A language for specifying &#8216;credentials&#8217;, which allow principals to delegate authorization to other principals.</li>
<li class="list-bul" style="margin-top: 1.00em;">
A &#8216;compliance checker&#8217;, which provides a service to applications for determining how an action requested by principals should be handled, given a policy and a set of credentials.</li>
</ul>
<div class="spacer">
</div>
The trust-management approach has a number of advantages over other mechanisms for specifying and controlling authorization, especially when security policy is distributed over a network or is otherwise decentralized.<div class="spacer">
</div>
Trust management unifies the notions of security policy, credentials, access control, and authorization. An application that uses a trust-management system can simply ask the compliance checker whether a requested action should be allowed. Furthermore, policies and credentials are written in standard languages that are shared by all trust-managed applications; the security configuration mechanism for one application carries exactly the same syntactic and semantic structure as that of another, even when the semantics of the applications themselves are quite different.<div class="spacer">
</div>
Trust-management policies are easy to distribute across networks, helping to avoid the need for application-specific distributed policy configuration mechanisms, access control lists, and certificate parsers and interpreters.<div class="spacer">
</div>
For a general discussion of the use of trust management in distributed system security, see the papers listed at the end of this manual.<div class="spacer">
</div>
KeyNote is a simple and flexible trust-management system designed to work well for a variety of large- and small- scale Internet-based applications. It provides a single, unified language for both local policies and credentials. KeyNote policies and credentials, called &#8216;assertions&#8217;, contain predicates that describe the trusted actions permitted by the holders of specific public keys. KeyNote assertions are essentially small, highly-structured programs. A signed assertion, which can be sent over an untrusted network, is also called a &#8216;credential assertion&#8217;. Credential assertions, which also serve the role of certificates, have the same syntax as policy assertions but are also signed by the principal delegating the trust.<div class="spacer">
</div>
In KeyNote:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
Actions are specified as a collection of name-value pairs.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Principal names can be any convenient string and can directly represent cryptographic public keys.</li>
<li class="list-bul" style="margin-top: 1.00em;">
The same language is used for both policies and credentials.</li>
<li class="list-bul" style="margin-top: 1.00em;">
The policy and credential language is concise, highly expressive, human readable and writable, and compatible with a variety of storage and transmission media, including electronic mail.</li>
<li class="list-bul" style="margin-top: 1.00em;">
The compliance checker returns an application-configured &#8216;policy compliance value&#8217; that describes how a request should be handled by the application. Policy compliance values are always positively derived from policy and credentials, facilitating analysis of KeyNote-based systems.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Compliance checking is efficient enough for high-performance and real-time applications.</li>
</ul>
<div class="spacer">
</div>
In KeyNote, the authority to perform trusted actions is associated with one or more &#8216;principals&#8217;. A principal may be a physical entity, a process in an operating system, a public key, or any other convenient abstraction. KeyNote principals are identified by a string called a &#8216;Principal Identifier&#8217;. In some cases, a Principal Identifier will contain a cryptographic key interpreted by the KeyNote system (e.g., for credential signature verification). In other cases, Principal Identifiers may have a structure that is opaque to KeyNote.<div class="spacer">
</div>
Principals perform two functions of concern to KeyNote: They request &#8216;actions&#8217; and they issue &#8216;assertions&#8217;. Actions are any trusted operations that an application places under KeyNote control. Assertions delegate the authorization to perform actions to other principals.<div class="spacer">
</div>
Actions are described to the KeyNote compliance checker in terms of a collection of name-value pairs called an &#8216;action attribute set&#8217;. The action attribute set is created by the invoking application. Its structure and format are described in detail elsewhere of this document.<div class="spacer">
</div>
KeyNote provides advice to applications on the interpretation of policy with regard to specific requested actions. Applications invoke the KeyNote compliance checker by issuing a &#8216;query&#8217; containing a proposed action attribute set and identifying the principal(s) requesting it. The KeyNote system determines and returns an appropriate &#8216;policy compliance value&#8217; from an ordered set of possible responses.<div class="spacer">
</div>
The policy compliance value returned from a KeyNote query advises the application how to process the requested action. In the simplest case, the compliance value is Boolean (e.g., &#8220;reject&#8221; or &#8220;approve&#8221;). Assertions can also be written to select from a range of possible compliance values, when appropriate for the application (e.g., &#8220;no access&#8221;, &#8220;restricted access&#8221;, &#8220;full access&#8221;). Applications can configure the relative ordering (from &#8216;weakest&#8217; to &#8216;strongest&#8217;) of compliance values at query time.<div class="spacer">
</div>
Assertions are the basic programming unit for specifying policy and delegating authority. Assertions describe the conditions under which a principal authorizes actions requested by other principals. An assertion identifies the principal that made it, which other principals are being authorized, and the conditions under which the authorization applies. The syntax of assertions is given in <a class="link-man" href="../html5/keynote.html">keynote(5)</a>.<div class="spacer">
</div>
A special principal, whose identifier is &#8220;POLICY&#8221;, provides the root of trust in KeyNote. &#8220;POLICY&#8221; is therefore considered to be authorized to perform any action.<div class="spacer">
</div>
Assertions issued by the &#8220;POLICY&#8221; principal are called &#8216;policy assertions&#8217; and are used to delegate authority to otherwise untrusted principals. The KeyNote security policy of an application consists of a collection of policy assertions.<div class="spacer">
</div>
When a principal is identified by a public key, it can digitally sign assertions and distribute them over untrusted networks for use by other KeyNote compliance checkers. These signed assertions are also called &#8216;credentials&#8217;, and serve a role similar to that of traditional public key certificates. Policies and credentials share the same syntax and are evaluated according to the same semantics. A principal can therefore convert its policy assertions into credentials simply by digitally signing them.<div class="spacer">
</div>
KeyNote is designed to encourage the creation of human-readable policies and credentials that are amenable to transmission and storage over a variety of media. Its assertion syntax is inspired by the format of RFC822-style message headers. A KeyNote assertion contains a sequence of sections, called &#8216;fields&#8217;, each of which specifying one aspect of the assertion's semantics. Fields start with an identifier at the beginning of a line and continue until the next field is encountered. For example:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
  KeyNote-Version: 2 
  Comment: A simple, if contrived, email certificate for user mab 
  Local-Constants:  ATT_CA_key = &quot;RSA:acdfa1df1011bbac&quot; 
                    mab_key = &quot;DSA:deadbeefcafe001a&quot; 
  Authorizer: ATT_CA_key 
  Licensees: mab_key 
  Conditions: ((app_domain == &quot;email&quot;)  # valid for email only 
            &amp;&amp; (address == &quot;mab@research.att.com&quot;)); 
  Signature: &quot;RSA-SHA1:f00f2244&quot;</pre>
<div class="spacer">
</div>
For the exact meanings of all the fields, see the RFC reference at the end of this manual, and/or <a class="link-man" href="../html5/keynote.html">keynote(5)</a>.<div class="spacer">
</div>
KeyNote semantics resolve the relationship between an application's policy and actions requested by other principals, as supported by credentials. The KeyNote compliance checker processes the assertions against the action attribute set to determine the policy compliance value of a requested action. These semantics are defined later in this document.<div class="spacer">
</div>
An important principle in KeyNote's design is &#8216;assertion monotonicity&#8217;; the policy compliance value of an action is always positively derived from assertions made by trusted principals. Removing an assertion never results in increasing the compliance value returned by KeyNote for a given query. The monotonicity property can simplify the design and analysis of complex network-based security protocols; network failures that prevent the transmission of credentials can never result in spurious authorization of dangerous actions.<div class="spacer">
</div>
Trusted actions to be evaluated by KeyNote are described by a collection of name-value pairs called the &#8216;action attribute set&#8217;. Action attributes are the mechanism by which applications communicate requests to KeyNote and are the primary objects on which KeyNote assertions operate. An action attribute set is passed to the KeyNote compliance checker with each query.<div class="spacer">
</div>
Each action attribute consists of a name and a value. The semantics of the names and values are not interpreted by KeyNote itself; they vary from application to application and must be agreed upon by the writers of applications and the writers of the policies and credentials that will be used by them.<div class="spacer">
</div>
Action attribute names and values are represented by arbitrary-length strings. KeyNote guarantees support of attribute names and values up to 2048 characters long. Applications and assertions should therefore avoid depending on the use of attributes with names or values longer than 2048 characters.<div class="spacer">
</div>
Attribute values are inherently untyped and are represented as character strings by default. Attribute values may contain any non-NUL ASCII character. Numeric attribute values should first be converted to an ASCII text representation by the invoking application, e.g., the value 1234.5 would be represented by the string &#8220;1234.5&#8221;.<div class="spacer">
</div>
An &#10216;AttributeID&#10217; begins with an alphabetic or underscore character and can be followed by any number of alphanumerics and underscores. Attribute names are case sensitive.<div class="spacer">
</div>
If an action attribute is not defined its value is considered to be the empty string.<div class="spacer">
</div>
Attribute names beginning with the &#8220;_&#8221; character are reserved for use by the KeyNote runtime environment and cannot be passed from applications as part of queries. The following special attribute names are used:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
_MIN_TRUST</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Lowest-order (minimum) compliance value in query.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
_MAX_TRUST</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Highest-order (maximum) compliance value in query.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
_VALUES</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Linearly ordered set of compliance value in query.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
_ACTION_AUTHORIZERS</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Names of principals directly authorizing action in query. Comma separated.</dd>
</dl>
<div class="spacer">
</div>
In addition, attributes with names of the form &#8220;_&#10216;N&#10217;&#8221;, where &#10216;N&#10217; is an ASCII-encoded integer, are used by the regular expression matching mechanism described in <a class="link-man" href="../html5/keynote.html">keynote(5)</a>.<div class="spacer">
</div>
By convention, the name of the application domain over which action attributes should be interpreted is given in the attribute named &#8220;app_domain&#8221;. The IANA (or some other suitable authority) will provide a registry of reserved app_domain names. The registry will list the names and meanings of each application's attributes.<div class="spacer">
</div>
The app_domain convention helps to ensure that credentials are interpreted as they were intended. An attribute with any given name may be used in many different application domains but might have different meanings in each of them. However, the use of a global registry is not always required for small-scale, closed applications; the only requirement is that the policies and credentials made available to the KeyNote compliance checker interpret attributes according to the same semantics assumed by the application that created them.<div class="spacer">
</div>
For example, an email application might reserve the app_domain &#8220;RFC822-EMAIL&#8221; and might use the attributes named &#8220;address&#8221; (the mail address of a message's sender), &#8220;name&#8221; (the human name of the message sender), and any &#8220;organization&#8221; headers present (the organization name). The values of these attributes would be derived in the obvious way from the email message headers. The public key of the message's signer would be given in the &#8220;_ACTION_AUTHORIZERS&#8221; attribute</div>
<div class="section">
<h1 id="x51554552592053454d414e54494353">QUERY SEMANTICS</h1> The discussion in the following sections assume some familiarity with assertion syntax. Please refer to <a class="link-man" href="../html5/keynote.html">keynote(5)</a> for more details on the syntax.</div>
<div class="section">
<h1 id="x515545525920504152414d4554455253">QUERY PARAMETERS</h1> A KeyNote query has four parameters:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
The identifier of the principal(s) requesting the action.</li>
<li class="list-bul" style="margin-top: 1.00em;">
The action attribute set describing the action.</li>
<li class="list-bul" style="margin-top: 1.00em;">
The set of compliance values of interest to the application, ordered from _MIN_TRUST to _MAX_TRUST.</li>
<li class="list-bul" style="margin-top: 1.00em;">
The policy and credential assertions that should be included in the evaluation.</li>
</ul>
<div class="spacer">
</div>
The mechanism for passing these parameters to the KeyNote evaluator is application dependent. In particular, an evaluator might provide for some parameters to be passed explicitly, while others are looked up externally (e.g., credentials might be looked up in a network- based distribution system), while still others might be requested from the application as needed by the evaluator, through a &#8216;callback&#8217; mechanism (e.g., for attribute values that represent values from among a very large namespace).</div>
<div class="section">
<h1 id="x414354494f4e20524551554553544552">ACTION REQUESTER</h1> At least one Principal must be identified in each query as the &#8216;requester&#8217; of the action. Actions may be requested by several principals, each considered to have individually requested it. This allows policies that require multiple authorizations, e.g., &#8216;two person control&#8217;. The set of authorizing principals is made available in the special attribute &#8220;_ACTION_AUTHORIZERS&#8221;; if several principals are authorizers, their identifiers are separated with commas.</div>
<div class="section">
<h1 id="x4f52444552454420434f4d504c49414e43452056414c554520534554">ORDERED COMPLIANCE VALUE SET</h1> The set of compliance values of interest to an application (and their relative ranking to one another) is determined by the invoking application and passed to the KeyNote evaluator as a parameter of the query. In many applications, this will be Boolean, e.g., the ordered sets {FALSE, TRUE} or {REJECT, APPROVE}. Other applications may require a range of possible values, e.g., {No_Access, Limited_Access, Full_Access}. Note that applications should include in this set only compliance value names that are actually returned by the assertions.<div class="spacer">
</div>
The lowest-order and highest-order compliance value strings given in the query are available in the special attributes named &#8220;_MIN_TRUST&#8221; and &#8220;_MAX_TRUST&#8221;, respectively. The complete set of query compliance values is made available in ascending order (from _MIN_TRUST to _MAX_TRUST) in the special attribute named &#8220;_VALUES&#8221;. Values are separated with commas; applications that use assertions that make use of the _VALUES attribute should therefore avoid the use of compliance value strings that themselves contain commas.</div>
<div class="section">
<h1 id="x5052494e434950414c204944454e544946494552204e4f524d414c495a4154494f4e">PRINCIPAL IDENTIFIER NORMALIZATION</h1> Principal identifier comparisons among Cryptographic Principal Identifiers (that represent keys) in the Authorizer and Licensees fields or in an action's direct authorizers are performed after normalizing them by conversion to a canonical form.<div class="spacer">
</div>
Every cryptographic algorithm used in KeyNote defines a method for converting keys to their canonical form and that specifies how the comparison for equality of two keys is performed. If the algorithm named in the identifier is unknown to KeyNote, the identifier is treated as opaque.<div class="spacer">
</div>
Opaque identifiers are compared as case sensitive strings.<div class="spacer">
</div>
Notice that use of opaque identifiers in the Authorizer field requires that the assertion's integrity be locally trusted (since it cannot be cryptographically verified by the compliance checker).</div>
<div class="section">
<h1 id="x504f4c49435920434f4d504c49414e43452056414c55452043414c43554c4154494f4e">POLICY COMPLIANCE VALUE CALCULATION</h1> The Policy Compliance Value of a query is the Principal Compliance Value of the principal named &#8220;POLICY&#8221;.</div>
<div class="section">
<h1 id="x5052494e434950414c20434f4d504c49414e43452056414c5545">PRINCIPAL COMPLIANCE VALUE</h1> The Compliance Value of a principal &#10216;X&#10217; is the highest order (maximum) of:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
the Direct Authorization Value of principal &#10216;X&#10217;; and</li>
<li class="list-bul" style="margin-top: 1.00em;">
the Assertion Compliance Values of all assertions identifying &#10216;X&#10217; in the Authorizer field.</li>
</ul>
</div>
<div class="section">
<h1 id="x44495245435420415554484f52495a4154494f4e2056414c5545">DIRECT AUTHORIZATION VALUE</h1> The Direct Authorization Value of a principal &#10216;X&#10217; is _MAX_TRUST if &#10216;X&#10217; is listed in the query as an authorizer of the action. Otherwise, the Direct Authorization Value of &#10216;X&#10217; is _MIN_TRUST.</div>
<div class="section">
<h1 id="x415353455254494f4e20434f4d504c49414e43452056414c5545">ASSERTION COMPLIANCE VALUE</h1> The Assertion Compliance Value of an assertion is the lowest order (minimum) of the assertion's Conditions Compliance Value and its Licensee Compliance Value.</div>
<div class="section">
<h1 id="x434f4e444954494f4e5320434f4d504c49414e43452056414c5545">CONDITIONS COMPLIANCE VALUE</h1> The Conditions Compliance Value of an assertion is the highest-order (maximum) value among all successful clauses listed in the conditions section.<div class="spacer">
</div>
If no clause's test succeeds or the Conditions field is empty, an assertion's Conditions Compliance Value is considered to be the _MIN_TRUST value, as described previously.<div class="spacer">
</div>
If an assertion's Conditions field is missing entirely, its Conditions Compliance Value is considered to be the _MAX_TRUST value, as defined previously.<div class="spacer">
</div>
The set of successful test clause values is calculated as follows:<div class="spacer">
</div>
Recall from the grammar of the Conditions field (see <a class="link-man" href="../html5/keynote.html">keynote(5)</a> for more details) that each clause in the conditions section has two logical parts: a `test' and an optional &#8216;value&#8217;, which, if present, is separated from the test with the &#8220;-&gt;&#8221; token. The test subclause is a predicate that either succeeds (evaluates to logical &#8216;true&#8217;) or fails (evaluates to logical &#8216;false&#8217;). The value subclause is a string expression that evaluates to one value from the ordered set of compliance values given with the query. If the value subclause is missing, it is considered to be _MAX_TRUST. That is, the clause<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">foo==&quot;bar&quot;;</code></div>
</blockquote>
<div class="spacer">
</div>
is equivalent to<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">foo==&quot;bar&quot; -&gt; _MAX_TRUST;</code></div>
</blockquote>
<div class="spacer">
</div>
If the value component of a clause is present, in the simplest case it contains a string expression representing a possible compliance value. For example, consider an assertion with the following Conditions field:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
       Conditions: 
          @user_id == 0 -&gt; &quot;full_access&quot;;             # clause (1) 
          @user_id &lt; 1000 -&gt; &quot;user_access&quot;;           # clause (2) 
          @user_id &lt; 10000 -&gt; &quot;guest_access&quot;;         # clause (3) 
          user_name == &quot;root&quot; -&gt; &quot;full_access&quot;;       # clause (4)</pre>
<div class="spacer">
</div>
Here, if the value of the &#8220;user_id&#8221; attribute is &#8220;1073&#8221; and the &#8220;user_name&#8221; attribute is &#8220;root&#8221;, the possible compliance value set would contain the values &#8220;guest_access&#8221; (by clause (3)) and &#8220;full_access&#8221; (by clause (4)). If the ordered set of compliance values given in the query (in ascending order) is {&#8220;no_access&#8221;, &#8220;guest_access&#8221;, &#8220;user_access&#8221;, &#8220;full_access&#8221;}, the Conditions Compliance Value of the assertion would be &#8220;full_access&#8221; (because &#8220;full_access&#8221; has a higher-order value than &#8220;guest_access&#8221;). If the &#8220;user_id&#8221; attribute had the value &#8220;19283&#8221; and the &#8220;user_name&#8221; attribute had the value &#8220;nobody&#8221;, no clause would succeed and the Conditions Compliance Value would be &#8220;no_access&#8221;, which is the lowest-order possible value (_MIN_TRUST).<div class="spacer">
</div>
If a clause lists an explicit value, its value string must be named in the query ordered compliance value set. Values not named in the query compliance value set are considered equivalent to _MIN_TRUST.<div class="spacer">
</div>
The value component of a clause can also contain recursively-nested clauses. Recursively-nested clauses are evaluated only if their parent test is true. That is,<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
       a==&quot;b&quot; -&gt;  { b==&quot;c&quot; -&gt; &quot;value1&quot;; 
                    d==&quot;e&quot;  -&gt; &quot;value2&quot;; 
                    true -&gt; &quot;value3&quot;; } ;</pre>
<div class="spacer">
</div>
is equivalent to<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
       (a==&quot;b&quot;) &amp;&amp; (b==&quot;c&quot;) -&gt; &quot;value1&quot;; 
       (a==&quot;b&quot;) &amp;&amp; (d==&quot;e&quot;) -&gt; &quot;value2&quot;; 
       (a==&quot;b&quot;) -&gt; &quot;value3&quot;;</pre>
<div class="spacer">
</div>
Notice that string comparisons are case sensitive.<div class="spacer">
</div>
A regular expression comparison (&#8220;~=&#8221;) is considered true if the left-hand-side string expression matches the right-hand-side regular expression. If the POSIX regular expression group matching scheme is used, the number of groups matched is placed in the temporary meta- attribute &#8220;_0&#8221; (dereferenced as _0), and each match is placed in sequence in the temporary attributes (_1, _2, ..., _N). These match-attributes' values are valid only within subsequent references made within the same clause. Regular expression evaluation is case sensitive.<div class="spacer">
</div>
A runtime error occurring in the evaluation of a test, such as division by zero or an invalid regular expression, causes the test to be considered false. For example:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
      foo == &quot;bar&quot; -&gt; { 
                        @a == 1/0 -&gt; &quot;oneval&quot;;    # subclause 1 
                        @a == 2 -&gt; &quot;anotherval&quot;;  # subclause 2 
                      };</pre>
<div class="spacer">
</div>
Here, subclause 1 triggers a runtime error. Subclause 1 is therefore false (and has the value _MIN_TRUST). Subclause 2, however, would be evaluated normally.<div class="spacer">
</div>
An invalid &#10216;RegExpr&#10217; is considered a runtime error and causes the test in which it occurs to be considered false.</div>
<div class="section">
<h1 id="x4c4943454e53454520434f4d504c49414e43452056414c5545">LICENSEE COMPLIANCE VALUE</h1> The Licensee Compliance Value of an assertion is calculated by evaluating the expression in the Licensees field, based on the Principal Compliance Value of the principals named there.<div class="spacer">
</div>
If an assertion's Licensees field is empty, its Licensee Compliance Value is considered to be _MIN_TRUST. If an assertion's Licensees field is missing altogether, its Licensee Compliance Value is considered to be _MAX_TRUST.<div class="spacer">
</div>
For each principal named in the Licensees field, its Principal Compliance Value is substituted for its name. If no Principal Compliance Value can be found for some named principal, its name is substituted with the _MIN_TRUST value.<div class="spacer">
</div>
The licensees expression (see <a class="link-man" href="../html5/keynote.html">keynote(5)</a>) is evaluated as follows:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
A &#8220;(...)&#8221; expression has the value of the enclosed subexpression.</li>
<li class="list-bul" style="margin-top: 1.00em;">
A &#8220;&#8221; expression has the lower-order (minimum) of its two subexpression values.</li>
<li class="list-bul" style="margin-top: 1.00em;">
A &#8220;&#8221; expression has the higher-order (maximum) of its two subexpression values.</li>
<li class="list-bul" style="margin-top: 1.00em;">
A &#8220;&#10216;K&#10217;-of(&#10216;List&#10217;)&#8221; expression has the K-th highest order compliance value listed in &#10216;list&#10217;. Values that appear multiple times are counted with multiplicity. For example, if K = 3 and the orders of the listed compliance values are (0, 1, 2, 2, 3), the value of the expression is the compliance value of order 2.</li>
</ul>
<div class="spacer">
</div>
For example, consider the following Licensees field:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">Licensees: (&quot;alice&quot; &amp;&amp; &quot;bob&quot;) || &quot;eve&quot;</code></div>
</blockquote>
<div class="spacer">
</div>
If the Principal Compliance Value is &#8220;yes&#8221; for principal &#8220;alice&#8221;, &#8220;no&#8221; for principal &#8220;bob&#8221;, and &#8220;no&#8221; for principal &#8220;eve&#8221;, and &#8220;yes&#8221; is higher order than &#8220;no&#8221; in the query's Compliance Value Set, then the resulting Licensee Compliance Value is &#8220;no&#8221;.<div class="spacer">
</div>
Observe that if there are exactly two possible compliance values (e.g., &#8220;false&#8221; and &#8220;true&#8221;), the rules of Licensee Compliance Value resolution reduce exactly to standard Boolean logic.</div>
<div class="section">
<h1 id="x415353455254494f4e204d414e4147454d454e54">ASSERTION MANAGEMENT</h1> Assertions may be either signed or unsigned. Only signed assertions should be used as credentials or transmitted or stored on untrusted media. Unsigned assertions should be used only to specify policy and for assertions whose integrity has already been verified as conforming to local policy by some mechanism external to the KeyNote system itself (e.g., X.509 certificates converted to KeyNote assertions by a trusted conversion program).<div class="spacer">
</div>
Implementations that permit signed credentials to be verified by the KeyNote compliance checker generally provide two &#8216;channels&#8217; through which applications can make assertions available. Unsigned, locally-trusted assertions are provided over a &#8216;trusted&#8217; interface, while signed credentials are provided over an &#8216;untrusted&#8217; interface. The KeyNote compliance checker verifies correct signatures for all assertions submitted over the untrusted interface. The integrity of KeyNote evaluation requires that only assertions trusted as reflecting local policy are submitted to KeyNote via the trusted interface.<div class="spacer">
</div>
Note that applications that use KeyNote exclusively as a local policy specification mechanism need use only trusted assertions. Other applications might need only a small number of infrequently changed trusted assertions to &#8216;bootstrap&#8217; a policy whose details are specified in signed credentials issued by others and submitted over the untrusted interface.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">keynote.h</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">libkeynote.a</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> A policy that delegates authority for the &#8220;SPEND&#8221; application domain to RSA key dab212 when the amount given in the &#8220;dollars&#8221; attribute is less than 10000.<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
        Authorizer: &quot;POLICY&quot; 
        Licensees: &quot;RSA:dab212&quot;  # the CFO's key 
        Conditions: (app_domain==&quot;SPEND&quot;) &amp;&amp; (@dollars &lt; 10000);</pre>
<div class="spacer">
</div>
RSA key dab212 delegates authorization to any two signers, from a list, one of which must be DSA key feed1234 in the &#8220;SPEND&#8221; application when @dollars &lt; 7500. If the amount in @dollars is 2500 or greater, the request is approved but logged.<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
        KeyNote-Version: 2 
        Comment: This credential specifies a spending policy 
        Authorizer: &quot;RSA:dab212&quot;        # the CFO 
        Licensees: &quot;DSA:feed1234&quot; &amp;&amp;    # The vice president 
                       (&quot;RSA:abc123&quot; || # middle manager #1 
                        &quot;DSA:bcd987&quot; || # middle manager #2 
                        &quot;DSA:cde333&quot; || # middle manager #3 
                        &quot;DSA:def975&quot; || # middle manager #4 
                        &quot;DSA:978add&quot;)   # middle manager #5 
        Conditions: (app_domain==&quot;SPEND&quot;)  # note nested clauses 
                      -&gt; { (@(dollars) &lt; 2500) 
                             -&gt; _MAX_TRUST; 
                           (@(dollars) &lt; 7500) 
                             -&gt; &quot;ApproveAndLog&quot;; 
                         }; 
        Signature: &quot;RSA-SHA1:9867a1&quot;</pre>
<div class="spacer">
</div>
According to this policy, any two signers from the list of managers will do if @(dollars) &lt; 1000:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
        KeyNote-Version: 2 
        Authorizer: &quot;POLICY&quot; 
        Licensees: 2-of(&quot;DSA:feed1234&quot;, # The VP 
                        &quot;RSA:abc123&quot;,   # Middle management clones 
                        &quot;DSA:bcd987&quot;, 
                        &quot;DSA:cde333&quot;, 
                        &quot;DSA:def975&quot;, 
                        &quot;DSA:978add&quot;) 
        Conditions: (app_domain==&quot;SPEND&quot;) &amp;&amp; 
                    (@(dollars) &lt; 1000);</pre>
<div class="spacer">
</div>
A credential from dab212 with a similar policy, but only one signer is required if @(dollars) &lt; 500. A log entry is made if the amount is at least 100.<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
        KeyNote-Version: 2 
        Comment: This one credential is equivalent to six separate 
                 credentials, one for each VP and middle manager. 
                 Individually, they can spend up to $500, but if 
                 it's $100 or more, we log it. 
        Authorizer: &quot;RSA:dab212&quot;      # From the CFO 
        Licensees: &quot;DSA:feed1234&quot; ||  # The VP 
                   &quot;RSA:abc123&quot; ||    # The middle management clones 
                   &quot;DSA:bcd987&quot; || 
                   &quot;DSA:cde333&quot; || 
                   &quot;DSA:def975&quot; || 
                   &quot;DSA:978add&quot; 
        Conditions: (app_domain=&quot;SPEND&quot;)  # nested clauses 
                      -&gt; { (@(dollars) &lt; 100) -&gt; _MAX_TRUST; 
                           (@(dollars) &lt; 500) -&gt; &quot;ApproveAndLog&quot;; 
                         }; 
        Signature: &quot;RSA-SHA1:186123&quot;</pre>
<div class="spacer">
</div>
Assume a query in which the ordered set of Compliance Values is {&#8220;Reject&#8221;, &#8220;ApproveAndLog&#8221;, &#8220;Approve&#8221;}. Under policies E and G, and credentials F and H, the Policy Compliance Value is &#8220;Approve&#8221; (_MAX_TRUST) when:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
        _ACTION_AUTHORIZERS = &quot;DSA:978add&quot; 
        app_domain = &quot;SPEND&quot; 
        dollars = &quot;45&quot; 
        unmentioned_attribute = &quot;whatever&quot; 
    and 
        _ACTION_AUTHORIZERS = &quot;RSA:abc123,DSA:cde333&quot; 
        app_domain = &quot;SPEND&quot; 
        dollars = &quot;550&quot;</pre>
<div class="spacer">
</div>
The following return &quot;ApproveAndLog&quot;:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
        _ACTION_AUTHORIZERS = &quot;DSA:feed1234,DSA:cde333&quot; 
        app_domain = &quot;SPEND&quot; 
        dollars = &quot;5500&quot; 
    and 
        _ACTION_AUTHORIZERS = &quot;DSA:cde333&quot; 
        app_domain = &quot;SPEND&quot; 
        dollars = &quot;150&quot;</pre>
<div class="spacer">
</div>
However, the following return &quot;Reject&quot; (_MIN_TRUST):<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
        _ACTION_AUTHORIZERS = &quot;DSA:def975&quot; 
        app_domain = &quot;SPEND&quot; 
        dollars = &quot;550&quot; 
    and 
        _ACTION_AUTHORIZERS = &quot;DSA:cde333,DSA:978add&quot; 
        app_domain = &quot;SPEND&quot; 
        dollars = &quot;5500&quot;</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/keynote.html">keynote(1)</a>, <a class="link-man" href="../html3/keynote.html">keynote(3)</a>, <a class="link-man" href="../html5/keynote.html">keynote(5)</a><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">M. Blaze</span>, <span class="ref-auth">J. Feigenbaum</span>, and <span class="ref-auth">J. Lacy</span>, <span class="ref-title">Decentralized Trust Management</span>, <i class="ref-jrnl">IEEE Symposium on Security and Privacy</i>, <span class="ref-date">1996</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">M. Blaze</span>, <span class="ref-auth">J. Feigenbaum</span>, and <span class="ref-auth">M. Strauss</span>, <span class="ref-title">Compliance-Checking in the PolicyMaker Trust Management System</span>, <i class="ref-jrnl">Financial Crypto Conference</i>, <span class="ref-date">1998</span>.</span></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> <span class="ref"><span class="ref-auth">M. Blaze</span>, <span class="ref-auth">J. Feigenbaum</span>, <span class="ref-auth">J. Ioannidis</span>, and <span class="ref-auth">A. Keromytis</span>, <span class="ref-title">The KeyNote Trust-Management System Version 2</span>, <span class="ref-rep">RFC 2704</span>, <span class="ref-date">September 1999</span>.</span></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Angelos D. Keromytis</span> &lt;<a class="link-mail" href="mailto:angelos@cs.columbia.edu">angelos@cs.columbia.edu</a>&gt;</div>
<div class="section">
<h1 id="x5745422050414745">WEB PAGE</h1> <a class="link-ext" href="http://www1.cs.columbia.edu/~angelos/keynote.html">http://www1.cs.columbia.edu/~angelos/keynote.html</a></div>
</div>
</body>
</html>

