<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
VLAN(4)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">vlan</b>, <b class="name">svlan</b> &#8212; <span class="desc">IEEE 802.1Q/1AD pseudo-device</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">pseudo-device vlan</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">vlan</b> driver provides network interfaces supporting Virtual Local Area Networks (VLANs) on Ethernet networks. <b class="name">vlan</b> interfaces implement virtual networks using the IEEE 802.1q protocol. <b class="name">svlan</b> interfaces implement virtual networks using the IEEE 802.1ad protocol.<div class="spacer">
</div>
<b class="name">svlan</b> interfaces allow construction of IEEE 802.1ad-compliant provider bridges. <b class="name">vlan</b> and <b class="name">svlan</b> interfaces can be configured to provide QinQ or stacked VLANs.<div class="spacer">
</div>
The interfaces can be created at runtime using the <b class="cmd">ifconfig vlan</b><i class="arg">N</i> <b class="cmd">create</b> command or by setting up a <a class="link-man" href="../html5/hostname.if.html">hostname.if(5)</a> configuration file for <a class="link-man" href="../html8/netstart.html">netstart(8)</a>. The interface itself can be configured with <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a>; see its manual page for more information.<div class="spacer">
</div>
<b class="name">vlan</b> and <b class="name">svlan</b> interfaces must be configured with a parent Ethernet interface to operate, and a virtual network identifier. Packets transmitted through a <b class="name">vlan</b> or <b class="name">svlan</b> interface will be encapsulated in their respective protocols and transmitted on the specified physical interface. 802.1q and 802.1ad packets received on the parent interface will be matched to the <b class="name">vlan</b> and <b class="name">svlan</b> interfaces by their respective protocol and virtual network identifiers, and decapsulated for reception on the associated virtual interfaces.<div class="spacer">
</div>
The 802.1q and 802.1ad protocols include a priority field which may be altered via <a class="link-man" href="../html5/pf.conf.html">pf.conf(5)</a>; see the <b class="flag">prio</b> option for more information.<div class="spacer">
</div>
<b class="name">vlan</b> and <b class="name">svlan</b> interfaces support the following <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a>s:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SIOCSIFPARENT</span> <i class="farg">struct if_parent *</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the parent interface. The parent may only be configured while the virtual interface is administratively down.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SIOCGIFPARENT</span> <i class="farg">struct if_parent *</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Get the currently configured parent interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SIOCDIFPARENT</span> <i class="farg">struct ifreq *</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Delete the parent interface configuration. The parent may only be removed while the virtual interface is administratively down.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SIOCSVNETID</span> <i class="farg">struct ifreq *</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the virtual network identifier. Valid identifiers are in the range 1 to 4095.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SIOCGVNETID</span> <i class="farg">struct if_parent *</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Get the currently configured virtual network identifier.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SIOCDVNETID</span> <i class="farg">struct ifreq *</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Clear the current virtual network identifier. Virtual interfaces without a configured virtual network identifier will use 0 in their protocols tag field.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SIOCSIFLLADDR</span> <i class="farg">struct ifreq *</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Configure a custom MAC address on the virtual interface. When the virtual interface is using a custom MAC address the parent interface will be configured to promiscuously receive packets. When operating without a custom MAC address the virtual interface will inherit the parent interfaces MAC address. Configuring 00:00:00:00:00:00 as the MAC address will clear the custom MAC address configuration and resume operation with the parents MAC address.</dd>
</dl>
<div class="spacer">
</div>
<b class="name">vlan</b> and <b class="name">svlan</b> interfaces use the following capability on parent interfaces:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
IFCAP_VLAN_MTU</dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
The parent interface can handle full sized frames, plus the size of the vlan tag.</dd>
</dl>
<div class="spacer">
</div>
<b class="name">vlan</b> interfaces use the following capability on parent interfaces:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
IFCAP_VLAN_HWTAGGING</dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
The parent interface will offload the encapsulation and decapsulation of 802.1q frames.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Create an 802.1q virtual interface on top of the physical interface em0, with virtual network identifier 5:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# ifconfig vlan0 create 
# ifconfig vlan0 parent em0 vnetid 5 
# ifconfig vlan0 10.1.1.100/24</pre>
<div class="spacer">
</div>
Create an 802.1q VLAN interface on network 10, on top of an 802.1ad provider bridge on network 8, on top of the physical interface bge0:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# ifconfig svlan0 create 
# ifconfig svlan0 parent bge0 vnetid 8 
# ifconfig svlan0 up 
# ifconfig vlan0 create 
# ifconfig vlan0 parent svlan0 vnetid 10 
# ifconfig vlan0 10.1.1.101/24</pre>
<div class="spacer">
</div>
Configure an 802.1q VLAN interface with a custom MAC address:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# ifconfig vlan0 lladdr fe:e1:ba:d0:84:0e</pre>
<div class="spacer">
</div>
Remove a custom MAC address from an 802.1q VLAN interface:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# ifconfig vlan0 lladdr 00:00:00:00:00:00</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/inet.html">inet(4)</a>, <a class="link-man" href="../html4/ip.html">ip(4)</a>, <a class="link-man" href="../html4/netintro.html">netintro(4)</a>, <a class="link-man" href="../html5/hostname.if.html">hostname.if(5)</a>, <a class="link-man" href="../html5/pf.conf.html">pf.conf(5)</a>, <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a>, <a class="link-man" href="../html8/netstart.html">netstart(8)</a><div class="spacer">
</div>
<span class="ref"><span class="ref-title">IEEE 802.1q standard</span>, <a class="link-ref" href="http://standards.ieee.org/getieee802/802.1.html">http://standards.ieee.org/getieee802/802.1.html</a>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-title">IEEE 802.1ad standard</span>, <span class="ref-corp">Provider Bridges, QinQ</span>.</span></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> Originally <span class="author">Garrett Wollman</span> &lt;<a class="link-mail" href="mailto:wollman@freebsd.org">wollman@freebsd.org</a>&gt;.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> Some Ethernet chips will either discard or truncate Ethernet frames that are larger than 1514 bytes. This causes a problem as 802.1Q tagged frames can be up to 1518 bytes. Most controller chips can be told not to discard large frames and/or to increase the allowed frame size.</div>
</div>
</body>
</html>

