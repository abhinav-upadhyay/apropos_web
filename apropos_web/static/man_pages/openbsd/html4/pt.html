<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
PTY(4)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">pty</b>, <b class="name">ptm</b> &#8212; <span class="desc">pseudo terminal driver</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">pseudo-device pty</b> [<span class="opt"><i class="arg">count</i></span>]</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">pty</b> driver provides support for a device-pair termed a <span class="emph">pseudo terminal</span>. A pseudo terminal is a pair of character devices, a <span class="emph">master</span> device and a <span class="emph">slave</span> device. The slave device provides to a process an interface identical to that described in <a class="link-man" href="../html4/tty.html">tty(4)</a>. However, whereas all other devices which provide the interface described in <a class="link-man" href="../html4/tty.html">tty(4)</a> have a hardware device of some sort behind them, the slave device has, instead, another process manipulating it through the master half of the pseudo terminal. That is, anything written on the master device is given to the slave device as input and anything written on the slave device is presented as input on the master device.<div class="spacer">
</div>
In configuring, if an optional <i class="arg">count</i> is given in the specification, space for that number of pseudo terminal pairs is preallocated. If the count is missing or is less than 2, a default count of 8 is used. This is not a hard limit--space for additional pseudo terminal pairs is allocated on demand up to the limit imposed by the <code class="lit">kern.tty.maxptys</code> <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a> (992 by default).<div class="spacer">
</div>
The following <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> calls apply only to pseudo terminals and may only be applied to the <b class="name">pty</b> master:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCEXT</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Enable/disable <span class="emph">external processing</span>. External processing is enabled by specifying (by reference) a non-zero <span class="type">int</span> parameter and disabled by specifying (by reference) a zero <span class="type">int</span> parameter.<div class="spacer">
</div>
While external processing is enabled, input line editing, character echo, and mapping of control characters to signals are disabled regardless of the terminal's <a class="link-man" href="../html4/termios.html">termios(4)</a> settings.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCSTOP</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Stops output to a terminal (e.g., like typing &#8216;<code class="lit">^S</code>&#8217;). Takes no parameter.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCSTART</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Restarts output (stopped by <span class="define">TIOCSTOP</span> or by typing &#8216;<code class="lit">^S</code>&#8217;). Takes no parameter.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Enable/disable <span class="emph">packet</span> mode. Packet mode is enabled by specifying (by reference) a non-zero <span class="type">int</span> parameter and disabled by specifying (by reference) a zero <span class="type">int</span> parameter.<div class="spacer">
</div>
While packet mode is enabled, each subsequent <a class="link-man" href="../html2/read.html">read(2)</a> from the <b class="name">pty</b> master will either return data written to the <b class="name">pty</b> slave preceded by a zero byte (symbolically defined as <span class="define">TIOCPKT_DATA</span>), or a single byte reflecting control status information. In the latter case, the byte is an inclusive-or of zero or more of the bits:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_FLUSHREAD</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever the read queue for the terminal is flushed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_FLUSHWRITE</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever the write queue for the terminal is flushed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_STOP</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever output to the terminal is stopped a la &#8216;<code class="lit">^S</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_START</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever output to the terminal is restarted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_DOSTOP</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever <span class="emph">t_stopc</span> is &#8216;<code class="lit">^S</code>&#8217; and <span class="emph">t_startc</span> is &#8216;<code class="lit">^Q</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_NOSTOP</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever the start and stop characters are not &#8216;<code class="lit">^S/^Q</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_IOCTL</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever the terminal's <a class="link-man" href="../html4/termios.html">termios(4)</a> settings change while external processing is enabled.<div class="spacer">
</div>
Additionally, when the <span class="define">TIOCPKT_IOCTL</span> bit is set, the remainder of the data read from the <b class="name">pty</b> master is a copy of the new <a class="link-man" href="../html4/termios.html">termios(4)</a> structure.</dd>
</dl>
<div class="spacer">
</div>
While this mode is in use, the presence of control status information to be read from the master side may be detected by a <a class="link-man" href="../html2/select.html">select(2)</a> for exceptional conditions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCUCNTL</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Enable/disable a mode that allows a small number of simple user <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> commands to be passed through the pseudo terminal, using a protocol similar to that of <span class="define">TIOCPKT</span>. The <span class="define">TIOCUCNTL</span> and <span class="define">TIOCPKT</span> modes are mutually exclusive. This mode is enabled from the master side of a pseudo terminal by specifying (by reference) a nonzero parameter and disabled by specifying (by reference) a zero parameter. Each subsequent <a class="link-man" href="../html2/read.html">read(2)</a> from the master side will return data written on the slave part of the pseudo terminal preceded by a zero byte, or a single byte reflecting a user control operation on the slave side. A user control command consists of a special <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> operation with no data; the command is given as <span class="define">UIOCCMD</span>(n), where <i class="arg">n</i> is a number in the range 1-255. The operation value <i class="arg">n</i> will be received as a single byte on the next <a class="link-man" href="../html2/read.html">read(2)</a> from the master side. The <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> <span class="define">UIOCCMD</span>(0) is a no-op that may be used to probe for the existence of this facility. As with <span class="define">TIOCPKT</span> mode, command operations may be detected with a <a class="link-man" href="../html2/select.html">select(2)</a> for exceptional conditions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCREMOTE</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
A mode for the master half of a pseudo terminal, independent of <span class="define">TIOCPKT</span>. This mode causes input to the pseudo terminal to be flow controlled and not input edited (regardless of the terminal mode). Each write to the control terminal produces a record boundary for the process reading the terminal. In normal usage, a write of data is like the data typed as a line on the terminal; a write of 0 bytes is like typing an end-of-file character. <span class="define">TIOCREMOTE</span> can be used when doing remote line editing in a window manager, or whenever flow controlled input is required.</dd>
</dl>
<div class="spacer">
</div>
The standard way to allocate <b class="name">pty</b> devices is through <a class="link-man" href="../html3/openpty.html">openpty(3)</a>, a function which internally uses a <span class="define">PTMGET</span> <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> call on the <i class="file">/dev/ptm</i> device. The <span class="define">PTMGET</span> command allocates a free pseudo terminal, changes its ownership to the caller, revokes the access privileges for all previous users, opens the file descriptors for the master and slave devices and returns them to the caller in <i class="farg">struct ptmget</i>.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct ptmget { 
	int	cfd; 
	int	sfd; 
	char	cn[16]; 
	char	sn[16]; 
};</pre>
<div class="spacer">
</div>
The <b class="var">cfd</b> and <b class="var">sfd</b> fields are the file descriptors for the controlling and slave terminals. The <b class="var">cn</b> and <b class="var">sn</b> fields are the file names of the controlling and slave devices.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/pty[p-zP-T][0-9a-zA-Z]</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
master pseudo terminals</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/tty[p-zP-T][0-9a-zA-Z]</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
slave pseudo terminals</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/ptm</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
pseudo terminal management device</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/openpty.html">openpty(3)</a>, <a class="link-man" href="../html4/tty.html">tty(4)</a>, <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">pty</b> driver appeared in <span class="unix">4.2BSD</span>. The <i class="file">/dev/ptm</i> device was added in <span class="unix">OpenBSD&#160;3.5</span>.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> The <i class="file">ptm</i> device will only work on systems where the <i class="file">/dev</i> directory has been properly populated with <b class="name">pty</b> device nodes following the naming convention used in <span class="unix">OpenBSD</span>. Since <i class="file">ptm</i> impersonates the super user for some operations it needs to perform to complete the allocation of a pseudo terminal, the <i class="file">/dev</i> directory must also be writeable by the super user.</div>
</div>
</body>
</html>

