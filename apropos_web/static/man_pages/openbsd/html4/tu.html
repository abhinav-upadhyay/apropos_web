<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
TUN(4)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">tun</b> &#8212; <span class="desc">network tunnel pseudo-device</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">pseudo-device tun</b><div class="spacer">
</div>
<br/>
<b class="includes">#include &lt;<a class="link-includes">sys/types.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">net/if_tun.h</a>&gt;</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">tun</b> driver provides a network interface pseudo-device. Packets sent to this interface can be read by a userland process and processed as desired. Packets written by the userland process are injected back into the kernel networking subsystem.<div class="spacer">
</div>
A <b class="name">tun</b> interface can be created at runtime using the <b class="cmd">ifconfig tun</b><i class="arg">N</i> <b class="cmd">create</b> command or by opening the character special device <i class="file">/dev/tunN</i>.<div class="spacer">
</div>
Each device has an exclusive open property: it cannot be opened if it is already open and in use by another process. Each read returns at most one packet; if insufficient buffer space is provided, the packet is truncated. Each write supplies exactly one packet. Each packet read or written is prefixed with a tunnel header consisting of a 4-byte network byte order integer containing the address family. On the last close of the device, all queued packets are discarded. If the device was created by opening <i class="file">/dev/tunN</i>, it will be automatically destroyed. Devices created via <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a> are only marked as not running and traffic will be dropped returning <span class="errno">EHOSTDOWN</span>.<div class="spacer">
</div>
Writes never block. If the protocol queue is full, the packet is dropped, a &#8220;collision&#8221; is counted, and <span class="errno">ENOBUFS</span> is returned.<div class="spacer">
</div>
In addition to the usual network interface ioctl commands described in <a class="link-man" href="../html4/netintro.html">netintro(4)</a>, the following special commands defined in <b class="includes">&lt;<a class="link-includes">net/if_tun.h</a>&gt;</b> are supported:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">TUNGIFINFO</span> <i class="farg">struct tuninfo *</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">TUNSIFINFO</span> <i class="farg">struct tuninfo *</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Get or set the interface characteristics.<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
/* iface info */ 
struct tuninfo { 
        u_int   mtu; 
        u_short type; 
        u_short flags; 
        u_int   baudrate; 
};</pre>
<div class="spacer">
</div>
<b class="var">flags</b> sets the interface flags, and can include one or more of <span class="define">IFF_UP</span>, <span class="define">IFF_POINTOPOINT</span>, <span class="define">IFF_MULTICAST</span>, <span class="define">IFF_BROADCAST</span>. Flags given will be set; flags omitted will be cleared; flags not in this list will not be changed even when given. Flags default to <span class="define">IFF_POINTOPOINT</span>. It is an error to set both <span class="define">IFF_POINTOPOINT</span> and <span class="define">IFF_BROADCAST</span>. <b class="var">type</b> defaults to <span class="define">IFT_TUNNEL</span>. This sets the interface media address header type.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">TUNSIFMODE</span> <i class="farg">int *flags</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set just the interface flags. The same restrictions as for <span class="define">TUNSIFINFO</span> apply.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">FIONBIO</span> <i class="farg">int *flag</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set non-blocking I/O.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">FIOASYNC</span> <i class="farg">int *flag</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Cause signal <span class="define">SIGIO</span> to be sent when a packet can be read.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">TIOCSPGRP</span> <i class="farg">int *pgrp</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">TIOCGPGRP</span> <i class="farg">int *pgrp</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Get or set the process group to which signals might be sent via <span class="define">FIOASYNC</span>.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">FIONREAD</span> <i class="farg">int *count</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Get the byte count of the next packet available to be read.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/tun*</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
</dd>
</dl>
</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> If open fails, <a class="link-man" href="../html2/errno.html">errno(2)</a> may be set to one of:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENXIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Not that many devices configured.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBUSY</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Device was already open.</dd>
</dl>
<div class="spacer">
</div>
If a <a class="link-man" href="../html2/write.html">write(2)</a> call fails, <a class="link-man" href="../html2/errno.html">errno(2)</a> is set to one of:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EMSGSIZE</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The packet supplied was too small or too large. The maximum sized packet allowed is currently 16384 bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOBUFS</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
There were no mbufs, or the queue for the outgoing protocol is full.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EAFNOSUPPORT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The address family specified in the tunnel header was not recognized.</dd>
</dl>
<div class="spacer">
</div>
Ioctl commands may fail with:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Attempt to set both <span class="define">IFF_POINTOPOINT</span> and <span class="define">IFF_BROADCAST</span> with <span class="define">TUNSIFMODE</span> or using <span class="define">SIOCGIFADDR</span> or <span class="define">SIOCSIFADDR</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTTY</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Unrecognized ioctl command.</dd>
</dl>
<div class="spacer">
</div>
A <a class="link-man" href="../html2/read.html">read(2)</a> call may fail because of:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EHOSTDOWN</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The device is not ready. The device must have an <a class="link-man" href="../html4/inet.html">inet(4)</a> interface address assigned to it, such as via <span class="define">SIOCSIFADDR</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EWOULDBLOCK</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Non-blocking I/O was selected and no packets were available.</dd>
</dl>
<div class="spacer">
</div>
An attempt to send a packet out via the interface may fail with:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EHOSTDOWN</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The device is not ready. The device must have an <a class="link-man" href="../html4/inet.html">inet(4)</a> interface address assigned to it, such as via <span class="define">SIOCSIFADDR</span>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/inet.html">inet(4)</a>, <a class="link-man" href="../html4/intro.html">intro(4)</a>, <a class="link-man" href="../html4/netintro.html">netintro(4)</a>, <a class="link-man" href="../html5/hostname.if.html">hostname.if(5)</a>, <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a>, <a class="link-man" href="../html8/netstart.html">netstart(8)</a></div>
</div>
</body>
</html>

