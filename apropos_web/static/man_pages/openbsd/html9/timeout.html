<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
TIMEOUT_SET(9)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">timeout_set</b>, <b class="name">timeout_add</b>, <b class="name">timeout_add_sec</b>, <b class="name">timeout_add_msec</b>, <b class="name">timeout_add_nsec</b>, <b class="name">timeout_add_usec</b>, <b class="name">timeout_add_tv</b>, <b class="name">timeout_add_ts</b>, <b class="name">timeout_add_bt</b>, <b class="name">timeout_del</b>, <b class="name">timeout_pending</b>, <b class="name">timeout_initialized</b>, <b class="name">timeout_triggered</b>, <b class="name">TIMEOUT_INITIALIZER</b> &#8212; <span class="desc">execute a function after a specified period of time</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/types.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">sys/timeout.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">timeout_set</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>, <i class="farg" style="white-space:nowrap;">void (*fn)(void *)</i>, <i class="farg" style="white-space:nowrap;">void *arg</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">timeout_add</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>, <i class="farg" style="white-space:nowrap;">int ticks</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">timeout_del</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">timeout_pending</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">timeout_initialized</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">timeout_triggered</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">timeout_add_tv</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>, <i class="farg" style="white-space:nowrap;">struct timeval *</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">timeout_add_ts</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>, <i class="farg" style="white-space:nowrap;">struct timespec *</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">timeout_add_bt</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>, <i class="farg" style="white-space:nowrap;">struct bintime *</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">timeout_add_sec</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>, <i class="farg" style="white-space:nowrap;">int sec</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">timeout_add_msec</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>, <i class="farg" style="white-space:nowrap;">int msec</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">timeout_add_usec</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>, <i class="farg" style="white-space:nowrap;">int usec</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">timeout_add_nsec</b>(<i class="farg" style="white-space:nowrap;">struct timeout *to</i>, <i class="farg" style="white-space:nowrap;">int nsec</i>);<div class="spacer">
</div>
<b class="fname">TIMEOUT_INITIALIZER</b>(<i class="farg" style="white-space:nowrap;">void (*fn)(void *)</i>, <i class="farg" style="white-space:nowrap;">void *arg</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">timeout</b> API provides a mechanism to execute a function at a given time. The granularity of the time is limited by the granularity of the <a class="link-man" href="../html9/hardclock.html">hardclock(9)</a> timer which executes <a class="link-man" href="../html9/hz.html">hz(9)</a> times a second.<div class="spacer">
</div>
It is the responsibility of the caller to provide these functions with pre-allocated timeout structures.<div class="spacer">
</div>
The function <b class="fname">timeout_set</b>() prepares the timeout structure <i class="farg">to</i> to be used in future calls to <b class="fname">timeout_add</b>() and <b class="fname">timeout_del</b>(). The timeout will be prepared to call the function specified by the <i class="farg">fn</i> argument with a <i class="farg">void *</i> argument given in the <i class="farg">arg</i> argument. Once initialized, the <i class="farg">to</i> structure can be used repeatedly in <b class="fname">timeout_add</b>() and <b class="fname">timeout_del</b>() and does not need to be reinitialized unless the function called and/or its argument must change.<div class="spacer">
</div>
The function <b class="fname">timeout_add</b>() schedules the execution of the <i class="farg">to</i> timeout in at least <i class="farg">ticks</i>/hz seconds. Negative values of <i class="farg">ticks</i> are illegal. If the value is &#8216;0&#8217; it will, in the current implementation, be treated as &#8216;1&#8217;, but in the future it might cause an immediate timeout. The timeout in the <i class="farg">to</i> argument must be already initialized by <b class="fname">timeout_set</b>() and may not be used in calls to <b class="fname">timeout_set</b>() until it has timed out or been removed with <b class="fname">timeout_del</b>(). If the timeout in the <i class="farg">to</i> argument is already scheduled, the old execution time will be replaced by the new one.<div class="spacer">
</div>
The function <b class="fname">timeout_del</b>() will cancel the timeout in the argument <i class="farg">to</i>. If the timeout has already executed or has never been added the call will have no effect.<div class="spacer">
</div>
The <b class="fname">timeout_pending</b>() macro can be used to check if a timeout is scheduled to run.<div class="spacer">
</div>
The <b class="fname">timeout_initialized</b>() macro can be used to check if a timeout has been initialized.<div class="spacer">
</div>
The <b class="fname">timeout_triggered</b>() macro can be used to check if a timeout is running or has been run. The <b class="fname">timeout_add</b>() and <b class="fname">timeout_del</b>() functions clear the triggered state for that timeout.<div class="spacer">
</div>
When possible, use the <b class="fname">timeout_add_tv</b>(), <b class="fname">timeout_add_ts</b>(), <b class="fname">timeout_add_bt</b>(), <b class="fname">timeout_add_sec</b>(), <b class="fname">timeout_add_msec</b>(), <b class="fname">timeout_add_usec</b>(), and <b class="fname">timeout_add_nsec</b>() functions instead of <b class="fname">timeout_add</b>(). Those functions add a timeout whilst converting the time specified by the respective types.<div class="spacer">
</div>
A timeout declaration can be initialised with the <b class="fname">TIMEOUT_INITIALIZER</b>() macro. The timeout will be prepared to call the function specified by the <i class="farg">fn</i> argument with the <i class="farg">void *</i> argument given in <i class="farg">arg</i>.</div>
<div class="section">
<h1 id="x434f4e54455854">CONTEXT</h1> <b class="fname">timeout_set</b>() can be called during autoconf, from process context, or from interrupt context.<div class="spacer">
</div>
<b class="fname">timeout_add</b>(), <b class="fname">timeout_add_sec</b>(), <b class="fname">timeout_add_msec</b>(), <b class="fname">timeout_add_nsec</b>(), <b class="fname">timeout_add_usec</b>(), <b class="fname">timeout_add_tv</b>(), <b class="fname">timeout_add_ts</b>(), <b class="fname">timeout_add_bt</b>(), <b class="fname">timeout_del</b>(), <b class="fname">timeout_pending</b>(), <b class="fname">timeout_initialized</b>(), <b class="fname">timeout_triggered</b>() can be called during autoconf, from process context, or from any interrupt context at or below <span class="define">IPL_CLOCK</span>.<div class="spacer">
</div>
When the timeout runs, the <i class="farg">fn</i> argument to <b class="fname">timeout_set</b>() will be called in an interrupt context at <span class="define">IPL_SOFTCLOCK</span>.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">timeout_add</b>(), <b class="fname">timeout_add_sec</b>(), <b class="fname">timeout_add_msec</b>(), <b class="fname">timeout_add_nsec</b>(), <b class="fname">timeout_add_usec</b>(), <b class="fname">timeout_add_tv</b>(), <b class="fname">timeout_add_ts</b>(), and <b class="fname">timeout_add_bt</b>() will return 1 if the timeout <i class="farg">to</i> was added to the timeout schedule or 0 if it was already queued.<div class="spacer">
</div>
<b class="fname">timeout_del</b>() will return 1 if the timeout <i class="farg">to</i> was removed from the pending timeout schedule or 0 if it was not currently queued.</div>
<div class="section">
<h1 id="x434f4445205245464552454e434553">CODE REFERENCES</h1> These functions are implemented in the file <i class="file">sys/kern/kern_timeout.c</i>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html9/hz.html">hz(9)</a>, <a class="link-man" href="../html9/splclock.html">splclock(9)</a>, <a class="link-man" href="../html9/tsleep.html">tsleep(9)</a>, <a class="link-man" href="../html9/tvtohz.html">tvtohz(9)</a></div>
</div>
</body>
</html>

