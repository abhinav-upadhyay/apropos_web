<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
RASOPS(9)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">rasops</b>, <b class="name">rasops_init</b>, <b class="name">rasops_reconfig</b> &#8212; <span class="desc">raster display operations</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">dev/wscons/wsdisplayvar.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">dev/rasops/rasops.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">rasops_init</b>(<i class="farg" style="white-space:nowrap;">struct rasops_info *ri</i>, <i class="farg" style="white-space:nowrap;">int wantrows</i>, <i class="farg" style="white-space:nowrap;">int wantcols</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">rasops_reconfig</b>(<i class="farg" style="white-space:nowrap;">struct rasops_info *ri</i>, <i class="farg" style="white-space:nowrap;">int wantrows</i>, <i class="farg" style="white-space:nowrap;">int wantcols</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">rasops</b> subsystem is a set of raster operations for <a class="link-man" href="../html4/wscons.html">wscons(4)</a>.<div class="spacer">
</div>
The primary data type for using the raster operations is the <span class="emph">rasops_info</span> structure in <i class="file">dev/rasops/rasops.h</i>:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
struct rasops_info { 
 
	/* 
	 * These must be filled in by the caller 
	 */ 
	int	ri_depth;	/* depth in bits */ 
	u_char	*ri_bits;	/* ptr to bits */ 
	int	ri_width;	/* width (pels) */ 
	int	ri_height;	/* height (pels) */ 
	int	ri_stride;	/* stride in bytes */ 
 
	/* 
	 * These can optionally be left zeroed out. If you fill ri_font, 
	 * but aren't using wsfont, set ri_wsfcookie to -1. 
	 */ 
	struct	wsdisplay_font *ri_font; 
	int	ri_wsfcookie;	/* wsfont cookie */ 
	void	*ri_hw;		/* driver private data */ 
	struct wsdisplay_charcell *ri_bs; /* character backing store */ 
	int	ri_crow;	/* cursor row */ 
	int	ri_ccol;	/* cursor column */ 
	int	ri_flg;		/* various operational flags */ 
 
	/* 
	 * These are optional and will default if zero. Meaningless 
	 * on depths other than 15, 16, 24 and 32 bits per pel. On 
	 * 24 bit displays, ri_{r,g,b}num must be 8. 
	 */ 
	u_char	ri_rnum;	/* number of bits for red */ 
	u_char	ri_gnum;	/* number of bits for green */ 
	u_char	ri_bnum;	/* number of bits for blue */ 
	u_char	ri_rpos;	/* which bit red starts at */ 
	u_char	ri_gpos;	/* which bit green starts at */ 
	u_char	ri_bpos;	/* which bit blue starts at */ 
 
	/* 
	 * These are filled in by rasops_init() 
	 */ 
	int	ri_emuwidth;	/* width we actually care about */ 
	int	ri_emuheight;	/* height we actually care about */ 
	int	ri_emustride;	/* bytes per row we actually care about */ 
	int	ri_rows;	/* number of rows (characters) */ 
	int	ri_cols;	/* number of columns (characters) */ 
	int	ri_delta;	/* row delta in bytes */ 
	int	ri_pelbytes;	/* bytes per pel (may be zero) */ 
	int	ri_fontscale;	/* fontheight * fontstride */ 
	int	ri_xscale;	/* fontwidth * pelbytes */ 
	int	ri_yscale;	/* fontheight * stride */ 
	u_char  *ri_origbits;	/* where screen bits actually start */ 
	int	ri_xorigin;	/* where ri_bits begins (x) */ 
	int	ri_yorigin;	/* where ri_bits begins (y) */ 
	int32_t	ri_devcmap[16]; /* color -&gt; framebuffer data */ 
 
	/* 
	 * The emulops you need to use, and the screen caps for wscons 
	 */ 
	struct	wsdisplay_emulops ri_ops; 
	int	ri_caps; 
 
	/* 
	 * Callbacks so we can share some code 
	 */ 
	void	(*ri_do_cursor)(struct rasops_info *); 
	void	(*ri_updatecursor)(struct rasops_info *); 
 
#if NRASOPS_ROTATION &gt; 0 
	/* Used to intercept putchar to permit display rotation */ 
	struct	wsdisplay_emulops ri_real_ops; 
#endif 
};</pre>
<div class="spacer">
</div>
The value of the <span class="emph">ri_flg</span> member is formed by OR'ing the following values:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
RI_FULLCLEAR</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Force eraserows() to clear the whole screen instead of only text lines, when invoked with an <span class="emph">nrows</span> parameter equal to the number of text lines.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
RI_FORCEMONO</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Do not output coloured text, even if the display supports it.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
RI_BSWAP</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Specifies that the frame buffer endianness is different from the CPU's.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
RI_CURSOR</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Set when the text cursor is enabled.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
RI_CLEAR</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Clear the display upon initialization.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
RI_CENTER</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Center the text area.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
RI_ROTATE_CW</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Rotate the text display quarter clockwise.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
RI_CFGDONE</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
<b class="fname">rasops_reconfig</b>() completed successfully</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
RI_VCONS</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Support the use of multiple screens.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
RI_WRONLY</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Do not read back pixels from the frame buffer memory when performing screen-to-screen copy operations. This flag is ignored unless <span class="define">RI_VCONS</span> is set or the <span class="emph">ri_bs</span> member is set.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46554e4354494f4e53">FUNCTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">rasops_init</b>(<i class="farg">ri</i>, <i class="farg">wantrows</i>, <i class="farg">wantcols</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Initialise a <span class="emph">rasops_info</span> descriptor. The arguments <i class="farg">wantrows</i> and <i class="farg">wantcols</i> are the number of rows and columns we'd like. In terms of optimization, fonts that are a multiple of 8 pixels wide work the best.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">rasops_reconfig</b>(<i class="farg">ri</i>, <i class="farg">wantrows</i>, <i class="farg">wantcols</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Reconfigure a <span class="emph">rasops_info</span> descriptor because parameters have changed in some way. The arguments <i class="farg">wantrows</i> and <i class="farg">wantcols</i> are the number of rows and columns we'd like. If calling <b class="fname">rasops_reconfig</b>() to change the font and ri_wsfcookie &#8805; 0, you must call <b class="fname">wsfont_unlock</b>() on it, and reset it to -1 (or a new, valid cookie).</dd>
</dl>
</div>
<div class="section">
<h1 id="x434f4445205245464552454e434553">CODE REFERENCES</h1> This section describes places within the <span class="unix">OpenBSD</span> source tree where actual code implementing or utilising the rasops subsystem can be found. All pathnames are relative to <i class="file">/usr/src</i>.<div class="spacer">
</div>
The rasops subsystem is implemented within the directory <i class="file">sys/dev/rasops</i>. The <b class="name">rasops</b> module itself is implemented within the file <i class="file">sys/dev/rasops/rasops.c</i>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html9/intro.html">intro(9)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">rasops</b> subsystem appeared in <span class="unix">NetBSD&#160;1.5</span> and <span class="unix">OpenBSD</span> first support appeared in <span class="unix">OpenBSD&#160;2.9</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="name">rasops</b> subsystem was written by <span class="author">Andrew Doran</span> &lt;<a class="link-mail" href="mailto:ad@NetBSD.org">ad@NetBSD.org</a>&gt;. Display rotation was written by <span class="author">Christopher Pascoe</span> &lt;<a class="link-mail" href="mailto:pascoe@openbsd.org">pascoe@openbsd.org</a>&gt;.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> Display rotation only works for 16bpp displays.</div>
</div>
</body>
</html>

