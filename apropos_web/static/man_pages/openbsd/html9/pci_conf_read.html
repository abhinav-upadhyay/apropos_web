<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
PCI_CONF_READ(9)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">pci_make_tag</b>, <b class="name">pci_decompose_tag</b>, <b class="name">pci_conf_read</b>, <b class="name">pci_conf_write</b> &#8212; <span class="desc">PCI config space manipulation functions</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">alpha/pci/pci_machdep.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">i386/pci/pci_machdep.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">powerpc/pci/pci_machdep.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">sgi/pci/pci_machdep.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">machine/pci_machdep.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">pcitag_t</i><br/>
<b class="fname">pci_make_tag</b>(<i class="farg" style="white-space:nowrap;">pci_chipset_tag_t pc</i>, <i class="farg" style="white-space:nowrap;">int bus</i>, <i class="farg" style="white-space:nowrap;">int dev</i>, <i class="farg" style="white-space:nowrap;">int func</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">pci_decompose_tag</b>(<i class="farg" style="white-space:nowrap;">pci_chipset_tag_t pc</i>, <i class="farg" style="white-space:nowrap;">pcitag_t tag</i>, <i class="farg" style="white-space:nowrap;">int *busp</i>, <i class="farg" style="white-space:nowrap;">int *devp</i>, <i class="farg" style="white-space:nowrap;">int *funcp</i>);<div class="spacer">
</div>
<i class="ftype">pcireg_t</i><br/>
<b class="fname">pci_conf_read</b>(<i class="farg" style="white-space:nowrap;">pci_chipset_tag_t pc</i>, <i class="farg" style="white-space:nowrap;">pcitag_t tag</i>, <i class="farg" style="white-space:nowrap;">int reg</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">pci_conf_write</b>(<i class="farg" style="white-space:nowrap;">pci_chipset_tag_t pc</i>, <i class="farg" style="white-space:nowrap;">pcitag_t tag</i>, <i class="farg" style="white-space:nowrap;">int reg</i>, <i class="farg" style="white-space:nowrap;">pcireg_t val</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> These functions provide a way to access PCI configuration space.<div class="spacer">
</div>
The following types are defined in the machine dependent include file <b class="includes">&lt;<a class="link-includes">pci_machdep.h</a>&gt;</b>.<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
pci_chipset_tag_t</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
a PCI chipset descriptor;</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
pcitag_t</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
a PCI device tag;</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
pcireg_t</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
a PCI register datum.</dd>
</dl>
<div class="spacer">
</div>
In order to access PCI configuration space, a device tag shall be made using <b class="name">pci_make_tag</b> given the PCI chipset tag <i class="arg">pc</i> and the device specification in a tuple of <i class="arg">bus</i>, <i class="arg">device</i>, <i class="arg">function</i>. The PCI tag composition is a PCI chipset dependent operation although often as simple as a shift and logical OR combination.<div class="spacer">
</div>
The <b class="name">pci_decompose_tag</b> provides a reverse operation. Once a tag is composed, it is possible to perform configuration space read and write with <b class="name">pci_conf_read</b> and <b class="name">pci_conf_write</b>, respectively. Access to PCI configuration space is only provided for whole <b class="name">pcireg_t</b> items, which is usually a 32-bit integer. Access to non-existent PCI devices do not (or should not) generate any kinds of faults or interruptions and thus allow for an easy device scanning by cycling through all possible device and function numbers for a given bus.<div class="spacer">
</div>
Below is an overview of defined PCI configuration space registers for devices:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
0x00</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Vendor (lower word) and Product (higher word) identification (see <i class="file">/sys/dev/pci/pcidevs</i> for a comprehensive list).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
0x04</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Commands and Status register.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
0x08</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
PCI device's class and subclass IDs. See <i class="file">/sys/dev/pci/pcireg.h</i> for PCI_CLASS_* and PCI_SUBCLASS_* definitions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
0x0c</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specify (low byte to high): cache line size, PCI latency timer, header type, and BIST.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
0x10 - 0x28</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Base address registers for I/O and memory space mapped registers.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
0x28</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
CardBus CIS register.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
0x2c</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Similar to 0x00 register's definitions for a subsystem identification.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
0x34</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A pointer to the capabilities list. Each item is an offset in the configuration space itself.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
0x3c</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Interrupt line and pin numbers.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/cardbus.html">cardbus(4)</a>, <a class="link-man" href="../html4/pci.html">pci(4)</a>, <a class="link-man" href="../html9/pci_intr_map.html">pci_intr_map(9)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> These functions first appeared in <span class="unix">OpenBSD&#160;1.2</span>.</div>
</div>
</body>
</html>

