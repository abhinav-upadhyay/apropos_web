<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
DUMP(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">dump</b>, <b class="name">rdump</b> &#8212; <span class="desc">filesystem backup</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 4.00ex;"/>
<col/>
<tbody>
<tr>
<td>
dump</td>
<td>
[<span class="opt"><b class="flag">-0123456789acnSuWw</b></span>] [<span class="opt"><b class="flag">-B</b>&#160;<i class="arg">records</i></span>] [<span class="opt"><b class="flag">-b</b>&#160;<i class="arg">blocksize</i></span>] [<span class="opt"><b class="flag">-d</b>&#160;<i class="arg">density</i></span>] [<span class="opt"><b class="flag">-f</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-h</b>&#160;<i class="arg">level</i></span>] [<span class="opt"><b class="flag">-s</b>&#160;<i class="arg">feet</i></span>] [<span class="opt"><b class="flag">-T</b>&#160;<i class="arg">date</i></span>]&#160;<i class="arg">files-to-dump</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">dump</b> examines files on a filesystem and determines which files need to be backed up. These files are copied to the given disk, tape or other storage medium for safe keeping. A dump that is larger than the output medium is broken into multiple volumes. On most media the size is determined by writing until an end-of-media indication is returned. This can be enforced by using the <b class="flag">-a</b> option.<div class="spacer">
</div>
<b class="name">dump</b> works across networks, replacing the functionality of the old <b class="name">rdump</b> program (though <b class="name">dump</b> may still be invoked as <b class="name">rdump</b>). See the <b class="flag">-f</b> option for more on writing backups to remote hosts.<div class="spacer">
</div>
Files can be marked with the &#8220;nodump&#8221; flag using <a class="link-man" href="../html1/chflags.html">chflags(1)</a>, settable only by the file's owner or the superuser. Files with this flag set will only be dumped during full backups. When set on a directory, &#8220;nodump&#8221; effectively deselects the whole subtree from being dumped, though it will still be scanned. See also the <b class="flag">-h</b> option, below.<div class="spacer">
</div>
On media that cannot reliably return an end-of-media indication (such as some cartridge tape drives), each volume is of a fixed size; the actual size is determined by the tape size, density and/or block count options below. By default, the same output file name is used for each volume after prompting the operator to change media.<div class="spacer">
</div>
Rewinding or ejecting tape features after a close operation on a tape device depend on the name of the tape unit device used. See the <b class="flag">-f</b> option and <a class="link-man" href="../html4/st.html">st(4)</a> for more information.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-0-9</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Dump levels. A level 0, full backup, guarantees the entire file system is copied (but see also the <b class="flag">-h</b> option below). A level number above 0, incremental backup, tells <b class="name">dump</b> to copy all files new or modified since the last dump of a lower level. The default level is 0.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-a</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;auto-size&#8221;. Bypass all tape length considerations, and enforce writing until an end-of-media indication is returned. This option is recommended for most modern tape drives. Use of this option is particularly recommended when appending to an existing tape, or using a tape drive with hardware compression (where you can never be sure about the compression ratio).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-B</b> <i class="arg">records</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The number of kilobytes per volume, rounded down to a multiple of the blocksize. This option overrides the calculation of tape size based on length and density.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-b</b> <i class="arg">blocksize</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The number of kilobytes per dump record. Since the I/O system slices all requests into chunks of MAXBSIZE (typically 64KB), it is not possible to use a larger blocksize without having problems later with <a class="link-man" href="../html8/restore.html">restore(8)</a>. Therefore <b class="name">dump</b> will constrain writes to MAXBSIZE.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-c</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Change the defaults for use with a cartridge tape drive, with a density of 8000 bpi, and a length of 1700 feet.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b> <i class="arg">density</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set tape density to <i class="arg">density</i>. The default is 1600BPI.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-f</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Write the backup to <i class="arg">file</i>; <i class="arg">file</i> may be a special device file like <i class="file">/dev/rst0</i> (a tape drive), <i class="file">/dev/rsd1c</i> (a disk drive), an ordinary file, or &#8216;-&#8217; (the standard output). See also the <span class="env">TAPE</span> environment variable, below.<div class="spacer">
</div>
Multiple file names may be given as a single argument separated by commas. Each file will be used for one dump volume in the order listed; if the dump requires more volumes than the number of names given, the last file name will be used for all remaining volumes after prompting for media changes. If the name of the file is of the form &#8220;host:file&#8221; or &#8220;user@host:file&#8221;, <b class="name">dump</b> writes to the named file on the remote host using <a class="link-man" href="../html8/rmt.html">rmt(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-h</b> <i class="arg">level</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Honor the user &#8220;nodump&#8221; flag (see above), only for dumps at or above the given <i class="arg">level</i>. The default honor level is 1, so that incremental backups omit such files but full backups retain them.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-n</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Whenever <b class="name">dump</b> requires operator attention, notify all operators in the group &#8220;operator&#8221; by means similar to a <a class="link-man" href="../html1/wall.html">wall(1)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-S</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Display an estimate of the backup size and the number of tapes required, and exit without actually performing the dump.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-s</b> <i class="arg">feet</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Attempt to calculate the amount of tape needed at a particular density. If this amount is exceeded, <b class="name">dump</b> prompts for a new tape. It is recommended to be a bit conservative on this option. The default tape length is 2300 feet.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-T</b> <i class="arg">date</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the specified date as the starting time for the dump instead of the time determined from looking in <i class="file">/etc/dumpdates</i>. The format of <i class="arg">date</i> is the same as that of <a class="link-man" href="../html3/ctime.html">ctime(3)</a>. This option is useful for automated dump scripts that wish to dump over a specific period of time. The <b class="flag">-T</b> flag is mutually exclusive from the <b class="flag">-u</b> flag.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-u</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Update the file <i class="file">/etc/dumpdates</i> after a successful dump. The format of <i class="file">/etc/dumpdates</i> is human readable, consisting of one free format record per line: filesystem name (defaults to <a class="link-man" href="../html8/disklabel.html">disklabel(8)</a> UID when possible), increment level and <a class="link-man" href="../html3/ctime.html">ctime(3)</a> format dump date. There may be only one entry per filesystem at each level. The file <i class="file">/etc/dumpdates</i> may be edited to change any of the fields, if necessary. If a list of files or subdirectories is being dumped (as opposed to an entire filesystem), then <b class="flag">-u</b> is ignored.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-W</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<b class="name">dump</b> tells the operator what file systems need to be dumped. This information is gleaned from the files <i class="file">/etc/dumpdates</i> and <i class="file">/etc/fstab</i>. The <b class="flag">-W</b> flag causes <b class="name">dump</b> to print out, for each file system in <i class="file">/etc/dumpdates</i>, the most recent dump date and level, and highlights those file systems that should be dumped. If the <b class="flag">-W</b> flag is set, all other options are ignored, and <b class="name">dump</b> exits immediately.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-w</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Same as <b class="flag">-W</b>, but prints only those filesystems which need to be dumped.</dd>
</dl>
<div class="spacer">
</div>
<i class="arg">files-to-dump</i> is either a mountpoint of a filesystem or a list of files and directories on a single filesystem to be backed up as a subset of the filesystem. In the former case, either the path to a mounted filesystem, the device of an unmounted filesystem or the <a class="link-man" href="../html8/disklabel.html">disklabel(8)</a> UID can be used. In the latter case, certain restrictions are placed on the backup: <b class="flag">-u</b> is ignored, the only dump level that is supported is <b class="flag">-0</b>, and all of the files must reside on the same filesystem.<div class="spacer">
</div>
<b class="name">dump</b> requires operator intervention on these conditions: end of tape, end of dump, tape write error, tape open error or disk read error (if there is more than a threshold of 32). In addition to alerting all operators implied by the <b class="flag">-n</b> flag, <b class="name">dump</b> interacts with the operator on <b class="name">dump</b>'s control terminal at times when <b class="name">dump</b> can no longer proceed, or if something is grossly wrong. All questions <b class="name">dump</b> poses <span class="emph">must</span> be answered by typing &#8220;yes&#8221; or &#8220;no&#8221;, appropriately.<div class="spacer">
</div>
Since making a dump involves a lot of time and effort for full dumps, <b class="name">dump</b> checkpoints itself at the start of each tape volume. If writing that volume fails for some reason, <b class="name">dump</b> will, with operator permission, restart itself from the checkpoint after the old tape has been rewound and removed, and a new tape has been mounted.<div class="spacer">
</div>
<b class="name">dump</b> tells the operator what is going on at periodic intervals, including usually low estimates of the number of blocks to write, the number of tapes it will take, the time to completion, and the time to the tape change. The output is verbose, so that others know that the terminal controlling <b class="name">dump</b> is busy, and will be for some time.<div class="spacer">
</div>
If <b class="name">dump</b> receives a <span class="define">SIGINFO</span> signal (see the &#8220;status&#8221; argument of <a class="link-man" href="../html1/stty.html">stty(1)</a>) whilst a backup is in progress, statistics on the amount completed, current transfer rate, and estimated finished time, will be written to the standard error output.<div class="spacer">
</div>
In the event of a catastrophic disk event, the time required to restore all the necessary backup tapes or files to disk is dependent on the levels of the dumps taken. A few methods of staggering incremental dumps to either minimize backup effort or restore effort follow:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
Always start with a level 0 backup, for example:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# /sbin/dump -0u -f /dev/nrst1 /usr/src</pre>
<div class="spacer">
</div>
This should be done at set intervals, say once a month or once every two months, and on a set of fresh tapes that is saved forever.</li>
<li class="list-bul" style="margin-top: 1.00em;">
After the level 0 dump, backups of active file systems are taken on each day in a cycle of a week. Once a week, a level 1 dump is taken. The other days of the week a higher level dump is done.<div class="spacer">
</div>
The following cycle needs at most three tapes to restore to a given point in time, but the dumps at the end of the weekly cycle will require more time and space:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
1 2 2 2 2 2 2</pre>
<div class="spacer">
</div>
This sequence requires at most eight tapes to restore, but the size of the individual dumps will be smaller:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
1 2 3 4 5 6 7</pre>
<div class="spacer">
</div>
This sequence seeks a compromise between backup and restore effort:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
1 2 2 3 3 4 4</pre>
<div class="spacer">
</div>
The weekly level 1 dumps should be done on a set of tapes that is used cyclically. For the daily dumps a tape per day of the week can be used.</li>
<li class="list-bul" style="margin-top: 1.00em;">
After several months or so, the daily and weekly tapes should get rotated out of the dump cycle and fresh tapes brought in.</li>
</ul>
</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">TAPE</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The default file to use instead of <i class="file">/dev/rst0</i>. See also <b class="flag">-f</b>, above.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/rst0</i></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
default tape unit to dump to</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/rst*</i></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
raw SCSI tape interface</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/dumpdates</i></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
dump date records</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/fstab</i></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
dump table: file systems and frequency</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/group</i></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
to find group <span class="emph">operator</span></dd>
</dl>
</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> Many, and verbose.<div class="spacer">
</div>
<b class="name">dump</b> exits with zero status on success. Startup errors are indicated with an exit code of 1; abnormal termination is indicated with an exit code of 3.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/chflags.html">chflags(1)</a>, <a class="link-man" href="../html1/stty.html">stty(1)</a>, <a class="link-man" href="../html3/fts.html">fts(3)</a>, <a class="link-man" href="../html3/rcmd.html">rcmd(3)</a>, <a class="link-man" href="../html4/st.html">st(4)</a>, <a class="link-man" href="../html5/fstab.html">fstab(5)</a>, <a class="link-man" href="../html8/restore.html">restore(8)</a>, <a class="link-man" href="../html8/rmt.html">rmt(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> A <b class="name">dump</b> command appeared in Version&#160;5 AT&amp;T UNIX.<div class="spacer">
</div>
The <span class="unix">4.3BSD</span> option syntax is implemented for backward compatibility but is not documented here.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Fewer than 32 read errors on the filesystem are ignored.<div class="spacer">
</div>
Each reel requires a new process, so parent processes for reels already written just hang around until the entire tape is written.<div class="spacer">
</div>
<b class="name">dump</b> with the <b class="flag">-W</b> or <b class="flag">-w</b> flag does not report filesystems that have never been recorded in <i class="file">/etc/dumpdates</i>, even if listed in <i class="file">/etc/fstab</i>.<div class="spacer">
</div>
When dumping a list of files or subdirectories, access privileges are required to scan the directory (as this is done via the <a class="link-man" href="../html3/fts.html">fts(3)</a> routines rather than directly accessing the filesystem).<div class="spacer">
</div>
It would be nice if <b class="name">dump</b> knew about the dump sequence, kept track of the tapes scribbled on, told the operator which tape to mount when, and provided more assistance for the operator running <a class="link-man" href="../html8/restore.html">restore(8)</a>.</div>
</div>
</body>
</html>

