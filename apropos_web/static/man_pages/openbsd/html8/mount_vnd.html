<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
MOUNT_VND(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">mount_vnd</b>, <b class="name">vnconfig</b> &#8212; <span class="desc">configure vnode disks</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 9.00ex;"/>
<col/>
<tbody>
<tr>
<td>
mount_vnd</td>
<td>
[<span class="opt"><b class="flag">-k</b></span>] [<span class="opt"><b class="flag">-K</b>&#160;<i class="arg">rounds</i></span>] [<span class="opt"><b class="flag">-o</b>&#160;<i class="arg">options</i></span>] [<span class="opt"><b class="flag">-S</b>&#160;<i class="arg">saltfile</i></span>] [<span class="opt"><b class="flag">-t</b>&#160;<i class="arg">disktype</i></span>]&#160;<i class="arg">image</i> <i class="arg">vnd_dev</i></td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 9.00ex;"/>
<col/>
<tbody>
<tr>
<td>
vnconfig</td>
<td>
[<span class="opt"><b class="flag">-ckluv</b></span>] [<span class="opt"><b class="flag">-K</b>&#160;<i class="arg">rounds</i></span>] [<span class="opt"><b class="flag">-S</b>&#160;<i class="arg">saltfile</i></span>] [<span class="opt"><b class="flag">-t</b>&#160;<i class="arg">disktype</i></span>]&#160;<i class="arg">vnd_dev</i> <i class="arg">image</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">vnconfig</b> command configures vnode pseudo disk devices. It will associate (or disassociate) the special file <i class="arg">vnd_dev</i> with the regular file <i class="arg">image</i>, allowing the latter to be accessed as though it were a disk.<div class="spacer">
</div>
<b class="name">mount_vnd</b> works similarly to <b class="name">vnconfig</b>, but it provides an interface that can be used by the <a class="link-man" href="../html5/fstab.html">fstab(5)</a> infrastructure, so that an <i class="arg">image</i> file can be configured to a device <i class="arg">node</i> while booting. <b class="name">mount_vnd</b> defaults to the <i class="file">vnd0</i> device.<div class="spacer">
</div>
For <a class="link-man" href="../html5/fstab.html">fstab(5)</a> lines with type &#8220;ffs&#8221;, the &#8220;noauto&#8221; option must be set to prevent a <a class="link-man" href="../html8/mount.html">mount(8)</a> of the FFS partitions before the necessary vnd devices are configured. Also, the &#8220;fs_passno&#8221; field has to be set to 0 to prevent <a class="link-man" href="../html8/fsck.html">fsck(8)</a> from checking the file system for the same reasons.<div class="spacer">
</div>
<b class="name">mount_vnd</b> is invoked by <a class="link-man" href="../html8/mount.html">mount(8)</a> when using the following syntax:<div class="spacer">
</div>
<div style="margin-left: 4.00ex;" class="display">
<b class="name">mount</b> [<span class="opt">options</span>] -t vnd <i class="arg">image</i> <i class="arg">node</i></div>
<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-c</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<b class="name">vnconfig</b> only. Configures the device. If successful, references to <i class="arg">vnd_dev</i> will access the contents of <i class="arg">image</i>. This is the default operation.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-K</b> <i class="arg">rounds</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Associate an encryption key with the device. All data will be encrypted using the Blowfish cipher before it is written to the disk. The user is asked for both a passphrase and the name of a salt file. The salt file can also be specified on the command line using the <b class="flag">-S</b> option. The passphrase and salt are combined according to PKCS #5 PBKDF2 for the specified number of rounds to generate the actual key used. <i class="arg">rounds</i> is a number between 1000 and <span class="define">INT_MAX</span>. DO NOT LOSE THE SALT FILE.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-k</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Associate an encryption key with the device. All data will be encrypted using the Blowfish cipher before it is written to the disk.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-l</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<b class="name">vnconfig</b> only. List the vnd devices and indicate which ones are in use. If a specific <i class="arg">vnd_dev</i> is given, then only that one will be described.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-o</b> <i class="arg">options</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<b class="name">mount_vnd</b> only. Options are specified with a <b class="flag">-o</b> flag followed by a comma separated string of options. See the <a class="link-man" href="../html8/mount.html">mount(8)</a> man page for possible options and their meanings.<div class="spacer">
</div>
At the moment, <b class="flag">-o</b> is only here for compatibility reasons, but no use is made of supplied options.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-S</b> <i class="arg">saltfile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
When <b class="flag">-K</b> is used, specify the <i class="file">saltfile</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-t</b> <i class="arg">disktype</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify a <i class="arg">disktype</i> entry from the <a class="link-man" href="../html5/disktab.html">disktab(5)</a> database. The <i class="arg">vnd_dev</i> will have the sector size, sectors per track, and tracks per cylinder values of the specified <i class="arg">disktype</i>. The defaults are 512-byte sectors, 100 sectors per track and 1 track per cylinder.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-u</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<b class="name">vnconfig</b> only. Unconfigures a <i class="arg">vnd_dev</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-v</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<b class="name">vnconfig</b> only. Print messages to stdout describing actions taken.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/{,r}vnd*</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Configure a CD-ROM or DVD image file as vnode disk vnd0 and mount the ISO 9660 file system contained in it:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# vnconfig vnd0 /tmp/diskimage 
# mount -t cd9660 /dev/vnd0c /mnt</pre>
<div class="spacer">
</div>
Configure an encrypted image file as vnode disk vnd0 and mount the FFS file system contained in the &#8216;a&#8217; partition of the disklabel. The encryption key does not echo and must be entered every time the vnode disk is configured.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# vnconfig -k vnd0 /tmp/cryptimg 
Encryption key: 
# mount /dev/vnd0a /mnt</pre>
<div class="spacer">
</div>
An equivalent <a class="link-man" href="../html5/fstab.html">fstab(5)</a> entry is:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
/tmp/cryptimg /dev/vnd0c vnd rw,noauto,-k       0 0 
/dev/vnd0a   /mnt        ffs rw,noauto          0 0</pre>
<div class="spacer">
</div>
Same as above, but now configure the vnode using PKCS #5 PBKDF2 and a salt file with 20000 rounds:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# vnconfig -K 20000 vnd0 /tmp/cryptimg 
Encryption key: 
Salt file: /tmp/cryptsalt 
# mount /dev/vnd0a /mnt</pre>
<div class="spacer">
</div>
An equivalent <a class="link-man" href="../html5/fstab.html">fstab(5)</a> entry is:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
/tmp/cryptimg /dev/vnd0c vnd rw,noauto,-K=20000 0 0 
/dev/vnd0a   /mnt        ffs rw,noauto          0 0</pre>
<div class="spacer">
</div>
Unmount the file system and unconfigure the vnode device:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# umount /mnt 
# vnconfig -u vnd0</pre>
<div class="spacer">
</div>
A sample of commands to put in <a class="link-man" href="../html8/rc.local.html">rc.local(8)</a> in order to have vnd images configured at boot time is listed here:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# Example for automatically configuring a vnd device on startup 
echo &quot;configuring vnd devices:&quot; 
mount /dev/vnd0c 
fsck -p /dev/rvnd0a 
mount /mnt</pre>
<div class="spacer">
</div>
Mounting images during the first pass of <a class="link-man" href="../html8/fsck.html">fsck(8)</a> and <a class="link-man" href="../html8/mount.html">mount(8)</a> is not possible, because the image to be configured to a vnd itself resides on a file system that first has to be checked and mounted.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/vnd.html">vnd(4)</a>, <a class="link-man" href="../html5/disktab.html">disktab(5)</a>, <a class="link-man" href="../html5/fstab.html">fstab(5)</a>, <a class="link-man" href="../html8/mount.html">mount(8)</a>, <a class="link-man" href="../html8/swapon.html">swapon(8)</a>, <a class="link-man" href="../html8/umount.html">umount(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">mount_vnd</b> command first appeared in <span class="unix">OpenBSD&#160;4.2</span>.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> The &#8216;c&#8217; partition of a vnd image should not be used. When a superblock becomes damaged, <a class="link-man" href="../html8/fsck_ffs.html">fsck_ffs(8)</a> needs information contained in the disklabel to determine the location of alternate superblocks. This information is not available when directly using the &#8216;c&#8217; partition, so checking the file system image will fail.<div class="spacer">
</div>
Swapping to vnd devices is no longer supported.<div class="spacer">
</div>
The encryption used is obsolete. Consider using <a class="link-man" href="../html4/softraid.html">softraid(4)</a> instead.</div>
</div>
</body>
</html>

