<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
SECURITY(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">security</b> &#8212; <span class="desc">periodic system security check</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 8.00ex;"/>
<col/>
<tbody>
<tr>
<td>
/usr/libexec/security</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">security</b> is a command script that examines the system for some signs of security weaknesses. It is only a security aid and does not offer complete protection. <b class="name">security</b> is run by <a class="link-man" href="../html8/daily.html">daily(8)</a>, which mails any output to root on a daily basis.<div class="spacer">
</div>
The <b class="name">security</b> script carries out the following list of simple checks:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
Check the <a class="link-man" href="../html5/master.passwd.html">master.passwd(5)</a> and <a class="link-man" href="../html5/group.html">group(5)</a> files for syntax, empty passwords, partially closed accounts, suspicious UIDs, suspicious GIDs, and duplicate entries.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check root's home directory and login environment for insecure permissions, suspicious paths, and umask commands in the dotfiles.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check for suspicious commands in <i class="file">/etc/mail/aliases</i>.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check for insecurities in <i class="file">/etc/hosts.lpd</i>.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check user <i class="file">.rhosts</i> and <i class="file">.shosts</i> files for open access.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check user home directory permissions.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check many user dotfile permissions.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check user mailbox permissions.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check NFS <a class="link-man" href="../html5/exports.html">exports(5)</a> file for global export entries.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check for changes in setuid/setgid files and devices.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check disk ownership and permissions.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check for changes in the device file list.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check for permission changes in special files and system binaries listed in <i class="file">/etc/mtree/special</i>. <b class="name">security</b> also provides hooks for administrators to create their own lists. These lists should be kept in <i class="file">/etc/mtree/</i> and filenames must have the suffix &#8220;.secure&#8221;. The following example shows how to create such a list, to protect the programs in <i class="file">/bin</i>:<div class="spacer">
</div>
<pre style="margin-left: 4.00ex;" class="lit display">
# mtree -cx -p /bin -K sha256digest,type &gt; /etc/mtree/bin.secure 
# chown root:wheel /etc/mtree/bin.secure 
# chmod 600 /etc/mtree/bin.secure</pre>
<div class="spacer">
</div>
<span class="symb">Note:</span> These checks do not provide complete protection against Trojan horse binaries, as the miscreant can modify the tree specification to match the replaced binary. For details on really protecting yourself against modified binaries, see <a class="link-man" href="../html8/mtree.html">mtree(8)</a>.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check for changes in files listed in <i class="file">/etc/changelist</i>. Files being created or deleted, as well as content change in the files themselves, are reported. See <a class="link-man" href="../html5/changelist.html">changelist(5)</a> for further details.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check for changes to the disklabels of mounted disks.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Report on the installation or removal of any system <a class="link-man" href="../html5/package.html">package(5)</a>.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Check <a class="link-man" href="../html5/hostname.if.html">hostname.if(5)</a> file permissions.</li>
</ul>
<div class="spacer">
</div>
The intent of the <b class="name">security</b> script is to point out some obvious holes to the system administrator.</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1> The following variables can be set in <i class="file">/etc/daily.local</i>:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="env">SUIDSKIP</span></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
A whitespace-separated list of absolute paths to be skipped in setuid/setgid file checks and in device special file checks. Avoid trailing slashes.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/changelist</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/daily</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/mtree</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/backups</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html5/changelist.html">changelist(5)</a>, <a class="link-man" href="../html8/daily.html">daily(8)</a>, <a class="link-man" href="../html8/mtree.html">mtree(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> A <b class="name">security</b> shell script appeared in <span class="unix">4.3BSD-Reno</span>, but most functionality only came with <span class="unix">4.4BSD</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The present manual was written by <span class="author">David Leonard</span> for <span class="unix">OpenBSD&#160;2.9</span>. <span class="author">Andrew Fresh</span> &lt;<a class="link-mail" href="mailto:afresh1@openbsd.org">afresh1@openbsd.org</a>&gt; and <span class="author">Ingo Schwarze</span> &lt;<a class="link-mail" href="mailto:schwarze@openbsd.org">schwarze@openbsd.org</a>&gt; rewrote <b class="name">security</b> from scratch in <a class="link-man" href="../html1/perl.html">perl(1)</a> for <span class="unix">OpenBSD&#160;5.0</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The name of this script may provide a false sense of <b class="name">security</b>.<div class="spacer">
</div>
There are perhaps an infinite number of ways the system can be compromised without this script noticing.</div>
</div>
</body>
</html>

