<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
PFCTL(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">pfctl</b> &#8212; <span class="desc">control the packet filter (PF) device</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 5.00ex;"/>
<col/>
<tbody>
<tr>
<td>
pfctl</td>
<td>
[<span class="opt"><b class="flag">-deghnPqrvz</b></span>] [<span class="opt"><b class="flag">-a</b>&#160;<i class="arg">anchor</i></span>] [<span class="opt"><b class="flag">-D</b>&#160;<i class="arg">macro</i>=<i class="arg">value</i></span>] [<span class="opt"><b class="flag">-F</b>&#160;<i class="arg">modifier</i></span>] [<span class="opt"><b class="flag">-f</b>&#160;<i class="arg">file</i></span>] [<span class="opt"><b class="flag">-i</b>&#160;<i class="arg">interface</i></span>] [<span class="opt"><b class="flag">-K</b>&#160;<i class="arg">host</i>&#160;|&#160;<i class="arg">network</i></span>] [<span class="opt"><b class="flag">-k</b>&#160;<i class="arg">host</i>&#160;|&#160;<i class="arg">network</i>&#160;|&#160;<i class="arg">label</i>&#160;|&#160;<i class="arg">id</i></span>] [<span class="opt"><b class="flag">-L</b>&#160;<i class="arg">statefile</i></span>] [<span class="opt"><b class="flag">-o</b>&#160;<i class="arg">level</i></span>] [<span class="opt"><b class="flag">-p</b>&#160;<i class="arg">device</i></span>] [<span class="opt"><b class="flag">-S</b>&#160;<i class="arg">statefile</i></span>] [<span class="opt"><b class="flag">-s</b>&#160;<i class="arg">modifier</i>&#160;[<span class="opt"><b class="flag">-R</b>&#160;<i class="arg">id</i></span>]</span>] [<span class="opt"><b class="flag">-t</b>&#160;<i class="arg">table</i>&#160;<b class="flag">-T</b>&#160;<i class="arg">command</i>&#160;[<span class="opt"><i class="arg">address&#160;...</i></span>]</span>] [<span class="opt"><b class="flag">-x</b>&#160;<i class="arg">level</i></span>]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">pfctl</b> utility communicates with the packet filter device using the ioctl interface described in <a class="link-man" href="../html4/pf.html">pf(4)</a>. It allows ruleset and parameter configuration, and retrieval of status information from the packet filter. Packet filtering restricts the types of packets that pass through network interfaces entering or leaving the host based on filter rules as described in <a class="link-man" href="../html5/pf.conf.html">pf.conf(5)</a>. The packet filter can also replace addresses and ports of packets.<div class="spacer">
</div>
The packet filter is enabled by default. Should <b class="name">pfctl</b> be unable to load a ruleset, an error occurs and the original ruleset remains in place. If this happens at system startup, the ruleset defined by the <b class="var">RULES</b> variable in <a class="link-man" href="../html8/rc.html">rc(8)</a> remains in place.<div class="spacer">
</div>
The packet filter does not itself forward packets between interfaces. Forwarding can be enabled by setting the <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a> variables <span class="emph">net.inet.ip.forwarding</span> and/or <span class="emph">net.inet6.ip6.forwarding</span> to 1. Set them permanently in <a class="link-man" href="../html5/sysctl.conf.html">sysctl.conf(5)</a>.<div class="spacer">
</div>
At least one option must be specified. The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-a</b> <i class="arg">anchor</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Apply flags <b class="flag">-f</b>, <b class="flag">-F</b>, and <b class="flag">-s</b> only to the rules in the specified <i class="arg">anchor</i>. In addition to the main ruleset, <b class="name">pfctl</b> can load and manipulate additional rulesets by name, called anchors. The main ruleset is the default anchor.<div class="spacer">
</div>
Anchors are referenced by name and may be nested, with the various components of the anchor path separated by &#8216;/&#8217; characters, similar to how file system hierarchies are laid out. The last component of the anchor path is where ruleset operations are performed.<div class="spacer">
</div>
Evaluation of <i class="arg">anchor</i> rules from the main ruleset is described in <a class="link-man" href="../html5/pf.conf.html">pf.conf(5)</a>.<div class="spacer">
</div>
For example, the following will show all filter rules (see the <b class="flag">-s</b> flag below) inside the anchor &#8220;authpf/smith(1234)&#8221;, which would have been created for user &#8220;smith&#8221; by <a class="link-man" href="../html8/authpf.html">authpf(8)</a>, PID 1234:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# pfctl -a &quot;authpf/smith(1234)&quot; -s rules</pre>
<div class="spacer">
</div>
Private tables can also be put inside anchors, either by having table statements in the <a class="link-man" href="../html5/pf.conf.html">pf.conf(5)</a> file that is loaded in the anchor, or by using regular table commands, as in:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# pfctl -a foo/bar -t mytable -T add 1.2.3.4 5.6.7.8</pre>
<div class="spacer">
</div>
When a rule referring to a table is loaded in an anchor, the rule will use the private table if one is defined, and then fall back to the table defined in the main ruleset, if there is one. This is similar to C rules for variable scope. It is possible to create distinct tables with the same name in the global ruleset and in an anchor, but this is often bad design and a warning will be issued in that case.<div class="spacer">
</div>
By default, recursive inline printing of anchors applies only to unnamed anchors specified inline in the ruleset. If the anchor name is terminated with a &#8216;*&#8217; character, the <b class="flag">-s</b> flag will recursively print all anchors in a brace delimited block. For example the following will print the &#8220;authpf&#8221; ruleset recursively:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# pfctl -a 'authpf/*' -sr</pre>
<div class="spacer">
</div>
To print the main ruleset recursively, specify only &#8216;*&#8217; as the anchor name:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# pfctl -a '*' -sr</pre>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-D</b> <i class="arg">macro</i>=<i class="arg">value</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Define <i class="arg">macro</i> to be set to <i class="arg">value</i> on the command line. Overrides the definition of <i class="arg">macro</i> in the ruleset.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable the packet filter.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-e</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable the packet filter.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-F</b> <i class="arg">modifier</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Flush the filter parameters specified by <i class="arg">modifier</i> (may be abbreviated):<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-F</b> <b class="flag">rules</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Flush the filter rules.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-F</b> <b class="flag">states</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Flush the state table (NAT and filter).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-F</b> <b class="flag">Sources</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Flush the source tracking table.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-F</b> <b class="flag">info</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Flush the filter information (statistics that are not bound to rules).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-F</b> <b class="flag">Tables</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Flush the tables.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-F</b> <b class="flag">osfp</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Flush the passive operating system fingerprints.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-F</b> <b class="flag">all</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Flush all of the above.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-f</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Replace the current ruleset with the rules contained in <i class="arg">file</i>. This <i class="arg">file</i> may contain macros, tables, options, and normalization, queueing, translation, and filtering rules. With the exception of macros and tables, the statements must appear in that order.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-g</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Include output helpful for debugging.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-h</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Help.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-i</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Restrict the operation to the given <i class="arg">interface</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-K</b> <i class="arg">host</i> | <i class="arg">network</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Kill all of the source tracking entries originating from the specified <i class="arg">host</i> or <i class="arg">network</i>. A second <b class="flag">-K</b> <i class="arg">host</i> or <b class="flag">-K</b> <i class="arg">network</i> option may be specified, which will kill all the source tracking entries from the first host/network to the second.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-k</b> <i class="arg">host</i> | <i class="arg">network</i> | <i class="arg">label</i> | <i class="arg">id</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Kill all of the state entries matching the specified <i class="arg">host</i>, <i class="arg">network</i>, <i class="arg">label</i>, or <i class="arg">id</i>.<div class="spacer">
</div>
For example, to kill all of the state entries originating from &#8220;host&#8221;:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># pfctl -k host</code></div>
</blockquote>
<div class="spacer">
</div>
A second <b class="flag">-k</b> <i class="arg">host</i> or <b class="flag">-k</b> <i class="arg">network</i> option may be specified, which will kill all the state entries from the first host/network to the second. To kill all of the state entries from &#8220;host1&#8221; to &#8220;host2&#8221;:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># pfctl -k host1 -k host2</code></div>
</blockquote>
<div class="spacer">
</div>
To kill all states originating from 192.168.1.0/24 to 172.16.0.0/16:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># pfctl -k 192.168.1.0/24 -k 172.16.0.0/16</code></div>
</blockquote>
<div class="spacer">
</div>
A network prefix length of 0 can be used as a wildcard. To kill all states with the target &#8220;host2&#8221;:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># pfctl -k 0.0.0.0/0 -k host2</code></div>
</blockquote>
<div class="spacer">
</div>
It is also possible to kill states by rule label or state ID. In this mode the first <b class="flag">-k</b> argument is used to specify the type of the second argument. The following command would kill all states that have been created from rules carrying the label &#8220;foobar&#8221;:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># pfctl -k label -k foobar</code></div>
</blockquote>
<div class="spacer">
</div>
To kill one specific state by its unique state ID (as shown by pfctl -s state -vv), use the <i class="arg">id</i> modifier and as a second argument the state ID and optional creator ID. To kill a state with ID 4823e84500000003 use:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># pfctl -k id -k 4823e84500000003</code></div>
</blockquote>
<div class="spacer">
</div>
To kill a state with ID 4823e84500000018 created from a backup firewall with hostid 00000002 use:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># pfctl -k id -k 4823e84500000018/2</code></div>
</blockquote>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-L</b> <i class="arg">statefile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Load pf states from the file specified by <i class="arg">statefile</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-n</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Do not actually load rules, just parse them.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-o</b> <i class="arg">level</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Control the ruleset optimizer, overriding any rule file settings.<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-o</b> <b class="flag">none</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Disable the ruleset optimizer.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-o</b> <b class="flag">basic</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Enable basic ruleset optimizations. This is the default behaviour.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-o</b> <b class="flag">profile</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Enable basic ruleset optimizations with profiling.</dd>
</dl>
For further information on the ruleset optimizer, see <a class="link-man" href="../html5/pf.conf.html">pf.conf(5)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-P</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print ports using their names in <i class="file">/etc/services</i> if available.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-p</b> <i class="arg">device</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the device file <i class="arg">device</i> instead of the default <i class="file">/dev/pf</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-q</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Only print errors and warnings.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-r</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Perform reverse DNS lookups on states when displaying them.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-S</b> <i class="arg">statefile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Store the pf state table in the file specified by <i class="arg">statefile</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-s</b> <i class="arg">modifier</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Show the filter parameters specified by <i class="arg">modifier</i> (may be abbreviated):<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">queue</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show the currently loaded queue definitions. When used together with <b class="flag">-v</b>, per-queue statistics are also shown. When used together with <b class="flag">-v</b> <b class="flag">-v</b>, <b class="name">pfctl</b> will loop and show updated queue statistics every five seconds, including measured bandwidth and packets per second.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">rules</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show the currently loaded filter rules. If <b class="flag">-R</b> <i class="arg">id</i> is specified as well, only the rule with the specified numeric ID is shown. When used together with <b class="flag">-v</b>, the per-rule statistics (number of evaluations, packets and bytes) are also shown. Note that the &#8220;skip step&#8221; optimization done automatically by the kernel will skip evaluation of rules where possible. Packets passed statefully are counted in the rule that created the state (even though the rule isn't evaluated more than once for the entire connection).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">Anchors</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show the currently loaded anchors directly attached to the main ruleset. If <b class="flag">-a</b> <i class="arg">anchor</i> is specified as well, the anchors loaded directly below the given <i class="arg">anchor</i> are shown instead. If <b class="flag">-v</b> is specified, all anchors attached under the target anchor will be displayed recursively.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">states</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show the contents of the state table. If <b class="flag">-R</b> <i class="arg">id</i> is specified as well, only states created by the rule with the specified numeric ID are shown.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">Sources</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show the contents of the source tracking table.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">info</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show filter information (statistics and counters). When used together with <b class="flag">-v</b>, source tracking statistics are also shown.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">labels</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show per-rule statistics (label, evaluations, packets total, bytes total, packets in, bytes in, packets out, bytes out, state creations) of filter rules with labels, useful for accounting. If <b class="flag">-R</b> <i class="arg">id</i> is specified as well, only the statistics for the rule with the specified numeric ID are shown.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">timeouts</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show the current global timeouts.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">memory</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show the current pool memory hard limits.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">Tables</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show the list of tables.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">osfp</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show the list of operating system fingerprints.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">Interfaces</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show the list of interfaces and interface drivers available to PF. When used together with <b class="flag">-v</b>, it additionally lists which interfaces have skip rules activated. When used together with <b class="flag">-vv</b>, interface statistics are also shown. <b class="flag">-i</b> can be used to select an interface or a group of interfaces.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-s</b> <b class="flag">all</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Show all of the above, except for the lists of interfaces and operating system fingerprints.</dd>
</dl>
<div class="spacer">
</div>
Counters shown with <b class="flag">-s</b> <b class="flag">info</b> are:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
match</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
explicit rule match</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
bad-offset</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
currently unused</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
fragment</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
invalid fragments dropped</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
short</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
short packets dropped</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
normalize</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
dropped by normalizer: illegal packets</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
memory</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
memory could not be allocated</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
bad-timestamp</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
bad TCP timestamp; RFC 1323</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
congestion</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
network interface queue congested</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
ip-option</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
bad IP/IPv6 options</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
proto-cksum</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
invalid protocol checksum</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
state-mismatch</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
packet was associated with a state entry, but sequence numbers did not match</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
state-insert</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
state insertion failure</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
state-limit</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
configured state limit was reached</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
src-limit</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
source node/connection limit</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
synproxy</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
dropped by synproxy</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
translate</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
no free ports in translation port range</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-T</b> <i class="arg">command</i> [<span class="opt"><i class="arg">address ...</i></span>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the <i class="arg">command</i> (may be abbreviated) to apply to the table. Commands include:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-T</b> <b class="flag">kill</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Kill a table.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-T</b> <b class="flag">flush</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Flush all addresses of a table.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-T</b> <b class="flag">add</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Add one or more addresses in a table. Automatically create a nonexisting table.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-T</b> <b class="flag">delete</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Delete one or more addresses from a table.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-T</b> <b class="flag">expire</b> <i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Delete addresses which had their statistics cleared more than <i class="arg">number</i> seconds ago. For entries which have never had their statistics cleared, <i class="arg">number</i> refers to the time they were added to the table.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-T</b> <b class="flag">replace</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Replace the addresses of the table. Automatically create a nonexisting table.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-T</b> <b class="flag">show</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Show the content (addresses) of a table.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-T</b> <b class="flag">test</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Test if the given addresses match a table.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">-T</b> <b class="flag">zero</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Clear all the statistics of a table.</dd>
</dl>
<div class="spacer">
</div>
For the <b class="flag">add</b>, <b class="flag">delete</b>, <b class="flag">replace</b>, and <b class="flag">test</b> commands, the list of addresses can be specified either directly on the command line and/or in an unformatted text file, using the <b class="flag">-f</b> flag. Comments starting with a &#8216;#&#8217; are allowed in the text file. With these commands, the <b class="flag">-v</b> flag can also be used once or twice, in which case <b class="name">pfctl</b> will print the detailed result of the operation for each individual address, prefixed by one of the following letters:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
A</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
The address/network has been added.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
C</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
The address/network has been changed (negated).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
D</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
The address/network has been deleted.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
M</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
The address matches (<b class="flag">test</b> operation only).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
X</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
The address/network is duplicated and therefore ignored.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
Y</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
The address/network cannot be added/deleted due to conflicting &#8216;!&#8217; attributes.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
Z</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
The address/network has been cleared (statistics).</dd>
</dl>
<div class="spacer">
</div>
Each table can maintain a set of counters that can be retrieved using the <b class="flag">-v</b> flag of <b class="name">pfctl</b>. For example, the following commands define a wide open firewall which will keep track of packets going to or coming from the <span class="unix">OpenBSD</span> FTP server. The following commands configure the firewall and send 10 pings to the FTP server:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# printf &quot;table &lt;test&gt; counters { ftp.openbsd.org }\n \ 
    pass out to &lt;test&gt;\n&quot; | pfctl -f- 
# ping -qc10 ftp.openbsd.org</pre>
<div class="spacer">
</div>
We can now use the table <b class="flag">show</b> command to output, for each address and packet direction, the number of packets and bytes that are being passed, matched or blocked by rules referencing the table. Note that the match counters are incremented for every match rule in which they are referenced, meaning that a single packet may be counted multiple times. The time at which the current accounting started is also shown with the &#8220;Cleared&#8221; line.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# pfctl -t test -vTshow 
   198.51.100.81 
        Cleared:        Fri Jun 28 11:17:37 2013 
        In/Block:       [ Packets: 0	Bytes: 0	] 
        In/Match        [ Packets: 54	Bytes: 10028	] 
        In/Pass:        [ Packets: 5	Bytes: 1949	] 
        Out/Block:      [ Packets: 0	Bytes: 0	] 
        Out/Match       [ Packets: 65	Bytes: 12684	] 
        Out/Pass:       [ Packets: 6	Bytes: 389	]</pre>
<div class="spacer">
</div>
Similarly, it is possible to view global information about the tables by using the <b class="flag">-v</b> modifier twice and the <b class="flag">-s</b> <b class="flag">Tables</b> command. This will display the number of addresses on each table, the number of rules which reference the table, and the global packet statistics for the whole table:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# pfctl -vvsTables 
--a-r-C test 
        Addresses:   1 
        Cleared:     Fri Jun 28 11:17:37 2013 
        References:  [ Anchors: 0	Rules: 4	] 
        Evaluations: [ NoMatch: 35	Match: 8	] 
        In/Block:    [ Packets: 0	Bytes: 0	] 
        In/Match:    [ Packets: 54	Bytes: 10028	] 
        In/Pass:     [ Packets: 5	Bytes: 1949	] 
        In/XPass:    [ Packets: 0	Bytes: 0	] 
        Out/Block:   [ Packets: 0	Bytes: 0	] 
        Out/Match:   [ Packets: 65	Bytes: 12684	] 
        Out/Pass:    [ Packets: 6	Bytes: 389	] 
        Out/XPass:   [ Packets: 0	Bytes: 0	]</pre>
<div class="spacer">
</div>
Only packets creating state are matched in the Evaluations line, but all packets passing as a result of the state are correctly accounted for. Reloading the table(s) or ruleset will not affect packet accounting in any way. The two &#8220;XPass&#8221; counters are incremented instead of the &#8220;Pass&#8221; counters when a &#8220;stateful&#8221; packet is passed but doesn't match the table anymore. This will happen in our example if someone flushes the table while the <a class="link-man" href="../html8/ping.html">ping(8)</a> command is running.<div class="spacer">
</div>
When used with a single <b class="flag">-v</b>, <b class="name">pfctl</b> will only display the first line containing the table flags and name. The flags are defined as follows:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
c</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
For constant tables, which cannot be altered outside <a class="link-man" href="../html5/pf.conf.html">pf.conf(5)</a>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
p</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
For persistent tables, which don't get automatically killed when no rules refer to them.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
a</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
For tables which are part of the <span class="emph">active</span> tableset. Tables without this flag do not really exist, cannot contain addresses, and are only listed if the <b class="flag">-g</b> flag is given.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
i</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
For tables which are part of the <span class="emph">inactive</span> tableset. This flag can only be witnessed briefly during the loading of <a class="link-man" href="../html5/pf.conf.html">pf.conf(5)</a>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
r</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
For tables which are referenced (used) by rules.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
h</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
This flag is set when a table in the main ruleset is hidden by one or more tables of the same name from anchors attached below it.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
C</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
This flag is set when per-address counters are enabled on the table.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-t</b> <i class="arg">table</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the name of the table.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-v</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Produce more verbose output. A second use of <b class="flag">-v</b> will produce even more verbose output including ruleset warnings. See the previous section for its effect on table commands.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-x</b> <i class="arg">level</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the debug <i class="arg">level</i>, which limits the severity of log messages printed by <a class="link-man" href="../html4/pf.html">pf(4)</a>. This should be a keyword from the following ordered list (highest to lowest): <b class="flag">emerg</b>, <b class="flag">alert</b>, <b class="flag">crit</b>, <b class="flag">err</b>, <b class="flag">warning</b>, <b class="flag">notice</b>, <b class="flag">info</b>, and <b class="flag">debug</b>. These keywords correspond to the similar (LOG_) values specified to the <a class="link-man" href="../html3/syslog.html">syslog(3)</a> library routine, and may be abbreviated on the command line.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-z</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Clear per-rule statistics.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/pf.conf</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Packet filter rules file.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/pf.os</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Passive operating system fingerprint database.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/pf.html">pf(4)</a>, <a class="link-man" href="../html5/pf.conf.html">pf.conf(5)</a>, <a class="link-man" href="../html5/pf.os.html">pf.os(5)</a>, <a class="link-man" href="../html5/sysctl.conf.html">sysctl.conf(5)</a>, <a class="link-man" href="../html8/authpf.html">authpf(8)</a>, <a class="link-man" href="../html8/ftp-proxy.html">ftp-proxy(8)</a>, <a class="link-man" href="../html8/rc.html">rc(8)</a>, <a class="link-man" href="../html8/rc.conf.html">rc.conf(8)</a>, <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">pfctl</b> program and the <a class="link-man" href="../html4/pf.html">pf(4)</a> filter mechanism first appeared in <span class="unix">OpenBSD&#160;3.0</span>.</div>
</div>
</body>
</html>

