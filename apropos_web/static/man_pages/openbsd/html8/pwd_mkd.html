<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
PWD_MKDB(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">pwd_mkdb</b> &#8212; <span class="desc">generate the password databases</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 8.00ex;"/>
<col/>
<tbody>
<tr>
<td>
pwd_mkdb</td>
<td>
[<span class="opt"><b class="flag">-c</b></span>] [<span class="opt"><b class="flag">-p</b> | <b class="flag">-s</b></span>] [<span class="opt"><b class="flag">-d</b> <i class="arg">directory</i></span>] [<span class="opt"><b class="flag">-u</b> <i class="arg">username</i></span>] <i class="arg">file</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">pwd_mkdb</b> creates a pair of Berkeley databases for the specified file. These databases are then installed into <i class="file">/etc/spwd.db</i> and <i class="file">/etc/pwd.db</i>, respectively. The <i class="arg">file</i> argument is installed into <i class="file">/etc/master.passwd</i> by renaming <i class="arg">file</i>. The <i class="arg">file</i> must be in the correct format (see <a class="link-man" href="../html5/passwd.html">passwd(5)</a>). It is important to note that the format used in this system is different from the historic 6th Edition-style format.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-c</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Check if the password file is in the correct format. Do not change, add, or remove any files.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Operate in a base directory other than the default of <i class="file">/etc</i>. All absolute paths (including <i class="arg">file</i>) will be made relative to <i class="arg">directory</i>. Any directories specified as a part of <i class="arg">file</i> will be stripped off. This option is used to create password databases in directories other than <i class="file">/etc</i>; for instance in a <a class="link-man" href="../html8/chroot.html">chroot(8)</a> jail.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-p</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Create a 6th Edition-style password file and install it into <i class="file">/etc/passwd</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-s</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Only update the secure version of the database. This is most commonly used in conjunction with the <b class="flag">-u</b> flag during a password change. Because the insecure database doesn't contain the password there is no reason to update it if the only change is in the password field. Cannot be used in conjunction with the <b class="flag">-p</b> flag.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-u</b> <i class="arg">username</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Only update the record for the specified user. Utilities that operate on a single user can use this option to avoid the overhead of rebuilding the entire database. This option must never be used if the line number of the user's record in <i class="file">/etc/master.passwd</i> has changed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The absolute path to a file in <i class="arg">master.passwd</i> format, as described in <a class="link-man" href="../html5/passwd.html">passwd(5)</a>.</dd>
</dl>
<div class="spacer">
</div>
The two databases differ in that the secure version contains the user's encrypted password and the insecure version has an asterisk (&#8216;*&#8217;).<div class="spacer">
</div>
The databases are used by the C library password routines (see <a class="link-man" href="../html3/getpwent.html">getpwent(3)</a>).<div class="spacer">
</div>
<b class="name">pwd_mkdb</b> exits zero on success, non-zero on failure.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/master.passwd</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
current password file</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/passwd</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
a 6th Edition-style password file</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/pwd.db</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
insecure password database file</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/pwd.db.tmp</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
temporary file</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/spwd.db</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
secure password database file</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/spwd.db.tmp</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
temporary file</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/chpass.html">chpass(1)</a>, <a class="link-man" href="../html1/passwd.html">passwd(1)</a>, <a class="link-man" href="../html3/dbopen.html">dbopen(3)</a>, <a class="link-man" href="../html3/getpwent.html">getpwent(3)</a>, <a class="link-man" href="../html5/passwd.html">passwd(5)</a>, <a class="link-man" href="../html8/vipw.html">vipw(8)</a></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Because of the necessity for atomic update of the password files, <b class="name">pwd_mkdb</b> uses <a class="link-man" href="../html2/rename.html">rename(2)</a> to install them. This, however, requires that the file specified on the command line live on the same file system as the <i class="file">/etc</i> directory.<div class="spacer">
</div>
There are the obvious races with multiple people running <b class="name">pwd_mkdb</b> on different password files at the same time. The front-ends to <b class="name">pwd_mkdb</b>, <a class="link-man" href="../html1/chpass.html">chpass(1)</a>, <a class="link-man" href="../html1/passwd.html">passwd(1)</a>, and <a class="link-man" href="../html8/vipw.html">vipw(8)</a> handle the locking necessary to avoid this problem.</div>
</div>
</body>
</html>

