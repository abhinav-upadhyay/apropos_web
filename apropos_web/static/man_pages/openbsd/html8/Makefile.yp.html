<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
MAKEFILE.YP(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">Makefile.yp</b> &#8212; <span class="desc">generate and distribute YP maps</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <code class="lit">cd /var/yp; make</code></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">Makefile.yp</b> utility generates or updates the YP maps to be served by <a class="link-man" href="../html8/ypserv.html">ypserv(8)</a>.<div class="spacer">
</div>
Each YP domain to be served must have its own subdirectory below <i class="file">/var/yp</i>. Use <a class="link-man" href="../html8/ypinit.html">ypinit(8)</a> to set up such subdirectories. In particular, <a class="link-man" href="../html8/ypinit.html">ypinit(8)</a> will copy <i class="file">/var/yp/Makefile.yp</i> into each new domain subdirectory. For common configuration changes affecting all future domains, edit <i class="file">/var/yp/Makefile.yp</i> before running <a class="link-man" href="../html8/ypinit.html">ypinit(8)</a>. For configuration changes affecting only one individual domain, edit the <i class="file">Makefile</i> in the respective domain subdirectory after running <a class="link-man" href="../html8/ypinit.html">ypinit(8)</a>. Do <span class="emph">not</span> edit <i class="file">/var/yp/Makefile.yp.dist</i>.<div class="spacer">
</div>
By default, input data for generating YP maps is collected from the <i class="file">/etc</i> directory. Edit the <span class="define">DIR</span> variable to choose a different source directory.<div class="spacer">
</div>
To regenerate all maps for all domains, run <a class="link-man" href="../html1/make.html">make(1)</a> in <i class="file">/var/yp</i>. To regenerate all maps for one single domain, run <a class="link-man" href="../html1/make.html">make(1)</a> in the respective domain subdirectory. The <a class="link-man" href="../html8/makedbm.html">makedbm(8)</a> utility will be used to create the maps in Berkeley DB format, and they will be stored inside the appropriate domain subdirectory.<div class="spacer">
</div>
Whenever a YP map has been updated, it is automatically distributed to all slave servers in the respective domain using the <a class="link-man" href="../html8/yppush.html">yppush(8)</a> utility. To disable automatic distribution, set the <span class="define">NOPUSH</span> variable to an arbitrary, non-empty, value.</div>
<div class="section">
<h1 id="x5354414e44415244205950204d415053">STANDARD YP MAPS</h1> By default, <b class="name">Makefile.yp</b> provides the following <a class="link-man" href="../html1/make.html">make(1)</a> targets:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">passwd</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates the <i class="file">passwd.byname</i>, <i class="file">passwd.byuid</i>, <i class="file">master.passwd.byname</i>, and <i class="file">master.passwd.byuid</i> maps from <a class="link-man" href="../html5/master.passwd.html">master.passwd(5)</a> for use by <a class="link-man" href="../html3/getpwent.html">getpwent(3)</a>.<div class="spacer">
</div>
The <i class="file">master.passwd.*</i> maps always contain complete records in <a class="link-man" href="../html5/master.passwd.html">master.passwd(5)</a> format, including the encrypted passwords.<div class="spacer">
</div>
The <i class="file">passwd.*</i> maps follow the reduced <a class="link-man" href="../html5/passwd.html">passwd(5)</a> format having the class, change, and expire fields removed but by default the encrypted passwords are included too. If the <span class="define">UNSECURE</span> variable is changed to be empty, the encrypted passwords are replaced by asterisks (&#8216;<code class="lit">*</code>&#8217;). This &#8220;secure&#8221; mode is compatible with <span class="unix">OpenBSD</span> and <span class="unix">FreeBSD</span> clients.<div class="spacer">
</div>
The <span class="define">MINUID</span> and <span class="define">MAXUID</span> variables restrict the range of user IDs included into the four passwd maps. By default, system users are not included.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">netgroup</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates the <i class="file">netgroup</i>, <i class="file">netgroup.byuser</i>, and <i class="file">netgroup.byhost</i> maps from <a class="link-man" href="../html5/netgroup.html">netgroup(5)</a> for use by <a class="link-man" href="../html3/getnetgrent.html">getnetgrent(3)</a> and <a class="link-man" href="../html5/passwd.html">passwd(5)</a>. Requires the <a class="link-man" href="../html8/revnetgroup.html">revnetgroup(8)</a> utility.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">group</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates the <i class="file">group.byname</i> and <i class="file">group.bygid</i> maps from <a class="link-man" href="../html5/group.html">group(5)</a> for use by <a class="link-man" href="../html3/getgrent.html">getgrent(3)</a>.<div class="spacer">
</div>
The <span class="define">MINGID</span> and <span class="define">MAXGID</span> variables restrict the range of group IDs included into both group maps. By default, system groups are not included.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">netid</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates the <i class="file">netid.byname</i> map from <a class="link-man" href="../html5/netid.html">netid(5)</a>, <a class="link-man" href="../html5/passwd.html">passwd(5)</a>, <a class="link-man" href="../html5/group.html">group(5)</a>, and <a class="link-man" href="../html5/hosts.html">hosts(5)</a> for use by <a class="link-man" href="../html3/getgrouplist.html">getgrouplist(3)</a>. Falls back to <a class="link-man" href="../html5/master.passwd.html">master.passwd(5)</a> in case <a class="link-man" href="../html5/passwd.html">passwd(5)</a> is not available. Requires the <a class="link-man" href="../html8/mknetid.html">mknetid(8)</a> utility.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">hosts</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates the <i class="file">hosts.byname</i> and <i class="file">hosts.byaddr</i> maps from <a class="link-man" href="../html5/hosts.html">hosts(5)</a> for use by <a class="link-man" href="../html3/gethostbyname.html">gethostbyname(3)</a>.<div class="spacer">
</div>
To get <a class="link-man" href="../html8/ypserv.html">ypserv(8)</a> to ask DNS for unknown hosts, set the <span class="define">USEDNS</span> variable to <b class="flag">-b</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">ethers</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates the <i class="file">ethers.byaddr</i> and <i class="file">ethers.byname</i> maps from <a class="link-man" href="../html5/ethers.html">ethers(5)</a> for use by <a class="link-man" href="../html3/ethers.html">ethers(3)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">networks</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates the <i class="file">networks.byname</i> and <i class="file">networks.byaddr</i> maps from <a class="link-man" href="../html5/networks.html">networks(5)</a> for use by <a class="link-man" href="../html3/getnetent.html">getnetent(3)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">rpc</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates the <i class="file">rpc.bynumber</i> map from <a class="link-man" href="../html5/rpc.html">rpc(5)</a> for use by <a class="link-man" href="../html3/getrpcent.html">getrpcent(3)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">services</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates the <i class="file">services.byname</i> map from <a class="link-man" href="../html5/services.html">services(5)</a> for use by <a class="link-man" href="../html3/getservent.html">getservent(3)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">protocols</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates the <i class="file">protocols.byname</i> and <i class="file">protocols.bynumber</i> maps from <a class="link-man" href="../html5/protocols.html">protocols(5)</a> for use by <a class="link-man" href="../html3/getprotoent.html">getprotoent(3)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">aliases</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates the <i class="file">mail.aliases</i> and <i class="file">mail.byaddr</i> maps from <a class="link-man" href="../html5/aliases.html">aliases(5)</a>. This target uses both <a class="link-man" href="../html8/sendmail.html">sendmail(8)</a> with the option <b class="flag">-bi</b> and the <a class="link-man" href="../html8/mkalias.html">mkalias(8)</a> utility.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">amd.home</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates the <i class="file">amd.home</i> map from the file <i class="file">/etc/amd/amd.home</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">all</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Generates all of the above, and sends a hangup signal to <a class="link-man" href="../html8/ypserv.html">ypserv(8)</a> such that it uses the new maps.</dd>
</dl>
<div class="spacer">
</div>
In order to keep additional custom YP maps up to date, the <i class="file">Makefile</i> should be extended to support additional targets.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
/var/yp/Makefile</dt>
<dd class="list-tag" style="margin-left: 31.00ex;">
Top level YP Makefile.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
/var/yp/<i class="arg">domainname</i>/Makefile</dt>
<dd class="list-tag" style="margin-left: 31.00ex;">
Per domain YP maps Makefile.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
/var/yp/<i class="arg">domainname</i>/ypservers.db</dt>
<dd class="list-tag" style="margin-left: 31.00ex;">
Database of hosts serving this domain.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
/var/yp/<i class="arg">domainname/mapname</i>.db</dt>
<dd class="list-tag" style="margin-left: 31.00ex;">
Database files containing the YP maps.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
/var/yp/<i class="arg">domainname/target</i>.time</dt>
<dd class="list-tag" style="margin-left: 31.00ex;">
Cookies controlling the operation of <a class="link-man" href="../html1/make.html">make(1)</a>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/make.html">make(1)</a>, <a class="link-man" href="../html3/dbopen.html">dbopen(3)</a>, <a class="link-man" href="../html8/makedbm.html">makedbm(8)</a>, <a class="link-man" href="../html8/yp.html">yp(8)</a>, <a class="link-man" href="../html8/ypinit.html">ypinit(8)</a>, <a class="link-man" href="../html8/yppush.html">yppush(8)</a>, <a class="link-man" href="../html8/ypserv.html">ypserv(8)</a></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> When <span class="define">NOPUSH</span> is set and individual maps are regenerated (as opposed to <b class="cmd">all</b>), the hangup signal to <a class="link-man" href="../html8/ypserv.html">ypserv(8)</a> must be sent manually, or the new maps won't be used.<div class="spacer">
</div>
When <span class="define">NOPUSH</span> is unset, maps are pushed to the master server on the local host too, slowing down <b class="name">Makefile.yp</b>.</div>
</div>
</body>
</html>

