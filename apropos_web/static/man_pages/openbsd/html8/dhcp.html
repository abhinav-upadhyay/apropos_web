<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
DHCPD(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">dhcpd</b> &#8212; <span class="desc">Dynamic Host Configuration Protocol (DHCP) server</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 5.00ex;"/>
<col/>
<tbody>
<tr>
<td>
dhcpd</td>
<td>
[<span class="opt"><b class="flag">-dfn</b></span>] [<span class="opt"><b class="flag">-A</b>&#160;<i class="arg">abandoned_ip_table</i></span>] [<span class="opt"><b class="flag">-C</b>&#160;<i class="arg">changed_ip_table</i></span>] [<span class="opt"><b class="flag">-c</b>&#160;<i class="arg">config-file</i></span>] [<span class="opt"><b class="flag">-L</b>&#160;<i class="arg">leased_ip_table</i></span>] [<span class="opt"><b class="flag">-l</b>&#160;<i class="arg">lease-file</i></span>] [<span class="opt"><b class="flag">-u</b>[<span class="opt"><i class="arg">bind_address</i></span>]</span>] [<span class="opt"><b class="flag">-Y</b>&#160;<i class="arg">synctarget</i></span>] [<span class="opt"><b class="flag">-y</b>&#160;<i class="arg">synclisten</i></span>] [<span class="opt"><i class="arg">if0</i>&#160;[<span class="opt"><i class="arg">...&#160;ifN</i></span>]</span>]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The Internet Software Consortium DHCP Server, <b class="name">dhcpd</b>, implements the Dynamic Host Configuration Protocol (DHCP) and the Internet Bootstrap Protocol (BOOTP). DHCP allows hosts on a TCP/IP network to request and be assigned IP addresses, and also to discover information about the network to which they are attached. BOOTP provides similar functionality, with certain restrictions.<div class="spacer">
</div>
The DHCP protocol allows a host which is unknown to the network administrator to be automatically assigned a new IP address out of a pool of IP addresses for its network. In order for this to work, the network administrator allocates address pools in each subnet and enters them into the <a class="link-man" href="../html5/dhcpd.conf.html">dhcpd.conf(5)</a> file.<div class="spacer">
</div>
On startup, <b class="name">dhcpd</b> reads the <i class="file">dhcpd.conf</i> file and stores a list of available addresses on each subnet in memory. When a client requests an address using the DHCP protocol, <b class="name">dhcpd</b> allocates an address for it. Each client is assigned a lease, which expires after an amount of time chosen by the administrator (by default, one day). When a leased IP address is assigned to a new hardware address, <b class="name">dhcpd</b> may delete the leased IP from certain <a class="link-man" href="../html4/pf.html">pf(4)</a> tables. Before leases expire, the clients to which leases are assigned are expected to renew them in order to continue to use the addresses. Once a lease has expired, the client to which that lease was assigned is no longer permitted to use the leased IP address.<div class="spacer">
</div>
In order to keep track of leases across system reboots and server restarts, <b class="name">dhcpd</b> keeps a list of leases it has assigned in the <a class="link-man" href="../html5/dhcpd.leases.html">dhcpd.leases(5)</a> file. Before <b class="name">dhcpd</b> grants a lease to a host, it records the lease in this file and makes sure that the contents of the file are flushed to disk. This ensures that even in the event of a system crash, <b class="name">dhcpd</b> will not forget about a lease that it has assigned. On startup, after reading the <i class="file">dhcpd.conf</i> file, <b class="name">dhcpd</b> reads the <i class="file">dhcpd.leases</i> file to refresh its memory about what leases have been assigned.<div class="spacer">
</div>
BOOTP support is also provided by this server. Unlike DHCP, the BOOTP protocol does not provide a protocol for recovering dynamically-assigned addresses once they are no longer needed. It is still possible to dynamically assign addresses to BOOTP clients, but some administrative process for reclaiming addresses is required. By default, leases are granted to BOOTP clients in perpetuity, although the network administrator may set an earlier cutoff date or a shorter lease length for BOOTP leases if that makes sense.<div class="spacer">
</div>
BOOTP clients may also be served in the old standard way, which is simply to provide a declaration in the <i class="file">dhcpd.conf</i> file for each BOOTP client, permanently assigning an address to each client.<div class="spacer">
</div>
Whenever changes are made to the <i class="file">dhcpd.conf</i> file, <b class="name">dhcpd</b> must be restarted. Because the DHCP server database is not as lightweight as a BOOTP database, <b class="name">dhcpd</b> does not automatically restart itself when it sees a change to the <i class="file">dhcpd.conf</i> file.<div class="spacer">
</div>
DHCP traffic always bypasses IPsec. Otherwise there could be situations when a server has an IPsec SA for the client and sends replies over that, which a newly booted client would not be able to grasp.</div>
<div class="section">
<h1 id="x434f4d4d414e44204c494e45">COMMAND LINE</h1> The names of the network interfaces on which <b class="name">dhcpd</b> should listen for broadcasts may be specified on the command line. This should be done on systems where <b class="name">dhcpd</b> is unable to identify non-broadcast interfaces, but should not be required on other systems. If no interface names are specified on the command line, and the <b class="flag">-u</b> option is not given, <b class="name">dhcpd</b> will identify all network interfaces which are up, eliminating non-broadcast interfaces if possible, and listen for DHCP broadcasts on each interface.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-A</b> <i class="arg">abandoned_ip_table</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
When an address is abandoned for some reason, add it to the <a class="link-man" href="../html4/pf.html">pf(4)</a> table named <i class="arg">abandoned_ip_table</i>. This can be used to defend against machines &quot;camping&quot; on an address without obtaining a lease. When an address is properly leased, <b class="name">dhcpd</b> will remove the address from this table.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-C</b> <i class="arg">changed_ip_table</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
When an address is leased to a different hardware address, delete it from the <a class="link-man" href="../html4/pf.html">pf(4)</a> table named <i class="arg">changed_ip_table</i>. This feature complements the overload table in a stateful <a class="link-man" href="../html4/pf.html">pf(4)</a> rule. If a host appears to be misbehaving, it can be quarantined by using the overload feature. When the address is leased to a different machine, <b class="name">dhcpd</b> can remove the address from the overload table, thus allowing a well-behaved machine to reuse the address.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-c</b> <i class="arg">config-file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use an alternate configuration file, <i class="arg">config-file</i>. Because of the importance of using the same lease database at all times when running <b class="name">dhcpd</b> in production, this option should be used <span class="emph">only</span> for testing database files in a non-production environment.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Force <b class="name">dhcpd</b> to log to <i class="arg">stderr</i>. This can be useful for debugging, and also at sites where a complete log of all dhcp activity must be kept, but <a class="link-man" href="../html8/syslogd.html">syslogd(8)</a> is not reliable or otherwise cannot be used. Normally, <b class="name">dhcpd</b> will log all output using the <a class="link-man" href="../html3/syslog.html">syslog(3)</a> function with the log facility set to <span class="define">LOG_DAEMON</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-f</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Run <b class="name">dhcpd</b> as a foreground process, rather than allowing it to run as a daemon in the background. This is useful when running <b class="name">dhcpd</b> under a debugger, or when running it out of inittab on System V systems.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-L</b> <i class="arg">leased_ip_table</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
When an address is leased <b class="name">dhcpd</b> will insert it into the <a class="link-man" href="../html4/pf.html">pf(4)</a> table named <i class="arg">leased_ip_table</i>. Addresses are removed from the table when the lease expires. Combined with the table of abandoned addresses, this can help enforce a requirement to use DHCP on a network, or can place DHCP users in a different class of service. Users are cautioned against placing much trust in Ethernet or IP addresses; <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a> can be used to trivially change the interface's address, and on a busy DHCP network, IP addresses will likely be quickly recycled.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-l</b> <i class="arg">lease-file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use an alternate lease file, <i class="arg">lease-file</i>. Because of the importance of using the same lease database at all times when running <b class="name">dhcpd</b> in production, this option should be used <span class="emph">only</span> for testing lease files in a non-production environment.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-n</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Only test configuration, do not run <b class="name">dhcpd</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-u</b>[<span class="opt"><i class="arg">bind_address</i></span>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use a UDP socket instead of BPF for receiving and sending packets. Only <span class="define">DHCPINFORM</span> messages can be handled on this socket; other messages are discarded. With this option, <b class="name">dhcpd</b> can answer <span class="define">DHCPINFORM</span> from clients on non Ethernet interfaces such as <a class="link-man" href="../html4/tun.html">tun(4)</a> or <a class="link-man" href="../html4/pppx.html">pppx(4)</a>. If <i class="arg">bind_address</i> is specified, <b class="name">dhcpd</b> will bind to that address; otherwise the limited broadcast address (255.255.255.255) is used as the default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-Y</b> <i class="arg">synctarget</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Add target <i class="arg">synctarget</i> to receive synchronisation messages. <i class="arg">synctarget</i> can be either an IPv4 address for unicast messages or a network interface name followed optionally by a colon and a numeric TTL value for multicast messages to the group 224.0.1.240. If the multicast TTL is not specified, a default value of 1 is used. This option can be specified multiple times. See also <i class="link-sec"><a class="link-sec" href="#x53594e4348524f4e49534154494f4e">SYNCHRONISATION</a></i> below.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-y</b> <i class="arg">synclisten</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Listen on <i class="arg">synclisten</i> for incoming synchronisation messages. The format for <i class="arg">synclisten</i> is the same as for <i class="arg">synctarget</i>, above. This option can be specified only once. See also <i class="link-sec"><a class="link-sec" href="#x53594e4348524f4e49534154494f4e">SYNCHRONISATION</a></i> below.</dd>
</dl>
</div>
<div class="section">
<h1 id="x434f4e46494755524154494f4e">CONFIGURATION</h1> The syntax of the <a class="link-man" href="../html5/dhcpd.conf.html">dhcpd.conf(5)</a> file is discussed separately. This section should be used as an overview of the configuration process, and the <a class="link-man" href="../html5/dhcpd.conf.html">dhcpd.conf(5)</a> documentation should be consulted for detailed reference information.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
Subnets</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
<b class="name">dhcpd</b> needs to know the subnet numbers and netmasks of all subnets for which it will be providing service. In addition, in order to dynamically allocate addresses, it must be assigned one or more ranges of addresses on each subnet which it can in turn assign to client hosts as they boot. Thus, a very simple configuration providing DHCP support might look like this:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
subnet 239.252.197.0 netmask 255.255.255.0 { 
  range 239.252.197.10 239.252.197.250; 
}</pre>
<div class="spacer">
</div>
Multiple address ranges may be specified like this:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
subnet 239.252.197.0 netmask 255.255.255.0 { 
  range 239.252.197.10 239.252.197.107; 
  range 239.252.197.113 239.252.197.250; 
}</pre>
<div class="spacer">
</div>
If a subnet will only be provided with BOOTP service and no dynamic address assignment, the range clause can be left out entirely, but the subnet statement must appear.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
Lease Lengths</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
DHCP leases can be assigned almost any length from zero seconds to infinity. What lease length makes sense for any given subnet, or for any given installation, will vary depending on the kinds of hosts being served.<div class="spacer">
</div>
For example, in an office environment where systems are added from time to time and removed from time to time, but move relatively infrequently, it might make sense to allow lease times of a month or more. In a final test environment on a manufacturing floor, it may make more sense to assign a maximum lease length of 30 minutes - enough time to go through a simple test procedure on a network appliance before packaging it up for delivery.<div class="spacer">
</div>
It is possible to specify two lease lengths: the default length that will be assigned if a client doesn't ask for any particular lease length, and a maximum lease length. These are specified as clauses to the subnet command:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
subnet 239.252.197.0 netmask 255.255.255.0 { 
  range 239.252.197.10 239.252.197.107; 
  default-lease-time 600; 
  max-lease-time 7200; 
}</pre>
<div class="spacer">
</div>
This particular subnet declaration specifies a default lease time of 600 seconds (ten minutes), and a maximum lease time of 7200 seconds (two hours). Other common values would be 86400 (one day), 604800 (one week) and 2592000 (30 days).<div class="spacer">
</div>
Each subnet need not have the same lease - in the case of an office environment and a manufacturing environment served by the same DHCP server, it might make sense to have widely disparate values for default and maximum lease times on each subnet.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
BOOTP Support</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Each BOOTP client must be explicitly declared in the <a class="link-man" href="../html5/dhcpd.conf.html">dhcpd.conf(5)</a> file. A very basic client declaration will specify the client network interface's hardware address and the IP address to assign to that client. If the client needs to be able to load a boot file from the server, that file's name must be specified. A simple BOOTP client declaration might look like this:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
host haagen { 
  hardware ethernet 08:00:2b:4c:59:23; 
  fixed-address 239.252.197.9; 
  filename &quot;haagen.boot&quot;; 
}</pre>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
Options</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
DHCP (and also BOOTP with Vendor Extensions) provides a mechanism whereby the server can provide the client with information about how to configure its network interface (e.g., subnet mask), and also how the client can access various network services (e.g., DNS, IP routers, and so on).<div class="spacer">
</div>
These options can be specified on a per-subnet basis and, for BOOTP clients, also on a per-client basis. In the event that a BOOTP client declaration specifies options that are also specified in its subnet declaration, the options specified in the client declaration take precedence. A reasonably complete DHCP configuration might look something like this:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
subnet 239.252.197.0 netmask 255.255.255.0 { 
  range 239.252.197.10 239.252.197.250; 
  default-lease-time 600; 
  max-lease-time 7200; 
  option subnet-mask 255.255.255.0; 
  option broadcast-address 239.252.197.255; 
  option routers 239.252.197.1; 
  option domain-name-servers 239.252.197.2, 239.252.197.3; 
  option domain-name &quot;isc.org&quot;; 
}</pre>
<div class="spacer">
</div>
A BOOTP host on that subnet that needs to be in a different domain and use a different name server might be declared as follows:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
host haagen { 
  hardware ethernet 08:00:2b:4c:59:23; 
  fixed-address 239.252.197.9; 
  filename &quot;haagen.boot&quot;; 
  option domain-name-servers 192.5.5.1; 
  option domain-name &quot;vix.com&quot;; 
}</pre>
</dd>
</dl>
<div class="spacer">
</div>
A more complete description of the <i class="file">dhcpd.conf</i> file syntax is provided in <a class="link-man" href="../html5/dhcpd.conf.html">dhcpd.conf(5)</a>.</div>
<div class="section">
<h1 id="x53594e4348524f4e49534154494f4e">SYNCHRONISATION</h1> <b class="name">dhcpd</b> supports realtime synchronisation of the lease allocations to a number of <b class="name">dhcpd</b> daemons running on multiple machines, using the <b class="flag">-Y</b> and <b class="flag">-y</b> options.<div class="spacer">
</div>
The following example will accept incoming multicast and unicast synchronisation messages, and send outgoing multicast messages through the network interface <i class="arg">em0</i>:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# /usr/sbin/dhcpd -y em0 -Y em0</pre>
<div class="spacer">
</div>
The second example will increase the multicast TTL to a value of 2, add the unicast targets <i class="arg">foo.somewhere.org</i> and <i class="arg">bar.somewhere.org</i>, and accept incoming unicast messages sent to <i class="arg">example.somewhere.org</i> only.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# /usr/sbin/dhcpd -y example.somewhere.org -Y em0:2 \ 
	-Y foo.somewhere.org -Y bar.somewhere.org</pre>
<div class="spacer">
</div>
If the file <i class="file">/var/db/dhcpd.key</i> exists, <b class="name">dhcpd</b> will calculate the message-digest fingerprint (checksum) for the file and use it as a shared key to authenticate the synchronisation messages. The file itself can contain any data. For example, to create a secure random key:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# dd if=/dev/random of=/var/db/dhcpd.key bs=2048 count=1</pre>
<div class="spacer">
</div>
The file needs to be copied to all hosts sending or receiving synchronisation messages.<div class="spacer">
</div>
All hosts using synchronisation must use the same configuration in the <i class="file">/etc/dhcpd.conf</i> file.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/dhcpd.conf</i></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
DHCPD configuration file.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/db/dhcpd.leases</i></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
DHCPD lease file.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/pf.html">pf(4)</a>, <a class="link-man" href="../html5/dhcpd.conf.html">dhcpd.conf(5)</a>, <a class="link-man" href="../html5/dhcpd.leases.html">dhcpd.leases(5)</a>, <a class="link-man" href="../html8/dhclient.html">dhclient(8)</a>, <a class="link-man" href="../html8/dhcrelay.html">dhcrelay(8)</a>, <a class="link-man" href="../html8/pxeboot.html">pxeboot(8)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> <span class="ref"><span class="ref-auth">R. Droms</span>, <span class="ref-title">Interoperation Between DHCP and BOOTP</span>, <span class="ref-rep">RFC 1534</span>, <span class="ref-date">October 1993</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">R. Droms</span>, <span class="ref-title">Dynamic Host Configuration Protocol</span>, <span class="ref-rep">RFC 2131</span>, <span class="ref-date">March 1997</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">S. Alexander</span> and <span class="ref-auth">R. Droms</span>, <span class="ref-title">DHCP Options and BOOTP Vendor Extensions</span>, <span class="ref-rep">RFC 2132</span>, <span class="ref-date">March 1997</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">T. Lemon</span> and <span class="ref-auth">S. Cheshire</span>, <span class="ref-title">Encoding Long Options in the Dynamic Host Configuration Protocol (DHCPv4)</span>, <span class="ref-rep">RFC 3396</span>, <span class="ref-date">November 2002</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">T. Lemon</span>, <span class="ref-auth">S. Cheshire</span>, and <span class="ref-auth">B. Volz</span>, <span class="ref-title">The Classless Static Route Option for Dynamic Host Configuration Protocol (DHCP) version 4</span>, <span class="ref-rep">RFC 3442</span>, <span class="ref-date">December 2002</span>.</span></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <b class="name">dhcpd</b> was written by <span class="author">Ted Lemon</span> &lt;<a class="link-mail" href="mailto:mellon@vix.com">mellon@vix.com</a>&gt; under a contract with Vixie Labs.<div class="spacer">
</div>
The current implementation was reworked by <span class="author">Henning Brauer</span> &lt;<a class="link-mail" href="mailto:henning@openbsd.org">henning@openbsd.org</a>&gt;.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> We realize that it would be nice if one could send a <span class="define">SIGHUP</span> to the server and have it reload the database. This is not technically impossible, but it would require a great deal of work, our resources are extremely limited, and they can be better spent elsewhere. So please don't complain about this on the mailing list unless you're prepared to fund a project to implement this feature, or prepared to do it yourself.</div>
</div>
</body>
</html>

