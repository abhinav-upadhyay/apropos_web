<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
SPAMDB(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">spamdb</b> &#8212; <span class="desc">spamd database tool</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 6.00ex;"/>
<col/>
<tbody>
<tr>
<td>
spamdb</td>
<td>
[<span class="opt">[<span class="opt"><b class="flag">-Tt</b></span>] <b class="flag">-a</b> <i class="arg">keys</i></span>] [<span class="opt">[<span class="opt"><b class="flag">-Tt</b></span>] <b class="flag">-d</b> <i class="arg">keys</i></span>]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">spamdb</b> manipulates the spamd database in <i class="file">/var/db/spamd</i> used for <a class="link-man" href="../html8/spamd.html">spamd(8)</a>.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-a</b> <i class="arg">keys</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Add or update the entries for <i class="arg">keys</i>. This can be used to whitelist one or more IP addresses (i.e. circumvent the greylisting process altogether) by adding all IP addresses as keys to the spamd database for WHITE entries. If any <i class="arg">keys</i> specified match entries already in the spamd database, <b class="name">spamdb</b> updates the entry's time last seen to now.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b> <i class="arg">keys</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Delete entries for <i class="arg">keys</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-T</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Add or delete the keys as SPAMTRAP entries. See the GREYTRAPPING section of <a class="link-man" href="../html8/spamd.html">spamd(8)</a> for more information. Must be used in conjunction with the <b class="flag">-a</b> or <b class="flag">-d</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-t</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Add or delete the keys as TRAPPED entries. See the GREYTRAPPING section of <a class="link-man" href="../html8/spamd.html">spamd(8)</a> for more information. Must be used in conjunction with the <b class="flag">-a</b> or <b class="flag">-d</b> option.</dd>
</dl>
<div class="spacer">
</div>
If adding or deleting a SPAMTRAP address (<b class="flag">-T</b>), <i class="arg">keys</i> should be specified as email addresses:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">spamtrap@mydomain.org</code></div>
</blockquote>
<div class="spacer">
</div>
Otherwise <i class="arg">keys</i> must be numerical IP addresses.<div class="subsection">
<h2 id="x4441544142415345204f555450555420464f524d4154">DATABASE OUTPUT FORMAT</h2> If invoked without any arguments, <b class="name">spamdb</b> lists the contents of the database in a text format.<div class="spacer">
</div>
For SPAMTRAP entries the format is:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">type|mailaddress</code></div>
</blockquote>
<div class="spacer">
</div>
where <span class="emph">type</span> will be SPAMTRAP and <span class="emph">mailaddress</span> will be the email address for which any connections received by <a class="link-man" href="../html8/spamd.html">spamd(8)</a> will be blacklisted if mail is sent to this address.<div class="spacer">
</div>
For TRAPPED entries the format is:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">type|ip|expire</code></div>
</blockquote>
<div class="spacer">
</div>
where <span class="emph">type</span> will be TRAPPED, <span class="emph">IP</span> will be the IP address blacklisted due to hitting a spamtrap, and <span class="emph">expire</span> will be when the IP is due to be removed from the blacklist.<div class="spacer">
</div>
For GREY entries, the format is:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">type|source IP|helo|from|to|first|pass|expire|block|pass</code></div>
</blockquote>
<div class="spacer">
</div>
For WHITE entries, the format is:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">type|source IP|||first|pass|expire|block|pass</code></div>
</blockquote>
<div class="spacer">
</div>
The fields are as follows:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
type</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<span class="emph">WHITE</span> if whitelisted or <span class="emph">GREY</span> if greylisted</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
source IP</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
IP address the connection originated from</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
helo</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
what the connecting host sent as identification in the HELO/EHLO command in the SMTP dialogue</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
from</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
envelope-from address for <span class="emph">GREY</span> (empty for <span class="emph">WHITE</span> entries)</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
to</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
envelope-to address for <span class="emph">GREY</span> (empty for <span class="emph">WHITE</span> entries)</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
first</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
time the entry was first seen</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
pass</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
time the entry passed from being <span class="emph">GREY</span> to being <span class="emph">WHITE</span></dd>
<dt class="list-tag" style="margin-top: 0.00em;">
expire</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
time the entry will expire and be removed from the database</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
block</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
number of times a corresponding connection received a temporary failure from <a class="link-man" href="../html8/spamd.html">spamd(8)</a></dd>
<dt class="list-tag" style="margin-top: 0.00em;">
pass</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
number of times a corresponding connection has been seen to pass to the real MTA by <a class="link-man" href="../html8/spamlogd.html">spamlogd(8)</a></dd>
</dl>
<div class="spacer">
</div>
Note that times are in seconds since the Epoch, in the manner returned by <a class="link-man" href="../html3/time.html">time(3)</a>. Times may be converted to human readable format using:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ date -r &lt;value&gt;</code></div>
</blockquote>
</div>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1> <i class="file">/var/db/spamd</i></div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html5/spamd.conf.html">spamd.conf(5)</a>, <a class="link-man" href="../html8/spamd.html">spamd(8)</a>, <a class="link-man" href="../html8/spamd-setup.html">spamd-setup(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">spamdb</b> command appeared in <span class="unix">OpenBSD&#160;3.5</span>.</div>
</div>
</body>
</html>

