<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
CORE(5)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">core</b> &#8212; <span class="desc">memory image file format</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/param.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">sys/core.h</a>&gt;</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> A small number of signals which cause abnormal termination of a process also cause a record of the process's in-core state to be written to disk for later examination by one of the available debuggers (see <a class="link-man" href="../html2/sigaction.html">sigaction(2)</a>). This memory image is written to a file named <i class="file">programname.core</i> in the working directory, provided the terminated process had write permission in the directory, and provided the abnormality did not cause a system crash. (In this event, the decision to save the core file is arbitrary, see <a class="link-man" href="../html8/savecore.html">savecore(8)</a>.)<div class="spacer">
</div>
The maximum size of a <i class="file">programname.core</i> file is limited by <a class="link-man" href="../html2/setrlimit.html">setrlimit(2)</a>. Files which would be larger than the limit are not created.<div class="spacer">
</div>
The <i class="file">programname.core</i> file consists of the u-area, whose size (in pages) is defined by the <span class="define">UPAGES</span> manifest in the <b class="includes">&lt;<a class="link-includes">machine/param.h</a>&gt;</b> file. The u-area starts with a <i class="farg">user</i> structure as given in <b class="includes">&lt;<a class="link-includes">sys/user.h</a>&gt;</b>. The remainder of the <i class="file">programname.core</i> file consists of the data pages followed by the stack pages of the process image. The amount of data space image in the <i class="file">programname.core</i> file is given (in pages) by the variable <i class="farg">u_dsize</i> in the u-area. The amount of stack image in the core file is given (in pages) by the variable <i class="farg">u_ssize</i> in the u-area. The size of a &#8220;page&#8221; is given by the constant <span class="define">PAGE_SIZE</span>, defined in <b class="includes">&lt;<a class="link-includes">machine/param.h</a>&gt;</b>. The <i class="farg">user</i> structure is defined as:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct	user { 
	struct	pcb u_pcb; 
 
	struct	pstats u_stats; 
 
	/* 
	 * Remaining fields only for core dump and/or ptrace-- 
	 * not valid at other times! 
	 */ 
	struct	kinfo_proc u_kproc; 
	struct	md_coredump u_md; 
};</pre>
<div class="spacer">
</div>
<i class="farg">md_coredump</i> is defined in the header file <b class="includes">&lt;<a class="link-includes">machine/pcb.h</a>&gt;</b>.<div class="spacer">
</div>
The on-disk core file consists of a header followed by a number of segments. Each segment is preceded by a <i class="farg">coreseg</i> structure giving the segment's type, the virtual address where the bits resided in process address space and the size of the segment.<div class="spacer">
</div>
The core header specifies the lengths of the core header itself and each of the following core segment headers to allow for any machine dependent alignment requirements.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct coreseg { 
	u_int32_t c_midmag;		/* magic, id, flags */ 
	u_long	c_addr;		/* Virtual address of segment */ 
	u_long	c_size;		/* Size of this segment */ 
};</pre>
<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct core { 
	u_int32_t c_midmag;		/* magic, id, flags */ 
	u_int16_t c_hdrsize;   /* Size of this header (machdep algn) */ 
	u_int16_t c_seghdrsize;	/* Size of a segment header */ 
	u_int32_t c_nseg;		/* # of core segments */ 
	char	c_name[MAXCOMLEN+1];	/* Copy of p-&gt;p_comm */ 
	u_int32_t c_signo;		/* Killing signal */ 
	u_long	c_ucode;		/* Hmm ? */ 
	u_long	c_cpusize;	/* Size of machine dependent segment */ 
	u_long	c_tsize;		/* Size of traditional text segment */ 
	u_long	c_dsize;		/* Size of traditional data segment */ 
	u_long	c_ssize;		/* Size of traditional stack segment */ 
};</pre>
<div class="spacer">
</div>
The core structure's <i class="farg">c_midmag field</i> is an a.out-style midmag number with a <span class="define">COREMAGIC</span> magic number. and flags from the following list:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
#define CORE_CPU	1 
#define CORE_DATA	2 
#define CORE_STACK	4</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/gdb.html">gdb(1)</a>, <a class="link-man" href="../html2/setrlimit.html">setrlimit(2)</a>, <a class="link-man" href="../html2/sigaction.html">sigaction(2)</a>, <a class="link-man" href="../html3/sysctl.html">sysctl(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> A <b class="name">core</b> file format appeared in Version&#160;3 AT&amp;T UNIX.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> Programs which are started with either the set-user-ID or set-group-ID bits set, or which change their UID or GID after starting, will normally not dump core. This is to prevent sensitive information from inadvertently ending up on disk. This behaviour can be changed (for debugging purposes) by changing the <code class="lit">kern.nosuidcoredump</code> <a class="link-man" href="../html3/sysctl.html">sysctl(3)</a> variable to the right settings.</div>
</div>
</body>
</html>

