<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
PACKAGE(5)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">package</b> &#8212; <span class="desc">format for OpenBSD binary packages</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> Binary packages for <span class="unix">OpenBSD</span> can be created using <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a> and are usually manipulated using <a class="link-man" href="../html1/pkg_add.html">pkg_add(1)</a>, <a class="link-man" href="../html1/pkg_mklocatedb.html">pkg_mklocatedb(1)</a>, or <a class="link-man" href="../html1/pkg_info.html">pkg_info(1)</a>.<div class="spacer">
</div>
The basic underlying format is an archive following the ustar specification that can be handled with <a class="link-man" href="../html1/tar.html">tar(1)</a> and compressed using <a class="link-man" href="../html1/gzip.html">gzip(1)</a>.<div class="spacer">
</div>
Package names always end in &#8220;.tgz&#8221;; the file name itself should conform to <a class="link-man" href="../html7/packages-specs.html">packages-specs(7)</a>.<div class="spacer">
</div>
Note that the base distribution tarballs of <span class="unix">OpenBSD</span> (e.g. <i class="file">baseXX.tgz</i>, <i class="file">compXX.tgz</i>, ...) are not binary packages fit for <a class="link-man" href="../html1/pkg_add.html">pkg_add(1)</a>.<div class="spacer">
</div>
All types of archive contents can be present in a package, including files, directories, hardlinks, symlinks, fifos, block and character devices.<div class="spacer">
</div>
In order to allow just-in-time extraction, packages always begin with a table of contents, named <i class="file">+CONTENTS</i>. This table of contents can be read using the API described in <a class="link-man" href="../html3p/OpenBSD::PackingList.html">OpenBSD::PackingList(3p)</a>.<div class="spacer">
</div>
All the remaining information in the archive should be referenced in the packing-list, including all relevant information: symlinks destinations, special permissions, and file owners (<a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a> and <a class="link-man" href="../html1/pkg_add.html">pkg_add(1)</a> actually enforce this). See <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a> for annotation details.<div class="spacer">
</div>
This table of contents is always followed by a few special files, some of which are optional: the package description (+DESC), a display message (+DISPLAY), etc.<div class="spacer">
</div>
The basic ustar format has some limitations with respect to file names. Packages now use the &#8220;extended record specification&#8221; (header type x) for long links and long file names. Other extended ustar headers are currently recognized, but not supported.<div class="spacer">
</div>
Starting with <span class="unix">OpenBSD&#160;5.5</span>, the compressed archive may be composed of several <a class="link-man" href="../html1/gzip.html">gzip(1)</a> archives concatenated together. <a class="link-man" href="../html1/gzip.html">gzip(1)</a> doesn't mind, and <a class="link-man" href="../html1/tar.html">tar(1)</a> is happy as long as the uncompressed stream is sane. This allows for faster signing and better rsync properties.<div class="spacer">
</div>
Starting with <span class="unix">OpenBSD&#160;5.6</span>, tarballs are stored &#8220;out-of-order&#8221;: each archive entry will match an entry in the packing-list (and all file-like entries will be matched), but the order will be adjusted so that most recently changed files come first, in order to allow faster updates.</div>
<div class="section">
<h1 id="x5041434b494e47204c49535420414e4e4f544154494f4e53">PACKING LIST ANNOTATIONS</h1> User annotations are described in <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a>. The following annotations are automatically inserted during package creation and installations:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@arch</b> <i class="arg">arches</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
List of architectures for which this package is intended. This corresponds to <b class="flag">-A</b> <i class="arg">arches</i> of <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a><div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@comment pkgpath=path cdrom=yes/no ftp=yes/no</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Historical accident. This specific comment encodes the actual <b class="flag">-D</b> <i class="arg">FULLPKGPATH</i>, <b class="flag">-D</b> <i class="arg">CDROM</i>, and <b class="flag">-D</b> <i class="arg">FTP</i> arguments to <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a>.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@depend</b> <i class="arg">pkgpath</i>:<i class="arg">pkgspec</i>:<i class="arg">default</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Record a dependency declared using the option <b class="flag">-P</b> of <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a>.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@digital-signature</b> <i class="arg">style</i>:<i class="arg">date</i>:<i class="arg">b64sig</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Record a digital signature of the packing-list, corresponding to <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a>'s <b class="flag">-s</b> option.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@link</b> <i class="arg">name</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Added after a file entry by <b class="name">package</b> to record that the entry is actually a hard link.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@localbase</b> <i class="arg">base</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Used internally to record the settings of <b class="flag">-L</b> option.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@name</b> <i class="arg">pkgname</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the name of the package. This name is potentially different than the name of the file it came in, and is used when keeping track of the package for later deinstallation. <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a> will derive this field from the package file name.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@option</b> <i class="arg">name</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Some options are automatically inserted by the package tools:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">firmware</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set by <a class="link-man" href="../html1/fw_update.html">fw_update(1)</a> to trigger firmware-specific handling. In particular, firmware is hidden from normal updates.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">manual-installation</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Record that a package has been explicitly installed by the user, and not as a result of a dependency look-up. Refer to <a class="link-man" href="../html1/pkg_add.html">pkg_add(1)</a>'s <b class="flag">-a</b> option for details.</dd>
</dl>
<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@sha</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Added after a file entry by <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a> to record the files's cryptographic checksum, as a sha256 digest encoded in base64.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@signer</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Internal annotation necessary to identify packages signed with <a class="link-man" href="../html1/signify.html">signify(1)</a> keys, as those keys don't carry any identity.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@size</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Added after a file entry by <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a> to record a file size.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@symlink</b> <i class="arg">name</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Added after a file entry by <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a> to record that the entry is actually a symbolic link.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@url</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Original location of the package, automatically recorded in installed packages by <a class="link-man" href="../html1/pkg_add.html">pkg_add(1)</a>.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@ts</b> <i class="arg">timestamp</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Added after a file entry to record the actual file timestamp. The package tools read and process that annotation correctly. Starting with <span class="unix">OpenBSD&#160;5.7</span>, <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a> will migrate timestamps from the tarball meta-info to the packing-list to better create unchanging archive chunks.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">@wantlib</b> <i class="arg">libspec</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Record a library requirement declared using the option <b class="flag">-W</b> of <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x5041434b414745205349474e415455524553">PACKAGE SIGNATURES</h1> All information within a package is checksummed, using SHA256 since <span class="unix">OpenBSD&#160;4.4</span>. During creation and installation, meta-information, such as file owners and permissions, are also checked: any important stuff that isn't recorded in the packing-list is an error.<div class="spacer">
</div>
Packing-lists can be signed. If a signature is found, then it will be checked during installation, and failure to verify will prevent the package from installing correctly. Currently, <a class="link-man" href="../html1/signify.html">signify(1)</a> and X.509-style signatures are supported. X.509 signatures rely on a certificate authority file being present as <i class="file">/etc/ssl/pkgca.pem</i> and all signatures will be checked against it. Once the packing-list signature is checked, all individual packing elements will be checksummed, resulting in a &#8216;just-in-time&#8217; signature checking.<div class="spacer">
</div>
Fat packages were removed in <span class="unix">OpenBSD&#160;5.1</span>, since no practical application was found.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/pkg_add.html">pkg_add(1)</a>, <a class="link-man" href="../html1/pkg_create.html">pkg_create(1)</a>, <a class="link-man" href="../html1/pkg_info.html">pkg_info(1)</a>, <a class="link-man" href="../html1/pkg_sign.html">pkg_sign(1)</a>, <a class="link-man" href="../html7/packages.html">packages(7)</a>, <a class="link-man" href="../html7/packages-specs.html">packages-specs(7)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> Packages are valid gzip'ed ustar archives that can be extracted using <a class="link-man" href="../html1/tar.html">tar(1)</a>. In particular, hardlink names should be valid, and all items will extract to different names. However, it may be a bit difficult to make sense of the package contents without peeking at the packing-list.</div>
</div>
</body>
</html>

