<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
GETRRSETBYNAME(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">freerrset</b>, <b class="name">getrrsetbyname</b> &#8212; <span class="desc">retrieve DNS records</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">netdb.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">getrrsetbyname</b>(<i class="farg" style="white-space:nowrap;">const char *hostname</i>, <i class="farg" style="white-space:nowrap;">unsigned int rdclass</i>, <i class="farg" style="white-space:nowrap;">unsigned int rdtype</i>, <i class="farg" style="white-space:nowrap;">unsigned int flags</i>, <i class="farg" style="white-space:nowrap;">struct rrsetinfo **res</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">freerrset</b>(<i class="farg" style="white-space:nowrap;">struct rrsetinfo *rrset</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">getrrsetbyname</b>() gets a set of resource records associated with a <i class="farg">hostname</i>, <i class="farg">rdclass</i>, and <i class="farg">rdtype</i>. <i class="farg">hostname</i> is a pointer to a NUL-terminated string. The <i class="farg">flags</i> field is currently unused and must be zero.<div class="spacer">
</div>
After a successful call to <b class="fname">getrrsetbyname</b>(), <i class="farg">*res</i> is a pointer to an <code class="lit">rrsetinfo</code> structure, containing a list of one or more <code class="lit">rdatainfo</code> structures containing resource records and potentially another list of <code class="lit">rdatainfo</code> structures containing SIG resource records associated with those records. The members <code class="lit">rri_rdclass</code> and <code class="lit">rri_rdtype</code> are copied from the parameters. <code class="lit">rri_ttl</code> and <code class="lit">rri_name</code> are properties of the obtained rrset. The resource records contained in <code class="lit">rri_rdatas</code> and <code class="lit">rri_sigs</code> are in uncompressed DNS wire format. Properties of the rdataset are represented in the <code class="lit">rri_flags</code> bitfield. If the <span class="define">RRSET_VALIDATED</span> bit is set, the data has been DNSSEC validated and the signatures verified.<div class="spacer">
</div>
The following structures are used:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct  rdatainfo { 
	unsigned int	rdi_length;	/* length of data */ 
	unsigned char	*rdi_data;	/* record data */ 
}; 
 
struct  rrsetinfo { 
	unsigned int	 rri_flags;	/* RRSET_VALIDATED ... */ 
	unsigned int	 rri_rdclass;	/* class number */ 
	unsigned int	 rri_rdtype;	/* RR type number */ 
	unsigned int	 rri_ttl;	/* time to live */ 
	unsigned int	 rri_nrdatas;	/* size of rdatas array */ 
	unsigned int	 rri_nsigs;	/* size of sigs array */ 
	char		 *rri_name;	/* canonical name */ 
	struct rdatainfo *rri_rdatas;	/* individual records */ 
	struct rdatainfo *rri_sigs;	/* individual signatures */ 
};</pre>
<div class="spacer">
</div>
All of the information returned by <b class="fname">getrrsetbyname</b>() is dynamically allocated: the <code class="lit">rrsetinfo</code> and <code class="lit">rdatainfo</code> structures, and the canonical host name strings pointed to by the <code class="lit">rrsetinfo</code> structure. Memory allocated for the dynamically allocated structures created by a successful call to <b class="fname">getrrsetbyname</b>() is released by <b class="fname">freerrset</b>(). <code class="lit">rrset</code> is a pointer to a <code class="lit">struct rrsetinfo</code> created by a call to <b class="fname">getrrsetbyname</b>().</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">getrrsetbyname</b>() returns zero on success, and one of the following error codes if an error occurred:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ERRSET_NONAME</span>]</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
The name does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ERRSET_NODATA</span>]</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
The name exists, but does not have data of the desired type.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ERRSET_NOMEMORY</span>]</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Memory could not be allocated.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ERRSET_INVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
A parameter is invalid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ERRSET_FAIL</span>]</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Other failure.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/resolver.html">resolver(3)</a>, <a class="link-man" href="../html5/resolv.conf.html">resolv.conf(5)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> <b class="fname">getrrsetbyname</b>() first appeared in <span class="unix">OpenBSD&#160;3.0</span>. The API first appeared in ISC BIND version 9.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Jakob Schlyter</span> &lt;<a class="link-mail" href="mailto:jakob@openbsd.org">jakob@openbsd.org</a>&gt;</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> The <span class="define">RRSET_VALIDATED</span> flag in <code class="lit">rri_flags</code> is set if the AD (authenticated data) bit in the DNS answer is set. This flag <span class="emph">should not</span> be trusted unless the transport between the nameserver and the resolver is secure (e.g. IPsec, trusted network, loopback communication).</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The data in <code class="lit">*rdi_data</code> should be returned in uncompressed wire format. Currently, the data is in compressed format and the caller can't uncompress since it doesn't have the full message.</div>
</div>
</body>
</html>

