<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
SOCKATMARK(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">sockatmark</b> &#8212; <span class="desc">determine whether the read pointer is at the out-of-band data mark</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/socket.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">sockatmark</b>(<i class="farg" style="white-space:nowrap;">int s</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">sockatmark</b>() function returns 1 if the read pointer for the socket <i class="farg">s</i> is currently at the out-of-band data mark. Otherwise, it returns 0 if the socket doesn't have an out-of-band data mark or if there is normal data to be received before the mark.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, the <b class="fname">sockatmark</b>() function returns the value 1 if the read pointer is pointing at the out-of-band data mark, 0 if it is not. Otherwise the value -1 is returned and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The routine used in the historical remote login process to flush output on receipt of an interrupt or quit signal is shown below. It reads the normal data up to the mark (to discard it), then reads the out-of-band byte.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
#include &lt;sys/socket.h&gt; 
... 
oob() 
{ 
	int mark; 
	char waste[BUFSIZ]; 
 
	for (;;) { 
		if ((mark = sockatmark(rem)) &lt; 0) { 
			perror(&quot;sockatmark&quot;); 
			break; 
		} 
		if (mark) 
			break; 
		(void) read(rem, waste, sizeof (waste)); 
	} 
	if (recv(rem, &amp;mark, 1, MSG_OOB) &lt; 0) { 
		perror(&quot;recv&quot;); 
		... 
	} 
	... 
}</pre>
</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> The <b class="fname">sockatmark</b>() call fails if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">s</i> is not a valid descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTTY</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">s</i> is valid but does not refer to a socket.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/recv.html">recv(2)</a>, <a class="link-man" href="../html2/send.html">send(2)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">sockatmark</b>() function conforms to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">sockatmark</b>() function was introduced by IEEE Std 1003.1-2001 (&#8220;POSIX.1&#8221;) to standardize the historical <span class="define">SIOCATMARK</span> <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a>. The <b class="fname">sockatmark</b>() function appeared in <span class="unix">OpenBSD&#160;5.7</span>.<div class="spacer">
</div>
The <span class="errno">ENOTTY</span> error is returned instead of the usual <span class="errno">ENOTSOCK</span> error to match the historical behavior of <span class="define">SIOCATMARK</span>.</div>
</div>
</body>
</html>

