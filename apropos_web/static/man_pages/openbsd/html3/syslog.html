<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
SYSLOG(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">syslog</b>, <b class="name">syslog_r</b>, <b class="name">vsyslog</b>, <b class="name">vsyslog_r</b>, <b class="name">openlog</b>, <b class="name">openlog_r</b>, <b class="name">closelog</b>, <b class="name">closelog_r</b>, <b class="name">setlogmask</b>, <b class="name">setlogmask_r</b> &#8212; <span class="desc">control system log</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">syslog.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">stdarg.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">syslog</b>(<i class="farg" style="white-space:nowrap;">int priority</i>, <i class="farg" style="white-space:nowrap;">const char *message</i>, <i class="farg" style="white-space:nowrap;">...</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">syslog_r</b>(<i class="farg" style="white-space:nowrap;">int priority</i>, <i class="farg" style="white-space:nowrap;">struct syslog_data *data</i>, <i class="farg" style="white-space:nowrap;">const char *message</i>, <i class="farg" style="white-space:nowrap;">...</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">vsyslog</b>(<i class="farg" style="white-space:nowrap;">int priority</i>, <i class="farg" style="white-space:nowrap;">const char *message</i>, <i class="farg" style="white-space:nowrap;">va_list args</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">vsyslog_r</b>(<i class="farg" style="white-space:nowrap;">int priority</i>, <i class="farg" style="white-space:nowrap;">struct syslog_data *data</i>, <i class="farg" style="white-space:nowrap;">const char *message</i>, <i class="farg" style="white-space:nowrap;">va_list args</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">openlog</b>(<i class="farg" style="white-space:nowrap;">const char *ident</i>, <i class="farg" style="white-space:nowrap;">int logopt</i>, <i class="farg" style="white-space:nowrap;">int facility</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">openlog_r</b>(<i class="farg" style="white-space:nowrap;">const char *ident</i>, <i class="farg" style="white-space:nowrap;">int logopt</i>, <i class="farg" style="white-space:nowrap;">int facility</i>, <i class="farg" style="white-space:nowrap;">struct syslog_data *data</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">closelog</b>(<i class="farg" style="white-space:nowrap;">void</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">closelog_r</b>(<i class="farg" style="white-space:nowrap;">struct syslog_data *data</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">setlogmask</b>(<i class="farg" style="white-space:nowrap;">int maskpri</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">setlogmask_r</b>(<i class="farg" style="white-space:nowrap;">int maskpri</i>, <i class="farg" style="white-space:nowrap;">struct syslog_data *data</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">syslog</b>() function writes <i class="farg">message</i> to the system message logger. The message is then written to the system console, log files, logged-in users, or forwarded to other machines as appropriate (see <a class="link-man" href="../html8/syslogd.html">syslogd(8)</a>).<div class="spacer">
</div>
The message is identical to a <a class="link-man" href="../html3/printf.html">printf(3)</a> format string, except that &#8216;<code class="lit">%m</code>&#8217; is replaced by the current error message (as denoted by the global variable <b class="var">errno</b>; see <a class="link-man" href="../html3/strerror.html">strerror(3)</a>). A trailing newline is added if none is present.<div class="spacer">
</div>
The <b class="fname">syslog_r</b>() function is a reentrant version of the <b class="fname">syslog</b>() function. It takes a pointer to a <i class="farg">syslog_data</i> structure which is used to store information. This parameter must be initialized before <b class="fname">syslog_r</b>() is called. The <span class="define">SYSLOG_DATA_INIT</span> constant is used for this purpose.<div class="spacer">
</div>
The <b class="fname">vsyslog</b>() function is an alternate form in which the arguments have already been captured using the variable-length argument facilities of <a class="link-man" href="../html3/stdarg.html">stdarg(3)</a>.<div class="spacer">
</div>
The message is tagged with <i class="farg">priority</i>. Priorities are encoded as a <i class="farg">facility</i> and a <i class="farg">level</i>. The <i class="farg">facility</i> describes the part of the system generating the message:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_AUTH</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The authorization system: <a class="link-man" href="../html1/login.html">login(1)</a>, <a class="link-man" href="../html1/su.html">su(1)</a>, <a class="link-man" href="../html8/getty.html">getty(8)</a>, etc.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_AUTHPRIV</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The same as <span class="define">LOG_AUTH</span>, but logged to a file readable only by selected individuals.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_CRON</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The cron daemon, <a class="link-man" href="../html8/cron.html">cron(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_DAEMON</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
System daemons, such as <a class="link-man" href="../html8/dhcpd.html">dhcpd(8)</a>, that are not provided for explicitly by other facilities.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_FTP</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The file transfer protocol daemon, <a class="link-man" href="../html8/ftpd.html">ftpd(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_KERN</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Messages generated by the kernel. These cannot be generated by any user processes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_LPR</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The line printer spooling system: <a class="link-man" href="../html1/lpr.html">lpr(1)</a>, <a class="link-man" href="../html8/lpc.html">lpc(8)</a>, <a class="link-man" href="../html8/lpd.html">lpd(8)</a>, etc.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_MAIL</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The mail system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_NEWS</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The network news system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_SYSLOG</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Messages generated internally by <a class="link-man" href="../html8/syslogd.html">syslogd(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_USER</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Messages generated by random user processes. This is the default facility identifier if none is specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_UUCP</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The UUCP system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_LOCAL0</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Reserved for local use. Similarly for <span class="define">LOG_LOCAL1</span> through <span class="define">LOG_LOCAL7</span>.</dd>
</dl>
<div class="spacer">
</div>
The <i class="farg">level</i> (ORed with the <i class="farg">facility</i>) is selected from the following <span class="emph">ordered</span> (high to low) list:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_EMERG</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
A panic condition. This is normally broadcast to all users.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_ALERT</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
A condition that should be corrected immediately, such as a corrupted system database.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_CRIT</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Critical conditions, e.g., hard device errors.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_ERR</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Errors.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_WARNING</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Warning messages.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_NOTICE</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Conditions that are not error conditions, but should possibly be handled specially.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_INFO</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Informational messages.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_DEBUG</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Messages that contain information normally of use only when debugging a program.</dd>
</dl>
<div class="spacer">
</div>
The <b class="fname">vsyslog_r</b>() function is used the same way as <b class="fname">vsyslog</b>() except that it takes an additional pointer to a <i class="farg">syslog_data</i> structure. It is a reentrant version of the <b class="fname">vsyslog</b>() function described above.<div class="spacer">
</div>
The <b class="fname">openlog</b>() function provides for more specialized processing of the messages sent by <b class="fname">syslog</b>() and <b class="fname">vsyslog</b>(). The parameter <i class="farg">ident</i> is a string that will be prepended to every message. The <i class="farg">logopt</i> argument is a bit field specifying logging options, which is formed by OR'ing one or more of the following values:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_CONS</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
If <b class="fname">syslog</b>() cannot pass the message to <a class="link-man" href="../html8/syslogd.html">syslogd(8)</a> it will attempt to write the message to the console (<i class="file">/dev/console</i>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_NDELAY</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Open the connection to <a class="link-man" href="../html8/syslogd.html">syslogd(8)</a> immediately. Normally the open is delayed until the first message is logged. Useful for programs that need to manage the order in which file descriptors are allocated. This option must be used in programs that call <a class="link-man" href="../html2/chroot.html">chroot(2)</a> where the new root does not have its own log socket.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_ODELAY</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Delay opening the connection to <a class="link-man" href="../html8/syslogd.html">syslogd(8)</a> until the first message is logged. This is the opposite of <span class="define">LOG_NDELAY</span> and is the default behaviour when neither option is specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_PERROR</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Write the message to standard error output as well as to the system log.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">LOG_PID</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Log the process ID with each message; useful for identifying instantiations of daemons.</dd>
</dl>
<div class="spacer">
</div>
The <i class="farg">facility</i> parameter encodes a default facility to be assigned to all messages that do not have an explicit facility encoded.<div class="spacer">
</div>
The <b class="fname">openlog_r</b>() function is the reentrant version of the <b class="fname">openlog</b>() function. It takes an additional pointer to a <i class="farg">syslog_data</i> structure. This function must be used in conjunction with the other reentrant functions.<div class="spacer">
</div>
The <b class="fname">closelog</b>() function can be used to close the log file. <b class="fname">closelog_r</b>() does the same thing but in a reentrant way and takes an additional pointer to a <i class="farg">syslog_data</i> structure.<div class="spacer">
</div>
The <b class="fname">setlogmask</b>() function sets the log priority mask to <i class="farg">maskpri</i> and returns the previous mask. Calls to <b class="fname">syslog</b>() with a priority not set in <i class="farg">maskpri</i> are rejected. The mask for an individual priority <i class="farg">pri</i> is calculated by the macro <b class="fname">LOG_MASK</b>(<i class="farg">pri</i>); the mask for all priorities up to and including <i class="farg">toppri</i> is given by the macro <b class="fname">LOG_UPTO</b>(<i class="farg">toppri</i>). The default allows all priorities to be logged.<div class="spacer">
</div>
The <b class="fname">setlogmask_r</b>() function is the reentrant version of <b class="fname">setlogmask</b>(). It takes an additional pointer to a <i class="farg">syslog_data</i> structure.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> The <b class="fname">closelog</b>(), <b class="fname">closelog_r</b>(), <b class="fname">openlog</b>(), <b class="fname">openlog_r</b>(), <b class="fname">syslog</b>(), <b class="fname">syslog_r</b>(), <b class="fname">vsyslog</b>(), and <b class="fname">vsyslog_r</b>() functions return no value.<div class="spacer">
</div>
The routines <b class="fname">setlogmask</b>() and <b class="fname">setlogmask_r</b>() always return the previous log mask level.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1><pre style="margin-left: 5.00ex;" class="lit display">
syslog(LOG_ALERT, &quot;who: internal error 23&quot;); 
 
openlog(&quot;ftpd&quot;, LOG_PID | LOG_NDELAY, LOG_FTP); 
 
setlogmask(LOG_UPTO(LOG_ERR)); 
 
syslog(LOG_INFO, &quot;Connection from host %d&quot;, CallingHost); 
 
syslog(LOG_INFO|LOG_LOCAL2, &quot;foobar error: %m&quot;);</pre>
<div class="spacer">
</div>
For the reentrant functions:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct syslog_data sdata = SYSLOG_DATA_INIT; 
 
syslog_r(LOG_INFO|LOG_LOCAL2, &amp;sdata, &quot;foobar error: %m&quot;);</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/logger.html">logger(1)</a>, <a class="link-man" href="../html8/syslogd.html">syslogd(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> These functions appeared in <span class="unix">4.2BSD</span>. The reentrant functions appeared in <span class="unix">OpenBSD&#160;3.1</span>.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> It is important never to pass a string with user-supplied data as a format without using &#8216;<code class="lit">%s</code>&#8217;. An attacker can put format specifiers in the string to mangle the stack, leading to a possible security hole. This holds true even if the string has been built &#8220;by hand&#8221; using a function like <b class="fname">snprintf</b>(), as the resulting string may still contain user-supplied conversion specifiers for later interpolation by <b class="fname">syslog</b>().<div class="spacer">
</div>
Always be sure to use the proper secure idiom:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
syslog(priority, &quot;%s&quot;, string);</pre>
<div class="spacer">
</div>
<b class="fname">syslog_r</b>() and the other reentrant functions should only be used where reentrancy is required (for instance, in a signal handler). <b class="fname">syslog</b>() being not reentrant, only <b class="fname">syslog_r</b>() should be used here. For more information about reentrancy and signal handlers, see <a class="link-man" href="../html3/signal.html">signal(3)</a>.</div>
</div>
</body>
</html>

