<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
GETOPT_LONG(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">getopt_long</b>, <b class="name">getopt_long_only</b> &#8212; <span class="desc">get long options from command line argument list</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">getopt.h</a>&gt;</b><div class="spacer">
</div>
<span class="type">extern char *optarg;</span><br/>
<span class="type">extern int optind;</span><br/>
<span class="type">extern int optopt;</span><br/>
<span class="type">extern int opterr;</span><br/>
<span class="type">extern int optreset;</span><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">getopt_long</b>(<i class="farg" style="white-space:nowrap;">int argc</i>, <i class="farg" style="white-space:nowrap;">char * const *argv</i>, <i class="farg" style="white-space:nowrap;">const char *optstring</i>, <i class="farg" style="white-space:nowrap;">const struct option *longopts</i>, <i class="farg" style="white-space:nowrap;">int *longindex</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">getopt_long_only</b>(<i class="farg" style="white-space:nowrap;">int argc</i>, <i class="farg" style="white-space:nowrap;">char * const *argv</i>, <i class="farg" style="white-space:nowrap;">const char *optstring</i>, <i class="farg" style="white-space:nowrap;">const struct option *longopts</i>, <i class="farg" style="white-space:nowrap;">int *longindex</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">getopt_long</b>() function is similar to <a class="link-man" href="../html3/getopt.html">getopt(3)</a> but it accepts options in two forms: words and characters. The <b class="fname">getopt_long</b>() function provides a superset of the functionality of <a class="link-man" href="../html3/getopt.html">getopt(3)</a>. <b class="fname">getopt_long</b>() can be used in two ways. In the first way, every long option understood by the program has a corresponding short option, and the option structure is only used to translate from long options to short options. When used in this fashion, <b class="fname">getopt_long</b>() behaves identically to <a class="link-man" href="../html3/getopt.html">getopt(3)</a>. This is a good way to add long option processing to an existing program with the minimum of rewriting.<div class="spacer">
</div>
In the second mechanism, a long option sets a flag in the <i class="farg">option</i> structure passed, or will store a pointer to the command line argument in the <i class="farg">option</i> structure passed to it for options that take arguments. Additionally, the long option's argument may be specified as a single argument with an equal sign, e.g.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ myprogram --myoption=somevalue</pre>
<div class="spacer">
</div>
When a long option is processed, the call to <b class="fname">getopt_long</b>() will return 0. For this reason, long option processing without shortcuts is not backwards compatible with <a class="link-man" href="../html3/getopt.html">getopt(3)</a>.<div class="spacer">
</div>
It is possible to combine these methods, providing for long options processing with short option equivalents for some options. Less frequently used options would be processed as long options only.<div class="spacer">
</div>
Abbreviated long option names are accepted when <b class="fname">getopt_long</b>() processes long options if the abbreviation is unique. An exact match is always preferred for a defined long option.<div class="spacer">
</div>
The <b class="fname">getopt_long</b>() call requires an array to be initialized describing the long options. Each element of the array is a structure:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct option { 
	char *name; 
	int has_arg; 
	int *flag; 
	int val; 
};</pre>
<div class="spacer">
</div>
The <i class="farg">name</i> field should contain the option name without the leading double dash.<div class="spacer">
</div>
The <i class="farg">has_arg</i> field should be one of:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">no_argument</span></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
no argument to the option is expected.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">required_argument</span></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
an argument to the option is required.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">optional_argument</span></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
an argument to the option may be presented.</dd>
</dl>
<div class="spacer">
</div>
If <i class="farg">flag</i> is not <span class="define">NULL</span>, then the integer pointed to by it will be set to the value in the <i class="farg">val</i> field. If the <i class="farg">flag</i> field is <span class="define">NULL</span>, then the <i class="farg">val</i> field will be returned. Setting <i class="farg">flag</i> to <span class="define">NULL</span> and setting <i class="farg">val</i> to the corresponding short option will make this function act just like <a class="link-man" href="../html3/getopt.html">getopt(3)</a>.<div class="spacer">
</div>
If the <i class="farg">longindex</i> field is not <span class="define">NULL</span>, then the integer pointed to by it will be set to the index of the long option relative to <i class="farg">longopts</i>.<div class="spacer">
</div>
The last element of the <i class="farg">longopts</i> array has to be filled with zeroes.<div class="spacer">
</div>
The <b class="fname">getopt_long_only</b>() function behaves identically to <b class="fname">getopt_long</b>() with the exception that long options may start with &#8216;-&#8217; in addition to &#8216;--&#8217;. If an option starting with &#8216;-&#8217; does not match a long option but does match a single-character option, the single-character option is returned.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> If the <i class="farg">flag</i> field in <code class="lit">struct option</code> is <span class="define">NULL</span>, <b class="fname">getopt_long</b>() and <b class="fname">getopt_long_only</b>() return the value specified in the <i class="farg">val</i> field, which is usually just the corresponding short option. If <i class="farg">flag</i> is not <span class="define">NULL</span>, these functions return 0 and store <i class="farg">val</i> in the location pointed to by <i class="farg">flag</i>. These functions return &#8216;:&#8217; if there was a missing option argument, &#8216;?&#8217; if the user specified an unknown or ambiguous option, and -1 when the argument list has been exhausted.</div>
<div class="section">
<h1 id="x494d504c454d454e544154494f4e20444946464552454e434553">IMPLEMENTATION DIFFERENCES</h1> This section describes differences to the GNU implementation found in glibc-2.1.3:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
handling of &#8216;<code class="lit">-</code>&#8217; within the option string (not the first character):<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
GNU</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
treats a &#8216;<code class="lit">-</code>&#8217; on the command line as a non-argument.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
OpenBSD</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
a &#8216;<code class="lit">-</code>&#8217; within the option string matches a &#8216;<code class="lit">-</code>&#8217; (single dash) on the command line. This functionality is provided for backward compatibility with programs, such as <a class="link-man" href="../html1/su.html">su(1)</a>, that use &#8216;<code class="lit">-</code>&#8217; as an option flag. This practice is wrong, and should not be used in any current development.</dd>
</dl>
</li>
<li class="list-bul" style="margin-top: 1.00em;">
handling of &#8216;<code class="lit">::</code>&#8217; in the option string in the presence of <span class="env">POSIXLY_CORRECT</span>:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
Both</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
GNU and <span class="unix">OpenBSD</span> ignore <span class="env">POSIXLY_CORRECT</span> here and take &#8216;<code class="lit">::</code>&#8217; to mean the preceding option takes an optional argument.</dd>
</dl>
</li>
<li class="list-bul" style="margin-top: 1.00em;">
return value in case of missing argument if first character (after &#8216;<code class="lit">+</code>&#8217; or &#8216;<code class="lit">-</code>&#8217;) in the option string is not &#8216;<code class="lit">:</code>&#8217;:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
GNU</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
returns &#8216;<code class="lit">?</code>&#8217;</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
OpenBSD</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
returns &#8216;<code class="lit">:</code>&#8217; (since <span class="unix">OpenBSD</span>'s <a class="link-man" href="../html3/getopt.html">getopt(3)</a> does).</dd>
</dl>
</li>
<li class="list-bul" style="margin-top: 1.00em;">
handling of &#8216;<code class="lit">--a</code>&#8217; in <a class="link-man" href="../html3/getopt.html">getopt(3)</a>:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
GNU</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
parses this as option &#8216;<code class="lit">-</code>&#8217;, option &#8216;<code class="lit">a</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
OpenBSD</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
parses this as &#8216;<code class="lit">--</code>&#8217;, and returns -1 (ignoring the &#8216;<code class="lit">a</code>&#8217;) (because the original <b class="fname">getopt</b>() did.)</dd>
</dl>
</li>
<li class="list-bul" style="margin-top: 1.00em;">
setting of <b class="var">optopt</b> for long options with <b class="var">flag</b> <code class="none">non-</code><span class="define">NULL</span>:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
GNU</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
sets <b class="var">optopt</b> to <b class="var">val</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
OpenBSD</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
sets <b class="var">optopt</b> to 0 (since <b class="var">val</b> would never be returned).</dd>
</dl>
</li>
<li class="list-bul" style="margin-top: 1.00em;">
handling of &#8216;<code class="lit">-W</code>&#8217; with &#8216;<code class="lit">W;</code>&#8217; in the option string in <a class="link-man" href="../html3/getopt.html">getopt(3)</a> (not <b class="fname">getopt_long</b>()):<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
GNU</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
causes a segmentation fault.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
OpenBSD</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
no special handling is done; &#8216;<code class="lit">W;</code>&#8217; is interpreted as two separate options, neither of which take an argument.</dd>
</dl>
</li>
<li class="list-bul" style="margin-top: 1.00em;">
setting of <b class="var">optarg</b> for long options without an argument that are invoked via &#8216;<code class="lit">-W</code>&#8217; (with &#8216;<code class="lit">W;</code>&#8217; in the option string):<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
GNU</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
sets <b class="var">optarg</b> to the option name (the argument of &#8216;<code class="lit">-W</code>&#8217;).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
OpenBSD</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
sets <b class="var">optarg</b> to <span class="define">NULL</span> (the argument of the long option).</dd>
</dl>
</li>
<li class="list-bul" style="margin-top: 1.00em;">
handling of &#8216;<code class="lit">-W</code>&#8217; with an argument that is not (a prefix to) a known long option (with &#8216;<code class="lit">W;</code>&#8217; in the option string):<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
GNU</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
returns &#8216;<code class="lit">-W</code>&#8217; with <b class="var">optarg</b> set to the unknown option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
OpenBSD</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
treats this as an error (unknown option) and returns &#8216;<code class="lit">?</code>&#8217; with <b class="var">optopt</b> set to 0 and <b class="var">optarg</b> set to <span class="define">NULL</span> (as GNU's man page documents).</dd>
</dl>
</li>
<li class="list-bul" style="margin-top: 1.00em;">
The error messages are different.</li>
<li class="list-bul" style="margin-top: 1.00em;">
<span class="unix">OpenBSD</span> does not permute the argument vector at the same points in the calling sequence as GNU does. The aspects normally used by the caller (ordering after -1 is returned, value of <b class="var">optind</b> relative to current positions) are the same, though. (We do fewer variable swaps.)</li>
</ul>
</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">POSIXLY_CORRECT</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
If set, option processing stops when the first non-option is found and a leading &#8216;+&#8217; in the <i class="arg">optstring</i> is ignored.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1><pre style="margin-left: 0.00ex;" class="lit display">
int bflag, ch, fd; 
int daggerset; 
 
/* options descriptor */ 
static struct option longopts[] = { 
	{ &quot;buffy&quot;,	no_argument,		NULL, 		'b' }, 
	{ &quot;fluoride&quot;,	required_argument,	NULL, 	       	'f' }, 
	{ &quot;daggerset&quot;,	no_argument,		&amp;daggerset,	1 }, 
	{ NULL, 	0,			NULL, 		0 } 
}; 
 
bflag = 0; 
while ((ch = getopt_long(argc, argv, &quot;bf:&quot;, longopts, NULL)) != -1) 
	switch (ch) { 
	case 'b': 
		bflag = 1; 
		break; 
	case 'f': 
		if ((fd = open(optarg, O_RDONLY, 0)) == -1) 
			err(1, &quot;unable to open %s&quot;, optarg); 
		break; 
	case 0: 
		if (daggerset) 
			fprintf(stderr, &quot;Buffy will use her dagger to &quot; 
			    &quot;apply fluoride to dracula's teeth\n&quot;); 
		break; 
	default: 
		usage(); 
	} 
argc -= optind; 
argv += optind;</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/getopt.html">getopt(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">getopt_long</b>() and <b class="fname">getopt_long_only</b>() functions first appeared in GNU libiberty. This implementation first appeared in <span class="unix">OpenBSD&#160;3.3</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The <i class="arg">argv</i> argument is not really <span class="define">const</span> as its elements may be permuted (unless <span class="env">POSIXLY_CORRECT</span> is set).</div>
</div>
</body>
</html>

