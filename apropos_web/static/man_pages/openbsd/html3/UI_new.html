<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
UI_NEW(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">UI_new</b>, <b class="name">UI_new_method</b>, <b class="name">UI_free</b>, <b class="name">UI_add_input_string</b>, <b class="name">UI_dup_input_string</b>, <b class="name">UI_add_verify_string</b>, <b class="name">UI_dup_verify_string</b>, <b class="name">UI_add_input_boolean</b>, <b class="name">UI_dup_input_boolean</b>, <b class="name">UI_add_info_string</b>, <b class="name">UI_dup_info_string</b>, <b class="name">UI_add_error_string</b>, <b class="name">UI_dup_error_string</b>, <b class="name">UI_construct_prompt</b>, <b class="name">UI_add_user_data</b>, <b class="name">UI_get0_user_data</b>, <b class="name">UI_get0_result</b>, <b class="name">UI_process</b>, <b class="name">UI_ctrl</b>, <b class="name">UI_set_default_method</b>, <b class="name">UI_get_default_method</b>, <b class="name">UI_get_method</b>, <b class="name">UI_set_method</b>, <b class="name">UI_OpenSSL</b>, <b class="name">ERR_load_UI_strings</b> &#8212; <span class="desc">New User Interface</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">openssl/ui.h</a>&gt;</b><div class="spacer">
</div>
<b class="macro">typedef struct ui_st UI;</b><br/>
<b class="macro">typedef struct ui_method_st UI_METHOD;</b><div class="spacer">
</div>
<i class="ftype">UI *</i><br/>
<b class="fname">UI_new</b>(<i class="farg" style="white-space:nowrap;">void</i>);<div class="spacer">
</div>
<i class="ftype">UI *</i><br/>
<b class="fname">UI_new_method</b>(<i class="farg">const UI_METHOD *method</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">UI_free</b>(<i class="farg">UI *ui</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">UI_add_input_string</b>(<i class="farg">UI *ui</i>, <i class="farg">const char *prompt</i>, <i class="farg">int flags</i>, <i class="farg">char *result_buf</i>, <i class="farg">int minsize</i>, <i class="farg">int maxsize</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">UI_dup_input_string</b>(<i class="farg">UI *ui</i>, <i class="farg">const char *prompt</i>, <i class="farg">int flags</i>, <i class="farg">char *result_buf</i>, <i class="farg">int minsize</i>, <i class="farg">int maxsize</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">UI_add_verify_string</b>(<i class="farg">UI *ui</i>, <i class="farg">const char *prompt</i>, <i class="farg">int flags</i>, <i class="farg">char *result_buf</i>, <i class="farg">int minsize</i>, <i class="farg">int maxsize</i>, <i class="farg">const char *test_buf</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">UI_dup_verify_string</b>(<i class="farg">UI *ui</i>, <i class="farg">const char *prompt</i>, <i class="farg">int flags</i>, <i class="farg">char *result_buf</i>, <i class="farg">int minsize</i>, <i class="farg">int maxsize</i>, <i class="farg">const char *test_buf</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">UI_add_input_boolean</b>(<i class="farg">UI *ui</i>, <i class="farg">const char *prompt</i>, <i class="farg">const char *action_desc</i>, <i class="farg">const char *ok_chars</i>, <i class="farg">const char *cancel_chars</i>, <i class="farg">int flags</i>, <i class="farg">char *result_buf</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">UI_dup_input_boolean</b>(<i class="farg">UI *ui</i>, <i class="farg">const char *prompt</i>, <i class="farg">const char *action_desc</i>, <i class="farg">const char *ok_chars</i>, <i class="farg">const char *cancel_chars</i>, <i class="farg">int flags</i>, <i class="farg">char *result_buf</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">UI_add_info_string</b>(<i class="farg">UI *ui</i>, <i class="farg">const char *text</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">UI_dup_info_string</b>(<i class="farg">UI *ui</i>, <i class="farg">const char *text</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">UI_add_error_string</b>(<i class="farg">UI *ui</i>, <i class="farg">const char *text</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">UI_dup_error_string</b>(<i class="farg">UI *ui</i>, <i class="farg">const char *text</i>);<div class="spacer">
</div>
<b class="macro">/* These are the possible flags. They can be OR'ed together. */</b><br/>
<b class="macro">#define UI_INPUT_FLAG_ECHO		0x01</b><br/>
<b class="macro">#define UI_INPUT_FLAG_DEFAULT_PWD	0x02</b><div class="spacer">
</div>
<i class="ftype">char *</i><br/>
<b class="fname">UI_construct_prompt</b>(<i class="farg">UI *ui_method</i>, <i class="farg">const char *object_desc</i>, <i class="farg">const char *object_name</i>);<div class="spacer">
</div>
<i class="ftype">void *</i><br/>
<b class="fname">UI_add_user_data</b>(<i class="farg">UI *ui</i>, <i class="farg">void *user_data</i>);<div class="spacer">
</div>
<i class="ftype">void *</i><br/>
<b class="fname">UI_get0_user_data</b>(<i class="farg">UI *ui</i>);<div class="spacer">
</div>
<i class="ftype">const char *</i><br/>
<b class="fname">UI_get0_result</b>(<i class="farg">UI *ui</i>, <i class="farg">int i</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">UI_process</b>(<i class="farg">UI *ui</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">UI_ctrl</b>(<i class="farg">UI *ui</i>, <i class="farg">int cmd</i>, <i class="farg">long i</i>, <i class="farg">void *p</i>, <i class="farg">void (*f)()</i>);<div class="spacer">
</div>
<b class="macro">#define UI_CTRL_PRINT_ERRORS		1</b><br/>
<b class="macro">#define UI_CTRL_IS_REDOABLE		2</b><div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">UI_set_default_method</b>(<i class="farg">const UI_METHOD *meth</i>);<div class="spacer">
</div>
<i class="ftype">const UI_METHOD *</i><br/>
<b class="fname">UI_get_default_method</b>(<i class="farg">void</i>);<div class="spacer">
</div>
<i class="ftype">const UI_METHOD *</i><br/>
<b class="fname">UI_get_method</b>(<i class="farg">UI *ui</i>);<div class="spacer">
</div>
<i class="ftype">const UI_METHOD *</i><br/>
<b class="fname">UI_set_method</b>(<i class="farg">UI *ui</i>, <i class="farg">const UI_METHOD *meth</i>);<div class="spacer">
</div>
<i class="ftype">UI_METHOD *</i><br/>
<b class="fname">UI_OpenSSL</b>(<i class="farg">void</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> UI stands for User Interface, and is general purpose set of routines to prompt the user for text-based information. Through user-written methods (see <a class="link-man" href="../html3/ui_create.html">ui_create(3)</a>), prompting can be done in any way imaginable, be it plain text prompting, through dialog boxes or from a cell phone.<div class="spacer">
</div>
All the functions work through a context of the type <span class="type">UI</span>. This context contains all the information needed to prompt correctly as well as a reference to a <span class="type">UI_METHOD</span>, which is an ordered vector of functions that carry out the actual prompting.<div class="spacer">
</div>
The first thing to do is to create a <span class="type">UI</span> with <b class="fname">UI_new</b>() or <b class="fname">UI_new_method</b>(), then add information to it with the <b class="fname">UI_add_*</b>() or <b class="fname">UI_dup_*</b>() functions. Also, user-defined random data can be passed down to the underlying method through calls to <b class="fname">UI_add_user_data</b>(). The default UI method doesn't care about these data, but other methods might. Finally, use <b class="fname">UI_process</b>() to actually perform the prompting and <b class="fname">UI_get0_result</b>() to find the result to the prompt.<div class="spacer">
</div>
A <span class="type">UI</span> can contain more than one prompt, which are performed in the given sequence. Each prompt gets an index number which is returned by the <b class="fname">UI_add_*</b>() and <b class="fname">UI_dup_*</b>() functions, and has to be used to get the corresponding result with <b class="fname">UI_get0_result</b>().<div class="spacer">
</div>
The functions are as follows:<div class="spacer">
</div>
<b class="fname">UI_new</b>() creates a new <span class="type">UI</span> using the default UI method. When done with this UI, it should be freed using <b class="fname">UI_free</b>().<div class="spacer">
</div>
<b class="fname">UI_new_method</b>() creates a new <span class="type">UI</span> using the given UI method. When done with this UI, it should be freed using <b class="fname">UI_free</b>().<div class="spacer">
</div>
<b class="fname">UI_OpenSSL</b>() returns the built-in UI method (note: not the default one, since the default can be changed. See further on). This method is the most machine/OS dependent part of OpenSSL and normally generates the most problems when porting.<div class="spacer">
</div>
<b class="fname">UI_free</b>() removes <i class="farg">ui</i> from memory, along with all other pieces of memory that are connected to it, like duplicated input strings, results and others.<div class="spacer">
</div>
<b class="fname">UI_add_input_string</b>() and <b class="fname">UI_add_verify_string</b>() add a prompt to <i class="farg">ui</i>, as well as flags and a result buffer and the desired minimum and maximum sizes of the result. The given information is used to prompt for information, for example a password, and to verify a password (i.e. having the user enter it twice and check that the same string was entered twice). <b class="fname">UI_add_verify_string</b>() takes and extra argument that should be a pointer to the result buffer of the input string that it's supposed to verify, or verification will fail.<div class="spacer">
</div>
<b class="fname">UI_add_input_boolean</b>() adds a prompt to <i class="farg">ui</i> that's supposed to be answered in a boolean way, with a single character for yes and a different character for no. A set of characters that can be used to cancel the prompt is given as well. The prompt itself is really divided in two, one part being the descriptive text (given through the <i class="farg">prompt</i> argument) and one describing the possible answers (given through the <i class="farg">action_desc</i> argument).<div class="spacer">
</div>
<b class="fname">UI_add_info_string</b>() and <b class="fname">UI_add_error_string</b>() add strings that are shown at the same time as the prompt for extra information or to show an error string. The difference between the two is only conceptual. With the builtin method, there's no technical difference between them. Other methods may make a difference between them, however.<div class="spacer">
</div>
The flags currently supported are <span class="define">UI_INPUT_FLAG_ECHO,</span> which is relevant for <b class="fname">UI_add_input_string</b>() and will have the users response be echoed (when prompting for a password, this flag should obviously not be used), and <span class="define">UI_INPUT_FLAG_DEFAULT_PWD</span>, which means that a default password of some sort will be used (completely depending on the application and the UI method).<div class="spacer">
</div>
<b class="fname">UI_dup_input_string</b>(), <b class="fname">UI_dup_verify_string</b>(), <b class="fname">UI_dup_input_boolean</b>(), <b class="fname">UI_dup_info_string</b>(), and <b class="fname">UI_dup_error_string</b>() are basically the same as their <b class="fname">UI_add_*</b>() counterparts, except that they make their own copies of all strings.<div class="spacer">
</div>
<b class="fname">UI_construct_prompt</b>() is a helper function that can be used to create a prompt from two pieces of information: an description and a name. The default constructor (if there is none provided by the method used) creates a string &quot;Enter <span class="emph">description</span> for <span class="emph">name</span>:&quot;. With the description &quot;pass phrase&quot; and the file name &quot;foo.key&quot;, that becomes &quot;Enter pass phrase for foo.key:&quot;. Other methods may create whatever string and may include encodings that will be processed by the other method functions.<div class="spacer">
</div>
<b class="fname">UI_add_user_data</b>() adds a piece of memory for the method to use at any time. The builtin UI method doesn't care about this info. Note that several calls to this function doesn't add data, it replaces the previous blob with the one given as argument.<div class="spacer">
</div>
<b class="fname">UI_get0_user_data</b>() retrieves the data that has last been given to the <i class="farg">ui</i> with <b class="fname">UI_add_user_data</b>().<div class="spacer">
</div>
<b class="fname">UI_get0_result</b>() returns a pointer to the result buffer associated with the information indexed by <i class="farg">i</i>.<div class="spacer">
</div>
<b class="fname">UI_process</b>() goes through the information given so far, does all the printing and prompting and returns.<div class="spacer">
</div>
<b class="fname">UI_ctrl</b>() adds extra control for the application author. For now, it understands two commands: <span class="define">UI_CTRL_PRINT_ERRORS</span>, which makes <b class="fname">UI_process</b>() print the OpenSSL error stack as part of processing the <i class="farg">ui</i>, and <span class="define">UI_CTRL_IS_REDOABLE</span>, which returns a flag saying if the used <i class="farg">ui</i> can be used again or not.<div class="spacer">
</div>
<b class="fname">UI_set_default_method</b>() changes the default UI method to the one given.<div class="spacer">
</div>
<b class="fname">UI_get_default_method</b>() returns a pointer to the current default UI method.<div class="spacer">
</div>
<b class="fname">UI_get_method</b>() returns the UI method associated with a given <i class="farg">ui</i>.<div class="spacer">
</div>
<b class="fname">UI_set_method</b>() changes the UI method associated with a given <i class="farg">ui</i>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/des_read_pw.html">des_read_pw(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The UI section was first introduced in OpenSSL 0.9.7.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Richard Levitte</span> &lt;<a class="link-mail" href="mailto:richard@levitte.org">richard@levitte.org</a>&gt; for the OpenSSL project.</div>
</div>
</body>
</html>

