<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
BF_SET_KEY(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">BF_set_key</b>, <b class="name">BF_encrypt</b>, <b class="name">BF_decrypt</b>, <b class="name">BF_ecb_encrypt</b>, <b class="name">BF_cbc_encrypt</b>, <b class="name">BF_cfb64_encrypt</b>, <b class="name">BF_ofb64_encrypt</b>, <b class="name">BF_options</b> &#8212; <span class="desc">Blowfish encryption</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">openssl/blowfish.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">BF_set_key</b>(<i class="farg">BF_KEY *key</i>, <i class="farg">int len</i>, <i class="farg">const unsigned char *data</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">BF_ecb_encrypt</b>(<i class="farg">const unsigned char *in</i>, <i class="farg">unsigned char *out</i>, <i class="farg">BF_KEY *key</i>, <i class="farg">int enc</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">BF_cbc_encrypt</b>(<i class="farg">const unsigned char *in</i>, <i class="farg">unsigned char *out</i>, <i class="farg">long length</i>, <i class="farg">BF_KEY *schedule</i>, <i class="farg">unsigned char *ivec</i>, <i class="farg">int enc</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">BF_cfb64_encrypt</b>(<i class="farg">const unsigned char *in</i>, <i class="farg">unsigned char *out</i>, <i class="farg">long length</i>, <i class="farg">BF_KEY *schedule</i>, <i class="farg">unsigned char *ivec</i>, <i class="farg">int *num</i>, <i class="farg">int enc</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">BF_ofb64_encrypt</b>(<i class="farg">const unsigned char *in</i>, <i class="farg">unsigned char *out</i>, <i class="farg">long length</i>, <i class="farg">BF_KEY *schedule</i>, <i class="farg">unsigned char *ivec</i>, <i class="farg">int *num</i>);<div class="spacer">
</div>
<i class="ftype">const char *</i><br/>
<b class="fname">BF_options</b>(<i class="farg">void</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">BF_encrypt</b>(<i class="farg">BF_LONG *data</i>, <i class="farg">const BF_KEY *key</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">BF_decrypt</b>(<i class="farg">BF_LONG *data</i>, <i class="farg">const BF_KEY *key</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> This library implements the Blowfish cipher, which was invented and described by <span class="author">Counterpane</span>.<div class="spacer">
</div>
Blowfish is a block cipher that operates on 64 bit (8 byte) blocks of data. It uses a variable size key, but typically, 128 bit (16 byte) keys are considered good for strong encryption. Blowfish can be used in the same modes as DES (see <a class="link-man" href="../html3/des_modes.html">des_modes(3)</a>). Blowfish is currently one of the faster block ciphers. It is quite a bit faster than DES, and much faster than IDEA or RC2.<div class="spacer">
</div>
Blowfish consists of a key setup phase and the actual encryption or decryption phase.<div class="spacer">
</div>
<b class="fname">BF_set_key</b>() sets up the <span class="type">BF_KEY</span> <i class="farg">key</i> using the <i class="farg">len</i> bytes long key at <i class="farg">data</i>.<div class="spacer">
</div>
<b class="fname">BF_ecb_encrypt</b>() is the basic Blowfish encryption and decryption function. It encrypts or decrypts the first 64 bits of <i class="farg">in</i> using the key <i class="farg">key</i>, putting the result in <i class="farg">out</i>. <i class="farg">enc</i> decides if encryption (<span class="define">BF_ENCRYPT</span>) or decryption (<span class="define">BF_DECRYPT</span>) shall be performed. The vector pointed at by <i class="farg">in</i> and <i class="farg">out</i> must be 64 bits in length, no less. If they are larger, everything after the first 64 bits is ignored.<div class="spacer">
</div>
The mode functions <b class="fname">BF_cbc_encrypt</b>(), <b class="fname">BF_cfb64_encrypt</b>(), and <b class="fname">BF_ofb64_encrypt</b>() all operate on variable length data. They all take an initialization vector <i class="farg">ivec</i> which needs to be passed along into the next call of the same function for the same message. <i class="farg">ivec</i> may be initialized with anything, but the recipient needs to know what it was initialized with, or it won't be able to decrypt. Some programs and protocols simplify this, like SSH, where <i class="farg">ivec</i> is simply initialized to zero. <b class="fname">BF_cbc_encrypt</b>() operates on data that is a multiple of 8 bytes long, while <b class="fname">BF_cfb64_encrypt</b>() and <b class="fname">BF_ofb64_encrypt</b>() are used to encrypt an variable number of bytes (the amount does not have to be an exact multiple of 8). The purpose of the latter two is to simulate stream ciphers, and therefore, they need the parameter <i class="farg">num</i>, which is a pointer to an integer where the current offset in <i class="farg">ivec</i> is stored between calls. This integer must be initialized to zero when <i class="farg">ivec</i> is initialized.<div class="spacer">
</div>
<b class="fname">BF_cbc_encrypt</b>() is the Cipher Block Chaining function for Blowfish. It encrypts or decrypts the 64 bits chunks of <i class="farg">in</i> using the key <i class="farg">schedule</i>, putting the result in <i class="farg">out</i>. <i class="farg">enc</i> decides if encryption (<span class="define">BF_ENCRYPT</span>) or decryption (<span class="define">BF_DECRYPT</span>) shall be performed. <i class="farg">ivec</i> must point at an 8 byte long initialization vector.<div class="spacer">
</div>
<b class="fname">BF_cfb64_encrypt</b>() is the CFB mode for Blowfish with 64 bit feedback. It encrypts or decrypts the bytes in <i class="farg">in</i> using the key <i class="farg">schedule</i>, putting the result in <i class="farg">out</i>. <i class="farg">enc</i> decides if encryption (<span class="define">BF_ENCRYPT</span>) or decryption (<span class="define">BF_DECRYPT</span>) shall be performed. <i class="farg">ivec</i> must point at an 8 byte long initialization vector. <i class="farg">num</i> must point at an integer which must be initially zero.<div class="spacer">
</div>
<b class="fname">BF_ofb64_encrypt</b>() is the OFB mode for Blowfish with 64 bit feedback. It uses the same parameters as <b class="fname">BF_cfb64_encrypt</b>(), which must be initialized the same way.<div class="spacer">
</div>
<b class="fname">BF_encrypt</b>() and <b class="fname">BF_decrypt</b>() are the lowest level functions for Blowfish encryption. They encrypt/decrypt the first 64 bits of the vector pointed by <i class="farg">data</i>, using the key <i class="farg">key</i>. These functions should not be used unless you implement 'modes' of Blowfish. The alternative is to use <b class="fname">BF_ecb_encrypt</b>(). If you still want to use these functions, you should be aware that they take each 32-bit chunk in host-byte order, which is little-endian on little-endian platforms and big-endian on big-endian ones.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> None of the functions presented here return any value.</div>
<div class="section">
<h1 id="x4e4f5445">NOTE</h1> Applications should use the higher level functions <a class="link-man" href="../html3/EVP_EncryptInit.html">EVP_EncryptInit(3)</a> etc. instead of calling the blowfish functions directly.</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The Blowfish functions are available in all versions of SSLeay and OpenSSL.</div>
</div>
</body>
</html>

