<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
SSL_CTX_SET_DEFAULT_PASSWD_CB(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">SSL_CTX_set_default_passwd_cb</b>, <b class="name">SSL_CTX_set_default_passwd_cb_userdata</b> &#8212; <span class="desc">set passwd callback for encrypted PEM file handling</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">openssl/ssl.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">SSL_CTX_set_default_passwd_cb</b>(<i class="farg" style="white-space:nowrap;">SSL_CTX *ctx</i>, <i class="farg" style="white-space:nowrap;">pem_password_cb *cb</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">SSL_CTX_set_default_passwd_cb_userdata</b>(<i class="farg" style="white-space:nowrap;">SSL_CTX *ctx</i>, <i class="farg" style="white-space:nowrap;">void *u</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">pem_passwd_cb</b>(<i class="farg" style="white-space:nowrap;">char *buf</i>, <i class="farg" style="white-space:nowrap;">int size</i>, <i class="farg" style="white-space:nowrap;">int rwflag</i>, <i class="farg" style="white-space:nowrap;">void *userdata</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">SSL_CTX_set_default_passwd_cb</b>() sets the default password callback called when loading/storing a PEM certificate with encryption.<div class="spacer">
</div>
<b class="fname">SSL_CTX_set_default_passwd_cb_userdata</b>() sets a pointer to userdata <i class="farg">u</i> which will be provided to the password callback on invocation.<div class="spacer">
</div>
The <b class="fname">pem_passwd_cb</b>(), which must be provided by the application, hands back the password to be used during decryption. On invocation a pointer to <i class="farg">userdata</i> is provided. The pem_passwd_cb must write the password into the provided buffer <i class="farg">buf</i> which is of size <i class="farg">size</i>. The actual length of the password must be returned to the calling function. <i class="farg">rwflag</i> indicates whether the callback is used for reading/decryption (<i class="farg">rwflag</i> <code class="none">= 0</code>) or writing/encryption (<i class="farg">rwflag</i> <code class="none">= 1</code>).</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1> When loading or storing private keys, a password might be supplied to protect the private key. The way this password can be supplied may depend on the application. If only one private key is handled, it can be practical to have <b class="fname">pem_passwd_cb</b>() handle the password dialog interactively. If several keys have to be handled, it can be practical to ask for the password once, then keep it in memory and use it several times. In the last case, the password could be stored into the <i class="farg">userdata</i> storage and the <b class="fname">pem_passwd_cb</b>() only returns the password already stored.<div class="spacer">
</div>
When asking for the password interactively, <b class="fname">pem_passwd_cb</b>() can use <i class="farg">rwflag</i> to check whether an item shall be encrypted (<i class="farg">rwflag</i> <code class="none">= 1</code>). In this case the password dialog may ask for the same password twice for comparison in order to catch typos which would make decryption impossible.<div class="spacer">
</div>
Other items in PEM formatting (certificates) can also be encrypted; it is however atypical, as certificate information is considered public.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">SSL_CTX_set_default_passwd_cb</b>() and <b class="fname">SSL_CTX_set_default_passwd_cb_userdata</b>() do not provide diagnostic information.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The following example returns the password provided as <i class="farg">userdata</i> to the calling function. The password is considered to be a &#8216;\0&#8217; terminated string. If the password does not fit into the buffer, the password is truncated.<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
int pem_passwd_cb(char *buf, int size, int rwflag, void *password) 
{ 
	strncpy(buf, (char *)password, size); 
	buf[size - 1] = '\0'; 
	return strlen(buf); 
}</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/ssl.html">ssl(3)</a>, <a class="link-man" href="../html3/SSL_CTX_use_certificate.html">SSL_CTX_use_certificate(3)</a></div>
</div>
</body>
</html>

