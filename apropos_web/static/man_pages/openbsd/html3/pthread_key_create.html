<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
PTHREAD_KEY_CREATE(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">pthread_key_create</b> &#8212; <span class="desc">thread-specific data key creation</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">pthread.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">pthread_key_create</b>(<i class="farg" style="white-space:nowrap;">pthread_key_t *key</i>, <i class="farg" style="white-space:nowrap;">void (*destructor)(void *)</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">pthread_key_create</b>() function creates a thread-specific data key visible to all threads in the process. Key values provided by <b class="fname">pthread_key_create</b>() are opaque objects used to locate thread-specific data. Although the same key value may be used by different threads, the values bound to the key by <b class="fname">pthread_setspecific</b>() are maintained on a per-thread basis and persist for the life of the calling thread.<div class="spacer">
</div>
Upon key creation, the value NULL is associated with the new key in all active threads. Upon thread creation, the value NULL is associated with all defined keys in the new thread.<div class="spacer">
</div>
An optional destructor function may be associated with each key value. At thread exit, if a key value has a non-NULL destructor pointer, and the thread has a non-NULL value associated with the key, the function pointed to is called with the current associated value as its sole argument. The order of destructor calls is unspecified if more than one destructor exists for a thread when it exits.<div class="spacer">
</div>
If, after all the destructors have been called for all non-NULL values with associated destructors, there are still some non-NULL values with associated destructors, then the process is repeated. If, after at least [PTHREAD_DESTRUCTOR_ITERATIONS] iterations of destructor calls for outstanding non-NULL values, there are still some non-NULL values with associated destructors, the implementation stops calling destructors.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> If successful, the <b class="fname">pthread_key_create</b>() function will store the newly created key value at the location specified by <i class="farg">key</i> and returns zero. Otherwise an error number will be returned to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">pthread_key_create</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EAGAIN</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The system lacked the necessary resources to create another thread-specific data key, or the system-imposed limit on the total number of keys per process [PTHREAD_KEYS_MAX] would be exceeded.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOMEM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Insufficient memory exists to create the key.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/pthread_getspecific.html">pthread_getspecific(3)</a>, <a class="link-man" href="../html3/pthread_key_delete.html">pthread_key_delete(3)</a>, <a class="link-man" href="../html3/pthread_setspecific.html">pthread_setspecific(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> <b class="fname">pthread_key_create</b>() conforms to ISO/IEC 9945-1:1996 (&#8220;POSIX.1&#8221;).</div>
</div>
</body>
</html>

