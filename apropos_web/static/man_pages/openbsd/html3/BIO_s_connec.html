<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
BIO_S_CONNECT(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">BIO_s_connect</b>, <b class="name">BIO_new_connect</b>, <b class="name">BIO_set_conn_hostname</b>, <b class="name">BIO_set_conn_port</b>, <b class="name">BIO_set_conn_ip</b>, <b class="name">BIO_set_conn_int_port</b>, <b class="name">BIO_get_conn_hostname</b>, <b class="name">BIO_get_conn_port</b>, <b class="name">BIO_get_conn_ip</b>, <b class="name">BIO_get_conn_int_port</b>, <b class="name">BIO_set_nbio</b>, <b class="name">BIO_do_connect</b> &#8212; <span class="desc">connect BIO</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">openssl/bio.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">BIO_METHOD *</i><br/>
<b class="fname">BIO_s_connect</b>(<i class="farg">void</i>);<div class="spacer">
</div>
<i class="ftype">BIO *</i><br/>
<b class="fname">BIO_new_connect</b>(<i class="farg">char *name</i>);<div class="spacer">
</div>
<i class="ftype">long</i><br/>
<b class="fname">BIO_set_conn_hostname</b>(<i class="farg">BIO *b</i>, <i class="farg">char *name</i>);<div class="spacer">
</div>
<i class="ftype">long</i><br/>
<b class="fname">BIO_set_conn_port</b>(<i class="farg">BIO *b</i>, <i class="farg">char *port</i>);<div class="spacer">
</div>
<i class="ftype">long</i><br/>
<b class="fname">BIO_set_conn_ip</b>(<i class="farg">BIO *b</i>, <i class="farg">char *ip</i>);<div class="spacer">
</div>
<i class="ftype">long</i><br/>
<b class="fname">BIO_set_conn_int_port</b>(<i class="farg">BIO *b</i>, <i class="farg">char *port</i>);<div class="spacer">
</div>
<i class="ftype">char *</i><br/>
<b class="fname">BIO_get_conn_hostname</b>(<i class="farg">BIO *b</i>);<div class="spacer">
</div>
<i class="ftype">char *</i><br/>
<b class="fname">BIO_get_conn_port</b>(<i class="farg">BIO *b</i>);<div class="spacer">
</div>
<i class="ftype">char *</i><br/>
<b class="fname">BIO_get_conn_ip</b>(<i class="farg">BIO *b</i>, <i class="farg">dummy</i>);<div class="spacer">
</div>
<i class="ftype">long</i><br/>
<b class="fname">BIO_get_conn_int_port</b>(<i class="farg">BIO *b</i>, <i class="farg">int port</i>);<div class="spacer">
</div>
<i class="ftype">long</i><br/>
<b class="fname">BIO_set_nbio</b>(<i class="farg">BIO *b</i>, <i class="farg">long n</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BIO_do_connect</b>(<i class="farg">BIO *b</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">BIO_s_connect</b>() returns the connect BIO method. This is a wrapper around the platform's TCP/IP socket connection routines.<div class="spacer">
</div>
Using connect BIOs, TCP/IP connections can be made and data transferred using only BIO routines. In this way any platform specific operations are hidden by the BIO abstraction.<div class="spacer">
</div>
Read and write operations on a connect BIO will perform I/O on the underlying connection. If no connection is established and the port and hostname (see below) is set up properly, then a connection is established first.<div class="spacer">
</div>
Connect BIOs support <a class="link-man" href="../html3/BIO_puts.html">BIO_puts(3)</a> but not <a class="link-man" href="../html3/BIO_gets.html">BIO_gets(3)</a>.<div class="spacer">
</div>
If the close flag is set on a connect BIO, then any active connection is shutdown and the socket closed when the BIO is freed.<div class="spacer">
</div>
Calling <a class="link-man" href="../html3/BIO_reset.html">BIO_reset(3)</a> on a connect BIO will close any active connection and reset the BIO into a state where it can connect to the same host again.<div class="spacer">
</div>
<a class="link-man" href="../html3/BIO_get_fd.html">BIO_get_fd(3)</a> places the underlying socket in <i class="farg">c</i> if it is not <span class="define">NULL</span>, it also returns the socket. If <i class="farg">c</i> is not <span class="define">NULL</span> it should be of type <span class="type">int *</span>.<div class="spacer">
</div>
<b class="fname">BIO_set_conn_hostname</b>() uses the string <i class="farg">name</i> to set the hostname. The hostname can be an IP address. The hostname can also include the port in the form <i class="arg">hostname</i>:<i class="arg">port</i>. It is also acceptable to use the forms <i class="arg">hostname</i>/<i class="file">any/other/path</i> or <i class="arg">hostname</i>:<i class="arg">port</i>/<i class="file">any/other/path</i>.<div class="spacer">
</div>
<b class="fname">BIO_set_conn_port</b>() sets the port to <i class="farg">port</i>. <i class="farg">port</i> can be the numerical form or a string such as <b class="flag">http</b>. A string will be looked up first using <a class="link-man" href="../html3/getservbyname.html">getservbyname(3)</a> on the host platform, but if that fails a built-in table of port names will be used. Currently the list is <b class="flag">http</b>, <b class="flag">telnet</b>, <b class="flag">socks</b>, <b class="flag">https</b>, <b class="flag">ssl</b>, <b class="flag">ftp</b>, <b class="flag">gopher</b>, and <b class="flag">wais</b>.<div class="spacer">
</div>
<b class="fname">BIO_set_conn_ip</b>() sets the IP address to <i class="farg">ip</i> using binary form, that is four bytes specifying the IP address in big-endian form.<div class="spacer">
</div>
<b class="fname">BIO_set_conn_int_port</b>() sets the port using <i class="farg">port</i>. <i class="farg">port</i> should be of type <span class="type">int *</span>.<div class="spacer">
</div>
<b class="fname">BIO_get_conn_hostname</b>() returns the hostname of the connect BIO or <span class="define">NULL</span> if the BIO is initialized but no hostname is set. This return value is an internal pointer which should not be modified.<div class="spacer">
</div>
<b class="fname">BIO_get_conn_port</b>() returns the port as a string.<div class="spacer">
</div>
<b class="fname">BIO_get_conn_ip</b>() returns the IP address in binary form.<div class="spacer">
</div>
<b class="fname">BIO_get_conn_int_port</b>() returns the port as an <span class="type">int</span>.<div class="spacer">
</div>
<b class="fname">BIO_set_nbio</b>() sets the non blocking I/O flag to <i class="farg">n</i>. If <i class="farg">n</i> is zero then blocking I/O is set. If <i class="farg">n</i> is 1 then non blocking I/O is set. Blocking I/O is the default. The call to <b class="fname">BIO_set_nbio</b>() should be made before the connection is established because non blocking I/O is set during the connect process.<div class="spacer">
</div>
<b class="fname">BIO_new_connect</b>() combines <a class="link-man" href="../html3/BIO_new.html">BIO_new(3)</a> and <b class="fname">BIO_set_conn_hostname</b>() into a single call. It creates a new connect BIO with <i class="farg">name</i>.<div class="spacer">
</div>
<b class="fname">BIO_do_connect</b>() attempts to connect the supplied BIO. It returns 1 if the connection was established successfully. A zero or negative value is returned if the connection could not be established. The call <a class="link-man" href="../html3/BIO_should_retry.html">BIO_should_retry(3)</a> should be used for non blocking connect BIOs to determine if the call should be retried.</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1> If blocking I/O is set then a non positive return value from any I/O call is caused by an error condition, although a zero return will normally mean that the connection was closed.<div class="spacer">
</div>
If the port name is supplied as part of the host name then this will override any value set with <b class="fname">BIO_set_conn_port</b>(). This may be undesirable if the application does not wish to allow connection to arbitrary ports. This can be avoided by checking for the presence of the &#8216;:&#8217; character in the passed hostname and either indicating an error or truncating the string at that point.<div class="spacer">
</div>
The values returned by <b class="fname">BIO_get_conn_hostname</b>(), <b class="fname">BIO_get_conn_port</b>(), <b class="fname">BIO_get_conn_ip</b>(), and <b class="fname">BIO_get_conn_int_port</b>() are updated when a connection attempt is made. Before any connection attempt the values returned are those set by the application itself.<div class="spacer">
</div>
Applications do not have to call <b class="fname">BIO_do_connect</b>() but may wish to do so to separate the connection process from other I/O processing.<div class="spacer">
</div>
If non-blocking I/O is set, then retries will be requested as appropriate.<div class="spacer">
</div>
It addition to <a class="link-man" href="../html3/BIO_should_read.html">BIO_should_read(3)</a> and <a class="link-man" href="../html3/BIO_should_write.html">BIO_should_write(3)</a> it is also possible for <a class="link-man" href="../html3/BIO_should_io_special.html">BIO_should_io_special(3)</a> to be true during the initial connection process with the reason <span class="define">BIO_RR_CONNECT</span>. If this is returned, it is an indication that a connection attempt would block. The application should then take appropriate action to wait until the underlying socket has connected and retry the call.<div class="spacer">
</div>
<b class="fname">BIO_set_conn_hostname</b>(), <b class="fname">BIO_set_conn_port</b>(), <b class="fname">BIO_set_conn_ip</b>(), <b class="fname">BIO_set_conn_int_port</b>(), <b class="fname">BIO_get_conn_hostname</b>(), <b class="fname">BIO_get_conn_port</b>(), <b class="fname">BIO_get_conn_ip</b>(), <b class="fname">BIO_get_conn_int_port</b>(), <b class="fname">BIO_set_nbio</b>(), and <b class="fname">BIO_do_connect</b>() are macros.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">BIO_s_connect</b>() returns the connect BIO method.<div class="spacer">
</div>
<a class="link-man" href="../html3/BIO_get_fd.html">BIO_get_fd(3)</a> returns the socket or -1 if the BIO has not been initialized.<div class="spacer">
</div>
<b class="fname">BIO_set_conn_hostname</b>(), <b class="fname">BIO_set_conn_port</b>(), <b class="fname">BIO_set_conn_ip</b>(), and <b class="fname">BIO_set_conn_int_port</b>() always return 1.<div class="spacer">
</div>
<b class="fname">BIO_get_conn_hostname</b>() returns the connected hostname or <span class="define">NULL</span> if none is set.<div class="spacer">
</div>
<b class="fname">BIO_get_conn_port</b>() returns a string representing the connected port or <span class="define">NULL</span> if not set.<div class="spacer">
</div>
<b class="fname">BIO_get_conn_ip</b>() returns a pointer to the connected IP address in binary form or all zeros if not set.<div class="spacer">
</div>
<b class="fname">BIO_get_conn_int_port</b>() returns the connected port or 0 if none was set.<div class="spacer">
</div>
<b class="fname">BIO_set_nbio</b>() always returns 1.<div class="spacer">
</div>
<b class="fname">BIO_do_connect</b>() returns 1 if the connection was successfully established and 0 or -1 if the connection failed.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> This example connects to a webserver on the local host and attempts to retrieve a page and copy the result to standard output.<div class="spacer">
</div>
<pre style="margin-left: 2.00ex;" class="lit display">
BIO *cbio, *out; 
int len; 
char tmpbuf[1024]; 
 
ERR_load_crypto_strings(); 
cbio = BIO_new_connect(&quot;localhost:http&quot;); 
out = BIO_new_fp(stdout, BIO_NOCLOSE); 
if (BIO_do_connect(cbio) &lt;= 0) { 
	fprintf(stderr, &quot;Error connecting to server\n&quot;); 
	ERR_print_errors_fp(stderr); 
	/* whatever ... */ 
} 
BIO_puts(cbio, &quot;GET / HTTP/1.0\n\n&quot;); 
for(;;) { 
	len = BIO_read(cbio, tmpbuf, 1024); 
	if (len &lt;= 0) 
		break; 
	BIO_write(out, tmpbuf, len); 
} 
BIO_free(cbio); 
BIO_free(out);</pre>
</div>
</div>
</body>
</html>

