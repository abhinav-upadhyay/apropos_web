<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
SSL_CTX_LOAD_VERIFY_LOCATIONS(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">SSL_CTX_load_verify_locations</b> &#8212; <span class="desc">set default locations for trusted CA certificates</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">openssl/ssl.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">SSL_CTX_load_verify_locations</b>(<i class="farg">SSL_CTX *ctx</i>, <i class="farg">const char *CAfile</i>, <i class="farg">const char *CApath</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">SSL_CTX_load_verify_locations</b>() specifies the locations for <i class="farg">ctx</i>, at which CA certificates for verification purposes are located. The certificates available via <i class="farg">CAfile</i> and <i class="farg">CApath</i> are trusted.</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1> If <i class="farg">CAfile</i> is not <span class="define">NULL</span>, it points to a file of CA certificates in PEM format. The file can contain several CA certificates identified by sequences of:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
 -----BEGIN CERTIFICATE----- 
 ... (CA certificate in base64 encoding) ... 
 -----END CERTIFICATE-----</pre>
Before, between, and after the certificates arbitrary text is allowed which can be used, e.g., for descriptions of the certificates.<div class="spacer">
</div>
The <i class="farg">CAfile</i> is processed on execution of the <b class="fname">SSL_CTX_load_verify_locations</b>() function.<div class="spacer">
</div>
If <i class="farg">CApath</i> is not NULL, it points to a directory containing CA certificates in PEM format. The files each contain one CA certificate. The files are looked up by the CA subject name hash value, which must hence be available. If more than one CA certificate with the same name hash value exist, the extension must be different (e.g., <i class="file">9d66eef0.0</i>, <i class="file">9d66eef0.1</i>, etc.). The search is performed in the ordering of the extension number, regardless of other properties of the certificates.<div class="spacer">
</div>
The certificates in <i class="farg">CApath</i> are only looked up when required, e.g., when building the certificate chain or when actually performing the verification of a peer certificate.<div class="spacer">
</div>
When looking up CA certificates, the OpenSSL library will first search the certificates in <i class="farg">CAfile</i>, then those in <i class="farg">CApath</i>. Certificate matching is done based on the subject name, the key identifier (if present), and the serial number as taken from the certificate to be verified. If these data do not match, the next certificate will be tried. If a first certificate matching the parameters is found, the verification process will be performed; no other certificates for the same parameters will be searched in case of failure.<div class="spacer">
</div>
In server mode, when requesting a client certificate, the server must send the list of CAs of which it will accept client certificates. This list is not influenced by the contents of <i class="farg">CAfile</i> or <i class="farg">CApath</i> and must explicitly be set using the <a class="link-man" href="../html3/SSL_CTX_set_client_CA_list.html">SSL_CTX_set_client_CA_list(3)</a> family of functions.<div class="spacer">
</div>
When building its own certificate chain, an OpenSSL client/server will try to fill in missing certificates from <i class="farg">CAfile</i>/ <i class="farg">CApath</i>, if the certificate chain was not explicitly specified (see <a class="link-man" href="../html3/SSL_CTX_add_extra_chain_cert.html">SSL_CTX_add_extra_chain_cert(3)</a> and <a class="link-man" href="../html3/SSL_CTX_use_certificate.html">SSL_CTX_use_certificate(3)</a>).</div>
<div class="section">
<h1 id="x5741524e494e4753">WARNINGS</h1> If several CA certificates matching the name, key identifier, and serial number condition are available, only the first one will be examined. This may lead to unexpected results if the same CA certificate is available with different expiration dates. If a &#8220;certificate expired&#8221; verification error occurs, no other certificate will be searched. Make sure to not have expired certificates mixed with valid ones.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> The following return values can occur:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
0</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The operation failed because <i class="farg">CAfile</i> and <i class="farg">CApath</i> are <span class="define">NULL</span> or the processing at one of the locations specified failed. Check the error stack to find out the reason.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
1</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The operation succeeded.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Generate a CA certificate file with descriptive text from the CA certificates <i class="file">ca1.pem</i> <i class="file">ca2.pem</i> <i class="file">ca3.pem</i>:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
#!/bin/sh 
rm CAfile.pem 
for i in ca1.pem ca2.pem ca3.pem; do 
	openssl x509 -in $i -text &gt;&gt; CAfile.pem 
done</pre>
<div class="spacer">
</div>
Prepare the directory /some/where/certs containing several CA certificates for use as <i class="farg">CApath</i>:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
$ cd /some/where/certs 
$ rm -f *.[0-9]* *.r[0-9]* 
$ for c in *.pem; do 
&gt;    [ &quot;$c&quot; = &quot;*.pem&quot; ] &amp;&amp; continue 
&gt;    hash=$(openssl x509 -noout -hash -in &quot;$c&quot;) 
&gt;    if egrep -q -- '-BEGIN( X509 | TRUSTED | )CERTIFICATE-' &quot;$c&quot;; then 
&gt;      suf=0 
&gt;      while [ -e $hash.$suf ]; do suf=$(( $suf + 1 )); done 
&gt;      ln -s &quot;$c&quot; $hash.$suf 
&gt;    fi 
&gt;    if egrep -q -- '-BEGIN X509 CRL-' &quot;$c&quot;; then 
&gt;      suf=0 
&gt;      while [ -e $hash.r$suf ]; do suf=$(( $suf + 1 )); done 
&gt;      ln -s &quot;$c&quot; $hash.r$suf 
&gt;    fi 
&gt; done</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/ssl.html">ssl(3)</a>, <a class="link-man" href="../html3/SSL_CTX_add_extra_chain_cert.html">SSL_CTX_add_extra_chain_cert(3)</a>, <a class="link-man" href="../html3/SSL_CTX_set_cert_store.html">SSL_CTX_set_cert_store(3)</a>, <a class="link-man" href="../html3/SSL_CTX_set_client_CA_list.html">SSL_CTX_set_client_CA_list(3)</a>, <a class="link-man" href="../html3/SSL_CTX_use_certificate.html">SSL_CTX_use_certificate(3)</a>, <a class="link-man" href="../html3/SSL_get_client_CA_list.html">SSL_get_client_CA_list(3)</a></div>
</div>
</body>
</html>

