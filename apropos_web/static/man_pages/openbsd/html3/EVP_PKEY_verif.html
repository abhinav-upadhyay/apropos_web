<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
EVP_PKEY_VERIFY(3)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
EVP_PKEY_VERIFY(3)</td>
<td class="head-vol">
OpenSSL</td>
<td class="head-rtitle">
EVP_PKEY_VERIFY(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> EVP_PKEY_verify_init, EVP_PKEY_verify - signature verification using a public key algorithm</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
 #include &lt;openssl/evp.h&gt;<br/>
<br/>
 int EVP_PKEY_verify_init(EVP_PKEY_CTX *ctx);<br/>
 int EVP_PKEY_verify(EVP_PKEY_CTX *ctx,<br/>
                        const unsigned char *sig, size_t siglen,<br/>
                        const unsigned char *tbs, size_t tbslen);<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> The  <i>EVP_PKEY_verify_init()</i> function initializes a public key algorithm context using key  <b>pkey</b> for a signature verification operation.<div class="spacer">
</div>
The <i>EVP_PKEY_verify()</i> function performs a public key verification operation using  <b>ctx</b>. The signature is specified using the <b>sig</b> and  <b>siglen</b> parameters. The verified data (i.e. the data believed originally signed) is specified using the  <b>tbs</b> and <b>tbslen</b> parameters.</div>
<div class="section">
<h1>NOTES</h1> After the call to  <i>EVP_PKEY_verify_init()</i> algorithm specific control operations can be performed to set any appropriate parameters for the operation.<div class="spacer">
</div>
The function <i>EVP_PKEY_verify()</i> can be called more than once on the same context if several operations are performed using the same parameters.</div>
<div class="section">
<h1>RETURN VALUES</h1>  <i>EVP_PKEY_verify_init()</i> and <i>EVP_PKEY_verify()</i> return 1 if the verification was successful and 0 if it failed. Unlike other functions the return value 0 from  <i>EVP_PKEY_verify()</i> only indicates that the signature did not verify successfully (that is tbs did not match the original data or the signature was of invalid form) it is not an indication of a more serious error.<div class="spacer">
</div>
A negative value indicates an error other that signature verification failure. In particular a return value of -2 indicates the operation is not supported by the public key algorithm.</div>
<div class="section">
<h1>EXAMPLE</h1> Verify signature using PKCS#1 and SHA256 digest:<div class="spacer">
</div>
<br/>
 #include &lt;openssl/evp.h&gt;<br/>
 #include &lt;openssl/rsa.h&gt;<br/>
<br/>
 EVP_PKEY_CTX *ctx;<br/>
 unsigned char *md, *sig;<br/>
 size_t mdlen, siglen;<br/>
 EVP_PKEY *verify_key;<br/>
 /* NB: assumes verify_key, sig, siglen md and mdlen are already set up<br/>
  * and that verify_key is an RSA public key<br/>
  */<br/>
 ctx = EVP_PKEY_CTX_new(verify_key);<br/>
 if (!ctx)<br/>
        /* Error occurred */<br/>
 if (EVP_PKEY_verify_init(ctx) &lt;= 0)<br/>
        /* Error */<br/>
 if (EVP_PKEY_CTX_set_rsa_padding(ctx, RSA_PKCS1_PADDING) &lt;= 0)<br/>
        /* Error */<br/>
 if (EVP_PKEY_CTX_set_signature_md(ctx, EVP_sha256()) &lt;= 0)<br/>
        /* Error */<br/>
<br/>
 /* Perform operation */<br/>
 ret = EVP_PKEY_verify(ctx, sig, siglen, md, mdlen);<br/>
<br/>
 /* ret == 1 indicates success, 0 verify failure and &lt; 0 for some<br/>
  * other error.<br/>
  */<br/>
</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>EVP_PKEY_CTX_new</i>(3),  <i>EVP_PKEY_encrypt</i>(3),  <i>EVP_PKEY_decrypt</i>(3),  <i>EVP_PKEY_sign</i>(3),  <i>EVP_PKEY_verify_recover</i>(3),  <i>EVP_PKEY_derive</i>(3)</div>
<div class="section">
<h1>HISTORY</h1> These functions were first added to OpenSSL 1.0.0.</div>
<table class="foot">
<tr>
<td class="foot-date">
2015-07-26</td>
<td class="foot-os">
OpenBSD 6.0</td>
</tr>
</table>
</div>
</body>
</html>

