<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
RADIUS_NEW_REQUEST_PACKET(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">radius_new_request_packet</b>, <b class="name">radius_new_response_packet</b>, <b class="name">radius_convert_packet</b>, <b class="name">radius_delete_packet</b>, <b class="name">radius_get_id</b>, <b class="name">radius_get_code</b>, <b class="name">radius_get_authenticator</b>, <b class="name">radius_get_authenticator_retval</b>, <b class="name">radius_get_length</b>, <b class="name">radius_update_id</b>, <b class="name">radius_set_id</b>, <b class="name">radius_set_request_packet</b>, <b class="name">radius_get_request_packet</b>, <b class="name">radius_set_response_authenticator</b>, <b class="name">radius_check_response_authenticator</b>, <b class="name">radius_set_accounting_request_authenticator</b>, <b class="name">radius_check_accounting_request_authenticator</b>, <b class="name">radius_get_request_authenticator_retval</b>, <b class="name">radius_get_data</b>, <b class="name">radius_get_raw_attr</b>, <b class="name">radius_put_raw_attr</b>, <b class="name">radius_get_raw_attr_cat</b>, <b class="name">radius_put_raw_attr_cat</b>, <b class="name">radius_get_raw_attr_ptr</b>, <b class="name">radius_set_raw_attr</b>, <b class="name">radius_del_attr_all</b>, <b class="name">radius_has_attr</b>, <b class="name">radius_get_vs_raw_attr</b>, <b class="name">radius_put_vs_raw_attr</b>, <b class="name">radius_get_vs_raw_attr_cat</b>, <b class="name">radius_put_vs_raw_attr_cat</b>, <b class="name">radius_get_vs_raw_attr_ptr</b>, <b class="name">radius_set_vs_raw_attr</b>, <b class="name">radius_del_vs_attr_all</b>, <b class="name">radius_has_vs_attr</b>, <b class="name">radius_get_uint16_attr</b>, <b class="name">radius_get_uint32_attr</b>, <b class="name">radius_get_uint64_attr</b>, <b class="name">radius_get_ipv4_attr</b>, <b class="name">radius_get_ipv6_attr</b>, <b class="name">radius_put_uint16_attr</b>, <b class="name">radius_put_uint32_attr</b>, <b class="name">radius_put_uint64_attr</b>, <b class="name">radius_put_ipv4_attr</b>, <b class="name">radius_put_ipv6_attr</b>, <b class="name">radius_set_uint16_attr</b>, <b class="name">radius_set_uint32_attr</b>, <b class="name">radius_set_uint64_attr</b>, <b class="name">radius_set_ipv4_attr</b>, <b class="name">radius_set_ipv6_attr</b>, <b class="name">radius_get_string_attr</b>, <b class="name">radius_put_string_attr</b>, <b class="name">radius_get_vs_uint16_attr</b>, <b class="name">radius_get_vs_uint32_attr</b>, <b class="name">radius_get_vs_uint64_attr</b>, <b class="name">radius_get_vs_ipv4_attr</b>, <b class="name">radius_get_vs_ipv6_attr</b>, <b class="name">radius_put_vs_uint16_attr</b>, <b class="name">radius_put_vs_uint32_attr</b>, <b class="name">radius_put_vs_uint64_attr</b>, <b class="name">radius_put_vs_ipv4_attr</b>, <b class="name">radius_put_vs_ipv6_attr</b>, <b class="name">radius_set_vs_uint16_attr</b>, <b class="name">radius_set_vs_uint32_attr</b>, <b class="name">radius_set_vs_uint64_attr</b>, <b class="name">radius_set_vs_ipv4_attr</b>, <b class="name">radius_set_vs_ipv6_attr</b>, <b class="name">radius_get_vs_string_attr</b>, <b class="name">radius_put_vs_string_attr</b>, <b class="name">radius_put_message_authenticator</b>, <b class="name">radius_set_message_authenticator</b>, <b class="name">radius_check_message_authenticator</b>, <b class="name">radius_encrypt_user_password_attr</b>, <b class="name">radius_decrypt_user_password_attr</b>, <b class="name">radius_encrypt_mppe_key_attr</b>, <b class="name">radius_decrypt_mppe_key_attr</b>, <b class="name">radius_get_user_password_attr</b>, <b class="name">radius_put_user_password_attr</b>, <b class="name">radius_get_mppe_send_key_attr</b>, <b class="name">radius_put_mppe_send_key_attr</b>, <b class="name">radius_get_mppe_recv_key_attr</b>, <b class="name">radius_put_mppe_recv_key_attr</b>, <b class="name">radius_get_eap_msk</b>, <b class="name">radius_send</b>, <b class="name">radius_sendmsg</b>, <b class="name">radius_sendto</b>, <b class="name">radius_recv</b>, <b class="name">radius_recvfrom</b>, <b class="name">radius_recvmsg</b>, <b class="name">radius</b> &#8212; <span class="desc">manipulate RADIUS packets for RADIUS clients/servers</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/types.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">sys/socket.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">netinet/in.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">stdbool.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">radius.h</a>&gt;</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">radius</b> provides a facility to manipulate RADIUS packets and some helper functions.</div>
<div class="section">
<h1 id="x4352454154494e4720414e442044455354524f59494e47205041434b455453">CREATING AND DESTROYING PACKETS</h1> RADIUS packet objects are created by <b class="fname">radius_new_request_packet</b>(), <b class="fname">radius_new_response_packet</b>() or <b class="fname">radius_convert_packet</b>(). The authenticator field of the packet that is returned by <b class="fname">radius_new_request_packet</b>() and <b class="fname">radius_new_response_packet</b>() is filled with random bytes.<div class="spacer">
</div>
You must call <b class="fname">radius_delete_packet</b>() to free memory associated with the packet object.</div>
<div class="section">
<h1 id="x484541444552204143434553534f52">HEADER ACCESSOR</h1> <b class="fname">radius_get_id</b>(), <b class="fname">radius_get_code</b>(), <b class="fname">radius_get_authenticator</b>(), <b class="fname">radius_get_authenticator_retval</b>() and <b class="fname">radius_get_length</b>() retrieves the specified property of the packet. <b class="fname">radius_update_id</b>() updates a packet's ID field with an internal ID counter. <b class="fname">radius_set_id</b>() sets a packet's ID field.<div class="spacer">
</div>
<b class="fname">radius_set_request_packet</b>() associates a request packet to a response packet. The associated request packet can be retrieved by <b class="fname">radius_get_request_packet</b>().<div class="spacer">
</div>
<b class="fname">radius_set_response_authenticator</b>() sets a response authenticator to a response packet. <b class="fname">radius_check_response_authenticator</b>() checks the response authenticator of a response packet. The request packet must be associated with a response packet by <b class="fname">radius_new_response_packet</b>() or <b class="fname">radius_set_request_packet</b>().<div class="spacer">
</div>
<b class="fname">radius_set_accounting_request_authenticator</b>() sets a request authenticator to an accounting request packet. <b class="fname">radius_check_accounting_request_authenticator</b>() checks a request authenticator of an accounting request packet.<div class="spacer">
</div>
<b class="fname">radius_get_request_authenticator_retval</b>() returns the authenticator field of the packet if the argument is a request packet, and returns that of the associated request packet if the argument is a response packet.<div class="spacer">
</div>
<b class="fname">radius_get_data</b>() returns packet data itself.</div>
<div class="section">
<h1 id="x52415720415454524942555445204143434553534f52">RAW ATTRIBUTE ACCESSOR</h1> <b class="fname">radius_get_raw_attr</b>() retrieves an attribute value. <i class="farg">length</i> is a value-result parameter, initially containing the size of the buffer and modified on return to indicate the size of the value returned. If the buffer size is not sufficient, the returned value is truncated.<div class="spacer">
</div>
<b class="fname">radius_put_raw_attr</b>() appends attribute data to the end of the packet. If buffer size is larger than the maximum size of a single attribute, the function returns an error.<div class="spacer">
</div>
<b class="fname">radius_get_raw_attr_cat</b>() retrieves an attribute value. Unlike <b class="fname">radius_get_raw_attr</b>(), <b class="fname">radius_get_raw_attr_cat</b>() retrieves ALL attribute values that have the specified attribute type concatenated. If the buffer size is not sufficient, the function returns an error. If <i class="farg">buf</i> is <span class="define">NULL</span>, the initial value of <i class="farg">length</i> is ignored and the actual size of concatenated values is returned.<div class="spacer">
</div>
<b class="fname">radius_put_raw_attr_cat</b>() appends attribute data to the last of the packet. Unlike <b class="fname">radius_put_raw_attr</b>(), <b class="fname">radius_put_raw_attr_cat</b>() divides data into multiple attributes and appends them if the buffer size is larger than the maximum size of a single attribute. Note that packet objects may be broken (but can be deleted normally by <b class="fname">radius_delete_packet</b>()) if this function has returned an error.<div class="spacer">
</div>
<b class="fname">radius_get_raw_attr_ptr</b>() retrieves a pointer and length of specified attribute. The returned buffer must not be modified.<div class="spacer">
</div>
<b class="fname">radius_set_raw_attr</b>() overwrites existing an attribute value. If the specified attribute does not exist, this function returns an error. If <i class="farg">length</i> is different from the length of the specified attribute, the function returns an error.<div class="spacer">
</div>
<b class="fname">radius_del_attr_all</b>() deletes all attributes matching its arguments.<div class="spacer">
</div>
<b class="fname">radius_has_attr</b>() returns whether packet has a specified attribute.<div class="spacer">
</div>
<b class="fname">radius_get_vs_raw_attr</b>(), <b class="fname">radius_put_vs_raw_attr</b>(), <b class="fname">radius_get_vs_raw_attr_cat</b>(), <b class="fname">radius_put_vs_raw_attr_cat</b>(), <b class="fname">radius_get_vs_raw_attr_ptr</b>(), <b class="fname">radius_set_vs_raw_attr</b>(), <b class="fname">radius_del_vs_attr_all</b>() and <b class="fname">radius_has_vs_attr</b>() are vendor-specific versions of raw attribute accessors.</div>
<div class="section">
<h1 id="x545950454420415454524942555445204143434553534f52">TYPED ATTRIBUTE ACCESSOR</h1> To make code simple, there are many typed attribute accessors. <b class="name">radius</b> provides typed accessors for <code class="lit">uint16_t</code>, <code class="lit">uint32_t</code>, <code class="lit">uint64_t</code>, <code class="lit">struct in_addr</code> and <code class="lit">struct in6_addr</code>. Byte endian may be appropriately swapped for <code class="lit">uint16_t</code>, <code class="lit">uint32_t</code> and <code class="lit">uint64_t</code>.<div class="spacer">
</div>
These typed accessors do not requires <i class="farg">length</i> parameters because length is implied by the type. For &quot;get&quot; functions, if the actual attribute size is different from the size of the type, the functions returns an error.<div class="spacer">
</div>
There are also typed accessors for string (<code class="lit">char *</code>). For &quot;get&quot; functions for strings, the returned string is always NUL-terminated even if buffer size is smaller than actual attribute size. This behavior is similar to <b class="fname">strlcpy</b>().</div>
<div class="section">
<h1 id="x4d4553534147452041555448454e54494341544f52">MESSAGE AUTHENTICATOR</h1> There are helper functions for Message-Authenticator attributes.<div class="spacer">
</div>
<b class="fname">radius_put_message_authenticator</b>() and <b class="fname">radius_set_message_authenticator</b>() calculate a Message-Authenticator and put or set it to packet, respectively.<div class="spacer">
</div>
<b class="fname">radius_check_message_authenticator</b>() checks a Message-Authenticator.<div class="spacer">
</div>
The request packet must be associated with a response packet by <b class="fname">radius_new_response_packet</b>() or <b class="fname">radius_set_request_packet</b>(), otherwise the packet is treated as a request packet.</div>
<div class="section">
<h1 id="x454e4352595054454420415454524942555445">ENCRYPTED ATTRIBUTE</h1> There are helper functions for encrypted attributes.<div class="spacer">
</div>
<b class="fname">radius_encrypt_user_password_attr</b>(), <b class="fname">radius_decrypt_user_password_attr</b>(), <b class="fname">radius_encrypt_mppe_key_attr</b>() and <b class="fname">radius_decrypt_mppe_key_attr</b>() encrypt or decrypt User-Password attribute or MS-MPPE-{Send,Recv}-Key attributes respectively.<div class="spacer">
</div>
<b class="fname">radius_get_user_password_attr</b>(), <b class="fname">radius_put_user_password_attr</b>(), <b class="fname">radius_get_mppe_send_key_attr</b>(), <b class="fname">radius_put_mppe_send_key_attr</b>(), <b class="fname">radius_get_mppe_recv_key_attr</b>() and <b class="fname">radius_put_mppe_recv_key_attr</b>() are shortcuts of combination of encrypt/decrypt functions and get/put functions.<div class="spacer">
</div>
<b class="fname">radius_get_eap_msk</b>() retrieves a Master Session Key (MSK) for Extensible Authentication Protocol (EAP). Currently retrieving an MSK from MS-MPPE key attributes is supported.</div>
<div class="section">
<h1 id="x53454e44494e4720414e4420524543454956494e47205041434b455453">SENDING AND RECEIVING PACKETS</h1> There are helper functions for sending and receiving packets.<div class="spacer">
</div>
<b class="fname">radius_send</b>(), <b class="fname">radius_sendto</b>(), <b class="fname">radius_sendmsg</b>(), <b class="fname">radius_recv</b>(), <b class="fname">radius_recvfrom</b>() and <b class="fname">radius_recvmsg</b>() are helper version of <b class="fname">send</b>(), <b class="fname">sendto</b>(), <b class="fname">sendmsg</b>(), <b class="fname">recv</b>(), <b class="fname">recvfrom</b>() and <b class="fname">recvmsg</b>(), respectively.<div class="spacer">
</div>
<b class="fname">radius_send</b>(), <b class="fname">radius_sendto</b>() and <b class="fname">radius_sendmsg</b>() return 0 on success and nonzero on failure.<div class="spacer">
</div>
<b class="fname">radius_recv</b>() <b class="fname">radius_recvfrom</b>() and <b class="fname">radius_recvmsg</b>() return the received packet on success and return NULL on failure.<div class="spacer">
</div>
Note that <code class="lit">msg_iov</code> must be <code class="lit">NULL</code> and <code class="lit">msg_iovlen</code> must be zero in case of <b class="fname">radius_sendmsg</b>() and <b class="fname">radius_recvmsg</b>().</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Functions that return int return 0 on success and nonzero on failure. Functions that return pointer return non-NULL pointer on success and NULL on failure.</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">radius+</b> library was first written by UMEZAWA Takeshi in 2002 for the ID gateway service of Internet Initiative Japan. YASUOKA Masahiko added support for Message-Authentication attributes in 2008. <span class="unix">OpenBSD</span> project rewrote C++ code to pure C code in 2010. The <b class="name">radius+</b> library was renamed <b class="name">radius</b> and moved to <i class="file">lib/</i> in 2013.</div>
</div>
</body>
</html>

