<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
TOKENINIT(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">activinit</b>, <b class="name">cryptoinit</b>, <b class="name">snkinit</b> &#8212; <span class="desc">modify or add user in ActivCard, CRYPTOCard, or SNK-004 authentication system</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 9.00ex;"/>
<col/>
<tbody>
<tr>
<td>
tokeninit</td>
<td>
[<span class="opt"><b class="flag">-fhsv</b></span>] [<span class="opt"><b class="flag">-m</b> <i class="arg">mode</i></span>] <i class="arg">user ...</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">tokeninit</b> utility may also be invoked by one of the following names: <b class="name">activinit</b>, <b class="name">cryptoinit</b>, or <b class="name">snkinit</b>. Depending on the name it was invoked as, it will initialize the system information to allow one to use the ActivCard, CRYPTOCard, or SNK-004 digital encryption token to login. The <b class="name">tokeninit</b> utility is intended for use by the system administrator.<div class="spacer">
</div>
Token card systems provide strong user authentication by combining a user's unique knowledge (a Personal Identification Number) and a physical object (the token) which the user must have in their possession to login. The system administrator programs the token with a secret encryption key which is also stored in the database. The user programs the token with a PIN. To discourage exhaustive attempts to guess the PIN, configuration options permit the token to be programmed to erase knowledge of the shared secret should the user enter an excessive number of incorrect PIN entries.<div class="spacer">
</div>
The user activates the token by entering their PIN into the token. After activating the token, the user enters a random number challenge presented by the host computer into the token. The challenge is encrypted by the token and a response is displayed. The user then enters the response at the host computer's prompt, where it is compared with the anticipated response.<div class="spacer">
</div>
Token cards typically support multiple unique encryption keys. This facility allows a single token to be used for multiple computer systems, or multiple user instances on the same system.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-f</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Force reinitialization of an existing account. The current shared secret stored in the database will be replaced with a new shared secret. The new shared secret must be entered into the token, replacing the current one.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-h</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Read the shared secret as a 16 digit hexadecimal integer rather than a sequence of 8 octets. This is not supported when invoked as <b class="name">snkinit</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-m</b> <i class="arg">mode</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the input modes allowed for this user. Possible modes are decimal (dec), hexadecimal (hex), phonebook (phone), and reduced-input (rim). Not all modes are available for all types of cards. Multiple <b class="flag">-m</b> options may be specified to enable multiple modes. By default only the hexadecimal mode is enabled, except for the SNK-004 token, which by default only enables the decimal mode. If an attempt is made to initialize a card with only reduced-input, the default mode for the card is silently included.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-s</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default, <b class="name">tokeninit</b> prompts for a shared secret to enter into the authentication database. The <b class="flag">-s</b> option generates a 64-bit cryptographically strong key for use in the token. This shared secret will be saved in the database for the user ID specified on the command line. After entering the shared secret into the token, determine that the checksum computed by the token matches the one displayed by <b class="name">tokeninit</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-v</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable verbose mode. <b class="name">tokeninit</b> will emit messages on the status of each user ID processed.</dd>
</dl>
</div>
<div class="section">
<h1 id="x524544554345441e494e505554204d4f4445">REDUCED-INPUT MODE</h1> Reduced-input mode allows the token to predict the next challenge, given the current challenge. This may be used to eliminate the need to enter the challenge to the token or may also be used with a paper list. Using a program such as <a class="link-man" href="../html1/x99token.html">x99token(1)</a> many challenges could be precomputed and printed. This list should be kept secret. This list can then take the place of an actual token until the system has issued all the challenges printed. Challenges are predicted by the following algorithm:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
* Encrypt the last challenge with the shared secret key 
 
* AND each byte of the response with 0x0f 
 
* Modulo each byte by 10 (0x0a) 
 
* ADD 0x30 (ASCII value of '0') to each byte</pre>
<div class="spacer">
</div>
The resulting 8 bytes are all ASCII decimal digits and are the next challenge.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/activ.db</i></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
database of information for ActivCard system</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/crypto.db</i></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
database of information for CRYPTOCard system</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/snk.db</i></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
database of information for SNK-004 system</dd>
</dl>
</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> Diagnostic messages are logged via <a class="link-man" href="../html3/syslog.html">syslog(3)</a> with the LOG_AUTH facility.</div>
<div class="section">
<h1 id="x434f4d4d454e5453">COMMENTS</h1> A supplier for ActivCard tokens may be obtained by contacting:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
ActivCard, Inc. 
303 Twin Dolphin Dr., Ste 420 
Redwood City, CA 94065 
Tel: (415) 654-1700 
Fax: (415) 654-1701</pre>
<div class="spacer">
</div>
CRYPTOCard tokens may be obtained by contacting:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
CRYPTOCard Incorporated 
Attn: Wade Clark 
1649 Barclay Blvd. 
Buffalo Grove, Illinois 60089 
Tel: (800) 307-7042 / (708) 459-6500 
Fax: (708) 459-6599 
&lt;token@cryptocard.com&gt;</pre>
<div class="spacer">
</div>
SNK-004 tokens are no longer available for purchase.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/x99token.html">x99token(1)</a>, <a class="link-man" href="../html3/syslog.html">syslog(3)</a>, <a class="link-man" href="../html8/login_token.html">login_token(8)</a>, <a class="link-man" href="../html8/tokenadm.html">tokenadm(8)</a></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Jack Flory</span> &lt;<a class="link-mail" href="mailto:jpf@mig.com">jpf@mig.com</a>&gt;</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Not all modes of all cards are supported.</div>
</div>
</body>
</html>

