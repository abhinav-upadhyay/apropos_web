<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
MTREE(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">mtree</b> &#8212; <span class="desc">map a directory hierarchy</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 5.00ex;"/>
<col/>
<tbody>
<tr>
<td>
mtree</td>
<td>
[<span class="opt"><b class="flag">-cdeilnqrtUux</b></span>] [<span class="opt"><b class="flag">-f</b>&#160;<i class="arg">spec</i></span>] [<span class="opt"><b class="flag">-K</b>&#160;<i class="arg">keywords</i></span>] [<span class="opt"><b class="flag">-k</b>&#160;<i class="arg">keywords</i></span>] [<span class="opt"><b class="flag">-p</b>&#160;<i class="arg">path</i></span>] [<span class="opt"><b class="flag">-s</b>&#160;<i class="arg">seed</i></span>]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The utility <b class="name">mtree</b> compares the file hierarchy rooted in the current directory against a specification read from the standard input. Messages are written to the standard output for any files whose characteristics do not match the specification, or which are missing from either the file hierarchy or the specification. For an explanation of the directory hierarchy, see <a class="link-man" href="../html7/hier.html">hier(7)</a>.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-c</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print a specification for the file hierarchy to the standard output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Ignore everything except directory type files.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-e</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't complain about files that are in the file hierarchy, but not in the specification.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-f</b> <i class="arg">spec</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Read the specification from file <i class="arg">spec</i>, instead of from the standard input.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-i</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Indents the output 4 spaces each time a directory level is descended when creating a specification with the <b class="flag">-c</b> option. This does not affect either the /set statements or the comment before each directory. It does however affect the comment before the close of each directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-K</b> <i class="arg">keywords</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Add the specified (whitespace or comma separated) keywords to the current set of keywords.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-k</b> <i class="arg">keywords</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the &#8220;type&#8221; keyword plus the specified (whitespace or comma separated) keywords instead of the current set of keywords.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-l</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Do &#8220;loose&#8221; permissions checks, in which more stringent permissions will match less stringent ones. For example, a file marked mode 0444 will pass a check for mode 0644. &#8220;Loose&#8221; checks apply only to read, write and execute permissions -- in particular, if other bits like the sticky bit or suid/sgid bits are set either in the specification or the file, exact checking will be performed. This flag may not be set at the same time as the <b class="flag">-u</b> or <b class="flag">-U</b> flags.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-n</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Do not emit pathname comments when creating a specification. Normally a comment is emitted before each directory and before the close of that directory when using the <b class="flag">-c</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-p</b> <i class="arg">path</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the file hierarchy rooted in <i class="arg">path</i>, instead of the current directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-q</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Quiet mode. Do not complain when a &#8220;missing&#8221; directory cannot be created because it already exists. This occurs when the directory is a symbolic link.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-r</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Remove any files in the file hierarchy that are not described in the specification.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-s</b> <i class="arg">seed</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Display a single checksum to the standard error output that represents all of the files for which the keyword <b class="flag">cksum</b> was specified. The checksum is seeded with the specified value.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-t</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If a file's timestamp is different from the specification, &#8220;touch&#8221; it to match the specification (and list as modified).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-U</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Modify the owner, group, and permissions of existing files to match the specification and create any missing directories. User, group, and permissions must all be specified for missing directories to be created. Exit with a status of 0 on success, 1 if any error occurred; a mismatch is not considered an error if it was corrected.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-u</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Same as the <b class="flag">-U</b> option except a status of 2 is returned if the file hierarchy did not match the specification.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-x</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't descend below mount points in the file hierarchy.</dd>
</dl>
<div class="spacer">
</div>
Specifications are mostly composed of &#8220;keywords&#8221; (i.e., strings that specify values relating to files). No keywords have default values, and if a keyword has no value set, no checks based on it are performed.<div class="spacer">
</div>
Currently supported keywords are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">cksum</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The checksum of the file using the default algorithm specified by the <a class="link-man" href="../html1/cksum.html">cksum(1)</a> utility.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">flags</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The current file's flags (whitespace or comma separated) in symbolic form as specified by <a class="link-man" href="../html1/chflags.html">chflags(1)</a>. The string &#8220;none&#8221; may be used to indicate that no flags should be set on the file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">gid</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The file group as a numeric value.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">gname</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The file group as a symbolic name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ignore</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Ignore any file hierarchy below this file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">link</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The file the symbolic link is expected to reference.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">md5digest</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The MD5 message digest of the file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">mode</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The current file's permissions as a numeric (octal) or symbolic value.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">nlink</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The number of hard links the file is expected to have.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">nochange</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Do not change the attributes (owner, group, mode, etc) on a file or directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">optional</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The file is optional; don't complain about the file if it's not in the file hierarchy.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rmd160digest</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The RIPEMD-160 message digest of the file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">sha1digest</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The SHA-1 message digest of the file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">sha256digest</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The SHA-256 message digest of the file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">size</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The size, in bytes, of the file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">time</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The last modification time of the file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">type</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The type of the file; may be set to any one of the following:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">block</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
block special device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">char</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
character special device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">dir</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
directory</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">fifo</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
FIFO</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">file</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
regular file</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">link</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
symbolic link</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">socket</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
socket</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">uid</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The file owner as a numeric value.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">uname</b></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
The file owner as a symbolic name.</dd>
</dl>
<div class="spacer">
</div>
The default set of keywords are <b class="flag">gid</b>, <b class="flag">mode</b>, <b class="flag">nlink</b>, <b class="flag">size</b>, <b class="flag">link</b>, <b class="flag">time</b>, and <b class="flag">uid</b>.<div class="spacer">
</div>
There are four types of lines in a specification.<div class="spacer">
</div>
The first type of line sets a global value for a keyword, and consists of the string &#8220;/set&#8221; followed by whitespace, followed by sets of keyword/value pairs, separated by whitespace. Keyword/value pairs consist of a keyword, followed by an equals sign (&#8216;=&#8217;), followed by a value, without whitespace characters. Once a keyword has been set, its value remains unchanged until either reset or unset.<div class="spacer">
</div>
The second type of line unsets keywords and consists of the string &#8220;/unset&#8221;, followed by whitespace, followed by one or more keywords, separated by whitespace.<div class="spacer">
</div>
The third type of line is a file specification and consists of a file name, followed by whitespace, followed by zero or more whitespace separated keyword/value pairs. The file name may be preceded by whitespace characters. The file name may contain any of the standard file name matching characters (&#8220;[&#8221;, &#8220;]&#8221;, &#8220;?&#8221;, or &#8220;*&#8221;), in which case files in the hierarchy will be associated with the first pattern that they match.<div class="spacer">
</div>
Each of the keyword/value pairs consist of a keyword, followed by an equals sign, followed by the keyword's value, without whitespace characters. These values override, without changing, the global value of the corresponding keyword.<div class="spacer">
</div>
All paths are relative. Specifying a directory will cause subsequent files to be searched for in that directory hierarchy. Which brings us to the last type of line in a specification: a line containing only the string &#8220;..&#8221; causes the current directory path to ascend one level.<div class="spacer">
</div>
Empty lines and lines whose first non-whitespace character is a hash mark (&#8216;#&#8217;) are ignored.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/mtree</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
system specification directory</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558495420535441545553">EXIT STATUS</h1> The <b class="name">mtree</b> utility exits with a status of 0 on success, 1 if any error occurred, and 2 if the file hierarchy did not match the specification. A status of 2 is converted to a status of 0 if the <b class="flag">-U</b> option is used.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> To detect system binaries that have been &#8220;trojan horsed&#8221;, it is recommended that <b class="name">mtree</b> <b class="flag">-cK</b> <b class="flag">sha256digest</b> be run on the file systems, and a copy of the results stored on a different machine or, at least, in encrypted form. The output file itself should be digested using the <a class="link-man" href="../html1/sha256.html">sha256(1)</a> utility. Then, periodically, <b class="name">mtree</b> and <a class="link-man" href="../html1/sha256.html">sha256(1)</a> should be run against the on-line specifications. While it is possible for the bad guys to change the on-line specifications to conform to their modified binaries, it is believed to be impractical for them to create a modified specification which has the same SHA-256 digest as the original.<div class="spacer">
</div>
The <b class="flag">-d</b> and <b class="flag">-u</b> options can be used in combination to create directory hierarchies for distributions and other such things; the files in <i class="file">/etc/mtree</i> were used to create almost all directories in a normal binary distribution.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/chgrp.html">chgrp(1)</a>, <a class="link-man" href="../html1/chmod.html">chmod(1)</a>, <a class="link-man" href="../html1/cksum.html">cksum(1)</a>, <a class="link-man" href="../html1/md5.html">md5(1)</a>, <a class="link-man" href="../html2/stat.html">stat(2)</a>, <a class="link-man" href="../html3/fts.html">fts(3)</a>, <a class="link-man" href="../html3/md5.html">md5(3)</a>, <a class="link-man" href="../html3/rmd160.html">rmd160(3)</a>, <a class="link-man" href="../html3/sha1.html">sha1(3)</a>, <a class="link-man" href="../html3/sha2.html">sha2(3)</a>, <a class="link-man" href="../html7/hier.html">hier(7)</a>, <a class="link-man" href="../html8/chown.html">chown(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">mtree</b> utility appeared in <span class="unix">4.3BSD-Reno</span>.</div>
</div>
</body>
</html>

