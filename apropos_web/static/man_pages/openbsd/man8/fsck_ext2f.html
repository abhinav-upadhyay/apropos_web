<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
FSCK_EXT2FS(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">fsck_ext2fs</b> &#8212; <span class="desc">Second Extended File System consistency check and interactive repair</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 11.00ex;"/>
<col/>
<tbody>
<tr>
<td>
fsck_ext2fs</td>
<td>
[<span class="opt"><b class="flag">-dfnpy</b></span>] [<span class="opt"><b class="flag">-b</b> <i class="arg">block#</i></span>] [<span class="opt"><b class="flag">-m</b> <i class="arg">mode</i></span>] <i class="arg">filesystem</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">fsck_ext2fs</b> performs interactive file system consistency checks and repairs the filesystem specified. It is normally invoked from <a class="link-man" href="../html8/fsck.html">fsck(8)</a>.<div class="spacer">
</div>
The kernel takes care that only a restricted class of innocuous file system inconsistencies can happen unless hardware or software failures intervene. These are limited to the following:<div class="spacer">
</div>
<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-item">
<li class="list-item" style="margin-top: 0.00em;">
Unreferenced inodes</li>
<li class="list-item" style="margin-top: 0.00em;">
Link counts in inodes too large</li>
<li class="list-item" style="margin-top: 0.00em;">
Missing blocks in the free map</li>
<li class="list-item" style="margin-top: 0.00em;">
Blocks in the free map also in files</li>
<li class="list-item" style="margin-top: 0.00em;">
Counts in the super-block wrong</li>
</ul>
<div class="spacer">
</div>
These are the only inconsistencies that <b class="name">fsck_ext2fs</b> in &#8220;preen&#8221; mode (with the <b class="flag">-p</b> option) will correct; if it encounters other inconsistencies, it exits with an abnormal return status. For each corrected inconsistency one or more lines will be printed identifying the file system on which the correction will take place, and the nature of the correction. After successfully correcting a file system, <b class="name">fsck_ext2fs</b> will print the number of files on that file system and the number of used and free blocks.<div class="spacer">
</div>
If sent a <span class="define">QUIT</span> signal, <b class="name">fsck_ext2fs</b> will finish the file system checks, then exit with an abnormal return status.<div class="spacer">
</div>
Without the <b class="flag">-p</b> option, <b class="name">fsck_ext2fs</b> audits and interactively repairs inconsistent conditions for the filesystem. If the file system is inconsistent, the operator is prompted for concurrence before each correction is attempted. It should be noted that some of the corrective actions which are not correctable under the <b class="flag">-p</b> option will result in some loss of data. The amount and severity of data lost may be determined from the diagnostic output. The default action for each consistency correction is to wait for the operator to respond &#8220;yes&#8221; or &#8220;no&#8221;. If the operator does not have write permission on the file system, <b class="name">fsck_ext2fs</b> will default to a <b class="flag">-n</b> action.<div class="spacer">
</div>
The following flags are interpreted by <b class="name">fsck_ext2fs</b>:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-b</b> <i class="arg">block#</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the block specified immediately after the flag as the super block for the file system. Block 8193 is usually an alternate super block.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Print debugging output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-f</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Force checking of the filesystem. Normally, if a file system is cleanly unmounted, the kernel will set a &#8220;clean flag&#8221; in the file system superblock and <b class="name">fsck_ext2fs</b> will not check the file system. This option forces <b class="name">fsck_ext2fs</b> to check the file system, regardless of the state of the clean flag.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-m</b> <i class="arg">mode</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the <i class="arg">mode</i> specified in octal as the permission bits to use when creating the <i class="file">lost+found</i> directory rather than the default 1777. In particular, systems that do not wish to have lost files accessible by all users on the system should use a more restrictive set of permissions such as 700.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-n</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Assume a &#8220;no&#8221; response to all questions asked by <b class="name">fsck_ext2fs</b> except for &#8220;CONTINUE?&#8221;, which is assumed to be affirmative. The filesystem will not be opened for writing. This is the default for file systems to be checked that are concurrently mounted writable.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-p</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify &#8220;preen&#8221; mode, described above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-y</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Assume a &#8220;yes&#8221; response to all questions asked by <b class="name">fsck_ext2fs</b>; this should be used with great caution as this is a free license to continue after essentially unlimited trouble has been encountered.</dd>
</dl>
<div class="spacer">
</div>
If neither of the <b class="flag">-y</b> or <b class="flag">-n</b> options are specified, the user may force <b class="name">fsck_ext2fs</b> to assume an answer of &#8220;yes&#8221; to all the remaining questions by replying to a question with a value of &#8220;F&#8221;.<div class="spacer">
</div>
Inconsistencies checked are as follows:<div class="spacer">
</div>
<ol style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-enum">
<li class="list-enum" style="margin-top: 0.00em;">
Blocks claimed more than once by inodes or the free map.</li>
<li class="list-enum" style="margin-top: 0.00em;">
Blocks claimed by an inode outside the range of the file system.</li>
<li class="list-enum" style="margin-top: 0.00em;">
Incorrect link counts.</li>
<li class="list-enum" style="margin-top: 0.00em;">
Size checks:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-item">
<li class="list-item" style="margin-top: 0.00em;">
Directory size not a multiple of file system block size.</li>
<li class="list-item" style="margin-top: 0.00em;">
Partially truncated file.</li>
</ul>
</li>
<li class="list-enum" style="margin-top: 0.00em;">
Bad inode format.</li>
<li class="list-enum" style="margin-top: 0.00em;">
Blocks not accounted for anywhere.</li>
<li class="list-enum" style="margin-top: 0.00em;">
Directory checks:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-item">
<li class="list-item" style="margin-top: 0.00em;">
File pointing to unallocated inode.</li>
<li class="list-item" style="margin-top: 0.00em;">
Inode number out of range.</li>
<li class="list-item" style="margin-top: 0.00em;">
Dot or dot-dot not the first two entries of a directory or having the wrong inode number.</li>
</ul>
</li>
<li class="list-enum" style="margin-top: 0.00em;">
Super Block checks:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-item">
<li class="list-item" style="margin-top: 0.00em;">
More blocks for inodes than there are in the file system.</li>
<li class="list-item" style="margin-top: 0.00em;">
Bad free block map format.</li>
<li class="list-item" style="margin-top: 0.00em;">
Total free block and/or free inode count incorrect.</li>
</ul>
</li>
</ol>
<div class="spacer">
</div>
Orphaned files and directories (allocated but unreferenced) are, with the operator's concurrence, reconnected by placing them in the <i class="file">lost+found</i> directory. The name assigned is the inode number. If the <i class="file">lost+found</i> directory does not exist, it is created. If there is insufficient space its size is increased.<div class="spacer">
</div>
Because of inconsistencies between the block device and the buffer cache, the raw device should always be used.</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> The diagnostics produced by <b class="name">fsck_ext2fs</b> are fully enumerated and explained in Appendix A of <span class="ref"><span class="ref-title">Fsck_ffs - The UNIX File System Check Program</span>.</span></div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html5/fs.html">fs(5)</a>, <a class="link-man" href="../html5/fstab.html">fstab(5)</a>, <a class="link-man" href="../html8/fsck.html">fsck(8)</a>, <a class="link-man" href="../html8/mount_ext2fs.html">mount_ext2fs(8)</a>, <a class="link-man" href="../html8/rc.html">rc(8)</a></div>
</div>
</body>
</html>

