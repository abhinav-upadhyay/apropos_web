<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
TCPDUMP(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">tcpdump</b> &#8212; <span class="desc">dump traffic on a network</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 7.00ex;"/>
<col/>
<tbody>
<tr>
<td>
tcpdump</td>
<td>
[<span class="opt"><b class="flag">-AadefILlNnOopqStvXx</b></span>] [<span class="opt"><b class="flag">-c</b> <i class="arg">count</i></span>] [<span class="opt"><b class="flag">-D</b> <i class="arg">direction</i></span>] [<span class="opt"><b class="flag">-E</b> [<span class="opt"><i class="arg">espalg</i>:</span>]<i class="arg">espkey</i></span>] [<span class="opt"><b class="flag">-F</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-i</b> <i class="arg">interface</i></span>] [<span class="opt"><b class="flag">-r</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-s</b> <i class="arg">snaplen</i></span>] [<span class="opt"><b class="flag">-T</b> <i class="arg">type</i></span>] [<span class="opt"><b class="flag">-w</b> <i class="arg">file</i></span>] [<span class="opt"><b class="flag">-y</b> <i class="arg">datalinktype</i></span>] [<span class="opt"><i class="arg">expression</i></span>]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">tcpdump</b> prints out the headers of packets on a network interface that match the boolean <i class="arg">expression</i>. You must have read access to <i class="file">/dev/bpf0</i>.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-A</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Print each packet in ASCII. If the <b class="flag">-e</b> option is also specified, the link-level header will be included. The smaller of the entire packet or <i class="arg">snaplen</i> bytes will be printed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-a</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Attempt to convert network and broadcast addresses to names.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-c</b> <i class="arg">count</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Exit after receiving <i class="arg">count</i> packets.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-D</b> <i class="arg">direction</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Select packets flowing in the specified <i class="arg">direction</i>. Valid directions are: <b class="flag">in</b> and <b class="flag">out</b>. The default is to accept packets flowing in any direction.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Dump the compiled packet-matching code in a human readable form to standard output and stop.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-dd</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Dump packet-matching code as a C program fragment.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-ddd</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Dump packet-matching code as decimal numbers preceded with a count.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-E</b> [<span class="opt"><i class="arg">espalg</i>:</span>]<i class="arg">espkey</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Try to decrypt RFC 4835 ESP (Encapsulating Security Payload) traffic using the specified hex key <i class="arg">espkey</i>. Supported algorithms for <i class="arg">espalg</i> are: <b class="flag">aes128</b>, <b class="flag">aes128-hmac96</b>, <b class="flag">blowfish</b>, <b class="flag">blowfish-hmac96</b>, <b class="flag">cast</b>, <b class="flag">cast-hmac96</b>, <b class="flag">des3</b>, <b class="flag">des3-hmac96</b>, <b class="flag">des</b> and <b class="flag">des-hmac96</b>. The algorithm defaults to <b class="flag">aes128-hmac96</b>. This option should be used for debugging only, since the key will show up in <a class="link-man" href="../html1/ps.html">ps(1)</a> output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-e</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Print the link-level header on each dump line.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-F</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Use <i class="arg">file</i> as input for the filter expression. Any additional expressions given on the command line are ignored.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-f</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Print &#8220;foreign&#8221; internet addresses numerically rather than symbolically. This option is intended to get around serious brain damage in Sun's yp server &#8212; usually it hangs forever translating non-local internet numbers.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-I</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Print the interface on each dump line.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-i</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Listen on <i class="arg">interface</i>. If unspecified, <b class="name">tcpdump</b> searches the system interface list for the lowest numbered, configured &#8220;up&#8221; interface (excluding loopback). Ties are broken by choosing the earliest match.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-L</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
List the supported data link types for the interface and exit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-l</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Make stdout line buffered. Useful if you want to see the data while capturing it. For example:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump -l | tee dat</code></div>
</blockquote>
or<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump -l &gt; dat &amp; tail -f dat</code></div>
</blockquote>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-N</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Do not print domain name qualification of host names. For example, if you specify this flag then <b class="name">tcpdump</b> will print &#8220;nic&#8221; instead of &#8220;nic.ddn.mil&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-n</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Do not convert addresses (host addresses, port numbers, etc.) to names.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-O</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Do not run the packet-matching code optimizer. This is useful only if you suspect a bug in the optimizer.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-o</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Print a guess of the possible operating system(s) of hosts that sent TCP SYN packets. See <a class="link-man" href="../html5/pf.os.html">pf.os(5)</a> for a description of the passive operating system fingerprints.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-p</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Do not put the interface into promiscuous mode. The interface might be in promiscuous mode for some other reason; hence, <b class="flag">-p</b> cannot be used as an abbreviation for &#8220;ether host &quot;{local-hw-addr}&quot;&#8221; or &#8220;ether broadcast&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-q</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Quick (quiet?) output. Print less protocol information so output lines are shorter.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-r</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Read packets from a <i class="arg">file</i> which was created with the <b class="flag">-w</b> option. Standard input is used if <i class="arg">file</i> is &#8216;<code class="lit">-</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-S</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Print absolute, rather than relative, TCP sequence numbers.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-s</b> <i class="arg">snaplen</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Analyze at most the first <i class="arg">snaplen</i> bytes of data from each packet rather than the default of 116. 116 bytes is adequate for IPv6, ICMP, TCP, and UDP, but may truncate protocol information from name server and NFS packets (see below). Packets truncated because of a limited <i class="arg">snaplen</i> are indicated in the output with &#8220;[<span class="opt">|<span class="emph">proto</span></span>]&#8221;, where <span class="emph">proto</span> is the name of the protocol level at which the truncation has occurred. Taking larger snapshots both increases the amount of time it takes to process packets and, effectively, decreases the amount of packet buffering. This may cause packets to be lost. You should limit <i class="arg">snaplen</i> to the smallest number that will capture the protocol information you're interested in.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-T</b> <i class="arg">type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Force packets selected by <i class="arg">expression</i> to be interpreted as the specified <i class="arg">type</i>. Currently known types are <b class="flag">vrrp</b> (Virtual Router Redundancy protocol), <b class="flag">cnfp</b> (Cisco NetFlow protocol), <b class="flag">rpc</b> (Remote Procedure Call), <b class="flag">rtp</b> (Real-Time Applications protocol), <b class="flag">rtcp</b> (Real-Time Applications control protocol), <b class="flag">sack</b> (RFC 2018 TCP Selective Acknowledgements Options), <b class="flag">tcp</b> (Transmission Control Protocol), <b class="flag">vat</b> (Visual Audio Tool), and <b class="flag">wb</b> (distributed White Board).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-t</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Do not print a timestamp on each dump line.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-tt</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Print an unformatted timestamp on each dump line.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-ttt</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Print day and month in timestamp.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-tttt</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Print timestamp difference between packets.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-ttttt</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Print timestamp difference since the first packet.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-v</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
(Slightly more) verbose output. For example, the time to live (TTL) and type of service (ToS) information in an IP packet are printed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-vv</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Even more verbose output. For example, additional fields are printed from NFS reply packets.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-w</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Write the raw packets to <i class="arg">file</i> rather than parsing and printing them out. They can be analyzed later with the <b class="flag">-r</b> option. Standard output is used if <i class="arg">file</i> is &#8216;<code class="lit">-</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-X</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Print each packet in hex and ASCII. If the <b class="flag">-e</b> option is also specified, the link-level header will be included. The smaller of the entire packet or <i class="arg">snaplen</i> bytes will be printed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-x</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Print each packet in hex. If the <b class="flag">-e</b> option is also specified, the link-level header will be included. The smaller of the entire packet or <i class="arg">snaplen</i> bytes will be printed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-y</b> <i class="arg">datalinktype</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Set the data link type to use while capturing to <i class="arg">datalinktype</i>. Commonly used types include <b class="flag">EN10MB</b>, <b class="flag">IEEE802_11</b>, and <b class="flag">IEEE802_11_RADIO</b>. The choices applicable to a particular device can be listed using <b class="flag">-L</b>.</dd>
</dl>
<div class="spacer">
</div>
<i class="arg">expression</i> selects which packets will be dumped. If no <i class="arg">expression</i> is given, all packets on the net will be dumped. Otherwise, only packets satisfying <i class="arg">expression</i> will be dumped.<div class="spacer">
</div>
The <i class="arg">expression</i> consists of one or more primitives. Primitives usually consist of an <i class="arg">id</i> (name or number) preceded by one or more qualifiers. There are three different kinds of qualifiers:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">type</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
Specify which kind of address component the <i class="arg">id</i> name or number refers to. Possible types are <b class="flag">host</b>, <b class="flag">net</b> and <b class="flag">port</b>. E.g., &#8220;host foo&#8221;, &#8220;net 128.3&#8221;, &#8220;port 20&#8221;. If there is no type qualifier, <b class="flag">host</b> is assumed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">dir</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
Specify a particular transfer direction to and/or from <i class="arg">id</i>. Possible directions are <b class="flag">src</b>, <b class="flag">dst</b>, <b class="flag">src or dst</b>, <b class="flag">src and dst</b>, <b class="flag">addr1</b>, <b class="flag">addr2</b>, <b class="flag">addr3</b>, and <b class="flag">addr4</b>. E.g., &#8220;src foo&#8221;, &#8220;dst net 128.3&#8221;, &#8220;src or dst port ftp-data&#8221;. If there is no <i class="arg">dir</i> qualifier, <b class="flag">src or dst</b> is assumed. The <b class="flag">addr1</b>, <b class="flag">addr2</b>, <b class="flag">addr3</b>, and <b class="flag">addr4</b> qualifiers are only valid for IEEE 802.11 Wireless LAN link layers. For null link layers (i.e., point-to-point protocols such as SLIP (Serial Line Internet Protocol) or the <a class="link-man" href="../html4/pflog.html">pflog(4)</a> header), the <b class="flag">inbound</b> and <b class="flag">outbound</b> qualifiers can be used to specify a desired direction.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">proto</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
Restrict the match to a particular protocol. Possible protocols are: <b class="flag">ah</b>, <b class="flag">arp</b>, <b class="flag">atalk</b>, <b class="flag">decnet</b>, <b class="flag">esp</b>, <b class="flag">ether</b>, <b class="flag">fddi</b>, <b class="flag">icmp</b>, <b class="flag">icmp6</b>, <b class="flag">igmp</b>, <b class="flag">igrp</b>, <b class="flag">ip</b>, <b class="flag">ip6</b>, <b class="flag">lat</b>, <b class="flag">mopdl</b>, <b class="flag">moprc</b>, <b class="flag">pim</b>, <b class="flag">rarp</b>, <b class="flag">sca</b>, <b class="flag">stp</b>, <b class="flag">tcp</b>, <b class="flag">udp</b>, and <b class="flag">wlan</b>. E.g., &#8220;ether src foo&#8221;, &#8220;arp net 128.3&#8221;, &#8220;tcp port 21&#8221;, &#8220;wlan addr1 0:2:3:4:5:6&#8221;. If there is no protocol qualifier, all protocols consistent with the type are assumed. E.g., &#8220;src foo&#8221; means &#8220;(ip or arp or rarp) src foo&#8221; (except the latter is not legal syntax); &#8220;net bar&#8221; means &#8220;(ip or arp or rarp) net bar&#8221;; and &#8220;port 53&#8221; means &#8220;(TCP or UDP) port 53&#8221;.<div class="spacer">
</div>
<b class="flag">fddi</b> is actually an alias for <b class="flag">ether</b>; the parser treats them identically as meaning &#8220;the data link level used on the specified network interface&#8221;. FDDI (Fiber Distributed Data Interface) headers contain Ethernet-like source and destination addresses, and often contain Ethernet-like packet types, so you can filter on these FDDI fields just as with the analogous Ethernet fields. FDDI headers also contain other fields, but you cannot name them explicitly in a filter expression.</dd>
</dl>
<div class="spacer">
</div>
In addition to the above, there are some special primitive keywords that don't follow the pattern: <b class="flag">gateway</b>, <b class="flag">broadcast</b>, <b class="flag">less</b>, <b class="flag">greater</b>, and arithmetic expressions. All of these are described below.<div class="spacer">
</div>
More complex filter expressions are built up by using the words <b class="flag">and</b>, <b class="flag">or</b>, and <b class="flag">not</b> to combine primitives e.g., &#8220;host foo and not port ftp and not port ftp-data&#8221;. To save typing, identical qualifier lists can be omitted e.g., &#8220;tcp dst port ftp or ftp-data or domain&#8221; is exactly the same as &#8220;tcp dst port ftp or tcp dst port ftp-data or tcp dst port domain&#8221;.<div class="spacer">
</div>
Allowable primitives are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">dst host</b> <i class="arg">host</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the IP destination field of the packet is <i class="arg">host</i>, which may be either an address or a name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">src host</b> <i class="arg">host</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the IP source field of the packet is <i class="arg">host</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">host</b> <i class="arg">host</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if either the IP source or destination of the packet is <i class="arg">host</i>.<div class="spacer">
</div>
Any of the above <i class="arg">host</i> expressions can be prepended with the keywords, <b class="flag">ip</b>, <b class="flag">arp</b>, or <b class="flag">rarp</b> as in:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<b class="flag">ip host</b> <i class="arg">host</i></div>
</blockquote>
<div class="spacer">
</div>
which is equivalent to:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="flag">ether proto</b> <i class="arg">ip</i> <b class="flag">and host</b> <i class="arg">host</i></div>
<div class="spacer">
</div>
If <i class="arg">host</i> is a name with multiple IP addresses, each address will be checked for a match.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ether dst</b> <i class="arg">ehost</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the Ethernet destination address is <i class="arg">ehost</i>. <i class="arg">ehost</i> may be either a name from <i class="file">/etc/ethers</i> or a number (see <a class="link-man" href="../html3/ethers.html">ethers(3)</a> for a numeric format).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ether src</b> <i class="arg">ehost</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the Ethernet source address is <i class="arg">ehost</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ether host</b> <i class="arg">ehost</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if either the Ethernet source or destination address is <i class="arg">ehost</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">gateway</b> <i class="arg">host</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet used <i class="arg">host</i> as a gateway; i.e., the Ethernet source or destination address was <i class="arg">host</i> but neither the IP source nor the IP destination was <i class="arg">host</i>. <i class="arg">host</i> must be a name and must be found in both <i class="file">/etc/hosts</i> and <i class="file">/etc/ethers</i>. An equivalent expression is<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="flag">ether host</b> <i class="arg">ehost</i> <b class="flag">and not host</b> <i class="arg">host</i></div>
<div class="spacer">
</div>
which can be used with either names or numbers for <i class="arg">host</i>/<i class="arg">ehost</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">dst net</b> <i class="arg">net</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the IP destination address of the packet has a network number of <i class="arg">net</i>. <i class="arg">net</i> may be either a name from <i class="file">/etc/networks</i> or a network number (see <a class="link-man" href="../html5/networks.html">networks(5)</a> for details).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">src net</b> <i class="arg">net</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the IP source address of the packet has a network number of <i class="arg">net</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">net</b> <i class="arg">net</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if either the IP source or destination address of the packet has a network number of <i class="arg">net</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">dst port</b> <i class="arg">port</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet is IP/TCP or IP/UDP and has a destination port value of <i class="arg">port</i>. The <i class="arg">port</i> can be a number or name from <a class="link-man" href="../html5/services.html">services(5)</a> (see <a class="link-man" href="../html4/tcp.html">tcp(4)</a> and <a class="link-man" href="../html4/udp.html">udp(4)</a>). If a name is used, both the port number and protocol are checked. If a number or ambiguous name is used, only the port number is checked; e.g., &#8220;<b class="flag">dst port</b> <code class="none">513</code>&#8221; will print both TCP/login traffic and UDP/who traffic, and &#8220;<b class="flag">dst port</b> <code class="none">domain</code>&#8221; will print both TCP/domain and UDP/domain traffic.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">src port</b> <i class="arg">port</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet has a source port value of <i class="arg">port</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">port</b> <i class="arg">port</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if either the source or destination port of the packet is <i class="arg">port</i>.<div class="spacer">
</div>
Any of the above port expressions can be prepended with the keywords <b class="flag">tcp</b> or <b class="flag">udp</b>, as in:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<b class="flag">tcp src port</b> <i class="arg">port</i></div>
</blockquote>
<div class="spacer">
</div>
which matches only TCP packets whose source port is <i class="arg">port</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">less</b> <i class="arg">length</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet has a length less than or equal to <i class="arg">length</i>. This is equivalent to:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<b class="flag">len &lt;=</b> <i class="arg">length</i></div>
</blockquote>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">greater</b> <i class="arg">length</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet has a length greater than or equal to <i class="arg">length</i>. This is equivalent to:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<b class="flag">len &gt;=</b> <i class="arg">length</i></div>
</blockquote>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ip proto</b> <i class="arg">proto</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet is an IP packet (see <a class="link-man" href="../html4/ip.html">ip(4)</a>) of protocol type <i class="arg">proto</i>. <i class="arg">proto</i> can be a number or name from <a class="link-man" href="../html5/protocols.html">protocols(5)</a>, such as <b class="flag">icmp</b>, <b class="flag">udp</b>, or <b class="flag">tcp</b>. These identifiers are also keywords and must be escaped using a backslash character (&#8216;\&#8217;).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ether broadcast</b></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet is an Ethernet broadcast packet. The <b class="flag">ether</b> keyword is optional.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ip broadcast</b></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet is an IP broadcast packet. It checks for both the all-zeroes and all-ones broadcast conventions and looks up the local subnet mask.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ether multicast</b></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet is an Ethernet multicast packet. The <b class="flag">ether</b> keyword is optional. This is shorthand for &#8220;<b class="flag">ether</b>[0] &amp; 1 != 0&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ip multicast</b></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet is an IP multicast packet.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ether proto</b> <i class="arg">proto</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet is of ether type <i class="arg">proto</i>. <i class="arg">proto</i> can be a number or one of the names <b class="flag">ip</b>, <b class="flag">ip6</b>, <b class="flag">arp</b>, <b class="flag">rarp</b>, <b class="flag">atalk</b>, <b class="flag">atalkarp</b>, <b class="flag">decnet</b>, <b class="flag">decdts</b>, <b class="flag">decdns</b>, <b class="flag">lanbridge</b>, <b class="flag">lat</b>, <b class="flag">mopdl</b>, <b class="flag">moprc</b>, <b class="flag">pup</b>, <b class="flag">sca</b>, <b class="flag">sprite</b>, <b class="flag">stp</b>, <b class="flag">vexp</b>, <b class="flag">vprod</b>, or <b class="flag">xns</b>. These identifiers are also keywords and must be escaped using a backslash character (&#8216;\&#8217;). In the case of FDDI (e.g., &#8220;<b class="flag">fddi protocol arp</b>&#8221;), the protocol identification comes from the 802.2 Logical Link Control (LLC) header, which is usually layered on top of the FDDI header. <b class="name">tcpdump</b> assumes, when filtering on the protocol identifier, that all FDDI packets include an LLC header, and that the LLC header is in so-called SNAP format.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">decnet src</b> <i class="arg">host</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the DECNET source address is <i class="arg">host</i>, which may be an address of the form &#8220;10.123&#8221;, or a DECNET host name. DECNET host name support is only available on systems that are configured to run DECNET.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">decnet dst</b> <i class="arg">host</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the DECNET destination address is <i class="arg">host</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">decnet host</b> <i class="arg">host</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if either the DECNET source or destination address is <i class="arg">host</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ifname</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet was logged as coming from the specified interface (applies only to packets logged by <a class="link-man" href="../html4/pf.html">pf(4)</a>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">on</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Synonymous with the <i class="arg">ifname</i> modifier.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rnr</b> <i class="arg">num</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet was logged as matching the specified PF rule number in the main ruleset (applies only to packets logged by <a class="link-man" href="../html4/pf.html">pf(4)</a>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rulenum</b> <i class="arg">num</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Synonymous with the <i class="arg">rnr</i> modifier.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">reason</b> <i class="arg">code</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet was logged with the specified PF reason code. The known codes are: <i class="arg">match</i>, <i class="arg">bad-offset</i>, <i class="arg">fragment</i>, <i class="arg">short</i>, <i class="arg">normalize</i>, <i class="arg">memory</i>, <i class="arg">bad-timestamp</i>, <i class="arg">congestion</i>, <i class="arg">ip-option</i>, <i class="arg">proto-cksum</i>, <i class="arg">state-mismatch</i>, <i class="arg">state-insert</i>, <i class="arg">state-limit</i>, <i class="arg">src-limit</i>, and <i class="arg">synproxy</i> (applies only to packets logged by <a class="link-man" href="../html4/pf.html">pf(4)</a>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rset</b> <i class="arg">name</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet was logged as matching the specified PF ruleset name of an anchored ruleset (applies only to packets logged by <a class="link-man" href="../html4/pf.html">pf(4)</a>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ruleset</b> <i class="arg">name</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Synonymous with the <i class="arg">rset</i> modifier.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">srnr</b> <i class="arg">num</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the packet was logged as matching the specified PF rule number of an anchored ruleset (applies only to packets logged by <a class="link-man" href="../html4/pf.html">pf(4)</a>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">subrulenum</b> <i class="arg">num</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Synonymous with the <i class="arg">srnr</i> modifier.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">action</b> <i class="arg">act</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if PF took the specified action when the packet was logged. Valid actions are: <i class="arg">pass</i>, <i class="arg">block</i>, and <i class="arg">match</i> (applies only to packets logged by <a class="link-man" href="../html4/pf.html">pf(4)</a>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">wlan addr1</b> <i class="arg">ehost</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the first IEEE 802.11 address is <i class="arg">ehost</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">wlan addr2</b> <i class="arg">ehost</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the second IEEE 802.11 address is <i class="arg">ehost</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">wlan addr3</b> <i class="arg">ehost</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the third IEEE 802.11 address is <i class="arg">ehost</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">wlan addr4</b> <i class="arg">ehost</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the fourth IEEE 802.11 address is <i class="arg">ehost</i>. The fourth address field is only used for WDS (Wireless Distribution System) frames.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">wlan host</b> <i class="arg">ehost</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if either the first, second, third, or fourth IEEE 802.11 address is <i class="arg">ehost</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">type</b> <i class="arg">type</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the IEEE 802.11 frame type matches the specified <i class="arg">type</i>. Valid types are: <i class="arg">data</i>, <i class="arg">mgt</i>, <i class="arg">ctl</i>, or a numeric value.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">subtype</b> <i class="arg">subtype</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the IEEE 802.11 frame subtype matches the specified <i class="arg">subtype</i>. Valid subtypes are: <i class="arg">assocreq</i>, <i class="arg">assocresp</i>, <i class="arg">reassocreq</i>, <i class="arg">reassocresp</i>, <i class="arg">probereq</i>, <i class="arg">proberesp</i>, <i class="arg">beacon</i>, <i class="arg">atim</i>, <i class="arg">disassoc</i>, <i class="arg">auth</i>, <i class="arg">deauth</i>, <i class="arg">data</i>, or a numeric value.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">dir</b> <i class="arg">dir</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the IEEE 802.11 frame direction matches the specified <i class="arg">dir</i>. Valid directions are: <i class="arg">nods</i>, <i class="arg">tods</i>, <i class="arg">fromds</i>, <i class="arg">dstods</i>, or a numeric value.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">atalk</b>, <b class="flag">ip</b>, <b class="flag">ip6</b>, <b class="flag">arp</b>, <b class="flag">decnet</b>, <b class="flag">lat</b>, <b class="flag">moprc</b>, <b class="flag">mopdl</b>, <b class="flag">rarp</b>, <b class="flag">sca</b></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Abbreviations for: <b class="flag">ether proto</b> <i class="arg">p</i> where <i class="arg">p</i> is one of the above protocols. <b class="name">tcpdump</b> does not currently know how to parse <b class="flag">lat</b>, <b class="flag">moprc</b>, or <b class="flag">mopdl</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ah</b>, <b class="flag">esp</b>, <b class="flag">icmp</b>, <b class="flag">icmp6</b>, <b class="flag">igmp</b>, <b class="flag">igrp</b>, <b class="flag">pim</b>, <b class="flag">tcp</b>, <b class="flag">udp</b></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Abbreviations for: <b class="flag">ip proto</b> <i class="arg">p</i> where <i class="arg">p</i> is one of the above protocols.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">expr relop expr</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
True if the relation holds, where <i class="arg">relop</i> is one of &#8216;<code class="lit">&gt;</code>&#8217;, &#8216;<code class="lit">&lt;</code>&#8217;, &#8216;<code class="lit">&gt;=</code>&#8217;, &#8216;<code class="lit">&lt;=</code>&#8217;, &#8216;<code class="lit">=</code>&#8217;, &#8216;<code class="lit">!=</code>&#8217;, and <i class="arg">expr</i> is an arithmetic expression composed of integer constants (expressed in standard C syntax), the normal binary operators (&#8216;<code class="lit">+</code>&#8217;, &#8216;<code class="lit">-</code>&#8217;, &#8216;<code class="lit">*</code>&#8217;, &#8216;<code class="lit">/</code>&#8217;, &#8216;<code class="lit">&amp;</code>&#8217;, &#8216;<code class="lit">|</code>&#8217;), a length operator, and special packet data accessors. To access data inside the packet, use the following syntax:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<i class="arg">proto</i>[<span class="opt"><i class="arg">expr</i>:<i class="arg">size</i></span>]</div>
<div class="spacer">
</div>
<i class="arg">proto</i> is one of <b class="flag">ether</b>, <b class="flag">fddi</b>, <b class="flag">ip</b>, <b class="flag">arp</b>, <b class="flag">rarp</b>, <b class="flag">tcp</b>, <b class="flag">udp</b>, or <b class="flag">icmp</b>, and indicates the protocol layer for the index operation. The byte offset, relative to the indicated protocol layer, is given by <i class="arg">expr</i>. <i class="arg">size</i> is optional and indicates the number of bytes in the field of interest; it can be either one, two, or four, and defaults to one. The length operator, indicated by the keyword <b class="flag">len</b>, gives the length of the packet.<div class="spacer">
</div>
For example, &#8220;<b class="flag">ether</b>[0] &amp; 1 != 0&#8221; catches all multicast traffic. The expression &#8220;<b class="flag">ip</b>[0] &amp; 0xf != 5&#8221; catches all IP packets with options. The expression &#8220;<b class="flag">ip</b>[6:2] &amp; 0x1fff = 0&#8221; catches only unfragmented datagrams and frag zero of fragmented datagrams. This check is implicitly applied to the <b class="flag">tcp</b> and <b class="flag">udp</b> index operations. For instance, &#8220;<b class="flag">tcp</b>[0]&#8221; always means the first byte of the TCP header, and never means the first byte of an intervening fragment.</dd>
</dl>
<div class="spacer">
</div>
Primitives may be combined using a parenthesized group of primitives and operators. Parentheses are special to the shell and must be escaped. Allowable primitives and operators are:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
Negation (&#8220;<b class="flag">!</b>&#8221; or &#8220;<b class="flag">not</b>&#8221;)<div class="spacer">
</div>
Concatenation (&#8220;<b class="flag">&amp;&amp;</b>&#8221; or &#8220;<b class="flag">and</b>&#8221;)<div class="spacer">
</div>
Alternation (&#8220;<b class="flag">||</b>&#8221; or &#8220;<b class="flag">or</b>&#8221;)</div>
<div class="spacer">
</div>
Negation has highest precedence. Alternation and concatenation have equal precedence and associate left to right. Explicit <b class="flag">and</b> tokens, not juxtaposition, are now required for concatenation.<div class="spacer">
</div>
If an identifier is given without a keyword, the most recent keyword is assumed. For example,<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="flag">not host</b> vs <b class="flag">and</b> ace</div>
<div class="spacer">
</div>
is short for<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="flag">not host</b> vs <b class="flag">and host</b> ace</div>
<div class="spacer">
</div>
which should not be confused with<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="flag">not</b> (<b class="flag">host</b> <code class="none">vs</code> <b class="flag">or</b> <code class="none">ace</code>)</div>
<div class="spacer">
</div>
Expression arguments can be passed to <b class="name">tcpdump</b> as either a single argument or as multiple arguments, whichever is more convenient. Generally, if the expression contains shell metacharacters, it is easier to pass it as a single, quoted argument. Multiple arguments are concatenated with spaces before being parsed.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> To print all packets arriving at or departing from sundown:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump host sundown</code></div>
</blockquote>
<div class="spacer">
</div>
To print traffic between helios and either hot or ace (the expression is quoted to prevent the shell from misinterpreting the parentheses):<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump 'host helios and (hot or ace)'</code></div>
</blockquote>
<div class="spacer">
</div>
To print all IP packets between ace and any host except helios:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump ip host ace and not helios</code></div>
</blockquote>
<div class="spacer">
</div>
To print all traffic between local hosts and hosts at Berkeley:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump net ucb-ether</code></div>
</blockquote>
<div class="spacer">
</div>
To print all FTP traffic through internet gateway snup:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump 'gateway snup and (port ftp or ftp-data)'</code></div>
</blockquote>
<div class="spacer">
</div>
To print traffic neither sourced from nor destined for local network 192.168.7.0/24 (if you gateway to one other net, this stuff should never make it onto your local network):<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump ip and not net 192.168.7.0/24</code></div>
</blockquote>
<div class="spacer">
</div>
To print the start and end packets (the SYN and FIN packets) of each TCP connection that involves a host that is not in local network 192.168.7.0/24:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# tcpdump 'tcp[13] &amp; 3 != 0 and not src and dst net 192.168.7.0/24'</pre>
<div class="spacer">
</div>
To print only the SYN packets of HTTP connections:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump 'tcp[tcpflags] = tcp-syn and port http'</code></div>
</blockquote>
<div class="spacer">
</div>
To print IP packets longer than 576 bytes sent through gateway snup:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump 'gateway snup and ip[2:2] &gt; 576'</code></div>
</blockquote>
<div class="spacer">
</div>
To print IP broadcast or multicast packets that were <span class="emph">not</span> sent via Ethernet broadcast or multicast:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# tcpdump 'ether[0] &amp; 1 = 0 and ip[16] &gt;= 224'</pre>
<div class="spacer">
</div>
To print all ICMP packets that are not echo requests/replies (i.e., not ping packets):<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump 'icmp[0] != 8 and icmp[0] != 0'</code></div>
</blockquote>
<div class="spacer">
</div>
To print only echo request ICMP packets:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump 'icmp[icmptype] = icmp-echo'</code></div>
</blockquote>
<div class="spacer">
</div>
To print and decrypt all ESP packets with SPI 0x00001234:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump -E des3-hmac96:ab...def 'ip[20:4] = 0x00001234'</code></div>
</blockquote>
<div class="spacer">
</div>
To print raw wireless frames passing the iwn0 interface:<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># tcpdump -i iwn0 -y IEEE802_11_RADIO -v</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x4f555450555420464f524d4154">OUTPUT FORMAT</h1> The output of <b class="name">tcpdump</b> is protocol dependent. The following gives a brief description and examples of most of the formats.<div class="subsection">
<h2 id="x4c696e6b204c6576656c2048656164657273">Link Level Headers</h2> If the <b class="flag">-e</b> option is given, the link level header is printed out. On Ethernets, the source and destination addresses, protocol, and packet length are printed.<div class="spacer">
</div>
On the packet filter logging interface <a class="link-man" href="../html4/pflog.html">pflog(4)</a>, logging reason (rule match, bad-offset, fragment, bad-timestamp, short, normalize, memory), action taken (pass/block), direction (in/out) and interface information are printed out for each packet.<div class="spacer">
</div>
On FDDI networks, the <b class="flag">-e</b> option causes <b class="name">tcpdump</b> to print the frame control field, the source and destination addresses, and the packet length. The frame control field governs the interpretation of the rest of the packet. Normal packets (such as those containing IP datagrams) are &#8220;async&#8221; packets, with a priority value between 0 and 7; for example, <span class="symb">async4</span>. Such packets are assumed to contain an 802.2 Logical Link Control (LLC) packet; the LLC header is printed if it is <span class="emph">not</span> an ISO datagram or a so-called SNAP packet.<div class="spacer">
</div>
The following description assumes familiarity with the SLIP compression algorithm described in RFC 1144.<div class="spacer">
</div>
On SLIP links, a direction indicator (&#8216;<code class="lit">I</code>&#8217; for inbound, &#8216;<code class="lit">O</code>&#8217; for outbound), packet type, and compression information are printed out. The packet type is printed first. The three types are <b class="flag">ip</b>, <b class="flag">utcp</b>, and <b class="flag">ctcp</b>. No further link information is printed for IP packets. For TCP packets, the connection identifier is printed following the type. If the packet is compressed, its encoded header is printed out. The special cases are printed out as <b class="flag">*S+</b><i class="arg">n</i> and <b class="flag">*SA+</b><i class="arg">n</i>, where <i class="arg">n</i> is the amount by which the sequence number (or sequence number and ack) has changed. If it is not a special case, zero or more changes are printed. A change is indicated by &#8216;U&#8217; (urgent pointer), &#8216;W&#8217; (window), &#8216;A&#8217; (ack), &#8216;S&#8217; (sequence number), and &#8216;I&#8217; (packet ID), followed by a delta (+n or -n), or a new value (=n). Finally, the amount of data in the packet and compressed header length are printed.<div class="spacer">
</div>
For example, the following line shows an outbound compressed TCP packet, with an implicit connection identifier; the ack has changed by 6, the sequence number by 49, and the packet ID by 6; there are 3 bytes of data and 6 bytes of compressed header:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
O <b class="flag">ctcp</b> <code class="none">*</code> <b class="flag">A</b> <code class="none">+6</code> <b class="flag">S</b> <code class="none">+49</code> <b class="flag">I</b> <code class="none">+6 3</code> (6)</div>
</div>
<div class="subsection">
<h2 id="x4152502f52415250205061636b657473">ARP/RARP Packets</h2> arp/rarp output shows the type of request and its arguments. The format is intended to be self-explanatory. Here is a short sample taken from the start of an rlogin from host rtsg to host csam:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
arp who-has csam tell rtsg 
arp reply csam is-at CSAM</pre>
<div class="spacer">
</div>
In this example, Ethernet addresses are in caps and internet addresses in lower case. The first line says that rtsg sent an arp packet asking for the Ethernet address of internet host csam. csam replies with its Ethernet address CSAM.<div class="spacer">
</div>
This would look less redundant if we had done <b class="name">tcpdump</b> <b class="flag">-n</b>:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
arp who-has 128.3.254.6 tell 128.3.254.68 
arp reply 128.3.254.6 is-at 02:07:01:00:01:c4</pre>
<div class="spacer">
</div>
If we had done <b class="name">tcpdump</b> <b class="flag">-e</b>, the fact that the first packet is broadcast and the second is point-to-point would be visible:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
RTSG Broadcast 0806 64: arp who-has csam tell rtsg 
CSAM RTSG 0806 64: arp reply csam is-at CSAM</pre>
<div class="spacer">
</div>
For the first packet this says the Ethernet source address is RTSG, the destination is the Ethernet broadcast address, the type field contained hex 0806 (type <span class="define">ETHER_ARP</span>) and the total length was 64 bytes.</div>
<div class="subsection">
<h2 id="x544350205061636b657473">TCP Packets</h2> The following description assumes familiarity with the TCP protocol described in RFC 793. If you are not familiar with the protocol, neither this description nor <b class="name">tcpdump</b> will be of much use to you.<div class="spacer">
</div>
The general format of a TCP protocol line is:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<i class="arg">src</i> <code class="none">&gt;</code> <i class="arg">dst</i>: <i class="arg">flags src-os data-seqno ack window urgent options</i></div>
<div class="spacer">
</div>
<i class="arg">src</i> and <i class="arg">dst</i> are the source and destination IP addresses and ports. <i class="arg">flags</i> is some combination of &#8216;S&#8217; (SYN), &#8216;F&#8217; (FIN), &#8216;P&#8217; (PUSH), or &#8216;R&#8217; (RST), &#8216;W&#8217; (congestion Window reduced), &#8216;E&#8217; (ecn ECHO) or a single &#8216;<code class="lit">.</code>&#8217; (no flags). <i class="arg">src-os</i> will list a guess of the source host's operating system if the <b class="flag">-o</b> command line flag was passed to <b class="name">tcpdump</b>. <i class="arg">data-seqno</i> describes the portion of sequence space covered by the data in this packet (see example below). <i class="arg">ack</i> is the sequence number of the next data expected by the other end of this connection. <i class="arg">window</i> is the number of bytes of receive buffer space available at the other end of this connection. <i class="arg">urg</i> indicates there is urgent data in the packet. <i class="arg">options</i> are TCP options enclosed in angle brackets e.g., &lt;mss 1024&gt;.<div class="spacer">
</div>
<i class="arg">src</i>, <i class="arg">dst</i> and <i class="arg">flags</i> are always present. The other fields depend on the contents of the packet's TCP protocol header and are output only if appropriate.<div class="spacer">
</div>
Here is the opening portion of an rlogin from host rtsg to host csam.<div class="spacer">
</div>
<pre style="margin-left: 2.00ex;" class="lit display">
rtsg.1023 &gt; csam.login: S 768512:768512(0) win 4096 &lt;mss 1024&gt; 
csam.login &gt; rtsg.1023: S 947648:947648(0) ack 768513 win 4096 &lt;mss 1024&gt; 
rtsg.1023 &gt; csam.login: . ack 1 win 4096 
rtsg.1023 &gt; csam.login: P 1:2(1) ack 1 win 4096 
csam.login &gt; rtsg.1023: . ack 2 win 4096 
rtsg.1023 &gt; csam.login: P 2:21(19) ack 1 win 4096 
csam.login &gt; rtsg.1023: P 1:2(1) ack 21 win 4077 
csam.login &gt; rtsg.1023: P 2:3(1) ack 21 win 4077 urg 1 
csam.login &gt; rtsg.1023: P 3:4(1) ack 21 win 4077 urg 1</pre>
<div class="spacer">
</div>
The first line says that TCP port 1023 on rtsg sent a packet to port login on host csam. The &#8216;<code class="lit">S</code>&#8217; indicates that the SYN flag was set. The packet sequence number was 768512 and it contained no data. The notation is &#8216;<i class="arg">first</i>:<i class="arg">last</i>(<i class="arg">nbytes</i>)&#8217; which means sequence numbers <i class="arg">first</i> up to but not including <i class="arg">last</i> which is <i class="arg">nbytes</i> bytes of user data. There was no piggy-backed ack, the available receive window was 4096 bytes and there was a max-segment-size option requesting an mss of 1024 bytes.<div class="spacer">
</div>
Csam replies with a similar packet except it includes a piggy-backed ack for rtsg's SYN. Rtsg then acks csam's SYN. The &#8216;<code class="lit">.</code>&#8217; means no flags were set. The packet contained no data so there is no data sequence number. The ack sequence number is a 32-bit integer. The first time <b class="name">tcpdump</b> sees a TCP connection, it prints the sequence number from the packet. On subsequent packets of the connection, the difference between the current packet's sequence number and this initial sequence number is printed. This means that sequence numbers after the first can be interpreted as relative byte positions in the connection's data stream (with the first data byte each direction being 1). <b class="flag">-S</b> will override this feature, causing the original sequence numbers to be output.<div class="spacer">
</div>
On the 6th line, rtsg sends csam 19 bytes of data (bytes 2 through 20 in the rtsg -&gt; csam side of the connection). The PUSH flag is set in the packet. On the 7th line, csam says it's received data sent by rtsg up to but not including byte 21. Most of this data is apparently sitting in the socket buffer since csam's receive window has gotten 19 bytes smaller. Csam also sends one byte of data to rtsg in this packet. On the 8th and 9th lines, csam sends two bytes of urgent, pushed data to rtsg.</div>
<div class="subsection">
<h2 id="x554450205061636b657473">UDP Packets</h2> UDP format is illustrated by this rwho packet:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
actinide.who &gt; broadcast.who: udp 84</div>
</blockquote>
<div class="spacer">
</div>
This says that port who on host actinide sent a UDP datagram to port who on host broadcast, the Internet broadcast address. The packet contained 84 bytes of user data.<div class="spacer">
</div>
Some UDP services are recognized (from the source or destination port number) and the higher level protocol information printed. In particular, Domain Name service requests (RFC 1034/1035) and Sun RPC calls (RFC 1050) to NFS.</div>
<div class="subsection">
<h2 id="x554450204e616d6520536572766572205265717565737473">UDP Name Server Requests</h2> The following description assumes familiarity with the Domain Service protocol described in RFC 1035. If you are not familiar with the protocol, the following description will appear to be written in Greek.<div class="spacer">
</div>
Name server requests are formatted as<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<i class="arg">src</i> &gt; <i class="arg">dst</i>: <i class="arg">id op</i>? <i class="arg">flags qtype qclass name</i> (<i class="arg">len</i>)</div>
<div class="spacer">
</div>
For example:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
h2opolo.1538 &gt; helios.domain: 3+ A? ucbvax.berkeley.edu. (37)</div>
</blockquote>
<div class="spacer">
</div>
Host h2opolo asked the domain server on helios for an address record (<i class="arg">qtype</i>=A) associated with the name ucbvax.berkeley.edu. The query <i class="arg">id</i> was 3. The &#8216;<code class="lit">+</code>&#8217; indicates the recursion desired flag was set. The query length was 37 bytes, not including the UDP and IP protocol headers. The query operation was the normal one (Query) so the <i class="arg">op</i> field was omitted. If <i class="arg">op</i> had been anything else, it would have been printed between the 3 and the &#8216;<code class="lit">+</code>&#8217;. Similarly, the <i class="arg">qclass</i> was the normal one (C_IN) and was omitted. Any other <i class="arg">qclass</i> would have been printed immediately after the A.<div class="spacer">
</div>
A few anomalies are checked and may result in extra fields enclosed in square brackets: if a query contains an answer, name server or authority section, <i class="arg">ancount</i>, <i class="arg">nscount</i>, or <i class="arg">arcount</i> are printed as &#8220;[<i class="arg">n</i>a]&#8221;, &#8220;[<i class="arg">n</i>n]&#8221;, or &#8220;[<i class="arg">n</i>au]&#8221; where <i class="arg">n</i> is the appropriate count. If any of the response bits are set (AA, RA or rcode) or any of the &#8220;must be zero&#8221; bits are set in bytes two and three, &#8220;[b2&amp;3=<i class="arg">x</i>]&#8221; is printed, where <i class="arg">x</i> is the hex value of header bytes two and three.</div>
<div class="subsection">
<h2 id="x554450204e616d652053657276657220526573706f6e736573">UDP Name Server Responses</h2> Name server responses are formatted as<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<i class="arg">src</i> <code class="none">&gt;</code> <i class="arg">dst</i>: <i class="arg">id op rcode flags</i> <i class="arg">a</i> / <i class="arg">n</i> / <i class="arg">au</i> <i class="arg">type class data</i> (<i class="arg">len</i>)</div>
<div class="spacer">
</div>
For example:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
helios.domain &gt; h2opolo.1538: 3 3/3/7 A 128.32.137.3 (273) 
helios.domain &gt; h2opolo.1537: 2 NXDomain* 0/1/0 (97)</pre>
<div class="spacer">
</div>
In the first example, helios responds to query <i class="arg">id</i> 3 from h2opolo with 3 answer records, 3 name server records and 7 authority records. The first answer record is type A (address and its data is internet) address 128.32.137.3. The total size of the response was 273 bytes, excluding UDP and IP headers. The <i class="arg">op</i> (Query) and <i class="arg">rcode</i> (NoError) were omitted, as was the <i class="arg">class</i> (C_IN) of the A record.<div class="spacer">
</div>
In the second example, helios responds to query <i class="arg">op</i> 2 with an <i class="arg">rcode</i> of non-existent domain (NXDomain) with no answers, one name server and no authority records. The &#8216;<code class="lit">*</code>&#8217; indicates that the authoritative answer bit was set. Since there were no answers, no <i class="arg">type</i>, <i class="arg">class</i> or <i class="arg">data</i> were printed.<div class="spacer">
</div>
Other flag characters that might appear are &#8216;-&#8217; (recursion available, RA, <span class="emph">not</span> set) and &#8216;|&#8217; (truncated message, TC, set). If the question section doesn't contain exactly one entry, &#8220;[<i class="arg">n</i>q]&#8221; is printed.<div class="spacer">
</div>
Name server requests and responses tend to be large and the default <i class="arg">snaplen</i> of 96 bytes may not capture enough of the packet to print. Use the <b class="flag">-s</b> flag to increase the <i class="arg">snaplen</i> if you need to seriously investigate name server traffic. &#8220;<b class="flag">-s</b> <code class="none">128</code>&#8221; has worked well for me.</div>
<div class="subsection">
<h2 id="x4e465320526571756573747320616e64205265706c696573">NFS Requests and Replies</h2> Sun NFS (Network File System) requests and replies are printed as:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<i class="arg">src</i>.<i class="arg">xid</i> &gt; <i class="arg">dst</i>.nfs: <i class="arg">len op args</i><div class="spacer">
</div>
<i class="arg">src</i>.nfs &gt; <i class="arg">dst</i>.<i class="arg">xid</i>: reply <i class="arg">stat len op results</i></div>
<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
sushi.6709 &gt; wrl.nfs: 112 readlink fh 21,24/10.73165 
wrl.nfs &gt; sushi.6709: reply ok 40 readlink &quot;../var&quot; 
sushi.201b &gt; wrl.nfs: 
	144 lookup fh 9,74/4096.6878 &quot;xcolors&quot; 
wrl.nfs &gt; sushi.201b: 
	reply ok 128 lookup fh 9,74/4134.3150</pre>
<div class="spacer">
</div>
In the first line, host sushi sends a transaction with ID 6709 to wrl. The number following the src host is a transaction ID, <span class="emph">not</span> the source port. The request was 112 bytes, excluding the UDP and IP headers. The <i class="arg">op</i> was a readlink (read symbolic link) on fh (&#8220;file handle&#8221;) 21,24/10.731657119. If one is lucky, as in this case, the file handle can be interpreted as a major,minor device number pair, followed by the inode number and generation number. Wrl replies with a <i class="arg">stat</i> of ok and the contents of the link.<div class="spacer">
</div>
In the third line, sushi asks wrl to look up the name &#8220;xcolors&#8221; in directory file 9,74/4096.6878. The data printed depends on the operation type. The format is intended to be self-explanatory if read in conjunction with an NFS protocol spec.<div class="spacer">
</div>
If the <b class="flag">-v</b> (verbose) flag is given, additional information is printed. For example:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
sushi.1372a &gt; wrl.nfs: 
	148 read fh 21,11/12.195 8192 bytes @ 24576 
wrl.nfs &gt; sushi.1372a: 
	reply ok 1472 read REG 100664 ids 417/0 sz 29388</pre>
<div class="spacer">
</div>
<b class="flag">-v</b> also prints the IP header TTL, ID, and fragmentation fields, which have been omitted from this example. In the first line, sushi asks wrl to read 8192 bytes from file 21,11/12.195, at byte offset 24576. Wrl replies with a <i class="arg">stat of</i> ok; the packet shown on the second line is the first fragment of the reply, and hence is only 1472 bytes long. The other bytes will follow in subsequent fragments, but these fragments do not have NFS or even UDP headers and so might not be printed, depending on the filter expression used. Because the <b class="flag">-v</b> flag is given, some of the file attributes (which are returned in addition to the file data) are printed: the file type (&#8216;REG&#8217;, <code class="none">for regular file</code>), the file mode (in octal), the UID and GID, and the file size.<div class="spacer">
</div>
If the <b class="flag">-v</b> flag is given more than once, even more details are printed.<div class="spacer">
</div>
NFS requests are very large and much of the detail won't be printed unless <i class="arg">snaplen</i> is increased. Try using &#8220;<b class="flag">-s</b> <code class="none">192</code>&#8221; to watch NFS traffic.<div class="spacer">
</div>
NFS reply packets do not explicitly identify the RPC operation. Instead, <b class="name">tcpdump</b> keeps track of &#8220;recent&#8221; requests, and matches them to the replies using the <i class="arg">xid</i> (transaction ID). If a reply does not closely follow the corresponding request, it might not be parsable.</div>
<div class="subsection">
<h2 id="x4b4950204170706c6554616c6b202844445020696e2055445029">KIP AppleTalk (DDP in UDP)</h2> AppleTalk DDP packets encapsulated in UDP datagrams are de-encapsulated and dumped as DDP packets (i.e., all the UDP header information is discarded). The file <i class="file">/etc/atalk.names</i> is used to translate AppleTalk net and node numbers to names. Lines in this file have the form<table style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-col">
<col style="width: 6.00ex;"/>
<col style="min-width: 4.00ex;"/>
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">number</span></td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">name</span></td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
1.254</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
ether</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
16.1</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
icsd-net</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
1.254.110</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
ace</td>
</tr>
</tbody>
</table>
<div class="spacer">
</div>
The first two lines give the names of AppleTalk networks. The third line gives the name of a particular host (a host is distinguished from a net by the 3rd octet in the number; a net number <span class="emph">must</span> have two octets and a host number <span class="emph">must</span> have three octets). The number and name should be separated by whitespace (blanks or tabs). The <i class="file">/etc/atalk.names</i> file may contain blank lines or comment lines (lines starting with a &#8216;<code class="lit">#</code>&#8217;).<div class="spacer">
</div>
AppleTalk addresses are printed in the form<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<i class="arg">net</i>.<i class="arg">host</i>.<i class="arg">port</i></div>
</blockquote>
<div class="spacer">
</div>
For example:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
144.1.209.2 &gt; icsd-net.112.220 
office.2 &gt; icsd-net.112.220 
jssmag.149.235 &gt; icsd-net.2</pre>
<div class="spacer">
</div>
If <i class="file">/etc/atalk.names</i> doesn't exist or doesn't contain an entry for some AppleTalk host/net number, addresses are printed in numeric form. In the first example, NBP (DDP port 2) on net 144.1 node 209 is sending to whatever is listening on port 220 of net icsd-net node 112. The second line is the same except the full name of the source node is known (&#8220;office&#8221;). The third line is a send from port 235 on net jssmag node 149 to broadcast on the icsd-net NBP port. The broadcast address (255) is indicated by a net name with no host number; for this reason it is a good idea to keep node names and net names distinct in <i class="file">/etc/atalk.names</i>.<div class="spacer">
</div>
NBP (name binding protocol) and ATP (AppleTalk transaction protocol) packets have their contents interpreted. Other protocols just dump the protocol name (or number if no name is registered for the protocol) and packet size.<div class="spacer">
</div>
NBP packets are formatted like the following examples:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
icsd-net.112.220 &gt; jssmag.2: nbp-lkup 190: &quot;=:LaserWriter@*&quot; 
jssmag.209.2 &gt; icsd-net.112.220: nbp-reply 190: &quot;RM1140:LaserWriter@*&quot; 250 
techpit.2 &gt; icsd-net.112.220: nbp-reply 190: &quot;techpit:LaserWriter@*&quot; 186</pre>
<div class="spacer">
</div>
The first line is a name lookup request for laserwriters sent by net icsdi-net host 112 and broadcast on net jssmag. The nbp ID for the lookup is 190. The second line shows a reply for this request (note that it has the same ID) from host jssmag.209 saying that it has a laserwriter resource named RM1140 registered on port 250. The third line is another reply to the same request saying host techpit has laserwriter techpit registered on port 186.<div class="spacer">
</div>
ATP packet formatting is demonstrated by the following example:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
jssmag.209.165 &gt; helios.132: atp-req  12266&lt;0-7&gt; 0xae030001 
helios.132 &gt; jssmag.209.165: atp-resp 12266:0 (512) 0xae040000 
helios.132 &gt; jssmag.209.165: atp-resp 12266:1 (512) 0xae040000 
helios.132 &gt; jssmag.209.165: atp-resp 12266:2 (512) 0xae040000 
helios.132 &gt; jssmag.209.165: atp-resp 12266:3 (512) 0xae040000 
helios.132 &gt; jssmag.209.165: atp-resp 12266:4 (512) 0xae040000 
helios.132 &gt; jssmag.209.165: atp-resp 12266:5 (512) 0xae040000 
helios.132 &gt; jssmag.209.165: atp-resp 12266:6 (512) 0xae040000 
helios.132 &gt; jssmag.209.165: atp-resp*12266:7 (512) 0xae040000 
jssmag.209.165 &gt; helios.132: atp-req  12266&lt;3,5&gt; 0xae030001 
helios.132 &gt; jssmag.209.165: atp-resp 12266:3 (512) 0xae040000 
helios.132 &gt; jssmag.209.165: atp-resp 12266:5 (512) 0xae040000 
jssmag.209.165 &gt; helios.132: atp-rel  12266&lt;0-7&gt; 0xae030001 
jssmag.209.133 &gt; helios.132: atp-req* 12267&lt;0-7&gt; 0xae030002</pre>
<div class="spacer">
</div>
Jssmag.209 initiates transaction ID 12266 with host helios by requesting up to 8 packets (the&#8220;&lt;0-7&gt;&#8221;). The hex number at the end of the line is the value of the <i class="arg">userdata</i> field in the request.<div class="spacer">
</div>
Helios responds with 8 512-byte packets. The &#8220;:<i class="arg">n</i>&#8221; following the transaction ID gives the packet sequence number in the transaction and the number in parentheses is the amount of data in the packet, excluding the ATP header. The &#8216;<code class="lit">*</code>&#8217; on packet 7 indicates that the EOM bit was set.<div class="spacer">
</div>
Jssmag.209 then requests that packets 3 &amp; 5 be retransmitted. Helios resends them then jssmag.209 releases the transaction. Finally, jssmag.209 initiates the next request. The &#8216;<code class="lit">*</code>&#8217; on the request indicates that XO (exactly once) was <span class="emph">not</span> set.</div>
<div class="subsection">
<h2 id="x495020467261676d656e746174696f6e">IP Fragmentation</h2> Fragmented Internet datagrams are printed as<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
(<b class="flag">frag</b> <i class="arg">id</i> : <i class="arg">size</i> @ <i class="arg">offset</i> [<span class="opt">+</span>])</div>
<div class="spacer">
</div>
A &#8216;<code class="lit">+</code>&#8217; indicates there are more fragments. The last fragment will have no &#8216;<code class="lit">+</code>&#8217;.<div class="spacer">
</div>
<i class="arg">id</i> is the fragment ID. <i class="arg">size</i> is the fragment size (in bytes) excluding the IP header. <i class="arg">offset</i> is this fragment's offset (in bytes) in the original datagram.<div class="spacer">
</div>
The fragment information is output for each fragment. The first fragment contains the higher level protocol header and the fragment info is printed after the protocol info. Fragments after the first contain no higher level protocol header and the fragment info is printed after the source and destination addresses. For example, here is part of an FTP from arizona.edu to lbl-rtsg.arpa over a CSNET connection that doesn't appear to handle 576 byte datagrams:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
arizona.ftp-data &gt; rtsg.1170: . 1024:1332(308) ack 1 win 4096 (frag 595a:328@0+) 
arizona &gt; rtsg: (frag 595a:204@328) 
rtsg.1170 &gt; arizona.ftp-data: . ack 1536 win 2560</pre>
<div class="spacer">
</div>
There are a couple of things to note here: first, addresses in the 2nd line don't include port numbers. This is because the TCP protocol information is all in the first fragment and we have no idea what the port or sequence numbers are when we print the later fragments. Second, the TCP sequence information in the first line is printed as if there were 308 bytes of user data when, in fact, there are 512 bytes (308 in the first frag and 204 in the second). If you are looking for holes in the sequence space or trying to match up acks with packets, this can fool you.<div class="spacer">
</div>
A packet with the IP <span class="symb">don't fragment</span> flag is marked with a trailing &#8220;(DF)&#8221;.</div>
<div class="subsection">
<h2 id="x54696d657374616d7073">Timestamps</h2> By default, all output lines are preceded by a timestamp. The timestamp is the current clock time in the form <i class="arg">hh</i>:<i class="arg">mm</i>:<i class="arg">ss</i>.<i class="arg">frac</i> and is as accurate as the kernel's clock. The timestamp reflects the time the kernel first saw the packet. No attempt is made to account for the time lag between when the Ethernet interface removed the packet from the wire and when the kernel serviced the &#8220;new packet&#8221; interrupt.</div>
<div class="subsection">
<h2 id="x495020616e642050726f746f636f6c20436865636b73756d204f66666c6f6164">IP and Protocol Checksum Offload</h2> Some network cards support IP and/or protocol checksum offload. Packet headers for such interfaces erroneously indicate a bad checksum, since the checksum is not calculated until after <b class="name">tcpdump</b> sees the packet.</div>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/ethers.html">ethers(3)</a>, <a class="link-man" href="../html3/pcap.html">pcap(3)</a>, <a class="link-man" href="../html3/pcap-filter.html">pcap-filter(3)</a>, <a class="link-man" href="../html4/bpf.html">bpf(4)</a>, <a class="link-man" href="../html4/ip.html">ip(4)</a>, <a class="link-man" href="../html4/pf.html">pf(4)</a>, <a class="link-man" href="../html4/pflog.html">pflog(4)</a>, <a class="link-man" href="../html4/tcp.html">tcp(4)</a>, <a class="link-man" href="../html4/udp.html">udp(4)</a>, <a class="link-man" href="../html5/networks.html">networks(5)</a>, <a class="link-man" href="../html5/pf.os.html">pf.os(5)</a>, <a class="link-man" href="../html5/protocols.html">protocols(5)</a>, <a class="link-man" href="../html5/services.html">services(5)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> <span class="ref"><span class="ref-title">Transmission Control Protocol</span>, <span class="ref-rep">RFC 793</span>, <span class="ref-date">September 1981</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">P. Mockapetris</span>, <span class="ref-title">Domain Names &#8211; Concepts and Facilities</span>, <span class="ref-rep">RFC 1034</span>, <span class="ref-date">November 1987</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">P. Mockapetris</span>, <span class="ref-title">Domain Names &#8211; Implementation and Specification</span>, <span class="ref-rep">RFC 1035</span>, <span class="ref-date">November 1987</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-title">RPC: Remote Procedure Call Protocol Specification</span>, <span class="ref-rep">RFC 1050</span>, <span class="ref-date">April 1988</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">V. Jacobson</span>, <span class="ref-title">Compressing TCP/IP Headers for Low-Speed Serial Links</span>, <span class="ref-rep">RFC 1144</span>, <span class="ref-date">February 1990</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">M. Mathis</span>, <span class="ref-auth">J. Mahdavi</span>, <span class="ref-auth">S. Floyd</span>, and <span class="ref-auth">A. Romanow</span>, <span class="ref-title">TCP Selective Acknowledgement Options</span>, <span class="ref-rep">RFC 2018</span>, <span class="ref-date">October 1996</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">V. Manral</span>, <span class="ref-title">Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)</span>, <span class="ref-rep">RFC 4835</span>, <span class="ref-date">April 2007</span>.</span></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Van Jacobson</span> &lt;<a class="link-mail" href="mailto:van@ee.lbl.gov">van@ee.lbl.gov</a>&gt;, <span class="author">Craig Leres</span> &lt;<a class="link-mail" href="mailto:leres@ee.lbl.gov">leres@ee.lbl.gov</a>&gt;, and <span class="author">Steven McCanne</span> &lt;<a class="link-mail" href="mailto:mccanne@ee.lbl.gov">mccanne@ee.lbl.gov</a>&gt;, all of the Lawrence Berkeley Laboratory, University of California, Berkeley, CA.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Some attempt should be made to reassemble IP fragments, or at least to compute the right length for the higher level protocol.<div class="spacer">
</div>
Name server inverse queries are not dumped correctly: The (empty) question section is printed rather than the real query in the answer section. Some believe that inverse queries are themselves a bug and prefer to fix the program generating them rather than <b class="name">tcpdump</b>.<div class="spacer">
</div>
Apple Ethertalk DDP packets could be dumped as easily as KIP DDP packets but aren't. Even if we were inclined to do anything to promote the use of Ethertalk (we aren't, LBL doesn't allow Ethertalk on any of its networks so we'd have no way of testing this code).<div class="spacer">
</div>
A packet trace that crosses a daylight saving time change will give skewed time stamps (the time change is ignored).<div class="spacer">
</div>
Filter expressions that manipulate FDDI headers assume that all FDDI packets are encapsulated Ethernet packets. This is true for IP, ARP, and DECNET Phase IV, but is not true for protocols such as ISO CLNS. Therefore, the filter may inadvertently accept certain packets that do not properly match the filter expression.</div>
</div>
</body>
</html>

