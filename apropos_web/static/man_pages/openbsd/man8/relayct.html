<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
RELAYCTL(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">relayctl</b> &#8212; <span class="desc">control the relay daemon</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 8.00ex;"/>
<col/>
<tbody>
<tr>
<td>
relayctl</td>
<td>
<i class="arg">command</i> [<span class="opt"><i class="arg">argument ...</i></span>]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">relayctl</b> program controls the <a class="link-man" href="../html8/relayd.html">relayd(8)</a> daemon.<div class="spacer">
</div>
The following commands are available:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">host disable</b> [<span class="opt"><i class="arg">name</i> | <i class="arg">id</i></span>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable a host. Treat it as though it were always down.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">host enable</b> [<span class="opt"><i class="arg">name</i> | <i class="arg">id</i></span>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable the host. Start checking its health again.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">load</b> <i class="arg">filename</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Reload the configuration from the specified file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">log brief</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable verbose debug logging.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">log verbose</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable verbose debug logging.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">monitor</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Continuously report any changes in the host checking engine and the <a class="link-man" href="../html4/pf.html">pf(4)</a> engine.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">poll</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Schedule an immediate check of all hosts.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">redirect disable</b> [<span class="opt"><i class="arg">name</i> | <i class="arg">id</i></span>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable a redirection. If it has <a class="link-man" href="../html4/pf.html">pf(4)</a> redirection rules installed, remove them. Mark the redirection's main table and &#8211; if applicable &#8211; disable the backup table as well.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">redirect enable</b> [<span class="opt"><i class="arg">name</i> | <i class="arg">id</i></span>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable a redirection. Mark the redirection's main table and &#8211; if applicable &#8211; enable the backup table as well.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">reload</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Reload the configuration file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">show hosts</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Show detailed status of hosts and tables. It will also print the last error for failed host checks; see the <i class="link-sec"><a class="link-sec" href="#x444941474e4f5354494353">DIAGNOSTICS</a></i> section below.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">show redirects</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Show detailed status of redirections including the current and average access statistics. The statistics will be updated every minute. Redirections using the <b class="cmd">sticky-address</b> option will count the number of sticky states, not the total number of redirected connections.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">show relays</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Show detailed status of relays including the current and average access statistics. The statistics will be updated every minute.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">show routers</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Show detailed status of routers including the configured network routes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">show sessions</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Dump the complete list of running relay sessions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">show summary</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Display a list of all relays, redirections, routers, tables, and hosts.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">table disable</b> [<span class="opt"><i class="arg">name</i> | <i class="arg">id</i></span>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable a table. Consider all hosts disabled. If it is a main table of a redirection which has a non-empty backup table, swap the contents of the <a class="link-man" href="../html4/pf.html">pf(4)</a> table with those of the backup table.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">table enable</b> [<span class="opt"><i class="arg">name</i> | <i class="arg">id</i></span>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable a table. Start doing checks for all hosts that aren't individually disabled again.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/run/relayd.sock</i></dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
<span class="unix">UNIX</span>-domain socket used for communication with <a class="link-man" href="../html8/relayd.html">relayd(8)</a>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> If a host is down and a previous check failed, <b class="name">relayctl</b> will display the last error in the output of the <b class="flag">show hosts</b> command. This is especially useful for debugging server or configuration failures. The following errors will be reported:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">none</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
No specific error was reported by the check engine.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">aborted</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
All checks were aborted by an external event, like a configuration reload.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">interval timeout</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The check did not finish in the configured time of an interval. This can happen if there are too many hosts that have to be checked by <a class="link-man" href="../html8/relayd.html">relayd(8)</a> and can be avoided by increasing the global <b class="cmd">interval</b> option in <a class="link-man" href="../html5/relayd.conf.html">relayd.conf(5)</a>.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">icmp read timeout</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tls read timeout</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tcp read timeout</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The check failed because the remote host did not send a reply within the configured timeout.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">icmp write timeout</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tls write timeout</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tcp write timeout</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tls connect timeout</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tcp connect timeout</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The check failed because <a class="link-man" href="../html8/relayd.html">relayd(8)</a> was not ready to send the request within the configured timeout.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tls connect error</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tls read error</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tls write error</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tcp connect error</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tcp read failed</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tcp write failed</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
An I/O error occurred. This indicates that <a class="link-man" href="../html8/relayd.html">relayd(8)</a> was running low on resources, file descriptors, or was too busy to run the request. It can also indicate that a TLS or TCP protocol error occurred or that the connection was unexpectedly aborted.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tls connect failed</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">tcp connect failed</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The check failed because the protocol handshake did not succeed in opening a stateful connection with the remote host.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">script failed</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The external script executed by the check did not return a valid return code.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">send/expect failed</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The payload data returned by the remote host did not match the expected pattern.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">http code malformed</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">http digest malformed</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The remote host did not return a valid HTTP header or body.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">http code mismatch</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The remote host did not return a matching HTTP error code. This may indicate a real server problem (a server error, the page was not found, permission was denied) or a configuration error. For example, it is a very common mistake that <a class="link-man" href="../html8/relayd.html">relayd(8)</a> was configured to expect a HTTP 200 OK status but the host is returning a HTTP 302 Found redirection. See <a class="link-man" href="../html5/relayd.conf.html">relayd.conf(5)</a> for more information on validating the HTTP return code.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="emph">http digest mismatch</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The remote host did not return the expected content and the computed digest was different to the configured value. See <a class="link-man" href="../html5/relayd.conf.html">relayd.conf(5)</a> for more information on validating the digest.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html8/relayd.html">relayd(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">relayctl</b> program, formerly known as <b class="cmd">hoststatectl</b>, first appeared in <span class="unix">OpenBSD&#160;4.1</span>. It was renamed to <b class="name">relayctl</b> in <span class="unix">OpenBSD&#160;4.3</span>.</div>
</div>
</body>
</html>

