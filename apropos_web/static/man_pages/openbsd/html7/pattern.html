<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
PATTERNS(7)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">patterns</b> &#8212; <span class="desc">Lua's pattern matching rules</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> Pattern matching in <a class="link-man" href="../html8/httpd.html">httpd(8)</a> is based on the implementation of the Lua scripting language and provides a simple and fast alternative to the regular expressions (REs) that are described in <a class="link-man" href="../html7/re_format.html">re_format(7)</a>. Patterns are described by regular strings, which are interpreted as patterns by the pattern-matching &#8220;find&#8221; and &#8220;match&#8221; functions. This document describes the syntax and the meaning (that is, what they match) of these strings.</div>
<div class="section">
<h1 id="x43484152414354455220434c415353">CHARACTER CLASS</h1> A character class is used to represent a set of characters. The following combinations are allowed in describing a character class:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">x</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
(where <i class="arg">x</i> is not one of the magic characters &#8216;^$()%.[]*+-?&#8217;) represents the character <i class="arg">x</i> itself.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
.</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
(a dot) represents all characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%a</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
represents all letters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%c</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
represents all control characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%d</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
represents all digits.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%g</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
represents all printable characters except space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%l</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
represents all lowercase letters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%p</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
represents all punctuation characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%s</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
represents all space characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%u</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
represents all uppercase letters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%w</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
represents all alphanumeric characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%x</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
represents all hexadecimal digits.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%<i class="arg">x</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
(where <i class="arg">x</i> is any non-alphanumeric character) represents the character <i class="arg">x</i>. This is the standard way to escape the magic characters. Any non-alphanumeric character (including all punctuation characters, even the non-magical) can be preceded by a &#8216;%&#8217; when used to represent itself in a pattern.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<i class="arg">set</i>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
represents the class which is the union of all characters in <i class="arg">set</i>. A range of characters can be specified by separating the end characters of the range, in ascending order, with a &#8216;-&#8217;. All classes &#8216;<i class="arg">%x</i>&#8217; described above can also be used as components in <i class="arg">set</i>. All other characters in <i class="arg">set</i> represent themselves. For example, &#8216;[%w_]&#8217; (or &#8216;[_%w]&#8217;) represents all alphanumeric characters plus the underscore, &#8216;[0-7]&#8217; represents the octal digits, and &#8216;[0-7%l%-]&#8217; represents the octal digits plus the lowercase letters plus the &#8216;-&#8217; character.<div class="spacer">
</div>
The interaction between ranges and classes is not defined. Therefore, patterns like &#8216;[%a-z]&#8217; or &#8216;[a-%%]&#8217; have no meaning.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<i class="arg">^set</i>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
represents the complement of <i class="arg">set</i>, where <i class="arg">set</i> is interpreted as above.</dd>
</dl>
<div class="spacer">
</div>
For all classes represented by single letters ( &#8216;%a&#8217;, &#8216;%c&#8217;, etc.), the corresponding uppercase letter represents the complement of the class. For instance, &#8216;%S&#8217; represents all non-space characters.<div class="spacer">
</div>
The definitions of letter, space, and other character groups depend on the current locale. In particular, the class &#8216;[a-z]&#8217; may not be equivalent to &#8216;%l&#8217;.</div>
<div class="section">
<h1 id="x5041545445524e204954454d">PATTERN ITEM</h1> A  pattern item can be<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
a single character class, which matches any single character in the class;</li>
<li class="list-bul" style="margin-top: 1.00em;">
a single character class followed by &#8216;*&#8217;, which matches zero or more repetitions of characters in the class. These repetition items will always match the longest possible sequence;</li>
<li class="list-bul" style="margin-top: 1.00em;">
a single character class followed by &#8216;+&#8217;, which matches one or more repetitions of characters in the class. These repetition items will always match the longest possible sequence;</li>
<li class="list-bul" style="margin-top: 1.00em;">
a single character class followed by &#8216;-&#8217;, which also matches zero or more repetitions of characters in the class. Unlike &#8216;*&#8217;, these repetition items will always match the shortest possible sequence;</li>
<li class="list-bul" style="margin-top: 1.00em;">
a single character class followed by &#8216;?&#8217;, which matches zero or one occurrence of a character in the class. It always matches one occurrence if possible;</li>
<li class="list-bul" style="margin-top: 1.00em;">
&#8216;%<i class="arg">n</i>&#8217;, for <i class="arg">n</i> between 1 and 9; such item matches a substring equal to the n-th captured string (see below);</li>
<li class="list-bul" style="margin-top: 1.00em;">
&#8216;%b<i class="arg">xy</i>&#8217;, where <i class="arg">x</i> and <i class="arg">y</i> are two distinct characters; such item matches strings that start with <i class="arg">x</i>, end with <i class="arg">y</i>, and where the <i class="arg">x</i> and <i class="arg">y</i> are <span class="emph">balanced</span>. This means that if one reads the string from left to right, counting <span class="emph">+1</span> for an <i class="arg">x</i> and <span class="emph">-1</span> for a <i class="arg">y</i>, the ending <i class="arg">y</i> is the first <i class="arg">y</i> where the count reaches 0. For instance, the item &#8216;%b()&#8217; matches expressions with balanced parentheses.</li>
<li class="list-bul" style="margin-top: 1.00em;">
&#8216;%f[<i class="arg">set</i>]&#8217;, a <span class="emph">frontier pattern</span>; such item matches an empty string at any position such that the next character belongs to <i class="arg">set</i> and the previous character does not belong to <i class="arg">set</i>. The set <i class="arg">set</i> is interpreted as previously described. The beginning and the end of the subject are handled as if they were the character &#8216;\0&#8217;.</li>
</ul>
</div>
<div class="section">
<h1 id="x5041545445524e">PATTERN</h1> A pattern is a sequence of pattern items. A caret &#8216;^&#8217; at the beginning of a pattern anchors the match at the beginning of the subject string. A &#8216;$&#8217; at the end of a pattern anchors the match at the end of the subject string. At other positions, &#8216;^&#8217; and &#8216;$&#8217; have no special meaning and represent themselves.</div>
<div class="section">
<h1 id="x4341505455524553">CAPTURES</h1> A pattern can contain sub-patterns enclosed in parentheses; they describe captures. When a match succeeds, the substrings of the subject string that match captures are stored (captured) for future use. Captures are numbered according to their left parentheses. For instance, in the pattern &#8220;(a*(.)%w(%s*))&#8221;, the part of the string matching &#8220;a*(.)%w(%s*)&#8221; is stored as the first capture (and therefore has number 1); the character matching &#8216;.&#8217; is captured with number 2, and the part matching &#8220;%s*&#8221; has number 3.<div class="spacer">
</div>
As a special case, the empty capture &#8216;()&#8217; captures the current string position (a number). For instance, if we apply the pattern &#8220;()aa()&#8221; on the string &#8220;flaaap&#8221;, there will be two captures: 2 and 4.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/fnmatch.html">fnmatch(3)</a>, <a class="link-man" href="../html7/re_format.html">re_format(7)</a>, <a class="link-man" href="../html8/httpd.html">httpd(8)</a><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">Roberto Ierusalimschy</span>, <span class="ref-auth">Luiz Henrique de Figueiredo</span>, and <span class="ref-auth">Waldemar Celes</span>, <span class="ref-title">Patterns</span>, <span class="ref-rep">Lua 5.3 Reference Manual</span>, <a class="link-ref" href="http://www.lua.org/manual/5.3/manual.html#6.4.1">http://www.lua.org/manual/5.3/manual.html#6.4.1</a>, <span class="ref-corp">Lua.org</span>, <span class="ref-corp">PUC-Rio</span>, <span class="ref-date">June 2015</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The first implementation of the pattern rules were introduced with Lua 2.5. Almost twenty years later, an implementation based on Lua 5.3.1 appeared in <span class="unix">OpenBSD&#160;5.8</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The pattern matching is derived from the original implementation of the Lua scripting language written by <span class="author">Roberto Ierusalimschy</span>, <span class="author">Waldemar Celes</span>, and <span class="author">Luiz Henrique de Figueiredo</span> at PUC-Rio. It was turned into a native C API for <a class="link-man" href="../html8/httpd.html">httpd(8)</a> by <span class="author">Reyk Floeter</span> &lt;<a class="link-mail" href="mailto:reyk@openbsd.org">reyk@openbsd.org</a>&gt;.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> A notable difference with the Lua implementation is the position in the string returned by captures. It follows the C-style indexing (position starting from 0) instead of Lua-style indexing (position starting from 1).</div>
</div>
</body>
</html>

