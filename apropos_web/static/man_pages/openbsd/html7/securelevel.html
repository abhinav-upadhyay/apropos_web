<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
SECURELEVEL(7)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">securelevel</b> &#8212; <span class="desc">securelevel and its effects</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <span class="unix">OpenBSD</span> kernel provides four levels of system security:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
-1 <span class="emph">Permanently insecure mode</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-hyph">
<li class="list-hyph" style="margin-top: 0.00em;">
<a class="link-man" href="../html8/init.html">init(8)</a> will not attempt to raise the securelevel</li>
<li class="list-hyph" style="margin-top: 0.00em;">
may only be set with <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a> while the system is insecure</li>
<li class="list-hyph" style="margin-top: 0.00em;">
otherwise identical to securelevel 0</li>
</ul>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#160;0 <span class="emph">Insecure mode</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-hyph">
<li class="list-hyph" style="margin-top: 0.00em;">
used during bootstrapping and while the system is single-user</li>
<li class="list-hyph" style="margin-top: 0.00em;">
all devices may be read or written subject to their permissions</li>
<li class="list-hyph" style="margin-top: 0.00em;">
system file flags may be cleared with <a class="link-man" href="../html2/chflags.html">chflags(2)</a></li>
</ul>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#160;1 <span class="emph">Secure mode</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-hyph">
<li class="list-hyph" style="margin-top: 0.00em;">
default mode when system is multi-user</li>
<li class="list-hyph" style="margin-top: 0.00em;">
securelevel may no longer be lowered except by init</li>
<li class="list-hyph" style="margin-top: 0.00em;">
<i class="file">/dev/mem</i> and <i class="file">/dev/kmem</i> may not be written to</li>
<li class="list-hyph" style="margin-top: 0.00em;">
raw disk devices of mounted file systems are read-only</li>
<li class="list-hyph" style="margin-top: 0.00em;">
system immutable and append-only file flags may not be removed</li>
<li class="list-hyph" style="margin-top: 0.00em;">
the <b class="var">fs.posix.setuid</b> <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a> variable may not be changed</li>
<li class="list-hyph" style="margin-top: 0.00em;">
the <b class="var">hw.allowpowerdown</b> <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a> variable may not be changed</li>
<li class="list-hyph" style="margin-top: 0.00em;">
the <b class="var">net.inet.ip.sourceroute</b> <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a> variable may not be changed</li>
<li class="list-hyph" style="margin-top: 0.00em;">
the <b class="var">machdep.kbdreset</b> <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a> variable may not be changed</li>
<li class="list-hyph" style="margin-top: 0.00em;">
the <b class="var">ddb.console</b> and <b class="var">ddb.panic</b> <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a> variables may not be raised</li>
<li class="list-hyph" style="margin-top: 0.00em;">
the <b class="var">machdep.allowaperture</b> <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a> variable may not be raised</li>
<li class="list-hyph" style="margin-top: 0.00em;">
<a class="link-man" href="../html8/gpioctl.html">gpioctl(8)</a> may only access GPIO pins configured at system startup</li>
</ul>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#160;2 <span class="emph">Highly secure mode</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-hyph">
<li class="list-hyph" style="margin-top: 0.00em;">
all effects of securelevel 1</li>
<li class="list-hyph" style="margin-top: 0.00em;">
raw disk devices are always read-only whether mounted or not</li>
<li class="list-hyph" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/settimeofday.html">settimeofday(2)</a> and <a class="link-man" href="../html2/clock_settime.html">clock_settime(2)</a> may not set the time backwards or close to overflow</li>
<li class="list-hyph" style="margin-top: 0.00em;">
<a class="link-man" href="../html4/pf.html">pf(4)</a> filter and NAT rules may not be altered</li>
</ul>
</dd>
</dl>
<div class="spacer">
</div>
Securelevel provides convenient means of &#8220;locking down&#8221; a system to a degree suited to its environment. It is normally set at boot by <a class="link-man" href="../html8/rc.html">rc(8)</a>, or the superuser may raise securelevel at any time by modifying the <b class="var">kern.securelevel</b> <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a> variable. However, only <a class="link-man" href="../html8/init.html">init(8)</a> may lower it once the system has entered secure mode. A kernel built with <b class="flag">option INSECURE</b> in the config file will default to permanently insecure mode.<div class="spacer">
</div>
Highly secure mode may seem Draconian, but is intended as a last line of defence should the superuser account be compromised. Its effects preclude circumvention of file flags by direct modification of a raw disk device, or erasure of a file system by means of <a class="link-man" href="../html8/newfs.html">newfs(8)</a>. Further, it can limit the potential damage of a compromised &#8220;firewall&#8221; by prohibiting the modification of packet filter rules. Preventing the system clock from being set backwards aids in post-mortem analysis and helps ensure the integrity of logs. Precision timekeeping is not affected because the clock may still be slowed.<div class="spacer">
</div>
Because securelevel can be modified with the in-kernel debugger <a class="link-man" href="../html4/ddb.html">ddb(4)</a>, a convenient means of locking it off (if present) is provided at securelevels 1 and 2. This is accomplished by setting <b class="var">ddb.console</b> and <b class="var">ddb.panic</b> to 0 with the <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a> utility.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/rc.securelevel</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
commands that run before the security level changes</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/options.html">options(4)</a>, <a class="link-man" href="../html8/init.html">init(8)</a>, <a class="link-man" href="../html8/rc.html">rc(8)</a>, <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">securelevel</b> manual page first appeared in <span class="unix">OpenBSD&#160;2.6</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The list of securelevel's effects may not be comprehensive.</div>
</div>
</body>
</html>

