<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
SSL_CTX_SET_SESSION_CACHE_MODE(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">SSL_CTX_set_session_cache_mode</b>, <b class="name">SSL_CTX_get_session_cache_mode</b> &#8212; <span class="desc">enable/disable session caching</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">openssl/ssl.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">long</i><br/>
<b class="fname">SSL_CTX_set_session_cache_mode</b>(<i class="farg" style="white-space:nowrap;">SSL_CTX ctx</i>, <i class="farg" style="white-space:nowrap;">long mode</i>);<div class="spacer">
</div>
<i class="ftype">long</i><br/>
<b class="fname">SSL_CTX_get_session_cache_mode</b>(<i class="farg" style="white-space:nowrap;">SSL_CTX ctx</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">SSL_CTX_set_session_cache_mode</b>() enables/disables session caching by setting the operational mode for <i class="arg">ctx</i> to <i class="arg">mode</i>.<div class="spacer">
</div>
<b class="fname">SSL_CTX_get_session_cache_mode</b>() returns the currently used cache mode.</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1> The OpenSSL library can store/retrieve SSL/TLS sessions for later reuse. The sessions can be held in memory for each <i class="farg">ctx</i>, if more than one <span class="type">SSL_CTX</span> object is being maintained, the sessions are unique for each <span class="type">SSL_CTX</span> object.<div class="spacer">
</div>
In order to reuse a session, a client must send the session's id to the server. It can only send exactly one id. The server then either agrees to reuse the session or it starts a full handshake (to create a new session).<div class="spacer">
</div>
A server will lookup up the session in its internal session storage. If the session is not found in internal storage or lookups for the internal storage have been deactivated (<span class="define">SSL_SESS_CACHE_NO_INTERNAL_LOOKUP</span>), the server will try the external storage if available.<div class="spacer">
</div>
Since a client may try to reuse a session intended for use in a different context, the session id context must be set by the server (see <a class="link-man" href="../html3/SSL_CTX_set_session_id_context.html">SSL_CTX_set_session_id_context(3)</a>).<div class="spacer">
</div>
The following session cache modes and modifiers are available:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SSL_SESS_CACHE_OFF</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
No session caching for client or server takes place.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SSL_SESS_CACHE_CLIENT</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Client sessions are added to the session cache. As there is no reliable way for the OpenSSL library to know whether a session should be reused or which session to choose (due to the abstract BIO layer the SSL engine does not have details about the connection), the application must select the session to be reused by using the <a class="link-man" href="../html3/SSL_set_session.html">SSL_set_session(3)</a> function. This option is not activated by default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SSL_SESS_CACHE_SERVER</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Server sessions are added to the session cache. When a client proposes a session to be reused, the server looks for the corresponding session in (first) the internal session cache (unless <span class="define">SSL_SESS_CACHE_NO_INTERNAL_LOOKUP</span> is set), then (second) in the external cache if available. If the session is found, the server will try to reuse the session. This is the default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SSL_SESS_CACHE_BOTH</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable both <span class="define">SSL_SESS_CACHE_CLIENT</span> and <span class="define">SSL_SESS_CACHE_SERVER</span> at the same time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SSL_SESS_CACHE_NO_AUTO_CLEAR</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Normally the session cache is checked for expired sessions every 255 connections using the <a class="link-man" href="../html3/SSL_CTX_flush_sessions.html">SSL_CTX_flush_sessions(3)</a> function. Since this may lead to a delay which cannot be controlled, the automatic flushing may be disabled and <a class="link-man" href="../html3/SSL_CTX_flush_sessions.html">SSL_CTX_flush_sessions(3)</a> can be called explicitly by the application.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SSL_SESS_CACHE_NO_INTERNAL_LOOKUP</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By setting this flag, session-resume operations in an SSL/TLS server will not automatically look up sessions in the internal cache, even if sessions are automatically stored there. If external session caching callbacks are in use, this flag guarantees that all lookups are directed to the external cache. As automatic lookup only applies for SSL/TLS servers, the flag has no effect on clients.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SSL_SESS_CACHE_NO_INTERNAL_STORE</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Depending on the presence of <span class="define">SSL_SESS_CACHE_CLIENT</span> and/or <span class="define">SSL_SESS_CACHE_SERVER</span>, sessions negotiated in an SSL/TLS handshake may be cached for possible reuse. Normally a new session is added to the internal cache as well as any external session caching (callback) that is configured for the <span class="type">SSL_CTX</span>. This flag will prevent sessions being stored in the internal cache (though the application can add them manually using <a class="link-man" href="../html3/SSL_CTX_add_session.html">SSL_CTX_add_session(3)</a>). Note: in any SSL/TLS servers where external caching is configured, any successful session lookups in the external cache (e.g., for session-resume requests) would normally be copied into the local cache before processing continues &#8211; this flag prevents these additions to the internal cache as well.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SSL_SESS_CACHE_NO_INTERNAL</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable both <span class="define">SSL_SESS_CACHE_NO_INTERNAL_LOOKUP</span> and <span class="define">SSL_SESS_CACHE_NO_INTERNAL_STORE</span> at the same time.</dd>
</dl>
<div class="spacer">
</div>
The default mode is <span class="define">SSL_SESS_CACHE_SERVER</span>.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">SSL_CTX_set_session_cache_mode</b>() returns the previously set cache mode.<div class="spacer">
</div>
<b class="fname">SSL_CTX_get_session_cache_mode</b>() returns the currently set cache mode.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/ssl.html">ssl(3)</a>, <a class="link-man" href="../html3/SSL_CTX_add_session.html">SSL_CTX_add_session(3)</a>, <a class="link-man" href="../html3/SSL_CTX_flush_sessions.html">SSL_CTX_flush_sessions(3)</a>, <a class="link-man" href="../html3/SSL_CTX_sess_number.html">SSL_CTX_sess_number(3)</a>, <a class="link-man" href="../html3/SSL_CTX_sess_set_cache_size.html">SSL_CTX_sess_set_cache_size(3)</a>, <a class="link-man" href="../html3/SSL_CTX_sess_set_get_cb.html">SSL_CTX_sess_set_get_cb(3)</a>, <a class="link-man" href="../html3/SSL_CTX_set_session_id_context.html">SSL_CTX_set_session_id_context(3)</a>, <a class="link-man" href="../html3/SSL_CTX_set_timeout.html">SSL_CTX_set_timeout(3)</a>, <a class="link-man" href="../html3/SSL_session_reused.html">SSL_session_reused(3)</a>, <a class="link-man" href="../html3/SSL_set_session.html">SSL_set_session(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> <span class="define">SSL_SESS_CACHE_NO_INTERNAL_STORE</span> and <span class="define">SSL_SESS_CACHE_NO_INTERNAL</span> were introduced in OpenSSL 0.9.6h.</div>
</div>
</body>
</html>

