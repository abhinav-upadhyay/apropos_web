<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
SKEYLOOKUP(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">atob8</b>, <b class="name">backspace</b>, <b class="name">btoa8</b>, <b class="name">btoe</b>, <b class="name">etob</b>, <b class="name">f</b>, <b class="name">htoi</b>, <b class="name">keycrunch</b>, <b class="name">put8</b>, <b class="name">readpass</b>, <b class="name">readskey</b>, <b class="name">rip</b>, <b class="name">sevenbit</b>, <b class="name">skey_authenticate</b>, <b class="name">skey_get_algorithm</b>, <b class="name">skey_haskey</b>, <b class="name">skey_keyinfo</b>, <b class="name">skey_passcheck</b>, <b class="name">skey_set_algorithm</b>, <b class="name">skey_unlock</b>, <b class="name">skeychallenge</b>, <b class="name">skeychallenge2</b>, <b class="name">skeygetnext</b>, <b class="name">skeylookup</b>, <b class="name">skeyverify</b>, <b class="name">skipspace</b> &#8212; <span class="desc">S/Key library functions</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">skey.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">atob8</b>(<i class="farg" style="white-space:nowrap;">char *out</i>, <i class="farg" style="white-space:nowrap;">char *in</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">backspace</b>(<i class="farg" style="white-space:nowrap;">char *buf</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">btoa8</b>(<i class="farg" style="white-space:nowrap;">char *out</i>, <i class="farg" style="white-space:nowrap;">char *in</i>);<div class="spacer">
</div>
<i class="ftype">char *</i><br/>
<b class="fname">btoe</b>(<i class="farg" style="white-space:nowrap;">char *engout</i>, <i class="farg" style="white-space:nowrap;">char *c</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">etob</b>(<i class="farg" style="white-space:nowrap;">char *out</i>, <i class="farg" style="white-space:nowrap;">char *e</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">f</b>(<i class="farg" style="white-space:nowrap;">char *x</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">htoi</b>(<i class="farg" style="white-space:nowrap;">int h</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">keycrunch</b>(<i class="farg" style="white-space:nowrap;">char *result</i>, <i class="farg" style="white-space:nowrap;">char *seed</i>, <i class="farg" style="white-space:nowrap;">char *passwd</i>);<div class="spacer">
</div>
<i class="ftype">char *</i><br/>
<b class="fname">put8</b>(<i class="farg" style="white-space:nowrap;">char *out</i>, <i class="farg" style="white-space:nowrap;">char *s</i>);<div class="spacer">
</div>
<i class="ftype">char *</i><br/>
<b class="fname">readpass</b>(<i class="farg" style="white-space:nowrap;">char *buf</i>, <i class="farg" style="white-space:nowrap;">int n</i>);<div class="spacer">
</div>
<i class="ftype">char *</i><br/>
<b class="fname">readskey</b>(<i class="farg" style="white-space:nowrap;">char *buf</i>, <i class="farg" style="white-space:nowrap;">int n</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">rip</b>(<i class="farg" style="white-space:nowrap;">char *buf</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">sevenbit</b>(<i class="farg" style="white-space:nowrap;">char *s</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">skey_authenticate</b>(<i class="farg" style="white-space:nowrap;">char *user</i>);<div class="spacer">
</div>
<i class="ftype">const char *</i><br/>
<b class="fname">skey_get_algorithm</b>(<i class="farg" style="white-space:nowrap;">void</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">skey_haskey</b>(<i class="farg" style="white-space:nowrap;">char *user</i>);<div class="spacer">
</div>
<i class="ftype">char *</i><br/>
<b class="fname">skey_keyinfo</b>(<i class="farg" style="white-space:nowrap;">char *user</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">skey_passcheck</b>(<i class="farg" style="white-space:nowrap;">char *user</i>, <i class="farg" style="white-space:nowrap;">char *passwd</i>);<div class="spacer">
</div>
<i class="ftype">char *</i><br/>
<b class="fname">skey_set_algorithm</b>(<i class="farg" style="white-space:nowrap;">char *new</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">skey_unlock</b>(<i class="farg" style="white-space:nowrap;">struct skey *rec</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">skeychallenge</b>(<i class="farg" style="white-space:nowrap;">struct skey *rec</i>, <i class="farg" style="white-space:nowrap;">char *user</i>, <i class="farg" style="white-space:nowrap;">char *buf</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">skeychallenge2</b>(<i class="farg" style="white-space:nowrap;">int fd</i>, <i class="farg" style="white-space:nowrap;">struct skey *rec</i>, <i class="farg" style="white-space:nowrap;">char *user</i>, <i class="farg" style="white-space:nowrap;">char *buf</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">skeygetnext</b>(<i class="farg" style="white-space:nowrap;">struct skey *rec</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">skeylookup</b>(<i class="farg" style="white-space:nowrap;">struct skey *rec</i>, <i class="farg" style="white-space:nowrap;">char *user</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">skeyverify</b>(<i class="farg" style="white-space:nowrap;">struct skey *rec</i>, <i class="farg" style="white-space:nowrap;">char *response</i>);<div class="spacer">
</div>
<i class="ftype">char *</i><br/>
<b class="fname">skipspace</b>(<i class="farg" style="white-space:nowrap;">char *</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> These functions implement the S/Key one time password authentication mechanism.<div class="spacer">
</div>
The <b class="fname">atob8</b>() function converts the 16-byte hex string <i class="farg">in</i> to an 8-byte binary array stored in <i class="farg">out</i>. The <b class="fname">atob8</b>() function returns 0 on success and -1 if an invalid hex character is encountered.<div class="spacer">
</div>
The <b class="fname">backspace</b>() function removes backspaced over characters from <i class="farg">buf</i>. Note that <b class="fname">backspace</b>() assumes the actual backspace character is 0x8 (^H).<div class="spacer">
</div>
The <b class="fname">btoa8</b>() function converts the 8-byte binary array <i class="farg">in</i> to a 16-byte string of hex digits stored in <i class="farg">out</i>; the caller must supply enough space (17 bytes including the final NUL). The <b class="fname">btoa8</b>() function returns 0 on success and -1 if an error occurred.<div class="spacer">
</div>
The <b class="fname">btoe</b>() function encodes the 8 bytes in <i class="farg">c</i> into a string of 6 English words, stored in <i class="farg">engout</i>. The caller must supply enough space (30 bytes including the final NUL) to store the words. The <b class="fname">btoe</b>() function returns <i class="farg">engout</i>.<div class="spacer">
</div>
The <b class="fname">etob</b>() function converts the 6 English words in <i class="farg">e</i> into an 8-byte binary representation. The <b class="fname">etob</b>() function returns 1 if the words are all in the database and parity is correct, 0 if a word is not in the database, -1 if the number of words is incorrect, or -2 if there is a parity error.<div class="spacer">
</div>
The <b class="fname">f</b>() function is a one-way hash that overwrites the 8-byte input buffer <i class="farg">x</i> with the hashed result.<div class="spacer">
</div>
The <b class="fname">htoi</b>() function converts a single hex digit <i class="farg">h</i> to an integer. The <b class="fname">htoi</b>() function returns the converted integer on success or -1 if <i class="farg">h</i> not a valid hex digit.<div class="spacer">
</div>
The <b class="fname">keycrunch</b>() function concatenates the <i class="farg">seed</i> and <i class="farg">passwd</i>, runs them through a hash function and collapses the <i class="farg">result</i> to 64 bits. The <b class="fname">keycrunch</b>() function returns 0 on success or -1 if there is a memory allocation failure.<div class="spacer">
</div>
The <b class="fname">put8</b>() function converts the 8 bytes stored in <i class="farg">s</i> into a series of 4 16-bit hex digit stored in <i class="farg">out</i>. There must be at least 20 bytes (including the NUL) in the output buffer, <i class="farg">out</i>. The <b class="fname">put8</b>() function returns <i class="farg">out</i>.<div class="spacer">
</div>
The <b class="fname">readpass</b>() function reads up to <i class="farg">n</i> characters from standard input with echo turned off, converting the resulting string to 7 bits, storing the result in <i class="farg">buf</i>. The <b class="fname">readpass</b>() function returns <i class="farg">buf</i>.<div class="spacer">
</div>
The <b class="fname">readskey</b>() function reads up to <i class="farg">n</i> characters from standard input with echo turned on, converting the resulting string to 7 bits, storing the result in <i class="farg">buf</i>. The <b class="fname">readskey</b>() function returns <i class="farg">buf</i>.<div class="spacer">
</div>
The <b class="fname">rip</b>() function strips trailing linefeeds and carriage returns from <i class="farg">buf</i>.<div class="spacer">
</div>
The <b class="fname">sevenbit</b>() function strips the high bit from each character in <i class="farg">s</i>, converting the characters to seven bit ASCII.<div class="spacer">
</div>
The <b class="fname">skey_authenticate</b>() function presents the <i class="farg">user</i> with an S/Key challenge and authenticates the response. The <b class="fname">skey_authenticate</b>() function returns 0 if authentication is successful or -1 if not.<div class="spacer">
</div>
The <b class="fname">skey_get_algorithm</b>() function returns a string corresponding to the hash algorithm for the current user. The default algorithm is &#8220;md5&#8221;.<div class="spacer">
</div>
The <b class="fname">skey_haskey</b>() function returns 0 if the <i class="farg">user</i> exists in the S/Key database, 1 if the user does not exist, or -1 if there was an error reading the database.<div class="spacer">
</div>
The <b class="fname">skey_keyinfo</b>() function returns a string containing the current sequence number and seed for <i class="farg">user</i>. The returned string points to internal static storage that will be overwritten by subsequent calls to <b class="fname">skey_keyinfo</b>().<div class="spacer">
</div>
The <b class="fname">skey_passcheck</b>() function checks a <i class="farg">user</i> and <i class="farg">passwd</i> pair against the S/Key database. It returns 0 on successful authentication or -1 on failure.<div class="spacer">
</div>
The <b class="fname">skey_set_algorithm</b>() function sets the user's hash algorithm based on the string <i class="farg">new</i>. The <b class="fname">skey_set_algorithm</b>() function returns the specified algorithm if it is supported, or the null pointer if the hash algorithm is not supported.<div class="spacer">
</div>
The <b class="fname">skey_unlock</b>() function unlocks the record in the S/Key database specified by <i class="farg">rec</i>. The <b class="fname">skey_unlock</b>() function returns 0 on success or -1 on failure. Either way, the S/Key database is not closed nor is the database file pointer affected.<div class="spacer">
</div>
The <b class="fname">skeychallenge</b>() function stores the (potentially fake) S/Key challenge for <i class="farg">user</i> in <i class="farg">buf</i>, which is at least SKEY_MAX_CHALLENGE bytes long. It also fills in the skey struct <i class="farg">rec</i> and locks the user's record in the S/Key database. The <b class="fname">skeychallenge</b>() function returns 0 on success or -1 on failure. On success the S/Key database remains open and the read/write file pointer is set to the beginning of the record.<div class="spacer">
</div>
The <b class="fname">skeychallenge2</b>() function is identical to <b class="fname">skeychallenge</b>() except that instead of opening the user's entry in the S/Key database, the open file referenced by <i class="arg">fd</i> is used instead. When <i class="arg">fd</i> is -1, the behavior is equivalent to <b class="fname">skeychallenge</b>().<div class="spacer">
</div>
The <b class="fname">skeygetnext</b>() function stores the next record in the S/Key database in <i class="farg">rec</i> and locks that record in the S/Key database. The <b class="fname">skeygetnext</b>() function returns 0 on success, 1 if there are no more entries, or -1 if there was an error accessing the S/Key database. The S/Key database remains open after a call to <b class="fname">skeygetnext</b>(). If no error was encountered accessing the S/Key database, the read/write file pointer is set to the beginning of the record or at EOF if there are no more records.<div style="height: 0.00em;">
&#160;</div>
Because it exposes other users' S/Key records, only the superuser may use <b class="fname">skeygetnext</b>().<div class="spacer">
</div>
The <b class="fname">skeylookup</b>() function looks up the specified <i class="farg">user</i> in the S/Key database then fills in the skey struct <i class="farg">rec</i> and locks the user's record in the database. The <b class="fname">skeylookup</b>() function returns 0 on success, 1 if <i class="farg">user</i> was not found, or -1 if there was an error accessing the S/Key database. If no error was encountered accessing the S/Key database, the read/write file pointer is set to the beginning of the record.<div class="spacer">
</div>
The <b class="fname">skeyverify</b>() function verifies the user's <i class="farg">response</i> based on the S/Key record <i class="farg">rec</i>. It returns 0 on success (updating the database), 1 on failure, or -1 if there was an error accessing the database. The database is always closed by a call to <b class="fname">skeyverify</b>().</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/skey.html">skey(1)</a>, <a class="link-man" href="../html1/skeyinit.html">skeyinit(1)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> There is no standard API for S/Key. The de facto standard is the free S/Key distribution released by Bellcore.<div class="spacer">
</div>
The following functions are extensions and do not appear in the original Bellcore S/Key distribution: <b class="fname">readskey</b>(), <b class="fname">skey_authenticate</b>(), <b class="fname">skey_get_algorithm</b>(), <b class="fname">skey_haskey</b>(), <b class="fname">skey_keyinfo</b>(), <b class="fname">skey_passcheck</b>(), <b class="fname">skey_set_algorithm</b>(), <b class="fname">skey_unlock</b>().<div class="spacer">
</div>
S/Key is a Trademark of Bellcore.</div>
</div>
</body>
</html>

