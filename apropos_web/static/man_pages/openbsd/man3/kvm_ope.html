<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
KVM_OPEN(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">kvm_open</b>, <b class="name">kvm_openfiles</b>, <b class="name">kvm_close</b> &#8212; <span class="desc">initialize kernel virtual memory access</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">fcntl.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">kvm.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">kvm_t *</i><br/>
<b class="fname">kvm_open</b>(<i class="farg" style="white-space:nowrap;">const char *execfile</i>, <i class="farg" style="white-space:nowrap;">const char *corefile</i>, <i class="farg" style="white-space:nowrap;">const char *swapfile</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">const char *errstr</i>);<div class="spacer">
</div>
<i class="ftype">kvm_t *</i><br/>
<b class="fname">kvm_openfiles</b>(<i class="farg" style="white-space:nowrap;">const char *execfile</i>, <i class="farg" style="white-space:nowrap;">const char *corefile</i>, <i class="farg" style="white-space:nowrap;">const char *swapfile</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">char *errbuf</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">kvm_close</b>(<i class="farg" style="white-space:nowrap;">kvm_t *kd</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The functions <b class="fname">kvm_open</b>() and <b class="fname">kvm_openfiles</b>() return a descriptor used to access kernel virtual memory via the <a class="link-man" href="../html3/kvm.html">kvm(3)</a> library routines. Both active kernels and crash dumps are accessible through this interface.<div class="spacer">
</div>
<i class="farg">execfile</i> is the executable image of the kernel being examined. This file must contain a symbol table. If this argument is <span class="define">NULL</span>, the currently running system is assumed, which is indicated by <span class="define">_PATH_KSYMS</span>, if it exists, otherwise <span class="define">_PATH_UNIX</span> is used. Both are defined in <b class="includes">&lt;<a class="link-includes">paths.h</a>&gt;</b>.<div class="spacer">
</div>
<i class="farg">corefile</i> is the kernel memory device file. It can be either <i class="file">/dev/mem</i> or a crash dump core generated by <a class="link-man" href="../html8/savecore.html">savecore(8)</a>. If <i class="farg">corefile</i> is <span class="define">NULL</span>, the default indicated by <span class="define">_PATH_MEM</span> from <b class="includes">&lt;<a class="link-includes">paths.h</a>&gt;</b> is used.<div class="spacer">
</div>
<i class="farg">swapfile</i> should indicate the swap device. If <span class="define">NULL</span>, no swap device will be used.<div class="spacer">
</div>
The <i class="farg">flags</i> argument indicates read/write access as in <a class="link-man" href="../html2/open.html">open(2)</a> and applies only to the core file. Only <span class="define">O_RDONLY</span>, <span class="define">O_WRONLY</span>, and <span class="define">O_RDWR</span> are permitted. A special value <span class="define">KVM_NO_FILES</span> can be specified which will cause no files to be opened and the handle can only be used on live kernels on a limited subset of all kvm operations.<div class="spacer">
</div>
There are two open routines which differ only with respect to the error mechanism. One provides backward compatibility with the SunOS kvm library, while the other provides an improved error reporting framework.<div class="spacer">
</div>
The <b class="fname">kvm_open</b>() function is the Sun kvm compatible open call. Here, the <i class="farg">errstr</i> argument indicates how errors should be handled. If it is <span class="define">NULL</span>, no errors are reported and the application cannot know the specific nature of the failed kvm call. If it is not <span class="define">NULL</span>, errors are printed to stderr with <i class="farg">errstr</i> prepended to the message, as in <a class="link-man" href="../html3/perror.html">perror(3)</a>. Normally, the name of the program is used here. The string is assumed to persist at least until the corresponding <b class="fname">kvm_close</b>() call.<div class="spacer">
</div>
The <b class="fname">kvm_openfiles</b>() function provides <span class="unix">BSD</span> style error reporting. Here, error messages are not printed out by the library. Instead, the application obtains the error message corresponding to the most recent kvm library call using <b class="fname">kvm_geterr</b>() (see <a class="link-man" href="../html3/kvm_geterr.html">kvm_geterr(3)</a>). The results are undefined if the most recent kvm call did not produce an error. Since <b class="fname">kvm_geterr</b>() requires a kvm descriptor, but the open routines return <span class="define">NULL</span> on failure, <b class="fname">kvm_geterr</b>() cannot be used to get the error message if open fails. Thus, <b class="fname">kvm_openfiles</b>() will place any error message in the <i class="farg">errbuf</i> argument. This buffer should be <span class="define">_POSIX2_LINE_MAX</span> characters large (from <b class="includes">&lt;<a class="link-includes">limits.h</a>&gt;</b>).</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> The <b class="fname">kvm_open</b>() and <b class="fname">kvm_openfiles</b>() functions both return a descriptor to be used in all subsequent kvm library calls. The library is fully re-entrant. On failure, <span class="define">NULL</span> is returned, in which case <b class="fname">kvm_openfiles</b>() writes the error message into <i class="farg">errbuf</i>.<div class="spacer">
</div>
The <b class="fname">kvm_close</b>() function returns 0 on success and -1 on failure.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/open.html">open(2)</a>, <a class="link-man" href="../html3/kvm.html">kvm(3)</a>, <a class="link-man" href="../html3/kvm_geterr.html">kvm_geterr(3)</a>, <a class="link-man" href="../html3/kvm_getprocs.html">kvm_getprocs(3)</a>, <a class="link-man" href="../html3/kvm_nlist.html">kvm_nlist(3)</a>, <a class="link-man" href="../html3/kvm_read.html">kvm_read(3)</a></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> There should not be two open calls. The ill-defined error semantics of the Sun library and the desire to have a backward-compatible library for <span class="unix">BSD</span> left little choice.</div>
</div>
</body>
</html>

