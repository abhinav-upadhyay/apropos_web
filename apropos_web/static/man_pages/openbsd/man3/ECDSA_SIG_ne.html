<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
ECDSA_SIG_NEW(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">ECDSA_SIG_new</b>, <b class="name">ECDSA_SIG_free</b>, <b class="name">i2d_ECDSA_SIG</b>, <b class="name">d2i_ECDSA_SIG</b>, <b class="name">ECDSA_size</b>, <b class="name">ECDSA_sign_setup</b>, <b class="name">ECDSA_sign</b>, <b class="name">ECDSA_sign_ex</b>, <b class="name">ECDSA_verify</b>, <b class="name">ECDSA_do_sign</b>, <b class="name">ECDSA_do_sign_ex</b>, <b class="name">ECDSA_do_verify</b>, <b class="name">ECDSA_OpenSSL</b>, <b class="name">ECDSA_get_default_method</b>, <b class="name">ECDSA_get_ex_data</b>, <b class="name">ECDSA_get_ex_new_index</b>, <b class="name">ECDSA_set_default_method</b>, <b class="name">ECDSA_set_ex_data</b>, <b class="name">ECDSA_set_method</b> &#8212; <span class="desc">Elliptic Curve Digital Signature Algorithm</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">openssl/ecdsa.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">ECDSA_SIG*</i><br/>
<b class="fname">ECDSA_SIG_new</b>(<i class="farg">void</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">ECDSA_SIG_free</b>(<i class="farg">ECDSA_SIG *sig</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">i2d_ECDSA_SIG</b>(<i class="farg">const ECDSA_SIG *sig</i>, <i class="farg">unsigned char **pp</i>);<div class="spacer">
</div>
<i class="ftype">ECDSA_SIG*</i><br/>
<b class="fname">d2i_ECDSA_SIG</b>(<i class="farg">ECDSA_SIG **sig</i>, <i class="farg">const unsigned char **pp</i>, <i class="farg">long len</i>);<div class="spacer">
</div>
<i class="ftype">ECDSA_SIG*</i><br/>
<b class="fname">ECDSA_do_sign</b>(<i class="farg">const unsigned char *dgst</i>, <i class="farg">int dgst_len</i>, <i class="farg">EC_KEY *eckey</i>);<div class="spacer">
</div>
<i class="ftype">ECDSA_SIG*</i><br/>
<b class="fname">ECDSA_do_sign_ex</b>(<i class="farg">const unsigned char *dgst</i>, <i class="farg">int dgstlen</i>, <i class="farg">const BIGNUM *kinv</i>, <i class="farg">const BIGNUM *rp</i>, <i class="farg">EC_KEY *eckey</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">ECDSA_do_verify</b>(<i class="farg">const unsigned char *dgst</i>, <i class="farg">int dgst_len</i>, <i class="farg">const ECDSA_SIG *sig</i>, <i class="farg">EC_KEY* eckey</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">ECDSA_sign_setup</b>(<i class="farg">EC_KEY *eckey</i>, <i class="farg">BN_CTX *ctx</i>, <i class="farg">BIGNUM **kinv</i>, <i class="farg">BIGNUM **rp</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">ECDSA_sign</b>(<i class="farg">int type</i>, <i class="farg">const unsigned char *dgst</i>, <i class="farg">int dgstlen</i>, <i class="farg">unsigned char *sig</i>, <i class="farg">unsigned int *siglen</i>, <i class="farg">EC_KEY *eckey</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">ECDSA_sign_ex</b>(<i class="farg">int type</i>, <i class="farg">const unsigned char *dgst</i>, <i class="farg">int dgstlen</i>, <i class="farg">unsigned char *sig</i>, <i class="farg">unsigned int *siglen</i>, <i class="farg">const BIGNUM *kinv</i>, <i class="farg">const BIGNUM *rp</i>, <i class="farg">EC_KEY *eckey</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">ECDSA_verify</b>(<i class="farg">int type</i>, <i class="farg">const unsigned char *dgst</i>, <i class="farg">int dgstlen</i>, <i class="farg">const unsigned char *sig</i>, <i class="farg">int siglen</i>, <i class="farg">EC_KEY *eckey</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">ECDSA_size</b>(<i class="farg">const EC_KEY *eckey</i>);<div class="spacer">
</div>
<i class="ftype">const ECDSA_METHOD*</i><br/>
<b class="fname">ECDSA_OpenSSL</b>(<i class="farg">void</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">ECDSA_set_default_method</b>(<i class="farg">const ECDSA_METHOD *meth</i>);<div class="spacer">
</div>
<i class="ftype">const ECDSA_METHOD*</i><br/>
<b class="fname">ECDSA_get_default_method</b>(<i class="farg">void</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">ECDSA_set_method</b>(<i class="farg">EC_KEY *eckey</i>, <i class="farg">const ECDSA_METHOD *meth</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">ECDSA_get_ex_new_index</b>(<i class="farg">long argl</i>, <i class="farg">void *argp</i>, <i class="farg">CRYPTO_EX_new *new_func</i>, <i class="farg">CRYPTO_EX_dup *dup_func</i>, <i class="farg">CRYPTO_EX_free *free_func</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">ECDSA_set_ex_data</b>(<i class="farg">EC_KEY *d</i>, <i class="farg">int idx</i>, <i class="farg">void *arg</i>);<div class="spacer">
</div>
<i class="ftype">void*</i><br/>
<b class="fname">ECDSA_get_ex_data</b>(<i class="farg">EC_KEY *d</i>, <i class="farg">int idx</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <span class="type">ECDSA_SIG</span> structure consists of two <span class="type">BIGNUM</span>s for the <i class="farg">r</i> and <i class="farg">s</i> value of an ECDSA signature (see X9.62 or FIPS 186-2).<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct { 
	BIGNUM *r; 
	BIGNUM *s; 
} ECDSA_SIG;</pre>
<div class="spacer">
</div>
<b class="fname">ECDSA_SIG_new</b>() allocates a new <span class="type">ECDSA_SIG</span> structure (note: this function also allocates the <span class="type">BIGNUM</span>s) and initialize it.<div class="spacer">
</div>
<b class="fname">ECDSA_SIG_free</b>() frees the <span class="type">ECDSA_SIG</span> structure <i class="farg">sig</i>.<div class="spacer">
</div>
<b class="fname">i2d_ECDSA_SIG</b>() creates the DER encoding of the ECDSA signature <i class="farg">sig</i> and writes the encoded signature to <i class="farg">*pp</i> (note: if <i class="farg">pp</i> is <span class="define">NULL</span>, <b class="fname">i2d_ECDSA_SIG</b>() returns the expected length in bytes of the DER encoded signature). <b class="fname">i2d_ECDSA_SIG</b>() returns the length of the DER encoded signature (or 0 on error).<div class="spacer">
</div>
<b class="fname">d2i_ECDSA_SIG</b>() decodes a DER encoded ECDSA signature and returns the decoded signature in a newly allocated <span class="type">ECDSA_SIG</span> structure. <i class="farg">*sig</i> points to the buffer containing the DER encoded signature of size <i class="farg">len</i>.<div class="spacer">
</div>
<b class="fname">ECDSA_size</b>() returns the maximum length of a DER encoded ECDSA signature created with the private EC key <i class="farg">eckey</i>.<div class="spacer">
</div>
<b class="fname">ECDSA_sign_setup</b>() may be used to precompute parts of the signing operation. <i class="farg">eckey</i> is the private EC key and <i class="farg">ctx</i> is a pointer to a <span class="type">BN_CTX</span> structure (or <span class="define">NULL</span>). The precomputed values or returned in <i class="farg">kinv</i> and <i class="farg">rp</i> and can be used in a later call to <i class="farg">ECDSA_sign_ex</i> or <i class="farg">ECDSA_do_sign_ex</i>.<div class="spacer">
</div>
<b class="fname">ECDSA_sign</b>() is wrapper function for <i class="farg">ECDSA_sign_ex</i> with <i class="farg">kinv</i> and <i class="farg">rp</i> set to <span class="define">NULL</span>.<div class="spacer">
</div>
<b class="fname">ECDSA_sign_ex</b>() computes a digital signature of the <i class="farg">dgstlen</i> bytes hash value <i class="farg">dgst</i> using the private EC key <i class="farg">eckey</i> and the optional pre-computed values <i class="farg">kinv</i> and <i class="farg">rp</i>. The DER encoded signatures is stored in <i class="farg">sig</i> and its length is returned in <i class="farg">siglen</i>. Note: <i class="farg">sig</i> must point to <b class="fname">ECDSA_size</b>() bytes of memory. The parameter <i class="farg">type</i> is ignored.<div class="spacer">
</div>
<b class="fname">ECDSA_verify</b>() verifies that the signature in <i class="farg">sig</i> of size <i class="farg">siglen</i> is a valid ECDSA signature of the hash value <i class="farg">dgst</i> of size <i class="farg">dgstlen</i> using the public key <i class="farg">eckey</i>. The parameter <i class="farg">type</i> is ignored.<div class="spacer">
</div>
<b class="fname">ECDSA_do_sign</b>() is wrapper function for ECDSA_do_sign_ex with <i class="farg">kinv</i> and <i class="farg">rp</i> set to <span class="define">NULL</span>.<div class="spacer">
</div>
<b class="fname">ECDSA_do_sign_ex</b>() computes a digital signature of the <i class="farg">dgst_len</i> bytes hash value <i class="farg">dgst</i> using the private key <i class="farg">eckey</i> and the optional pre-computed values <i class="farg">kinv</i> and <i class="farg">rp</i>. The signature is returned in a newly allocated <span class="type">ECDSA_SIG</span> structure (or <span class="define">NULL</span> on error).<div class="spacer">
</div>
<b class="fname">ECDSA_do_verify</b>() verifies that the signature <i class="farg">sig</i> is a valid ECDSA signature of the hash value <i class="farg">dgst</i> of size <i class="farg">dgst_len</i> using the public key <i class="farg">eckey</i>.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">ECDSA_size</b>() returns the maximum length signature or 0 on error.<div class="spacer">
</div>
<b class="fname">ECDSA_sign_setup</b>() and <b class="fname">ECDSA_sign</b>() return 1 if successful or 0 on error.<div class="spacer">
</div>
<b class="fname">ECDSA_verify</b>() and <b class="fname">ECDSA_do_verify</b>() return 1 for a valid signature, 0 for an invalid signature and -1 on error. The error codes can be obtained by <a class="link-man" href="../html3/ERR_get_error.html">ERR_get_error(3)</a>.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Creating a ECDSA signature of given SHA-1 hash value using the named curve secp192k1.<div class="spacer">
</div>
First step: Create an <span class="type">EC_KEY</span> object. This part is <span class="emph">not</span> ECDSA specific.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
int ret; 
ECDSA_SIG *sig; 
EC_KEY *eckey; 
 
eckey = EC_KEY_new_by_curve_name(NID_secp192k1); 
if (eckey == NULL) { 
	/* error */ 
} 
if (!EC_KEY_generate_key(eckey)) { 
	/* error */ 
}</pre>
<div class="spacer">
</div>
Second step: compute the ECDSA signature of a SHA-1 hash value using <b class="fname">ECDSA_do_sign</b>()<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
sig = ECDSA_do_sign(digest, 20, eckey); 
if (sig == NULL) { 
	/* error */ 
}</pre>
<div class="spacer">
</div>
or using <b class="fname">ECDSA_sign</b>()<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
unsigned char *buffer, *pp; 
int buf_len; 
 
buf_len = ECDSA_size(eckey); 
buffer  = malloc(buf_len); 
pp = buffer; 
if (!ECDSA_sign(0, dgst, dgstlen, pp, &amp;buf_len, eckey) { 
	/* error */ 
}</pre>
<div class="spacer">
</div>
Third step: Verify the created ECDSA signature using <b class="fname">ECDSA_do_verify</b>()<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">ret = ECDSA_do_verify(digest, 20, sig, eckey);</code></div>
</blockquote>
<div class="spacer">
</div>
or using <b class="fname">ECDSA_verify</b>()<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">ret = ECDSA_verify(0, digest, 20, buffer, buf_len, eckey);</code></div>
</blockquote>
<div class="spacer">
</div>
and finally evaluate the return value:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
if (ret == -1) { 
	/* error */ 
} else if (ret == 0) { 
	/* incorrect signature */ 
} else { 
	/* ret == 1 */ 
	/* signature ok */ 
}</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/dsa.html">dsa(3)</a>, <a class="link-man" href="../html3/rsa.html">rsa(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> ANSI X9.62, US Federal Information Processing Standard FIPS 186-2 (Digital Signature Standard, DSS)</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The ecdsa implementation was first introduced in OpenSSL 0.9.8.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Nils Larsch</span> for the OpenSSL project.</div>
</div>
</body>
</html>

