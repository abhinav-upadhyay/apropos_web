<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
OPENDIR(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">opendir</b>, <b class="name">fdopendir</b>, <b class="name">readdir</b>, <b class="name">readdir_r</b>, <b class="name">telldir</b>, <b class="name">seekdir</b>, <b class="name">rewinddir</b>, <b class="name">closedir</b>, <b class="name">dirfd</b> &#8212; <span class="desc">directory operations</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/types.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">dirent.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">DIR *</i><br/>
<b class="fname">opendir</b>(<i class="farg" style="white-space:nowrap;">const char *filename</i>);<div class="spacer">
</div>
<i class="ftype">DIR *</i><br/>
<b class="fname">fdopendir</b>(<i class="farg" style="white-space:nowrap;">int fd</i>);<div class="spacer">
</div>
<i class="ftype">struct dirent *</i><br/>
<b class="fname">readdir</b>(<i class="farg" style="white-space:nowrap;">DIR *dirp</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">readdir_r</b>(<i class="farg" style="white-space:nowrap;">DIR *dirp</i>, <i class="farg" style="white-space:nowrap;">struct dirent *entry</i>, <i class="farg" style="white-space:nowrap;">struct dirent **result</i>);<div class="spacer">
</div>
<i class="ftype">long</i><br/>
<b class="fname">telldir</b>(<i class="farg" style="white-space:nowrap;">const DIR *dirp</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">seekdir</b>(<i class="farg" style="white-space:nowrap;">DIR *dirp</i>, <i class="farg" style="white-space:nowrap;">long loc</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">rewinddir</b>(<i class="farg" style="white-space:nowrap;">DIR *dirp</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">closedir</b>(<i class="farg" style="white-space:nowrap;">DIR *dirp</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">dirfd</b>(<i class="farg" style="white-space:nowrap;">DIR *dirp</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">opendir</b>() function opens the directory named by <i class="farg">filename</i>, associates a directory stream with it, and returns a pointer to be used to identify the directory stream in subsequent operations. On failure, <span class="define">NULL</span> is returned and <b class="var">errno</b> is set to indicate the error.<div class="spacer">
</div>
The <b class="fname">fdopendir</b>() function is equivalent to <b class="fname">opendir</b>() except that the directory is specified by file descriptor rather than by name. The file offset associated with the file descriptor at the time of the call determines which entries are returned.<div class="spacer">
</div>
Upon successful return from <b class="fname">fdopendir</b>(), the file descriptor is under the control of the system, and if any attempt is made to close the file descriptor or to modify the state of the associated directory, other than by means of <b class="fname">closedir</b>(), <b class="fname">readdir</b>(), <b class="fname">readdir_r</b>(), or <b class="fname">rewinddir</b>(), the behavior is undefined. Upon calling <b class="fname">closedir</b>() the file descriptor shall be closed.<div class="spacer">
</div>
The <b class="fname">readdir</b>() function returns a pointer to the next directory entry in the named directory stream <i class="farg">dirp</i>. It returns <span class="define">NULL</span> upon reaching the end of the directory or detecting an invalid <b class="fname">seekdir</b>() operation.<div class="spacer">
</div>
The <b class="fname">readdir_r</b>() function (much like <b class="fname">readdir</b>()) initializes the <code class="lit">dirent</code> structure referenced by <i class="farg">entry</i> to represent the next directory entry in the named directory stream <i class="farg">dirp</i>, and stores a pointer to this structure at the location referenced by <i class="farg">result</i>. The storage pointed to by <i class="farg">entry</i> must be large enough for a dirent with a <i class="farg">d_name</i> array member containing at least <span class="define">NAME_MAX</span> plus one elements. On successful return, the pointer returned at <i class="farg">*result</i> will have the same value as the argument <i class="farg">entry</i>. Upon reaching the end of the directory stream, this pointer shall have the value <span class="define">NULL</span>.<div class="spacer">
</div>
The <b class="fname">telldir</b>() function returns the current location associated with the named directory stream <i class="farg">dirp</i>. On failure, -1 is returned and <b class="var">errno</b> is set to indicate the error.<div class="spacer">
</div>
The <b class="fname">seekdir</b>() function sets the position of the next <b class="fname">readdir</b>() operation on the named directory stream <i class="farg">dirp</i>. The new position reverts to the one associated with the directory stream when the <b class="fname">telldir</b>() operation was performed. Values returned by <b class="fname">telldir</b>() are good only for the lifetime of the <span class="define">DIR</span> pointer, <i class="farg">dirp</i>, from which they are derived. If the directory is closed and then reopened, the <b class="fname">telldir</b>() value may be invalidated due to undetected directory compaction.<div class="spacer">
</div>
The <b class="fname">rewinddir</b>() function resets the position of the named directory stream <i class="farg">dirp</i> to the beginning of the directory.<div class="spacer">
</div>
The <b class="fname">closedir</b>() function closes the named directory stream and frees the structure associated with the <i class="farg">dirp</i> pointer, returning 0 on success. On failure, -1 is returned and the global variable <b class="var">errno</b> is set to indicate the error.<div class="spacer">
</div>
The <b class="fname">dirfd</b>() function returns the integer file descriptor associated with the named directory stream <i class="farg">dirp</i> (see <a class="link-man" href="../html2/open.html">open(2)</a>).</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Sample code which searches a directory for entry &#8220;name&#8221; is:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
len = strlen(name); 
dirp = opendir(&quot;.&quot;); 
if (dirp) { 
	while ((dp = readdir(dirp)) != NULL) 
		if (dp-&gt;d_namlen == len &amp;&amp; 
		    !strcmp(dp-&gt;d_name, name)) { 
			(void)closedir(dirp); 
			return (FOUND); 
		} 
	(void)closedir(dirp); 
} 
return (NOT_FOUND);</pre>
</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> The <b class="fname">opendir</b>() function will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The supplied <i class="farg">filename</i> is not a directory.</dd>
</dl>
<div class="spacer">
</div>
The <b class="fname">opendir</b>() function may also fail and set <b class="var">errno</b> for any of the errors specified for the routines <a class="link-man" href="../html2/fcntl.html">fcntl(2)</a>, <a class="link-man" href="../html2/fstat.html">fstat(2)</a>, <a class="link-man" href="../html2/open.html">open(2)</a>, and <a class="link-man" href="../html3/malloc.html">malloc(3)</a>.<div class="spacer">
</div>
The <b class="fname">fdopendir</b>() function will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">fd</i> argument is not a valid file descriptor open for reading.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The descriptor <i class="farg">fd</i> is not associated with a directory.</dd>
</dl>
<div class="spacer">
</div>
The <b class="fname">readdir</b>() and <b class="fname">readdir_r</b>() functions may also fail and set <b class="var">errno</b> for any of the errors specified for the routine <a class="link-man" href="../html2/getdents.html">getdents(2)</a>.<div class="spacer">
</div>
The <b class="fname">telldir</b>() function may also fail and set <b class="var">errno</b> for any of the errors specified for the routine <a class="link-man" href="../html3/realloc.html">realloc(3)</a>.<div class="spacer">
</div>
The <b class="fname">closedir</b>() function may also fail and set <b class="var">errno</b> for any of the errors specified for the routine <a class="link-man" href="../html2/close.html">close(2)</a>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/close.html">close(2)</a>, <a class="link-man" href="../html2/getdents.html">getdents(2)</a>, <a class="link-man" href="../html2/lseek.html">lseek(2)</a>, <a class="link-man" href="../html2/open.html">open(2)</a>, <a class="link-man" href="../html5/dir.html">dir(5)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">opendir</b>(), <b class="fname">fdopendir</b>(), <b class="fname">readdir</b>(), <b class="fname">readdir_r</b>(), <b class="fname">telldir</b>(), <b class="fname">seekdir</b>(), <b class="fname">rewinddir</b>(), <b class="fname">closedir</b>(), and <b class="fname">dirfd</b>() functions conform to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">opendir</b>(), <b class="fname">readdir</b>(), <b class="fname">telldir</b>(), <b class="fname">seekdir</b>(), <b class="fname">rewinddir</b>(), <b class="fname">closedir</b>(), and <b class="fname">dirfd</b>() functions appeared in <span class="unix">4.2BSD</span>. The <b class="fname">fdopendir</b>() function appeared in <span class="unix">OpenBSD&#160;5.0</span>.</div>
</div>
</body>
</html>

