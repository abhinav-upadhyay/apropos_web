<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
BN_GENERATE_PRIME(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">BN_generate_prime_ex</b>, <b class="name">BN_is_prime_ex</b>, <b class="name">BN_is_prime_fasttest_ex</b>, <b class="name">BN_GENCB_call</b>, <b class="name">BN_GENCB_set_old</b>, <b class="name">BN_GENCB_set</b>, <b class="name">BN_generate_prime</b>, <b class="name">BN_is_prime</b>, <b class="name">BN_is_prime_fasttest</b> &#8212; <span class="desc">generate primes and test for primality</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">openssl/bn.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BN_generate_prime_ex</b>(<i class="farg">BIGNUM *ret</i>, <i class="farg">int bits</i>, <i class="farg">int safe</i>, <i class="farg">const BIGNUM *add</i>, <i class="farg">const BIGNUM *rem</i>, <i class="farg">BN_GENCB *cb</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BN_is_prime_ex</b>(<i class="farg">const BIGNUM *p</i>, <i class="farg">int nchecks</i>, <i class="farg">BN_CTX *ctx</i>, <i class="farg">BN_GENCB *cb</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BN_is_prime_fasttest_ex</b>(<i class="farg">const BIGNUM *p</i>, <i class="farg">int nchecks</i>, <i class="farg">BN_CTX *ctx</i>, <i class="farg">int do_trial_division</i>, <i class="farg">BN_GENCB *cb</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BN_GENCB_call</b>(<i class="farg">BN_GENCB *cb</i>, <i class="farg">int a</i>, <i class="farg">int b</i>);<div class="spacer">
</div>
<b class="macro">#define BN_GENCB_set_old(gencb, callback, cb_arg) ...</b><br/>
<b class="macro">#define BN_GENCB_set(gencb, callback, cb_arg) ...</b><div class="spacer">
</div>
Deprecated:<div class="spacer">
</div>
<br/>
<i class="ftype">BIGNUM *</i><br/>
<b class="fname">BN_generate_prime</b>(<i class="farg">BIGNUM *ret</i>, <i class="farg">int num</i>, <i class="farg">int safe</i>, <i class="farg">BIGNUM *add</i>, <i class="farg">BIGNUM *rem</i>, <i class="farg">void (*callback)(int, int, void *)</i>, <i class="farg">void *cb_arg</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BN_is_prime</b>(<i class="farg">const BIGNUM *a</i>, <i class="farg">int checks</i>, <i class="farg">void (*callback)(int, int, void *)</i>, <i class="farg">BN_CTX *ctx</i>, <i class="farg">void *cb_arg</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BN_is_prime_fasttest</b>(<i class="farg">const BIGNUM *a</i>, <i class="farg">int checks</i>, <i class="farg">void (*callback)(int, int, void *)</i>, <i class="farg">BN_CTX *ctx</i>, <i class="farg">void *cb_arg</i>, <i class="farg">int do_trial_division</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">BN_generate_prime_ex</b>() generates a pseudo-random prime number of bit length <i class="farg">bits</i>. If <i class="farg">ret</i> is not <span class="define">NULL</span>, it will be used to store the number.<div class="spacer">
</div>
If <i class="farg">cb</i> is not <span class="define">NULL</span>, it is used as follows:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
<b class="fname">BN_GENCB_call</b>(<i class="farg">cb</i>, <i class="farg">0</i>, <i class="farg">i</i>) is called after generating the i-th potential prime number.</li>
<li class="list-bul" style="margin-top: 1.00em;">
While the number is being tested for primality, <b class="fname">BN_GENCB_call</b>(<i class="farg">cb</i>, <i class="farg">1</i>, <i class="farg">j</i>) is called as described below.</li>
<li class="list-bul" style="margin-top: 1.00em;">
When a prime has been found, <b class="fname">BN_GENCB_call</b>(<i class="farg">cb</i>, <i class="farg">2</i>, <i class="farg">i</i>) is called.</li>
</ul>
<div class="spacer">
</div>
The prime may have to fulfill additional requirements for use in Diffie-Hellman key exchange:<div class="spacer">
</div>
If <i class="farg">add</i> is not <span class="define">NULL</span>, the prime will fulfill the condition p % <i class="farg">add</i> == <i class="farg">rem</i> (p % <i class="farg">add</i> == 1 if <i class="farg">rem</i> == <span class="define">NULL</span>) in order to suit a given generator.<div class="spacer">
</div>
If <i class="farg">safe</i> is true, it will be a safe prime (i.e. a prime p so that (p-1)/2 is also prime).<div class="spacer">
</div>
The prime number generation has a negligible error probability.<div class="spacer">
</div>
<b class="fname">BN_is_prime_ex</b>() and <b class="fname">BN_is_prime_fasttest_ex</b>() test if the number <i class="farg">p</i> is prime. The following tests are performed until one of them shows that <i class="farg">p</i> is composite; if <i class="farg">p</i> passes all these tests, it is considered prime.<div class="spacer">
</div>
<b class="fname">BN_is_prime_fasttest_ex</b>(), when called with <i class="farg">do_trial_division</i> == 1, first attempts trial division by a number of small primes; if no divisors are found by this test and <i class="farg">cb</i> is not <span class="define">NULL</span>, <span class="symb">BN_GENCB_call(cb, 1, -1)</span> is called. If <i class="farg">do_trial_division</i> == 0, this test is skipped.<div class="spacer">
</div>
Both <b class="fname">BN_is_prime_ex</b>() and <b class="fname">BN_is_prime_fasttest_ex</b>() perform a Miller-Rabin probabilistic primality test with <i class="farg">nchecks</i> iterations. If <i class="farg">nchecks</i> == <span class="define">BN_prime_checks</span>, a number of iterations is used that yields a false positive rate of at most 2^-80 for random input.<div class="spacer">
</div>
If <i class="farg">cb</i> is not <span class="define">NULL</span>, <i class="farg">BN_GENCB_call cb 1 j</i> is called after the j-th iteration (j = 0, 1, ...). <i class="farg">ctx</i> is a pre-allocated <span class="type">BN_CTX</span> (to save the overhead of allocating and freeing the structure in a loop), or <span class="define">NULL</span>.<div class="spacer">
</div>
<b class="fname">BN_GENCB_call</b>() calls the callback function held in the <span class="type">BN_GENCB</span> structure and passes the ints <i class="farg">a</i> and <i class="farg">b</i> as arguments. There are two types of <span class="type">BN_GENCB</span> structures that are supported: &quot;new&quot; style and &quot;old&quot; style. New programs should prefer the &quot;new&quot; style, whilst the &quot;old&quot; style is provided for backwards compatibility purposes.<div class="spacer">
</div>
For &quot;new&quot; style callbacks a <span class="type">BN_GENCB</span> structure should be initialised with a call to <b class="fname">BN_GENCB_set</b>(), where <i class="farg">gencb</i> is a <span class="type">BN_GENCB *</span>, <i class="farg">callback</i> is of type <span class="type">int (*callback)(int, int, BN_GENCB *)</span> and <i class="farg">cb_arg</i> is a <span class="type">void *</span>. &quot;Old&quot; style callbacks are the same except they are initialised with a call to <b class="fname">BN_GENCB_set_old</b>() and <i class="farg">callback</i> is of type <span class="type">void (*callback)(int, int, void *)</span>.<div class="spacer">
</div>
A callback is invoked through a call to <b class="fname">BN_GENCB_call</b>(). This will check the type of the callback and will invoke <b class="fname">callback</b>(<i class="farg">a</i>, <i class="farg">b</i>, <i class="farg">gencb</i>) for new style callbacks or <b class="fname">callback</b>(<i class="farg">a</i>, <i class="farg">b</i>, <i class="farg">cb_arg</i>) for old style.<div class="spacer">
</div>
<b class="fname">BN_generate_prime</b>() (deprecated) works in the same way as <b class="fname">BN_generate_prime_ex</b>() but expects an old style callback function directly in the <i class="farg">callback</i> parameter, and an argument to pass to it in the <i class="farg">cb_arg</i>. Similarly <b class="fname">BN_is_prime</b>() and <b class="fname">BN_is_prime_fasttest</b>() are deprecated and can be compared to <b class="fname">BN_is_prime_ex</b>() and <b class="fname">BN_is_prime_fasttest_ex</b>() respectively.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">BN_generate_prime_ex</b>() returns 1 on success or 0 on error.<div class="spacer">
</div>
<b class="fname">BN_is_prime_ex</b>(), <b class="fname">BN_is_prime_fasttest_ex</b>(), <b class="fname">BN_is_prime</b>(), and <b class="fname">BN_is_prime_fasttest</b>() return 0 if the number is composite, 1 if it is prime with an error probability of less than 0.25^<i class="farg">nchecks</i>, and -1 on error.<div class="spacer">
</div>
<b class="fname">BN_generate_prime</b>() returns the prime number on success, <span class="define">NULL</span> otherwise.<div class="spacer">
</div>
Callback functions should return 1 on success or 0 on error.<div class="spacer">
</div>
The error codes can be obtained by <a class="link-man" href="../html3/ERR_get_error.html">ERR_get_error(3)</a>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/bn.html">bn(3)</a>, <a class="link-man" href="../html3/ERR_get_error.html">ERR_get_error(3)</a>, <a class="link-man" href="../html3/rand.html">rand(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <i class="farg">cb_arg</i> arguments to <b class="fname">BN_generate_prime</b>() and to <b class="fname">BN_is_prime</b>() were added in SSLeay 0.9.0. The <i class="farg">ret</i> argument to <b class="fname">BN_generate_prime</b>() was added in SSLeay 0.9.1. <b class="fname">BN_is_prime_fasttest</b>() was added in OpenSSL 0.9.5.</div>
</div>
</body>
</html>

