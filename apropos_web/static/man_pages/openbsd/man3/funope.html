<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
FUNOPEN(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">funopen</b>, <b class="name">fropen</b>, <b class="name">fwopen</b> &#8212; <span class="desc">open a stream</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">stdio.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">FILE *</i><br/>
<b class="fname">funopen</b>(<i class="farg" style="white-space:nowrap;">const void *cookie</i>, <i class="farg" style="white-space:nowrap;">int (*readfn)(void *, char *, int)</i>, <i class="farg" style="white-space:nowrap;">int (*writefn)(void *, const char *, int)</i>, <i class="farg" style="white-space:nowrap;">fpos_t (*seekfn)(void *, fpos_t, int)</i>, <i class="farg" style="white-space:nowrap;">int (*closefn)(void *)</i>);<div class="spacer">
</div>
<i class="ftype">FILE *</i><br/>
<b class="fname">fropen</b>(<i class="farg" style="white-space:nowrap;">const void *cookie</i>, <i class="farg" style="white-space:nowrap;">int (*readfn)(void *, char *, int)</i>);<div class="spacer">
</div>
<i class="ftype">FILE *</i><br/>
<b class="fname">fwopen</b>(<i class="farg" style="white-space:nowrap;">const void *cookie</i>, <i class="farg" style="white-space:nowrap;">int (*writefn)(void *, const char *, int)</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">funopen</b>() function associates a stream with up to four I/O functions. Either <i class="farg">readfn</i> or <i class="farg">writefn</i> must be specified; the others may be given as <span class="define">NULL</span> pointers. These I/O functions will be used to read, write, seek, and close the new stream.<div class="spacer">
</div>
In general, omitting a function means that any attempt to perform the associated operation on the resulting stream will fail. If the close function is omitted, closing the stream will flush any buffered output and then succeed.<div class="spacer">
</div>
The calling conventions of <i class="farg">readfn</i>, <i class="farg">writefn</i>, <i class="farg">seekfn</i>, and <i class="farg">closefn</i> must match those, respectively, of <a class="link-man" href="../html2/read.html">read(2)</a>, <a class="link-man" href="../html2/write.html">write(2)</a>, <a class="link-man" href="../html2/lseek.html">lseek(2)</a>, and <a class="link-man" href="../html2/close.html">close(2)</a> with the exceptions that they are passed the <i class="farg">cookie</i> argument specified to <b class="fname">funopen</b>() in place of the traditional file descriptor argument and that the seek function takes an <code class="lit">fpos_t</code> argument and not an <code class="lit">off_t</code> argument.<div class="spacer">
</div>
Read and write I/O functions are allowed to change the underlying buffer on fully buffered or line buffered streams by calling <a class="link-man" href="../html3/setvbuf.html">setvbuf(3)</a>. They are also not required to completely fill or empty the buffer. They are not, however, allowed to change streams from unbuffered to buffered or to change the state of the line buffering flag. They must also be prepared to have read or write calls occur on buffers other than the one most recently specified.<div class="spacer">
</div>
All user I/O functions can report an error by returning -1. Additionally, all of the functions should set the external variable <b class="var">errno</b> appropriately if an error occurs.<div class="spacer">
</div>
An error on <b class="fname">closefn</b>() does not keep the stream open.<div class="spacer">
</div>
As a convenience, the include file <b class="includes">&lt;<a class="link-includes">stdio.h</a>&gt;</b> defines the macros <b class="fname">fropen</b>() and <b class="fname">fwopen</b>() as calls to <b class="fname">funopen</b>() with only a read or write function specified.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, <b class="fname">funopen</b>() returns a <span class="define">FILE</span> pointer. Otherwise, <span class="define">NULL</span> is returned and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <b class="fname">funopen</b>() function was called without either a read or write function. The <b class="fname">funopen</b>() function may also fail and set <b class="var">errno</b> for any of the errors specified for the routine <a class="link-man" href="../html3/malloc.html">malloc(3)</a>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/fcntl.html">fcntl(2)</a>, <a class="link-man" href="../html2/open.html">open(2)</a>, <a class="link-man" href="../html3/fclose.html">fclose(3)</a>, <a class="link-man" href="../html3/fopen.html">fopen(3)</a>, <a class="link-man" href="../html3/fseek.html">fseek(3)</a>, <a class="link-man" href="../html3/setvbuf.html">setvbuf(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">funopen</b>() functions first appeared in <span class="unix">4.4BSD</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The <b class="fname">funopen</b>() function may not be portable to systems other than <span class="unix">BSD</span>.</div>
</div>
</body>
</html>

