<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
FMT_SCALED(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">fmt_scaled</b>, <b class="name">scan_scaled</b> &#8212; <span class="desc">handle numbers with a human-readable scale</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">util.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">scan_scaled</b>(<i class="farg" style="white-space:nowrap;">char *number_w_scale</i>, <i class="farg" style="white-space:nowrap;">long long *result</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">fmt_scaled</b>(<i class="farg" style="white-space:nowrap;">long long number</i>, <i class="farg" style="white-space:nowrap;">char *result</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">scan_scaled</b>() function scans the given number and looks for a terminal scale multiplier of B, K, M, G, T, P or E (in either upper or lower case) for Byte, Kilobyte, Megabyte, Gigabyte, Terabyte, Petabyte, Exabyte (computed using powers of two, i.e., Megabyte = 1024*1024). The number can have a decimal point, as in 1.5K, which returns 1536 (1024+512). If no scale factor is found, B is assumed.<div class="spacer">
</div>
The <b class="fname">fmt_scaled</b>() function formats a number for display using the same &quot;human-readable&quot; format, that is, a number with one of the above scale factors. Numbers will be printed with a maximum of four digits (preceded by a minus sign if the value is negative); values such as 0B, 100B, 1023B, 1K, 1.5K, 5.5M, and so on, will be generated. The &#8220;result&#8221; buffer must be allocated with at least <span class="define">FMT_SCALED_STRSIZE</span> bytes. The result will be left-justified in the given space, and NUL-terminated.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> The <b class="fname">scan_scaled</b>() and <b class="fname">fmt_scaled</b>() functions return 0 on success. In case of error, they return -1, leave <b class="var">*result</b> as is, and set <b class="var">errno</b> to one of the following values: <span class="define">ERANGE</span> if the input string represents a number that is too large to represent. <span class="define">EINVAL</span> if an unknown character was used as scale factor, or if the input to <b class="fname">scan_scaled</b>() was malformed, e.g., too many '.' characters.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1><pre style="margin-left: 5.00ex;" class="lit display">
char *cinput = &quot;1.5K&quot;; 
long long result; 
if (scan_scaled(cinput, &amp;result) == 0) 
	printf(&quot;%s -&gt; %ld\n&quot;, cinput, result); 
else 
	fprintf(stderr, &quot;%s - invalid\n&quot;, cinput); 
 
char buf[FMT_SCALED_STRSIZE]; 
long long ninput = 10483892; 
if (fmt_scaled(ninput, buf) == 0) 
	printf(&quot;%lld -&gt; %s\n&quot;, ninput, buf); 
else 
	fprintf(stderr, &quot;fmt scaled failed (errno %d)&quot;, errno);</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/printf.html">printf(3)</a>, <a class="link-man" href="../html3/scanf.html">scanf(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The functions <b class="fname">fmt_scaled</b>() and <b class="fname">scan_scaled</b>() first appeared in <span class="unix">OpenBSD&#160;3.4</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Ken Stailey</span> wrote the first version of the code that became <b class="fname">fmt_scaled</b>(), originally inside <span class="unix">OpenBSD</span> <a class="link-man" href="../html1/df.html">df(1)</a>. <span class="author">Ian Darwin</span> excerpted this and made it into a library routine (with significant help from <span class="author">Paul Janzen</span>), and wrote <b class="fname">scan_scaled</b>().</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Some of the scale factors have misleading meanings in lower case (p for P is incorrect; p should be pico- and P for Peta-). However, we bend the SI rules in favor of common sense here. A person creating a disk partition of &quot;100m&quot; is unlikely to require 100 millibytes (i.e., 0.1 byte) of storage in the partition; 100 megabytes is the only reasonable interpretation.<div class="spacer">
</div>
Cannot represent the larger scale factors on all architectures.<div class="spacer">
</div>
Ignores the current locale.</div>
</div>
</body>
</html>

