<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
EVP_AEAD_CTX_INIT(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">EVP_AEAD_CTX_init</b>, <b class="name">EVP_AEAD_CTX_cleanup</b>, <b class="name">EVP_AEAD_CTX_open</b>, <b class="name">EVP_AEAD_CTX_seal</b>, <b class="name">EVP_AEAD_key_length</b>, <b class="name">EVP_AEAD_max_overhead</b>, <b class="name">EVP_AEAD_max_tag_len</b>, <b class="name">EVP_AEAD_nonce_length</b>, <b class="name">EVP_aead_aes_128_gcm</b>, <b class="name">EVP_aead_aes_256_gcm</b>, <b class="name">EVP_aead_chacha20_poly1305</b>, <b class="name">EVP_aead_chacha20_poly1305_ietf</b> &#8212; <span class="desc">authenticated encryption with additional data</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">openssl/evp.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">EVP_AEAD_CTX_init</b>(<i class="farg">EVP_AEAD_CTX *ctx</i>, <i class="farg">const EVP_AEAD *aead</i>, <i class="farg">const unsigned char *key</i>, <i class="farg">size_t key_len</i>, <i class="farg">size_t tag_len</i>, <i class="farg">ENGINE *impl</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">EVP_AEAD_CTX_cleanup</b>(<i class="farg">EVP_AEAD_CTX *ctx</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">EVP_AEAD_CTX_open</b>(<i class="farg">const EVP_AEAD_CTX *ctx</i>, <i class="farg">unsigned char *out</i>, <i class="farg">size_t *out_len</i>, <i class="farg">size_t max_out_len</i>, <i class="farg">const unsigned char *nonce</i>, <i class="farg">size_t nonce_len</i>, <i class="farg">const unsigned char *in</i>, <i class="farg">size_t in_len</i>, <i class="farg">const unsigned char *ad</i>, <i class="farg">size_t ad_len</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">EVP_AEAD_CTX_seal</b>(<i class="farg">const EVP_AEAD_CTX *ctx</i>, <i class="farg">unsigned char *out</i>, <i class="farg">size_t *out_len</i>, <i class="farg">size_t max_out_len</i>, <i class="farg">const unsigned char *nonce</i>, <i class="farg">size_t nonce_len</i>, <i class="farg">const unsigned char *in</i>, <i class="farg">size_t in_len</i>, <i class="farg">const unsigned char *ad</i>, <i class="farg">size_t ad_len</i>);<div class="spacer">
</div>
<i class="ftype">size_t</i><br/>
<b class="fname">EVP_AEAD_key_length</b>(<i class="farg">const EVP_AEAD *aead</i>);<div class="spacer">
</div>
<i class="ftype">size_t</i><br/>
<b class="fname">EVP_AEAD_max_overhead</b>(<i class="farg">const EVP_AEAD *aead</i>);<div class="spacer">
</div>
<i class="ftype">size_t</i><br/>
<b class="fname">EVP_AEAD_max_tag_len</b>(<i class="farg">const EVP_AEAD *aead</i>);<div class="spacer">
</div>
<i class="ftype">size_t</i><br/>
<b class="fname">EVP_AEAD_nonce_length</b>(<i class="farg">const EVP_AEAD *aead</i>);<div class="spacer">
</div>
<i class="ftype">const EVP_AEAD *</i><br/>
<b class="fname">EVP_aead_aes_128_gcm</b>(<i class="farg">void</i>);<div class="spacer">
</div>
<i class="ftype">const EVP_AEAD *</i><br/>
<b class="fname">EVP_aead_aes_256_gcm</b>(<i class="farg">void</i>);<div class="spacer">
</div>
<i class="ftype">const EVP_AEAD *</i><br/>
<b class="fname">EVP_aead_chacha20_poly1305</b>(<i class="farg">void</i>);<div class="spacer">
</div>
<i class="ftype">const EVP_AEAD *</i><br/>
<b class="fname">EVP_aead_chacha20_poly1305_ietf</b>(<i class="farg">void</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> AEAD (Authenticated Encryption with Additional Data) couples confidentiality and integrity in a single primitive. AEAD algorithms take a key and can then seal and open individual messages. Each message has a unique, per-message nonce and, optionally, additional data which is authenticated but not included in the output.<div class="spacer">
</div>
<b class="fname">EVP_AEAD_CTX_init</b>() initializes the context <i class="farg">ctx</i> for the given AEAD algorithm <i class="farg">aead</i>. The <i class="farg">impl</i> argument must be <span class="define">NULL</span> for the default implementation; other values are currently not supported. Authentication tags may be truncated by passing a tag length. A tag length of zero indicates the default tag length should be used.<div class="spacer">
</div>
<b class="fname">EVP_AEAD_CTX_cleanup</b>() frees any data allocated for the context <i class="farg">ctx</i>.<div class="spacer">
</div>
<b class="fname">EVP_AEAD_CTX_open</b>() authenticates the input <i class="farg">in</i> and optional additional data <i class="farg">ad</i>, decrypting the input and writing it as output <i class="farg">out</i>. This function may be called (with the same <span class="type">EVP_AEAD_CTX</span>) concurrently with itself or with <b class="fname">EVP_AEAD_CTX_seal</b>(). At most the number of input bytes are written as output. In order to ensure success, <i class="farg">max_out_len</i> should be at least the same as the input length <i class="farg">in_len</i>. On successful return <i class="farg">out_len</i> is set to the actual number of bytes written. The length of the <i class="farg">nonce</i> specified with <i class="farg">nonce_len</i> must be equal to the result of EVP_AEAD_nonce_length for this AEAD. <b class="fname">EVP_AEAD_CTX_open</b>() never results in partial output. If <i class="farg">max_out_len</i> is insufficient, zero will be returned and <i class="farg">out_len</i> will be set to zero. If the input and output are aliased then <i class="farg">out</i> must be &lt;= <i class="farg">in</i>.<div class="spacer">
</div>
<b class="fname">EVP_AEAD_CTX_seal</b>() encrypts and authenticates the input and authenticates any additional data provided in <i class="farg">ad</i>, the encrypted input and authentication tag being written as output <i class="farg">out</i>. This function may be called (with the same <span class="type">EVP_AEAD_CTX</span>) concurrently with itself or with <b class="fname">EVP_AEAD_CTX_open</b>(). At most <i class="farg">max_out_len</i> bytes are written as output and, in order to ensure success, this value should be the <i class="farg">in_len</i> plus the result of <a class="link-man" href="../html3/EVP_AEAD_overhead.html">EVP_AEAD_overhead(3)</a>. On successful return, <i class="farg">out_len</i> is set to the actual number of bytes written. The length of the <i class="farg">nonce</i> specified with <i class="farg">nonce_len</i> must be equal to the result of <b class="fname">EVP_AEAD_nonce_length</b>() for this AEAD. <b class="fname">EVP_AEAD_CTX_seal</b>() never results in a partial output. If <i class="farg">max_out_len</i> is insufficient, zero will be returned and <i class="farg">out_len</i> will be set to zero. If the input and output are aliased then <i class="farg">out</i> must be &lt;= <i class="farg">in</i>.<div class="spacer">
</div>
<b class="fname">EVP_AEAD_key_length</b>(), <b class="fname">EVP_AEAD_max_overhead</b>(), <b class="fname">EVP_AEAD_max_tag_len</b>(), and <b class="fname">EVP_AEAD_nonce_length</b>() provide information about the AEAD algorithm <i class="farg">aead</i>.<div class="spacer">
</div>
All cipher algorithms have a fixed key length unless otherwise stated. The following ciphers are available:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">EVP_aead_aes_128_gcm</b>()</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
AES-128 in Galois Counter Mode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">EVP_aead_aes_256_gcm</b>()</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
AES-256 in Galois Counter Mode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">EVP_aead_chacha20_poly1305</b>()</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
ChaCha20 with a Poly1305 authenticator.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">EVP_aead_chacha20_poly1305_ietf</b>()</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
ChaCha20 with a Poly1305 authenticator for IETF Protocols. The IETF standardised variant of the AEAD is incompatible with the original version. It uses a constant salt that is prepended to the nonce.</dd>
</dl>
<div class="spacer">
</div>
Where possible the <span class="symb">EVP_AEAD</span> interface to AEAD ciphers should be used in preference to the older <span class="symb">EVP</span> variants or to the low level interfaces. This is because the code then becomes transparent to the AEAD cipher used and much more flexible, it is also safer to use as it prevents common mistakes with the native APIs.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">EVP_AEAD_CTX_init</b>(), <b class="fname">EVP_AEAD_CTX_open</b>(), and <b class="fname">EVP_AEAD_CTX_seal</b>() return 1 for success or zero for failure.<div class="spacer">
</div>
<b class="fname">EVP_AEAD_key_length</b>() returns the length of the key used for this AEAD.<div class="spacer">
</div>
<b class="fname">EVP_AEAD_max_overhead</b>() returns the maximum number of additional bytes added by the act of sealing data with the AEAD.<div class="spacer">
</div>
<b class="fname">EVP_AEAD_max_tag_len</b>() returns the maximum tag length when using this AEAD. This is the largest value that can be passed as a tag length to <b class="fname">EVP_AEAD_CTX_init</b>().<div class="spacer">
</div>
<b class="fname">EVP_AEAD_nonce_length</b>() returns the length of the per-message nonce.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Encrypt a string using ChaCha20-Poly1305:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
const EVP_AEAD *aead = EVP_aead_chacha20_poly1305(); 
static const unsigned char nonce[32] = {0}; 
size_t buf_len, nonce_len; 
EVP_AEAD_CTX ctx; 
 
EVP_AEAD_CTX_init(&amp;ctx, aead, key32, EVP_AEAD_key_length(aead), 
    EVP_AEAD_DEFAULT_TAG_LENGTH, NULL); 
nonce_len = EVP_AEAD_nonce_length(aead); 
 
EVP_AEAD_CTX_seal(&amp;ctx, out, &amp;out_len, BUFSIZE, nonce, 
    nonce_len, in, in_len, NULL, 0); 
 
EVP_AEAD_CTX_cleanup(&amp;ctx);</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/evp.html">evp(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> <span class="ref"><span class="ref-auth">A. Langley</span> and <span class="ref-auth">W. Chang</span>, <span class="ref-title">ChaCha20 and Poly1305 based Cipher Suites for TLS</span>, <span class="ref-rep">draft-agl-tls-chacha20poly1305-04</span>, <span class="ref-date">November 2013</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">Y. Nir</span> and <span class="ref-auth">A. Langley</span>, <span class="ref-title">ChaCha20 and Poly1305 for IETF Protocols</span>, <span class="ref-rep">RFC 7539</span>, <span class="ref-date">May 2015</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> AEAD is based on the implementation by <span class="author">Adam Langley</span> for Chromium/BoringSSL and first appeared in <span class="unix">OpenBSD&#160;5.6</span>.</div>
</div>
</body>
</html>

