<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
OPENPTY(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">openpty</b>, <b class="name">login_tty</b>, <b class="name">forkpty</b> &#8212; <span class="desc">tty utility functions</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">termios.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">util.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">openpty</b>(<i class="farg" style="white-space:nowrap;">int *amaster</i>, <i class="farg" style="white-space:nowrap;">int *aslave</i>, <i class="farg" style="white-space:nowrap;">char *name</i>, <i class="farg" style="white-space:nowrap;">struct termios *termp</i>, <i class="farg" style="white-space:nowrap;">struct winsize *winp</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">login_tty</b>(<i class="farg" style="white-space:nowrap;">int fd</i>);<div class="spacer">
</div>
<i class="ftype">pid_t</i><br/>
<b class="fname">forkpty</b>(<i class="farg" style="white-space:nowrap;">int *amaster</i>, <i class="farg" style="white-space:nowrap;">char *name</i>, <i class="farg" style="white-space:nowrap;">struct termios *termp</i>, <i class="farg" style="white-space:nowrap;">struct winsize *winp</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">openpty</b>(), <b class="fname">login_tty</b>(), and <b class="fname">forkpty</b>() functions perform manipulations on ttys and pseudo-ttys.<div class="spacer">
</div>
The <b class="fname">openpty</b>() function finds an available pseudo-tty and returns file descriptors for the master and slave in <i class="farg">amaster</i> and <i class="farg">aslave</i>. If <i class="farg">name</i> is non-null, the filename of the slave is returned in <i class="farg">name</i> (a string of at least 16 characters). If <i class="farg">termp</i> is non-null, the terminal parameters of the slave will be set to the values in <i class="farg">termp</i>. If <i class="farg">winp</i> is non-null, the window size of the slave will be set to the values in <i class="farg">winp</i>.<div class="spacer">
</div>
The <b class="fname">openpty</b>() function allocates the pseudo-tty through the <i class="file">/dev/ptm</i> device (see <a class="link-man" href="../html4/pty.html">pty(4)</a> for details) which means that its ownership is changed to the UID of the caller, permissions are set to correct values, and all earlier uses of that device are revoked (see <a class="link-man" href="../html2/revoke.html">revoke(2)</a> for details).<div class="spacer">
</div>
The <b class="fname">login_tty</b>() function prepares for a login on the tty <i class="farg">fd</i> (which may be a real tty device, or the slave of a pseudo-tty as returned by <b class="fname">openpty</b>()) by creating a new session, making <i class="farg">fd</i> the controlling terminal for the current process, setting <i class="farg">fd</i> to be the standard input, output, and error streams of the current process, and closing <i class="farg">fd</i>.<div class="spacer">
</div>
The <b class="fname">forkpty</b>() function combines <b class="fname">openpty</b>(), <b class="fname">fork</b>(), and <b class="fname">login_tty</b>() to create a new process operating in a pseudo-tty. The file descriptor of the master side of the pseudo-tty is returned in <i class="farg">amaster</i>, and the filename of the slave in <i class="farg">name</i> if it is non-null. The <i class="farg">termp</i> and <i class="farg">winp</i> parameters, if non-null, will determine the terminal attributes and window size of the slave side of the pseudo-tty.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> If a call to <b class="fname">openpty</b>(), <b class="fname">login_tty</b>(), or <b class="fname">forkpty</b>() is not successful, -1 is returned and <b class="var">errno</b> is set to indicate the error. Otherwise, <b class="fname">openpty</b>(), <b class="fname">login_tty</b>(), and the child process of <b class="fname">forkpty</b>() return 0, and the parent process of <b class="fname">forkpty</b>() returns the process ID of the child process.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/pty[p-zP-T][0-9a-zA-Z]</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
master pseudo terminals</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/tty[p-zP-T][0-9a-zA-Z]</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
slave pseudo terminals</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/ptm</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
pseudo terminal management device</dd>
</dl>
</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">openpty</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOENT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
There are no available ttys.</dd>
</dl>
<div class="spacer">
</div>
<b class="fname">login_tty</b>() will fail if <b class="fname">ioctl</b>() fails to set <i class="farg">fd</i> to the controlling terminal of the current process. <b class="fname">forkpty</b>() will fail if either <b class="fname">openpty</b>() or <b class="fname">fork</b>() fails.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/fork.html">fork(2)</a>, <a class="link-man" href="../html2/revoke.html">revoke(2)</a>, <a class="link-man" href="../html4/pty.html">pty(4)</a></div>
</div>
</body>
</html>

