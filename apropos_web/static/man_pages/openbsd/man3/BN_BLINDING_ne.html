<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
BN_BLINDING_NEW(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">BN_BLINDING_new</b>, <b class="name">BN_BLINDING_free</b>, <b class="name">BN_BLINDING_update</b>, <b class="name">BN_BLINDING_convert</b>, <b class="name">BN_BLINDING_invert</b>, <b class="name">BN_BLINDING_convert_ex</b>, <b class="name">BN_BLINDING_invert_ex</b>, <b class="name">BN_BLINDING_get_thread_id</b>, <b class="name">BN_BLINDING_set_thread_id</b>, <b class="name">BN_BLINDING_thread_id</b>, <b class="name">BN_BLINDING_get_flags</b>, <b class="name">BN_BLINDING_set_flags</b>, <b class="name">BN_BLINDING_create_param</b> &#8212; <span class="desc">blinding related BIGNUM functions</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">openssl/bn.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">BN_BLINDING *</i><br/>
<b class="fname">BN_BLINDING_new</b>(<i class="farg">const BIGNUM *A</i>, <i class="farg">const BIGNUM *Ai</i>, <i class="farg">BIGNUM *mod</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">BN_BLINDING_free</b>(<i class="farg">BN_BLINDING *b</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BN_BLINDING_update</b>(<i class="farg">BN_BLINDING *b</i>, <i class="farg">BN_CTX *ctx</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BN_BLINDING_convert</b>(<i class="farg">BIGNUM *n</i>, <i class="farg">BN_BLINDING *b</i>, <i class="farg">BN_CTX *ctx</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BN_BLINDING_invert</b>(<i class="farg">BIGNUM *n</i>, <i class="farg">BN_BLINDING *b</i>, <i class="farg">BN_CTX *ctx</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BN_BLINDING_convert_ex</b>(<i class="farg">BIGNUM *n</i>, <i class="farg">BIGNUM *r</i>, <i class="farg">BN_BLINDING *b</i>, <i class="farg">BN_CTX *ctx</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BN_BLINDING_invert_ex</b>(<i class="farg">BIGNUM *n</i>, <i class="farg">const BIGNUM *r</i>, <i class="farg">BN_BLINDING *b</i>, <i class="farg">BN_CTX *ctx</i>);<div class="spacer">
</div>
<b class="macro">#ifndef OPENSSL_NO_DEPRECATED</b><div class="spacer">
</div>
<i class="ftype">unsigned long</i><br/>
<b class="fname">BN_BLINDING_get_thread_id</b>(<i class="farg">const BN_BLINDING *</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">BN_BLINDING_set_thread_id</b>(<i class="farg">BN_BLINDING *</i>, <i class="farg">unsigned long</i>);<div class="spacer">
</div>
<b class="macro">#endif</b><div class="spacer">
</div>
<i class="ftype">CRYPTO_THREADID *</i><br/>
<b class="fname">BN_BLINDING_thread_id</b>(<i class="farg">BN_BLINDING *</i>);<div class="spacer">
</div>
<i class="ftype">unsigned long</i><br/>
<b class="fname">BN_BLINDING_get_flags</b>(<i class="farg">const BN_BLINDING *</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">BN_BLINDING_set_flags</b>(<i class="farg">BN_BLINDING *</i>, <i class="farg">unsigned long</i>);<div class="spacer">
</div>
<i class="ftype">BN_BLINDING *</i><br/>
<b class="fname">BN_BLINDING_create_param</b>(<i class="farg">BN_BLINDING *b</i>, <i class="farg">const BIGNUM *e</i>, <i class="farg">BIGNUM *m</i>, <i class="farg">BN_CTX *ctx</i>, <i class="farg">int (*bn_mod_exp)(BIGNUM *r, const BIGNUM *a, const BIGNUM *p, const BIGNUM *m, BN_CTX *ctx, BN_MONT_CTX *m_ctx)</i>, <i class="farg">BN_MONT_CTX *m_ctx</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">BN_BLINDING_new</b>() allocates a new <span class="type">BN_BLINDING</span> structure and copies the <i class="farg">A</i> and <i class="farg">Ai</i> values into the newly created <span class="type">BN_BLINDING</span> object.<div class="spacer">
</div>
<b class="fname">BN_BLINDING_free</b>() frees the <span class="type">BN_BLINDING</span> structure.<div class="spacer">
</div>
<b class="fname">BN_BLINDING_update</b>() updates the <span class="type">BN_BLINDING</span> parameters by squaring the <i class="farg">A</i> and <i class="farg">Ai</i> or, after specific number of uses and if the necessary parameters are set, by re-creating the blinding parameters.<div class="spacer">
</div>
<b class="fname">BN_BLINDING_convert_ex</b>() multiplies <i class="farg">n</i> with the blinding factor <i class="farg">A</i>. If <i class="farg">r</i> is not <span class="define">NULL</span>, a copy of the inverse blinding factor <i class="farg">Ai</i> will be returned in <i class="farg">r</i> (this is useful if a <span class="type">RSA</span> object is shared among several threads). <b class="fname">BN_BLINDING_invert_ex</b>() multiplies <i class="farg">n</i> with the inverse blinding factor <i class="farg">Ai</i>. If <i class="farg">r</i> is not <span class="define">NULL</span>, it will be used as the inverse blinding.<div class="spacer">
</div>
<b class="fname">BN_BLINDING_convert</b>() and <b class="fname">BN_BLINDING_invert</b>() are wrapper functions for <b class="fname">BN_BLINDING_convert_ex</b>() and <b class="fname">BN_BLINDING_invert_ex</b>() with <i class="farg">r</i> set to <span class="define">NULL</span>.<div class="spacer">
</div>
<b class="fname">BN_BLINDING_thread_id</b>() provides access to the <span class="type">CRYPTO_THREADID</span> object within the <span class="type">BN_BLINDING</span> structure. This is to help users provide proper locking if needed for multi-threaded use. The &quot;thread id&quot; object of a newly allocated <span class="type">BN_BLINDING</span> structure is initialised to the thread id in which <b class="fname">BN_BLINDING_new</b>() was called.<div class="spacer">
</div>
<b class="fname">BN_BLINDING_get_flags</b>() returns the <span class="define">BN_BLINDING_*</span> flags. Currently there are two supported flags: <span class="define">BN_BLINDING_NO_UPDATE</span> and <span class="define">BN_BLINDING_NO_RECREATE</span>. <span class="define">BN_BLINDING_NO_UPDATE</span> inhibits the automatic update of the <span class="type">BN_BLINDING</span> parameters after each use and <span class="define">BN_BLINDING_NO_RECREATE</span> inhibits the automatic re-creation of the <span class="type">BN_BLINDING</span> parameters after a fixed number of uses (currently 32). In newly allocated <span class="type">BN_BLINDING</span> objects no flags are set. <b class="fname">BN_BLINDING_set_flags</b>() sets the <span class="define">BN_BLINDING_*</span> parameters flags.<div class="spacer">
</div>
<b class="fname">BN_BLINDING_create_param</b>() creates new <span class="type">BN_BLINDING</span> parameters using the exponent <i class="farg">e</i> and the modulus <i class="farg">m</i>. <i class="farg">bn_mod_exp</i> and <i class="farg">m_ctx</i> can be used to pass special functions for exponentiation (normally <a class="link-man" href="../html3/BN_mod_exp_mont.html">BN_mod_exp_mont(3)</a> and <span class="type">BN_MONT_CTX</span>).</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">BN_BLINDING_new</b>() returns the newly allocated <span class="type">BN_BLINDING</span> structure or <span class="define">NULL</span> in case of an error.<div class="spacer">
</div>
<b class="fname">BN_BLINDING_update</b>(), <b class="fname">BN_BLINDING_convert</b>(), <b class="fname">BN_BLINDING_invert</b>(), <b class="fname">BN_BLINDING_convert_ex</b>() and <b class="fname">BN_BLINDING_invert_ex</b>() return 1 on success and 0 if an error occurred.<div class="spacer">
</div>
<b class="fname">BN_BLINDING_thread_id</b>() returns a pointer to the thread id object within a <span class="type">BN_BLINDING</span> object.<div class="spacer">
</div>
<b class="fname">BN_BLINDING_get_flags</b>() returns the currently set <span class="define">BN_BLINDING_*</span> flags (an <span class="type">unsigned long</span> value).<div class="spacer">
</div>
<b class="fname">BN_BLINDING_create_param</b>() returns the newly created <span class="type">BN_BLINDING</span> parameters or <span class="define">NULL</span> on error.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/bn.html">bn(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> <b class="fname">BN_BLINDING_thread_id</b>() was first introduced in OpenSSL 1.0.0, and it deprecates <b class="fname">BN_BLINDING_set_thread_id</b>() and <b class="fname">BN_BLINDING_get_thread_id</b>().<div class="spacer">
</div>
<b class="fname">BN_BLINDING_convert_ex</b>(), <b class="fname">BN_BLINDIND_invert_ex</b>(), <b class="fname">BN_BLINDING_get_thread_id</b>(), <b class="fname">BN_BLINDING_set_thread_id</b>(), <b class="fname">BN_BLINDING_set_flags</b>(), <b class="fname">BN_BLINDING_get_flags</b>() and <b class="fname">BN_BLINDING_create_param</b>() were first introduced in OpenSSL 0.9.8</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Nils Larsch</span> for <a class="link-ext" href="http://www.openssl.org/">the OpenSSL project</a>.</div>
</div>
</body>
</html>

