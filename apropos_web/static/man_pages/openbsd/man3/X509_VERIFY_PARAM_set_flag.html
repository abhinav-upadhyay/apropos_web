<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
X509_VERIFY_PARAM_SET_FLAGS(3)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
X509_VERIFY_PARAM_SET_FLAGS(3)</td>
<td class="head-vol">
OpenSSL</td>
<td class="head-rtitle">
X509_VERIFY_PARAM_SET_FLAGS(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> X509_VERIFY_PARAM_set_flags, X509_VERIFY_PARAM_clear_flags, X509_VERIFY_PARAM_get_flags, X509_VERIFY_PARAM_set_purpose, X509_VERIFY_PARAM_set_trust, X509_VERIFY_PARAM_set_depth, X509_VERIFY_PARAM_get_depth, X509_VERIFY_PARAM_set_time, X509_VERIFY_PARAM_add0_policy, X509_VERIFY_PARAM_set1_policies - X509 verification parameters</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
 #include &lt;openssl/x509_vfy.h&gt;<br/>
<br/>
 int X509_VERIFY_PARAM_set_flags(X509_VERIFY_PARAM *param, unsigned long flags);<br/>
 int X509_VERIFY_PARAM_clear_flags(X509_VERIFY_PARAM *param,<br/>
                                                        unsigned long flags);<br/>
 unsigned long X509_VERIFY_PARAM_get_flags(X509_VERIFY_PARAM *param);<br/>
<br/>
 int X509_VERIFY_PARAM_set_purpose(X509_VERIFY_PARAM *param, int purpose);<br/>
 int X509_VERIFY_PARAM_set_trust(X509_VERIFY_PARAM *param, int trust);<br/>
<br/>
 void X509_VERIFY_PARAM_set_time(X509_VERIFY_PARAM *param, time_t t);<br/>
<br/>
 int X509_VERIFY_PARAM_add0_policy(X509_VERIFY_PARAM *param,<br/>
                                                ASN1_OBJECT *policy);<br/>
 int X509_VERIFY_PARAM_set1_policies(X509_VERIFY_PARAM *param,<br/>
                                        STACK_OF(ASN1_OBJECT) *policies);<br/>
<br/>
 void X509_VERIFY_PARAM_set_depth(X509_VERIFY_PARAM *param, int depth);<br/>
 int X509_VERIFY_PARAM_get_depth(const X509_VERIFY_PARAM *param);<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> These functions manipulate the  <b>X509_VERIFY_PARAM</b> structure associated with a certificate verification operation.<div class="spacer">
</div>
The <i>X509_VERIFY_PARAM_set_flags()</i> function sets the flags in <b>param</b> by oring it with  <b>flags</b>. See the <b>VERIFICATION FLAGS</b> section for a complete description of values the  <b>flags</b> parameter can take.<div class="spacer">
</div>
<i>X509_VERIFY_PARAM_get_flags()</i> returns the flags in <b>param</b>.<div class="spacer">
</div>
<i>X509_VERIFY_PARAM_clear_flags()</i> clears the flags <b>flags</b> in <b>param</b>.<div class="spacer">
</div>
<i>X509_VERIFY_PARAM_set_purpose()</i> sets the verification purpose in <b>param</b> to  <b>purpose</b>. This determines the acceptable purpose of the certificate chain, for example SSL client or SSL server.<div class="spacer">
</div>
<i>X509_VERIFY_PARAM_set_trust()</i> sets the trust setting in <b>param</b> to  <b>trust</b>.<div class="spacer">
</div>
<i>X509_VERIFY_PARAM_set_time()</i> sets the verification time in <b>param</b> to  <b>t</b>. Normally the current time is used.<div class="spacer">
</div>
<i>X509_VERIFY_PARAM_add0_policy()</i> enables policy checking (it is disabled by default) and adds  <b>policy</b> to the acceptable policy set.<div class="spacer">
</div>
<i>X509_VERIFY_PARAM_set1_policies()</i> enables policy checking (it is disabled by default) and sets the acceptable policy set to  <b>policies</b>. Any existing policy set is cleared. The  <b>policies</b> parameter can be <b>NULL</b> to clear an existing policy set.<div class="spacer">
</div>
<i>X509_VERIFY_PARAM_set_depth()</i> sets the maximum verification depth to <b>depth</b>. That is the maximum number of untrusted CA certificates that can appear in a chain.</div>
<div class="section">
<h1>RETURN VALUES</h1>  <i>X509_VERIFY_PARAM_set_flags()</i>, <i>X509_VERIFY_PARAM_clear_flags()</i>,  <i>X509_VERIFY_PARAM_set_purpose()</i>, <i>X509_VERIFY_PARAM_set_trust()</i>,  <i>X509_VERIFY_PARAM_add0_policy()</i> and <i>X509_VERIFY_PARAM_set1_policies()</i> return 1 for success and 0 for failure.<div class="spacer">
</div>
<i>X509_VERIFY_PARAM_get_flags()</i> returns the current verification flags.<div class="spacer">
</div>
<i>X509_VERIFY_PARAM_set_time()</i> and <i>X509_VERIFY_PARAM_set_depth()</i> do not return values.<div class="spacer">
</div>
<i>X509_VERIFY_PARAM_get_depth()</i> returns the current verification depth.</div>
<div class="section">
<h1>VERIFICATION FLAGS</h1> The verification flags consists of zero or more of the following flags ored together.<div class="spacer">
</div>
<b>X509_V_FLAG_CRL_CHECK</b> enables CRL checking for the certificate chain leaf certificate. An error occurs if a suitable CRL cannot be found.<div class="spacer">
</div>
<b>X509_V_FLAG_CRL_CHECK_ALL</b> enables CRL checking for the entire certificate chain.<div class="spacer">
</div>
<b>X509_V_FLAG_IGNORE_CRITICAL</b> disabled critical extension checking. By default any unhandled critical extensions in certificates or (if checked) CRLs results in a fatal error. If this flag is set unhandled critical extensions are ignored.  <b>WARNING</b> setting this option for anything other than debugging purposes can be a security risk. Finer control over which extensions are supported can be performed in the verification callback.<div class="spacer">
</div>
THe <b>X509_V_FLAG_X509_STRICT</b> flag disables workarounds for some broken certificates and makes the verification strictly apply  <b>X509</b> rules.<div class="spacer">
</div>
<b>X509_V_FLAG_ALLOW_PROXY_CERTS</b> enables proxy certificate verification.<div class="spacer">
</div>
<b>X509_V_FLAG_POLICY_CHECK</b> enables certificate policy checking, by default no policy checking is performed. Additional information is sent to the verification callback relating to policy checking.<div class="spacer">
</div>
<b>X509_V_FLAG_EXPLICIT_POLICY</b>, <b>X509_V_FLAG_INHIBIT_ANY</b> and  <b>X509_V_FLAG_INHIBIT_MAP</b> set the <b>require explicit policy</b>, <b>inhibit any</b>  <b>policy</b> and <b>inhibit policy mapping</b> flags respectively as defined in  <b>RFC3280</b>. Policy checking is automatically enabled if any of these flags are set.<div class="spacer">
</div>
If <b>X509_V_FLAG_NOTIFY_POLICY</b> is set and the policy checking is successful a special status code is set to the verification callback. This permits it to examine the valid policy tree and perform additional checks or simply log it for debugging purposes.<div class="spacer">
</div>
By default some additional features such as indirect CRLs and CRLs signed by different keys are disabled. If  <b>X509_V_FLAG_EXTENDED_CRL_SUPPORT</b> is set they are enabled.<div class="spacer">
</div>
If <b>X509_V_FLAG_USE_DELTAS</b> ise set delta CRLs (if present) are used to determine certificate status. If not set deltas are ignored.<div class="spacer">
</div>
<b>X509_V_FLAG_CHECK_SS_SIGNATURE</b> enables checking of the root CA self signed certificate signature. By default this check is disabled because it doesn't add any additional security but in some cases applications might want to check the signature anyway. A side effect of not checking the root CA signature is that disabled or unsupported message digests on the root CA are not treated as fatal errors.<div class="spacer">
</div>
The <b>X509_V_FLAG_CB_ISSUER_CHECK</b> flag enables debugging of certificate issuer checks. It is  <b>not</b> needed unless you are logging certificate verification. If this flag is set then additional status codes will be sent to the verification callback and it  <b>must</b> be prepared to handle such cases without assuming they are hard errors.</div>
<div class="section">
<h1>NOTES</h1> The above functions should be used to manipulate verification parameters instead of legacy functions which work in specific structures such as  <i>X509_STORE_CTX_set_flags()</i>.</div>
<div class="section">
<h1>BUGS</h1> Delta CRL checking is currently primitive. Only a single delta can be used and (partly due to limitations of  <b>X509_STORE</b>) constructed CRLs are not maintained.<div class="spacer">
</div>
If CRLs checking is enable CRLs are expected to be available in the corresponding  <b>X509_STORE</b> structure. No attempt is made to download CRLs from the CRL distribution points extension.</div>
<div class="section">
<h1>EXAMPLE</h1> Enable CRL checking when performing certificate verification during SSL connections associated with an  <b>SSL_CTX</b> structure <b>ctx</b>:<div class="spacer">
</div>
<br/>
  X509_VERIFY_PARAM *param;<br/>
  param = X509_VERIFY_PARAM_new();<br/>
  X509_VERIFY_PARAM_set_flags(param, X509_V_FLAG_CRL_CHECK);<br/>
  SSL_CTX_set1_param(ctx, param);<br/>
  X509_VERIFY_PARAM_free(param);<br/>
</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>X509_verify_cert</i>(3)</div>
<table class="foot">
<tr>
<td class="foot-date">
2015-09-22</td>
<td class="foot-os">
OpenBSD 6.0</td>
</tr>
</table>
</div>
</body>
</html>

