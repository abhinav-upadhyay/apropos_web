<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
BIO_F_CIPHER(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">BIO_f_cipher</b>, <b class="name">BIO_set_cipher</b>, <b class="name">BIO_get_cipher_status</b>, <b class="name">BIO_get_cipher_ctx</b> &#8212; <span class="desc">cipher BIO filter</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">openssl/bio.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">openssl/evp.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">BIO_METHOD *</i><br/>
<b class="fname">BIO_f_cipher</b>(<i class="farg">void</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">BIO_set_cipher</b>(<i class="farg">BIO *b</i>, <i class="farg">const EVP_CIPHER *cipher</i>, <i class="farg">unsigned char *key</i>, <i class="farg">unsigned char *iv</i>, <i class="farg">int enc</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BIO_get_cipher_status</b>(<i class="farg">BIO *b</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">BIO_get_cipher_ctx</b>(<i class="farg">BIO *b</i>, <i class="farg">EVP_CIPHER_CTX **pctx</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">BIO_f_cipher</b>() returns the cipher BIO method. This is a filter BIO that encrypts any data written through it, and decrypts any data read from it. It is a BIO wrapper for the cipher routines <a class="link-man" href="../html3/EVP_CipherInit.html">EVP_CipherInit(3)</a>, <a class="link-man" href="../html3/EVP_CipherUpdate.html">EVP_CipherUpdate(3)</a>, and <a class="link-man" href="../html3/EVP_CipherFinal.html">EVP_CipherFinal(3)</a>.<div class="spacer">
</div>
Cipher BIOs do not support <a class="link-man" href="../html3/BIO_gets.html">BIO_gets(3)</a> or <a class="link-man" href="../html3/BIO_puts.html">BIO_puts(3)</a>.<div class="spacer">
</div>
<a class="link-man" href="../html3/BIO_flush.html">BIO_flush(3)</a> on an encryption BIO that is being written through is used to signal that no more data is to be encrypted: this is used to flush and possibly pad the final block through the BIO.<div class="spacer">
</div>
<b class="fname">BIO_set_cipher</b>() sets the cipher of BIO <i class="farg">b</i> to <i class="farg">cipher</i> using key <i class="farg">key</i> and IV <i class="farg">iv</i>. <i class="farg">enc</i> should be set to 1 for encryption and zero for decryption.<div class="spacer">
</div>
When reading from an encryption BIO, the final block is automatically decrypted and checked when EOF is detected. <b class="fname">BIO_get_cipher_status</b>() is a <a class="link-man" href="../html3/BIO_ctrl.html">BIO_ctrl(3)</a> macro which can be called to determine whether the decryption operation was successful.<div class="spacer">
</div>
<b class="fname">BIO_get_cipher_ctx</b>() is a <a class="link-man" href="../html3/BIO_ctrl.html">BIO_ctrl(3)</a> macro which retrieves the internal BIO cipher context. The retrieved context can be used in conjunction with the standard cipher routines to set it up. This is useful when <b class="fname">BIO_set_cipher</b>() is not flexible enough for the applications needs.</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1> When encrypting, <a class="link-man" href="../html3/BIO_flush.html">BIO_flush(3)</a> must be called to flush the final block through the BIO. If it is not, then the final block will fail a subsequent decrypt.<div class="spacer">
</div>
When decrypting, an error on the final block is signalled by a zero return value from the read operation. A successful decrypt followed by EOF will also return zero for the final read. <b class="fname">BIO_get_cipher_status</b>() should be called to determine if the decrypt was successful.<div class="spacer">
</div>
As always, if <a class="link-man" href="../html3/BIO_gets.html">BIO_gets(3)</a> or <a class="link-man" href="../html3/BIO_puts.html">BIO_puts(3)</a> support is needed, then it can be achieved by preceding the cipher BIO with a buffering BIO.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">BIO_f_cipher</b>() returns the cipher BIO method.<div class="spacer">
</div>
<b class="fname">BIO_set_cipher</b>() does not return a value.<div class="spacer">
</div>
<b class="fname">BIO_get_cipher_status</b>() returns 1 for a successful decrypt and 0 for failure.<div class="spacer">
</div>
<b class="fname">BIO_get_cipher_ctx</b>() currently always returns 1.</div>
</div>
</body>
</html>

