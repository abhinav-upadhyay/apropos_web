<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
MKTEMP(1)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">mktemp</b> &#8212; <span class="desc">make temporary filename (unique)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 6.00ex;"/>
<col/>
<tbody>
<tr>
<td>
mktemp</td>
<td>
[<span class="opt"><b class="flag">-dqtu</b></span>] [<span class="opt"><b class="flag">-p</b> <i class="arg">directory</i></span>] [<span class="opt"><i class="arg">template</i></span>]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">mktemp</b> utility takes the given filename <i class="arg">template</i> and overwrites a portion of it to create a unique filename. The <i class="arg">template</i> may be any filename with at least six &#8216;<code class="lit">Xs</code>&#8217; appended to it, for example <i class="file">/tmp/tfile.XXXXXXXXXX</i>. If no <i class="arg">template</i> is specified a default of <i class="file">tmp.XXXXXXXXXX</i> is used and the <b class="flag">-t</b> flag is implied (see below).<div class="spacer">
</div>
The trailing &#8216;<code class="lit">Xs</code>&#8217; are replaced with a unique digit and letter combination. The name chosen depends both on the number of &#8216;<code class="lit">Xs</code>&#8217; in the <i class="arg">template</i> and the number of collisions with pre-existing files. The number of unique filenames <b class="name">mktemp</b> can return depends on the number of &#8216;<code class="lit">Xs</code>&#8217; provided; ten &#8216;<code class="lit">Xs</code>&#8217; will result in <b class="name">mktemp</b> testing roughly 26 ** 10 combinations.<div class="spacer">
</div>
If <b class="name">mktemp</b> can successfully generate a unique filename, the file (or directory) is created with file permissions such that it is only readable and writable by its owner (unless the <b class="flag">-u</b> flag is given) and the filename is printed to standard output.<div class="spacer">
</div>
<b class="name">mktemp</b> is provided to allow shell scripts to safely use temporary files. Traditionally, many shell scripts take the name of the program with the PID as a suffix and use that as a temporary filename. This kind of naming scheme is predictable and the race condition it creates is easy for an attacker to win. A safer, though still inferior approach is to make a temporary directory using the same naming scheme. While this does allow one to guarantee that a temporary file will not be subverted, it still allows a simple denial of service attack. For these reasons it is suggested that <b class="name">mktemp</b> be used instead.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Make a directory instead of a file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-p</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the specified <i class="arg">directory</i> as a prefix when generating the temporary filename. The <i class="arg">directory</i> will be overridden by the user's <span class="env">TMPDIR</span> environment variable if it is set. This option implies the <b class="flag">-t</b> flag (see below).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-q</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Fail silently if an error occurs. This is useful if a script does not want error output to go to standard error.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-t</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate a path rooted in a temporary directory. This directory is chosen as follows:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
If the user's <span class="env">TMPDIR</span> environment variable is set, the directory contained therein is used.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Otherwise, if the <b class="flag">-p</b> flag was given the specified directory is used.</li>
<li class="list-bul" style="margin-top: 1.00em;">
If none of the above apply, <i class="file">/tmp</i> is used.</li>
</ul>
<div class="spacer">
</div>
In this mode, the <i class="arg">template</i> (if specified) should be a directory component (as opposed to a full path) and thus should not contain any forward slashes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-u</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Operate in &#8220;unsafe&#8221; mode. The temp file will be unlinked before <b class="name">mktemp</b> exits. This is slightly better than <a class="link-man" href="../html3/mktemp.html">mktemp(3)</a> but still introduces a race condition. Use of this option is not encouraged.</dd>
</dl>
<div class="spacer">
</div>
The <b class="name">mktemp</b> utility exits with a value of 0 on success or 1 on failure.</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">TMPDIR</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
directory in which to place the temporary file when in <b class="flag">-t</b> mode</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The following <a class="link-man" href="../html1/sh.html">sh(1)</a> fragment illustrates a simple use of <b class="name">mktemp</b> where the script should quit if it cannot get a safe temporary file.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
TMPFILE=`mktemp /tmp/example.XXXXXXXXXX` || exit 1 
echo &quot;program output&quot; &gt;&gt; $TMPFILE</pre>
<div class="spacer">
</div>
The same fragment with support for a user's <span class="env">TMPDIR</span> environment variable can be written as follows.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
TMPFILE=`mktemp -t example.XXXXXXXXXX` || exit 1 
echo &quot;program output&quot; &gt;&gt; $TMPFILE</pre>
<div class="spacer">
</div>
This can be further simplified if we don't care about the actual name of the temporary file. In this case the <b class="flag">-t</b> flag is implied.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
TMPFILE=`mktemp` || exit 1 
echo &quot;program output&quot; &gt;&gt; $TMPFILE</pre>
<div class="spacer">
</div>
In some cases, it may be desirable to use a default temporary directory other than <i class="file">/tmp</i>. In this example the temporary file will be created in <i class="file">/extra/tmp</i> unless the user's <span class="env">TMPDIR</span> environment variable specifies otherwise.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
TMPFILE=`mktemp -p /extra/tmp example.XXXXXXXXXX` || exit 1 
echo &quot;program output&quot; &gt;&gt; $TMPFILE</pre>
<div class="spacer">
</div>
In other cases, we want the script to catch the error. For instance, if we attempt to create two temporary files and the second one fails we need to remove the first before exiting.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
TMP1=`mktemp -t example.1.XXXXXXXXXX` || exit 1 
TMP2=`mktemp -t example.2.XXXXXXXXXX` 
if [ $? -ne 0 ]; then 
	rm -f $TMP1 
	exit 1 
fi</pre>
<div class="spacer">
</div>
Or perhaps you don't want to exit if <b class="name">mktemp</b> is unable to create the file. In this case you can protect that part of the script thusly.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
TMPFILE=`mktemp -q -t example.XXXXXXXXXX` &amp;&amp; { 
	# Safe to use $TMPFILE in this block 
	echo data &gt; $TMPFILE 
	... 
	rm -f $TMPFILE 
}</pre>
</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> One of the following error messages may be displayed if <b class="name">mktemp</b> does not succeed and the <b class="flag">-q</b> option was not specified:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">insufficient number of Xs in template</code></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The specified <i class="arg">template</i> contained fewer than six &#8216;<code class="lit">Xs</code>&#8217; at the end.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">template must not contain directory separators in -t mode</code></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <i class="arg">template</i> contained one or more directory components and the <b class="flag">-t</b> option was specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">cannot make temp dir</code></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<b class="name">mktemp</b> was unable to create the temporary directory for any of the reasons specified by <a class="link-man" href="../html3/mkdtemp.html">mkdtemp(3)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">cannot make temp file</code></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<b class="name">mktemp</b> was unable to create the temporary file for any of the reasons specified by <a class="link-man" href="../html3/mkstemp.html">mkstemp(3)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">cannot allocate memory</code></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<b class="name">mktemp</b> was unable to allocate memory for any of the reasons specified by <a class="link-man" href="../html3/malloc.html">malloc(3)</a>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/mktemp.html">mktemp(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">mktemp</b> utility first appeared in <span class="unix">OpenBSD&#160;2.1</span>.</div>
</div>
</body>
</html>

