<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
LOGIN.CONF(5)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">login.conf</b> &#8212; <span class="desc">login class capability database</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 10.00ex;"/>
<col/>
<tbody>
<tr>
<td>
/etc/login.conf</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">login.conf</b> file describes the various attributes of login classes. A login class determines what styles of authentication are available as well as session resource limits and environment setup. While designed primarily for the <a class="link-man" href="../html1/login.html">login(1)</a> program, it is also used by other programs, such as <a class="link-man" href="../html8/ftpd.html">ftpd(8)</a>, to determine what means of authentication are available. It is also used by programs which need to set up a user environment.<div class="spacer">
</div>
A special record, &#8220;default&#8221;, in <i class="file">/etc/login.conf</i> is used for any user without a valid login class in <i class="file">/etc/master.passwd</i>.<div class="spacer">
</div>
Sites with very large <i class="file">/etc/login.conf</i> files may wish to create a database version of the file, <i class="file">/etc/login.conf.db</i>, for improved performance. Using a database version for small files does not result in a performance improvement. To build <i class="file">/etc/login.conf.db</i> from <i class="file">/etc/login.conf</i> the following command may be used:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># cap_mkdb /etc/login.conf</code></div>
</blockquote>
<div class="spacer">
</div>
Note that <a class="link-man" href="../html1/cap_mkdb.html">cap_mkdb(1)</a> must be run after each edit of <i class="file">/etc/login.conf</i> to keep the database version in sync with the plain file.</div>
<div class="section">
<h1 id="x4341504142494c4954494553">CAPABILITIES</h1> Refer to <a class="link-man" href="../html3/getcap.html">getcap(3)</a> for a description of the file layout. All entries in the <b class="name">login.conf</b> file are either boolean or use a &#8216;<code class="lit">=</code>&#8217; to separate the capability from the value. The types are described after the capability table.<table style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-col">
<col style="width: 15.00ex;"/>
<col style="width: 7.00ex;"/>
<col style="width: 10.00ex;"/>
<col style="min-width: 11.00ex;"/>
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Name</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Type</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Default</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Description</span></td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
approve</td>
<td class="list-col" style="margin-top: 1.00em;">
program</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Default program to approve login.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
approve-<i class="arg">service</i></td>
<td class="list-col" style="margin-top: 1.00em;">
program</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Program to approve login for <i class="arg">service</i>.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
auth</td>
<td class="list-col" style="margin-top: 1.00em;">
list</td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">passwd</span></td>
<td class="list-col" style="margin-top: 1.00em;">
Allowed authentication styles. The first value is the default styles.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
auth-<i class="arg">type</i></td>
<td class="list-col" style="margin-top: 1.00em;">
list</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Allowed authentication styles for the authentication type <i class="arg">type</i>.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
classify</td>
<td class="list-col" style="margin-top: 1.00em;">
program</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Classify type of login.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
copyright</td>
<td class="list-col" style="margin-top: 1.00em;">
file</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
File containing additional copyright information.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
coredumpsize</td>
<td class="list-col" style="margin-top: 1.00em;">
size</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Maximum coredump size limit.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
cputime</td>
<td class="list-col" style="margin-top: 1.00em;">
time</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
CPU usage limit.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
datasize</td>
<td class="list-col" style="margin-top: 1.00em;">
size</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Maximum data size limit.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
expire-warn</td>
<td class="list-col" style="margin-top: 1.00em;">
time</td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">2w</span></td>
<td class="list-col" style="margin-top: 1.00em;">
If the user's account will expire within this length of time then warn the user of this.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
filesize</td>
<td class="list-col" style="margin-top: 1.00em;">
size</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Maximum file size limit.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
hushlogin</td>
<td class="list-col" style="margin-top: 1.00em;">
bool</td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">false</span></td>
<td class="list-col" style="margin-top: 1.00em;">
Same as having a <i class="file">$HOME/.hushlogin</i> file. See <a class="link-man" href="../html1/login.html">login(1)</a>.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
ignorenologin</td>
<td class="list-col" style="margin-top: 1.00em;">
bool</td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">false</span></td>
<td class="list-col" style="margin-top: 1.00em;">
Not affected by <i class="file">nologin</i> files. See <a class="link-man" href="../html1/login.html">login(1)</a>.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
localcipher</td>
<td class="list-col" style="margin-top: 1.00em;">
string</td>
<td class="list-col" style="margin-top: 1.00em;">
blowfish,8</td>
<td class="list-col" style="margin-top: 1.00em;">
The cipher to use for encrypting passwords. Refer to <a class="link-man" href="../html3/crypt_newhash.html">crypt_newhash(3)</a> for possible values.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
login-backoff</td>
<td class="list-col" style="margin-top: 1.00em;">
number</td>
<td class="list-col" style="margin-top: 1.00em;">
3</td>
<td class="list-col" style="margin-top: 1.00em;">
After <i class="arg">login-backoff</i> unsuccessful login attempts during a single session, <a class="link-man" href="../html1/login.html">login(1)</a> will start sleeping a bit in between attempts.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
login-timeout</td>
<td class="list-col" style="margin-top: 1.00em;">
time</td>
<td class="list-col" style="margin-top: 1.00em;">
300</td>
<td class="list-col" style="margin-top: 1.00em;">
Number of seconds before <a class="link-man" href="../html1/login.html">login(1)</a> times out at the password prompt. Note that this setting is only valid for the <code class="lit">default</code> record.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
login-tries</td>
<td class="list-col" style="margin-top: 1.00em;">
number</td>
<td class="list-col" style="margin-top: 1.00em;">
10</td>
<td class="list-col" style="margin-top: 1.00em;">
Number of tries a user gets to successfully login before <a class="link-man" href="../html1/login.html">login(1)</a> closes the connection.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
stacksize</td>
<td class="list-col" style="margin-top: 1.00em;">
size</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Maximum stack size limit.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
maxproc</td>
<td class="list-col" style="margin-top: 1.00em;">
number</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Maximum number of processes.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
memorylocked</td>
<td class="list-col" style="margin-top: 1.00em;">
size</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Maximum locked in core memory size limit.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
memoryuse</td>
<td class="list-col" style="margin-top: 1.00em;">
size</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Maximum in core memoryuse size limit.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
minpasswordlen</td>
<td class="list-col" style="margin-top: 1.00em;">
number</td>
<td class="list-col" style="margin-top: 1.00em;">
6</td>
<td class="list-col" style="margin-top: 1.00em;">
The minimum length a local password may be. If a negative value or zero, no length restrictions are enforced. Used by the <a class="link-man" href="../html1/passwd.html">passwd(1)</a> utility.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
nologin</td>
<td class="list-col" style="margin-top: 1.00em;">
file</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
If the file exists it will be displayed and the login session will be terminated.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
openfiles</td>
<td class="list-col" style="margin-top: 1.00em;">
number</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Maximum number of open file descriptors per process.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
password-dead</td>
<td class="list-col" style="margin-top: 1.00em;">
time</td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">0</span></td>
<td class="list-col" style="margin-top: 1.00em;">
Length of time a password may be expired but not quite dead yet. When set (for both the client and remote server machine when doing remote authentication), a user is allowed to log in just one more time after their password (but not account) has expired. This allows a grace period for updating their password.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
password-warn</td>
<td class="list-col" style="margin-top: 1.00em;">
time</td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">2w</span></td>
<td class="list-col" style="margin-top: 1.00em;">
If the user's password will expire within this length of time then warn the user of this.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
passwordcheck</td>
<td class="list-col" style="margin-top: 1.00em;">
program</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
An external program that checks the quality of the password. The password is passed to the program on <i class="file">stdin</i>. An exit code of 0 indicates that the quality of the password is sufficient, an exit code of 1 signals that the password failed the check.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
passwordtime</td>
<td class="list-col" style="margin-top: 1.00em;">
time</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
The lifetime of a password in seconds, reset every time a user changes their password. When this value is exceeded the user will no longer be able to login unless the <code class="lit">password-dead</code> option has been specified. Used by the <a class="link-man" href="../html1/passwd.html">passwd(1)</a> utility.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
passwordtries</td>
<td class="list-col" style="margin-top: 1.00em;">
number</td>
<td class="list-col" style="margin-top: 1.00em;">
3</td>
<td class="list-col" style="margin-top: 1.00em;">
The number of times the <a class="link-man" href="../html1/passwd.html">passwd(1)</a> utility enforces a check on the password. If 0, the new password will only be accepted if it passes the password quality check.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
path</td>
<td class="list-col" style="margin-top: 1.00em;">
path</td>
<td class="list-col" style="margin-top: 1.00em;">
value of <span class="define">_PATH_DEFPATH</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<div style="height: 0.00em;">
&#160;</div>
Default search path. See <i class="file">/usr/include/paths.h</i>.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
priority</td>
<td class="list-col" style="margin-top: 1.00em;">
number</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Initial priority (nice) level.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
requirehome</td>
<td class="list-col" style="margin-top: 1.00em;">
bool</td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">false</span></td>
<td class="list-col" style="margin-top: 1.00em;">
Require home directory to login.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
setenv</td>
<td class="list-col" style="margin-top: 1.00em;">
envlist</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
A list of environment variables and associated values to be set for the class.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
shell</td>
<td class="list-col" style="margin-top: 1.00em;">
program</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Session shell to execute rather than the shell specified in the password file. The <span class="env">SHELL</span> environment variable will contain the shell specified in the password file.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
tc</td>
<td class="list-col" style="margin-top: 1.00em;">
string</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Interpolate/expands records from corresponding <i class="file">login.conf</i>. See <a class="link-man" href="../html3/getcap.html">getcap(3)</a>.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
term</td>
<td class="list-col" style="margin-top: 1.00em;">
string</td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">su</span></td>
<td class="list-col" style="margin-top: 1.00em;">
Default terminal type if not able to determine from other means.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
umask</td>
<td class="list-col" style="margin-top: 1.00em;">
number</td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">022</span></td>
<td class="list-col" style="margin-top: 1.00em;">
Initial umask. Should always have a leading <code class="lit">0</code> to ensure octal interpretation. See <a class="link-man" href="../html2/umask.html">umask(2)</a>.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
vmemoryuse</td>
<td class="list-col" style="margin-top: 1.00em;">
size</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Maximum virtual memoryuse size limit.<div class="spacer">
</div>
</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
welcome</td>
<td class="list-col" style="margin-top: 1.00em;">
file</td>
<td class="list-col" style="margin-top: 1.00em;">
<i class="file">/etc/motd</i></td>
<td class="list-col" style="margin-top: 1.00em;">
File containing welcome message.</td>
</tr>
</tbody>
</table>
<div class="spacer">
</div>
The resource limit entries (<b class="var">cputime</b>, <b class="var">filesize</b>, <b class="var">datasize</b>, <b class="var">stacksize</b>, <b class="var">coredumpsize</b>, <b class="var">memoryuse</b>, <b class="var">memorylocked</b>, <b class="var">maxproc</b>, and <b class="var">openfiles</b>) actually specify both the maximum and current limits (see <a class="link-man" href="../html2/getrlimit.html">getrlimit(2)</a>). The current limit is the one normally used, although the user is permitted to increase the current limit to the maximum limit. The maximum and current limits may be specified individually by appending a <b class="var">-max</b> or <b class="var">-cur</b> to the capability name (e.g., <b class="var">openfiles-max</b> and <b class="var">openfiles-cur</b>).<div class="spacer">
</div>
<span class="unix">OpenBSD</span> will never define capabilities which start with <code class="lit">x-</code> or <code class="lit">X-</code>, these are reserved for external use (unless included through contributed software).<div class="spacer">
</div>
The argument types are defined as:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
envlist</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
A comma-separated list of environment variables of the form <span class="env">variable</span><code class="none">=</code>value. If no value is specified, the &#8216;=&#8217; is optional. A <code class="lit">~</code> in the path name is expanded to the user's home directory if it is at the end of a string or is followed by a slash (&#8216;/&#8217;) or the user's login name. A <code class="lit">$</code> in the path name is expanded to the user's login name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
file</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Path name to a text file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
list</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
A comma-separated list of values.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
number</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
A number. A leading <code class="lit">0x</code> implies the number is expressed in hexadecimal. A leading <code class="lit">0</code> implies the number is expressed in octal. Any other number is treated as decimal.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
path</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
A space-separated list of path names. Login name and directory are substituted as for <span class="emph">envlist</span>. Additionally, a <code class="lit">~</code> is only expanded at the beginning of a path name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
program</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
A path name to program.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
size</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
A <b class="var">number</b> which expresses a size. By default, the size is specified in bytes. It may have a trailing <code class="lit">b</code>, <code class="lit">k</code>, <code class="lit">m</code>, <code class="lit">g</code> or <code class="lit">t</code> to indicate that the value is in 512-byte blocks, kilobytes, megabytes, gigabytes, or terabytes, respectively.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
time</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
A time in seconds. A time may be expressed as a series of numbers which are added together. Each number may have a trailing character to represent time units:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
y</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Indicates a number of 365 day years.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
w</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Indicates a number of 7 day weeks.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
d</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Indicates a number of 24 hour days.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
h</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Indicates a number of 60 minute hours.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
m</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Indicates a number of 60 second minutes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
s</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Indicates a number of seconds.</dd>
</dl>
<div class="spacer">
</div>
For example, to indicate 1 and 1/2 hours, the following string could be used: <code class="lit">1h30m</code>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x41555448454e5449434154494f4e">AUTHENTICATION</h1> <span class="unix">OpenBSD</span> uses <span class="unix">BSD</span> Authentication, which is made up of a variety of authentication styles. The authentication styles currently provided are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">activ</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Authenticate using an ActivCard token. See <a class="link-man" href="../html8/login_activ.html">login_activ(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">chpass</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Change user's password. See <a class="link-man" href="../html8/login_chpass.html">login_chpass(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">crypto</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Authenticate using a CRYPTOCard token. See <a class="link-man" href="../html8/login_crypto.html">login_crypto(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">lchpass</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Change user's local password. See <a class="link-man" href="../html8/login_lchpass.html">login_lchpass(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">passwd</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Request a password and check it against the password in the master.passwd file. See <a class="link-man" href="../html8/login_passwd.html">login_passwd(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">radius</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Normally linked to another authentication type, contact the radius server to do authentication. See <a class="link-man" href="../html8/login_radius.html">login_radius(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">reject</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Request a password and reject any request. See <a class="link-man" href="../html8/login_reject.html">login_reject(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">skey</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Send a challenge and request a response, checking it with S/Key (tm) authentication. See <a class="link-man" href="../html8/login_skey.html">login_skey(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">snk</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Authenticate using a SecureNet Key token. See <a class="link-man" href="../html8/login_snk.html">login_snk(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">token</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Authenticate using a generic X9.9 token. See <a class="link-man" href="../html8/login_token.html">login_token(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">yubikey</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Authenticate using a Yubico YubiKey token. See <a class="link-man" href="../html8/login_yubikey.html">login_yubikey(8)</a>.</dd>
</dl>
<div class="spacer">
</div>
Local authentication styles may be added by creating a login script for the style (see below). To prevent collisions with future official <span class="unix">BSD</span> Authentication style names, all local style names should start with a dash (-). Current plans are for all official <span class="unix">BSD</span> Authentication style names to begin with a lower case alphabetic character. For example, if you have a new style you refer to as <code class="lit">slick</code> then you should create an authentication script named <i class="file">/usr/libexec/auth/login_-slick</i> using the style name <code class="lit">-slick</code>. When logging in via the <a class="link-man" href="../html1/login.html">login(1)</a> program, the syntax <i class="arg">user</i><code class="lit">:-slick</code> would be used.<div class="spacer">
</div>
Authentication requires several pieces of information:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">class</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The login class being used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">service</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The type of service requesting authentication. The service type is used to determine what information the authentication program can provide to the user and what information the user can provide to the authentication program.<div class="spacer">
</div>
The service type <code class="lit">login</code> is appropriate for most situations. Two other service types, <code class="lit">challenge</code> and <code class="lit">response</code>, are provided for use by programs like <a class="link-man" href="../html8/ftpd.html">ftpd(8)</a> and <a class="link-man" href="../html8/radiusd.html">radiusd(8)</a>. If no service type is specified, <code class="lit">login</code> is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">style</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The authentication style being used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">type</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The authentication type, used to determine the available authentication styles.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">username</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The name of the user to authenticate. The name may contain an instance. If the authentication style being used does not support such instances, the request will fail.</dd>
</dl>
<div class="spacer">
</div>
The program requesting authentication must specify a username and an authentication style. (For example, <a class="link-man" href="../html1/login.html">login(1)</a> requests a username from the user. Users may enter usernames of the form &#8220;user:style&#8221; to optionally specify the authentication style.) The requesting program may also specify the type of authentication that will be done. Most programs will only have a single type, if any at all, i.e., <a class="link-man" href="../html8/ftpd.html">ftpd(8)</a> will always request the <code class="lit">ftp</code> type authentication, and <a class="link-man" href="../html1/su.html">su(1)</a> will always request the <code class="lit">su</code> type authentication. The <a class="link-man" href="../html1/login.html">login(1)</a> utility is special in that it may select an authentication type based on information found in the <i class="file">/etc/ttys</i> file for the appropriate tty (see <a class="link-man" href="../html5/ttys.html">ttys(5)</a>).<div class="spacer">
</div>
The class to be used is normally determined by the <code class="lit">class</code> field in the password file (see <a class="link-man" href="../html5/passwd.html">passwd(5)</a>).<div class="spacer">
</div>
The class is used to look up a corresponding entry in the <i class="file">login.conf</i> file. If an authentication type is defined and a value for <code class="lit">auth-</code><i class="arg">type</i> exists in that entry, it will be used as a list of potential authentication styles. If an authentication type is not defined, or <code class="lit">auth-</code><i class="arg">type</i> is not specified for the class, the value of <code class="lit">auth</code> is used as the list of available authentication styles.<div class="spacer">
</div>
If the user did not specify an authentication style the first style in the list of available styles is used. If the user did specify an authentication style and the style is in the list of available styles it will be used, otherwise the request is rejected.<div class="spacer">
</div>
For any given style, the program <i class="file">/usr/libexec/auth/login_</i><b class="var">style</b> is used to perform the authentication. The synopsis of this program is:<div class="spacer">
</div>
<code class="lit">/usr/libexec/auth/login_</code><b class="var">style</b> [<span class="opt"><b class="flag">-v</b> <b class="var">name=value</b></span>] [<span class="opt"><b class="flag">-s</b> <b class="var">service</b></span>] <b class="var">username class</b><div class="spacer">
</div>
The <b class="flag">-v</b> option is used to specify arbitrary information to the authentication programs. Any number of <b class="flag">-v</b> options may be used. The <a class="link-man" href="../html1/login.html">login(1)</a> program provides the following through the <b class="flag">-v</b> option:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">auth_type</code></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The type of authentication to use.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">fqdn</code></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The hostname provided to login by the <b class="flag">-h</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">hostname</code></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The name <a class="link-man" href="../html1/login.html">login(1)</a> will place in the utmp file for the remote hostname.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">local_addr</code></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The local IP address given to <a class="link-man" href="../html1/login.html">login(1)</a> by the <b class="flag">-L</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">lastchance</code></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Set to &#8220;yes&#8221; when a user's password has expired but the user is being given one last chance to login and update the password.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">login</code></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
This is a new login session (as opposed to a simple identity check).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">remote_addr</code></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The remote IP address given to <a class="link-man" href="../html1/login.html">login(1)</a> by the <b class="flag">-R</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">style</code></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The style of authentication used for this user (see approval scripts below).</dd>
</dl>
<div class="spacer">
</div>
The <a class="link-man" href="../html1/su.html">su(1)</a> program provides the following through the <b class="flag">-v</b> option:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">wheel</code></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Set to either &#8220;yes&#8221; or &#8220;no&#8221; to indicate if the user is in group wheel when they are trying to become root. Some authentication types require the user to be in group wheel when using the <a class="link-man" href="../html1/su.html">su(1)</a> program to become super user.</dd>
</dl>
<div class="spacer">
</div>
When the authentication program is executed, the environment will only contain the values <span class="env">PATH=/bin:/usr/bin</span> and <span class="env">SHELL=/bin/sh</span>. File descriptor 3 will be open for reading and writing. The authentication program should write one or more of the following strings to this file descriptor:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">authorize</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
The user has been authorized.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">authorize secure</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
The user has been authorized and root should be allowed to login even if this is not a secure terminal. This should only be sent by authentication styles that are secure over insecure lines.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">reject</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Authorization is rejected. This overrides any indication that the user was authorized (though one would question the wisdom in sending both a <b class="var">reject</b> and an <b class="var">authorize</b> command).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">reject challenge</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Authorization was rejected and a challenge has been made available via the value <code class="lit">challenge</code>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">reject silent</code></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Authorization is rejected, but no error messages should be generated.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">remove</code> <b class="var">file</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
If the login session fails for any reason, remove <b class="var">file</b> before termination.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">setenv</code> <b class="var">name</b> <b class="var">value</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
If the login session succeeds, the environment variable <b class="var">name</b> should be set to the specified <b class="var">value</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">unsetenv</code> <b class="var">name</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
If the login session succeeds, the environment variable <b class="var">name</b> should be removed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">value</code> <b class="var">name</b> <b class="var">value</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Set the internal variable <b class="var">name</b> to the specified <b class="var">value</b>. The <b class="var">value</b> should only contain printable characters. Several \ sequences may be used to introduce non printing characters. These are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">\n</code></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A newline.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">\r</code></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A carriage return.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">\t</code></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A tab.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">\</code><b class="var">xxx</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The character represented by the octal value <b class="var">xxx</b>. The value may be one, two, or three octal digits.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">\</code><b class="var">c</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The string is replaced by the value of <b class="var">c</b>. This allows quoting an initial space or the \ character itself.</dd>
</dl>
<div class="spacer">
</div>
The following values are currently defined:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">challenge</code></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
See section on challenges below.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">errormsg</code></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If set, the value is the reason authentication failed. The calling program may choose to display this when rejecting the user, but display is not required.</dd>
</dl>
</dd>
</dl>
<div class="spacer">
</div>
In order for authentication to be successful, the authentication program must exit with a value of 0 as well as provide an <code class="lit">authorize</code> or <code class="lit">authorize root</code> statement on file descriptor 3.<div class="spacer">
</div>
An authentication program must not assume it will be called as root, nor must it assume it will not be called as root. If it needs special permissions to access files it should be setuid or setgid to the appropriate user/group. See <a class="link-man" href="../html1/chmod.html">chmod(1)</a>.</div>
<div class="section">
<h1 id="x4348414c4c454e474553">CHALLENGES</h1> When an authentication program is called with a service of <code class="lit">challenge</code> it should do one of three things:<div class="spacer">
</div>
If this style of authentication supports challenge response it should set the internal variable <code class="lit">challenge</code> to be the appropriate challenge for the user. This is done by the <code class="lit">value</code> command listed above. The program should also issue a <code class="lit">reject challenge</code> and then exit with a 0 status. See the section on responses below.<div class="spacer">
</div>
If this style of authentication does not support challenge response, but does support the <code class="lit">response</code> service (described below) it should issue <code class="lit">reject silent</code> and then exit with a 0 status.<div class="spacer">
</div>
If this style of authentication does not support the <code class="lit">response</code> service it should simply fail, complaining about an unknown service type. It should exit with a non-zero status.</div>
<div class="section">
<h1 id="x524553504f4e534553">RESPONSES</h1> When an authentication program is called with a service of <code class="lit">response</code>, and this style supports this mode of authentication, it should read two null terminated strings from file descriptor 3. The first string is a challenge that was issued to the user (obtained from the <code class="lit">challenge</code> service above). The second string is the response the user gave (i.e., the password). If the response is correct for the specified challenge, the authentication should be accepted, else it should be rejected. It is possible for the challenge to be an empty string, which implies the calling program did first obtain a challenge prior to getting a response from the user. Not all authentication styles support empty challenges.</div>
<div class="section">
<h1 id="x415050524f56414c">APPROVAL</h1> An approval program has the synopsis of:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="var">approve</b> [<span class="opt"><b class="flag">-v</b> <i class="arg">name=value</i></span>] <b class="var">username class service</b></div>
<div class="spacer">
</div>
Just as with an authentication program, file descriptor 3 will be open for writing when the approval program is executed. The <b class="flag">-v</b> option is the same as in the authentication program. Unlike an authentication program, the approval program need not explicitly send an <code class="lit">authorize</code> or <code class="lit">authorize root</code> statement, it only need exit with a value of 0 or non-zero. An exit value of 0 is equivalent to an <code class="lit">authorize</code> statement, and non-zero to a <code class="lit">reject</code> statement. This allows for simple programs which have no information to provide other than approval or denial.</div>
<div class="section">
<h1 id="x434c415353494649434154494f4e">CLASSIFICATION</h1> A classify program has the synopsis of:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="var">classify</b> [<span class="opt"><b class="flag">-v</b> <i class="arg">name=value</i></span>] [<span class="opt"><b class="flag">-f</b></span>] [<span class="opt">user</span>]</div>
<div class="spacer">
</div>
See <a class="link-man" href="../html1/login.html">login(1)</a> for a description of the <b class="flag">-f</b>, option. The <b class="flag">-v</b> option is the same as for the authentication programs. The <b class="var">user</b> is the username passed to <a class="link-man" href="../html1/login.html">login(1)</a> login, if any.<div class="spacer">
</div>
The typical job of the classify program is to determine what authentication type should actually be used, presumably based on the remote IP address. It might also re-specify the hostname to be included in the <a class="link-man" href="../html5/utmp.html">utmp(5)</a> file, reject the login attempt outright, or even print an additional login banner (e.g., <i class="file">/etc/issue</i>).<div class="spacer">
</div>
The classify entry is only valid for the <code class="lit">default</code> class as it is used prior to knowing who the user is. The classify script may pass environment variables or other commands back to <a class="link-man" href="../html1/login.html">login(1)</a> on file descriptor 3, just as an authentication program does. The two variables <b class="name">AUTH_TYPE</b> and <b class="name">REMOTE_NAME</b> are used to specify a new authentication type (the type must have the form <code class="lit">auth-</code><i class="arg">type</i>) and override the <b class="flag">-h</b> option to login, respectively.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/cap_mkdb.html">cap_mkdb(1)</a>, <a class="link-man" href="../html1/login.html">login(1)</a>, <a class="link-man" href="../html3/auth_subr.html">auth_subr(3)</a>, <a class="link-man" href="../html3/authenticate.html">authenticate(3)</a>, <a class="link-man" href="../html3/getcap.html">getcap(3)</a>, <a class="link-man" href="../html3/login_cap.html">login_cap(3)</a>, <a class="link-man" href="../html5/passwd.html">passwd(5)</a>, <a class="link-man" href="../html5/ttys.html">ttys(5)</a>, <a class="link-man" href="../html8/ftpd.html">ftpd(8)</a></div>
</div>
</body>
</html>

