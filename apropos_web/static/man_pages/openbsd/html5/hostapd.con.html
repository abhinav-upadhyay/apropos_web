<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
HOSTAPD.CONF(5)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">hostapd.conf</b> &#8212; <span class="desc">configuration file for the Host Access Point daemon</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">hostapd.conf</b> is the configuration file for the <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> daemon.</div>
<div class="section">
<h1 id="x53454354494f4e53">SECTIONS</h1> The <b class="name">hostapd.conf</b> file is divided into four main sections.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">Macros</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
User-defined variables may be defined and used later, simplifying the configuration file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">Tables</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Tables provide a mechanism to handle a large number of link layer addresses easily, with increased performance and flexibility.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">Global Configuration</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Global runtime settings for <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">Event Rules</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Event rules provide a powerful mechanism to trigger certain actions when receiving specified IEEE 802.11 frames.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">IP Roaming</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The concepts and details about the optional IP based roaming in <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a>.</dd>
</dl>
<div class="spacer">
</div>
The current line can be extended over multiple lines using a backslash (&#8216;\&#8217;). Comments can be put anywhere in the file using a hash mark (&#8216;#&#8217;), and extend to the end of the current line. Care should be taken when commenting out multi-line text: the comment is effective until the end of the entire block.<div class="spacer">
</div>
Argument names not beginning with a letter, digit, or underscore must be quoted.<div class="spacer">
</div>
Additional configuration files can be included with the <b class="cmd">include</b> keyword, for example:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
include &quot;/etc/hostapd.conf.local&quot;</pre>
</div>
<div class="section">
<h1 id="x4d4143524f53">MACROS</h1> Macros can be defined that will later be expanded in context. Macro names must start with a letter, digit, or underscore, and may contain any of those characters. Macro names may not be reserved words (for example, <b class="cmd">set</b>, <b class="cmd">interface</b>, or <b class="cmd">hostap</b>). Macros are not expanded inside quotes.<div class="spacer">
</div>
For example:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
wlan=&quot;ath0&quot; 
set iapp handle subtype { ! add notify, radiotap } 
set iapp interface $wlan</pre>
</div>
<div class="section">
<h1 id="x5441424c4553">TABLES</h1> Tables are named structures which can hold a collection of link layer addresses, masked address ranges, and link layer to IP address assignments. Lookups against tables in <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> are relatively fast, making a single rule with tables much more efficient, in terms of processor usage and memory consumption, than a large number of rules which differ only in link layer addresses.<div class="spacer">
</div>
Tables are used for <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> <span class="emph">event rules</span> to match specified IEEE 802.11 link layer addresses and address ranges, and the capability to assign link layer to IP addresses and an option netmask is a requirement for advanced IAPP functionality.<div class="spacer">
</div>
Table options may be presented after the table name declaration. The following options are supported:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">const</b></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
The table is constant and cannot be later changed from its original definition.</dd>
</dl>
<div class="spacer">
</div>
For example:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
cisco=&quot;00:40:06:ff:ff:ff &amp; ff:ff:ff:00:00:00&quot; 
 
table &lt;black&gt; { $cisco, 00:0d:60:ff:f1:2a } 
table &lt;myess&gt; const { 
	00:00:24:c3:40:18 -&gt; 10.195.64.24, 
	00:00:24:c3:40:19 -&gt; 10.195.64.25, 
	00:00:24:c3:40:1a -&gt; 10.195.64.26 
} 
table &lt;myclient&gt; const { 
	00:05:4e:45:d4:b9 -&gt; 172.23.5.1/30 
}</pre>
</div>
<div class="section">
<h1 id="x474c4f42414c20434f4e46494755524154494f4e">GLOBAL CONFIGURATION</h1> The following configuration settings are understood:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">set hostap interface</b> <i class="arg">interface</i> | {<i class="arg">interface0</i>, <i class="arg">interface1</i>, <i class="arg">...</i>}</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the wireless interface running in Host AP mode. This option could be omitted to use <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> to log received IAPP messages. Multiple hostap interfaces may be specified as a comma-separated list, surrounded by curly braces.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">set hostap mode</b> <i class="arg">mode</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the Host AP capture mode. The supported modes are:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">radiotap</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Capture IEEE 802.11 frames with additional radiotap headers. They will provide optional but useful information like received frame signal levels.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">pcap</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Capture plain IEEE 802.11 frames.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">set hostap hopper interface</b> <i class="arg">interface</i> | {<i class="arg">interface0</i>, <i class="arg">interface1</i>, <i class="arg">...</i>}</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable a channel hopper on the selected wireless interface. Multiple hostap interfaces may be specified as a comma-separated list, surrounded by curly braces.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">set hostap hopper delay</b> <i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the delay in milliseconds for the channel hopper before hopping to the next available channel. The default value is 800 milliseconds.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">set iapp interface</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the mandatory Inter-Access-Point (IAPP) interface. It is important that the IAPP interface is on a trusted network because there is no authentication and an attacker could force disassociation of selected stations on all listening access points.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">set iapp</b> [<span class="opt"><b class="cmd">address</b> | <b class="cmd">route</b></span>] <b class="cmd">roaming table</b> &lt;<i class="arg">table</i>&gt;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify a table used for <span class="emph">IP Roaming</span> lookups of link layer address to IP address or subnet assignments.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">set iapp handle subtype</b> <i class="arg">subtype</i> | {<i class="arg">subtype0</i>, <i class="arg">subtype1</i>, <i class="arg">...</i>}</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the IAPP subtypes to use:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
[<span class="opt"><b class="cmd">not</b></span>] <b class="cmd">add notify</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Send and receive <span class="emph">ADD.notify</span> messages. This option is enabled by default.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
[<span class="opt"><b class="cmd">not</b></span>] <b class="cmd">radiotap</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Receive <span class="emph">radiotap</span> messages. This option is enabled by default.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
[<span class="opt"><b class="cmd">not</b></span>] [<span class="opt"><b class="cmd">address |&#160;route</b></span>] <b class="cmd">roaming</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Enable dynamic roaming of IP addresses or routes. These options are disabled by default.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">set iapp mode</b> <i class="arg">mode</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the IAPP mode. The supported modes are:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">multicast</b> [<span class="opt"><b class="cmd">address</b> <i class="arg">ipv4addr</i></span>] [<span class="opt"><b class="cmd">port</b> <i class="arg">number</i></span>] [<span class="opt"><b class="cmd">ttl</b> <i class="arg">number</i></span>]</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Use <a class="link-man" href="../html4/multicast.html">multicast(4)</a> frames. A multicast time-to-live (TTL) of 2 or higher is required to allow multicast forwarding, for example for use with <a class="link-man" href="../html8/mrouted.html">mrouted(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">broadcast</b> [<span class="opt"><b class="cmd">port</b> <i class="arg">number</i></span>]</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Use broadcast frames.</dd>
</dl>
<div class="spacer">
</div>
The default is multicast using the multicast address 224.0.1.178 and port 3517 with a TTL limited to 1 hop. Some access point vendors still use broadcast with the pre-standard IAPP port 2313.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4556454e542052554c4553">EVENT RULES</h1> Event rules provide a powerful way to trigger a certain action when receiving specified IEEE 802.11 frames on the <span class="emph">hostap interface</span>. The rules are handled in sequential order, from first to last. Rules are handled without a state: each rule is processed independently from the others and from any previous actions. This behaviour is somewhat different to that of packet filter rules specified in <a class="link-man" href="../html5/pf.conf.html">pf.conf(5)</a>.<div class="spacer">
</div>
All <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> event rules are single line statements beginning with the mandatory <b class="cmd">hostap handle</b> keywords and optional rule options, interface, frame matching, a specified action, a limit, and a minimal rate:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="cmd">hostap handle</b> [<span class="opt"><i class="arg">option</i></span>] [<span class="opt"><i class="arg">interface</i></span>] [<span class="opt"><i class="arg">frame</i></span>] [<span class="opt"><i class="arg">action</i></span>] [<span class="opt"><i class="arg">limit</i></span>] [<span class="opt"><i class="arg">rate</i></span>]</div>
<div class="spacer">
</div>
Some rule statements support the optional keyword <b class="cmd">not</b>, also represented by the <b class="cmd">!</b> operator, for inverse matching.<div class="spacer">
</div>
The optional parts are defined below.<div class="subsection">
<h2 id="x52756c65204f7074696f6e">Rule Option</h2> The rule <i class="arg">option</i> will modify the behaviour of handling the statement. There are two possible options, <b class="cmd">quick</b> and <b class="cmd">skip</b>. If either the keyword <b class="cmd">quick</b> or the keyword <b class="cmd">skip</b> is specified, no further event rules will be handled for this frame after processing this rule successfully. The keyword <b class="cmd">skip</b> additionally skips any further IAPP processing of the frame, which is normally done after handling the event rules.</div>
<div class="subsection">
<h2 id="x52756c6520496e74657266616365">Rule Interface</h2> The rule <i class="arg">interface</i> specifies the hostap interface the rule is matched on. The available interface list is specified by the global <b class="cmd">set hostap interface</b> configuration setting.<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="cmd">on</b> [<span class="opt"><b class="cmd">not</b></span>] <i class="arg">interface</i></div>
<div class="spacer">
</div>
If not given, the event rule is matched on all available hostap interfaces.</div>
<div class="subsection">
<h2 id="x52756c65204672616d65">Rule Frame</h2> The <i class="arg">frame</i> description specifies a mechanism to match IEEE 802.11 frames.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">any</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Match all frames.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">frame</b> [<span class="opt"><i class="arg">type</i></span>] [<span class="opt"><i class="arg">dir</i></span>] [<span class="opt"><i class="arg">from</i></span>] [<span class="opt"><i class="arg">to</i></span>] [<span class="opt"><i class="arg">bssid</i></span>] [<span class="opt"><i class="arg">radiotap</i></span>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Apply rules to frames matching the given parameters. The parameters are explained below.<div class="spacer">
</div>
The <i class="arg">type</i> parameter specifies the frame type to match on. The frame type may be specified in the following ways:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">type any</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Match all frame types.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">type</b> [<span class="opt"><b class="cmd">not</b></span>] <b class="cmd">data</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Match data frames. Presence of the <b class="cmd">not</b> keyword negates the match and will match all non-data frames.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">type</b> [<span class="opt"><b class="cmd">not</b></span>] <b class="cmd">management</b> [<span class="opt">[<span class="opt"><b class="cmd">not</b></span>] <i class="arg">subtype</i></span>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Match management frames. The <i class="arg">subtype</i> argument may be specified to optionally match management frames of the given subtype. The subtype match may be negated by specifying the <b class="cmd">not</b> keyword. See the <i class="link-sec"><a class="link-sec" href="#x4d616e6167656d656e74204672616d65205375627479706573">Management Frame Subtypes</a></i> section below for available subtypes specifications.</dd>
</dl>
<div class="spacer">
</div>
The <i class="arg">dir</i> parameter specifies the direction the frame is being sent. The direction may be specified in the following ways:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">dir any</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Match all directions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">dir</b> <i class="arg">framedir</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Match frames with the given direction <i class="arg">framedir</i>. See the <i class="link-sec"><a class="link-sec" href="#x4672616d6520446972656374696f6e73">Frame Directions</a></i> section below for available direction specifications.</dd>
</dl>
<div class="spacer">
</div>
The <i class="arg">radiotap</i> rules allow parsing and matching of the extra information reported by the radiotap header. Support for the specified radiotap headers is optional and the specific parameters depend on the radiotap elements reported by the wireless interface. Support for the radiotap data link type can be verified with the <a class="link-man" href="../html8/tcpdump.html">tcpdump(8)</a> command. These rules require <b class="cmd">hostap mode radiotap</b> in the global configuration.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">signal</b> [<span class="opt"><b class="cmd">operator</b></span>] <i class="arg">percentage</i> <b class="cmd">%</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Match the signal quality of the received frame.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">freq</b> [<span class="opt"><b class="cmd">operator</b></span>] <i class="arg">value</i> (<b class="cmd">GHz</b> | <b class="cmd">MHz</b>)</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Match the transmit rate of the received frame.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">txrate</b> [<span class="opt"><b class="cmd">operator</b></span>] <i class="arg">rate</i> <b class="cmd">Mb</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Match the frequency of the received frame, in Mbps.</dd>
</dl>
<div class="spacer">
</div>
The radiotap rules support the following operators. If omitted, the specified value will be checked if it is equal or not.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
=	(equal) 
!=	(not equal) 
&lt;	(less than) 
&lt;=	(less than or equal) 
&gt;	(greater than) 
&gt;=	(greater than or equal)</pre>
<div class="spacer">
</div>
The <i class="arg">from</i>, <i class="arg">to</i>, and <i class="arg">bssid</i> parameters specify the IEEE 802.11 address fields to match on. They can be specified in the following ways:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
(<b class="cmd">from</b> | <b class="cmd">to</b> | <b class="cmd">bssid</b>) <b class="cmd">any</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Allow all addresses for the specified address field.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
(<b class="cmd">from</b> | <b class="cmd">to</b> | <b class="cmd">bssid</b>) [<span class="opt"><b class="cmd">not</b></span>] &lt;<i class="arg">table</i>&gt;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Allow allow addresses from the given <i class="arg">table</i> (see <i class="link-sec"><a class="link-sec" href="#x5461626c6573">Tables</a></i> above) for the specified address field.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
(<b class="cmd">from</b> | <b class="cmd">to</b> | <b class="cmd">bssid</b>) [<span class="opt"><b class="cmd">not</b></span>] <i class="arg">lladdr</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Allow the given address <i class="arg">lladdr</i> for the specified address field.</dd>
</dl>
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x52756c6520416374696f6e">Rule Action</h2> An optional <i class="arg">action</i> is triggered if a received IEEE 802.11 frame matches the frame description. The following actions are supported:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">with frame</b> <i class="arg">type</i> [<span class="opt"><i class="arg">dir</i></span>] <i class="arg">from to bssid</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Send an arbitrary constructed frame to the wireless network. The arguments are as follows.<div class="spacer">
</div>
The <i class="arg">type</i> describes the IEEE 802.11 frame type to send, specified in the frame control header. The following frames types are supported at present:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">type data</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Send a data frame. This is normally used to encapsulate ordinary IEEE 802.3 frames into IEEE 802.11 wireless frames.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">type</b> <b class="cmd">management</b> <i class="arg">subtype</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Send a management frame with the specified subtype. Management frames are used to control states and to find access points and IBSS nodes in IEEE 802.11 networks. See the <i class="link-sec"><a class="link-sec" href="#x4d616e6167656d656e74204672616d65205375627479706573">Management Frame Subtypes</a></i> section below for available subtypes specifications.</dd>
</dl>
<div class="spacer">
</div>
The <i class="arg">dir</i> describes the direction the IEEE 802.11 frame will be sent. It has the following syntax:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="cmd">dir</b> <i class="arg">framedir</i></div>
<div class="spacer">
</div>
See the <i class="link-sec"><a class="link-sec" href="#x4672616d6520446972656374696f6e73">Frame Directions</a></i> section below for available direction specifications.<div class="spacer">
</div>
The <i class="arg">from</i>, <i class="arg">to</i>, and <i class="arg">bssid</i> arguments specify the link layer address fields used in IEEE 802.11 frames. All address fields are mandatory in the frame action. The optional fourth address field used by wireless distribution systems (WDS) is currently not supported. Each argument is specified by a keyword of the same name (<b class="cmd">from</b>, <b class="cmd">to</b>, or <b class="cmd">bssid</b>) followed by one of the following address specifications:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">lladdr</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Specify the link layer addresses used in the IEEE 802.11 frame address field. The link layer address &#8216;<code class="lit">ff:ff:ff:ff:ff:ff</code>&#8217; is the IEEE 802.11 broadcast address.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">&amp;</code><i class="arg">refaddr</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Fill in a link layer address from the previously matched IEEE 802.11 frame. <b class="cmd">&amp;from</b> will use the source link layer address; <b class="cmd">&amp;to</b> the destination link layer address; and <b class="cmd">&amp;bssid</b> the BSSID link layer address of the previously matched frame.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">random</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Use a random link layer address in the specified IEEE 802.11 frame address field. Multicast and broadcast link layer addresses will be skipped.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">with iapp type</b> <i class="arg">iapp-type</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Send a <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> specific IAPP frame with a raw IEEE 802.11 packet dump of the received frame to the wired network. The only supported <i class="arg">iapp-type</i> is <b class="cmd">radiotap</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">with log</b> [<span class="opt"><b class="cmd">verbose</b></span>]</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Write informational messages to the local system log (see <a class="link-man" href="../html8/syslogd.html">syslogd(8)</a>) or standard error. If the <i class="link-sec"><a class="link-sec" href="#x52756c652052617465">Rule Rate</a></i> has been specified, log will print the actual rate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">node add</b> | <b class="cmd">delete</b> <i class="arg">lladdr</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Add or remove the specified node from the internal kernel node table.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">resend</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Resend the received IEEE 802.11 frame.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x52756c65204c696d6974">Rule Limit</h2> It is possible to limit handling of specific rules with the <b class="cmd">limit</b> keyword:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="cmd">limit</b> <i class="arg">number</i> <b class="cmd">sec</b> | <b class="cmd">usec</b></div>
<div class="spacer">
</div>
In some cases it is absolutely necessary to use limited matching to protect <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> against excessive flooding with IEEE 802.11 frames. For example, beacon frames will be normally received every 100 ms.</div>
<div class="subsection">
<h2 id="x52756c652052617465">Rule Rate</h2> It is possible to tell <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> to trigger the action only after a specific <b class="cmd">rate</b> of matched frames.<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="cmd">rate</b> <i class="arg">number</i> <i class="arg">/</i> <i class="arg">number</i> <b class="cmd">sec</b></div>
<div class="spacer">
</div>
This will help to detect excessive flooding of IEEE 802.11 frames. For example, de-auth flooding is a denial of service (DoS) attack against IEEE 802.11 wireless networks.</div>
<div class="subsection">
<h2 id="x4d616e6167656d656e74204672616d65205375627479706573">Management Frame Subtypes</h2> The <i class="arg">subtype</i> describes the IEEE 802.11 frame subtype, specified in the frame control header. The choice of subtypes depends on the used frame type. <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> currently only supports management frame subtypes. Most frame subtypes require an additional subtype-specific header in the frame body, but currently only the <b class="cmd">deauth</b> and <b class="cmd">disassoc</b> reason codes are supported:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-ohang">
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">subtype beacon</b></dt>
<dd class="list-ohang">
A beacon frame. Wireless access points and devices running in <span class="emph">ibss</span> master or <span class="emph">hostap</span> mode continuously send beacon frames to indicate their presence, traffic load, and capabilities.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">subtype deauth</b> [<span class="opt"><i class="arg">reason</i></span>]</dt>
<dd class="list-ohang">
A deauthentication frame with an optional reason code. Deauthenticated stations will lose any IEEE 802.11 operational state.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">subtype disassoc</b> [<span class="opt"><i class="arg">reason</i></span>]</dt>
<dd class="list-ohang">
A disassociation frame with an optional reason code.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">subtype assoc request</b></dt>
<dd class="list-ohang">
An association request frame.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">subtype assoc response</b></dt>
<dd class="list-ohang">
An association response frame.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">subtype atim</b></dt>
<dd class="list-ohang">
An announcement traffic indication message (ATIM frame).</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">subtype auth</b> [<span class="opt"><b class="cmd">open request</b> | <b class="cmd">response</b></span>]</dt>
<dd class="list-ohang">
An authentication frame.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">subtype probe request</b></dt>
<dd class="list-ohang">
A probe request frame. Probe requests are used to probe for access points and IBSS nodes.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">subtype probe response</b></dt>
<dd class="list-ohang">
A probe response frame.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">subtype reassoc request</b></dt>
<dd class="list-ohang">
A re-association request frame.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">subtype reassoc response</b></dt>
<dd class="list-ohang">
A re-association response frame.</dd>
</dl>
<div class="spacer">
</div>
The <i class="arg">reason</i> defines a descriptive reason for the actual <span class="emph">deauthentication</span> or <span class="emph">disassociation</span> of a station:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-ohang">
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason assoc expire</b></dt>
<dd class="list-ohang">
Disassociated due to inactivity.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason assoc leave</b></dt>
<dd class="list-ohang">
Disassociated because the sending station is leaving or has left the wireless network.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason assoc toomany</b></dt>
<dd class="list-ohang">
Disassociated because the access point has reached its limit of associated stations.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason auth expire</b></dt>
<dd class="list-ohang">
Previous authentication no longer valid.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason auth leave</b></dt>
<dd class="list-ohang">
Deauthenticated because the sending station is leaving or has left the wireless network.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason ie invalid</b></dt>
<dd class="list-ohang">
IEEE 802.11i extension.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason mic failure</b></dt>
<dd class="list-ohang">
IEEE 802.11i extension.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason not authed</b></dt>
<dd class="list-ohang">
Frame received from unauthenticated station.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason assoc not authed</b></dt>
<dd class="list-ohang">
Frame received from an associated but unauthenticated station.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason not assoced</b></dt>
<dd class="list-ohang">
Frame received from unassociated station.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason rsn required</b></dt>
<dd class="list-ohang">
IEEE 802.11i extension.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason rsn inconsistent</b></dt>
<dd class="list-ohang">
IEEE 802.11i extension.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">reason unspecified</b></dt>
<dd class="list-ohang">
Unspecified reason.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4672616d6520446972656374696f6e73">Frame Directions</h2> The direction a frame is being transmitted (<i class="arg">framedir</i>) can be specified in the following ways:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 3.00ex;" class="list list-ohang">
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">dir no ds</b></dt>
<dd class="list-ohang">
No distribution system direction is used for management frames.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">dir to ds</b></dt>
<dd class="list-ohang">
A frame sent from a station to the distribution system, the access point.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">dir from ds</b></dt>
<dd class="list-ohang">
A frame from the distribution system, the access point, to a station.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<b class="cmd">dir ds to ds</b></dt>
<dd class="list-ohang">
A frame direction used by wireless distribution systems (WDS) for wireless access point to access point communication.</dd>
</dl>
</div>
</div>
<div class="section">
<h1 id="x4556454e542052554c45204558414d504c4553">EVENT RULE EXAMPLES</h1><pre style="margin-left: 0.00ex;" class="lit display">
# Log probe requests locally 
hostap handle type management subtype probe request \ 
    with log 
 
# Detect flooding of management frames except beacons. 
# This will detect some possible denial of service attacks 
# against the IEEE 802.11 protocol. 
hostap handle skip type management subtype ! beacon \ 
    with log \ 
    rate 100 / 10 sec 
 
# Log rogue access points via IAPP, limited to every second, 
# and skip further IAPP processing. 
hostap handle skip type management subtype beacon bssid !&lt;myess&gt; \ 
    with iapp type radiotap limit 1 sec 
 
# Send deauthentication frames to stations associated to rogue APs 
hostap handle type data bssid !&lt;myess&gt; with frame type management \ 
    subtype deauth reason auth expire \ 
    from &amp;bssid to &amp;from bssid &amp;bssid 
 
# Send authentication requests from random station addresses to 
# rogue access points. This is a common way to test the quality of 
# various hostap implementations. 
hostap handle skip type management subtype beacon bssid &lt;pentest&gt; \ 
    with frame type management subtype auth \ 
    from random to &amp;bssid bssid &amp;bssid 
 
# Re-inject a received IEEE 802.11 frame on the interface ath0 
hostap handle on ath0 type management subtype auth with resend 
 
# Remove a blacklisted node from the kernel node tree 
hostap handle type management subtype auth from &lt;blacklist&gt; \ 
    with node delete &amp;from 
 
# Log rogue access points with a strong signal quality on 
# channel 3 (2.422GHz) transmitting frames with 1Mbps. 
hostap handle type management subtype beacon bssid !&lt;myess&gt; \ 
    signal &gt;= 50% txrate 1Mb freq 2.422GHz \ 
    with log</pre>
</div>
<div class="section">
<h1 id="x495020524f414d494e47">IP ROAMING</h1> In a traditional wireless network, multiple access points are members of a single layer 3 broadcast domain. The traffic is bridged between physical collision domains, as with the <a class="link-man" href="../html4/bridge.html">bridge(4)</a> interface in <span class="unix">OpenBSD</span>. This may cause problems in large wireless networks with a heavy load of broadcast traffic, like broadcasted ARP, DHCP or ICMP requests.<div class="spacer">
</div>
<a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> implements IP based roaming to build wireless networks without the requirement of a single broadcast domain. This works as follows:<div class="spacer">
</div>
<ol style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-enum">
<li class="list-enum" style="margin-top: 0.00em;">
Every access point running <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> is a router to an individual internal broadcast domain, <span class="emph">without</span> using the <a class="link-man" href="../html4/bridge.html">bridge(4)</a> interface.</li>
<li class="list-enum" style="margin-top: 0.00em;">
An increased multicast TTL is used for IAPP communication between access points in multiple network segments. Multicast routing is required in the network infrastructure, like an <span class="unix">OpenBSD</span> router running <a class="link-man" href="../html8/mrouted.html">mrouted(8)</a>.</li>
<li class="list-enum" style="margin-top: 0.00em;">
The configuration file <b class="name">hostapd.conf</b> is used to assign IP subnets to link layer addresses. If a station with the specified link layer address successfully associates to the access point, <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> will configure the specified IP address and subnet on the wireless interface.</li>
<li class="list-enum" style="margin-top: 0.00em;">
The IAPP <span class="emph">ADD.notify</span> message is used to notify other access points running <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> to remove the station and any assigned IP addresses or subnets from the wireless interface.</li>
<li class="list-enum" style="margin-top: 0.00em;">
A dynamic routing daemon like <a class="link-man" href="../html8/ospfd.html">ospfd(8)</a> or <a class="link-man" href="../html8/bgpd.html">bgpd(8)</a> running on the access point will be used to announce the new IP route to the internal network and routers.</li>
</ol>
<div class="spacer">
</div>
For example:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# Assign IP addresses to layer 2 addresses 
table &lt;clients&gt; { 
	00:02:6f:42:d0:01 -&gt; 172.23.5.1/30, 
	00:05:4e:45:d3:b8 -&gt; 172.23.5.4/30, 
	00:04:2e:12:03:e0 -&gt; 172.23.5.8/30 
} 
 
# Global options 
set hostap interface ath0 
set hostap mode radiotap 
set iapp interface sis0 
set iapp address roaming table &lt;clients&gt; 
set iapp handle subtype address roaming 
set iapp mode multicast ttl 2</pre>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/hostapd.conf</i></dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Default location of the configuration file.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <a class="link-man" href="../html8/hostapd.html">hostapd(8)</a> program was written by <span class="author">Reyk Floeter</span> &lt;<a class="link-mail" href="mailto:reyk@openbsd.org">reyk@openbsd.org</a>&gt;.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> <span class="emph">IP Roaming</span> requires statically assigned IP addresses of stations and does not support DHCP at present.</div>
</div>
</body>
</html>

