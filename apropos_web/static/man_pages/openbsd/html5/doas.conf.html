<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
DOAS.CONF(5)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">doas.conf</b> &#8212; <span class="desc">doas configuration file</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 9.00ex;"/>
<col/>
<tbody>
<tr>
<td>
/etc/doas.conf</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <a class="link-man" href="../html1/doas.html">doas(1)</a> utility executes commands as other users according to the rules in the <b class="name">doas.conf</b> configuration file.<div class="spacer">
</div>
The rules have the following format:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<b class="cmd">permit</b>|<b class="cmd">deny</b> [<span class="opt"><i class="arg">options</i></span>] <i class="arg">identity</i> [<span class="opt"><b class="cmd">as</b> <i class="arg">target</i></span>] [<span class="opt"><b class="cmd">cmd</b> <i class="arg">command</i> [<span class="opt"><b class="cmd">args ...</b></span>]</span>]</div>
<div class="spacer">
</div>
Rules consist of the following parts:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">permit</b>|<b class="cmd">deny</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The action to be taken if this rule matches.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">options</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Options are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">nopass</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The user is not required to enter a password.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">keepenv</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The user's environment is maintained. The default is to reset the environment, except for the variables <span class="env">DISPLAY</span>, <span class="env">HOME</span>, <span class="env">LOGNAME</span>, <span class="env">MAIL</span>, <span class="env">PATH</span>, <span class="env">TERM</span>, <span class="env">USER</span> and <span class="env">USERNAME</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">keepenv {</b> [<span class="opt"><i class="arg">variable ...</i></span>] <b class="cmd">}</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
In addition to the variables mentioned above, keep the space-separated specified variables.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">identity</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The username to match. Groups may be specified by prepending a colon (&#8216;:&#8217;). Numeric IDs are also accepted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">as</b> <i class="arg">target</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The target user the running user is allowed to run the command as. The default is all users.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">cmd</b> <i class="arg">command</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The command the user is allowed or denied to run. The default is all commands. Be advised that it's best to specify absolute paths. If a cmd is specified, only a restricted <span class="env">PATH</span> will be searched.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">args ...</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Arguments to command. If specified, the command arguments provided by the user need to match for the command to be successful. Specifying <b class="cmd">args</b> alone means that command should be run without any arguments.</dd>
</dl>
<div class="spacer">
</div>
The last matching rule determines the action taken.<div class="spacer">
</div>
Comments can be put anywhere in the file using a hash mark (&#8216;#&#8217;), and extend to the end of the current line.<div class="spacer">
</div>
The following quoting rules apply:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-dash">
<li class="list-dash" style="margin-top: 1.00em;">
The text between a pair of double quotes (&#8216;&quot;&#8217;) is taken as is.</li>
<li class="list-dash" style="margin-top: 1.00em;">
The backslash character (&#8216;\&#8217;) escapes the next character, including new line characters, outside comments; as a result, comments may not be extended over multiple lines.</li>
<li class="list-dash" style="margin-top: 1.00em;">
If quotes or backslashes are used in a word, it isn't considered a keyword.</li>
</ul>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The following example permits users in group wsrc to build ports, wheel to execute commands as any user while keeping the environment variables <span class="env">ENV</span>, <span class="env">PS1</span>, and <span class="env">SSH_AUTH_SOCK</span>, permits tedu to run procmap as root without a password, and additionally permits root to run unrestricted commands as itself.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
# Non-exhaustive list of variables needed to 
# build release(8) and ports(7) 
permit nopass keepenv { \ 
        FTPMODE PKG_CACHE PKG_PATH SM_PATH SSH_AUTH_SOCK \ 
        DESTDIR DISTDIR FETCH_CMD FLAVOR GROUP MAKE MAKECONF \ 
        MULTI_PACKAGES NOMAN OKAY_FILES OWNER PKG_DBDIR \ 
        PKG_DESTDIR PKG_TMPDIR PORTSDIR RELEASEDIR SHARED_ONLY \ 
        SUBPACKAGE WRKOBJDIR SUDO_PORT_V1 } :wsrc 
permit nopass keepenv { ENV PS1 SSH_AUTH_SOCK } :wheel 
permit nopass tedu as root cmd /usr/sbin/procmap 
permit nopass keepenv root as root</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/doas.html">doas(1)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">doas.conf</b> configuration file first appeared in <span class="unix">OpenBSD&#160;5.8</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Ted Unangst</span> &lt;<a class="link-mail" href="mailto:tedu@openbsd.org">tedu@openbsd.org</a>&gt;</div>
</div>
</body>
</html>

