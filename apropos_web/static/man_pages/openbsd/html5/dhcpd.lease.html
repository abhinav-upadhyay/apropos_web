<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
DHCPD.LEASES(5)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">dhcpd.leases</b> &#8212; <span class="desc">DHCP server lease database</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The Internet Software Consortium DHCP Server keeps a persistent database of leases that it has assigned. This database is a free-form ASCII file containing a series of lease declarations. Every time a lease is acquired, renewed or released, its new value is recorded at the end of the lease file. So if more than one declaration appears for a given lease, the last one in the file is the current one.</div>
<div class="section">
<h1 id="x464f524d4154">FORMAT</h1> Lease descriptions are stored in a format that is parsed by the same recursive descent parser used to read the <a class="link-man" href="../html5/dhcpd.conf.html">dhcpd.conf(5)</a> and <a class="link-man" href="../html5/dhclient.conf.html">dhclient.conf(5)</a> files. Currently, the only declaration that is used in the <b class="name">dhcpd.leases</b> file is the <b class="cmd">lease</b> declaration.<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<b class="cmd">lease</b> <i class="arg">ip-address</i> <code class="none">{</code> <i class="arg">statements...</i> <code class="none">}</code></div>
</blockquote>
<div class="spacer">
</div>
Each lease declaration includes the single IP address that has been leased to the client. The statements within the braces define the duration of the lease and to whom it is assigned.<div class="spacer">
</div>
The start and end time of a lease are recorded using the <b class="cmd">starts</b> and <b class="cmd">ends</b> statements:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<b class="cmd">starts</b> <i class="arg">date</i>;</div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<b class="cmd">ends</b> <i class="arg">date</i>;</div>
</blockquote>
<div class="spacer">
</div>
Dates are specified as follows:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<i class="arg">weekday year</i>/<i class="arg">month</i>/<i class="arg">day hour</i>:<i class="arg">minute</i>:<i class="arg">second</i></div>
</blockquote>
<div class="spacer">
</div>
The weekday is present to make it easy for a human to tell when a lease expires - it's specified as a number from zero to six, with zero being Sunday. The day of week is ignored on input. The year is specified with the century, so it should generally be four digits except for really long leases. The month is specified as a number starting with 1 for January. The day of the month is likewise specified starting with 1. The hour is a number from 0 to 23, the minute a number from 0 to 59, and the second also a number from 0 to 59.<div class="spacer">
</div>
Lease times are specified in Coordinated Universal Time (UTC), not in the local time zone.<div class="spacer">
</div>
The MAC address of the network interface that was used to acquire the lease is recorded with the <b class="cmd">hardware</b> statement:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<b class="cmd">hardware</b> <i class="arg">hardware-type mac-address</i>;</div>
</blockquote>
<div class="spacer">
</div>
The MAC address is specified as a series of hexadecimal octets, separated by colons.<div class="spacer">
</div>
If the client uses a client identifier to acquire its address, the client identifier is recorded using the <b class="cmd">uid</b> statement:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<b class="cmd">uid</b> <i class="arg">client-identifier</i>;</div>
</blockquote>
<div class="spacer">
</div>
The client identifier is recorded as a series of hexadecimal octets, regardless of whether the client specifies an ASCII string or uses the newer hardware type/MAC address format.<div class="spacer">
</div>
If the client sends a hostname using the <b class="cmd">Client Hostname</b> option, as specified in some versions of the DHCP-DNS Interaction draft, that hostname is recorded using the <b class="cmd">client-hostname</b> statement.<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<b class="cmd">client-hostname</b> &#8220;<i class="arg">hostname</i>&#8221;;</div>
</blockquote>
<div class="spacer">
</div>
If the client sends its hostname using the <b class="cmd">Hostname</b> option, it is recorded using the <b class="cmd">hostname</b> statement.<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<b class="cmd">hostname</b> &#8220;<i class="arg">hostname</i>&#8221;;</div>
</blockquote>
<div class="spacer">
</div>
The DHCP server may determine that a lease has been misused in some way, either because a client that has been assigned a lease NAKs it, or because the server's own attempt to see if an address is in use prior to reusing it reveals that the address is in fact already in use. In that case, the <b class="cmd">abandoned</b> statement will be used to indicate that the lease should not be reassigned.<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<b class="cmd">abandoned</b>;</div>
</blockquote>
<div class="spacer">
</div>
Abandoned leases are reclaimed automatically. When a client asks for a new address, and the server finds that there are no new addresses, it checks to see if there are any abandoned leases, and allocates the least recently abandoned lease. The standard mechanisms for checking for lease address conflicts are still followed, so if the abandoned lease's IP address is still in use, it will be reabandoned.<div class="spacer">
</div>
If a client <span class="emph">requests</span> an abandoned address, the server assumes that the reason the address was abandoned was that the lease file was corrupted, and that the client is the machine that responded when the lease was probed, causing it to be abandoned. In that case, the address is immediately assigned to the client.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/db/dhcpd.leases</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html5/dhcp-options.html">dhcp-options(5)</a>, <a class="link-man" href="../html5/dhcpd.conf.html">dhcpd.conf(5)</a>, <a class="link-man" href="../html8/dhcpd.html">dhcpd(8)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> <span class="ref"><span class="ref-auth">R. Droms</span>, <span class="ref-title">Dynamic Host Configuration Protocol</span>, <span class="ref-rep">RFC 2131</span>, <span class="ref-date">March 1997</span>.</span><div class="spacer">
</div>
<span class="ref"><span class="ref-auth">S. Alexander</span> and <span class="ref-auth">R. Droms</span>, <span class="ref-title">DHCP Options and BOOTP Vendor Extensions</span>, <span class="ref-rep">RFC 2132</span>, <span class="ref-date">March 1997</span>.</span></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <a class="link-man" href="../html8/dhcpd.html">dhcpd(8)</a> was written by <span class="author">Ted Lemon</span> &lt;<a class="link-mail" href="mailto:mellon@vix.com">mellon@vix.com</a>&gt; under a contract with Vixie Labs.<div class="spacer">
</div>
The current implementation was reworked by <span class="author">Henning Brauer</span> &lt;<a class="link-mail" href="mailto:henning@openbsd.org">henning@openbsd.org</a>&gt;.</div>
</div>
</body>
</html>

