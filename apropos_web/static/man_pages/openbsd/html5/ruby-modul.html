<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
RUBY-MODULE(5)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">ruby-module</b> &#8212; <span class="desc">lang/ruby port module</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> This manual page documents the behavior of setting <code class="lit">MODULE=lang/ruby</code> in the <a class="link-man" href="../html7/ports.html">ports(7)</a> tree.<div class="spacer">
</div>
Sets <span class="env">MODRUBY_REV</span>, <span class="env">RUBY</span>, <span class="env">RAKE</span>, <span class="env">RSPEC</span>, <span class="env">MODRUBY_BIN_TESTRB</span>, <span class="env">MODRUBY_BIN_RSPEC</span>, <span class="env">MODRUBY_WANTLIB</span>, <span class="env">MODRUBY_RUN_DEPENDS</span>, <span class="env">MODRUBY_LIB_DEPENDS</span>, <span class="env">MODRUBY_BUILD_DEPENDS</span>, <span class="env">MODRUBY_RSPEC_DEPENDS</span>, <span class="env">MODRUBY_RSPEC3_DEPENDS</span>, <span class="env">MODRUBY_RUBY_ADJ</span>, <span class="env">MODRUBY_ADJ_FILES</span>, <span class="env">MODRUBY_LIBDIR</span>, <span class="env">MODRUBY_DOCDIR</span>, <span class="env">MODRUBY_SITEARCHDIR</span>, <span class="env">MODRUBY_SITEDIR</span>, <span class="env">MODRUBY_EXAMPLEDIR</span>, <span class="env">MODRUBY_ARCH</span>, <span class="env">MODRUBY_LIBREV</span>, <span class="env">MODRUBY_BINREV</span>, <span class="env">MODRUBY_HANDLE_FLAVORS</span>, <span class="env">MODRUBY_PKG_PREFIX</span>, <span class="env">MODRUBY_FLAVOR</span>, <span class="env">MODRUBY_TEST</span>, <span class="env">MODRUBY_TEST_TARGET</span>, <span class="env">MODRUBY_TEST_DIR</span>, <span class="env">MODRUBY_TEST_ENV</span>, <span class="env">MODRUBY_BUILD_TARGET</span>, <span class="env">MODRUBY_INSTALL_TARGET</span>, <span class="env">MODRUBY_EXTRACT_TARGET</span>, <span class="env">GEM</span>, <span class="env">GEM_BIN</span>, <span class="env">GEM_LIB</span>, <span class="env">GEM_BASE_LIB</span>, <span class="env">GEM_ABS_PATH</span>, <span class="env">GEM_BASE_BIN</span>, <span class="env">GEM_BIN_SUFFIX</span>, <span class="env">GEM_MAN_SUFFIX</span>, and <span class="env">GEM_FLAGS</span>.<div class="spacer">
</div>
Appends to <span class="env">CATEGORIES</span> and <span class="env">SUBST_VARS</span>. Appends to <span class="env">BUILD_DEPENDS</span> unless <span class="env">MODRUBY_BUILDDEP</span> is set to No or <span class="env">NO_BUILD</span> is set to Yes. Appends to <span class="env">RUN_DEPENDS</span> unless <span class="env">MODRUBY_RUNDEP</span> is set to No.<div class="spacer">
</div>
<span class="env">MODRUBY_RSPEC_DEPENDS</span> is set to the dependency line for the rspec 1 port for the version of ruby in use. <span class="env">MODRUBY_RSPEC3_DEPENDS</span> is set to the dependency line for the rspec 3 port for the version of ruby in use. <span class="env">RUBY</span>, <span class="env">RAKE</span>, and <span class="env">MODRUBY_BIN_TESTRB</span> are the path to the ruby, rake, and testrb binaries for the related ruby implementation. <span class="env">RSPEC</span> and <span class="env">MODRUBY_BIN_RSPEC</span> are the path to the spec (rspec 1) and rspec (rspec 2 and 3) binaries for the related ruby implementation.<div class="spacer">
</div>
<span class="env">MODRUBY_RUBY_ADJ</span> is a command that takes filename arguments and replaces the /usr/bin/env ruby shebang lines with <span class="env">RUBY</span>. <span class="env">MODRUBY_ADJ_FILES</span> is a list of filename patterns that will automatically have <span class="env">MODRUBY_RUBY_ADJ</span> called on them during pre-configure.<div class="spacer">
</div>
Creates a do-test target if <span class="env">MODRUBY_TEST</span> is used and one is not already defined. <span class="env">MODRUBY_TEST</span> can be set to ruby, rake, rspec, rspec3, or testrb to choose the appropriate binary to run the regress tests. <span class="env">MODRUBY_TEST_ENV</span> can be used to set environment variables for the regress tests. <span class="env">MODRUBY_TEST_DIR</span> can be used to set the directory in which to execute the regress tests, it defaults to <span class="env">WRKSRC</span>. <span class="env">MODRUBY_TEST_TARGET</span> sets the argument to the regress test program.<div class="spacer">
</div>
Supports additional <span class="env">CONFIGURE_STYLE</span>s, and setting specific <span class="env">CONFIGURE_STYLE</span>s modifies some additional parameters:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
The &quot;ruby gem&quot; <span class="env">CONFIGURE_STYLE</span> should be used for pure ruby gems without C extensions. This adds <span class="env">PKG_ARCH</span> = * and adds ruby18, ruby20, ruby21, ruby22, ruby23 and jruby <span class="env">FLAVOR</span>s to the port, so the same port can build packages for multiple versions of ruby.</li>
<li class="list-bul" style="margin-top: 1.00em;">
The &quot;ruby gem ext&quot; <span class="env">CONFIGURE_STYLE</span> should be used for ruby gems with C extensions. This adds <span class="env">MODRUBY_LIB_DEPENDS</span> to <span class="env">LIB_DEPENDS</span> and the appropriate libraries and <span class="env">MODRUBY_WANTLIB</span> to <span class="env">WANTLIB</span>. It also adds ruby18, ruby20, ruby21, ruby22, and ruby23 <span class="env">FLAVOR</span>s to the port. If the C extension in the gem requires specific arguments to extconf.rb, set those via <span class="env">CONFIGURE_ARGS</span>.</li>
<li class="list-bul" style="margin-top: 1.00em;">
The &quot;ruby extconf&quot; <span class="env">CONFIGURE_STYLE</span> is similar to the &quot;ruby gem ext&quot; <span class="env">CONFIGURE_STYLE</span>, except that it is used when the package is distributed with an extconf.rb file and not as a ruby gem.</li>
</ul>
<div class="spacer">
</div>
To ensure that dependencies use the same ruby implementation as the current port, all ruby gem/extconf dependencies specified in the port should use this format:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">category/ruby-foo,${MODRUBY_FLAVOR}</code></div>
</blockquote>
<div class="spacer">
</div>
Use of a ruby20, ruby21, ruby22, ruby23, or jruby <span class="env">FLAVOR</span> causes the <span class="env">FULLPKGNAME</span> to use the <span class="env">FLAVOR</span> instead of ruby as the package prefix. Specifying <span class="env">MODRUBY_FLAVOR</span> is necessary so that if a ruby x.y package is being built for the current port, it depends on the ruby x.y package of the dependencies.<div class="spacer">
</div>
The ports system defaults to using ruby 2.2 if the version of ruby is not specified. If you want to specify a version for a gem/extconf port, use a specific <span class="env">FLAVOR</span>, such as ruby18 to use ruby 1.8. If you want to specify a version for a non-gem/extconf port, set <span class="env">MODRUBY_REV</span> for the version of ruby you want to use (1.8, 2.0, 2.1, 2.2, jruby).<div class="spacer">
</div>
If you do not want the ports system to automatically set up <span class="env">FLAVOR</span>s when using a gem/extconf port, set <span class="env">MODRUBY_HANDLE_FLAVORS</span> to No. Similarly, if you want the ports system to automatically set up <span class="env">FLAVOR</span>s when using a non-gem/extconf port, set <span class="env">MODRUBY_HANDLE_FLAVORS</span> to Yes. When <span class="env">MODRUBY_HANDLE_FLAVORS</span> is Yes, the ports system automatically adds the appropriate prefix to the <span class="env">FULLPKGNAME</span> (e.g. ruby- for ruby 1.8, ruby22- for ruby 2.2). Additionally, it adds <span class="env">GEM_BIN_SUFFIX</span> and <span class="env">GEM_MAN_SUFFIX</span> to <span class="env">SUBST_VARS</span> so that the PLISTs will work on multiple ruby versions.<div class="spacer">
</div>
For ruby gem ports that can work on multiple ruby versions or implementations, any binary file entries in the PLIST should be appended with <span class="env">GEM_BIN_SUFFIX</span>. This is because the gem binaries for multiple ruby versions are all installed to <i class="file">${LOCALBASE}/bin</i>, and the binaries all use a version-specific suffix. Any man pages and other files that would be installed to locations not specific to a ruby implementation (such as under <i class="file">${LOCALBASE}/share</i>), should use <span class="env">GEM_MAN_SUFFIX</span> before the extension so the different <span class="env">FLAVOR</span>s do not conflict.<div class="spacer">
</div>
make update-plist may remove <span class="env">GEM_BIN_SUFFIX</span> and <span class="env">GEM_MAN_SUFFIX</span> from the PLIST, or use them in inappropriate places where they shouldn't be used, so be careful when updating gem ports with binaries or man pages. Additionally, for gem ports with C extensions, make update-plist will add back files used by the specific <span class="env">FLAVOR</span> you are using (such as files under the extension source directory), which may not exist for other <span class="env">FLAVOR</span>s, so always manually check the result of make update-plist and manually test that you can build the other <span class="env">FLAVOR</span>s before committing. Additionally, for gems with C extensions, make update-plist may add back the extension source files, which shouldn't be included in the files, so make sure to double check that all files added by make update-plist should be included in the package.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html5/port-modules.html">port-modules(5)</a></div>
</div>
</body>
</html>

