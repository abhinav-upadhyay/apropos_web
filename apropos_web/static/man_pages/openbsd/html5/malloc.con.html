<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
MALLOC.CONF(5)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">malloc.conf</b> &#8212; <span class="desc">options for the memory allocator</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> Upon the first call to the <a class="link-man" href="../html3/malloc.html">malloc(3)</a> family of functions, an initialization sequence inspects the symbolic link <i class="file">/etc/malloc.conf</i>, next checks the environment for a variable called <span class="env">MALLOC_OPTIONS</span>, and finally looks at the global variable <b class="var">malloc_options</b> in the program. Each is scanned for the following flags. Flags are single letters, uppercase means on, lowercase means off.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">C</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;Canaries&#8221;. Add canaries at the end of allocations in order to detect heap overflows. The canary's content is checked when <a class="link-man" href="../html3/free.html">free(3)</a> is called. If it has been corrupted, the process is aborted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">D</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;Dump&#8221;. <a class="link-man" href="../html3/malloc.html">malloc(3)</a> will dump statistics to the file <i class="file">./malloc.out</i>, if it already exists, at exit. This option requires the library to have been compiled with -DMALLOC_STATS in order to have any effect.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">F</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;Freeguard&#8221;. Enable use after free detection. Unused pages on the freelist are read and write protected to cause a segmentation fault upon access. This will also switch off the delayed freeing of chunks, reducing random behaviour but detecting double <a class="link-man" href="../html3/free.html">free(3)</a> calls as early as possible. This option is intended for debugging rather than improved security (use the <b class="flag">U</b> option for security).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">G</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;Guard&#8221;. Enable guard pages. Each page size or larger allocation is followed by a guard page that will cause a segmentation fault upon any access.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">H</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;Hint&#8221;. Pass a hint to the kernel about pages we don't use. If the machine is paging a lot this may help a bit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">J</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;Junk&#8221;. Fill some junk into the area allocated. Currently junk is bytes of 0xd0 when allocating; this is pronounced &#8220;Duh&#8221;. :-) Freed chunks are filled with 0xdf.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">j</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;Don't Junk&#8221;. By default, small chunks are always junked, and the first part of pages is junked after free. The reuse of freed memory is delayed. After the delay, the filling pattern is validated and the process is aborted if the pattern was modified. This option ensures that no junking is performed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">P</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;Move allocations within a page.&#8221; Allocations larger than half a page but smaller than a page are aligned to the end of a page to catch buffer overruns in more cases. This is the default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">R</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;realloc&#8221;. Always reallocate when <a class="link-man" href="../html3/realloc.html">realloc(3)</a> is called, even if the initial allocation was big enough. This can substantially aid in compacting memory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">S</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable all options suitable for security auditing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">U</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;Free unmap&#8221;. Enable use after free protection for larger allocations. Unused pages on the freelist are read and write protected to cause a segmentation fault upon access.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">X</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;xmalloc&#8221;. Rather than return failure, <a class="link-man" href="../html3/abort.html">abort(3)</a> the program with a diagnostic message on stderr. It is the intention that this option be set at compile time by including in the source:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
extern char *malloc_options; 
malloc_options = &quot;X&quot;;</pre>
<div class="spacer">
</div>
Note that this will cause code that is supposed to handle out-of-memory conditions gracefully to abort instead.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&lt;</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;Half the cache size&#8221;. Decrease the size of the free page cache by a factor of two.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&gt;</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
&#8220;Double the cache size&#8221;. Increase the size of the free page cache by a factor of two.</dd>
</dl>
<div class="spacer">
</div>
The flags are mostly for testing and debugging. If a program changes behavior if any of these options (except <b class="flag">X</b>) are used, it is buggy.<div class="spacer">
</div>
The default number of free pages cached is 64.</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">MALLOC_OPTIONS</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
string of option flags</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="file">/etc/malloc.conf</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
symbolic link to filename containing option flags</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Set a systemwide reduction of the cache to a quarter of the default size and use guard pages:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"># ln -s 'G&lt;&lt;' /etc/malloc.conf</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/malloc.html">malloc(3)</a></div>
</div>
</body>
</html>

