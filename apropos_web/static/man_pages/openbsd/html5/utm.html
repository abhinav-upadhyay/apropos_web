<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
UTMP(5)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">utmp</b>, <b class="name">wtmp</b>, <b class="name">lastlog</b> &#8212; <span class="desc">login records</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">utmp.h</a>&gt;</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="includes">&lt;<a class="link-includes">utmp.h</a>&gt;</b> file declares the structures used to record information about current users in the <b class="name">utmp</b> file, logins and logouts in the <b class="name">wtmp</b> file, and last logins in the <b class="name">lastlog</b> file. The timestamps of date changes, shutdowns, and reboots are also logged in the <b class="name">wtmp</b> file.<div class="spacer">
</div>
<b class="name">wtmp</b> can grow rapidly on busy systems, so daily or weekly rotation is recommended. If any one of these files does not exist, it is not created. They must be created manually and are maintained by <a class="link-man" href="../html8/newsyslog.html">newsyslog(8)</a>.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
#define _PATH_UTMP      &quot;/var/run/utmp&quot; 
#define _PATH_WTMP      &quot;/var/log/wtmp&quot; 
#define _PATH_LASTLOG   &quot;/var/log/lastlog&quot; 
 
#define UT_NAMESIZE     32 
#define UT_LINESIZE     8 
#define UT_HOSTSIZE     256 
 
struct lastlog { 
        time_t  ll_time; 
        char    ll_line[UT_LINESIZE]; 
        char    ll_host[UT_HOSTSIZE]; 
}; 
 
struct utmp { 
        char    ut_line[UT_LINESIZE]; 
        char    ut_name[UT_NAMESIZE]; 
        char    ut_host[UT_HOSTSIZE]; 
        time_t	ut_time; 
};</pre>
<div class="spacer">
</div>
Each time a user logs in, the <a class="link-man" href="../html1/login.html">login(1)</a> program looks up the user's UID in the <b class="name">lastlog</b> file. If it is found, the timestamp of the last time the user logged in, the terminal line, and the hostname are written to the standard output (provided the login is not &#8220;quiet&#8221;; see <a class="link-man" href="../html1/login.html">login(1)</a>). The <a class="link-man" href="../html1/login.html">login(1)</a> program then records the new login time in the <b class="name">lastlog</b> file.<div class="spacer">
</div>
After the new <i class="farg">lastlog</i> record is written, the <b class="name">utmp</b> file is opened and the <i class="farg">utmp</i> record for the user is inserted. This record remains until the user logs out at which time it is deleted. The <b class="name">utmp</b> file is used by the programs <a class="link-man" href="../html1/users.html">users(1)</a>, <a class="link-man" href="../html1/w.html">w(1)</a>, and <a class="link-man" href="../html1/who.html">who(1)</a>.<div class="spacer">
</div>
Next, the <a class="link-man" href="../html1/login.html">login(1)</a> program opens the <b class="name">wtmp</b> file and appends the user's <i class="farg">utmp</i> record. When the user logs out, a <i class="farg">utmp</i> record with the tty line, an updated timestamp, and zeroed name and host fields is appended to the file (see <a class="link-man" href="../html8/init.html">init(8)</a>). The <b class="name">wtmp</b> file is used by the programs <a class="link-man" href="../html1/last.html">last(1)</a> and <a class="link-man" href="../html8/ac.html">ac(8)</a>.<div class="spacer">
</div>
In the event of a date change, shutdown, or reboot, the following items are logged in the <b class="name">wtmp</b> file:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<code class="lit">reboot</code></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<code class="lit">shutdown</code></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
A system reboot or shutdown has been initiated. A tilde (&#8216;~&#8217;) character is placed in the field <i class="farg">ut_line</i>, and &#8220;reboot&#8221; or &#8220;shutdown&#8221; in the field <i class="farg">ut_name</i> (see <a class="link-man" href="../html8/shutdown.html">shutdown(8)</a> and <a class="link-man" href="../html8/reboot.html">reboot(8)</a>).<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<code class="lit">date</code></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The system time has been manually or automatically updated (see <a class="link-man" href="../html1/date.html">date(1)</a>). The command name <a class="link-man" href="../html1/date.html">date(1)</a> is recorded in the field <i class="farg">ut_name</i>. In the field <i class="farg">ut_line</i>, the &#8220;|&#8221; character indicates the time prior to the change and the &#8220;{&#8221; character indicates the new time.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/run/utmp</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/log/wtmp</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/log/lastlog</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/last.html">last(1)</a>, <a class="link-man" href="../html1/login.html">login(1)</a>, <a class="link-man" href="../html1/who.html">who(1)</a>, <a class="link-man" href="../html8/ac.html">ac(8)</a>, <a class="link-man" href="../html8/init.html">init(8)</a>, <a class="link-man" href="../html8/newsyslog.html">newsyslog(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> A <b class="name">utmp</b> and <b class="name">wtmp</b> file format appeared in Version&#160;3 AT&amp;T UNIX. The <b class="name">lastlog</b> file format appeared in <span class="unix">3.0BSD</span>.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> The strings in the <i class="farg">utmp</i> and <i class="farg">lastlog</i> structures are <span class="emph">not</span> normal &#8216;C&#8217; strings and are thus not guaranteed to be null terminated.</div>
</div>
</body>
</html>

