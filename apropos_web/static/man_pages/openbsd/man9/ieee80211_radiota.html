<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
IEEE80211_RADIOTAP(9)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">ieee80211_radiotap</b> &#8212; <span class="desc">software 802.11 stack packet capture definitions</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">net80211/ieee80211_var.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">net80211/ieee80211_ioctl.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">net80211/ieee80211_radiotap.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">net/bpf.h</a>&gt;</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">ieee80211_radiotap</b> definitions provide a device-independent <a class="link-man" href="../html4/bpf.html">bpf(4)</a> attachment for the capture of information about 802.11 traffic which is not part of the 802.11 frame structure.<div class="spacer">
</div>
Radiotap was designed to balance the desire for a capture format that conserved CPU and memory bandwidth on embedded systems, with the desire for a hardware-independent, extensible format that would support the diverse capabilities of virtually all 802.11 radios.<div class="spacer">
</div>
These considerations led radiotap to settle on a format consisting of a standard preamble followed by an extensible bitmap indicating the presence of optional capture fields.<div class="spacer">
</div>
The capture fields were packed into the header as compactly as possible, modulo the requirements that they had to be packed swiftly, with suitable alignment, in the same order as the bits indicating their presence.<div class="spacer">
</div>
This typically includes information such as signal quality and timestamps. This information may be used by a variety of user agents, including <a class="link-man" href="../html8/tcpdump.html">tcpdump(8)</a>. It is requested by using the <a class="link-man" href="../html4/bpf.html">bpf(4)</a> data-link type <span class="define">DLT_IEEE802_11_RADIO</span>.<div class="spacer">
</div>
Each frame using this attachment has the following header prepended to it:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct ieee80211_radiotap_header { 
	u_int8_t	it_version;	/* set to 0 */ 
	u_int8_t	it_pad; 
	u_int16_t	it_len;		/* entire length */ 
	u_int32_t	it_present;	/* fields present */ 
} __packed;</pre>
<div class="spacer">
</div>
A device driver implementing <span class="type">radiotap</span> typically defines a packed structure embedding an instance of <span class="type">struct ieee80211_radiotap_header</span> at the beginning, with subsequent fields in the appropriate order, and a macro to set the bits of the <b class="var">it_present</b> bitmap to indicate which fields exist and are filled in by the driver.<div class="spacer">
</div>
Radiotap headers are copied to userland via a separate bpf attachment. It is necessary for the driver to create this attachment after calling <a class="link-man" href="../html9/ieee80211_ifattach.html">ieee80211_ifattach(9)</a> by calling <b class="fname">bpfattach2</b>() with the data-link type set to <span class="define">DLT_IEEE802_11_RADIO</span>.<div class="spacer">
</div>
When the information is available, usually immediately before a link-layer transmission or after a receive, the driver copies it to the bpf layer using the <b class="fname">bpf_mtap2</b>() function.<div class="spacer">
</div>
The following extension fields are defined for <span class="type">radiotap</span>, in the order in which they should appear in the buffer copied to userland:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_TSFT</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains the unsigned 64-bit value, in microseconds, of the MAC's 802.11 Time Synchronization Function timer, when the first bit of the MPDU arrived at the MAC. This field should be present for received frames only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_FLAGS</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains a single unsigned 8-bit value, containing a bitmap of flags specifying properties of the frame being transmitted or received.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_RATE</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains a single unsigned 8-bit value, which is the data rate in use in units of 500Kbps.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_CHANNEL</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains two unsigned 16-bit values. The first value is the frequency upon which this PDU was transmitted or received. The second value is a bitmap containing flags which specify properties of the channel in use. These are documented within the header file <b class="includes">&lt;<a class="link-includes">net80211/ieee80211_radiotap.h</a>&gt;</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_FHSS</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains two 8-bit values. This field should be present for frequency-hopping radios only. The first byte is the hop set. The second byte is the pattern in use.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_DBM_ANTSIGNAL</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains a single signed 8-bit value, which indicates the RF signal power at the antenna, in decibels difference from 1mW.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_DBM_ANTNOISE</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains a single signed 8-bit value, which indicates the RF noise power at the antenna, in decibels difference from 1mW.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_LOCK_QUALITY</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains a single unsigned 16-bit value, indicating the quality of the Barker Code lock. No unit is specified for this field. There does not appear to be a standard way of measuring this at this time; this quantity is often referred to as &#8220;Signal Quality&#8221; in some datasheets.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_TX_ATTENUATION</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains a single unsigned 16-bit value, expressing transmit power as unitless distance from maximum power set at factory calibration. 0 indicates maximum transmit power. Monotonically nondecreasing with lower power levels.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_DB_TX_ATTENUATION</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains a single unsigned 16-bit value, expressing transmit power as decibel distance from maximum power set at factory calibration. 0 indicates maximum transmit power. Monotonically nondecreasing with lower power levels.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_DBM_TX_POWER</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Transmit power expressed as decibels from a 1mW reference. This field is a single signed 8-bit value. This is the absolute power level measured at the antenna port.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_ANTENNA</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
For radios which support antenna diversity, this field contains a single unsigned 8-bit value specifying which antenna is being used to transmit or receive this frame. The first antenna is antenna 0.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_DB_ANTSIGNAL</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains a single unsigned 8-bit value, which indicates the RF signal power at the antenna, in decibels difference from an arbitrary, fixed reference.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_DB_ANTNOISE</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains a single unsigned 8-bit value, which indicates the RF noise power at the antenna, in decibels difference from an arbitrary, fixed reference.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_HWQUEUE</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains a single unsigned 8-bit value specifying which hardware queue is being used to transmit the frame.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_RSSI</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This field contains two unsigned 8-bit values. The first value is the received signal strength index (RSSI) which indicates the RF signal power at the antenna. The second value is the relative maximum RSSI value of the RF interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IEEE80211_RADIOTAP_EXT</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This bit is reserved for any future extensions to the <span class="type">radiotap</span> structure. A driver can set <span class="define">IEEE80211_RADIOTAP_EXT</span> to extend the it_present bitmap by another 64 bits. The bitmap can be extended by multiples of 32 bits to 96, 128, 160 bits, or longer, by setting <span class="define">IEEE80211_RADIOTAP_EXT</span> in the extensions. The bitmap ends at the first extension field where <span class="define">IEEE80211_RADIOTAP_EXT</span> is not set.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Radiotap header for the Realtek RTL8180L driver <a class="link-man" href="../html4/rtw.html">rtw(4)</a>:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
struct rtw_rx_radiotap_header { 
	struct ieee80211_radiotap_header	rr_ihdr; 
	u_int64_t				rr_tsft; 
	u_int8_t				rr_flags; 
	u_int8_t				rr_rate; 
	u_int16_t				rr_chan_freq; 
	u_int16_t				rr_chan_flags; 
	u_int16_t				rr_barker_lock; 
	u_int8_t				rr_antsignal; 
} __packed;</pre>
<div class="spacer">
</div>
Bitmap indicating which fields are present in the above structure:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
#define RTW_RX_RADIOTAP_PRESENT					\ 
	((1 &lt;&lt; IEEE80211_RADIOTAP_TSFT)			|	\ 
	 (1 &lt;&lt; IEEE80211_RADIOTAP_FLAGS)		|	\ 
	 (1 &lt;&lt; IEEE80211_RADIOTAP_RATE)			|	\ 
	 (1 &lt;&lt; IEEE80211_RADIOTAP_CHANNEL)		|	\ 
	 (1 &lt;&lt; IEEE80211_RADIOTAP_LOCK_QUALITY)		|	\ 
	 (1 &lt;&lt; IEEE80211_RADIOTAP_DB_ANTSIGNAL)		|	\ 
	 0)</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/bpf.html">bpf(4)</a>, <a class="link-man" href="../html9/ieee80211.html">ieee80211(9)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">ieee80211_radiotap</b> definitions first appeared in <span class="unix">NetBSD&#160;1.5</span>, and were later ported to <span class="unix">FreeBSD&#160;4.6</span> and <span class="unix">OpenBSD&#160;3.6</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="name">ieee80211_radiotap</b> interface was designed and implemented by <span class="author">David Young</span> &lt;<a class="link-mail" href="mailto:dyoung@pobox.com">dyoung@pobox.com</a>&gt;.<div class="spacer">
</div>
This manual page was written by <span class="author">Bruce M. Simpson</span> &lt;<a class="link-mail" href="mailto:bms@FreeBSD.org">bms@FreeBSD.org</a>&gt; and <span class="author">Darron Broad</span> &lt;<a class="link-mail" href="mailto:darron@kewl.org">darron@kewl.org</a>&gt;.</div>
</div>
</body>
</html>

