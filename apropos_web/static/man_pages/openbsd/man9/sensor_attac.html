<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
SENSOR_ATTACH(9)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">sensor_attach</b>, <b class="name">sensor_detach</b>, <b class="name">sensor_find</b>, <b class="name">sensordev_install</b>, <b class="name">sensordev_deinstall</b>, <b class="name">sensordev_get</b>, <b class="name">sensor_task_register</b>, <b class="name">sensor_task_unregister</b> &#8212; <span class="desc">sensors framework</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/sensors.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">sensordev_install</b>(<i class="farg" style="white-space:nowrap;">struct ksensordev *sensdev</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">sensordev_deinstall</b>(<i class="farg" style="white-space:nowrap;">struct ksensordev *sensdev</i>);<div class="spacer">
</div>
<i class="ftype">struct ksensordev *</i><br/>
<b class="fname">sensordev_get</b>(<i class="farg" style="white-space:nowrap;">int devnum</i>);<div class="spacer">
</div>
<br/>
<i class="ftype">void</i><br/>
<b class="fname">sensor_attach</b>(<i class="farg" style="white-space:nowrap;">struct ksensordev *sensdev</i>, <i class="farg" style="white-space:nowrap;">struct ksensor *sens</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">sensor_detach</b>(<i class="farg" style="white-space:nowrap;">struct ksensordev *sensdev</i>, <i class="farg" style="white-space:nowrap;">struct ksensor *sens</i>);<div class="spacer">
</div>
<i class="ftype">struct ksensor *</i><br/>
<b class="fname">sensor_find</b>(<i class="farg" style="white-space:nowrap;">int devnum</i>, <i class="farg" style="white-space:nowrap;">enum sensor_type stype</i>, <i class="farg" style="white-space:nowrap;">int numt</i>);<div class="spacer">
</div>
<br/>
<i class="ftype">struct sensor_task *</i><br/>
<b class="fname">sensor_task_register</b>(<i class="farg" style="white-space:nowrap;">void *arg</i>, <i class="farg" style="white-space:nowrap;">void (*func)(void *)</i>, <i class="farg" style="white-space:nowrap;">int period</i>);<div class="spacer">
</div>
<i class="ftype">void</i><br/>
<b class="fname">sensor_task_unregister</b>(<i class="farg" style="white-space:nowrap;">struct sensor_task *st</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The sensors framework API provides a mechanism for manipulation of hardware sensors that are available under the <b class="var">hw.sensors</b> <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a> tree.<div class="spacer">
</div>
<b class="fname">sensor_attach</b>() adds the sensor specified by the <i class="farg">sens</i> argument to the sensor device specified by the <i class="farg">sensdev</i> argument. <b class="fname">sensor_detach</b>() can be used to remove sensors previously added by <b class="fname">sensor_attach</b>().<div class="spacer">
</div>
<b class="fname">sensordev_install</b>() registers the sensor device specified by the <i class="farg">sensdev</i> argument so that all sensors that are attached to the device become accessible via the sysctl interface. <b class="fname">sensordev_deinstall</b>() can be used to remove sensor devices previously registered by <b class="fname">sensordev_install</b>().<div class="spacer">
</div>
<b class="fname">sensordev_get</b>() takes ordinal number <i class="farg">devnum</i> specifying a sensor device and returns a pointer to the corresponding <span class="type">struct ksensordev</span>, or <span class="define">NULL</span> if no such sensor device exists.<div class="spacer">
</div>
<b class="fname">sensor_find</b>() takes ordinal number <i class="farg">devnum</i> specifying a sensor device, sensor type <i class="farg">stype</i> and ordinal number of sensor of such type <i class="farg">numt</i>, and returns a pointer to the corresponding <span class="type">struct ksensor</span>, or <span class="define">NULL</span> if no such sensor exists. <b class="fname">sensor_find</b>() will always return <span class="define">NULL</span> if the corresponding sensor devices are not registered by <b class="fname">sensordev_install</b>().<div class="spacer">
</div>
Drivers are responsible for retrieving, interpreting, and normalising sensor values and updating the sensor struct periodically. If the driver needs process context, for example to sleep, it can register a task with the sensor framework.<div class="spacer">
</div>
<b class="fname">sensor_task_register</b>() is used to register a periodic task to update sensors. The <i class="farg">func</i> argument is a pointer to the function to run with an interval of <i class="farg">period</i> seconds. The <i class="farg">arg</i> parameter is the argument given to the <i class="farg">func</i> function. <b class="fname">sensor_task_unregister</b>() ensures that the task specified by the <i class="farg">st</i> argument is no longer running, and then removes it from the queue.<div class="spacer">
</div>
All the functions in the sensor framework must be called during <a class="link-man" href="../html9/autoconf.html">autoconf(9)</a> or from a process context. Additionally, <b class="fname">sensor_task_unregister</b>() must not be called from the sensor task that it is about to remove.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a>, <a class="link-man" href="../html9/autoconf.html">autoconf(9)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The sensor framework was written by <span class="author">Alexander Yurchenko</span> &lt;<a class="link-mail" href="mailto:grange@openbsd.org">grange@openbsd.org</a>&gt; and first appeared in <span class="unix">OpenBSD&#160;3.4</span>. <span class="author">David Gwynne</span> &lt;<a class="link-mail" href="mailto:dlg@openbsd.org">dlg@openbsd.org</a>&gt; later extended it for <span class="unix">OpenBSD&#160;3.8</span>. <span class="author">Constantine A. Murenin</span> &lt;<a class="link-mail" href="mailto:cnst+openbsd@bugmail.mojo.ru">cnst+openbsd@bugmail.mojo.ru</a>&gt; extended it even further by introducing the concept of sensor devices in <span class="unix">OpenBSD&#160;4.1</span>.</div>
</div>
</body>
</html>

