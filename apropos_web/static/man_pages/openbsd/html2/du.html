<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
DUP(2)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">dup</b>, <b class="name">dup2</b>, <b class="name">dup3</b> &#8212; <span class="desc">duplicate an existing file descriptor</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">unistd.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">dup</b>(<i class="farg" style="white-space:nowrap;">int oldd</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">dup2</b>(<i class="farg" style="white-space:nowrap;">int oldd</i>, <i class="farg" style="white-space:nowrap;">int newd</i>);<div class="spacer">
</div>
<b class="includes">#include &lt;<a class="link-includes">fcntl.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">unistd.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">dup3</b>(<i class="farg" style="white-space:nowrap;">int oldd</i>, <i class="farg" style="white-space:nowrap;">int newd</i>, <i class="farg" style="white-space:nowrap;">int flags</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">dup</b>() duplicates an existing object descriptor and returns its value to the calling process (<i class="farg">newd</i> = <b class="fname">dup</b>(<i class="farg">oldd</i>)). The argument <i class="farg">oldd</i> is a small non-negative integer index in the per-process descriptor table. The value must be less than the size of the table, which is returned by <a class="link-man" href="../html3/getdtablesize.html">getdtablesize(3)</a>. The new descriptor returned by the call is the lowest numbered descriptor currently not in use by the process.<div class="spacer">
</div>
The object referenced by the descriptor does not distinguish between <i class="farg">oldd</i> and <i class="farg">newd</i> in any way. Thus if <i class="farg">newd</i> and <i class="farg">oldd</i> are duplicate references to an open file, <a class="link-man" href="../html2/read.html">read(2)</a>, <a class="link-man" href="../html2/write.html">write(2)</a> and <a class="link-man" href="../html2/lseek.html">lseek(2)</a> calls all move a single pointer into the file, and append mode, non-blocking I/O and asynchronous I/O options are shared between the references. If a separate pointer into the file is desired, a different object reference to the file must be obtained by issuing an additional <a class="link-man" href="../html2/open.html">open(2)</a> call. The close-on-exec flag on the new file descriptor is unset.<div class="spacer">
</div>
In <b class="fname">dup2</b>(), the value of the new descriptor <i class="farg">newd</i> is specified. If this descriptor is already in use, it is first deallocated as if a <a class="link-man" href="../html2/close.html">close(2)</a> call had been done first. When <i class="farg">newd</i> equals <i class="farg">oldd</i>, <b class="fname">dup2</b>() just returns without affecting the close-on-exec flag.<div class="spacer">
</div>
In <b class="fname">dup3</b>(), both the value of the new descriptor and the close-on-exec flag on the new file descriptor are specified: <i class="farg">newd</i> specifies the value and the <span class="define">O_CLOEXEC</span> bit in <i class="farg">flags</i> specifies the close-on-exec flag. Unlike <b class="fname">dup2</b>(), if <i class="farg">oldd</i> and <i class="farg">newd</i> are equal then <b class="fname">dup3</b>() fails. Otherwise, if <i class="farg">flags</i> is zero then <b class="fname">dup3</b>() is identical to a call to <b class="fname">dup2</b>().</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, the value of the new descriptor is returned. The value -1 is returned if an error occurs in either call. The external variable <b class="var">errno</b> indicates the cause of the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">dup</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">oldd</i> is not a valid active descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EMFILE</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many descriptors are active.</dd>
</dl>
<div class="spacer">
</div>
<b class="fname">dup2</b>() and <b class="fname">dup3</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">oldd</i> is not a valid active descriptor or <i class="farg">newd</i> is negative or greater than or equal to the process's <span class="define">RLIMIT_NOFILE</span> limit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINTR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An interrupt was received.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while writing to the file system.</dd>
</dl>
<div class="spacer">
</div>
In addition, <b class="fname">dup3</b>() will return the following error:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">oldd</i> is equal to <i class="farg">newd</i> or <i class="farg">flags</i> is invalid.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/accept.html">accept(2)</a>, <a class="link-man" href="../html2/close.html">close(2)</a>, <a class="link-man" href="../html2/fcntl.html">fcntl(2)</a>, <a class="link-man" href="../html2/getrlimit.html">getrlimit(2)</a>, <a class="link-man" href="../html2/open.html">open(2)</a>, <a class="link-man" href="../html2/pipe.html">pipe(2)</a>, <a class="link-man" href="../html2/socket.html">socket(2)</a>, <a class="link-man" href="../html2/socketpair.html">socketpair(2)</a>, <a class="link-man" href="../html3/getdtablesize.html">getdtablesize(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> <b class="fname">dup</b>() and <b class="fname">dup2</b>() conform to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;). The <b class="fname">dup3</b>() function is expected to conform to a future revision of that standard.</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">dup</b>() system call first appeared in Version&#160;3 AT&amp;T UNIX, <b class="fname">dup2</b>() in Version&#160;7 AT&amp;T UNIX, and <b class="fname">dup3</b>() in <span class="unix">OpenBSD&#160;5.7</span>.</div>
</div>
</body>
</html>

