<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
CHROOT(2)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">chroot</b> &#8212; <span class="desc">change root directory</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">unistd.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">chroot</b>(<i class="farg" style="white-space:nowrap;">const char *dirname</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <i class="farg">dirname</i> is the address of the pathname of a directory, terminated by an ASCII NUL. <b class="fname">chroot</b>() causes <i class="farg">dirname</i> to become the root directory, that is, the starting point for path searches of pathnames beginning with &#8216;<code class="lit">/</code>&#8217;.<div class="spacer">
</div>
In order for a directory to become the root directory a process must have execute (search) access for that directory.<div class="spacer">
</div>
If the program is not currently running with an altered root directory, it should be noted that <b class="fname">chroot</b>() has no effect on the process's current directory.<div class="spacer">
</div>
If the program is already running with an altered root directory, the process's current directory is changed to the same new root directory. This prevents the current directory from being further up the directory tree than the altered root directory.<div class="spacer">
</div>
This call is restricted to the superuser.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, the value&#160;0 is returned; otherwise the value&#160;-1 is returned and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The following example changes the root directory to <b class="var">newroot</b>, sets the current directory to the new root, and drops some setuid privileges. There may be other privileges which need to be dropped as well.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
#include &lt;err.h&gt; 
#include &lt;unistd.h&gt; 
 
if (chroot(newroot) != 0 || chdir(&quot;/&quot;) != 0) 
	err(1, &quot;%s&quot;, newroot); 
setresuid(getuid(), getuid(), getuid());</pre>
</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">chroot</b>() will fail and the root directory will be unchanged if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of the path name is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENAMETOOLONG</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded <span class="define">NAME_MAX</span> characters, or an entire pathname (including the terminating NUL) exceeded <span class="define">PATH_MAX</span> bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOENT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named directory does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Search permission is denied for any component of the path name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ELOOP</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating the pathname.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">dirname</i> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading from or writing to the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EPERM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The caller is not the superuser.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/chdir.html">chdir(2)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">chroot</b>() system call first appeared in Version&#160;7 AT&amp;T UNIX.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> There are ways for a root process to escape from the chroot jail. Changes to the directory hierarchy made from outside the chroot jail may allow a restricted process to escape, even if it is unprivileged. Passing directory file descriptors via <a class="link-man" href="../html2/recvmsg.html">recvmsg(2)</a> from outside the chroot jail may also allow a process to escape.</div>
</div>
</body>
</html>

