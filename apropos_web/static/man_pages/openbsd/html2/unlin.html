<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
UNLINK(2)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">unlink</b>, <b class="name">unlinkat</b> &#8212; <span class="desc">remove directory entry</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">unistd.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">unlink</b>(<i class="farg" style="white-space:nowrap;">const char *path</i>);<div class="spacer">
</div>
<b class="includes">#include &lt;<a class="link-includes">fcntl.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">unistd.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">unlinkat</b>(<i class="farg" style="white-space:nowrap;">int fd</i>, <i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">int flag</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">unlink</b>() function removes the link named by <i class="farg">path</i> from its directory and decrements the link count of the file which was referenced by the link. If that decrement reduces the link count of the file to zero, and no process has the file open, then all resources associated with the file are reclaimed. If one or more processes have the file open when the last link is removed, the link is removed, but the removal of the file is delayed until all references to it have been closed.<div class="spacer">
</div>
The <b class="fname">unlinkat</b>() function is equivalent to either the <b class="fname">unlink</b>() or <a class="link-man" href="../html2/rmdir.html">rmdir(2)</a> function depending on the value of <i class="farg">flag</i> (see below), except that where <i class="farg">path</i> specifies a relative path, the directory entry to be removed is determined relative to the directory associated with file descriptor <i class="farg">fd</i> instead of the current working directory.<div class="spacer">
</div>
If <b class="fname">unlinkat</b>() is passed the special value <span class="define">AT_FDCWD</span> (defined in <b class="includes">&lt;<a class="link-includes">fcntl.h</a>&gt;</b>) in the <i class="farg">fd</i> parameter, the current working directory is used and the behavior is identical to a call to <b class="fname">unlink</b>() or <a class="link-man" href="../html2/rmdir.html">rmdir(2)</a>, depending on whether or not the <span class="define">AT_REMOVEDIR</span> bit is set in <i class="farg">flag</i>.<div class="spacer">
</div>
The <i class="farg">flag</i> argument is the bitwise OR of zero or more of the following values:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">AT_REMOVEDIR</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Remove the directory entry specified by <i class="farg">path</i> as a directory, not a normal file.</dd>
</dl>
</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, the value&#160;0 is returned; otherwise the value&#160;-1 is returned and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> The <b class="fname">unlink</b>() and <b class="fname">unlinkat</b>() functions will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of the path prefix is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENAMETOOLONG</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded <span class="define">NAME_MAX</span> characters, or an entire pathname (including the terminating NUL) exceeded <span class="define">PATH_MAX</span> bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOENT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Search permission is denied for a component of the path prefix.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Write permission is denied on the directory containing the link to be removed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ELOOP</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating the pathname.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EPERM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file is a directory and the effective user ID of the process is not the superuser, or the file system containing the file does not permit the use of <b class="fname">unlink</b>() on a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EPERM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The directory containing the file is marked sticky, and neither the containing directory nor the file to be removed are owned by the effective user ID.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EPERM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file or the directory containing it has its immutable or append-only flag set (see <a class="link-man" href="../html2/chflags.html">chflags(2)</a>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBUSY</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The entry to be unlinked is the mount point for a mounted file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while deleting the directory entry or deallocating the inode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EROFS</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file resides on a read-only file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">path</i> points outside the process's allocated address space.</dd>
</dl>
<div class="spacer">
</div>
Additionally, <b class="fname">unlinkat</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <span class="define">AT_REMOVEDIR</span> flag bit is set and <i class="farg">path</i> does not name a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTEMPTY</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <span class="define">AT_REMOVEDIR</span> flag bit is set and the named directory contains files other than &#8216;<code class="lit">.</code>&#8217; and &#8216;<code class="lit">..</code>&#8217; in it.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The value of the <i class="farg">flag</i> argument was neither zero nor <span class="define">AT_REMOVEDIR</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The value of the <i class="farg">flag</i> argument was <span class="define">AT_REMOVEDIR</span> and the last element of <i class="arg">path</i> consists of &#8216;<code class="lit">.</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument specifies a relative path and the <i class="farg">fd</i> argument is neither <span class="define">AT_FDCWD</span> nor a valid file descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument specifies a relative path and the <i class="farg">fd</i> argument is a valid file descriptor but it does not reference a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument specifies a relative path but search permission is denied for the directory which the <i class="farg">fd</i> file descriptor references.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/rm.html">rm(1)</a>, <a class="link-man" href="../html2/chflags.html">chflags(2)</a>, <a class="link-man" href="../html2/close.html">close(2)</a>, <a class="link-man" href="../html2/link.html">link(2)</a>, <a class="link-man" href="../html2/rmdir.html">rmdir(2)</a>, <a class="link-man" href="../html7/symlink.html">symlink(7)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">unlink</b>() and <b class="fname">unlinkat</b>() functions conform to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">unlink</b>() system call first appeared in Version&#160;1 AT&amp;T UNIX. The <b class="fname">unlinkat</b>() function appeared in <span class="unix">OpenBSD&#160;5.0</span>.</div>
</div>
</body>
</html>

