<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
NFSSVC(2)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">nfssvc</b> &#8212; <span class="desc">NFS services</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">unistd.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">nfs/nfs.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">nfssvc</b>(<i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">void *argstructp</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">nfssvc</b>() function is used by NFS daemons to pass information into the kernel and also to enter the kernel as a server daemon. The <i class="farg">flags</i> argument consists of several bits that show what action is to be taken once in the kernel and the <i class="farg">argstructp</i> points to one of two structures depending on which bits are set in flags.<div class="spacer">
</div>
To enter an <a class="link-man" href="../html8/nfsd.html">nfsd(8)</a> daemon into the kernel, <b class="fname">nfssvc</b>() is called with the flag <span class="define">NFSSVC_NFSD</span> and a pointer to a structure:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
struct nfsd_srvargs { 
        struct nfsd     *nsd_nfsd;   /* Pointer to in kernel nfsd struct */ 
        uid_t           nsd_uid;        /* Effective uid mapped to cred */ 
        u_int32_t       nsd_haddr;      /* IP address of client */ 
        struct xucred   nsd_cr;         /* Cred. uid maps to */ 
        int             nsd_authlen;    /* Length of auth string (ret) */ 
        u_char          *nsd_authstr;   /* Auth string (ret) */ 
        int             nsd_verflen;    /* and the verifier */ 
        u_char          *nsd_verfstr; 
        struct timeval  nsd_timestamp;  /* timestamp from verifier */ 
        u_int32_t       nsd_ttl;        /* credential ttl (sec) */ 
};</pre>
<div class="spacer">
</div>
To add further sockets for processing by the <a class="link-man" href="../html8/nfsd.html">nfsd(8)</a> server daemons the master <a class="link-man" href="../html8/nfsd.html">nfsd(8)</a> daemon  calls <b class="fname">nfssvc</b>() with the flag <span class="define">NFSSVC_ADDSOCK</span> and a pointer to a structure:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
struct nfsd_args { 
        int     sock;     /* Socket to serve */ 
        caddr_t name;     /* Client address for connection based sockets */ 
        int     namelen;  /* Length of name */ 
};</pre>
</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Normally <b class="fname">nfssvc</b>() does not return unless the server is terminated by a signal when a value of 0 is returned. Otherwise, -1 is returned and the global variable <b class="var">errno</b> is set to specify the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EPERM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The caller is not the superuser.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The flag argument consisted of incompatible or otherwise unsupported bits.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html8/mount_nfs.html">mount_nfs(8)</a>, <a class="link-man" href="../html8/nfsd.html">nfsd(8)</a>, <a class="link-man" href="../html8/sysctl.html">sysctl(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">nfssvc</b>() function first appeared in <span class="unix">4.4BSD</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The <b class="fname">nfssvc</b>() system call is designed specifically for the NFS support daemons and as such is specific to their requirements. Several fields of the argument structures are assumed to be valid and sometimes to be unchanged from a previous call, such that <b class="fname">nfssvc</b>() must be used with extreme care.</div>
</div>
</body>
</html>

