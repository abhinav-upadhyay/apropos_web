<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
OPEN(2)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">open</b>, <b class="name">openat</b> &#8212; <span class="desc">open or create a file for reading or writing</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">fcntl.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">open</b>(<i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">...</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">openat</b>(<i class="farg" style="white-space:nowrap;">int fd</i>, <i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">...</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The file name specified by <i class="farg">path</i> is opened for reading and/or writing as specified by the argument <i class="farg">flags</i> and the file descriptor returned to the calling process. The <i class="farg">flags</i> argument may indicate the file is to be created if it does not exist (by specifying the <span class="define">O_CREAT</span> flag), in which case the file is created with a mode specified by an additional argument of type <span class="type">mode_t</span> as described in <a class="link-man" href="../html2/chmod.html">chmod(2)</a> and modified by the process' umask value (see <a class="link-man" href="../html2/umask.html">umask(2)</a>).<div class="spacer">
</div>
The <i class="farg">flags</i> specified are a bitwise OR of the following values. Exactly one of the first three values (file access modes) must be specified:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_RDONLY</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Open for reading only.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_WRONLY</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Open for writing only.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_RDWR</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Open for reading and writing.</dd>
</dl>
<div class="spacer">
</div>
Any combination of the following flags may additionally be used:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_NONBLOCK</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Do not block on open or for data to become available.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_APPEND</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Append on each write.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_CREAT</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Create file if it does not exist. An additional argument of type <span class="type">mode_t</span> must be supplied to the call.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_TRUNC</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Truncate size to 0.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_EXCL</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Error if <span class="define">O_CREAT</span> is set and file exists.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_SYNC</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Perform synchronous I/O operations.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_SHLOCK</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Atomically obtain a shared lock.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_EXLOCK</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Atomically obtain an exclusive lock.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_NOFOLLOW</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
If last path element is a symlink, don't follow it.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_CLOEXEC</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Set <span class="define">FD_CLOEXEC</span> (the close-on-exec flag) on the new file descriptor.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">O_DIRECTORY</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Error if <i class="farg">path</i> does not name a directory.</dd>
</dl>
<div class="spacer">
</div>
Opening a file with <span class="define">O_APPEND</span> set causes each write on the file to be appended to the end. If <span class="define">O_TRUNC</span> and a writing mode are specified and the file exists, the file is truncated to zero length. If <span class="define">O_EXCL</span> is set with <span class="define">O_CREAT</span> and the file already exists, <b class="fname">open</b>() returns an error. This may be used to implement a simple exclusive access locking mechanism. If either of <span class="define">O_EXCL</span> or <span class="define">O_NOFOLLOW</span> are set and the last component of the pathname is a symbolic link, <b class="fname">open</b>() will fail even if the symbolic link points to a non-existent name. If the <span class="define">O_NONBLOCK</span> flag is specified, do not wait for the device or file to be ready or available. If the <b class="fname">open</b>() call would result in the process being blocked for some reason (e.g., waiting for carrier on a dialup line), <b class="fname">open</b>() returns immediately. This flag also has the effect of making all subsequent I/O on the open file non-blocking. If the <span class="define">O_SYNC</span> flag is set, all I/O operations on the file will be done synchronously.<div class="spacer">
</div>
A FIFO should either be opened with <span class="define">O_RDONLY</span> or with <span class="define">O_WRONLY</span>. The behavior for opening a FIFO with <span class="define">O_RDWR</span> is undefined.<div class="spacer">
</div>
When opening a file, a lock with <a class="link-man" href="../html2/flock.html">flock(2)</a> semantics can be obtained by setting <span class="define">O_SHLOCK</span> for a shared lock, or <span class="define">O_EXLOCK</span> for an exclusive lock. If creating a file with <span class="define">O_CREAT</span>, the request for the lock will never fail (provided that the underlying filesystem supports locking).<div class="spacer">
</div>
If <b class="fname">open</b>() is successful, the file pointer used to mark the current position within the file is set to the beginning of the file.<div class="spacer">
</div>
When a new file is created it is given the group of the directory which contains it.<div class="spacer">
</div>
The new descriptor is set to remain open across <a class="link-man" href="../html2/execve.html">execve(2)</a> system calls; see <a class="link-man" href="../html2/close.html">close(2)</a> and <a class="link-man" href="../html2/fcntl.html">fcntl(2)</a>.<div class="spacer">
</div>
The system imposes a limit on the number of file descriptors open simultaneously by one process. <a class="link-man" href="../html3/getdtablesize.html">getdtablesize(3)</a> returns the current system limit.<div class="spacer">
</div>
The <b class="fname">openat</b>() function is equivalent to <b class="fname">open</b>() except that where <i class="farg">path</i> specifies a relative path, the file to be opened is determined relative to the directory associated with file descriptor <i class="farg">fd</i> instead of the current working directory.<div class="spacer">
</div>
If <b class="fname">openat</b>() is passed the special value <span class="define">AT_FDCWD</span> (defined in <b class="includes">&lt;<a class="link-includes">fcntl.h</a>&gt;</b>) in the <i class="farg">fd</i> parameter, the current working directory is used and the behavior is identical to a call to <b class="fname">open</b>().</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> If successful, <b class="fname">open</b>() returns a non-negative integer, termed a file descriptor. Otherwise, a value of -1 is returned and <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> The <b class="fname">open</b>() and <b class="fname">openat</b>() functions will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of the path prefix is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_DIRECTORY</span> is specified and <i class="farg">path</i> does not name a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENAMETOOLONG</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded <span class="define">NAME_MAX</span> characters, or an entire pathname (including the terminating NUL) exceeded <span class="define">PATH_MAX</span> bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOENT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> is not set and the named file does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOENT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of the path name that must exist does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Search permission is denied for a component of the path prefix.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The required permissions (for reading and/or writing) are denied for the given <i class="farg">flags</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> is specified, the file does not exist, and the directory in which it is to be created does not permit writing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ELOOP</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating the pathname, or the <span class="define">O_NOFOLLOW</span> flag was specified and the target is a symbolic link.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EISDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file is a directory, and the arguments specify it is to be opened for writing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">flags</i> specified for opening the file are not valid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EROFS</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file resides on a read-only file system, and the file is to be modified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EMFILE</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The process has already reached its limit for open file descriptors.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENFILE</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The system file table is full.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENXIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file is a character special or block special file, and the device associated with this special file does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENXIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file is a FIFO, the <span class="define">O_NONBLOCK</span> and <span class="define">O_WRONLY</span> flags are set, and no process has the file open for reading.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINTR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <b class="fname">open</b>() operation was interrupted by a signal.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EOPNOTSUPP</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_SHLOCK</span> or <span class="define">O_EXLOCK</span> is specified but the underlying filesystem does not support locking.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EWOULDBLOCK</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_NONBLOCK</span> and one of <span class="define">O_SHLOCK</span> or <span class="define">O_EXLOCK</span> is specified and the file is already locked.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOSPC</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> is specified, the file does not exist, and the directory in which the entry for the new file is being placed cannot be extended because there is no space left on the file system containing the directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOSPC</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> is specified, the file does not exist, and there are no free inodes on the file system on which the file is being created.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EDQUOT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> is specified, the file does not exist, and the directory in which the entry for the new file is being placed cannot be extended because the user's quota of disk blocks on the file system containing the directory has been exhausted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EDQUOT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> is specified, the file does not exist, and the user's quota of inodes on the file system on which the file is being created has been exhausted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while making the directory entry or allocating the inode for <span class="define">O_CREAT</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ETXTBSY</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The file is a pure procedure (shared text) file that is being executed and the <b class="fname">open</b>() call requests write access.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">path</i> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EEXIST</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> and <span class="define">O_EXCL</span> were specified and the file exists.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EPERM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The file named by <i class="farg">path</i> is flagged append-only but <span class="define">O_APPEND</span> was not specified in <i class="farg">flags</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EOPNOTSUPP</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An attempt was made to open a socket (not currently implemented).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBUSY</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An attempt was made to open a terminal device that requires exclusive access and the specified device has already be opened.</dd>
</dl>
<div class="spacer">
</div>
Additionally, the <b class="fname">openat</b>() function will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument specifies a relative path and the <i class="farg">fd</i> argument is neither <span class="define">AT_FDCWD</span> nor a valid file descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument specifies a relative path and the <i class="farg">fd</i> argument is a valid file descriptor but it does not reference a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument specifies a relative path but search permission is denied for the directory which the <i class="farg">fd</i> file descriptor references.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/chflags.html">chflags(2)</a>, <a class="link-man" href="../html2/chmod.html">chmod(2)</a>, <a class="link-man" href="../html2/close.html">close(2)</a>, <a class="link-man" href="../html2/dup.html">dup(2)</a>, <a class="link-man" href="../html2/flock.html">flock(2)</a>, <a class="link-man" href="../html2/lseek.html">lseek(2)</a>, <a class="link-man" href="../html2/read.html">read(2)</a>, <a class="link-man" href="../html2/umask.html">umask(2)</a>, <a class="link-man" href="../html2/write.html">write(2)</a>, <a class="link-man" href="../html3/getdtablesize.html">getdtablesize(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">open</b>() and <b class="fname">openat</b>() functions conform to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;).<div class="spacer">
</div>
<span class="define">POSIX</span> specifies three different flavors for synchronous I/O: <span class="define">O_SYNC</span>, <span class="define">O_DSYNC</span>, and <span class="define">O_RSYNC</span>. In <span class="unix">OpenBSD</span>, these are all equivalent.<div class="spacer">
</div>
The <span class="define">O_SHLOCK</span> and <span class="define">O_EXLOCK</span> flags are non-standard extensions and should not be used if portability is of concern.</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> An <b class="fname">open</b>() system call first appeared in Version&#160;1 AT&amp;T UNIX. The <i class="farg">flags</i> argument has been supported since <span class="unix">4.2BSD</span>. Before that, a dedicated <b class="fname">creat</b>() system call had to be used to create new files; it appeared in Version&#160;1 AT&amp;T UNIX, was deprecated in <span class="unix">4.3BSD-Reno</span>, and removed in <span class="unix">OpenBSD&#160;5.0</span>.<div class="spacer">
</div>
The <b class="fname">openat</b>() system call has been available since <span class="unix">OpenBSD&#160;5.0</span>.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> The <span class="define">O_TRUNC</span> flag requires that one of <span class="define">O_RDWR</span> or <span class="define">O_WRONLY</span> also be specified, else <span class="errno">EINVAL</span> is returned.</div>
</div>
</body>
</html>

