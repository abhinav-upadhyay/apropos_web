<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
PLEDGE(2)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">pledge</b> &#8212; <span class="desc">restrict system operations</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">unistd.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">pledge</b>(<i class="farg" style="white-space:nowrap;">const char *promises</i>, <i class="farg" style="white-space:nowrap;">const char *paths[]</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The current process is forced into a restricted-service operating mode. A few subsets are available, roughly described as computation, memory management, read-write operations on file descriptors, opening of files, networking. In general, these modes were selected by studying the operation of many programs using libc and other such interfaces, and setting <i class="arg">promises</i> or <i class="arg">paths</i>.<div class="spacer">
</div>
Use of <b class="fname">pledge</b>() in an application will require at least some study and understanding of the interfaces called. Subsequent calls to <b class="fname">pledge</b>() can reduce the abilities further, but abilities can never be regained.<div class="spacer">
</div>
A process which attempts a restricted operation is killed with an uncatchable <span class="define">SIGABRT</span>, delivering a core file if possible.<div class="spacer">
</div>
A <i class="farg">promises</i> value of &quot;&quot; restricts the process to the <a class="link-man" href="../html2/_exit.html">_exit(2)</a> system call. This can be used for pure computation operating on memory shared with another process.<div class="spacer">
</div>
Passing <span class="define">NULL</span> to <i class="farg">promises</i> or <i class="farg">paths</i> specifies to not change the current value.<div class="spacer">
</div>
Some system calls, when allowed, have restrictions applied to them:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/access.html">access(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
May check for existence of <i class="file">/etc/localtime</i>.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/adjtime.html">adjtime(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Read-only, for <a class="link-man" href="../html8/ntpd.html">ntpd(8)</a>.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/ioctl.html">ioctl(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Only the <span class="define">FIONREAD</span> and <span class="define">FIONBIO</span> operations are allowed by default. Use of the &quot;tty&quot; and &quot;ioctl&quot; promises receive more ioctl requests.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/chmod.html">chmod(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/fchmod.html">fchmod(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/fchmodat.html">fchmodat(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/chown.html">chown(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/lchown.html">lchown(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/fchown.html">fchown(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/fchownat.html">fchownat(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/mkfifo.html">mkfifo(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/mknod.html">mknod(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Setuid/setgid/sticky bits are ignored. The user or group cannot be changed on a file.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/mmap.html">mmap(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/mprotect.html">mprotect(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
<span class="define">PROT_EXEC</span> isn't allowed.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/open.html">open(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
May open <i class="file">/etc/localtime</i> and any files below <i class="file">/usr/share/zoneinfo</i>.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/readlink.html">readlink(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
May operate on <i class="file">/etc/malloc.conf</i>.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html3/sysctl.html">sysctl(3)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
A small set of read-only operations are allowed, sufficient to support: <a class="link-man" href="../html3/getdomainname.html">getdomainname(3)</a>, <a class="link-man" href="../html3/gethostname.html">gethostname(3)</a>, <a class="link-man" href="../html3/getifaddrs.html">getifaddrs(3)</a>, <a class="link-man" href="../html3/uname.html">uname(3)</a>, system sensor readings.<div class="spacer">
</div>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<a class="link-man" href="../html2/pledge.html">pledge(2)</a></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Can only reduce permissions; can only set a list of <i class="file">paths</i> once.</dd>
</dl>
<div class="spacer">
</div>
The <i class="arg">promises</i> is specified as a string, with space separate keywords:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">stdio</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The following system calls are permitted to allow most basic functions in libc, including memory allocation, most types of IO operations on previously allocated file descriptors:<div class="spacer">
</div>
<a class="link-man" href="../html2/clock_getres.html">clock_getres(2)</a>, <a class="link-man" href="../html2/clock_gettime.html">clock_gettime(2)</a>, <a class="link-man" href="../html2/close.html">close(2)</a>, <a class="link-man" href="../html2/closefrom.html">closefrom(2)</a>, <a class="link-man" href="../html2/dup.html">dup(2)</a>, <a class="link-man" href="../html2/dup2.html">dup2(2)</a>, <a class="link-man" href="../html2/dup3.html">dup3(2)</a>, <a class="link-man" href="../html2/fchdir.html">fchdir(2)</a>, <a class="link-man" href="../html2/fcntl.html">fcntl(2)</a>, <a class="link-man" href="../html2/fstat.html">fstat(2)</a>, <a class="link-man" href="../html2/fsync.html">fsync(2)</a>, <a class="link-man" href="../html2/ftruncate.html">ftruncate(2)</a>, <a class="link-man" href="../html2/getdents.html">getdents(2)</a>, <a class="link-man" href="../html2/getdtablecount.html">getdtablecount(2)</a>, <a class="link-man" href="../html2/getegid.html">getegid(2)</a>, <a class="link-man" href="../html2/getentropy.html">getentropy(2)</a>, <a class="link-man" href="../html2/geteuid.html">geteuid(2)</a>, <a class="link-man" href="../html2/getgid.html">getgid(2)</a>, <a class="link-man" href="../html2/getgroups.html">getgroups(2)</a>, <a class="link-man" href="../html2/getitimer.html">getitimer(2)</a>, <a class="link-man" href="../html2/getlogin.html">getlogin(2)</a>, <a class="link-man" href="../html2/getpgid.html">getpgid(2)</a>, <a class="link-man" href="../html2/getpgrp.html">getpgrp(2)</a>, <a class="link-man" href="../html2/getpid.html">getpid(2)</a>, <a class="link-man" href="../html2/getppid.html">getppid(2)</a>, <a class="link-man" href="../html2/getresgid.html">getresgid(2)</a>, <a class="link-man" href="../html2/getresuid.html">getresuid(2)</a>, <a class="link-man" href="../html2/getrlimit.html">getrlimit(2)</a>, <a class="link-man" href="../html2/getsid.html">getsid(2)</a>, <a class="link-man" href="../html2/getthrid.html">getthrid(2)</a>, <a class="link-man" href="../html2/gettimeofday.html">gettimeofday(2)</a>, <a class="link-man" href="../html2/getuid.html">getuid(2)</a>, <a class="link-man" href="../html2/getuid.html">getuid(2)</a>, <a class="link-man" href="../html2/issetugid.html">issetugid(2)</a>, <a class="link-man" href="../html2/kevent.html">kevent(2)</a>, <a class="link-man" href="../html2/kqueue.html">kqueue(2)</a>, <a class="link-man" href="../html2/lseek.html">lseek(2)</a>, <a class="link-man" href="../html2/madvise.html">madvise(2)</a>, <a class="link-man" href="../html2/minherit.html">minherit(2)</a>, <a class="link-man" href="../html2/mmap.html">mmap(2)</a>, <a class="link-man" href="../html2/mprotect.html">mprotect(2)</a>, <a class="link-man" href="../html2/mquery.html">mquery(2)</a>, <a class="link-man" href="../html2/munmap.html">munmap(2)</a>, <a class="link-man" href="../html2/nanosleep.html">nanosleep(2)</a>, <a class="link-man" href="../html2/pipe.html">pipe(2)</a>, <a class="link-man" href="../html2/pipe2.html">pipe2(2)</a>, <a class="link-man" href="../html2/poll.html">poll(2)</a>, <a class="link-man" href="../html2/pread.html">pread(2)</a>, <a class="link-man" href="../html2/preadv.html">preadv(2)</a>, <a class="link-man" href="../html2/pwrite.html">pwrite(2)</a>, <a class="link-man" href="../html2/pwritev.html">pwritev(2)</a>, <a class="link-man" href="../html2/read.html">read(2)</a>, <a class="link-man" href="../html2/readv.html">readv(2)</a>, <a class="link-man" href="../html2/recvfrom.html">recvfrom(2)</a>, <a class="link-man" href="../html2/recvmsg.html">recvmsg(2)</a>, <a class="link-man" href="../html2/select.html">select(2)</a>, <a class="link-man" href="../html2/sendmsg.html">sendmsg(2)</a>, <a class="link-man" href="../html2/sendsyslog.html">sendsyslog(2)</a>, <a class="link-man" href="../html2/sendto.html">sendto(2)</a>, <a class="link-man" href="../html2/setitimer.html">setitimer(2)</a>, <a class="link-man" href="../html2/shutdown.html">shutdown(2)</a>, <a class="link-man" href="../html2/sigaction.html">sigaction(2)</a>, <a class="link-man" href="../html2/sigprocmask.html">sigprocmask(2)</a>, <a class="link-man" href="../html2/sigreturn.html">sigreturn(2)</a>, <a class="link-man" href="../html2/socketpair.html">socketpair(2)</a>, <a class="link-man" href="../html2/umask.html">umask(2)</a>, <a class="link-man" href="../html2/wait4.html">wait4(2)</a>, <a class="link-man" href="../html2/write.html">write(2)</a>, <a class="link-man" href="../html2/writev.html">writev(2)</a>.<div class="spacer">
</div>
Note that <a class="link-man" href="../html2/sendto.html">sendto(2)</a> is only permitted if its destination socket address is <span class="define">NULL</span>. As a result, all the expected functionalities of libc stdio work.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">rpath</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
A number of system calls are allowed if they only cause read-only effects on the filesystem:<div class="spacer">
</div>
<a class="link-man" href="../html2/chdir.html">chdir(2)</a>, <a class="link-man" href="../html3/getcwd.html">getcwd(3)</a>, <a class="link-man" href="../html2/openat.html">openat(2)</a>, <a class="link-man" href="../html2/fstatat.html">fstatat(2)</a>, <a class="link-man" href="../html2/faccessat.html">faccessat(2)</a>, <a class="link-man" href="../html2/readlinkat.html">readlinkat(2)</a>, <a class="link-man" href="../html2/lstat.html">lstat(2)</a>, <a class="link-man" href="../html2/chmod.html">chmod(2)</a>, <a class="link-man" href="../html2/fchmod.html">fchmod(2)</a>, <a class="link-man" href="../html2/fchmodat.html">fchmodat(2)</a>, <a class="link-man" href="../html2/chflags.html">chflags(2)</a>, <a class="link-man" href="../html2/chflagsat.html">chflagsat(2)</a>, <a class="link-man" href="../html2/chown.html">chown(2)</a>, <a class="link-man" href="../html2/fchown.html">fchown(2)</a>, <a class="link-man" href="../html2/fchownat.html">fchownat(2)</a>, <a class="link-man" href="../html2/fstat.html">fstat(2)</a>, <a class="link-man" href="../html2/getfsstat.html">getfsstat(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">wpath</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
A number of system calls are allowed and may cause write-effects on the filesystem:<div class="spacer">
</div>
<a class="link-man" href="../html3/getcwd.html">getcwd(3)</a>, <a class="link-man" href="../html2/openat.html">openat(2)</a>, <a class="link-man" href="../html2/fstatat.html">fstatat(2)</a>, <a class="link-man" href="../html2/faccessat.html">faccessat(2)</a>, <a class="link-man" href="../html2/readlinkat.html">readlinkat(2)</a>, <a class="link-man" href="../html2/lstat.html">lstat(2)</a>, <a class="link-man" href="../html2/chmod.html">chmod(2)</a>, <a class="link-man" href="../html2/fchmod.html">fchmod(2)</a>, <a class="link-man" href="../html2/fchmodat.html">fchmodat(2)</a>, <a class="link-man" href="../html2/chflags.html">chflags(2)</a>, <a class="link-man" href="../html2/chflagsat.html">chflagsat(2)</a>, <a class="link-man" href="../html2/chown.html">chown(2)</a>, <a class="link-man" href="../html2/fchown.html">fchown(2)</a>, <a class="link-man" href="../html2/fchownat.html">fchownat(2)</a>, <a class="link-man" href="../html2/fstat.html">fstat(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">cpath</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
A number of system calls and sub-modes are allowed, which may create new files or directories in the filesystem:<div class="spacer">
</div>
<a class="link-man" href="../html2/rename.html">rename(2)</a>, <a class="link-man" href="../html2/rmdir.html">rmdir(2)</a>, <a class="link-man" href="../html2/renameat.html">renameat(2)</a>, <a class="link-man" href="../html2/link.html">link(2)</a>, <a class="link-man" href="../html2/linkat.html">linkat(2)</a>, <a class="link-man" href="../html2/symlink.html">symlink(2)</a>, <a class="link-man" href="../html2/unlink.html">unlink(2)</a>, <a class="link-man" href="../html2/unlinkat.html">unlinkat(2)</a>, <a class="link-man" href="../html2/mkdir.html">mkdir(2)</a>, <a class="link-man" href="../html2/mkdirat.html">mkdirat(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">dpath</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
A number of system calls are allowed to create special files:<div class="spacer">
</div>
<a class="link-man" href="../html2/mkfifo.html">mkfifo(2)</a>, <a class="link-man" href="../html2/mknod.html">mknod(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">tmppath</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
A number of system calls are allowed to do operations in the <i class="file">/tmp</i> directory, including create, read, or write:<div class="spacer">
</div>
<a class="link-man" href="../html2/lstat.html">lstat(2)</a>, <a class="link-man" href="../html2/chmod.html">chmod(2)</a>, <a class="link-man" href="../html2/chflags.html">chflags(2)</a>, <a class="link-man" href="../html2/chown.html">chown(2)</a>, <a class="link-man" href="../html2/unlink.html">unlink(2)</a>, <a class="link-man" href="../html2/fstat.html">fstat(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">inet</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The following system calls are allowed to operate in the <span class="define">AF_INET</span> and <span class="define">AF_INET6</span> domains:<div class="spacer">
</div>
<a class="link-man" href="../html2/socket.html">socket(2)</a>, <a class="link-man" href="../html2/listen.html">listen(2)</a>, <a class="link-man" href="../html2/bind.html">bind(2)</a>, <a class="link-man" href="../html2/connect.html">connect(2)</a>, <a class="link-man" href="../html2/accept4.html">accept4(2)</a>, <a class="link-man" href="../html2/accept.html">accept(2)</a>, <a class="link-man" href="../html2/getpeername.html">getpeername(2)</a>, <a class="link-man" href="../html2/getsockname.html">getsockname(2)</a>, <a class="link-man" href="../html2/setsockopt.html">setsockopt(2)</a>, <a class="link-man" href="../html2/getsockopt.html">getsockopt(2)</a>.<div class="spacer">
</div>
<a class="link-man" href="../html2/setsockopt.html">setsockopt(2)</a> has been reduced in functionality substantially.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">fattr</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The following system calls are allowed to make explicit changes to fields in <b class="var">struct stat</b> relating to a file:<div class="spacer">
</div>
<a class="link-man" href="../html2/utimes.html">utimes(2)</a>, <a class="link-man" href="../html2/futimes.html">futimes(2)</a>, <a class="link-man" href="../html2/utimensat.html">utimensat(2)</a>, <a class="link-man" href="../html2/futimens.html">futimens(2)</a>, <a class="link-man" href="../html2/chmod.html">chmod(2)</a>, <a class="link-man" href="../html2/fchmod.html">fchmod(2)</a>, <a class="link-man" href="../html2/fchmodat.html">fchmodat(2)</a>, <a class="link-man" href="../html2/chflags.html">chflags(2)</a>, <a class="link-man" href="../html2/chflagsat.html">chflagsat(2)</a>, <a class="link-man" href="../html2/chown.html">chown(2)</a>, <a class="link-man" href="../html2/fchownat.html">fchownat(2)</a>, <a class="link-man" href="../html2/lchown.html">lchown(2)</a>, <a class="link-man" href="../html2/fchown.html">fchown(2)</a>, <a class="link-man" href="../html2/utimes.html">utimes(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">flock</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
File locking via <a class="link-man" href="../html2/fcntl.html">fcntl(2)</a>, <a class="link-man" href="../html2/flock.html">flock(2)</a>, <a class="link-man" href="../html3/lockf.html">lockf(3)</a>, and <a class="link-man" href="../html2/open.html">open(2)</a> is allowed. No distinction is made between shared and exclusive locks. This promise is required for unlock as well as lock.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">unix</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The following system calls are allowed to operate in the <span class="define">AF_UNIX</span> domain:<div class="spacer">
</div>
<a class="link-man" href="../html2/socket.html">socket(2)</a>, <a class="link-man" href="../html2/listen.html">listen(2)</a>, <a class="link-man" href="../html2/bind.html">bind(2)</a>, <a class="link-man" href="../html2/connect.html">connect(2)</a>, <a class="link-man" href="../html2/accept4.html">accept4(2)</a>, <a class="link-man" href="../html2/accept.html">accept(2)</a>, <a class="link-man" href="../html2/getpeername.html">getpeername(2)</a>, <a class="link-man" href="../html2/getsockname.html">getsockname(2)</a>, <a class="link-man" href="../html2/setsockopt.html">setsockopt(2)</a>, <a class="link-man" href="../html2/getsockopt.html">getsockopt(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">dns</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Subsequent to a successful <a class="link-man" href="../html2/open.html">open(2)</a> of <i class="file">/etc/resolv.conf</i>, a few system calls become able to allow DNS network transactions:<div class="spacer">
</div>
<a class="link-man" href="../html2/sendto.html">sendto(2)</a>, <a class="link-man" href="../html2/recvfrom.html">recvfrom(2)</a>, <a class="link-man" href="../html2/socket.html">socket(2)</a>, <a class="link-man" href="../html2/connect.html">connect(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">getpw</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
This allows read-only opening of files in <i class="file">/etc</i> for the <a class="link-man" href="../html3/getpwnam.html">getpwnam(3)</a>, <a class="link-man" href="../html3/getgrnam.html">getgrnam(3)</a>, <a class="link-man" href="../html3/getgrouplist.html">getgrouplist(3)</a>, and <a class="link-man" href="../html3/initgroups.html">initgroups(3)</a> family of functions. They may also need to operate in a <a class="link-man" href="../html8/yp.html">yp(8)</a> environment, so a successful <a class="link-man" href="../html2/open.html">open(2)</a> of <i class="file">/var/run/ypbind.lock</i> enables <b class="var">inet</b> operations.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">sendfd</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allows sending of file descriptors using <a class="link-man" href="../html2/sendmsg.html">sendmsg(2)</a>. File descriptors referering to directories may not be passed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">recvfd</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allows receiving of file descriptors using <a class="link-man" href="../html2/recvmsg.html">recvmsg(2)</a>. File descriptors referering to directories may not be passed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">ioctl</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allows a subset of <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> operations:<div class="spacer">
</div>
<span class="define">FIOCLEX</span>, <span class="define">FIONCLEX</span>, <span class="define">FIOASYNC</span>, <span class="define">FIOGETOWN</span>, and <span class="define">FIOSETOWN</span>. On a tty device <span class="define">TIOCGETA will succeed otherwise fail with</span> <span class="errno">EPERM</span>. On a tty device, <span class="define">TIOCGPGRP</span> and <span class="define">TIOCGWINSZ</span> are allowed. A few other operations are allowed, but not listed here.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">tty</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
In addition to allowing read-write operations on <i class="file">/dev/tty</i>, this opens up a variety of <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> requests used by tty devices. The following <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> requests are permitted: <span class="define">TIOCSPGRP</span>, <span class="define">TIOCGETA</span>, <span class="define">TIOCGPGRP</span>, <span class="define">TIOCGWINSZ</span>, <span class="define">TIOCSWINSZ</span>, <span class="define">TIOCSBRK</span>, <span class="define">TIOCCDTR</span>, <span class="define">TIOCSETA</span>, <span class="define">TIOCSETAW</span> and <span class="define">TIOCSETAF</span>.<div class="spacer">
</div>
If <b class="var">tty</b> is accompanied with <b class="var">rpath</b>, <a class="link-man" href="../html2/revoke.html">revoke(2)</a> is permitted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">proc</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allows the following process relationship operations:<div class="spacer">
</div>
<a class="link-man" href="../html2/fork.html">fork(2)</a>, <a class="link-man" href="../html2/vfork.html">vfork(2)</a>, <a class="link-man" href="../html2/kill.html">kill(2)</a>, <a class="link-man" href="../html2/getpriority.html">getpriority(2)</a>, <a class="link-man" href="../html2/setpriority.html">setpriority(2)</a>, <a class="link-man" href="../html2/setrlimit.html">setrlimit(2)</a>, <a class="link-man" href="../html2/setpgid.html">setpgid(2)</a>, <a class="link-man" href="../html2/setsid.html">setsid(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">exec</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allows a process to call <a class="link-man" href="../html2/execve.html">execve(2)</a>. Coupled with the <b class="var">proc</b> promise, this allows a process to fork and execute another program. The new program starts running without pledge active and hopefully makes a new <b class="fname">pledge</b>().</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">prot_exec</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allows the use of <span class="define">PROT_EXEC</span> with <a class="link-man" href="../html2/mmap.html">mmap(2)</a> and <a class="link-man" href="../html2/mprotect.html">mprotect(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">settime</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allows the setting of system time, via the <a class="link-man" href="../html2/settimeofday.html">settimeofday(2)</a>, <a class="link-man" href="../html2/adjtime.html">adjtime(2)</a>, and <a class="link-man" href="../html2/adjfreq.html">adjfreq(2)</a> system calls.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">ps</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allows enough <a class="link-man" href="../html3/sysctl.html">sysctl(3)</a> interfaces to allow inspection of processes operating on the system using programs like <a class="link-man" href="../html1/ps.html">ps(1)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">vminfo</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allows enough <a class="link-man" href="../html3/sysctl.html">sysctl(3)</a> interfaces to allow inspection of the system's virtual memory by programs like <a class="link-man" href="../html1/top.html">top(1)</a> and <a class="link-man" href="../html8/vmstat.html">vmstat(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">id</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allows the following system calls which can change the rights of a process:<div class="spacer">
</div>
<a class="link-man" href="../html2/setuid.html">setuid(2)</a>, <a class="link-man" href="../html2/seteuid.html">seteuid(2)</a>, <a class="link-man" href="../html2/setreuid.html">setreuid(2)</a>, <a class="link-man" href="../html2/setresuid.html">setresuid(2)</a>, <a class="link-man" href="../html2/setgid.html">setgid(2)</a>, <a class="link-man" href="../html2/setegid.html">setegid(2)</a>, <a class="link-man" href="../html2/setregid.html">setregid(2)</a>, <a class="link-man" href="../html2/setresgid.html">setresgid(2)</a>, <a class="link-man" href="../html2/setgroups.html">setgroups(2)</a>, <a class="link-man" href="../html2/setlogin.html">setlogin(2)</a>, <a class="link-man" href="../html2/setrlimit.html">setrlimit(2)</a>, <a class="link-man" href="../html2/getpriority.html">getpriority(2)</a>, <a class="link-man" href="../html2/setpriority.html">setpriority(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">pf</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allows a subset of <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> operations on the <a class="link-man" href="../html4/pf.html">pf(4)</a> device:<div class="spacer">
</div>
<span class="define">DIOCADDRULE</span>, <span class="define">DIOCGETSTATUS</span>, <span class="define">DIOCNATLOOK</span>, <span class="define">DIOCRADDTABLES</span>, <span class="define">DIOCRCLRADDRS</span>, <span class="define">DIOCRCLRTABLES</span>, <span class="define">DIOCRCLRTSTATS</span>, <span class="define">DIOCRGETTSTATS</span>, <span class="define">DIOCRSETADDRS</span>, <span class="define">DIOCXBEGIN</span>, <span class="define">DIOCXCOMMIT</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">audio</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allows a subset of <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a> operations on <a class="link-man" href="../html4/audio.html">audio(4)</a> devices:<div class="spacer">
</div>
<span class="define">AUDIO_GETPOS</span>, <span class="define">AUDIO_SETINFO</span>, <span class="define">AUDIO_GETINFO</span>, <span class="define">AUDIO_GETENC</span>, <span class="define">AUDIO_SETFD</span>, <span class="define">AUDIO_GETPROPS</span>.<div class="spacer">
</div>
See <a class="link-man" href="../html3/sio_open.html">sio_open(3)</a> for more information on using the sndio API in combination with <b class="fname">pledge</b>().</dd>
</dl>
<div class="spacer">
</div>
A whitelist of permitted paths may be provided in <i class="arg">paths</i>. All other paths will return <span class="errno">ENOENT</span>. At least one promise is required to be pledged in order to activate a whitelist.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, the value&#160;0 is returned; otherwise the value&#160;-1 is returned and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">pledge</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">paths</i> or one of its elements, or <i class="farg">promises</i> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="arg">request</i> is malformed or contains invalid keywords.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENAMETOOLONG</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An element of <i class="farg">paths</i> is too large, prepending <i class="farg">cwd</i> to it would exceed <span class="define">PATH_MAX</span> bytes, or <i class="farg">promises</i> is too long.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EPERM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
This process is attempting to increase permissions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">E2BIG</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="arg">paths</i> array is too large, or the total number of bytes exceeds a system-imposed limit. The limit in the system as released is 262144 bytes (<span class="define">ARG_MAX</span>).</dd>
</dl>
</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">pledge</b>() system call first appeared in <span class="unix">OpenBSD&#160;5.9</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The path whitelist feature is not available at this time.</div>
</div>
</body>
</html>

