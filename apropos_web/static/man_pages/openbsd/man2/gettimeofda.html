<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
GETTIMEOFDAY(2)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">gettimeofday</b>, <b class="name">settimeofday</b> &#8212; <span class="desc">get/set date and time</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/time.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">gettimeofday</b>(<i class="farg" style="white-space:nowrap;">struct timeval *tp</i>, <i class="farg" style="white-space:nowrap;">struct timezone *tzp</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">settimeofday</b>(<i class="farg" style="white-space:nowrap;">const struct timeval *tp</i>, <i class="farg" style="white-space:nowrap;">const struct timezone *tzp</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1><div class="symb" style="display:inline;margin-left: 1.00ex;">
Note: timezone is no longer used; this information is kept outside the kernel.</div>
<div class="spacer">
</div>
The system's notion of the current Greenwich time and the current time zone is obtained with the <b class="fname">gettimeofday</b>() call, and set with the <b class="fname">settimeofday</b>() call. The time is expressed in seconds and microseconds since midnight (0 hour), January 1, 1970. The resolution of the system clock is hardware dependent, and the time may be updated continuously or in &#8220;ticks&#8221;. If <i class="farg">tp</i> or <i class="farg">tzp</i> is <span class="define">NULL</span>, the associated time information will not be returned or set.<div class="spacer">
</div>
The structures pointed to by <i class="farg">tp</i> and <i class="farg">tzp</i> are defined in <b class="includes">&lt;<a class="link-includes">sys/time.h</a>&gt;</b> as:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
struct timeval { 
	time_t		tv_sec;		/* seconds since Jan. 1, 1970 */ 
	suseconds_t	tv_usec;	/* and microseconds */ 
}; 
 
struct timezone { 
	int	tz_minuteswest; /* of Greenwich */ 
	int	tz_dsttime;	/* type of dst correction to apply */ 
};</pre>
<div class="spacer">
</div>
The <i class="farg">timezone</i> structure indicates the local time zone (measured in minutes of time westward from Greenwich), and a flag that, if nonzero, indicates that Daylight Saving time applies locally during the appropriate part of the year.<div class="spacer">
</div>
Only the superuser may set the time of day or time zone. If the system securelevel is greater than 1 (see <a class="link-man" href="../html8/init.html">init(8)</a>), the time may only be advanced. This limitation is imposed to prevent a malicious superuser from setting arbitrary time stamps on files. The system time can still be adjusted backwards using the <a class="link-man" href="../html2/adjtime.html">adjtime(2)</a> system call even when the system is secure.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, the value&#160;0 is returned; otherwise the value&#160;-1 is returned and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">gettimeofday</b>() and <b class="fname">settimeofday</b>() will succeed unless:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An argument address referenced invalid memory.</dd>
</dl>
<div class="spacer">
</div>
In addition, <b class="fname">settimeofday</b>() may return the following error:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EPERM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A user other than the superuser attempted to set the time.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/date.html">date(1)</a>, <a class="link-man" href="../html2/adjtime.html">adjtime(2)</a>, <a class="link-man" href="../html2/clock_gettime.html">clock_gettime(2)</a>, <a class="link-man" href="../html2/getitimer.html">getitimer(2)</a>, <a class="link-man" href="../html3/ctime.html">ctime(3)</a>, <a class="link-man" href="../html3/time.html">time(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">gettimeofday</b>() function conforms to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> As predecessors of these functions, former system calls <b class="fname">time</b>() and <b class="fname">stime</b>() first appeared in Version&#160;1 AT&amp;T UNIX, and <b class="fname">ftime</b>() first appeared in Version&#160;7 AT&amp;T UNIX. The <b class="fname">gettimeofday</b>() and <b class="fname">settimeofday</b>() system calls first appeared in <span class="unix">4.1cBSD</span>.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> Setting the time with <b class="fname">settimeofday</b>() is dangerous; if possible use <a class="link-man" href="../html2/adjtime.html">adjtime(2)</a> instead. Many daemon programming techniques utilize time-delta techniques using the results from <b class="fname">gettimeofday</b>() instead of from <a class="link-man" href="../html2/clock_gettime.html">clock_gettime(2)</a> on the <span class="define">CLOCK_MONOTONIC</span> clock. Time jumps can cause these programs to malfunction in unexpected ways. If the time must be set, consider rebooting the machine for safety.</div>
</div>
</body>
</html>

