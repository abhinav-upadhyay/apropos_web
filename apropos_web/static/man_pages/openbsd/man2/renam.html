<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
RENAME(2)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">rename</b>, <b class="name">renameat</b> &#8212; <span class="desc">change the name of a file</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">stdio.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">rename</b>(<i class="farg" style="white-space:nowrap;">const char *from</i>, <i class="farg" style="white-space:nowrap;">const char *to</i>);<div class="spacer">
</div>
<b class="includes">#include &lt;<a class="link-includes">fcntl.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">stdio.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">renameat</b>(<i class="farg" style="white-space:nowrap;">int fromfd</i>, <i class="farg" style="white-space:nowrap;">const char *from</i>, <i class="farg" style="white-space:nowrap;">int tofd</i>, <i class="farg" style="white-space:nowrap;">const char *to</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">rename</b>() function causes the link named <i class="farg">from</i> to be renamed as <i class="farg">to</i>. If <i class="farg">to</i> exists, it is first removed. Both <i class="farg">from</i> and <i class="farg">to</i> must be of the same type (that is, both directories or both non-directories), and must reside on the same file system.<div class="spacer">
</div>
<b class="fname">rename</b>() guarantees that if <i class="farg">to</i> already exists, an instance of <i class="farg">to</i> will always exist, even if the system should crash in the middle of the operation.<div class="spacer">
</div>
If the final component of <i class="farg">from</i> is a symbolic link, the symbolic link is renamed, not the file or directory to which it points.<div class="spacer">
</div>
The <b class="fname">renameat</b>() function is equivalent to <b class="fname">rename</b>() except that where <i class="farg">from</i> or <i class="farg">to</i> specifies a relative path, the directory entry names used are resolved relative to the directories associated with file descriptors <i class="farg">fromfd</i> or <i class="farg">tofd</i> (respectively) instead of the current working directory.<div class="spacer">
</div>
If <b class="fname">renameat</b>() is passed the special value <span class="define">AT_FDCWD</span> (defined in <b class="includes">&lt;<a class="link-includes">fcntl.h</a>&gt;</b>) in the <i class="farg">fromfd</i> or <i class="farg">tofd</i> parameter, the current working directory is used for resolving the respective <i class="farg">from</i> or <i class="farg">to</i> argument.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, the value&#160;0 is returned; otherwise the value&#160;-1 is returned and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">rename</b>() and <b class="fname">renameat</b>() will fail and neither of the argument files will be affected if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENAMETOOLONG</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded <span class="define">NAME_MAX</span> characters, or an entire pathname (including the terminating NUL) exceeded <span class="define">PATH_MAX</span> bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOENT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of the <i class="farg">from</i> path does not exist, or a path prefix of <i class="farg">to</i> does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of either path prefix denies search permission.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The requested change requires writing in a directory that denies write permission.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">from</i> argument is a directory and denies write permission.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EPERM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The directory containing <i class="farg">from</i> is marked sticky, and neither the containing directory nor <i class="farg">from</i> are owned by the effective user ID.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EPERM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">to</i> file exists, the directory containing <i class="farg">to</i> is marked sticky, and neither the containing directory nor <i class="farg">to</i> are owned by the effective user ID.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ELOOP</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating either pathname.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EMLINK</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The link count on the source file or destination directory is at the maximum. A rename cannot be completed under these conditions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of either path prefix is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">from</i> is a directory, but <i class="farg">to</i> is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EISDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">to</i> is a directory, but <i class="farg">from</i> is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EXDEV</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The link named by <i class="farg">to</i> and the file named by <i class="farg">from</i> are on different logical devices (file systems). Note that this error code will not be returned if the implementation permits cross-device links.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOSPC</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The directory in which the entry for the new name is being placed cannot be extended because there is no space left on the file system containing the directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EDQUOT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The directory in which the entry for the new name is being placed cannot be extended because the user's quota of disk blocks on the file system containing the directory has been exhausted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while making or updating a directory entry.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EROFS</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The requested link requires writing in a directory on a read-only file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">from</i> or <i class="farg">to</i> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">from</i> is a parent directory of <i class="farg">to</i>, or an attempt is made to rename &#8216;<code class="lit">.</code>&#8217; or &#8216;<code class="lit">..</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTEMPTY</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">to</i> is a directory and is not empty.</dd>
</dl>
<div class="spacer">
</div>
Additionally, <b class="fname">renameat</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">from</i> or <i class="farg">to</i> argument specifies a relative path and the <i class="farg">fromfd</i> or <i class="farg">tofd</i> argument, respectively, is neither <span class="define">AT_FDCWD</span> nor a valid file descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">from</i> or <i class="farg">to</i> argument specifies a relative path and the <i class="farg">fromfd</i> or <i class="farg">tofd</i> argument, respectively, is a valid file descriptor but it does not reference a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">from</i> or <i class="farg">to</i> argument specifies a relative path but search permission is denied for the directory which the <i class="farg">fromfd</i> or <i class="farg">tofd</i> file descriptor, respectively, references.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/mv.html">mv(1)</a>, <a class="link-man" href="../html2/open.html">open(2)</a>, <a class="link-man" href="../html7/symlink.html">symlink(7)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">rename</b>() and <b class="fname">renameat</b>() functions conform to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">renameat</b>() function appeared in <span class="unix">OpenBSD&#160;5.0</span>.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> The system can deadlock if a loop in the file system graph is present. This loop takes the form of an entry in directory &#8216;<i class="file">a</i>&#8217;, say &#8216;<i class="file">a/foo</i>&#8217;, being a hard link to directory &#8216;<i class="file">b</i>&#8217;, and an entry in directory &#8216;<i class="file">b</i>&#8217;, say &#8216;<i class="file">b/bar</i>&#8217;, being a hard link to directory &#8216;<i class="file">a</i>&#8217;. When such a loop exists and two separate processes attempt to perform &#8216;<code class="lit">rename a/foo b/bar</code>&#8217; and &#8216;<code class="lit">rename b/bar a/foo</code>&#8217;, respectively, the system may deadlock attempting to lock both directories for modification. Hard links to directories should be replaced by symbolic links by the system administrator.</div>
</div>
</body>
</html>

