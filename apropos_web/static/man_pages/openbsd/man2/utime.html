<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
UTIMES(2)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">utimes</b>, <b class="name">futimes</b>, <b class="name">utimensat</b>, <b class="name">futimens</b> &#8212; <span class="desc">set file access and modification times</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/time.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">utimes</b>(<i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">const struct timeval *times</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">futimes</b>(<i class="farg" style="white-space:nowrap;">int fd</i>, <i class="farg" style="white-space:nowrap;">const struct timeval *times</i>);<div class="spacer">
</div>
<b class="includes">#include &lt;<a class="link-includes">sys/stat.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">fcntl.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">utimensat</b>(<i class="farg" style="white-space:nowrap;">int fd</i>, <i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">const struct timespec times[2]</i>, <i class="farg" style="white-space:nowrap;">int flag</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">futimens</b>(<i class="farg" style="white-space:nowrap;">int fd</i>, <i class="farg" style="white-space:nowrap;">const struct timespec times[2]</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The access and modification times of the file named by <i class="farg">path</i> or referenced by <i class="farg">fd</i> are changed as specified by the argument <i class="farg">times</i>.<div class="spacer">
</div>
If <i class="farg">times</i> is <span class="define">NULL</span>, the access and modification times are set to the current time. The caller must be the owner of the file, have permission to write the file, or be the superuser.<div class="spacer">
</div>
If <i class="farg">times</i> is non-null, it is assumed to point to an array of two timeval structures. The access time is set to the value of the first element, and the modification time is set to the value of the second element. The caller must be the owner of the file or be the superuser.<div class="spacer">
</div>
In either case, the file status change time is set to the current time.<div class="spacer">
</div>
The <b class="fname">utimensat</b>() and <b class="fname">futimens</b>() are equivalent to <b class="fname">utimes</b>() and <b class="fname">futimes</b>(), respectively, with the following differences.<div class="spacer">
</div>
Both <b class="fname">utimensat</b>() and <b class="fname">futimens</b>() take two timespec values instead of two timeval values. Further, either of the <i class="farg">tv_nsec</i> fields can be set to one of the following special values defined in <b class="includes">&lt;<a class="link-includes">sys/stat.h</a>&gt;</b>, in which case the value of <i class="farg">tv_sec</i> is ignored:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">UTIME_NOW</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Set the respective timestamp to the greatest value supported that is not greater than the current time.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">UTIME_OMIT</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Do not change the respective timestamp.</dd>
</dl>
<div class="spacer">
</div>
Additionally, if the <i class="farg">path</i> argument to <b class="fname">utimensat</b>() specifies a relative path, the file whose timestamps are changed is determined relative to the directory associated with file descriptor <i class="farg">fd</i> instead of the current working directory.<div class="spacer">
</div>
If <b class="fname">utimensat</b>() is passed the special value <span class="define">AT_FDCWD</span> (defined in <b class="includes">&lt;<a class="link-includes">fcntl.h</a>&gt;</b>) in the <i class="farg">fd</i> parameter, the current working directory is used.<div class="spacer">
</div>
The <i class="farg">flag</i> argument is the bitwise OR of zero or more of the following values:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">AT_SYMLINK_NOFOLLOW</span></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
If <i class="farg">path</i> names a symbolic link, then the timestamps of the symbolic link are changed.</dd>
</dl>
</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, the value&#160;0 is returned; otherwise the value&#160;-1 is returned and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">utimes</b>() and <b class="fname">utimensat</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Search permission is denied for a component of the path prefix; or the <i class="farg">times</i> argument is <span class="define">NULL</span> and the effective user ID of the process does not match the owner of the file, and is not the superuser, and write access is denied.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">path</i> or <i class="farg">times</i> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading or writing the affected inode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ELOOP</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating the pathname.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENAMETOOLONG</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded <span class="define">NAME_MAX</span> characters, or an entire pathname (including the terminating NUL) exceeded <span class="define">PATH_MAX</span> bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOENT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of the path prefix is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EPERM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">times</i> argument is not <span class="define">NULL</span> and the calling process's effective user ID does not match the owner of the file and is not the superuser.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EROFS</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The file system containing the file is mounted read-only.</dd>
</dl>
<div class="spacer">
</div>
Additionally, <b class="fname">utimensat</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The value of the <i class="farg">flag</i> argument was neither zero nor <span class="define">AT_SYMLINK_NOFOLLOW</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument specifies a relative path and the <i class="farg">fd</i> argument is neither <span class="define">AT_FDCWD</span> nor a valid file descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument specifies a relative path and the <i class="farg">fd</i> argument is a valid file descriptor but it does not reference a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument specifies a relative path but search permission is denied for the directory which the <i class="farg">fd</i> file descriptor references.</dd>
</dl>
<div class="spacer">
</div>
<b class="fname">futimes</b>() and <b class="fname">futimens</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">fd</i> does not refer to a valid descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">times</i> argument is <span class="define">NULL</span> and the effective user ID of the process does not match the owner of the file, and is not the superuser, and write access is denied.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">times</i> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading or writing the affected inode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EPERM</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">times</i> argument is not <span class="define">NULL</span> and the calling process's effective user ID does not match the owner of the file and is not the superuser.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EROFS</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The file system containing the file is mounted read-only.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/clock_gettime.html">clock_gettime(2)</a>, <a class="link-man" href="../html2/stat.html">stat(2)</a>, <a class="link-man" href="../html3/utime.html">utime(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">utimes</b>(), <b class="fname">utimensat</b>(), and <b class="fname">futimens</b>() functions conform to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The predecessors of <b class="fname">utimes</b>() were <b class="fname">smdate</b>() in Version&#160;1 AT&amp;T UNIX, <b class="fname">mdate</b>() in Version&#160;3 AT&amp;T UNIX, and <b class="fname">utime</b>() in Version&#160;7 AT&amp;T UNIX; the latter first supported the concept of an access time in addition to the modification time.<div class="spacer">
</div>
The <b class="fname">utimes</b>() function call appeared in <span class="unix">4.2BSD</span>. The <b class="fname">futimes</b>() function call appeared in <span class="unix">NetBSD&#160;1.2</span>. The <b class="fname">utimensat</b>() and <b class="fname">futimens</b>() function calls appeared in <span class="unix">OpenBSD&#160;5.0</span>.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> Some filesystems, such as FAT, use the same timestamp for both modification and file status change; on those filesystems, the file status change timestamp will not be updated if <span class="define">UTIME_OMIT</span> is specified for the modification timestamp argument. Similarly, on NFS the file status change timestamp will not be updated if <span class="define">UTIME_OMIT</span> is specified for both the access and the modification timestamp arguments.</div>
</div>
</body>
</html>

