<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
ACCEPT(2)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">accept</b>, <b class="name">accept4</b> &#8212; <span class="desc">accept a connection on a socket</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/socket.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">accept</b>(<i class="farg" style="white-space:nowrap;">int s</i>, <i class="farg" style="white-space:nowrap;">struct sockaddr *addr</i>, <i class="farg" style="white-space:nowrap;">socklen_t *addrlen</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">accept4</b>(<i class="farg" style="white-space:nowrap;">int s</i>, <i class="farg" style="white-space:nowrap;">struct sockaddr *addr</i>, <i class="farg" style="white-space:nowrap;">socklen_t *addrlen</i>, <i class="farg" style="white-space:nowrap;">int flags</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The argument <i class="farg">s</i> is a socket that has been created with <a class="link-man" href="../html2/socket.html">socket(2)</a>, bound to an address with <a class="link-man" href="../html2/bind.html">bind(2)</a>, and is listening for connections after a <a class="link-man" href="../html2/listen.html">listen(2)</a>. The <b class="fname">accept</b>() call extracts the first connection request on the queue of pending connections, creates a new socket with the same non-blocking I/O mode as <i class="farg">s</i>, and allocates a new file descriptor for the socket with the close-on-exec flag clear.<div class="spacer">
</div>
The <b class="fname">accept4</b>() system call is similar, however the non-blocking I/O mode of the new socket is determined by the <span class="define">SOCK_NONBLOCK</span> flag in the <i class="farg">flags</i> argument and the close-on-exec flag on the new file descriptor is determined by the <span class="define">SOCK_CLOEXEC</span> flag in the <i class="farg">flags</i> argument.<div class="spacer">
</div>
If no pending connections are present on the queue, and the socket is not marked as non-blocking, <b class="fname">accept</b>() blocks the caller until a connection is present. If the socket is marked non-blocking and no pending connections are present on the queue, <b class="fname">accept</b>() returns an error as described below. The accepted socket may not be used to accept more connections. The original socket <i class="farg">s</i> remains open.<div class="spacer">
</div>
The argument <i class="farg">addr</i> is a result parameter that is filled in with the address of the connecting entity as known to the communications layer. The exact format of the <i class="farg">addr</i> parameter is determined by the domain in which the communication is occurring. The structure <code class="lit">sockaddr_storage</code> exists for greater portability. It is large enough to hold any of the types that may be returned in the <i class="farg">addr</i> parameter.<div class="spacer">
</div>
The <i class="farg">addrlen</i> is a value-result parameter; it should initially contain the amount of space pointed to by <i class="farg">addr</i>; on return it will contain the actual length (in bytes) of the address returned. If <i class="farg">addrlen</i> does not point to enough space to hold the entire socket address, the result will be truncated to the initial value of <i class="farg">addrlen</i> (in bytes). This call is used with connection-based socket types, currently with <span class="define">SOCK_STREAM</span>.<div class="spacer">
</div>
It is possible to <a class="link-man" href="../html2/select.html">select(2)</a> or <a class="link-man" href="../html2/poll.html">poll(2)</a> a socket for the purposes of doing an <b class="fname">accept</b>() by selecting it for read.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> The call returns -1 on error. If it succeeds, it returns a non-negative integer that is a descriptor for the accepted socket.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The following code uses struct <code class="lit">sockaddr_storage</code> to allocate enough space for the returned address:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
#include &lt;sys/types.h&gt; 
#include &lt;sys/socket.h&gt; 
 
struct sockaddr_storage addr; 
socklen_t len = sizeof(addr); 
int retcode; 
 
retcode = accept(s, (struct sockaddr *)&amp;addr, &amp;len); 
if (retcode == -1) 
	err(1, &quot;accept&quot;);</pre>
</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">accept</b>() and <b class="fname">accept4</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The descriptor is invalid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTSOCK</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The descriptor doesn't reference a socket.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EOPNOTSUPP</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The referenced socket is not of type <span class="define">SOCK_STREAM</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINTR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A signal was caught before a connection arrived.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The referenced socket is not listening for connections (that is, <a class="link-man" href="../html2/listen.html">listen(2)</a> has not yet been called).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">addr</i> or <i class="farg">addrlen</i> parameter is not in a valid part of the process address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EWOULDBLOCK</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The socket is marked non-blocking and no connections are present to be accepted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EMFILE</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The per-process descriptor table is full.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENFILE</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The system file table is full.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ECONNABORTED</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A connection has been aborted.</dd>
</dl>
<div class="spacer">
</div>
In addition, <b class="fname">accept4</b>() will fail if<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">flags</i> is invalid.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/bind.html">bind(2)</a>, <a class="link-man" href="../html2/connect.html">connect(2)</a>, <a class="link-man" href="../html2/listen.html">listen(2)</a>, <a class="link-man" href="../html2/poll.html">poll(2)</a>, <a class="link-man" href="../html2/select.html">select(2)</a>, <a class="link-man" href="../html2/socket.html">socket(2)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">accept</b>() function conforms to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;). The <b class="fname">accept4</b>() function is expected to conform to a future revision of that standard.</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">accept</b>() system call first appeared in <span class="unix">4.1cBSD</span> and <b class="fname">accept4</b>() in <span class="unix">OpenBSD&#160;5.7</span>.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> When <span class="errno">EMFILE</span> or <span class="errno">ENFILE</span> is returned, new connections are neither dequeued nor discarded. Thus considerable care is required in <a class="link-man" href="../html2/select.html">select(2)</a> and <a class="link-man" href="../html2/poll.html">poll(2)</a> loops.</div>
</div>
</body>
</html>

