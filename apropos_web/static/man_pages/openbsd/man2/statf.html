<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
STATFS(2)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">statfs</b>, <b class="name">fstatfs</b> &#8212; <span class="desc">get file system statistics</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/param.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">sys/mount.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">statfs</b>(<i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">struct statfs *buf</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">fstatfs</b>(<i class="farg" style="white-space:nowrap;">int fd</i>, <i class="farg" style="white-space:nowrap;">struct statfs *buf</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">statfs</b>() returns information about a mounted file system. <i class="farg">path</i> is the path name of any file within the mounted file system. <i class="farg">buf</i> is a pointer to a <b class="name">statfs</b> structure defined as follows:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
typedef struct { int32_t val[2]; } fsid_t; 
 
#define MFSNAMELEN   16 /* length of fs type name, including nul */ 
#define MNAMELEN     90	/* length of buffer for returned name */ 
 
struct statfs { 
   u_int32_t       f_flags;        /* copy of mount flags */ 
   u_int32_t       f_bsize;        /* file system block size */ 
   u_int32_t       f_iosize;       /* optimal transfer block size */ 
 
                                   /* unit is f_bsize */ 
   u_int64_t       f_blocks;       /* total data blocks in file system */ 
   u_int64_t       f_bfree;        /* free blocks in fs */ 
   int64_t         f_bavail;       /* free blocks avail to non-superuser */ 
 
   u_int64_t       f_files;        /* total file nodes in file system */ 
   u_int64_t       f_ffree;        /* free file nodes in fs */ 
   int64_t         f_favail;       /* free file nodes avail to non-root */ 
 
   u_int64_t       f_syncwrites;   /* count of sync writes since mount */ 
   u_int64_t       f_syncreads;    /* count of sync reads since mount */ 
   u_int64_t       f_asyncwrites;  /* count of async writes since mount */ 
   u_int64_t       f_asyncreads;   /* count of async reads since mount */ 
 
   fsid_t          f_fsid;         /* file system id */ 
   u_int32_t       f_namemax;      /* maximum filename length */ 
   uid_t           f_owner;        /* user that mounted the file system */ 
   u_int64_t       f_ctime;        /* last mount [-u] time */ 
 
   char f_fstypename[MFSNAMELEN];  /* fs type name */ 
   char f_mntonname[MNAMELEN];     /* directory on which mounted */ 
   char f_mntfromname[MNAMELEN];   /* mounted file system */ 
   char f_mntfromspec[MNAMELEN];   /* special for mount request */ 
   union mount_info mount_info;    /* per-filesystem mount options */ 
};</pre>
<div class="spacer">
</div>
<b class="fname">fstatfs</b>() returns the same information about an open file referenced by descriptor <i class="farg">fd</i>.<div class="spacer">
</div>
Note that <i class="farg">f_fsid</i> will be empty unless the user is the superuser.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, the value&#160;0 is returned; otherwise the value&#160;-1 is returned and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">statfs</b>() fails if one or more of the following are true:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of the path prefix of <i class="farg">path</i> is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENAMETOOLONG</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded <span class="define">NAME_MAX</span> characters, or an entire pathname (including the terminating NUL) exceeded <span class="define">PATH_MAX</span> bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOENT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The file referred to by <i class="farg">path</i> does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Search permission is denied for a component of the path prefix of <i class="farg">path</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ELOOP</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating <i class="farg">path</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">buf</i> or <i class="farg">path</i> points to an invalid address.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading from or writing to the file system.</dd>
</dl>
<div class="spacer">
</div>
<b class="fname">fstatfs</b>() fails if one or more of the following are true:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">fd</i> is not a valid open file descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">buf</i> points to an invalid address.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading from or writing to the file system.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/df.html">df(1)</a>, <a class="link-man" href="../html2/getfsstat.html">getfsstat(2)</a>, <a class="link-man" href="../html2/mount.html">mount(2)</a>, <a class="link-man" href="../html2/stat.html">stat(2)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">statfs</b>() function first appeared in <span class="unix">4.4BSD</span>.</div>
</div>
</body>
</html>

