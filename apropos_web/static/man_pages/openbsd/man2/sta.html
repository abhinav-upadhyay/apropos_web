<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
STAT(2)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">stat</b>, <b class="name">lstat</b>, <b class="name">fstatat</b>, <b class="name">fstat</b>, <b class="name">S_ISBLK</b>, <b class="name">S_ISCHR</b>, <b class="name">S_ISDIR</b>, <b class="name">S_ISFIFO</b>, <b class="name">S_ISLNK</b>, <b class="name">S_ISREG</b>, <b class="name">S_ISSOCK</b> &#8212; <span class="desc">get file status</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/stat.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">stat</b>(<i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">struct stat *sb</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">lstat</b>(<i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">struct stat *sb</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">fstat</b>(<i class="farg" style="white-space:nowrap;">int fd</i>, <i class="farg" style="white-space:nowrap;">struct stat *sb</i>);<div class="spacer">
</div>
<b class="includes">#include &lt;<a class="link-includes">sys/stat.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">fcntl.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">fstatat</b>(<i class="farg" style="white-space:nowrap;">int fd</i>, <i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">struct stat *sb</i>, <i class="farg" style="white-space:nowrap;">int flag</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">stat</b>() function obtains information about the file pointed to by <i class="farg">path</i>. Read, write, or execute permission of the named file is not required, but all directories listed in the path name leading to the file must be searchable.<div class="spacer">
</div>
The <b class="fname">lstat</b>() function is identical to <b class="fname">stat</b>() except when the named file is a symbolic link, in which case <b class="fname">lstat</b>() returns information about the link itself, not the file the link references.<div class="spacer">
</div>
The <b class="fname">fstatat</b>() function is equivalent to either the <b class="fname">stat</b>() or <b class="fname">lstat</b>() function depending on the value of <i class="farg">flag</i> (see below), except that where <i class="farg">path</i> specifies a relative path, the file whose information is returned is determined relative to the directory associated with file descriptor <i class="farg">fd</i> instead of the current working directory.<div class="spacer">
</div>
If <b class="fname">fstatat</b>() is passed the special value <span class="define">AT_FDCWD</span> (defined in <b class="includes">&lt;<a class="link-includes">fcntl.h</a>&gt;</b>) in the <i class="farg">fd</i> parameter, the current working directory is used and the behavior is identical to a call to <b class="fname">stat</b>() or <b class="fname">lstat</b>(), depending on whether or not the <span class="define">AT_SYMLINK_NOFOLLOW</span> bit is set in <i class="farg">flag</i>.<div class="spacer">
</div>
The <i class="farg">flag</i> argument is the bitwise OR of zero or more of the following values:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">AT_SYMLINK_NOFOLLOW</span></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
If <i class="farg">path</i> names a symbolic link, then the status of the symbolic link is returned.</dd>
</dl>
<div class="spacer">
</div>
The <b class="fname">fstat</b>() function obtains the same information about an open file known by the file descriptor <i class="farg">fd</i>.<div class="spacer">
</div>
The <i class="farg">sb</i> argument is a pointer to a <b class="fname">stat</b>() structure as defined by <b class="includes">&lt;<a class="link-includes">sys/stat.h</a>&gt;</b> (shown below) and into which information is placed concerning the file.<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
struct stat { 
    dev_t      st_dev;    /* inode's device */ 
    ino_t      st_ino;    /* inode's number */ 
    mode_t     st_mode;   /* inode protection mode */ 
    nlink_t    st_nlink;  /* number of hard links */ 
    uid_t      st_uid;    /* user ID of the file's owner */ 
    gid_t      st_gid;    /* group ID of the file's group */ 
    dev_t      st_rdev;   /* device type */ 
    struct timespec st_atim;  /* time of last access */ 
    struct timespec st_mtim;  /* time of last data modification */ 
    struct timespec st_ctim;  /* time of last file status change */ 
    off_t      st_size;   /* file size, in bytes */ 
    blkcnt_t   st_blocks; /* blocks allocated for file */ 
    blksize_t  st_blksize;/* optimal blocksize for I/O */ 
    u_int32_t  st_flags;  /* user defined flags for file */ 
    u_int32_t  st_gen;    /* file generation number */ 
};</pre>
<div class="spacer">
</div>
The time-related fields of <code class="lit">struct stat</code> are represented in <code class="lit">struct timespec</code> format, which has nanosecond precision. However, the actual precision is generally limited by the file system holding the file. The fields are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">st_atim</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Time when file data was last accessed. Set when the file system object was created and updated by the <a class="link-man" href="../html2/utimes.html">utimes(2)</a> and <a class="link-man" href="../html2/read.html">read(2)</a> system calls.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">st_mtim</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Time when file data was last modified. Changed by the <a class="link-man" href="../html2/truncate.html">truncate(2)</a>, <a class="link-man" href="../html2/utimes.html">utimes(2)</a>, and <a class="link-man" href="../html2/write.html">write(2)</a> system calls. For directories, changed by any system call that alters which files are in the directory, such as the <a class="link-man" href="../html2/unlink.html">unlink(2)</a>, <a class="link-man" href="../html2/rename.html">rename(2)</a>, <a class="link-man" href="../html2/mkdir.html">mkdir(2)</a>, and <a class="link-man" href="../html2/symlink.html">symlink(2)</a> system calls.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">st_ctim</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Time when file status was last changed (inode data modification). Changed by the <a class="link-man" href="../html2/chmod.html">chmod(2)</a>, <a class="link-man" href="../html2/chown.html">chown(2)</a>, <a class="link-man" href="../html2/link.html">link(2)</a>, <a class="link-man" href="../html2/rename.html">rename(2)</a>, <a class="link-man" href="../html2/unlink.html">unlink(2)</a>, <a class="link-man" href="../html2/utimes.html">utimes(2)</a>, and <a class="link-man" href="../html2/write.html">write(2)</a> system calls.</dd>
</dl>
<div class="spacer">
</div>
In addition, all the time fields are set to the current time when a file system object is first created by the <a class="link-man" href="../html2/mkdir.html">mkdir(2)</a>, <a class="link-man" href="../html2/mkfifo.html">mkfifo(2)</a>, <a class="link-man" href="../html2/mknod.html">mknod(2)</a>, <a class="link-man" href="../html2/open.html">open(2)</a>, and <a class="link-man" href="../html2/symlink.html">symlink(2)</a> system calls.<div class="spacer">
</div>
For compatibility with previous standards, <i class="farg">st_atime</i>, <i class="farg">st_mtime</i>, and <i class="farg">st_ctime</i> macros are provided that expand to the <i class="farg">tv_secs</i> member of their respective <code class="lit">struct timespec</code> member. Deprecated macros are also provided for some transitional names: <i class="farg">st_atimensec</i>, <i class="farg">st_mtimensec</i>, <i class="farg">st_ctimensec</i>, <i class="farg">st_atimespec</i>, <i class="farg">st_mtimespec</i>, and <i class="farg">st_ctimespec</i><div class="spacer">
</div>
The size-related fields of the <code class="lit">struct stat</code> are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">st_blksize</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The optimal I/O block size for the file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">st_blocks</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The actual number of blocks allocated for the file in 512-byte units. As short symbolic links are stored in the inode, this number may be zero.</dd>
</dl>
<div class="spacer">
</div>
The status information word <i class="farg">st_mode</i> has the following bits:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
#define S_IFMT   0170000  /* type of file mask */ 
#define S_IFIFO  0010000  /* named pipe (fifo) */ 
#define S_IFCHR  0020000  /* character special */ 
#define S_IFDIR  0040000  /* directory */ 
#define S_IFBLK  0060000  /* block special */ 
#define S_IFREG  0100000  /* regular */ 
#define S_IFLNK  0120000  /* symbolic link */ 
#define S_IFSOCK 0140000  /* socket */ 
#define S_ISUID  0004000  /* set-user-ID on execution */ 
#define S_ISGID  0002000  /* set-group-ID on execution */ 
#define S_ISVTX  0001000  /* save swapped text even after use */ 
#define S_IRWXU  0000700  /* RWX mask for owner */ 
#define S_IRUSR  0000400  /* R for owner */ 
#define S_IWUSR  0000200  /* W for owner */ 
#define S_IXUSR  0000100  /* X for owner */ 
#define S_IRWXG  0000070  /* RWX mask for group */ 
#define S_IRGRP  0000040  /* R for group */ 
#define S_IWGRP  0000020  /* W for group */ 
#define S_IXGRP  0000010  /* X for group */ 
#define S_IRWXO  0000007  /* RWX mask for other */ 
#define S_IROTH  0000004  /* R for other */ 
#define S_IWOTH  0000002  /* W for other */ 
#define S_IXOTH  0000001  /* X for other */</pre>
<div class="spacer">
</div>
The following macros test a file's type. If the file is of that type, a non-zero value is returned; otherwise, 0 is returned.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
S_ISBLK(st_mode m)  /* block special */ 
S_ISCHR(st_mode m)  /* char special */ 
S_ISDIR(st_mode m)  /* directory */ 
S_ISFIFO(st_mode m) /* fifo */ 
S_ISLNK(st_mode m)  /* symbolic link */ 
S_ISREG(st_mode m)  /* regular file */ 
S_ISSOCK(st_mode m) /* socket */</pre>
<div class="spacer">
</div>
For a list of access modes, see <b class="includes">&lt;<a class="link-includes">sys/stat.h</a>&gt;</b>, <a class="link-man" href="../html2/access.html">access(2)</a>, and <a class="link-man" href="../html2/chmod.html">chmod(2)</a>.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, the value&#160;0 is returned; otherwise the value&#160;-1 is returned and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">stat</b>(), <b class="fname">lstat</b>(), and <b class="fname">fstatat</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of the path prefix is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENAMETOOLONG</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded <span class="define">NAME_MAX</span> characters, or an entire pathname (including the terminating NUL) exceeded <span class="define">PATH_MAX</span> bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOENT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of <span class="emph">name</span> does not exist or <span class="emph">name</span> is the empty path.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Search permission is denied for a component of the path prefix.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ELOOP</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating the pathname.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">sb</i> or <span class="emph">name</span> points to an invalid address.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading from or writing to the file system.</dd>
</dl>
<div class="spacer">
</div>
Additionally, <b class="fname">fstatat</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EINVAL</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The value of the <i class="farg">flag</i> argument was neither zero nor <span class="define">AT_SYMLINK_NOFOLLOW</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument specifies a relative path and the <i class="farg">fd</i> argument is neither <span class="define">AT_FDCWD</span> nor a valid file descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">ENOTDIR</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument specifies a relative path and the <i class="farg">fd</i> argument is a valid file descriptor but it does not reference a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EACCES</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument specifies a relative path but search permission is denied for the directory which the <i class="farg">fd</i> file descriptor references.</dd>
</dl>
<div class="spacer">
</div>
<b class="fname">fstat</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EBADF</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">fd</i> is not a valid open file descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EFAULT</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">sb</i> points to an invalid address.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
[<span class="errno">EIO</span>]</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading from the file system.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/chmod.html">chmod(2)</a>, <a class="link-man" href="../html2/chown.html">chown(2)</a>, <a class="link-man" href="../html2/clock_gettime.html">clock_gettime(2)</a>, <a class="link-man" href="../html2/utimes.html">utimes(2)</a>, <a class="link-man" href="../html7/symlink.html">symlink(7)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> Previous versions of the system used different types for the <i class="farg">st_dev</i>, <i class="farg">st_uid</i>, <i class="farg">st_gid</i>, <i class="farg">st_rdev</i>, <i class="farg">st_size</i>, <i class="farg">st_blksize</i>, and <i class="farg">st_blocks</i> fields.<div class="spacer">
</div>
The <b class="fname">fstat</b>(), <b class="fname">fstatat</b>(), <b class="fname">lstat</b>(), and <b class="fname">stat</b>() functions are intended to conform to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">stat</b>() and <b class="fname">fstat</b>() system calls first appeared in Version&#160;1 AT&amp;T UNIX. The <b class="includes">&lt;<a class="link-includes">sys/stat.h</a>&gt;</b> header file and the <span class="type">struct stat</span> were introduced in Version&#160;7 AT&amp;T UNIX.<div class="spacer">
</div>
An <b class="fname">lstat</b>() function call appeared in <span class="unix">4.2BSD</span>. The <b class="fname">fstatat</b>() function appeared in <span class="unix">OpenBSD&#160;5.0</span>.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> The file generation number, <i class="farg">st_gen</i>, is only available to the superuser.<div class="spacer">
</div>
Certain programs written when the timestamps were just of type <code class="lit">time_t</code> assumed that the members were consecutive (and could therefore be treated as an array and have their address passed directly to <a class="link-man" href="../html3/utime.html">utime(3)</a>). The transition to timestamps of type <code class="lit">struct timespec</code> broke them irrevocably.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Applying <b class="fname">fstat</b>() to a pipe or socket fails to fill in a unique device and inode number pair. Applying <b class="fname">fstat</b>() to a socket also fails to fill in the time fields.</div>
</div>
</body>
</html>

