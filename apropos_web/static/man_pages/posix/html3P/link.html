<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of LINK</TITLE>
</HEAD><BODY>
<H1>LINK</H1>
Section: POSIX Programmer's Manual (3P)<BR>Updated: 2003<BR><A HREF="#index">Index</A>
<A HREF="/cgi-bin/man/man2html">Return to Main Contents</A><HR>


<A NAME="lbAB">&nbsp;</A>
<H2>PROLOG</H2>

This manual page is part of the POSIX Programmer's Manual.
The Linux implementation of this interface may differ (consult
the corresponding Linux manual page for details of Linux behavior),
or the interface may not be implemented on Linux.
<A NAME="lbAC">&nbsp;</A>
<H2>NAME</H2>

link - link to a file
<A NAME="lbAD">&nbsp;</A>
<H2>SYNOPSIS</H2>

<P>

<B>#include &lt;<A HREF="file:///usr/include/unistd.h">unistd.h</A>&gt;
<BR>

<P>
int link(const char *</B><I>path1</I><B>, const char *</B><I>path2</I><B>);
<BR>

</B>
<A NAME="lbAE">&nbsp;</A>
<H2>DESCRIPTION</H2>

<P>

The <I>link</I>() function shall create a new link (directory entry)
for the existing file, <I>path1</I>.
<P>

The <I>path1</I> argument points to a pathname naming an existing file.
The <I>path2</I> argument points to a pathname naming
the new directory entry to be created. The <I>link</I>() function shall
atomically create a new link for the existing file and the
link count of the file shall be incremented by one.
<P>

If <I>path1</I> names a directory, <I>link</I>() shall fail unless the
process has appropriate privileges and the implementation
supports using <I>link</I>() on directories.
<P>

Upon successful completion, <I>link</I>() shall mark for update the
<I>st_ctime</I> field of the file. Also, the <I>st_ctime</I>
and <I>st_mtime</I> fields of the directory that contains the new entry
shall be marked for update.
<P>

If <I>link</I>() fails, no link shall be created and the link count
of the file shall remain unchanged.
<P>

The implementation may require that the calling process has permission
to access the existing file.
<A NAME="lbAF">&nbsp;</A>
<H2>RETURN VALUE</H2>

<P>

Upon successful completion, 0 shall be returned. Otherwise, -1 shall
be returned and <I>errno</I> set to indicate the error.
<A NAME="lbAG">&nbsp;</A>
<H2>ERRORS</H2>

<P>

The <I>link</I>() function shall fail if:
<DL COMPACT>
<DT><B>EACCES</B>

<DD>
A component of either path prefix denies search permission, or the
requested link requires writing in a directory that denies
write permission, or the calling process does not have permission
to access the existing file and this is required by the
implementation.
<DT><B>EEXIST</B>

<DD>
The <I>path2</I> argument resolves to an existing file or refers to
a symbolic link.
<DT><B>ELOOP</B>

<DD>
A loop exists in symbolic links encountered during resolution of the
<I>path1</I> or <I>path2</I> argument.
<DT><B>EMLINK</B>

<DD>
The number of links to the file named by <I>path1</I> would exceed
{LINK_MAX}.
<DT><B>ENAMETOOLONG</B>

<DD>
The length of the <I>path1</I> or <I>path2</I> argument exceeds {PATH_MAX}
or a pathname component is longer than {NAME_MAX}.
<DT><B>ENOENT</B>

<DD>
A component of either path prefix does not exist; the file named by
<I>path1</I> does not exist; or <I>path1</I> or
<I>path2</I> points to an empty string.
<DT><B>ENOSPC</B>

<DD>
The directory to contain the link cannot be extended.
<DT><B>ENOTDIR</B>

<DD>
A component of either path prefix is not a directory.
<DT><B>EPERM</B>

<DD>
The file named by <I>path1</I> is a directory and either the calling
process does not have appropriate privileges or the
implementation prohibits using <I>link</I>() on directories.
<DT><B>EROFS</B>

<DD>
The requested link requires writing in a directory on a read-only
file system.
<DT><B>EXDEV</B>

<DD>
The link named by <I>path2</I> and the file named by <I>path1</I> are
on different file systems and the implementation does not
support links between file systems.
<DT><B>EXDEV</B>

<DD>
<I>path1</I> refers to a named STREAM. 
<P>
</DL>
<P>

The <I>link</I>() function may fail if:
<DL COMPACT>
<DT><B>ELOOP</B>

<DD>
More than {SYMLOOP_MAX} symbolic links were encountered during resolution
of the <I>path1</I> or <I>path2</I> argument.
<DT><B>ENAMETOOLONG</B>

<DD>
As a result of encountering a symbolic link in resolution of the <I>path1</I>
or <I>path2</I> argument, the length of the
substituted pathname string exceeded {PATH_MAX}.
<P>
</DL>
<P>

<I>The following sections are informative.</I>
<A NAME="lbAH">&nbsp;</A>
<H2>EXAMPLES</H2>

<A NAME="lbAI">&nbsp;</A>
<H3>Creating a Link to a File</H3>

<P>

The following example shows how to create a link to a file named <B>/home/cnd/mod1</B>
by creating a new directory entry named
<B>/modules/pass1</B>.
<P>
<DL COMPACT><DT><DD>
<PRE>

<B>#include &lt;<A HREF="file:///usr/include/unistd.h">unistd.h</A>&gt;


char *path1 = &quot;/home/cnd/mod1&quot;;
char *path2 = &quot;/modules/pass1&quot;;
int   status;
...
status = link (path1, path2);
</B>
</PRE>

</DL>

<A NAME="lbAJ">&nbsp;</A>
<H3>Creating a Link to a File Within a Program</H3>

<P>

In the following program example, the <I>link</I>() function links
the <B>/etc/passwd</B> file (defined as <B>PASSWDFILE</B>) to
a file named <B>/etc/opasswd</B> (defined as <B>SAVEFILE</B>), which
is used to save the current password file. Then, after
removing the current password file (defined as <B>PASSWDFILE</B>),
the new password file is saved as the current password file
using the <I>link</I>() function again.
<P>
<DL COMPACT><DT><DD>
<PRE>

<B>#include &lt;<A HREF="file:///usr/include/unistd.h">unistd.h</A>&gt;


#define LOCKFILE &quot;/etc/ptmp&quot;
#define PASSWDFILE &quot;/etc/passwd&quot;
#define SAVEFILE &quot;/etc/opasswd&quot;
...
/* Save current password file */
link (PASSWDFILE, SAVEFILE);


/* Remove current password file. */
unlink (PASSWDFILE);


/* Save new password file as current password file. */
link (LOCKFILE,PASSWDFILE);
</B>
</PRE>

</DL>

<A NAME="lbAK">&nbsp;</A>
<H2>APPLICATION USAGE</H2>

<P>

Some implementations do allow links between file systems.
<A NAME="lbAL">&nbsp;</A>
<H2>RATIONALE</H2>

<P>

Linking to a directory is restricted to the superuser in most historical
implementations because this capability may produce
loops in the file hierarchy or otherwise corrupt the file system.
This volume of IEEE&nbsp;Std&nbsp;1003.1-2001 continues that
philosophy by prohibiting <I>link</I>() and <I>unlink</I>() from doing
this. Other functions
could do it if the implementor designed such an extension.
<P>

Some historical implementations allow linking of files on different
file systems. Wording was added to explicitly allow this
optional behavior.
<P>

The exception for cross-file system links is intended to apply only
to links that are programmatically indistinguishable from
&quot;hard&quot; links.
<A NAME="lbAM">&nbsp;</A>
<H2>FUTURE DIRECTIONS</H2>

<P>

None.
<A NAME="lbAN">&nbsp;</A>
<H2>SEE ALSO</H2>

<P>

<I>symlink</I>(), <I>unlink</I>(), the Base Definitions volume of
IEEE&nbsp;Std&nbsp;1003.1-2001, <I>&lt;<A HREF="file:///usr/include/unistd.h">unistd.h</A>&gt;</I>
<A NAME="lbAO">&nbsp;</A>
<H2>COPYRIGHT</H2>

Portions of this text are reprinted and reproduced in electronic form
from IEEE Std 1003.1, 2003 Edition, Standard for Information Technology
-- Portable Operating System Interface (POSIX), The Open Group Base
Specifications Issue 6, Copyright (C) 2001-2003 by the Institute of
Electrical and Electronics Engineers, Inc and The Open Group. In the
event of any discrepancy between this version and the original IEEE and
The Open Group Standard, the original IEEE and The Open Group Standard
is the referee document. The original Standard can be obtained online at
<A HREF="http://www.opengroup.org/unix/online.html">http://www.opengroup.org/unix/online.html</A> .
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">PROLOG</A><DD>
<DT><A HREF="#lbAC">NAME</A><DD>
<DT><A HREF="#lbAD">SYNOPSIS</A><DD>
<DT><A HREF="#lbAE">DESCRIPTION</A><DD>
<DT><A HREF="#lbAF">RETURN VALUE</A><DD>
<DT><A HREF="#lbAG">ERRORS</A><DD>
<DT><A HREF="#lbAH">EXAMPLES</A><DD>
<DL>
<DT><A HREF="#lbAI">Creating a Link to a File</A><DD>
<DT><A HREF="#lbAJ">Creating a Link to a File Within a Program</A><DD>
</DL>
<DT><A HREF="#lbAK">APPLICATION USAGE</A><DD>
<DT><A HREF="#lbAL">RATIONALE</A><DD>
<DT><A HREF="#lbAM">FUTURE DIRECTIONS</A><DD>
<DT><A HREF="#lbAN">SEE ALSO</A><DD>
<DT><A HREF="#lbAO">COPYRIGHT</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 12:41:35 GMT, April 18, 2016
</BODY>
</HTML>
