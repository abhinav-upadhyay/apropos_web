<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of POSIX_OPENPT</TITLE>
</HEAD><BODY>
<H1>POSIX_OPENPT</H1>
Section: POSIX Programmer's Manual (3P)<BR>Updated: 2003<BR><A HREF="#index">Index</A>
<A HREF="/cgi-bin/man/man2html">Return to Main Contents</A><HR>


<A NAME="lbAB">&nbsp;</A>
<H2>PROLOG</H2>

This manual page is part of the POSIX Programmer's Manual.
The Linux implementation of this interface may differ (consult
the corresponding Linux manual page for details of Linux behavior),
or the interface may not be implemented on Linux.
<A NAME="lbAC">&nbsp;</A>
<H2>NAME</H2>

posix_openpt - open a pseudo-terminal device
<A NAME="lbAD">&nbsp;</A>
<H2>SYNOPSIS</H2>

<P>

<B>#include &lt;<A HREF="file:///usr/include/stdlib.h">stdlib.h</A>&gt;
<BR>

#include &lt;<A HREF="file:///usr/include/fcntl.h">fcntl.h</A>&gt;
<BR>

<P>
int posix_openpt(int</B> <I>oflag</I><B>); </B>
<B>
<BR>

</B>
<A NAME="lbAE">&nbsp;</A>
<H2>DESCRIPTION</H2>

<P>

The <I>posix_openpt</I>() function shall establish a connection between
a master device for a pseudo-terminal and a file
descriptor. The file descriptor is used by other I/O functions that
refer to that pseudo-terminal.
<P>

The file status flags and file access modes of the open file description
shall be set according to the value of
<I>oflag</I>.
<P>

Values for <I>oflag</I> are constructed by a bitwise-inclusive OR of
flags from the following list, defined in <I>&lt;<A HREF="file:///usr/include/fcntl.h">fcntl.h</A>&gt;</I>:
<DL COMPACT>
<DT>O_RDWR<DD>
Open for reading and writing.
<DT>O_NOCTTY<DD>
If set <I>posix_openpt</I>() shall not cause the terminal device to
become the controlling terminal for the process.
<P>
</DL>
<P>

The behavior of other values for the <I>oflag</I> argument is unspecified.
<A NAME="lbAF">&nbsp;</A>
<H2>RETURN VALUE</H2>

<P>

Upon successful completion, the <I>posix_openpt</I>() function shall
open a master pseudo-terminal device and return a
non-negative integer representing the lowest numbered unused file
descriptor. Otherwise, -1 shall be returned and <I>errno</I> set
to indicate the error.
<A NAME="lbAG">&nbsp;</A>
<H2>ERRORS</H2>

<P>

The <I>posix_openpt</I>() function shall fail if:
<DL COMPACT>
<DT><B>EMFILE</B>

<DD>
{OPEN_MAX} file descriptors are currently open in the calling process.
<DT><B>ENFILE</B>

<DD>
The maximum allowable number of files is currently open in the system.
<P>
</DL>
<P>

The <I>posix_openpt</I>() function may fail if:
<DL COMPACT>
<DT><B>EINVAL</B>

<DD>
The value of <I>oflag</I> is not valid.
<DT><B>EAGAIN</B>

<DD>
Out of pseudo-terminal resources.
<DT><B>ENOSR</B>

<DD>
Out of STREAMS resources. 
<P>
</DL>
<P>

<I>The following sections are informative.</I>
<A NAME="lbAH">&nbsp;</A>
<H2>EXAMPLES</H2>

<A NAME="lbAI">&nbsp;</A>
<H3>Opening a Pseudo-Terminal and Returning the Name of the Slave</H3>

Device and a File Descriptor
<P>
<DL COMPACT><DT><DD>
<PRE>

<B>#include &lt;<A HREF="file:///usr/include/fcntl.h">fcntl.h</A>&gt;
#include &lt;<A HREF="file:///usr/include/stdio.h">stdio.h</A>&gt;


int masterfd, slavefd;
char *slavedevice;


masterfd = posix_openpt(O_RDWR|O_NOCTTY);


if (masterfd == -1
    || grantpt (masterfd) == -1
    || unlockpt (masterfd) == -1
    || (slavedevice = ptsname (masterfd)) == NULL)
    return -1;


printf(&quot;slave device is: %s\n&quot;, slavedevice);


slavefd = open(slave, O_RDWR|O_NOCTTY);
if (slavefd &lt; 0)
    return -1;
</B>
</PRE>

</DL>

<A NAME="lbAJ">&nbsp;</A>
<H2>APPLICATION USAGE</H2>

<P>

This function is a method for portably obtaining a file descriptor
of a master terminal device for a pseudo-terminal. The <I>grantpt</I>()
and <I>ptsname</I>() functions can be
used to manipulate mode and ownership permissions, and to obtain the
name of the slave device, respectively.
<A NAME="lbAK">&nbsp;</A>
<H2>RATIONALE</H2>

<P>

The standard developers considered the matter of adding a special
device for cloning master pseudo-terminals: the
<B>/dev/ptmx</B> device. However, consensus could not be reached, and
it was felt that adding a new function would permit other
implementations. The <I>posix_openpt</I>() function is designed to
complement the <I>grantpt</I>(), <I>ptsname</I>(), and <I>unlockpt</I>()
functions.
<P>

On implementations supporting the <B>/dev/ptmx</B> clone device, opening
the master device of a pseudo-terminal is simply:
<P>
<DL COMPACT><DT><DD>
<PRE>

<B>mfdp = open(&quot;/dev/ptmx&quot;, oflag );
if (mfdp &lt; 0)
    return -1;
</B>
</PRE>

</DL>

<A NAME="lbAL">&nbsp;</A>
<H2>FUTURE DIRECTIONS</H2>

<P>

None.
<A NAME="lbAM">&nbsp;</A>
<H2>SEE ALSO</H2>

<P>

<I>grantpt</I>(), <I>open</I>(), <I>ptsname</I>(), <I>unlockpt</I>(),
the Base Definitions volume of
IEEE&nbsp;Std&nbsp;1003.1-2001, <I>&lt;<A HREF="file:///usr/include/fcntl.h">fcntl.h</A>&gt;</I>
<A NAME="lbAN">&nbsp;</A>
<H2>COPYRIGHT</H2>

Portions of this text are reprinted and reproduced in electronic form
from IEEE Std 1003.1, 2003 Edition, Standard for Information Technology
-- Portable Operating System Interface (POSIX), The Open Group Base
Specifications Issue 6, Copyright (C) 2001-2003 by the Institute of
Electrical and Electronics Engineers, Inc and The Open Group. In the
event of any discrepancy between this version and the original IEEE and
The Open Group Standard, the original IEEE and The Open Group Standard
is the referee document. The original Standard can be obtained online at
<A HREF="http://www.opengroup.org/unix/online.html">http://www.opengroup.org/unix/online.html</A> .
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">PROLOG</A><DD>
<DT><A HREF="#lbAC">NAME</A><DD>
<DT><A HREF="#lbAD">SYNOPSIS</A><DD>
<DT><A HREF="#lbAE">DESCRIPTION</A><DD>
<DT><A HREF="#lbAF">RETURN VALUE</A><DD>
<DT><A HREF="#lbAG">ERRORS</A><DD>
<DT><A HREF="#lbAH">EXAMPLES</A><DD>
<DL>
<DT><A HREF="#lbAI">Opening a Pseudo-Terminal and Returning the Name of the Slave</A><DD>
</DL>
<DT><A HREF="#lbAJ">APPLICATION USAGE</A><DD>
<DT><A HREF="#lbAK">RATIONALE</A><DD>
<DT><A HREF="#lbAL">FUTURE DIRECTIONS</A><DD>
<DT><A HREF="#lbAM">SEE ALSO</A><DD>
<DT><A HREF="#lbAN">COPYRIGHT</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 12:41:34 GMT, April 18, 2016
</BODY>
</HTML>
