<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
GETOPT(3P)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
GETOPT(3P)</td>
<td class="head-vol">
POSIX Programmer's Manual</td>
<td class="head-rtitle">
GETOPT(3P)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>PROLOG</h1> This manual page is part of the POSIX Programmer's Manual. The Linux implementation of this interface may differ (consult the corresponding Linux manual page for details of Linux behavior), or the interface may not be implemented on Linux.</div>
<div class="section">
<h1>NAME</h1> getopt, optarg, opterr, optind, optopt - command option parsing</div>
<div class="section">
<h1>SYNOPSIS</h1>  <b>#include &lt;unistd.h&gt;</b><div style="height: 0.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
int getopt(int<b> </b><i>argc</i><b></b><b>, char * const</b><b> </b><i>argv</i><b></b><b>[],</b>  <b>const char *</b><b></b><i>optstring</i><b></b><b>);</b><div style="height: 0.00em;">
&#160;</div>
extern char *optarg;<div style="height: 0.00em;">
&#160;</div>
extern int optind, opterr, optopt;<div style="height: 0.00em;">
&#160;</div>
<b></b></div>
<div class="section">
<h1>DESCRIPTION</h1> The  <i>getopt</i>() function is a command-line parser that shall follow Utility Syntax Guidelines 3, 4, 5, 6, 7, 9, and 10 in the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001, Section 12.2, Utility Syntax Guidelines.<div class="spacer">
</div>
The parameters <i>argc</i> and <i>argv</i> are the argument count and argument array as passed to  <i>main</i>() (see <i>exec</i>()). The argument  <i>optstring</i> is a string of recognized option characters; if a character is followed by a colon, the option takes an argument. All option characters allowed by Utility Syntax Guideline 3 are allowed in  <i>optstring</i>. The implementation may accept other characters as an extension.<div class="spacer">
</div>
The variable <i>optind</i> is the index of the next element of the  <i>argv</i>[] vector to be processed. It shall be initialized to 1 by the system, and  <i>getopt</i>() shall update it when it finishes with each element of  <i>argv</i>[]. When an element of  <i>argv</i>[] contains multiple option characters, it is unspecified how  <i>getopt</i>() determines which options have already been processed.<div class="spacer">
</div>
The <i>getopt</i>() function shall return the next option character (if one is found) from  <i>argv</i> that matches a character in  <i>optstring</i>, if there is one that matches. If the option takes an argument,  <i>getopt</i>() shall set the variable  <i>optarg</i> to point to the option-argument as follows:<dl>
<dt>
 1.</dt>
<dd>
If the option was the last character in the string pointed to by an element of  <i>argv</i>, then <i>optarg</i> shall contain the next element of  <i>argv</i>, and <i>optind</i> shall be incremented by 2. If the resulting value of  <i>optind</i> is greater than  <i>argc</i>, this indicates a missing option-argument, and <i>getopt</i>() shall return an error indication.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Otherwise, <i>optarg</i> shall point to the string following the option character in that element of  <i>argv</i>, and  <i>optind</i> shall be incremented by 1.</dd>
</dl>
<div class="spacer">
</div>
If, when <i>getopt</i>() is called:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<i>argv</i><b>[optind]</b>  is a null pointer<b>*</b><br/>
<i>argv</i><b>[optind]</b>  is not the character <b>- </b> <br/>
<i>argv</i><b>[optind]</b>  points to the string <b>&quot;-&quot;</b><br/>
</div>
<div class="spacer">
</div>
<i>getopt</i>() shall return -1 without changing <i>optind</i>. If:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<i>argv</i><b>[optind] </b>  points to the string <b>&quot;--&quot;</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
<i>getopt</i>() shall return -1 after incrementing <i>optind</i>.<div class="spacer">
</div>
If <i>getopt</i>() encounters an option character that is not contained in  <i>optstring</i>, it shall return the question-mark (  <b>'?'</b> ) character. If it detects a missing option-argument, it shall return the colon character (  <b>':'</b> ) if the first character of  <i>optstring</i> was a colon, or a question-mark character (  <b>'?'</b> ) otherwise. In either case,  <i>getopt</i>() shall set the variable <i>optopt</i> to the option character that caused the error. If the application has not set the variable  <i>opterr</i> to 0 and the first character of <i>optstring</i> is not a colon,  <i>getopt</i>() shall also print a diagnostic message to  <i>stderr</i> in the format specified for the  <i>getopts</i> utility.<div class="spacer">
</div>
The <i>getopt</i>() function need not be reentrant. A function that is not required to be reentrant is not required to be thread-safe.</div>
<div class="section">
<h1>RETURN VALUE</h1> The  <i>getopt</i>() function shall return the next option character specified on the command line.<div class="spacer">
</div>
A colon ( <b>':'</b> ) shall be returned if <i>getopt</i>() detects a missing argument and the first character of  <i>optstring</i> was a colon ( <b>':'</b> ).<div class="spacer">
</div>
A question mark ( <b>'?'</b> ) shall be returned if <i>getopt</i>() encounters an option character not in  <i>optstring</i> or detects a missing argument and the first character of  <i>optstring</i> was not a colon (  <b>':'</b> ).<div class="spacer">
</div>
Otherwise, <i>getopt</i>() shall return -1 when all command line options are parsed.</div>
<div class="section">
<h1>ERRORS</h1> No errors are defined.<div class="spacer">
</div>
<i>The following sections are informative.</i></div>
<div class="section">
<h1>EXAMPLES</h1><div class="subsection">
<h2>Parsing Command Line Options</h2> The following code fragment shows how you might process the arguments for a utility that can take the mutually-exclusive options  <i>a</i> and <i>b</i> and the options <i>f</i> and <i>o</i>, both of which require arguments:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>#include &lt;unistd.h&gt;</b><div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
int<br/>
main(int argc, char *argv[ ])<br/>
{<br/>
    int c;<br/>
    int bflg, aflg, errflg;<br/>
    char *ifile;<br/>
    char *ofile;<br/>
    extern char *optarg;<br/>
    extern int optind, optopt;<br/>
    . . .<br/>
    while ((c = getopt(argc, argv, &quot;:abf:o:&quot;)) != -1) {<br/>
        switch(c) {<br/>
        case 'a':<br/>
            if (bflg)<br/>
                errflg++;<br/>
            else<br/>
                aflg++;<br/>
            break;<br/>
        case 'b':<br/>
            if (aflg)<br/>
                errflg++;<br/>
            else {<br/>
                bflg++;<br/>
                bproc();<br/>
            }<br/>
            break;<br/>
        case 'f':<br/>
            ifile = optarg;<br/>
            break;<br/>
        case 'o':<br/>
            ofile = optarg;<br/>
            break;<br/>
            case ':':       /* -f or -o without operand */<br/>
                    fprintf(stderr,<br/>
                            &quot;Option -%c requires an operand\n&quot;, optopt);<br/>
                    errflg++;<br/>
                    break;<br/>
        case '?':<br/>
                    fprintf(stderr,<br/>
                            &quot;Unrecognized option: -%c\n&quot;, optopt);<br/>
            errflg++;<br/>
        }<br/>
    }<br/>
    if (errflg) {<br/>
        fprintf(stderr, &quot;usage: . . . &quot;);<br/>
        exit(2);<br/>
    }<br/>
    for ( ; optind &lt; argc; optind++) {<br/>
        if (access(argv[optind], R_OK)) {<br/>
    . . .<br/>
}<br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
This code accepts any of the following as equivalent:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>cmd -ao arg path path</b><br/>
<b>cmd -a -o arg path path</b><br/>
<b>cmd -o arg -a path path</b><br/>
<b>cmd -a -o arg -- path path</b><br/>
<b>cmd -a -oarg path path</b><br/>
<b>cmd -aoarg path path</b><br/>
<b></b><br/>
</div>
</div>
<div class="subsection">
<h2>Checking Options and Arguments</h2> The following example parses a set of command line options and prints messages to standard output for each option and argument that it encounters.<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>#include &lt;unistd.h&gt;</b><br/>
<b>#include &lt;stdio.h&gt;</b><br/>
<b>...</b><br/>
<b>int c;</b><br/>
<b>char *filename;</b><br/>
<b>extern char *optarg;</b><br/>
<b>extern int optind, optopt, opterr;</b><br/>
<b>...</b><br/>
<b>while ((c = getopt(argc, argv, &quot;:abf:&quot;)) != -1) {</b><br/>
<b>    switch(c) {</b><br/>
<b>    case 'a':</b><br/>
<b>        printf(&quot;a is set\n&quot;);</b><br/>
<b>        break;</b><br/>
<b>    case 'b':</b><br/>
<b>        printf(&quot;b is set\n&quot;);</b><br/>
<b>        break;</b><br/>
<b>    case 'f':</b><br/>
<b>        filename = optarg;</b><br/>
<b>        printf(&quot;filename is %s\n&quot;, filename);</b><br/>
<b>        break;</b><br/>
<b>    case ':':</b><br/>
<b>        printf(&quot;-%c without filename\n&quot;, optopt);</b><br/>
<b>        break;</b><br/>
<b>    case '?':</b><br/>
<b>        printf(&quot;unknown arg %c\n&quot;, optopt);</b><br/>
<b>        break;</b><br/>
<b>    }</b><br/>
<b>}</b><br/>
<b></b><br/>
</div>
</div>
<div class="subsection">
<h2>Selecting Options from the Command Line</h2> The following example selects the type of database routines the user wants to use based on the  <i>Options</i> argument.<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>#include &lt;unistd.h&gt;</b><br/>
<b>#include &lt;string.h&gt;</b><br/>
<b>...</b><br/>
<b>char *Options = &quot;hdbtl&quot;;</b><br/>
<b>...</b><br/>
<b>int dbtype, i;</b><br/>
<b>char c;</b><br/>
<b>char *st;</b><br/>
<b>...</b><br/>
<b>dbtype = 0;</b><br/>
<b>while ((c = getopt(argc, argv, Options)) != -1) {</b><br/>
<b>    if ((st = strchr(Options, c)) != NULL) {</b><br/>
<b>        dbtype = st - Options;</b><br/>
<b>        break;</b><br/>
<b>    }</b><br/>
<b>}</b><br/>
<b></b><br/>
</div>
</div>
</div>
<div class="section">
<h1>APPLICATION USAGE</h1> The  <i>getopt</i>() function is only required to support option characters included in Utility Syntax Guideline 3. Many historical implementations of  <i>getopt</i>() support other characters as options. This is an allowed extension, but applications that use extensions are not maximally portable. Note that support for multi-byte option characters is only possible when such characters can be represented as type  <b>int</b>.</div>
<div class="section">
<h1>RATIONALE</h1> The  <i>optopt</i> variable represents historical practice and allows the application to obtain the identity of the invalid option.<div class="spacer">
</div>
The description has been written to make it clear that <i>getopt</i>(), like the  <i>getopts</i> utility, deals with option-arguments whether separated from the option by &lt;blank&gt;s or not. Note that the requirements on  <i>getopt</i>() and  <i>getopts</i> are more stringent than the Utility Syntax Guidelines.<div class="spacer">
</div>
The <i>getopt</i>() function shall return -1, rather than EOF, so that  <i>&lt;stdio.h&gt;</i> is not required.<div class="spacer">
</div>
The special significance of a colon as the first character of <i>optstring</i> makes  <i>getopt</i>() consistent with the <i>getopts</i> utility. It allows an application to make a distinction between a missing argument and an incorrect option letter without having to examine the option letter. It is true that a missing argument can only be detected in one case, but that is a case that has to be considered.</div>
<div class="section">
<h1>FUTURE DIRECTIONS</h1> None.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>exec</i>(), the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001,  <i>&lt;unistd.h&gt;</i>, the Shell and Utilities volume of IEEE&#160;Std&#160;1003.1-2001</div>
<div class="section">
<h1>COPYRIGHT</h1> Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1, 2003 Edition, Standard for Information Technology -- Portable Operating System Interface (POSIX), The Open Group Base Specifications Issue 6, Copyright (C) 2001-2003 by the Institute of Electrical and Electronics Engineers, Inc and The Open Group. In the event of any discrepancy between this version and the original IEEE and The Open Group Standard, the original IEEE and The Open Group Standard is the referee document. The original Standard can be obtained online at http://www.opengroup.org/unix/online.html .</div>
<table class="foot">
<tr>
<td class="foot-date">
2003</td>
<td class="foot-os">
IEEE/The Open Group</td>
</tr>
</table>
</div>
</body>
</html>

