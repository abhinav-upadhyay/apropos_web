<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/posix/style.css" type="text/css" media="all"/>
<title>
EX(1P)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
EX(1P)</td>
<td class="head-vol">
POSIX Programmer's Manual</td>
<td class="head-rtitle">
EX(1P)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>PROLOG</h1> This manual page is part of the POSIX Programmer's Manual. The Linux implementation of this interface may differ (consult the corresponding Linux manual page for details of Linux behavior), or the interface may not be implemented on Linux.</div>
<div class="section">
<h1>NAME</h1> ex - text editor</div>
<div class="section">
<h1>SYNOPSIS</h1>  <b>ex</b> <b>[</b><b>-rR</b><b>][</b><b>-s | -v</b><b>][</b><b>-c</b>  <i>command</i><b>][</b><b>-t</b> <i>tagstring</i><b>][</b><b>-w</b> <i>size</i><b>][</b><i>file</i>  <b>...</b><b>]</b><b></b></div>
<div class="section">
<h1>DESCRIPTION</h1> The  <i>ex</i> utility is a line-oriented text editor. There are two other modes of the editor-open and visual-in which screen-oriented editing is available. This is described more fully by the  <i>ex</i> <b>open</b> and <b>visual</b> commands and in  <i>vi</i> .<div class="spacer">
</div>
This section uses the term <i>edit buffer</i> to describe the current working text. No specific implementation is implied by this term. All editing changes are performed on the edit buffer, and no changes to it shall affect any file until an editor command writes the file.<div class="spacer">
</div>
Certain terminals do not have all the capabilities necessary to support the complete  <i>ex</i> definition, such as the full-screen editing commands (  <i>visual mode</i> or <i>open mode</i>). When these commands cannot be supported on such terminals, this condition shall not produce an error message such as &quot;not an editor command&quot; or report a syntax error. The implementation may either accept the commands and produce results on the screen that are the result of an unsuccessful attempt to meet the requirements of this volume of IEEE&#160;Std&#160;1003.1-2001 or report an error describing the terminal-related deficiency.</div>
<div class="section">
<h1>OPTIONS</h1> The  <i>ex</i> utility shall conform to the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001, Section 12.2, Utility Syntax Guidelines.<div class="spacer">
</div>
The following options shall be supported:<dl>
<dt>
<b>-c&#160;</b> <i>command</i></dt>
<dd>
Specify an initial command to be executed in the first edit buffer loaded from an existing file (see the EXTENDED DESCRIPTION section). Implementations may support more than a single  <b>-c</b> option. In such implementations, the specified commands shall be executed in the order specified on the command line.</dd>
</dl>
<dl>
<dt>
<b>-r</b></dt>
<dd>
Recover the named files (see the EXTENDED DESCRIPTION section). Recovery information for a file shall be saved during an editor or system crash (for example, when the editor is terminated by a signal which the editor can catch), or after the use of an  <i>ex</i> <b>preserve</b> command.</dd>
</dl>
<div class="spacer">
</div>
A <i>crash</i> in this context is an unexpected failure of the system or utility that requires restarting the failed system or utility. A system crash implies that any utilities running at the time also crash. In the case of an editor or system crash, the number of changes to the edit buffer (since the most recent  <b>preserve</b> command) that will be recovered is unspecified.<div class="spacer">
</div>
If no <i>file</i> operands are given and the <b>-t</b> option is not specified, all other options, the  <i>EXINIT</i> variable, and any  <b>.exrc</b> files shall be ignored; a list of all recoverable files available to the invoking user shall be written, and the editor shall exit normally without further action.<dl>
<dt>
<b>-R</b></dt>
<dd>
Set <b>readonly</b> edit option.</dd>
</dl>
<dl>
<dt>
<b>-s</b></dt>
<dd>
Prepare <i>ex</i> for batch use by taking the following actions:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 *</dt>
<dd>
Suppress writing prompts and informational (but not diagnostic) messages.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
Ignore the value of <i>TERM</i> and any implementation default terminal type and assume the terminal is a type incapable of supporting open or visual modes; see the  <b>visual</b> command and the description of  <i>vi</i> .</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
Suppress the use of the <i>EXINIT</i> environment variable and the reading of any  <b>.exrc</b> file; see the EXTENDED DESCRIPTION section.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
Suppress autoindentation, ignoring the value of the <b>autoindent</b> edit option.</dd>
</dl>
</div>
<dl>
<dt>
<b>-t&#160;</b> <i>tagstring</i></dt>
<dd>
Edit the file containing the specified <i>tagstring</i>; see <i>ctags</i> . The tags feature represented by  <b>-t</b> <i>tagstring</i> and the <b>tag</b> command is optional. It shall be provided on any system that also provides a conforming implementation of  <i>ctags</i>; otherwise, the use of  <b>-t</b> produces undefined results. On any system, it shall be an error to specify more than a single  <b>-t</b> option.</dd>
</dl>
<dl>
<dt>
<b>-v</b></dt>
<dd>
Begin in visual mode (see <i>vi</i> ).</dd>
</dl>
<dl>
<dt>
<b>-w&#160;</b> <i>size</i></dt>
<dd>
Set the value of the <i>window</i> editor option to <i>size</i>.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>OPERANDS</h1> The following operand shall be supported:<dl>
<dt>
<i>file</i></dt>
<dd>
A pathname of a file to be edited.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>STDIN</h1> The standard input consists of a series of commands and input text, as described in the EXTENDED DESCRIPTION section. The implementation may limit each line of standard input to a length of {LINE_MAX}.<div class="spacer">
</div>
If the standard input is not a terminal device, it shall be as if the  <b>-s</b> option had been specified.<div class="spacer">
</div>
If a read from the standard input returns an error, or if the editor detects an end-of-file condition from the standard input, it shall be equivalent to a SIGHUP asynchronous event.</div>
<div class="section">
<h1>INPUT FILES</h1> Input files shall be text files or files that would be text files except for an incomplete last line that is not longer than {LINE_MAX}-1 bytes in length and contains no NUL characters. By default, any incomplete last line shall be treated as if it had a trailing &lt;newline&gt;. The editing of other forms of files may optionally be allowed by  <i>ex</i> implementations.<div class="spacer">
</div>
The <b>.exrc</b> files and source files shall be text files consisting of  <i>ex</i> commands; see the EXTENDED DESCRIPTION section.<div class="spacer">
</div>
By default, the editor shall read lines from the files to be edited without interpreting any of those lines as any form of editor command.</div>
<div class="section">
<h1>ENVIRONMENT VARIABLES</h1> The following environment variables shall affect the execution of  <i>ex</i>:<dl>
<dt>
<i>COLUMNS</i></dt>
<dd>
Override the system-selected horizontal screen size. See the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001, Chapter 8, Environment Variables for valid values and results when it is unset or null.</dd>
</dl>
<dl>
<dt>
<i>EXINIT</i></dt>
<dd>
Determine a list of <i>ex</i> commands that are executed on editor start-up. See the EXTENDED DESCRIPTION section for more details of the initialization phase.</dd>
</dl>
<dl>
<dt>
<i>HOME</i></dt>
<dd>
Determine a pathname of a directory that shall be searched for an editor start-up file named  <b>.exrc</b>; see the EXTENDED DESCRIPTION section.</dd>
</dl>
<dl>
<dt>
<i>LANG</i></dt>
<dd>
Provide a default value for the internationalization variables that are unset or null. (See the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001, Section 8.2, Internationalization Variables for the precedence of internationalization variables used to determine the values of locale categories.)</dd>
</dl>
<dl>
<dt>
<i>LC_ALL</i></dt>
<dd>
If set to a non-empty string value, override the values of all the other internationalization variables.</dd>
</dl>
<dl>
<dt>
<i>LC_COLLATE</i></dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
Determine the locale for the behavior of ranges, equivalence classes, and multi-character collating elements within regular expressions.</dd>
</dl>
<dl>
<dt>
<i>LC_CTYPE</i></dt>
<dd>
Determine the locale for the interpretation of sequences of bytes of text data as characters (for example, single-byte as opposed to multi-byte characters in arguments and input files), the behavior of character classes within regular expressions, the classification of characters as uppercase or lowercase letters, the case conversion of letters, and the detection of word boundaries.</dd>
</dl>
<dl>
<dt>
<i>LC_MESSAGES</i></dt>
<dd>
Determine the locale that should be used to affect the format and contents of diagnostic messages written to standard error.</dd>
</dl>
<dl>
<dt>
<i>LINES</i></dt>
<dd>
Override the system-selected vertical screen size, used as the number of lines in a screenful and the vertical screen size in visual mode. See the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001, Chapter 8, Environment Variables for valid values and results when it is unset or null.</dd>
</dl>
<dl>
<dt>
<i>NLSPATH</i></dt>
<dd>
Determine the location of message catalogs for the processing of <i>LC_MESSAGES</i>  <i>.</i></dd>
</dl>
<dl>
<dt>
<i>PATH</i></dt>
<dd>
Determine the search path for the shell command specified in the <i>ex</i> editor commands  <b>!</b>, <b>shell</b>, <b>read</b>, and  <b>write</b>, and the open and visual mode command <b>!</b>; see the description of command search and execution in  <i>Command Search</i>  <i>and Execution</i> .</dd>
</dl>
<dl>
<dt>
<i>SHELL</i></dt>
<dd>
Determine the preferred command line interpreter for use as the default value of the  <b>shell</b> edit option.</dd>
</dl>
<dl>
<dt>
<i>TERM</i></dt>
<dd>
Determine the name of the terminal type. If this variable is unset or null, an unspecified default terminal type shall be used.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>ASYNCHRONOUS EVENTS</h1> The following term is used in this and following sections to specify command and asynchronous event actions:<dl>
<dt>
<i>complete&#160;write</i></dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
A complete write is a write of the entire contents of the edit buffer to a file of a type other than a terminal device, or the saving of the edit buffer caused by the user executing the  <i>ex</i>  <b>preserve</b> command. Writing the contents of the edit buffer to a temporary file that will be removed when the editor exits shall not be considered a complete write.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
The following actions shall be taken upon receipt of signals:<dl>
<dt>
SIGINT</dt>
<dd>
If the standard input is not a terminal device, <i>ex</i> shall not write the file or return to command or text input mode, and shall exit with a non-zero exit status.</dd>
</dl>
<div class="spacer">
</div>
Otherwise, if executing an open or visual text input mode command,  <i>ex</i> in receipt of SIGINT shall behave identically to its receipt of the &lt;ESC&gt; character.<div class="spacer">
</div>
Otherwise:<div style="margin-left: 5.00ex;">
<dl>
<dt>
 1.</dt>
<dd>
If executing an <i>ex</i> text input mode command, all input lines that have been completely entered shall be resolved into the edit buffer, and any partially entered line shall be discarded.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
If there is a currently executing command, it shall be aborted and a message displayed. Unless otherwise specified by the  <i>ex</i> or <i>vi</i> command descriptions, it is unspecified whether any lines modified by the executing command appear modified, or as they were before being modified by the executing command, in the buffer.</dd>
</dl>
<div class="spacer">
</div>
If the currently executing command was a motion command, its associated command shall be discarded.<dl>
<dt>
 3.</dt>
<dd>
If in open or visual command mode, the terminal shall be alerted.</dd>
</dl>
<dl>
<dt>
 4.</dt>
<dd>
The editor shall then return to command mode.</dd>
</dl>
</div>
<dl>
<dt>
SIGCONT</dt>
<dd>
The screen shall be refreshed if in open or visual mode.</dd>
</dl>
<dl>
<dt>
SIGHUP</dt>
<dd>
If the edit buffer has been modified since the last complete write,  <i>ex</i> shall attempt to save the edit buffer so that it can be recovered later using the  <b>-r</b> option or the <i>ex</i> <b>recover</b> command. The editor shall not write the file or return to command or text input mode, and shall terminate with a non-zero exit status.</dd>
</dl>
<dl>
<dt>
SIGTERM</dt>
<dd>
Refer to SIGHUP.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
The action taken for all other signals is unspecified.</div>
<div class="section">
<h1>STDOUT</h1> The standard output shall be used only for writing prompts to the user, for informational messages, and for writing lines from the file.</div>
<div class="section">
<h1>STDERR</h1> The standard error shall be used only for diagnostic messages.</div>
<div class="section">
<h1>OUTPUT FILES</h1> The output from  <i>ex</i> shall be text files.</div>
<div class="section">
<h1>EXTENDED DESCRIPTION</h1> Only the  <i>ex</i> mode of the editor is described in this section. See  <i>vi</i> for additional editing capabilities available in  <i>ex</i>.<div class="spacer">
</div>
When an error occurs, <i>ex</i> shall write a message. If the terminal supports a standout mode (such as inverse video), the message shall be written in standout mode. If the terminal does not support a standout mode, and the edit option  <b>errorbells</b> is set, an alert action shall precede the error message.<div class="spacer">
</div>
By default, <i>ex</i> shall start in command mode, which shall be indicated by a  <b>:</b> prompt; see the <b>prompt</b> command. Text input mode can be entered by the  <b>append</b>, <b>insert</b>, or  <b>change</b> commands; it can be exited (and command mode re-entered) by typing a period (  <b>'.'</b> ) alone at the beginning of a line.<div class="subsection">
<h2>Initialization in ex and vi</h2> The following symbols are used in this and following sections to specify locations in the edit buffer:<dl>
<dt>
<i>alternate&#160;and&#160;current&#160;pathnames</i></dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
Two pathnames, named <i>current</i> and <i>alternate</i>, are maintained by the editor. Any  <i>ex</i> commands that take filenames as arguments shall set them as follows:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 1.</dt>
<dd>
If a <i>file</i> argument is specified to the <i>ex</i> <b>edit</b>,  <b>ex</b>, or <b>recover</b> commands, or if an <i>ex</i>  <b>tag</b> command replaces the contents of the edit buffer.<div style="margin-left: 5.00ex;">
<dl>
<dt>
 a.</dt>
<dd>
If the command replaces the contents of the edit buffer, the current pathname shall be set to the  <i>file</i> argument or the file indicated by the tag, and the alternate pathname shall be set to the previous value of the current pathname.</dd>
</dl>
<dl>
<dt>
 b.</dt>
<dd>
Otherwise, the alternate pathname shall be set to the <i>file</i> argument.</dd>
</dl>
</div>
</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
If a <i>file</i> argument is specified to the <i>ex</i> <b>next</b> command:<div style="margin-left: 5.00ex;">
<dl>
<dt>
 a.</dt>
<dd>
If the command replaces the contents of the edit buffer, the current pathname shall be set to the first  <i>file</i> argument, and the alternate pathname shall be set to the previous value of the current pathname.</dd>
</dl>
</div>
</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
If a <i>file</i> argument is specified to the <i>ex</i> <b>file</b> command, the current pathname shall be set to the  <i>file</i> argument, and the alternate pathname shall be set to the previous value of the current pathname.</dd>
</dl>
<dl>
<dt>
 4.</dt>
<dd>
If a <i>file</i> argument is specified to the <i>ex</i> <b>read</b> and  <b>write</b> commands (that is, when reading or writing a file, and not to the program named by the  <b>shell</b> edit option), or a  <i>file</i> argument is specified to the <i>ex</i>  <b>xit</b> command:<div style="margin-left: 5.00ex;">
<dl>
<dt>
 a.</dt>
<dd>
If the current pathname has no value, the current pathname shall be set to the  <i>file</i> argument.</dd>
</dl>
<dl>
<dt>
 b.</dt>
<dd>
Otherwise, the alternate pathname shall be set to the <i>file</i> argument.</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="spacer">
</div>
If the alternate pathname is set to the previous value of the current pathname when the current pathname had no previous value, then the alternate pathname shall have no value as a result.<dl>
<dt>
<i>current&#160;line</i></dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
The line of the edit buffer referenced by the cursor. Each command description specifies the current line after the command has been executed, as the  <i>current line value</i>. When the edit buffer contains no lines, the current line shall be zero; see Addressing in ex .</dd>
</dl>
<dl>
<dt>
<i>current&#160;column</i></dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
The current display line column occupied by the cursor. (The columns shall be numbered beginning at 1.) Each command description specifies the current column after the command has been executed, as the  <i>current column</i> value. This column is an  <i>ideal</i> column that is remembered over the lifetime of the editor. The actual display line column upon which the cursor rests may be different from the current column; see the cursor positioning discussion in  <i>Command</i>  <i>Descriptions in vi</i> .</dd>
</dl>
<dl>
<dt>
<i>set&#160;to&#160;non-&lt;blank&gt;</i></dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
A description for a current column value, meaning that the current column shall be set to the last display line column on which is displayed any part of the first non- &lt;blank&gt; of the line. If the line has no non- &lt;blank&gt; non- &lt;newline&gt;s, the current column shall be set to the last display line column on which is displayed any part of the last non- &lt;newline&gt; in the line. If the line is empty, the current column shall be set to column position 1.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
The length of lines in the edit buffer may be limited to {LINE_MAX} bytes. In open and visual mode, the length of lines in the edit buffer may be limited to the number of characters that will fit in the display. If either limit is exceeded during editing, an error message shall be written. If either limit is exceeded by a line read in from a file, an error message shall be written and the edit session may be terminated.<div class="spacer">
</div>
If the editor stops running due to any reason other than a user command, and the edit buffer has been modified since the last complete write, it shall be equivalent to a SIGHUP asynchronous event. If the system crashes, it shall be equivalent to a SIGHUP asynchronous event.<div class="spacer">
</div>
During initialization (before the first file is copied into the edit buffer or any user commands from the terminal are processed) the following shall occur:<dl>
<dt>
 1.</dt>
<dd>
If the environment variable <i>EXINIT</i> is set, the editor shall execute the  <i>ex</i> commands contained in that variable.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
If the <i>EXINIT</i> variable is not set, and all of the following are true:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 a.</dt>
<dd>
The <i>HOME</i> environment variable is not null and not empty.</dd>
</dl>
<dl>
<dt>
 b.</dt>
<dd>
The file <b>.exrc</b> in the directory referred to by the <i>HOME</i> environment variable:<div style="margin-left: 5.00ex;">
<dl>
<dt>
 1.</dt>
<dd>
Exists</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Is owned by the same user ID as the real user ID of the process or the process has appropriate privileges</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
Is not writable by anyone other than the owner</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="spacer">
</div>
the editor shall execute the <i>ex</i> commands contained in that file.<dl>
<dt>
 3.</dt>
<dd>
If and only if all of the following are true:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 a.</dt>
<dd>
The current directory is not referred to by the <i>HOME</i> environment variable.</dd>
</dl>
<dl>
<dt>
 b.</dt>
<dd>
A command in the <i>EXINIT</i> environment variable or a command in the  <b>.exrc</b> file in the directory referred to by the  <i>HOME</i> environment variable sets the editor option <b>exrc</b>.</dd>
</dl>
<dl>
<dt>
 c.</dt>
<dd>
The <b>.exrc</b> file in the current directory:<div style="margin-left: 5.00ex;">
<dl>
<dt>
 1.</dt>
<dd>
Exists</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Is owned by the same user ID as the real user ID of the process, or by one of a set of implementation-defined user IDs</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
Is not writable by anyone other than the owner</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="spacer">
</div>
the editor shall attempt to execute the <i>ex</i> commands contained in that file.<div class="spacer">
</div>
Lines in any <b>.exrc</b> file that are blank lines shall be ignored. If any  <b>.exrc</b> file exists, but is not read for ownership or permission reasons, it shall be an error.<div class="spacer">
</div>
After the <i>EXINIT</i> variable and any <b>.exrc</b> files are processed, the first file specified by the user shall be edited, as follows:<dl>
<dt>
 1.</dt>
<dd>
If the user specified the <b>-t</b> option, the effect shall be as if the  <i>ex</i> <b>tag</b> command was entered with the specified argument, with the exception that if tag processing does not result in a file to edit, the effect shall be as described in step 3. below.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Otherwise, if the user specified any command line <i>file</i> arguments, the effect shall be as if the  <i>ex</i> <b>edit</b> command was entered with the first of those arguments as its  <i>file</i> argument.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
Otherwise, the effect shall be as if the <i>ex</i> <b>edit</b> command was entered with a nonexistent filename as its  <i>file</i> argument. It is unspecified whether this action shall set the current pathname. In an implementation where this action does not set the current pathname, any editor command using the current pathname shall fail until an editor command sets the current pathname.</dd>
</dl>
<div class="spacer">
</div>
If the <b>-r</b> option was specified, the first time a file in the initial argument list or a file specified by the  <b>-t</b> option is edited, if recovery information has previously been saved about it, that information shall be recovered and the editor shall behave as if the contents of the edit buffer have already been modified. If there are multiple instances of the file to be recovered, the one most recently saved shall be recovered, and an informational message that there are previous versions of the file that can be recovered shall be written. If no recovery information about a file is available, an informational message to this effect shall be written, and the edit shall proceed as usual.<div class="spacer">
</div>
If the <b>-c</b> option was specified, the first time a file that already exists (including a file that might not exist but for which recovery information is available, when the  <b>-r</b> option is specified) replaces or initializes the contents of the edit buffer, the current line shall be set to the last line of the edit buffer, the current column shall be set to non- &lt;blank&gt;, and the  <i>ex</i> commands specified with the <b>-c</b> option shall be executed. In this case, the current line and current column shall not be set as described for the command associated with the replacement or initialization of the edit buffer contents. However, if the  <b>-t</b> option or a <b>tag</b> command is associated with this action, the  <b>-c</b> option commands shall be executed and then the movement to the tag shall be performed.<div class="spacer">
</div>
The current argument list shall initially be set to the filenames specified by the user on the command line. If no filenames are specified by the user, the current argument list shall be empty. If the  <b>-t</b> option was specified, it is unspecified whether any filename resulting from tag processing shall be prepended to the current argument list. In the case where the filename is added as a prefix to the current argument list, the current argument list reference shall be set to that filename. In the case where the filename is not added as a prefix to the current argument list, the current argument list reference shall logically be located before the first of the filenames specified on the command line (for example, a subsequent  <i>ex</i> <b>next</b> command shall edit the first filename from the command line). If the  <b>-t</b> option was not specified, the current argument list reference shall be to the first of the filenames on the command line.</div>
<div class="subsection">
<h2>Addressing in ex</h2> Addressing in  <i>ex</i> relates to the current line and the current column; the address of a line is its 1-based line number, the address of a column is its 1-based count from the beginning of the line. Generally, the current line is the last line affected by a command. The current line number is the address of the current line. In each command description, the effect of the command on the current line number and the current column is described.<div class="spacer">
</div>
Addresses are constructed as follows:<dl>
<dt>
 1.</dt>
<dd>
The character <b>'.'</b> (period) shall address the current line.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
The character <b>'$'</b> shall address the last line of the edit buffer.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
The positive decimal number <i>n</i> shall address the <i>n</i>th line of the edit buffer.</dd>
</dl>
<dl>
<dt>
 4.</dt>
<dd>
The address <b>&quot;'x&quot;</b> refers to the line marked with the mark name character  <b>'x'</b>, which shall be a lowercase letter from the portable character set or one of the characters  <b>'`'</b> or  <b>'&quot;</b> . It shall be an error if the line that was marked is not currently present in the edit buffer or the mark has not been set. Lines can be marked with the  <i>ex</i>  <b>mark</b> or <b>k</b> commands, or the <i>vi</i> <b>m</b> command.</dd>
</dl>
<dl>
<dt>
 5.</dt>
<dd>
A regular expression enclosed by slashes ( <b>'/'</b> ) shall address the first line found by searching forwards from the line following the current line toward the end of the edit buffer and stopping at the first line for which the line excluding the terminating &lt;newline&gt; matches the regular expression. As stated in Regular Expressions in ex, an address consisting of a null regular expression delimited by slashes  <b>&quot;//&quot;</b> shall address the next line for which the line excluding the terminating &lt;newline&gt; matches the last regular expression encountered. In addition, the second slash can be omitted at the end of a command line. If the  <b>wrapscan</b> edit option is set, the search shall wrap around to the beginning of the edit buffer and continue up to and including the current line, so that the entire edit buffer is searched. Within the regular expression, the sequence  <b>&quot;\/&quot;</b> shall represent a literal slash instead of the regular expression delimiter.</dd>
</dl>
<dl>
<dt>
 6.</dt>
<dd>
A regular expression enclosed in question marks ( <b>'?'</b> ) shall address the first line found by searching backwards from the line preceding the current line toward the beginning of the edit buffer and stopping at the first line for which the line excluding the terminating &lt;newline&gt; matches the regular expression. An address consisting of a null regular expression delimited by question marks  <b>&quot;??&quot;</b> shall address the previous line for which the line excluding the terminating &lt;newline&gt; matches the last regular expression encountered. In addition, the second question mark can be omitted at the end of a command line. If the  <b>wrapscan</b> edit option is set, the search shall wrap around from the beginning of the edit buffer to the end of the edit buffer and continue up to and including the current line, so that the entire edit buffer is searched. Within the regular expression, the sequence  <b>&quot;\?&quot;</b> shall represent a literal question mark instead of the RE delimiter.</dd>
</dl>
<dl>
<dt>
 7.</dt>
<dd>
A plus sign ( <b>'+'</b> ) or a minus sign ( <b>'-'</b> ) followed by a decimal number shall address the current line plus or minus the number. A  <b>'+'</b> or <b>'-'</b> not followed by a decimal number shall address the current line plus or minus 1.</dd>
</dl>
<div class="spacer">
</div>
Addresses can be followed by zero or more address offsets, optionally &lt;blank&gt;-separated. Address offsets are constructed as follows:<dl>
<dt>
 1.</dt>
<dd>
A <b>'+'</b> or <b>'-'</b> immediately followed by a decimal number shall add (subtract) the indicated number of lines to (from) the address. A  <b>'+'</b> or <b>'-'</b> not followed by a decimal number shall add (subtract) 1 to (from) the address.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
A decimal number shall add the indicated number of lines to the address.</dd>
</dl>
<div class="spacer">
</div>
It shall not be an error for an intermediate address value to be less than zero or greater than the last line in the edit buffer. It shall be an error for the final address value to be less than zero or greater than the last line in the edit buffer.<div class="spacer">
</div>
Commands take zero, one, or two addresses; see the descriptions of  <i>1addr</i> and <i>2addr</i> in Command Descriptions in ex . If more than the required number of addresses are provided to a command that requires zero addresses, it shall be an error. Otherwise, if more than the required number of addresses are provided to a command, the addresses specified first shall be evaluated and then discarded until the maximum number of valid addresses remain.<div class="spacer">
</div>
Addresses shall be separated from each other by a comma ( <b>','</b> ) or a semicolon (  <b>';'</b> ). If no address is specified before or after a comma or semicolon separator, it shall be as if the address of the current line was specified before or after the separator. In the case of a semicolon separator, the current line (  <b>'.'</b> ) shall be set to the first address, and only then will the next address be calculated. This feature can be used to determine the starting line for forwards and backwards searches (see rules 5. and 6.).<div class="spacer">
</div>
A percent sign ( <b>'%'</b> ) shall be equivalent to entering the two addresses  <b>&quot;1,$&quot;</b> .<div class="spacer">
</div>
Any delimiting &lt;blank&gt;s between addresses, address separators, or address offsets shall be discarded.</div>
<div class="subsection">
<h2>Command Line Parsing in ex</h2> The following symbol is used in this and following sections to describe parsing behavior:<dl>
<dt>
<i>escape</i></dt>
<dd>
If a character is referred to as &quot;backslash-escaped&quot; or &quot; &lt;control&gt;-V-escaped,&quot; it shall mean that the character acquired or lost a special meaning by virtue of being preceded, respectively, by a backslash or &lt;control&gt;-V character. Unless otherwise specified, the escaping character shall be discarded at that time and shall not be further considered for any purpose.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
Command-line parsing shall be done in the following steps. For each step, characters already evaluated shall be ignored; that is, the phrase &quot;leading character&quot; refers to the next character that has not yet been evaluated.<dl>
<dt>
 1.</dt>
<dd>
Leading colon characters shall be skipped.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Leading &lt;blank&gt;s shall be skipped.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
If the leading character is a double-quote character, the characters up to and including the next non-backslash-escaped &lt;newline&gt; shall be discarded, and any subsequent characters shall be parsed as a separate command.</dd>
</dl>
<dl>
<dt>
 4.</dt>
<dd>
Leading characters that can be interpreted as addresses shall be evaluated; see Addressing in ex .</dd>
</dl>
<dl>
<dt>
 5.</dt>
<dd>
Leading &lt;blank&gt;s shall be skipped.</dd>
</dl>
<dl>
<dt>
 6.</dt>
<dd>
If the next character is a vertical-line character or a &lt;newline&gt;:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 a.</dt>
<dd>
If the next character is a &lt;newline&gt;:<div style="margin-left: 5.00ex;">
<dl>
<dt>
 1.</dt>
<dd>
If <i>ex</i> is in open or visual mode, the current line shall be set to the last address specified, if any.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Otherwise, if the last command was terminated by a vertical-line character, no action shall be taken; for example, the command  <b>&quot;||&lt;newline&gt;&quot;</b> shall execute two implied commands, not three.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
Otherwise, step 6.b. shall apply.</dd>
</dl>
</div>
</dd>
</dl>
<dl>
<dt>
 b.</dt>
<dd>
Otherwise, the implied command shall be the <b>print</b> command. The last  <b>#</b>, <b>p</b>, and <b>l</b> flags specified to any  <i>ex</i> command shall be remembered and shall apply to this implied command. Executing the  <i>ex</i> <b>number</b>,  <b>print</b>, or <b>list</b> command shall set the remembered flags to  <b>#</b>, nothing, and <b>l</b>, respectively, plus any other flags specified for that execution of the  <b>number</b>, <b>print</b>, or  <b>list</b> command.</dd>
</dl>
<div class="spacer">
</div>
If <i>ex</i> is not currently performing a <b>global</b> or <b>v</b> command, and no address or count is specified, the current line shall be incremented by 1 before the command is executed. If incrementing the current line would result in an address past the last line in the edit buffer, the command shall fail, and the increment shall not happen.<dl>
<dt>
 c.</dt>
<dd>
The &lt;newline&gt; or vertical-line character shall be discarded and any subsequent characters shall be parsed as a separate command.</dd>
</dl>
</div>
<dl>
<dt>
 7.</dt>
<dd>
The command name shall be comprised of the next character (if the character is not alphabetic), or the next character and any subsequent alphabetic characters (if the character is alphabetic), with the following exceptions:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 a.</dt>
<dd>
Commands that consist of any prefix of the characters in the command name  <b>delete</b>, followed immediately by any of the characters  <b>'l'</b>, <b>'p'</b>, <b>'+'</b>, <b>'-'</b>, or <b>'#'</b> shall be interpreted as a  <b>delete</b> command, followed by a &lt;blank&gt;, followed by the characters that were not part of the prefix of the  <b>delete</b> command. The maximum number of characters shall be matched to the command name  <b>delete</b>; for example, <b>&quot;del&quot;</b> shall not be treated as  <b>&quot;de&quot;</b> followed by the flag <b>l</b>.</dd>
</dl>
<dl>
<dt>
 b.</dt>
<dd>
Commands that consist of the character <b>'k'</b>, followed by a character that can be used as the name of a mark, shall be equivalent to the mark command followed by a &lt;blank&gt;, followed by the character that followed the  <b>'k'</b> .</dd>
</dl>
<dl>
<dt>
 c.</dt>
<dd>
Commands that consist of the character <b>'s'</b>, followed by characters that could be interpreted as valid options to the  <b>s</b> command, shall be the equivalent of the <b>s</b> command, without any pattern or replacement values, followed by a &lt;blank&gt;, followed by the characters after the  <b>'s'</b> .</dd>
</dl>
</div>
<dl>
<dt>
 8.</dt>
<dd>
The command name shall be matched against the possible command names, and a command name that contains a prefix matching the characters specified by the user shall be the executed command. In the case of commands where the characters specified by the user could be ambiguous, the executed command shall be as follows:<table class="tbl">
<col style="width: 8.00ex;"/>
<col style="width: 12.00ex;"/>
<col style="width: 2.00ex;"/>
<col style="width: 11.00ex;"/>
<col style="width: 8.00ex;"/>
<col style="width: 5.00ex;"/>
<col style="width: 8.00ex;"/>
<col style="width: 8.00ex;"/>
<tbody>
<tr>
<td>
<b>a</b></td>
<td>
<b>append</b></td>
<td>
n</td>
<td>
<b>next</b></td>
<td>
<b>t</b></td>
<td>
t</td>
<td>
<b>&#160;</b></td>
<td>
<b>&#160;</b></td>
</tr>
<tr>
<td>
<b>c</b></td>
<td>
<b>change</b></td>
<td>
p</td>
<td>
<b>print</b></td>
<td>
<b>u</b></td>
<td>
undo</td>
<td>
<b>&#160;</b></td>
<td>
<b>&#160;</b></td>
</tr>
<tr>
<td>
<b>ch</b></td>
<td>
<b>change</b></td>
<td>
pr</td>
<td>
<b>print</b></td>
<td>
<b>un</b></td>
<td>
undo</td>
<td>
<b>&#160;</b></td>
<td>
<b>&#160;</b></td>
</tr>
<tr>
<td>
<b>e</b></td>
<td>
<b>edit</b></td>
<td>
r</td>
<td>
<b>read</b></td>
<td>
<b>v</b></td>
<td>
v</td>
<td>
<b>&#160;</b></td>
<td>
<b>&#160;</b></td>
</tr>
<tr>
<td>
<b>m</b></td>
<td>
<b>move</b></td>
<td>
re</td>
<td>
<b>read</b></td>
<td>
<b>w</b></td>
<td>
write</td>
<td>
<b>&#160;</b></td>
<td>
<b>&#160;</b></td>
</tr>
<tr>
<td>
<b>ma</b></td>
<td>
<b>mark</b></td>
<td>
s</td>
<td>
<b>s</b></td>
<td>
<b>&#160;</b></td>
<td>
&#160;</td>
<td>
<b>&#160;</b></td>
<td>
<b>&#160;</b></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<div class="spacer">
</div>
Implementation extensions with names causing similar ambiguities shall not be checked for a match until all possible matches for commands specified by IEEE&#160;Std&#160;1003.1-2001 have been checked.<dl>
<dt>
 9.</dt>
<dd>
If the command is a <b>!</b> command, or if the command is a <b>read</b> command followed by zero or more &lt;blank&gt;s and a  <b>!</b>, or if the command is a <b>write</b> command followed by one or more &lt;blank&gt;s and a  <b>!</b>, the rest of the command shall include all characters up to a non-backslash-escaped &lt;newline&gt;. The &lt;newline&gt; shall be discarded and any subsequent characters shall be parsed as a separate  <i>ex</i> command.</dd>
</dl>
<dl>
<dt>
10.</dt>
<dd>
Otherwise, if the command is an <b>edit</b>, <b>ex</b>, or <b>next</b> command, or a  <b>visual</b> command while in open or visual mode, the next part of the command shall be parsed as follows:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 a.</dt>
<dd>
Any <b>'!'</b> character immediately following the command shall be skipped and be part of the command.</dd>
</dl>
<dl>
<dt>
 b.</dt>
<dd>
Any leading &lt;blank&gt;s shall be skipped and be part of the command.</dd>
</dl>
<dl>
<dt>
 c.</dt>
<dd>
If the next character is a <b>'+'</b>, characters up to the first non-backslash-escaped &lt;newline&gt; or non-backslash-escaped &lt;blank&gt; shall be skipped and be part of the command.</dd>
</dl>
<dl>
<dt>
 d.</dt>
<dd>
The rest of the command shall be determined by the steps specified in paragraph 12.</dd>
</dl>
</div>
<dl>
<dt>
11.</dt>
<dd>
Otherwise, if the command is a <b>global</b>, <b>open</b>, <b>s</b>, or  <b>v</b> command, the next part of the command shall be parsed as follows:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 a.</dt>
<dd>
Any leading &lt;blank&gt;s shall be skipped and be part of the command.</dd>
</dl>
<dl>
<dt>
 b.</dt>
<dd>
If the next character is not an alphanumeric, double-quote, &lt;newline&gt;, backslash, or vertical-line character:<div style="margin-left: 5.00ex;">
<dl>
<dt>
 1.</dt>
<dd>
The next character shall be used as a command delimiter.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
If the command is a <b>global</b>, <b>open</b>, or <b>v</b> command, characters up to the first non-backslash-escaped &lt;newline&gt;, or first non-backslash-escaped delimiter character, shall be skipped and be part of the command.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
If the command is an <b>s</b> command, characters up to the first non-backslash-escaped &lt;newline&gt;, or second non-backslash-escaped delimiter character, shall be skipped and be part of the command.</dd>
</dl>
</div>
</dd>
</dl>
<dl>
<dt>
 c.</dt>
<dd>
If the command is a <b>global</b> or <b>v</b> command, characters up to the first non-backslash-escaped &lt;newline&gt; shall be skipped and be part of the command.</dd>
</dl>
<dl>
<dt>
 d.</dt>
<dd>
Otherwise, the rest of the command shall be determined by the steps specified in paragraph 12.</dd>
</dl>
</div>
<dl>
<dt>
12.</dt>
<dd>
Otherwise:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 a.</dt>
<dd>
If the command was a <b>map</b>, <b>unmap</b>, <b>abbreviate</b>, or  <b>unabbreviate</b> command, characters up to the first non- &lt;control&gt;-V-escaped &lt;newline&gt;, vertical-line, or double-quote character shall be skipped and be part of the command.</dd>
</dl>
<dl>
<dt>
 b.</dt>
<dd>
Otherwise, characters up to the first non-backslash-escaped &lt;newline&gt;, vertical-line, or double-quote character shall be skipped and be part of the command.</dd>
</dl>
<dl>
<dt>
 c.</dt>
<dd>
If the command was an <b>append</b>, <b>change</b>, or <b>insert</b> command, and the step 12.b. ended at a vertical-line character, any subsequent characters, up to the next non-backslash-escaped &lt;newline&gt; shall be used as input text to the command.</dd>
</dl>
<dl>
<dt>
 d.</dt>
<dd>
If the command was ended by a double-quote character, all subsequent characters, up to the next non-backslash-escaped &lt;newline&gt;, shall be discarded.</dd>
</dl>
<dl>
<dt>
 e.</dt>
<dd>
The terminating &lt;newline&gt; or vertical-line character shall be discarded and any subsequent characters shall be parsed as a separate  <i>ex</i> command.</dd>
</dl>
</div>
<div class="spacer">
</div>
Command arguments shall be parsed as described by the Synopsis and Description of each individual  <i>ex</i> command. This parsing shall not be &lt;blank&gt;-sensitive, except for the  <b>!</b> argument, which must follow the command name without intervening &lt;blank&gt;s, and where it would otherwise be ambiguous. For example,  <i>count</i> and <i>flag</i> arguments need not be &lt;blank&gt;-separated because  <b>&quot;d22p&quot;</b> is not ambiguous, but <i>file</i> arguments to the  <i>ex</i> <b>next</b> command must be separated by one or more &lt;blank&gt;s. Any &lt;blank&gt; in command arguments for the  <b>abbreviate</b>,  <b>unabbreviate</b>, <b>map</b>, and <b>unmap</b> commands can be &lt;control&gt;-V-escaped, in which case the &lt;blank&gt; shall not be used as an argument delimiter. Any &lt;blank&gt; in the command argument for any other command can be backslash-escaped, in which case that &lt;blank&gt; shall not be used as an argument delimiter.<div class="spacer">
</div>
Within command arguments for the <b>abbreviate</b>, <b>unabbreviate</b>,  <b>map</b>, and <b>unmap</b> commands, any character can be &lt;control&gt;-V-escaped. All such escaped characters shall be treated literally and shall have no special meaning. Within command arguments for all other  <i>ex</i> commands that are not regular expressions or replacement strings, any character that would otherwise have a special meaning can be backslash-escaped. Escaped characters shall be treated literally, without special meaning as shell expansion characters or  <b>'!'</b>, <b>'%'</b>, and  <b>'#'</b> expansion characters. See Regular Expressions in ex and Replacement Strings in ex for descriptions of command arguments that are regular expressions or replacement strings.<div class="spacer">
</div>
Non-backslash-escaped <b>'%'</b> characters appearing in <i>file</i> arguments to any  <i>ex</i> command shall be replaced by the current pathname; unescaped  <b>'#'</b> characters shall be replaced by the alternate pathname. It shall be an error if  <b>'%'</b> or <b>'#'</b> characters appear unescaped in an argument and their corresponding values are not set.<div class="spacer">
</div>
Non-backslash-escaped <b>'!'</b> characters in the arguments to either the  <i>ex</i> <b>!</b> command or the open and visual mode  <b>!</b> command, or in the arguments to the <i>ex</i> <b>read</b> command, where the first non- &lt;blank&gt; after the command name is a  <b>'!'</b> character, or in the arguments to the  <i>ex</i> <b>write</b> command where the command name is followed by one or more &lt;blank&gt;s and the first non- &lt;blank&gt; after the command name is a  <b>'!'</b> character, shall be replaced with the arguments to the last of those three commands as they appeared after all unescaped  <b>'%'</b>, <b>'#'</b>, and  <b>'!'</b> characters were replaced. It shall be an error if  <b>'!'</b> characters appear unescaped in one of these commands and there has been no previous execution of one of these commands.<div class="spacer">
</div>
If an error occurs during the parsing or execution of an <i>ex</i> command:<dl>
<dt>
 *</dt>
<dd>
An informational message to this effect shall be written. Execution of the  <i>ex</i> command shall stop, and the cursor (for example, the current line and column) shall not be further modified.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
If the <i>ex</i> command resulted from a map expansion, all characters from that map expansion shall be discarded, except as otherwise specified by the  <b>map</b> command.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
Otherwise, if the <i>ex</i> command resulted from the processing of an  <i>EXINIT</i> environment variable, a <b>.exrc</b> file, a  <b>:source</b> command, a <b>-c</b> option, or a <b>+</b> <i>command</i> specified to an  <i>ex</i> <b>edit</b>, <b>ex</b>,  <b>next</b>, or <b>visual</b> command, no further commands from the source of the commands shall be executed.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
Otherwise, if the <i>ex</i> command resulted from the execution of a buffer or a  <b>global</b> or <b>v</b> command, no further commands caused by the execution of the buffer or the  <b>global</b> or  <b>v</b> command shall be executed.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
Otherwise, if the <i>ex</i> command was not terminated by a &lt;newline&gt;, all characters up to and including the next non-backslash-escaped &lt;newline&gt; shall be discarded.</dd>
</dl>
</div>
<div class="subsection">
<h2>Input Editing in ex</h2> The following symbol is used in this and the following sections to specify command actions:<dl>
<dt>
<i>word</i></dt>
<dd>
In the POSIX locale, a word consists of a maximal sequence of letters, digits, and underscores, delimited at both ends by characters other than letters, digits, or underscores, or by the beginning or end of a line or the edit buffer.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
When accepting input characters from the user, in either <i>ex</i> command mode or  <i>ex</i> text input mode, <i>ex</i> shall enable canonical mode input processing, as defined in the System Interfaces volume of IEEE&#160;Std&#160;1003.1-2001.<div class="spacer">
</div>
If in <i>ex</i> text input mode:<dl>
<dt>
 1.</dt>
<dd>
If the <b>number</b> edit option is set, <i>ex</i> shall prompt for input using the line number that would be assigned to the line if it is entered, in the format specified for the  <i>ex</i> <b>number</b> command.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
If the <b>autoindent</b> edit option is set, <i>ex</i> shall prompt for input using  <b>autoindent</b> characters, as described by the  <b>autoindent</b> edit option. <b>autoindent</b> characters shall follow the line number, if any.</dd>
</dl>
<div class="spacer">
</div>
If in <i>ex</i> command mode:<dl>
<dt>
 1.</dt>
<dd>
If the <b>prompt</b> edit option is set, input shall be prompted for using a single  <b>':'</b> character; otherwise, there shall be no prompt.</dd>
</dl>
<div class="spacer">
</div>
The input characters in the following sections shall have the following effects on the input line.</div>
<div class="subsection">
<h2>Scroll</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>eof</b><br/>
<b></b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
See the description of the <i>stty</i> <i>eof</i> character in <i>stty</i> .<div class="spacer">
</div>
If in <i>ex</i> command mode: If the  <i>eof</i> character is the first character entered on the line, the line shall be evaluated as if it contained two characters: a &lt;control&gt;-D and a &lt;newline&gt;.<div class="spacer">
</div>
Otherwise, the <i>eof</i> character shall have no special meaning.<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If in <i>ex</i> text input mode: If the cursor follows an  <b>autoindent</b> character, the <b>autoindent</b> characters in the line shall be modified so that a part of the next text input character will be displayed on the first column in the line after the previous  <b>shiftwidth</b> edit option column boundary, and the user shall be prompted again for input for the same line.<div class="spacer">
</div>
Otherwise, if the cursor follows a <b>'0'</b>, which follows an <b>autoindent</b> character, and the  <b>'0'</b> was the previous text input character, the  <b>'0'</b> and all <b>autoindent</b> characters in the line shall be discarded, and the user shall be prompted again for input for the same line.<div class="spacer">
</div>
Otherwise, if the cursor follows a <b>'^'</b>, which follows an <b>autoindent</b> character, and the  <b>'^'</b> was the previous text input character, the  <b>'^'</b> and all <b>autoindent</b> characters in the line shall be discarded, and the user shall be prompted again for input for the same line. In addition, the  <b>autoindent</b> level for the next input line shall be derived from the same line from which the  <b>autoindent</b> level for the current input line was derived.<div class="spacer">
</div>
Otherwise, if there are no <b>autoindent</b> or text input characters in the line, the  <i>eof</i> character shall be discarded.<div class="spacer">
</div>
Otherwise, the <i>eof</i> character shall have no special meaning.</div>
<div class="subsection">
<h2>&lt;newline&gt;</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>&lt;newline&gt;</b><div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
&lt;control&gt;-J<br/>
<b></b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If in <i>ex</i> command mode: Cause the command line to be parsed; &lt;control&gt;-J shall be mapped to the &lt;newline&gt; for this purpose.<div class="spacer">
</div>
If in <i>ex</i> text input mode: Terminate the current line. If there are no characters other than  <b>autoindent</b> characters on the line, all characters on the line shall be discarded.<div class="spacer">
</div>
Prompt for text input on a new line after the current line. If the  <b>autoindent</b> edit option is set, an appropriate number of  <b>autoindent</b> characters shall be added as a prefix to the line as described by the  <i>ex</i> <b>autoindent</b> edit option.</div>
<div class="subsection">
<h2>&lt;backslash&gt;</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>&lt;backslash&gt;</b><br/>
<b></b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Allow the entry of a subsequent &lt;newline&gt; or &lt;control&gt;-J as a literal character, removing any special meaning that it may have to the editor during text input mode. The backslash character shall be retained and evaluated when the command line is parsed, or retained and included when the input text becomes part of the edit buffer.</div>
<div class="subsection">
<h2>&lt;control&gt;-V</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>&lt;control&gt;-V</b><br/>
<b></b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Allow the entry of any subsequent character as a literal character, removing any special meaning that it may have to the editor during text input mode. The &lt;control&gt;-V character shall be discarded before the command line is parsed or the input text becomes part of the edit buffer.<div class="spacer">
</div>
If the &quot;literal next&quot; functionality is performed by the underlying system, it is implementation-defined whether a character other than &lt;control&gt;-V performs this function.</div>
<div class="subsection">
<h2>&lt;control&gt;-W</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>&lt;control&gt;-W</b><br/>
<b></b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Discard the &lt;control&gt;-W, and the word previous to it in the input line, including any &lt;blank&gt;s following the word and preceding the &lt;control&gt;-W. If the &quot;word erase&quot; functionality is performed by the underlying system, it is implementation-defined whether a character other than &lt;control&gt;-W performs this function.</div>
<div class="subsection">
<h2>Command Descriptions in ex</h2> The following symbols are used in this section to represent command modifiers. Some of these modifiers can be omitted, in which case the specified defaults shall be used.<dl>
<dt>
<i>1addr</i></dt>
<dd>
A single line address, given in any of the forms described in Addressing in ex ; the default shall be the current line (  <b>'.'</b> ), unless otherwise specified.</dd>
</dl>
<div class="spacer">
</div>
If the line address is zero, it shall be an error, unless otherwise specified in the following command descriptions.<div class="spacer">
</div>
If the edit buffer is empty, and the address is specified with a command other than  <b>=</b>, <b>append</b>, <b>insert</b>,  <b>open</b>, <b>put</b>, <b>read</b>, or <b>visual</b>, or the address is not zero, it shall be an error.<dl>
<dt>
<i>2addr</i></dt>
<dd>
Two addresses specifying an inclusive range of lines. If no addresses are specified, the default for  <i>2addr</i> shall be the current line only (  <b>&quot;.,.&quot;</b> ), unless otherwise specified in the following command descriptions. If one address is specified,  <i>2addr</i> shall specify that line only, unless otherwise specified in the following command descriptions.</dd>
</dl>
<div class="spacer">
</div>
It shall be an error if the first address is greater than the second address.<div class="spacer">
</div>
If the edit buffer is empty, and the two addresses are specified with a command other than the  <b>!</b>, <b>write</b>,  <b>wq</b>, or <b>xit</b> commands, or either address is not zero, it shall be an error.<dl>
<dt>
<i>count</i></dt>
<dd>
A positive decimal number. If <i>count</i> is specified, it shall be equivalent to specifying an additional address to the command, unless otherwise specified by the following command descriptions. The additional address shall be equal to the last address specified to the command (either explicitly or by default) plus  <i>count</i>-1.</dd>
</dl>
<div class="spacer">
</div>
If this would result in an address greater than the last line of the edit buffer, it shall be corrected to equal the last line of the edit buffer.<dl>
<dt>
<i>flags</i></dt>
<dd>
One or more of the characters <b>'+'</b>, <b>'-'</b>, <b>'#'</b>,  <b>'p'</b>, or <b>'l'</b> (ell). The flag characters can be &lt;blank&gt;-separated, and in any order or combination. The characters  <b>'#'</b>, <b>'p'</b>, and  <b>'l'</b> shall cause lines to be written in the format specified by the  <b>print</b> command with the specified <i>flags</i>.</dd>
</dl>
<div class="spacer">
</div>
The lines to be written are as follows:<div style="margin-left: 5.00ex;">
<dl>
<dt>
 1.</dt>
<dd>
All edit buffer lines written during the execution of the <i>ex</i>  <b>&amp;</b>, <b>~</b>, <b>list</b>, <b>number</b>,  <b>open</b>, <b>print</b>, <b>s</b>, <b>visual</b>, and <b>z</b> commands shall be written as specified by  <i>flags</i>.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
After the completion of an <i>ex</i> command with a flag as an argument, the current line shall be written as specified by  <i>flags</i>, unless the current line was the last line written by the command.</dd>
</dl>
</div>
<div class="spacer">
</div>
The characters <b>'+'</b> and <b>'-'</b> cause the value of the current line after the execution of the  <i>ex</i> command to be adjusted by the offset address as described in Addressing in ex . This adjustment shall occur before the current line is written as described in 2. above.<div class="spacer">
</div>
The default for <i>flags</i> shall be none.<dl>
<dt>
<i>buffer</i></dt>
<dd>
One of a number of named areas for holding text. The named buffers are specified by the alphanumeric characters of the POSIX locale. There shall also be one &quot;unnamed&quot; buffer. When no buffer is specified for editor commands that use a buffer, the unnamed buffer shall be used. Commands that store text into buffers shall store the text as it was before the command took effect, and shall store text occurring earlier in the file before text occurring later in the file, regardless of how the text region was specified. Commands that store text into buffers shall store the text into the unnamed buffer as well as any specified buffer.</dd>
</dl>
<div class="spacer">
</div>
In <i>ex</i> commands, buffer names are specified as the name by itself. In open or visual mode commands the name is preceded by a double quote (  <b>' )'</b> character.<div class="spacer">
</div>
If the specified buffer name is an uppercase character, and the buffer contents are to be modified, the buffer shall be appended to rather than being overwritten. If the buffer is not being modified, specifying the buffer name in lowercase and uppercase shall have identical results.<div class="spacer">
</div>
There shall also be buffers named by the numbers 1 through 9. In open and visual mode, if a region of text including characters from more than a single line is being modified by the  <i>vi</i> <b>c</b> or  <b>d</b> commands, the motion character associated with the  <b>c</b> or <b>d</b> commands specifies that the buffer text shall be in line mode, or the commands  <b>%</b>, <b>`</b>, <b>/</b>, <b>?</b>, <b>(</b>, <b>)</b>, <b>N</b>,  <b>n</b>, <b>{</b>, or <b>}</b> are used to define a region of text for the  <b>c</b> or <b>d</b> commands, the contents of buffers 1 through 8 shall be moved into the buffer named by the next numerically greater value, the contents of buffer 9 shall be discarded, and the region of text shall be copied into buffer 1. This shall be in addition to copying the text into a user-specified buffer or unnamed buffer, or both. Numeric buffers can be specified as a source buffer for open and visual mode commands; however, specifying a numeric buffer as the write target of an open or visual mode command shall have unspecified results.<div class="spacer">
</div>
The text of each buffer shall have the characteristic of being in either line or character mode. Appending text to a non-empty buffer shall set the mode to match the characteristic of the text being appended. Appending text to a buffer shall cause the creation of at least one additional line in the buffer. All text stored into buffers by  <i>ex</i> commands shall be in line mode. The  <i>ex</i> commands that use buffers as the source of text specify individually how buffers of different modes are handled. Each open or visual mode command that uses buffers for any purpose specifies individually the mode of the text stored into the buffer and how buffers of different modes are handled.<dl>
<dt>
<i>file</i></dt>
<dd>
Command text used to derive a pathname. The default shall be the current pathname, as defined previously, in which case, if no current pathname has yet been established it shall be an error, except where specifically noted in the individual command descriptions that follow. If the command text contains any of the characters  <b>'~'</b>, <b>'{'</b>, <b>'['</b>,  <b>'*'</b>, <b>'?'</b>, <b>'$'</b>, <b>'`'</b>, <b>'&quot;</b>, <b>' ,'</b> and  <b>'\'</b>, it shall be subjected to the process of &quot;shell expansions&quot;, as described below; if more than a single pathname results and the command expects only one, it shall be an error.</dd>
</dl>
<div class="spacer">
</div>
The process of shell expansions in the editor shall be done as follows. The  <i>ex</i> utility shall pass two arguments to the program named by the shell edit option; the first shall be  <b>-c</b>, and the second shall be the string  <b>&quot;echo&quot;</b> and the command text as a single argument. The standard output and standard error of that command shall replace the command text.<dl>
<dt>
<b>!</b></dt>
<dd>
A character that can be appended to the command name to modify its operation, as detailed in the individual command descriptions. With the exception of the  <i>ex</i> <b>read</b>, <b>write</b>, and  <b>!</b> commands, the <b>'!'</b> character shall only act as a modifier if there are no &lt;blank&gt;s between it and the command name.</dd>
</dl>
<dl>
<dt>
<i>remembered&#160;search&#160;direction</i></dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
The <i>vi</i> commands <b>N</b> and <b>n</b> begin searching in a forwards or backwards direction in the edit buffer based on a remembered search direction, which is initially unset, and is set by the  <i>ex</i>  <b>global</b>, <b>v</b>, <b>s</b>, and <b>tag</b> commands, and the <i>vi</i>  <b>/</b> and  <b>?</b> commands.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="subsection">
<h2>Abbreviate</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>ab</b><b>[</b><i>breviate</i><b>][</b><i>lhs rhs</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If <i>lhs</i> and <i>rhs</i> are not specified, write the current list of abbreviations and do nothing more.<div class="spacer">
</div>
Implementations may restrict the set of characters accepted in <i>lhs</i> or  <i>rh</i>, except that printable characters and &lt;blank&gt;s shall not be restricted. Additional restrictions shall be implementation-defined.<div class="spacer">
</div>
In both <i>lhs</i> and <i>rhs</i>, any character may be escaped with a &lt;control&gt;-V, in which case the character shall not be used to delimit  <i>lhs</i> from <i>rhs</i>, and the escaping &lt;control&gt;-V shall be discarded.<div class="spacer">
</div>
In open and visual text input mode, if a non-word or &lt;ESC&gt; character that is not escaped by a &lt;control&gt;-V character is entered after a word character, a check shall be made for a set of characters matching  <i>lhs</i>, in the text input entered during this command. If it is found, the effect shall be as if  <i>rhs</i> was entered instead of  <i>lhs</i>.<div class="spacer">
</div>
The set of characters that are checked is defined as follows:<dl>
<dt>
 1.</dt>
<dd>
If there are no characters inserted before the word and non-word or &lt;ESC&gt; characters that triggered the check, the set of characters shall consist of the word character.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
If the character inserted before the word and non-word or &lt;ESC&gt; characters that triggered the check is a word character, the set of characters shall consist of the characters inserted immediately before the triggering characters that are word characters, plus the triggering word character.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
If the character inserted before the word and non-word or &lt;ESC&gt; characters that triggered the check is not a word character, the set of characters shall consist of the characters that were inserted before the triggering characters that are neither &lt;blank&gt;s nor word characters, plus the triggering word character.</dd>
</dl>
<div class="spacer">
</div>
It is unspecified whether the <i>lhs</i> argument entered for the <i>ex</i>  <b>abbreviate</b> and <b>unabbreviate</b> commands is replaced in this fashion. Regardless of whether or not the replacement occurs, the effect of the command shall be as if the replacement had not occurred.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Append</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>1addr</i><b>]</b> <b>a</b><b>[</b><b>ppend</b><b>][</b><b>!</b><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Enter <i>ex</i> text input mode; the input text shall be placed after the specified line. If line zero is specified, the text shall be placed at the beginning of the edit buffer.<div class="spacer">
</div>
This command shall be affected by the <b>number</b> and <b>autoindent</b> edit options; following the command name with  <b>'!'</b> shall cause the <b>autoindent</b> edit option setting to be toggled for the duration of this command only.<div class="spacer">
</div>
<i>Current line</i>: Set to the last input line; if no lines were input, set to the specified line, or to the first line of the edit buffer if a line of zero was specified, or zero if the edit buffer is empty.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Arguments</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>ar</b><b>[</b><i>gs</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Write the current argument list, with the current argument-list entry, if any, between  <b>'['</b> and <b>']'</b> characters.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Change</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>c</b><b>[</b><b>hange</b><b>][</b><b>!</b><b>][</b><i>count</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Enter <i>ex</i> text input mode; the input text shall replace the specified lines. The specified lines shall be copied into the unnamed buffer, which shall become a line mode buffer.<div class="spacer">
</div>
This command shall be affected by the <b>number</b> and <b>autoindent</b> edit options; following the command name with  <b>'!'</b> shall cause the <b>autoindent</b> edit option setting to be toggled for the duration of this command only.<div class="spacer">
</div>
<i>Current line</i>: Set to the last input line; if no lines were input, set to the line before the first address, or to the first line of the edit buffer if there are no lines preceding the first address, or to zero if the edit buffer is empty.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Change Directory</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>chd</b><b>[</b><b>ir</b><b>][</b><b>!</b><b>][</b><i>directory</i><b>]</b><b>cd</b><b>[</b><b>!</b><b>][</b><i>directory</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Change the current working directory to <i>directory</i>.<div class="spacer">
</div>
If no <i>directory</i> argument is specified, and the <i>HOME</i> environment variable is set to a non-null and non-empty value,  <i>directory</i> shall default to the value named in the <i>HOME</i> environment variable. If the  <i>HOME</i> environment variable is empty or is undefined, the default value of  <i>directory</i> is implementation-defined.<div class="spacer">
</div>
If no <b>'!'</b> is appended to the command name, and the edit buffer has been modified since the last complete write, and the current pathname does not begin with a  <b>'/'</b>, it shall be an error.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Copy</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>co</b><b>[</b><b>py</b><b>]</b> <i>1addr</i> <b>[</b><i>flags</i><b>]</b><br/>
<b>[</b><i>2addr</i><b>]</b> <b>t</b> <i>1addr</i> <b>[</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Copy the specified lines after the specified destination line; line zero specifies that the lines shall be placed at the beginning of the edit buffer.<div class="spacer">
</div>
<i>Current line</i>: Set to the last line copied.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Delete</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>d</b><b>[</b><b>elete</b><b>][</b><i>buffer</i><b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Delete the specified lines into a buffer (defaulting to the unnamed buffer), which shall become a line-mode buffer.<div class="spacer">
</div>
Flags can immediately follow the command name; see Command Line Parsing in ex .<div class="spacer">
</div>
<i>Current line</i>: Set to the line following the deleted lines, or to the last line in the edit buffer if that line is past the end of the edit buffer, or to zero if the edit buffer is empty.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Edit</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>e</b><b>[</b><b>dit</b><b>][</b><b>!</b><b>][</b><b>+</b><i>command</i><b>][</b><i>file</i><b>]</b><b>ex</b><b>[</b><b>!</b><b>][</b><b>+</b><i>command</i><b>][</b><i>file</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If no <b>'!'</b> is appended to the command name, and the edit buffer has been modified since the last complete write, it shall be an error.<div class="spacer">
</div>
If <i>file</i> is specified, replace the current contents of the edit buffer with the current contents of  <i>file</i>, and set the current pathname to  <i>file</i>. If <i>file</i> is not specified, replace the current contents of the edit buffer with the current contents of the file named by the current pathname. If for any reason the current contents of the file cannot be accessed, the edit buffer shall be empty.<div class="spacer">
</div>
The <b>+</b> <i>command</i> option shall be &lt;blank&gt;-delimited; &lt;blank&gt;s within  <b>+</b> <i>command</i> can be escaped by preceding them with a backslash character. The  <b>+</b>  <i>command</i> shall be interpreted as an <i>ex</i> command immediately after the contents of the edit buffer have been replaced and the current line and column have been set.<div class="spacer">
</div>
If the edit buffer is empty:<div class="spacer">
</div>
<i>Current line</i>: Set to 0.<div class="spacer">
</div>
<i>Current column</i>: Set to 1.<div class="spacer">
</div>
Otherwise, if executed while in <i>ex</i> command mode or if the <b>+</b>  <i>command</i> argument is specified:<div class="spacer">
</div>
<i>Current line</i>: Set to the last line of the edit buffer.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.<div class="spacer">
</div>
Otherwise, if <i>file</i> is omitted or results in the current pathname:<div class="spacer">
</div>
<i>Current line</i>: Set to the first line of the edit buffer.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.<div class="spacer">
</div>
Otherwise, if <i>file</i> is the same as the last file edited, the line and column shall be set as follows; if the file was previously edited, the line and column may be set as follows:<div class="spacer">
</div>
<i>Current line</i>: Set to the last value held when that file was last edited. If this value is not a valid line in the new edit buffer, set to the first line of the edit buffer.<div class="spacer">
</div>
<i>Current column</i>: If the current line was set to the last value held when the file was last edited, set to the last value held when the file was last edited. Otherwise, or if the last value is not a valid column in the new edit buffer, set to non- &lt;blank&gt;.<div class="spacer">
</div>
Otherwise:<div class="spacer">
</div>
<i>Current line</i>: Set to the first line of the edit buffer.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>File</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>f</b><b>[</b><b>ile</b><b>][</b><i>file</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If a <i>file</i> argument is specified, the alternate pathname shall be set to the current pathname, and the current pathname shall be set to  <i>file</i>.<div class="spacer">
</div>
Write an informational message. If the file has a current pathname, it shall be included in this message; otherwise, the message shall indicate that there is no current pathname. If the edit buffer contains lines, the current line number and the number of lines in the edit buffer shall be included in this message; otherwise, the message shall indicate that the edit buffer is empty. If the edit buffer has been modified since the last complete write, this fact shall be included in this message. If the  <b>readonly</b> edit option is set, this fact shall be included in this message. The message may contain other unspecified information.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Global</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>g</b><b>[</b><b>lobal</b><b>]</b> <b>/</b><i>pattern</i><b>/</b> <b>[</b><i>commands</i><b>]</b><br/>
<b>[</b><i>2addr</i><b>]</b> <b>v /</b><i>pattern</i><b>/</b> <b>[</b><i>commands</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
The optional <b>'!'</b> character after the <b>global</b> command shall be the same as executing the  <b>v</b> command.<div class="spacer">
</div>
If <i>pattern</i> is empty (for example, <b>&quot;//&quot;</b> ) or not specified, the last regular expression used in the editor command shall be used as the  <i>pattern</i>. The <i>pattern</i> can be delimited by slashes (shown in the Synopsis), as well as any non-alphanumeric or non- &lt;blank&gt; other than backslash, vertical line, double quote, or &lt;newline&gt;.<div class="spacer">
</div>
If no lines are specified, the lines shall default to the entire file.<div class="spacer">
</div>
The <b>global</b> and <b>v</b> commands are logically two-pass operations. First, mark the lines within the specified lines for which the line excluding the terminating &lt;newline&gt; matches (  <b>global</b>) or does not match (  <b>v</b> or <b>global!</b>) the specified pattern. Second, execute the  <i>ex</i> commands given by  <i>commands</i>, with the current line ( <b>'.'</b> ) set to each marked line. If an error occurs during this process, or the contents of the edit buffer are replaced (for example, by the  <i>ex</i> <b>:edit</b> command) an error message shall be written and no more commands resulting from the execution of this command shall be processed.<div class="spacer">
</div>
Multiple <i>ex</i> commands can be specified by entering multiple commands on a single line using a vertical line to delimit them, or one per line, by escaping each &lt;newline&gt; with a backslash.<div class="spacer">
</div>
If no commands are specified:<dl>
<dt>
 1.</dt>
<dd>
If in <i>ex</i> command mode, it shall be as if the <b>print</b> command were specified.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Otherwise, no command shall be executed.</dd>
</dl>
<div class="spacer">
</div>
For the <b>append</b>, <b>change</b>, and <b>insert</b> commands, the input text shall be included as part of the command, and the terminating period can be omitted if the command ends the list of commands. The  <b>open</b> and <b>visual</b> commands can be specified as one of the commands, in which case each marked line shall cause the editor to enter open or visual mode. If open or visual mode is exited using the  <i>vi</i> <b>Q</b> command, the current line shall be set to the next marked line, and open or visual mode reentered, until the list of marked lines is exhausted.<div class="spacer">
</div>
The <b>global</b>, <b>v</b>, and <b>undo</b> commands cannot be used in  <i>commands</i>. Marked lines may be deleted by commands executed for lines occurring earlier in the file than the marked lines. In this case, no commands shall be executed for the deleted lines.<div class="spacer">
</div>
If the remembered search direction is not set, the <b>global</b> and  <b>v</b> commands shall set it to forward.<div class="spacer">
</div>
The <b>autoprint</b> and <b>autoindent</b> edit options shall be inhibited for the duration of the  <b>g</b> or <b>v</b> command.<div class="spacer">
</div>
<i>Current line</i>: If no commands executed, set to the last marked line. Otherwise, as specified for the executed  <i>ex</i> commands.<div class="spacer">
</div>
<i>Current column</i>: If no commands are executed, set to non- &lt;blank&gt;; otherwise, as specified for the individual  <i>ex</i> commands.</div>
<div class="subsection">
<h2>Insert</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>1addr</i><b>]</b> <b>i</b><b>[</b><b>nsert</b><b>][</b><b>!</b><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Enter <i>ex</i> text input mode; the input text shall be placed before the specified line. If the line is zero or 1, the text shall be placed at the beginning of the edit buffer.<div class="spacer">
</div>
This command shall be affected by the <b>number</b> and <b>autoindent</b> edit options; following the command name with  <b>'!'</b> shall cause the <b>autoindent</b> edit option setting to be toggled for the duration of this command only.<div class="spacer">
</div>
<i>Current line</i>: Set to the last input line; if no lines were input, set to the line before the specified line, or to the first line of the edit buffer if there are no lines preceding the specified line, or zero if the edit buffer is empty.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Join</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>j</b><b>[</b><b>oin</b><b>][</b><b>!</b><b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If <i>count</i> is specified: If no address was specified, the  <b>join</b> command shall behave as if  <i>2addr</i> were the current line and the current line plus  <i>count</i> (.,. + <i>count</i>).<div class="spacer">
</div>
If one address was specified, the <b>join</b> command shall behave as if  <i>2addr</i> were the specified address and the specified address plus  <i>count</i> ( <i>addr</i>, <i>addr</i> + <i>count</i>).<div class="spacer">
</div>
If two addresses were specified, the <b>join</b> command shall behave as if an additional address, equal to the last address plus  <i>count</i> -1 ( <i>addr1</i>, <i>addr2</i>, <i>addr2</i> + <i>count</i> -1), was specified.<div class="spacer">
</div>
If this would result in a second address greater than the last line of the edit buffer, it shall be corrected to be equal to the last line of the edit buffer.<div class="spacer">
</div>
If no <i>count</i> is specified: If no address was specified, the  <b>join</b> command shall behave as if  <i>2addr</i> were the current line and the next line (.,. +1).<div class="spacer">
</div>
If one address was specified, the <b>join</b> command shall behave as if  <i>2addr</i> were the specified address and the next line (  <i>addr</i>, <i>addr</i> +1).<div class="spacer">
</div>
Join the text from the specified lines together into a single line, which shall replace the specified lines.<div class="spacer">
</div>
If a <b>'!'</b> character is appended to the command name, the <b>join</b> shall be without modification of any line, independent of the current locale.<div class="spacer">
</div>
Otherwise, in the POSIX locale, set the current line to the first of the specified lines, and then, for each subsequent line, proceed as follows:<dl>
<dt>
 1.</dt>
<dd>
Discard leading &lt;space&gt;s from the line to be joined.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
If the line to be joined is now empty, delete it, and skip steps 3 through 5.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
If the current line ends in a &lt;blank&gt;, or the first character of the line to be joined is a  <b>')'</b> character, join the lines without further modification.</dd>
</dl>
<dl>
<dt>
 4.</dt>
<dd>
If the last character of the current line is a <b>'.'</b>, join the lines with two &lt;space&gt;s between them.</dd>
</dl>
<dl>
<dt>
 5.</dt>
<dd>
Otherwise, join the lines with a single &lt;space&gt; between them.</dd>
</dl>
<div class="spacer">
</div>
<i>Current line</i>: Set to the first line specified.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>List</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>l</b><b>[</b><b>ist</b><b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
This command shall be equivalent to the <i>ex</i> command:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>p</b><b>[</b><b>rint</b><b>][</b><i>count</i><b>]</b> <b>l</b><b>[</b><i>flags</i><b>]</b><br/>
</div>
<div class="spacer">
</div>
See Print .</div>
<div class="subsection">
<h2>Map</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>map</b><b>[</b><b>!</b><b>][</b><i>lhs rhs</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If <i>lhs</i> and <i>rhs</i> are not specified:<dl>
<dt>
 1.</dt>
<dd>
If <b>'!'</b> is specified, write the current list of text input mode maps.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Otherwise, write the current list of command mode maps.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
Do nothing more.</dd>
</dl>
<div class="spacer">
</div>
Implementations may restrict the set of characters accepted in <i>lhs</i> or  <i>rhs</i>, except that printable characters and &lt;blank&gt;s shall not be restricted. Additional restrictions shall be implementation-defined. In both  <i>lhs</i> and <i>rhs</i>, any character can be escaped with a &lt;control&gt;-V, in which case the character shall not be used to delimit  <i>lhs</i> from  <i>rhs</i>, and the escaping &lt;control&gt;-V shall be discarded.<div class="spacer">
</div>
If the character <b>'!'</b> is appended to the <b>map</b> command name, the mapping shall be effective during open or visual text input mode rather than  <b>open</b> or <b>visual</b> command mode. This allows  <i>lhs</i> to have two different <b>map</b> definitions at the same time: one for command mode and one for text input mode.<div class="spacer">
</div>
For command mode mappings: When the  <i>lhs</i> is entered as any part of a <i>vi</i> command in open or visual mode (but not as part of the arguments to the command), the action shall be as if the corresponding  <i>rhs</i> had been entered.<div class="spacer">
</div>
If any character in the command, other than the first, is escaped using a &lt;control&gt;-V character, that character shall not be part of a match to an  <i>lhs</i>.<div class="spacer">
</div>
It is unspecified whether implementations shall support <b>map</b> commands where the  <i>lhs</i> is more than a single character in length, where the first character of the  <i>lhs</i> is printable.<div class="spacer">
</div>
If <i>lhs</i> contains more than one character and the first character is  <b>'#'</b>, followed by a sequence of digits corresponding to a numbered function key, then when this function key is typed it shall be mapped to  <i>rhs</i>. Characters other than digits following a  <b>'#'</b> character also represent the function key named by the characters in the  <i>lhs</i> following the  <b>'#'</b> and may be mapped to <i>rhs</i>. It is unspecified how function keys are named or what function keys are supported.<div class="spacer">
</div>
For text input mode mappings: When the  <i>lhs</i> is entered as any part of text entered in open or visual text input modes, the action shall be as if the corresponding  <i>rhs</i> had been entered.<div class="spacer">
</div>
If any character in the input text is escaped using a &lt;control&gt;-V character, that character shall not be part of a match to an  <i>lhs</i>.<div class="spacer">
</div>
It is unspecified whether the <i>lhs</i> text entered for subsequent  <b>map</b> or <b>unmap</b> commands is replaced with the  <i>rhs</i> text for the purposes of the screen display; regardless of whether or not the display appears as if the corresponding  <i>rhs</i> text was entered, the effect of the command shall be as if the  <i>lhs</i> text was entered.<div class="spacer">
</div>
If only part of the <i>lhs</i> is entered, it is unspecified how long the editor will wait for additional, possibly matching characters before treating the already entered characters as not matching the  <i>lhs</i>.<div class="spacer">
</div>
The <i>rhs</i> characters shall themselves be subject to remapping, unless otherwise specified by the  <b>remap</b> edit option, except that if the characters in  <i>lhs</i> occur as prefix characters in  <i>rhs</i>, those characters shall not be remapped.<div class="spacer">
</div>
On block-mode terminals, the mapping need not occur immediately (for example, it may occur after the terminal transmits a group of characters to the system), but it shall achieve the same results as if it occurred immediately.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Mark</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>1addr</i><b>]</b> <b>ma</b><b>[</b><b>rk</b><b>]</b> <i>character</i><br/>
<i></i><b>[</b><i>1addr</i><b>]</b> <b>k</b> <i>character</i><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Implementations shall support <i>character</i> values of a single lowercase letter of the POSIX locale and the characters  <b>'`'</b> and <b>'&quot;</b> ; support of other characters is implementation-defined.<div class="spacer">
</div>
If executing the <i>vi</i> <b>m</b> command, set the specified mark to the current line and 1-based numbered character referenced by the current column, if any; otherwise, column position 1.<div class="spacer">
</div>
Otherwise, set the specified mark to the specified line and 1-based numbered first non- &lt;blank&gt; non- &lt;newline&gt; in the line, if any; otherwise, the last non- &lt;newline&gt; in the line, if any; otherwise, column position 1.<div class="spacer">
</div>
The mark shall remain associated with the line until the mark is reset or the line is deleted. If a deleted line is restored by a subsequent  <b>undo</b> command, any marks previously associated with the line, which have not been reset, shall be restored as well. Any use of a mark not associated with a current line in the edit buffer shall be an error.<div class="spacer">
</div>
The marks <b>`</b> and <b>'</b> shall be set as described previously, immediately before the following events occur in the editor:<dl>
<dt>
 1.</dt>
<dd>
The use of <b>'$'</b> as an <i>ex</i> address</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
The use of a positive decimal number as an <i>ex</i> address</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
The use of a search command as an <i>ex</i> address</dd>
</dl>
<dl>
<dt>
 4.</dt>
<dd>
The use of a mark reference as an <i>ex</i> address</dd>
</dl>
<dl>
<dt>
 5.</dt>
<dd>
The use of the following open and visual mode commands: &lt;control&gt;-],  <b>%</b>, <b>(</b>, <b>)</b>, <b>[</b>, <b>]</b>,  <b>{</b>, <b>}</b></dd>
</dl>
<dl>
<dt>
 6.</dt>
<dd>
The use of the following open and visual mode commands: <b>'</b>, <b>G</b>,  <b>H</b>, <b>L</b>, <b>M</b>, <b>z</b> if the current line will change as a result of the command</dd>
</dl>
<dl>
<dt>
 7.</dt>
<dd>
The use of the open and visual mode commands: <b>/</b>, <b>?</b>, <b>N</b>,  <b>`</b>, <b>n</b> if the current line or column will change as a result of the command</dd>
</dl>
<dl>
<dt>
 8.</dt>
<dd>
The use of the <i>ex</i> mode commands: <b>z</b>, <b>undo</b>, <b>global</b>,  <b>v</b></dd>
</dl>
<div class="spacer">
</div>
For rules 1., 2., 3., and 4., the <b>`</b> and <b>'</b> marks shall not be set if the  <i>ex</i> command is parsed as specified by rule 6.a. in Command Line Parsing in ex .<div class="spacer">
</div>
For rules 5., 6., and 7., the <b>`</b> and <b>'</b> marks shall not be set if the commands are used as motion commands in open and visual mode.<div class="spacer">
</div>
For rules 1., 2., 3., 4., 5., 6., 7., and 8., the <b>`</b> and <b>'</b> marks shall not be set if the command fails.<div class="spacer">
</div>
The <b>`</b> and <b>'</b> marks shall be set as described previously, each time the contents of the edit buffer are replaced (including the editing of the initial buffer), if in open or visual mode, or if in  <b>ex</b> mode and the edit buffer is not empty, before any commands or movements (including commands or movements specified by the  <b>-c</b> or <b>-t</b> options or the <b>+</b>  <i>command</i> argument) are executed on the edit buffer. If in open or visual mode, the marks shall be set as if executing the  <i>vi</i>  <b>m</b> command; otherwise, as if executing the <i>ex</i> <b>mark</b> command.<div class="spacer">
</div>
When changing from <b>ex</b> mode to open or visual mode, if the <b>`</b> and  <b>'</b> marks are not already set, the <b>`</b> and  <b>'</b> marks shall be set as described previously.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Move</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>m</b><b>[</b><b>ove</b><b>]</b> <i>1addr</i> <b></b><b>[</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Move the specified lines after the specified destination line. A destination of line zero specifies that the lines shall be placed at the beginning of the edit buffer. It shall be an error if the destination line is within the range of lines to be moved.<div class="spacer">
</div>
<i>Current line</i>: Set to the last of the moved lines.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Next</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>n</b><b>[</b><b>ext</b><b>][</b><b>!</b><b>][</b><b>+</b><i>command</i><b>][</b><i>file</i> <b>...</b><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If no <b>'!'</b> is appended to the command name, and the edit buffer has been modified since the last complete write, it shall be an error, unless the file is successfully written as specified by the  <b>autowrite</b> option.<div class="spacer">
</div>
If one or more files is specified:<dl>
<dt>
 1.</dt>
<dd>
Set the argument list to the specified filenames.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Set the current argument list reference to be the first entry in the argument list.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
Set the current pathname to the first filename specified.</dd>
</dl>
<div class="spacer">
</div>
Otherwise:<dl>
<dt>
 1.</dt>
<dd>
It shall be an error if there are no more filenames in the argument list after the filename currently referenced.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Set the current pathname and the current argument list reference to the filename after the filename currently referenced in the argument list.</dd>
</dl>
<div class="spacer">
</div>
Replace the contents of the edit buffer with the contents of the file named by the current pathname. If for any reason the contents of the file cannot be accessed, the edit buffer shall be empty.<div class="spacer">
</div>
This command shall be affected by the <b>autowrite</b> and <b>writeany</b> edit options.<div class="spacer">
</div>
The <b>+</b> <i>command</i> option shall be &lt;blank&gt;-delimited; &lt;blank&gt;s can be escaped by preceding them with a backslash character. The  <b>+</b> <i>command</i> shall be interpreted as an  <i>ex</i> command immediately after the contents of the edit buffer have been replaced and the current line and column have been set.<div class="spacer">
</div>
<i>Current line</i>: Set as described for the <b>edit</b> command.<div class="spacer">
</div>
<i>Current column</i>: Set as described for the <b>edit</b> command.</div>
<div class="subsection">
<h2>Number</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>nu</b><b>[</b><b>mber</b><b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b><br/>
<b>[</b><i>2addr</i><b>]</b> <b>#</b><b>[</b><i>count</i><b>][</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
These commands shall be equivalent to the <i>ex</i> command:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>p</b><b>[</b><b>rint</b><b>][</b><i>count</i><b>]</b> <b>#</b><b>[</b><i>flags</i><b>]</b><br/>
</div>
<div class="spacer">
</div>
See Print .</div>
<div class="subsection">
<h2>Open</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>1addr</i><b>]</b> <b>o</b><b>[</b><b>pen</b><b>]</b> <b>/</b><i>pattern</i><b>/</b> <b>[</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
This command need not be supported on block-mode terminals or terminals with insufficient capabilities. If standard input, standard output, or standard error are not terminal devices, the results are unspecified.<div class="spacer">
</div>
Enter open mode.<div class="spacer">
</div>
The trailing delimiter can be omitted from <i>pattern</i> at the end of the command line. If  <i>pattern</i> is empty (for example,  <b>&quot;//&quot;</b> ) or not specified, the last regular expression used in the editor shall be used as the pattern. The pattern can be delimited by slashes (shown in the Synopsis), as well as any alphanumeric, or non- &lt;blank&gt; other than backslash, vertical line, double quote, or &lt;newline&gt;.<div class="spacer">
</div>
<i>Current line</i>: Set to the specified line.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Preserve</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>pre</b><b>[</b><b>serve</b><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Save the edit buffer in a form that can later be recovered by using the  <b>-r</b> option or by using the <i>ex</i>  <b>recover</b> command. After the file has been preserved, a mail message shall be sent to the user. This message shall be readable by invoking the  <i>mailx</i> utility. The message shall contain the name of the file, the time of preservation, and an  <i>ex</i> command that could be used to recover the file. Additional information may be included in the mail message.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Print</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>p</b><b>[</b><b>rint</b><b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Write the addressed lines. The behavior is unspecified if the number of columns on the display is less than the number of columns required to write any single character in the lines being written.<div class="spacer">
</div>
Non-printable characters, except for the &lt;tab&gt;, shall be written as implementation-defined multi-character sequences.<div class="spacer">
</div>
If the <b>#</b> flag is specified or the <b>number</b> edit option is set, each line shall be preceded by its line number in the following format:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>&quot;%6d  &quot;, &lt;</b><i>line number</i><b>&gt;</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
If the <b>l</b> flag is specified or the <b>list</b> edit option is set:<dl>
<dt>
 1.</dt>
<dd>
The characters listed in the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001, Table 5-1, Escape Sequences and Associated Actions shall be written as the corresponding escape sequence.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Non-printable characters not in the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001, Table 5-1, Escape Sequences and Associated Actions shall be written as one three-digit octal number (with a preceding backslash) for each byte in the character (most significant byte first). If the size of a byte on the system is greater than 9 bits, the format used for non-printable characters is implementation-defined.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
The end of each line shall be marked with a <b>'$'</b>, and literal  <b>'$'</b> characters within the line shall be written with a preceding backslash.</dd>
</dl>
<div class="spacer">
</div>
Long lines shall be folded; the length at which folding occurs is unspecified, but should be appropriate for the output terminal, considering the number of columns of the terminal.<div class="spacer">
</div>
If a line is folded, and the <b>l</b> flag is not specified and the  <b>list</b> edit option is not set, it is unspecified whether a multi-column character at the folding position is separated; it shall not be discarded.<div class="spacer">
</div>
<i>Current line</i>: Set to the last written line.<div class="spacer">
</div>
<i>Current column</i>: Unchanged if the current line is unchanged; otherwise, set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Put</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>1addr</i><b>]</b> <b>pu</b><b>[</b><b>t</b><b>][</b><i>buffer</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Append text from the specified buffer (by default, the unnamed buffer) to the specified line; line zero specifies that the text shall be placed at the beginning of the edit buffer. Each portion of a line in the buffer shall become a new line in the edit buffer, regardless of the mode of the buffer.<div class="spacer">
</div>
<i>Current line</i>: Set to the last line entered into the edit buffer.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Quit</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>q</b><b>[</b><b>uit</b><b>][</b><b>!</b><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If no <b>'!'</b> is appended to the command name:<dl>
<dt>
 1.</dt>
<dd>
If the edit buffer has been modified since the last complete write, it shall be an error.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
If there are filenames in the argument list after the filename currently referenced, and the last command was not a  <b>quit</b>,  <b>wq</b>, <b>xit</b>, or <b>ZZ</b> (see <i>Exit</i> ) command, it shall be an error.</dd>
</dl>
<div class="spacer">
</div>
Otherwise, terminate the editing session.</div>
<div class="subsection">
<h2>Read</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>1addr</i><b>]</b> <b>r</b><b>[</b><b>ead</b><b>][</b><b>!</b><b>][</b><i>file</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If <b>'!'</b> is not the first non- &lt;blank&gt; to follow the command name, a copy of the specified file shall be appended into the edit buffer after the specified line; line zero specifies that the copy shall be placed at the beginning of the edit buffer. The number of lines and bytes read shall be written. If no  <i>file</i> is named, the current pathname shall be the default. If there is no current pathname, then  <i>file</i> shall become the current pathname. If there is no current pathname or  <i>file</i> operand, it shall be an error. Specifying a  <i>file</i> that is not of type regular shall have unspecified results.<div class="spacer">
</div>
Otherwise, if <i>file</i> is preceded by <b>'!'</b>, the rest of the line after the  <b>'!'</b> shall have <b>'%'</b>,  <b>'#'</b>, and <b>'!'</b> characters expanded as described in Command Line Parsing in ex .<div class="spacer">
</div>
The <i>ex</i> utility shall then pass two arguments to the program named by the shell edit option; the first shall be  <b>-c</b> and the second shall be the expanded arguments to the  <b>read</b> command as a single argument. The standard input of the program shall be set to the standard input of the  <i>ex</i> program when it was invoked. The standard error and standard output of the program shall be appended into the edit buffer after the specified line.<div class="spacer">
</div>
Each line in the copied file or program output (as delimited by &lt;newline&gt;s or the end of the file or output if it is not immediately preceded by a &lt;newline&gt;), shall be a separate line in the edit buffer. Any occurrences of &lt;carriage-return&gt; and &lt;newline&gt; pairs in the output shall be treated as single &lt;newline&gt;s.<div class="spacer">
</div>
The special meaning of the <b>'!'</b> following the <b>read</b> command can be overridden by escaping it with a backslash character.<div class="spacer">
</div>
<i>Current line</i>: If no lines are added to the edit buffer, unchanged. Otherwise, if in open or visual mode, set to the first line entered into the edit buffer. Otherwise, set to the last line entered into the edit buffer.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Recover</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>rec</b><b>[</b><b>over</b><b>][</b><b>!</b><b>]</b> <i>file</i><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If no <b>'!'</b> is appended to the command name, and the edit buffer has been modified since the last complete write, it shall be an error.<div class="spacer">
</div>
If no <i>file</i> operand is specified, then the current pathname shall be used. If there is no current pathname or  <i>file</i> operand, it shall be an error.<div class="spacer">
</div>
If no recovery information has previously been saved about <i>file</i>, the  <b>recover</b> command shall behave identically to the  <b>edit</b> command, and an informational message to this effect shall be written.<div class="spacer">
</div>
Otherwise, set the current pathname to <i>file</i>, and replace the current contents of the edit buffer with the recovered contents of  <i>file</i>. If there are multiple instances of the file to be recovered, the one most recently saved shall be recovered, and an informational message that there are previous versions of the file that can be recovered shall be written. The editor shall behave as if the contents of the edit buffer have already been modified.<div class="spacer">
</div>
<i>Current file</i>: Set as described for the <b>edit</b> command.<div class="spacer">
</div>
<i>Current column</i>: Set as described for the <b>edit</b> command.</div>
<div class="subsection">
<h2>Rewind</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>rew</b><b>[</b><b>ind</b><b>][</b><b>!</b><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If no <b>'!'</b> is appended to the command name, and the edit buffer has been modified since the last complete write, it shall be an error, unless the file is successfully written as specified by the  <b>autowrite</b> option.<div class="spacer">
</div>
If the argument list is empty, it shall be an error.<div class="spacer">
</div>
The current argument list reference and the current pathname shall be set to the first filename in the argument list.<div class="spacer">
</div>
Replace the contents of the edit buffer with the contents of the file named by the current pathname. If for any reason the contents of the file cannot be accessed, the edit buffer shall be empty.<div class="spacer">
</div>
This command shall be affected by the <b>autowrite</b> and <b>writeany</b> edit options.<div class="spacer">
</div>
<i>Current line</i>: Set as described for the <b>edit</b> command.<div class="spacer">
</div>
<i>Current column</i>: Set as described for the <b>edit</b> command.</div>
<div class="subsection">
<h2>Set</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>se</b><b>[</b><b>t</b><b>][</b><i>option</i><b>[</b><b>=</b><b>[</b><i>value</i><b>]]</b> <b>...</b><b>][</b><b>no</b><i>option</i> <b>...</b><b>][</b><i>option</i><b>? ...</b><b>][</b><b>all</b><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
When no arguments are specified, write the value of the <b>term</b> edit option and those options whose values have been changed from the default settings; when the argument  <i>all</i> is specified, write all of the option values.<div class="spacer">
</div>
Giving an option name followed by the character <b>'?'</b> shall cause the current value of that option to be written. The  <b>'?'</b> can be separated from the option name by zero or more &lt;blank&gt;s. The  <b>'?'</b> shall be necessary only for Boolean valued options. Boolean options can be given values by the form  <b>set</b> <i>option</i> to turn them on or <b>set</b>  <b>no</b> <i>option</i> to turn them off; string and numeric options can be assigned by the form  <b>set</b> <i>option</i>=  <i>value</i>. Any &lt;blank&gt;s in strings can be included as is by preceding each &lt;blank&gt; with an escaping backslash. More than one option can be set or listed by a single set command by specifying multiple arguments, each separated from the next by one or more &lt;blank&gt;s.<div class="spacer">
</div>
See Edit Options in ex for details about specific options.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Shell</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>sh</b><b>[</b><b>ell</b><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Invoke the program named in the <b>shell</b> edit option with the single argument  <b>-i</b> (interactive mode). Editing shall be resumed when the program exits.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Source</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>so</b><b>[</b><b>urce</b><b>]</b> <i>file</i><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Read and execute <i>ex</i> commands from <i>file</i>. Lines in the file that are blank lines shall be ignored.<div class="spacer">
</div>
<i>Current line</i>: As specified for the individual <i>ex</i> commands.<div class="spacer">
</div>
<i>Current column</i>: As specified for the individual <i>ex</i> commands.</div>
<div class="subsection">
<h2>Substitute</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>s</b><b>[</b><b>ubstitute</b><b>][</b><b>/</b><i>pattern</i><b>/</b><i>repl</i><b>/</b><b>[</b><i>options</i><b>][</b><i>count</i><b>][</b><i>flags</i><b>]]</b><b></b><div style="height: 0.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
<b></b><b>[</b><b></b><i>2addr</i><b></b><b>]</b><b> </b><b>&amp;</b><b></b><b>[</b><b></b><i>options</i><b></b><b>][</b><b></b><i>count</i><b></b><b>][</b><b></b><i>flags</i><b></b><b>]]</b><b></b><b></b><div style="height: 0.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
<b></b><b>[</b><b></b><i>2addr</i><b></b><b>]</b><b> </b><b>~</b><b></b><b>[</b><b></b><i>options</i><b></b><b>][</b><b></b><i>count</i><b></b><b>][</b><b></b><i>flags</i><b></b><b>]]</b><b></b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Replace the first instance of the pattern <i>pattern</i> by the string  <i>repl</i> on each specified line. (See Regular Expressions in ex and Replacement Strings in ex .) Any non-alphabetic, non- &lt;blank&gt; delimiter other than  <b>'\'</b>, <b>'|'</b>, double quote, or &lt;newline&gt; can be used instead of  <b>'/'</b> . Backslash characters can be used to escape delimiters, backslash characters, and other special characters.<div class="spacer">
</div>
The trailing delimiter can be omitted from <i>pattern</i> or from <i>repl</i> at the end of the command line. If both  <i>pattern</i> and <i>repl</i> are not specified or are empty (for example,  <b>&quot;//&quot;</b> ), the last <b>s</b> command shall be repeated. If only  <i>pattern</i> is not specified or is empty, the last regular expression used in the editor shall be used as the pattern. If only  <i>repl</i> is not specified or is empty, the pattern shall be replaced by nothing. If the entire replacement pattern is  <b>'%'</b>, the last replacement pattern to an <b>s</b> command shall be used.<div class="spacer">
</div>
Entering a &lt;carriage-return&gt; in <i>repl</i> (which requires an escaping backslash in  <i>ex</i> mode and an escaping &lt;control&gt;-V in open or  <i>vi</i> mode) shall split the line at that point, creating a new line in the edit buffer. The &lt;carriage-return&gt; shall be discarded.<div class="spacer">
</div>
If <i>options</i> includes the letter <b>'g'</b> ( <b>global</b>), all non-overlapping instances of the pattern in the line shall be replaced.<div class="spacer">
</div>
If <i>options</i> includes the letter <b>'c'</b> ( <b>confirm</b>), then before each substitution the line shall be written; the written line shall reflect all previous substitutions. On the following line, &lt;space&gt;s shall be written beneath the characters from the line that are before the  <i>pattern</i> to be replaced, and  <b>'^'</b> characters written beneath the characters included in the  <i>pattern</i> to be replaced. The <i>ex</i> utility shall then wait for a response from the user. An affirmative response shall cause the substitution to be done, while any other input shall not make the substitution. An affirmative response shall consist of a line with the affirmative response (as defined by the current locale) at the beginning of the line. This line shall be subject to editing in the same way as the  <i>ex</i> command line.<div class="spacer">
</div>
If interrupted (see the ASYNCHRONOUS EVENTS section), any modifications confirmed by the user shall be preserved in the edit buffer after the interrupt.<div class="spacer">
</div>
If the remembered search direction is not set, the <b>s</b> command shall set it to forward.<div class="spacer">
</div>
In the second Synopsis, the <b>&amp;</b> command shall repeat the previous substitution, as if the  <b>&amp;</b> command were replaced by:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>s/</b><i>pattern</i><b>/</b><i>repl</i><b>/</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
where <i>pattern</i> and <i>repl</i> are as specified in the previous  <b>s</b>, <b>&amp;</b>, or <b>~</b> command.<div class="spacer">
</div>
In the third Synopsis, the <b>~</b> command shall repeat the previous substitution, as if the  <b>'~'</b> were replaced by:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>s/</b><i>pattern</i><b>/</b><i>repl</i><b>/</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
where <i>pattern</i> shall be the last regular expression specified to the editor, and  <i>repl</i> shall be from the previous substitution (including  <b>&amp;</b> and <b>~</b>) command.<div class="spacer">
</div>
These commands shall be affected by the <i>LC_MESSAGES</i> environment variable.<div class="spacer">
</div>
<i>Current line</i>: Set to the last line in which a substitution occurred, or, unchanged if no substitution occurred.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Suspend</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>su</b><b>[</b><b>spend</b><b>][</b><b>!</b><b>]</b><b>st</b><b>[</b><b>op</b><b>][</b><b>!</b><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Allow control to return to the invoking process; <i>ex</i> shall suspend itself as if it had received the SIGTSTP signal. The suspension shall occur only if job control is enabled in the invoking shell (see the description of  <i>set</i> <b>-m</b>).<div class="spacer">
</div>
These commands shall be affected by the <b>autowrite</b> and <b>writeany</b> edit options.<div class="spacer">
</div>
The current <b>susp</b> character (see <i>stty</i> ) shall be equivalent to the  <b>suspend</b> command.</div>
<div class="subsection">
<h2>Tag</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>ta</b><b>[</b><b>g</b><b>][</b><b>!</b><b>]</b> <i>tagstring</i><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
The results are unspecified if the format of a tags file is not as specified by the  <i>ctags</i> utility (see <i>ctags</i> ) description.<div class="spacer">
</div>
The <b>tag</b> command shall search for <i>tagstring</i> in the tag files referred to by the  <b>tag</b> edit option, in the order they are specified, until a reference to  <i>tagstring</i> is found. Files shall be searched from beginning to end. If no reference is found, it shall be an error and an error message to this effect shall be written. If the reference is not found, or if an error occurs while processing a file referred to in the  <b>tag</b> edit option, it shall be an error, and an error message shall be written at the first occurrence of such an error.<div class="spacer">
</div>
Otherwise, if the tags file contained a pattern, the pattern shall be treated as a regular expression used in the editor; for example, for the purposes of the  <b>s</b> command.<div class="spacer">
</div>
If the <i>tagstring</i> is in a file with a different name than the current pathname, set the current pathname to the name of that file, and replace the contents of the edit buffer with the contents of that file. In this case, if no  <b>'!'</b> is appended to the command name, and the edit buffer has been modified since the last complete write, it shall be an error, unless the file is successfully written as specified by the  <b>autowrite</b> option.<div class="spacer">
</div>
This command shall be affected by the <b>autowrite</b>, <b>tag</b>,  <b>taglength</b>, and <b>writeany</b> edit options.<div class="spacer">
</div>
<i>Current line</i>: If the tags file contained a line number, set to that line number. If the line number is larger than the last line in the edit buffer, an error message shall be written and the current line shall be set as specified for the  <b>edit</b> command.<div class="spacer">
</div>
If the tags file contained a pattern, set to the first occurrence of the pattern in the file. If no matching pattern is found, an error message shall be written and the current line shall be set as specified for the  <b>edit</b> command.<div class="spacer">
</div>
<i>Current column</i>: If the tags file contained a line-number reference and that line-number was not larger than the last line in the edit buffer, or if the tags file contained a pattern and that pattern was found, set to non- &lt;blank&gt;. Otherwise, set as specified for the  <b>edit</b> command.</div>
<div class="subsection">
<h2>Unabbreviate</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>una</b><b>[</b><b>bbrev</b><b>]</b> <i>lhs</i><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If <i>lhs</i> is not an entry in the current list of abbreviations (see Abbreviate ), it shall be an error. Otherwise, delete  <i>lhs</i> from the list of abbreviations.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Undo</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>u</b><b>[</b><b>ndo</b><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Reverse the changes made by the last command that modified the contents of the edit buffer, including  <b>undo</b>. For this purpose, the  <b>global</b>, <b>v</b>, <b>open</b>, and <b>visual</b> commands, and commands resulting from buffer executions and mapped character expansions, are considered single commands.<div class="spacer">
</div>
If no action that can be undone preceded the <b>undo</b> command, it shall be an error.<div class="spacer">
</div>
If the <b>undo</b> command restores lines that were marked, the mark shall also be restored unless it was reset subsequent to the deletion of the lines.<div class="spacer">
</div>
<i>Current line</i>:<dl>
<dt>
 1.</dt>
<dd>
If lines are added or changed in the file, set to the first line added or changed.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Set to the line before the first line deleted, if it exists.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
Set to 1 if the edit buffer is not empty.</dd>
</dl>
<dl>
<dt>
 4.</dt>
<dd>
Set to zero.</dd>
</dl>
<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Unmap</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>unm</b><b>[</b><b>ap</b><b>][</b><b>!</b><b>]</b> <i>lhs</i><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If <b>'!'</b> is appended to the command name, and if <i>lhs</i> is not an entry in the list of text input mode map definitions, it shall be an error. Otherwise, delete  <i>lhs</i> from the list of text input mode map definitions.<div class="spacer">
</div>
If no <b>'!'</b> is appended to the command name, and if <i>lhs</i> is not an entry in the list of command mode map definitions, it shall be an error. Otherwise, delete  <i>lhs</i> from the list of command mode map definitions.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Version</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>ve</b><b>[</b><b>rsion</b><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Write a message containing version information for the editor. The format of the message is unspecified.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Visual</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>1addr</i><b>]</b> <b>vi</b><b>[</b><b>sual</b><b>][</b><i>type</i><b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If <i>ex</i> is currently in open or visual mode, the Synopsis and behavior of the visual command shall be the same as the  <b>edit</b> command, as specified by Edit .<div class="spacer">
</div>
Otherwise, this command need not be supported on block-mode terminals or terminals with insufficient capabilities. If standard input, standard output, or standard error are not terminal devices, the results are unspecified.<div class="spacer">
</div>
If <i>count</i> is specified, the value of the <b>window</b> edit option shall be set to  <i>count</i> (as described in window ). If the <b>'^'</b> type character was also specified, the  <b>window</b> edit option shall be set before being used by the type character.<div class="spacer">
</div>
Enter visual mode. If <i>type</i> is not specified, it shall be as if a  <i>type</i> of <b>'+'</b> was specified. The  <i>type</i> shall cause the following effects:<dl>
<dt>
<b>+</b></dt>
<dd>
Place the beginning of the specified line at the top of the display.</dd>
</dl>
<dl>
<dt>
<b>-</b></dt>
<dd>
Place the end of the specified line at the bottom of the display.</dd>
</dl>
<dl>
<dt>
<b>.</b></dt>
<dd>
Place the beginning of the specified line in the middle of the display.</dd>
</dl>
<dl>
<dt>
<b>^</b></dt>
<dd>
If the specified line is less than or equal to the value of the <b>window</b> edit option, set the line to 1; otherwise, decrement the line by the value of the  <b>window</b> edit option minus 1. Place the beginning of this line as close to the bottom of the displayed lines as possible, while still displaying the value of the  <b>window</b> edit option number of lines.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
<i>Current line</i>: Set to the specified line.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Write</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>w</b><b>[</b><b>rite</b><b>][</b><b>!</b><b>][</b><b>&gt;&gt;</b><b>][</b><i>file</i><b>]</b><br/>
<b>[</b><i>2addr</i><b>]</b> <b>w</b><b>[</b><b>rite</b><b>][</b><b>!</b><b>][</b><i>file</i><b>]</b><br/>
<b>[</b><i>2addr</i><b>]</b> <b>wq</b><b>[</b><b>!</b><b>][</b><b>&gt;&gt;</b><b>][</b><i>file</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If no lines are specified, the lines shall default to the entire file.<div class="spacer">
</div>
The command <b>wq</b> shall be equivalent to a <b>write</b> command followed by a  <b>quit</b> command; <b>wq!</b> shall be equivalent to  <b>write!</b> followed by <b>quit</b>. In both cases, if the  <b>write</b> command fails, the <b>quit</b> shall not be attempted.<div class="spacer">
</div>
If the command name is not followed by one or more &lt;blank&gt;s, or <i>file</i> is not preceded by a  <b>'!'</b> character, the  <b>write</b> shall be to a file.<dl>
<dt>
 1.</dt>
<dd>
If the <b>&gt;&gt;</b> argument is specified, and the file already exists, the lines shall be appended to the file instead of replacing its contents. If the  <b>&gt;&gt;</b> argument is specified, and the file does not already exist, it is unspecified whether the write shall proceed as if the  <b>&gt;&gt;</b> argument had not been specified or if the write shall fail.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
If the <b>readonly</b> edit option is set (see readonly ), the <b>write</b> shall fail.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
If <i>file</i> is specified, and is not the current pathname, and the file exists, the  <b>write</b> shall fail.</dd>
</dl>
<dl>
<dt>
 4.</dt>
<dd>
If <i>file</i> is not specified, the current pathname shall be used. If there is no current pathname, the  <b>write</b> command shall fail.</dd>
</dl>
<dl>
<dt>
 5.</dt>
<dd>
If the current pathname is used, and the current pathname has been changed by the  <b>file</b> or <b>read</b> commands, and the file exists, the  <b>write</b> shall fail. If the <b>write</b> is successful, subsequent  <b>write</b>s shall not fail for this reason (unless the current pathname is changed again).</dd>
</dl>
<dl>
<dt>
 6.</dt>
<dd>
If the whole edit buffer is not being written, and the file to be written exists, the  <b>write</b> shall fail.</dd>
</dl>
<div class="spacer">
</div>
For rules 1., 2., 4., and 5., the <b>write</b> can be forced by appending the character  <b>'!'</b> to the command name.<div class="spacer">
</div>
For rules 2., 4., and 5., the <b>write</b> can be forced by setting the  <b>writeany</b> edit option.<div class="spacer">
</div>
Additional, implementation-defined tests may cause the <b>write</b> to fail.<div class="spacer">
</div>
If the edit buffer is empty, a file without any contents shall be written.<div class="spacer">
</div>
An informational message shall be written noting the number of lines and bytes written.<div class="spacer">
</div>
Otherwise, if the command is followed by one or more &lt;blank&gt;s, and the file is preceded by  <b>'!'</b>, the rest of the line after the  <b>'!'</b> shall have <b>'%'</b>, <b>'#'</b>, and <b>'!'</b> characters expanded as described in Command Line Parsing in ex .<div class="spacer">
</div>
The <i>ex</i> utility shall then pass two arguments to the program named by the  <b>shell</b> edit option; the first shall be  <b>-c</b> and the second shall be the expanded arguments to the <b>write</b> command as a single argument. The specified lines shall be written to the standard input of the command. The standard error and standard output of the program, if any, shall be written as described for the  <b>print</b> command. If the last character in that output is not a &lt;newline&gt;, a &lt;newline&gt; shall be written at the end of the output.<div class="spacer">
</div>
The special meaning of the <b>'!'</b> following the <b>write</b> command can be overridden by escaping it with a backslash character.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Write and Exit</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>x</b><b>[</b><b>it</b><b>][</b><b>!</b><b>][</b><i>file</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If the edit buffer has not been modified since the last complete <b>write</b>,  <b>xit</b> shall be equivalent to the <b>quit</b> command, or if a  <b>'!'</b> is appended to the command name, to <b>quit!</b>.<div class="spacer">
</div>
Otherwise, <b>xit</b> shall be equivalent to the <b>wq</b> command, or if a  <b>'!'</b> is appended to the command name, to  <b>wq!</b>.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Yank</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>ya</b><b>[</b><b>nk</b><b>][</b><i>buffer</i><b>][</b><i>count</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Copy the specified lines to the specified buffer (by default, the unnamed buffer), which shall become a line-mode buffer.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Adjust Window</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>1addr</i><b>]</b> <b>z</b><b>[</b><b>!</b><b>][</b><i>type</i> <b>...</b><b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If no line is specified, the current line shall be the default; if  <i>type</i> is omitted as well, the current line value shall first be incremented by 1. If incrementing the current line would cause it to be greater than the last line in the edit buffer, it shall be an error.<div class="spacer">
</div>
If there are &lt;blank&gt;s between the <i>type</i> argument and the preceding  <b>z</b> command name or optional <b>'!'</b> character, it shall be an error.<div class="spacer">
</div>
If <i>count</i> is specified, the value of the <b>window</b> edit option shall be set to  <i>count</i> (as described in window ). If <i>count</i> is omitted, it shall default to 2 times the value of the  <b>scroll</b> edit option, or if  <b>!</b> was specified, the number of lines in the display minus 1.<div class="spacer">
</div>
If <i>type</i> is omitted, then <i>count</i> lines starting with the specified line shall be written. Otherwise,  <i>count</i> lines starting with the line specified by the  <i>type</i> argument shall be written.<div class="spacer">
</div>
The <i>type</i> argument shall change the lines to be written. The possible values of  <i>type</i> are as follows:<dl>
<dt>
<b>-</b></dt>
<dd>
The specified line shall be decremented by the following value:<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>(((number of &quot;-&quot; characters) x</b> <i>count</i><b>) -1)</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
If the calculation would result in a number less than 1, it shall be an error. Write lines from the edit buffer, starting at the new value of line, until  <i>count</i> lines or the last line in the edit buffer has been written.<dl>
<dt>
<b>+</b></dt>
<dd>
The specified line shall be incremented by the following value:<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>(((number of &quot;+&quot; characters) -1) x</b> <i>count</i><b>) +1</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
If the calculation would result in a number greater than the last line in the edit buffer, it shall be an error. Write lines from the edit buffer, starting at the new value of line, until  <i>count</i> lines or the last line in the edit buffer has been written.<dl>
<dt>
<b>=</b>,<b>.</b></dt>
<dd>
If more than a single <b>'.'</b> or <b>'='</b> is specified, it shall be an error. The following steps shall be taken:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 1.</dt>
<dd>
If <i>count</i> is zero, nothing shall be written.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Write as many of the <i>N</i> lines before the current line in the edit buffer as exist. If  <i>count</i> or <b>'!'</b> was specified,  <i>N</i> shall be:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>(</b><i>count</i> <b>-1) /2</b><br/>
<b></b><br/>
</div>
</dd>
</dl>
<div class="spacer">
</div>
Otherwise, <i>N</i> shall be:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>(</b><i>count</i> <b>-3) /2</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
If <i>N</i> is a number less than 3, no lines shall be written.<dl>
<dt>
 3.</dt>
<dd>
If <b>'='</b> was specified as the type character, write a line consisting of the smaller of the number of columns in the display divided by two, or 40  <b>'-'</b> characters.</dd>
</dl>
<dl>
<dt>
 4.</dt>
<dd>
Write the current line.</dd>
</dl>
<dl>
<dt>
 5.</dt>
<dd>
Repeat step 3.</dd>
</dl>
<dl>
<dt>
 6.</dt>
<dd>
Write as many of the <i>N</i> lines after the current line in the edit buffer as exist.  <i>N</i> shall be defined as in step 2. If  <i>N</i> is a number less than 3, no lines shall be written. If  <i>count</i> is less than 3, no lines shall be written.</dd>
</dl>
</div>
<dl>
<dt>
<b>^</b></dt>
<dd>
The specified line shall be decremented by the following value:<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>(((number of &quot;^&quot; characters) +1) x</b> <i>count</i><b>) -1</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
If the calculation would result in a number less than 1, it shall be an error. Write lines from the edit buffer, starting at the new value of line, until  <i>count</i> lines or the last line in the edit buffer has been written.<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
<i>Current line</i>: Set to the last line written, unless the type is  <b>=</b>, in which case, set to the specified line.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Escape</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>!</b> <i>command</i><br/>
<i></i><b>[</b><i>addr</i><b>]</b><b>!</b> <i>command</i><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
The contents of the line after the <b>'!'</b> shall have <b>'%'</b>,  <b>'#'</b>, and <b>'!'</b> characters expanded as described in Command Line Parsing in ex . If the expansion causes the text of the line to change, it shall be redisplayed, preceded by a single  <b>'!'</b> character.<div class="spacer">
</div>
The <i>ex</i> utility shall execute the program named by the <b>shell</b> edit option. It shall pass two arguments to the program; the first shall be  <b>-c</b>, and the second shall be the expanded arguments to the  <b>!</b> command as a single argument.<div class="spacer">
</div>
If no lines are specified, the standard input, standard output, and standard error of the program shall be set to the standard input, standard output, and standard error of the  <i>ex</i> program when it was invoked. In addition, a warning message shall be written if the edit buffer has been modified since the last complete write, and the  <b>warn</b> edit option is set.<div class="spacer">
</div>
If lines are specified, they shall be passed to the program as standard input, and the standard output and standard error of the program shall replace those lines in the edit buffer. Each line in the program output (as delimited by &lt;newline&gt;s or the end of the output if it is not immediately preceded by a &lt;newline&gt;), shall be a separate line in the edit buffer. Any occurrences of &lt;carriage-return&gt; and &lt;newline&gt; pairs in the output shall be treated as single &lt;newline&gt;s. The specified lines shall be copied into the unnamed buffer before they are replaced, and the unnamed buffer shall become a line-mode buffer.<div class="spacer">
</div>
If in <i>ex</i> mode, a single <b>'!'</b> character shall be written when the program completes.<div class="spacer">
</div>
This command shall be affected by the <b>shell</b> and <b>warn</b> edit options. If no lines are specified, this command shall be affected by the  <b>autowrite</b> and <b>writeany</b> edit options. If lines are specified, this command shall be affected by the  <b>autoprint</b> edit option.<div class="spacer">
</div>
<i>Current line</i>:<dl>
<dt>
 1.</dt>
<dd>
If no lines are specified, unchanged.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Otherwise, set to the last line read in, if any lines are read in.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
Otherwise, set to the line before the first line of the lines specified, if that line exists.</dd>
</dl>
<dl>
<dt>
 4.</dt>
<dd>
Otherwise, set to the first line of the edit buffer if the edit buffer is not empty.</dd>
</dl>
<dl>
<dt>
 5.</dt>
<dd>
Otherwise, set to zero.</dd>
</dl>
<div class="spacer">
</div>
<i>Current column</i>: If no lines are specified, unchanged. Otherwise, set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Shift Left</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>&lt;</b><b>[</b><b>&lt; ...</b><b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Shift the specified lines to the start of the line; the number of column positions to be shifted shall be the number of command characters times the value of the  <b>shiftwidth</b> edit option. Only leading &lt;blank&gt;s shall be deleted or changed into other &lt;blank&gt;s in shifting; other characters shall not be affected.<div class="spacer">
</div>
Lines to be shifted shall be copied into the unnamed buffer, which shall become a line-mode buffer.<div class="spacer">
</div>
This command shall be affected by the <b>autoprint</b> edit option.<div class="spacer">
</div>
<i>Current line</i>: Set to the last line in the lines specified.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Shift Right</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>&gt;</b><b>[</b><b>&gt; ...</b><b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Shift the specified lines away from the start of the line; the number of column positions to be shifted shall be the number of command characters times the value of the  <b>shiftwidth</b> edit option. The shift shall be accomplished by adding &lt;blank&gt;s as a prefix to the line or changing leading &lt;blank&gt;s into other &lt;blank&gt;s. Empty lines shall not be changed.<div class="spacer">
</div>
Lines to be shifted shall be copied into the unnamed buffer, which shall become a line-mode buffer.<div class="spacer">
</div>
This command shall be affected by the <b>autoprint</b> edit option.<div class="spacer">
</div>
<i>Current line</i>: Set to the last line in the lines specified.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>&lt;control&gt;-D</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>&lt;control&gt;-D</b><br/>
<b></b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Write the next <i>n</i> lines, where <i>n</i> is the minimum of the values of the  <b>scroll</b> edit option and the number of lines after the current line in the edit buffer. If the current line is the last line of the edit buffer it shall be an error.<div class="spacer">
</div>
<i>Current line</i>: Set to the last line written.<div class="spacer">
</div>
<i>Current column</i>: Set to non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Write Line Number</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>1addr</i><b>]</b> <b>=</b> <b>[</b><i>flags</i><b>]</b><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If <i>line</i> is not specified, it shall default to the last line in the edit buffer. Write the line number of the specified line.<div class="spacer">
</div>
<i>Current line</i>: Unchanged.<div class="spacer">
</div>
<i>Current column</i>: Unchanged.</div>
<div class="subsection">
<h2>Execute</h2><dl>
<dt>
<i>Synopsis</i>:</dt>
<dd>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>[</b><i>2addr</i><b>]</b> <b>@</b> <i>buffer</i><b>[</b><i>2addr</i><b>]</b> <b>*</b> <i>buffer</i><br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
If no buffer is specified or is specified as <b>'@'</b> or <b>'*'</b>, the last buffer executed shall be used. If no previous buffer has been executed, it shall be an error.<div class="spacer">
</div>
For each line specified by the addresses, set the current line ( <b>'.'</b> ) to the specified line, and execute the contents of the named  <i>buffer</i> (as they were at the time the <b>@</b> command was executed) as  <i>ex</i> commands. For each line of a line-mode buffer, and all but the last line of a character-mode buffer, the  <i>ex</i> command parser shall behave as if the line was terminated by a &lt;newline&gt;.<div class="spacer">
</div>
If an error occurs during this process, or a line specified by the addresses does not exist when the current line would be set to it, or more than a single line was specified by the addresses, and the contents of the edit buffer are replaced (for example, by the  <i>ex</i> <b>:edit</b> command) an error message shall be written, and no more commands resulting from the execution of this command shall be processed.<div class="spacer">
</div>
<i>Current line</i>: As specified for the individual <i>ex</i> commands.<div class="spacer">
</div>
<i>Current column</i>: As specified for the individual <i>ex</i> commands.</div>
<div class="subsection">
<h2>Regular Expressions in ex</h2> The  <i>ex</i> utility shall support regular expressions that are a superset of the basic regular expressions described in the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001, Section 9.3, Basic Regular Expressions. A null regular expression (  <b>&quot;//&quot;</b> ) shall be equivalent to the last regular expression encountered.<div class="spacer">
</div>
Regular expressions can be used in addresses to specify lines and, in some commands (for example, the  <b>substitute</b> command), to specify portions of a line to be substituted.<div class="spacer">
</div>
The following constructs can be used to enhance the basic regular expressions:<dl>
<dt>
<b>\&lt;</b></dt>
<dd>
Match the beginning of a <i>word</i>. (See the definition of <i>word</i> at the beginning of Command Descriptions in ex .)</dd>
</dl>
<dl>
<dt>
<b>\&gt;</b></dt>
<dd>
Match the end of a <i>word</i>.</dd>
</dl>
<dl>
<dt>
<b>~</b></dt>
<dd>
Match the replacement part of the last <b>substitute</b> command. The tilde (  <b>'~'</b> ) character can be escaped in a regular expression to become a normal character with no special meaning. The backslash shall be discarded.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
When the editor option <b>magic</b> is not set, the only characters with special meanings shall be  <b>'^'</b> at the beginning of a pattern,  <b>'$'</b> at the end of a pattern, and <b>'\'</b> . The characters  <b>'.'</b>, <b>'*'</b>, <b>'['</b>, and  <b>'~'</b> shall be treated as ordinary characters unless preceded by a  <b>'\'</b> ; when preceded by a <b>'\'</b> they shall regain their special meaning, or in the case of backslash, be handled as a single backslash. Backslashes used to escape other characters shall be discarded.</div>
<div class="subsection">
<h2>Replacement Strings in ex</h2> The character  <b>'&amp;'</b> ( <b>'\&amp;'</b> if the editor option <b>magic</b> is not set) in the replacement string shall stand for the text matched by the pattern to be replaced. The character  <b>'~'</b> ( <b>'\~'</b> if <b>magic</b> is not set) shall be replaced by the replacement part of the previous  <b>substitute</b> command. The sequence <b>'\n'</b>, where  <i>n</i> is an integer, shall be replaced by the text matched by the pattern enclosed in the  <i>n</i>th set of parentheses  <b>'\('</b> and <b>'\)'</b> .<div class="spacer">
</div>
The strings <b>'\l'</b>, <b>'\u'</b>, <b>'\L'</b>, and <b>'\U'</b> can be used to modify the case of elements in the replacement string (using the  <b>'\&amp;'</b> or <b>&quot;\&quot;</b> digit) notation. The string  <b>'\l'</b> ( <b>'\u'</b> ) shall cause the character that follows to be converted to lowercase (uppercase). The string  <b>'\L'</b> ( <b>'\U'</b> ) shall cause all characters subsequent to it to be converted to lowercase (uppercase) as they are inserted by the substitution until the string  <b>'\e'</b> or <b>'\E'</b>, or the end of the replacement string, is encountered.<div class="spacer">
</div>
Otherwise, any character following a backslash shall be treated as that literal character, and the escaping backslash shall be discarded.<div class="spacer">
</div>
An example of case conversion with the <b>s</b> command is as follows:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:</b><b>p</b><br/>
<b></b><b>The cat sat on the mat.</b><br/>
<b>:</b><b>s/\&lt;.at\&gt;/\u&amp;/gp</b><br/>
<b></b><b>The Cat Sat on the Mat.</b><br/>
<b>:</b><b>s/S\(.*\)M/S\U\1\eM/p</b><br/>
<b></b><b>The Cat SAT ON THE Mat.</b><br/>
</div>
</div>
<div class="subsection">
<h2>Edit Options in ex</h2> The  <i>ex</i> utility has a number of options that modify its behavior. These options have default settings, which can be changed using the  <b>set</b> command.<div class="spacer">
</div>
Options are Boolean unless otherwise specified.</div>
<div class="subsection">
<h2>autoindent, ai</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
If <b>autoindent</b> is set, each line in input mode shall be indented (using first as many &lt;tab&gt;s as possible, as determined by the editor option  <b>tabstop</b>, and then using &lt;space&gt;s) to align with another line, as follows:<dl>
<dt>
 1.</dt>
<dd>
If in open or visual mode and the text input is part of a line-oriented command (see the EXTENDED DESCRIPTION in  <i>vi</i> ), align to the first column.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Otherwise, if in open or visual mode, indentation for each line shall be set as follows:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 a.</dt>
<dd>
If a line was previously inserted as part of this command, it shall be set to the indentation of the last inserted line by default, or as otherwise specified for the &lt;control&gt;-D character in  <i>Input Mode Commands</i>  <i>in vi</i> .</dd>
</dl>
<dl>
<dt>
 b.</dt>
<dd>
Otherwise, it shall be set to the indentation of the previous current line, if any; otherwise, to the first column.</dd>
</dl>
</div>
<dl>
<dt>
 3.</dt>
<dd>
For the <i>ex</i> <b>a</b>, <b>i</b>, and <b>c</b> commands, indentation for each line shall be set as follows:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 a.</dt>
<dd>
If a line was previously inserted as part of this command, it shall be set to the indentation of the last inserted line by default, or as otherwise specified for the  <i>eof</i> character in Scroll .</dd>
</dl>
<dl>
<dt>
 b.</dt>
<dd>
Otherwise, if the command is the <i>ex</i> <b>a</b> command, it shall be set to the line appended after, if any; otherwise to the first column.</dd>
</dl>
<dl>
<dt>
 c.</dt>
<dd>
Otherwise, if the command is the <i>ex</i> <b>i</b> command, it shall be set to the line inserted before, if any; otherwise to the first column.</dd>
</dl>
<dl>
<dt>
 d.</dt>
<dd>
Otherwise, if the command is the <i>ex</i> <b>c</b> command, it shall be set to the indentation of the line replaced.</dd>
</dl>
</div>
</div>
<div class="subsection">
<h2>autoprint, ap</h2> [Default  <i>set</i>]<div class="spacer">
</div>
If <b>autoprint</b> is set, the current line shall be written after each  <i>ex</i> command that modifies the contents of the current edit buffer, and after each  <b>tag</b> command for which the tag search pattern was found or tag line number was valid, unless:<dl>
<dt>
 1.</dt>
<dd>
The command was executed while in open or visual mode.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
The command was executed as part of a <b>global</b> or <b>v</b> command or  <b>@</b> buffer execution.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
The command was the form of the <b>read</b> command that reads a file into the edit buffer.</dd>
</dl>
<dl>
<dt>
 4.</dt>
<dd>
The command was the <b>append</b>, <b>change</b>, or <b>insert</b> command.</dd>
</dl>
<dl>
<dt>
 5.</dt>
<dd>
The command was not terminated by a &lt;newline&gt;.</dd>
</dl>
<dl>
<dt>
 6.</dt>
<dd>
The current line shall be written by a flag specified to the command; for example,  <b>delete #</b> shall write the current line as specified for the flag modifier to the  <b>delete</b> command, and not as specified by the  <b>autoprint</b> edit option.</dd>
</dl>
</div>
<div class="subsection">
<h2>autowrite, aw</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
If <b>autowrite</b> is set, and the edit buffer has been modified since it was last completely written to any file, the contents of the edit buffer shall be written as if the  <i>ex</i> <b>write</b> command had been specified without arguments, before each command affected by the  <b>autowrite</b> edit option is executed. Appending the character  <b>'!'</b> to the command name of any of the  <i>ex</i> commands except <b>'!'</b> shall prevent the write. If the write fails, it shall be an error and the command shall not be executed.</div>
<div class="subsection">
<h2>beautify, bf</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
If <b>beautify</b> is set, all non-printable characters, other than &lt;tab&gt;s, &lt;newline&gt;s, and &lt;form-feed&gt;s, shall be discarded from text read in from files.</div>
<div class="subsection">
<h2>directory, dir</h2> [Default  <i>implementation-defined</i>]<div class="spacer">
</div>
The value of this option specifies the directory in which the editor buffer is to be placed. If this directory is not writable by the user, the editor shall quit.</div>
<div class="subsection">
<h2>edcompatible, ed</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
Causes the presence of <b>g</b> and <b>c</b> suffixes on substitute commands to be remembered, and toggled by repeating the suffixes.</div>
<div class="subsection">
<h2>errorbells, eb</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
If the editor is in <i>ex</i> mode, and the terminal does not support a standout mode (such as inverse video), and  <b>errorbells</b> is set, error messages shall be preceded by alerting the terminal.</div>
<div class="subsection">
<h2>exrc</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
If <b>exrc</b> is set, <i>ex</i> shall access any <b>.exrc</b> file in the current directory, as described in Initialization in ex and vi . If  <b>exrc</b> is not set, <i>ex</i> shall ignore any <b>.exrc</b> file in the current directory during initialization, unless the current directory is that named by the  <i>HOME</i> environment variable.</div>
<div class="subsection">
<h2>ignorecase, ic</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
If <b>ignorecase</b> is set, characters that have uppercase and lowercase representations shall have those representations considered as equivalent for purposes of regular expression comparison.<div class="spacer">
</div>
The <b>ignorecase</b> edit option shall affect all remembered regular expressions; for example, unsetting the  <b>ignorecase</b> edit option shall cause a subsequent  <i>vi</i> <b>n</b> command to search for the last basic regular expression in a case-sensitive fashion.</div>
<div class="subsection">
<h2>list</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
If <b>list</b> is set, edit buffer lines written while in <i>ex</i> command mode shall be written as specified for the  <b>print</b> command with the <b>l</b> flag specified. In open or visual mode, each edit buffer line shall be displayed as specified for the  <i>ex</i> <b>print</b> command with the <b>l</b> flag specified. In open or visual text input mode, when the cursor does not rest on any character in the line, it shall rest on the  <b>'$'</b> marking the end of the line.</div>
<div class="subsection">
<h2>magic</h2> [Default  <i>set</i>]<div class="spacer">
</div>
If <b>magic</b> is set, modify the interpretation of characters in regular expressions and substitution replacement strings (see Regular Expressions in ex and Replacement Strings in ex ).</div>
<div class="subsection">
<h2>mesg</h2> [Default  <i>set</i>]<div class="spacer">
</div>
If <b>mesg</b> is set, the permission for others to use the <b>write</b> or  <b>talk</b> commands to write to the terminal shall be turned on while in open or visual mode. The shell-level command  <i>mesg</i> <b>n</b> shall take precedence over any setting of the  <i>ex</i> <b>mesg</b> option; that is, if  <b>mesg y</b> was issued before the editor started (or in a shell escape), such as:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:!mesg y</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
the <b>mesg</b> option in <i>ex</i> shall suppress incoming messages, but the  <b>mesg</b> option shall not enable incoming messages if  <b>mesg n</b> was issued.</div>
<div class="subsection">
<h2>number, nu</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
If <b>number</b> is set, edit buffer lines written while in <i>ex</i> command mode shall be written with line numbers, in the format specified by the  <b>print</b> command with the <b>#</b> flag specified. In  <i>ex</i> text input mode, each line shall be preceded by the line number it will have in the file.<div class="spacer">
</div>
In open or visual mode, each edit buffer line shall be displayed with a preceding line number, in the format specified by the  <i>ex</i> <b>print</b> command with the <b>#</b> flag specified. This line number shall not be considered part of the line for the purposes of evaluating the current column; that is, column position 1 shall be the first column position after the format specified by the  <b>print</b> command.</div>
<div class="subsection">
<h2>paragraphs, para</h2> [Default in the POSIX locale  <b>IPLPPPQPP LIpplpipbp</b>]<div class="spacer">
</div>
The <b>paragraphs</b> edit option shall define additional paragraph boundaries for the open and visual mode commands. The  <b>paragraphs</b> edit option can be set to a character string consisting of zero or more character pairs. It shall be an error to set it to an odd number of characters.</div>
<div class="subsection">
<h2>prompt</h2> [Default  <i>set</i>]<div class="spacer">
</div>
If <b>prompt</b> is set, <i>ex</i> command mode input shall be prompted for with a colon (  <b>':'</b> ); when unset, no prompt shall be written.</div>
<div class="subsection">
<h2>readonly</h2> [Default  <i>see text</i>]<div class="spacer">
</div>
If the <b>readonly</b> edit option is set, read-only mode shall be enabled (see Write ). The  <b>readonly</b> edit option shall be initialized to set if either of the following conditions are true:<dl>
<dt>
 *</dt>
<dd>
The command-line option -R was specified.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
Performing actions equivalent to the <i>access</i>() function called with the following arguments indicates that the file lacks write permission:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
 1.</dt>
<dd>
The current pathname is used as the <i>path</i> argument.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
The constant <b>W_OK</b> is used as the <i>amode</i> argument.</dd>
</dl>
</div>
<div class="spacer">
</div>
The <b>readonly</b> edit option may be initialized to set for other, implementation-defined reasons. The  <b>readonly</b> edit option shall not be initialized to unset based on any special privileges of the user or process. The  <b>readonly</b> edit option shall be reinitialized each time that the contents of the edit buffer are replaced (for example, by an  <b>edit</b> or <b>next</b> command) unless the user has explicitly set it, in which case it shall remain set until the user explicitly unsets it. Once unset, it shall again be reinitialized each time that the contents of the edit buffer are replaced.</div>
<div class="subsection">
<h2>redraw</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
The editor simulates an intelligent terminal on a dumb terminal. (Since this is likely to require a large amount of output to the terminal, it is useful only at high transmission speeds.)</div>
<div class="subsection">
<h2>remap</h2> [Default  <i>set</i>]<div class="spacer">
</div>
If <b>remap</b> is set, map translation shall allow for maps defined in terms of other maps; translation shall continue until a final product is obtained. If unset, only a one-step translation shall be done.</div>
<div class="subsection">
<h2>report</h2> [Default 5]<div class="spacer">
</div>
The value of this <b>report</b> edit option specifies what number of lines being added, copied, deleted, or modified in the edit buffer will cause an informational message to be written to the user. The following conditions shall cause an informational message. The message shall contain the number of lines added, copied, deleted, or modified, but is otherwise unspecified.<dl>
<dt>
 *</dt>
<dd>
An <i>ex</i> or <i>vi</i> editor command, other than <b>open</b>, <b>undo</b>, or  <b>visual</b>, that modifies at least the value of the <b>report</b> edit option number of lines, and which is not part of an  <i>ex</i> <b>global</b> or <b>v</b> command, or <i>ex</i> or <i>vi</i> buffer execution, shall cause an informational message to be written.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
An <i>ex</i> <b>yank</b> or <i>vi</i> <b>y</b> or <b>Y</b> command, that copies at least the value of the  <b>report</b> edit option plus 1 number of lines, and which is not part of an  <i>ex</i> <b>global</b> or <b>v</b> command, or  <i>ex</i> or <i>vi</i> buffer execution, shall cause an informational message to be written.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
An <i>ex</i> <b>global</b>, <b>v</b>, <b>open</b>, <b>undo</b>, or <b>visual</b> command or  <i>ex</i> or <i>vi</i> buffer execution, that adds or deletes a total of at least the value of the  <b>report</b> edit option number of lines, and which is not part of an  <i>ex</i> <b>global</b> or  <b>v</b> command, or <i>ex</i> or <i>vi</i> buffer execution, shall cause an informational message to be written. (For example, if 3 lines were added and 8 lines deleted during an  <i>ex</i> <b>visual</b> command, 5 would be the number compared against the  <b>report</b> edit option after the command completed.)</dd>
</dl>
</div>
<div class="subsection">
<h2>scroll, scr</h2> [Default (number of lines in the display -1)/2]<div class="spacer">
</div>
The value of the <b>scroll</b> edit option shall determine the number of lines scrolled by the  <i>ex</i> &lt;control&gt;-D and  <b>z</b> commands. For the <i>vi</i> &lt;control&gt;-D and &lt;control&gt;-U commands, it shall be the initial number of lines to scroll when no previous &lt;control&gt;-D or &lt;control&gt;-U command has been executed.</div>
<div class="subsection">
<h2>sections</h2> [Default in the POSIX locale  <b>NHSHH HUnhsh</b>]<div class="spacer">
</div>
The <b>sections</b> edit option shall define additional section boundaries for the open and visual mode commands. The  <b>sections</b> edit option can be set to a character string consisting of zero or more character pairs; it shall be an error to set it to an odd number of characters.</div>
<div class="subsection">
<h2>shell, sh</h2> [Default from the environment variable  <i>SHELL ]</i><div class="spacer">
</div>
The value of this option shall be a string. The default shall be taken from the  <i>SHELL</i> environment variable. If the  <i>SHELL</i> environment variable is null or empty, the <i>sh</i> (see  <i>sh</i> ) utility shall be the default.</div>
<div class="subsection">
<h2>shiftwidth, sw</h2> [Default 8]<div class="spacer">
</div>
The value of this option shall give the width in columns of an indentation level used during autoindentation and by the shift commands (  <b>&lt;</b> and <b>&gt;</b>).</div>
<div class="subsection">
<h2>showmatch, sm</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
The functionality described for the <b>showmatch</b> edit option need not be supported on block-mode terminals or terminals with insufficient capabilities.<div class="spacer">
</div>
If <b>showmatch</b> is set, in open or visual mode, when a <b>')'</b> or  <b>'}'</b> is typed, if the matching <b>'('</b> or  <b>'{'</b> is currently visible on the display, the matching <b>'('</b> or  <b>'{'</b> shall be flagged moving the cursor to its location for an unspecified amount of time.</div>
<div class="subsection">
<h2>showmode</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
If <b>showmode</b> is set, in open or visual mode, the current mode that the editor is in shall be displayed on the last line of the display. Command mode and text input mode shall be differentiated; other unspecified modes and implementation-defined information may be displayed.</div>
<div class="subsection">
<h2>slowopen</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
If <b>slowopen</b> is set during open and visual text input modes, the editor shall not update portions of the display other than those display line columns that display the characters entered by the user (see  <i>Input</i>  <i>Mode Commands in vi</i> ).</div>
<div class="subsection">
<h2>tabstop, ts</h2> [Default 8]<div class="spacer">
</div>
The value of this edit option shall specify the column boundary used by a &lt;tab&gt; in the display (see autoprint, ap and  <i>Input Mode Commands</i>  <i>in vi</i> ).</div>
<div class="subsection">
<h2>taglength, tl</h2> [Default zero]<div class="spacer">
</div>
The value of this edit option shall specify the maximum number of characters that are considered significant in the user-specified tag name and in the tag name from the tags file. If the value is zero, all characters in both tag names shall be significant.</div>
<div class="subsection">
<h2>tags</h2> [Default  <i>see text</i>]<div class="spacer">
</div>
The value of this edit option shall be a string of &lt;blank&gt;-delimited pathnames of files used by the  <b>tag</b> command. The default value is unspecified.</div>
<div class="subsection">
<h2>term</h2> [Default from the environment variable  <i>TERM ]</i><div class="spacer">
</div>
The value of this edit option shall be a string. The default shall be taken from the  <i>TERM</i> variable in the environment. If the  <i>TERM</i> environment variable is empty or null, the default is unspecified. The editor shall use the value of this edit option to determine the type of the display device.<div class="spacer">
</div>
The results are unspecified if the user changes the value of the term edit option after editor initialization.</div>
<div class="subsection">
<h2>terse</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
If <b>terse</b> is set, error messages may be less verbose. However, except for this caveat, error messages are unspecified. Furthermore, not all error messages need change for different settings of this option.</div>
<div class="subsection">
<h2>warn</h2> [Default  <i>set</i>]<div class="spacer">
</div>
If <b>warn</b> is set, and the contents of the edit buffer have been modified since they were last completely written, the editor shall write a warning message before certain  <b>!</b> commands (see Escape ).</div>
<div class="subsection">
<h2>window</h2> [Default  <i>see text</i>]<div class="spacer">
</div>
A value used in open and visual mode, by the &lt;control&gt;-B and &lt;control&gt;-F commands, and, in visual mode, to specify the number of lines displayed when the screen is repainted.<div class="spacer">
</div>
If the <b>-w</b> command-line option is not specified, the default value shall be set to the value of the  <i>LINES</i> environment variable. If the  <i>LINES</i> environment variable is empty or null, the default shall be the number of lines in the display minus 1.<div class="spacer">
</div>
Setting the <b>window</b> edit option to zero or to a value greater than the number of lines in the display minus 1 (either explicitly or based on the  <b>-w</b> option or the <i>LINES</i> environment variable) shall cause the  <b>window</b> edit option to be set to the number of lines in the display minus 1.<div class="spacer">
</div>
The baud rate of the terminal line may change the default in an implementation-defined manner.</div>
<div class="subsection">
<h2>wrapmargin, wm</h2> [Default 0]<div class="spacer">
</div>
If the value of this edit option is zero, it shall have no effect.<div class="spacer">
</div>
If not in the POSIX locale, the effect of this edit option is implementation-defined.<div class="spacer">
</div>
Otherwise, it shall specify a number of columns from the ending margin of the terminal.<div class="spacer">
</div>
During open and visual text input modes, for each character for which any part of the character is displayed in a column that is less than  <b>wrapmargin</b> columns from the ending margin of the display line, the editor shall behave as follows:<dl>
<dt>
 1.</dt>
<dd>
If the character triggering this event is a &lt;blank&gt;, it, and all immediately preceding &lt;blank&gt;s on the current line entered during the execution of the current text input command, shall be discarded, and the editor shall behave as if the user had entered a single &lt;newline&gt; instead. In addition, if the next user-entered character is a &lt;space&gt;, it shall be discarded as well.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Otherwise, if there are one or more &lt;blank&gt;s on the current line immediately preceding the last group of inserted non- &lt;blank&gt;s which was entered during the execution of the current text input command, the &lt;blank&gt;s shall be replaced as if the user had entered a single &lt;newline&gt; instead.</dd>
</dl>
<div class="spacer">
</div>
If the <b>autoindent</b> edit option is set, and the events described in 1. or 2. are performed, any &lt;blank&gt;s at or after the cursor in the current line shall be discarded.<div class="spacer">
</div>
The ending margin shall be determined by the system or overridden by the user, as described for  <i>COLUMNS</i> in the ENVIRONMENT VARIABLES section and the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001, Chapter 8, Environment Variables.</div>
<div class="subsection">
<h2>wrapscan, ws</h2> [Default  <i>set</i>]<div class="spacer">
</div>
If <b>wrapscan</b> is set, searches (the <i>ex</i> <b>/</b> or <b>?</b> addresses, or open and visual mode  <b>/</b>, <b>?</b>,  <b>N</b>, and <b>n</b> commands) shall wrap around the beginning or end of the edit buffer; when unset, searches shall stop at the beginning or end of the edit buffer.</div>
<div class="subsection">
<h2>writeany, wa</h2> [Default  <i>unset</i>]<div class="spacer">
</div>
If <b>writeany</b> is set, some of the checks performed when executing the  <i>ex</i> <b>write</b> commands shall be inhibited, as described in editor option  <b>autowrite</b>.</div>
</div>
<div class="section">
<h1>EXIT STATUS</h1> The following exit values shall be returned:<dl>
<dt>
&#160;0</dt>
<dd>
Successful completion.</dd>
</dl>
<dl>
<dt>
&gt;0</dt>
<dd>
An error occurred.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>CONSEQUENCES OF ERRORS</h1> When any error is encountered and the standard input is not a terminal device file,  <i>ex</i> shall not write the file or return to command or text input mode, and shall terminate with a non-zero exit status.<div class="spacer">
</div>
Otherwise, when an unrecoverable error is encountered, it shall be equivalent to a SIGHUP asynchronous event.<div class="spacer">
</div>
Otherwise, when an error is encountered, the editor shall behave as specified in Command Line Parsing in ex .<div class="spacer">
</div>
<i>The following sections are informative.</i></div>
<div class="section">
<h1>APPLICATION USAGE</h1> If a SIGSEGV signal is received while  <i>ex</i> is saving a file, the file might not be successfully saved.<div class="spacer">
</div>
The <b>next</b> command can accept more than one file, so usage such as:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>next `ls [abc]*`</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
is valid; it would not be valid for the <b>edit</b> or <b>read</b> commands, for example, because they expect only one file and unspecified results occur.</div>
<div class="section">
<h1>EXAMPLES</h1> None.</div>
<div class="section">
<h1>RATIONALE</h1> The  <i>ex</i>/ <i>vi</i> specification is based on the historical practice found in the 4 BSD and System V implementations of  <i>ex</i> and <i>vi</i>. A freely redistributable implementation of  <i>ex</i>/ <i>vi</i>, which is tracking IEEE&#160;Std&#160;1003.1-2001 fairly closely, and demonstrates the intended changes between historical implementations and IEEE&#160;Std&#160;1003.1-2001, may be obtained by anonymous FTP from:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>ftp://ftp.rdg.opengroup.org/pub/mirrors/nvi</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
A <i>restricted editor</i> (both the historical <i>red</i> utility and modifications to  <i>ex</i>) were considered and rejected for inclusion. Neither option provided the level of security that users might expect.<div class="spacer">
</div>
It is recognized that <i>ex</i> visual mode and related features would be difficult, if not impossible, to implement satisfactorily on a block-mode terminal, or a terminal without any form of cursor addressing; thus, it is not a mandatory requirement that such features should work on all terminals. It is the intention, however, that an  <i>ex</i> implementation should provide the full set of capabilities on all terminals capable of supporting them.<div class="subsection">
<h2>Options</h2> The  <b>-c</b> replacement for <b>+</b> <i>command</i> was inspired by the  <b>-e</b> option of <i>sed</i>. Historically, all such commands (see  <b>edit</b> and <b>next</b> as well) were executed from the last line of the edit buffer. This meant, for example, that  <b>&quot;+/pattern&quot;</b> would fail unless the <b>wrapscan</b> option was set. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice. Historically, some implementations restricted the  <i>ex</i> commands that could be listed as part of the command line arguments. For consistency, IEEE&#160;Std&#160;1003.1-2001 does not permit these restrictions.<div class="spacer">
</div>
In historical implementations of the editor, the <b>-R</b> option (and the  <b>readonly</b> edit option) only prevented overwriting of files; appending to files was still permitted, mapping loosely into the  <i>csh</i> <b>noclobber</b> variable. Some implementations, however, have not followed this semantic, and  <b>readonly</b> does not permit appending either. IEEE&#160;Std&#160;1003.1-2001 follows the latter practice, believing that it is a more obvious and intuitive meaning of  <b>readonly</b>.<div class="spacer">
</div>
The <b>-s</b> option suppresses all interactive user feedback and is useful for editing scripts in batch jobs. The list of specific effects is historical practice. The terminal type &quot;incapable of supporting open and visual modes&quot; has historically been named &quot;dumb&quot;.<div class="spacer">
</div>
The <b>-t</b> option was required because the <i>ctags</i> utility appears in IEEE&#160;Std&#160;1003.1-2001 and the option is available in all historical implementations of  <i>ex</i>.<div class="spacer">
</div>
Historically, the <i>ex</i> and <i>vi</i> utilities accepted a <b>-x</b> option, which did encryption based on the algorithm found in the historical  <i>crypt</i> utility. The  <b>-x</b> option for encryption, and the associated  <i>crypt</i> utility, were omitted because the algorithm used was not specifiable and the export control laws of some nations make it difficult to export cryptographic technology. In addition, it did not historically provide the level of security that users might expect.</div>
<div class="subsection">
<h2>Standard Input</h2> An end-of-file condition is not equivalent to an end-of-file character. A common end-of-file character, &lt;control&gt;-D, is historically an  <i>ex</i> command.<div class="spacer">
</div>
There was no maximum line length in historical implementations of  <i>ex</i>. Specifically, as it was parsed in chunks, the addresses had a different maximum length than the filenames. Further, the maximum line buffer size was declared as BUFSIZ, which was different lengths on different systems. This version selected the value of {LINE_MAX} to impose a reasonable restriction on portable usage of  <i>ex</i> and to aid test suite writers in their development of realistic tests that exercise this limit.</div>
<div class="subsection">
<h2>Input Files</h2> It was an explicit decision by the standard developers that a &lt;newline&gt; be added to any file lacking one. It was believed that this feature of  <i>ex</i> and <i>vi</i> was relied on by users in order to make text files lacking a trailing &lt;newline&gt; more portable. It is recognized that this will require a user-specified option or extension for implementations that permit  <i>ex</i> and <i>vi</i> to edit files of type other than text if such files are not otherwise identified by the system. It was agreed that the ability to edit files of arbitrary type can be useful, but it was not considered necessary to mandate that an  <i>ex</i> or  <i>vi</i> implementation be required to handle files other than text files.<div class="spacer">
</div>
The paragraph in the INPUT FILES section, &quot;By default, ...&quot;, is intended to close a long-standing security problem in  <i>ex</i> and <i>vi</i>; that of the &quot;modeline&quot; or &quot;modelines&quot; edit option. This feature allows any line in the first or last five lines of the file containing the strings  <b>&quot;ex:&quot;</b> or <b>&quot;vi:&quot;</b> (and, apparently,  <b>&quot;ei:&quot;</b> or <b>&quot;vx:&quot;</b> ) to be a line containing editor commands, and  <i>ex</i> interprets all the text up to the next  <b>':'</b> or &lt;newline&gt; as a command. Consider the consequences, for example, of an unsuspecting user using  <i>ex</i> or <i>vi</i> as the editor when replying to a mail message in which a line such as:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>ex:! rm -rf :</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
appeared in the signature lines. The standard developers believed strongly that an editor should not by default interpret any lines of a file. Vendors are strongly urged to delete this feature from their implementations of  <i>ex</i> and <i>vi</i>.</div>
<div class="subsection">
<h2>Asynchronous Events</h2> The intention of the phrase &quot;complete write&quot; is that the entire edit buffer be written to stable storage. The note regarding temporary files is intended for implementations that use temporary files to back edit buffers unnamed by the user.<div class="spacer">
</div>
Historically, SIGQUIT was ignored by <i>ex</i>, but was the equivalent of the  <b>Q</b> command in visual mode; that is, it exited visual mode and entered  <i>ex</i> mode. IEEE&#160;Std&#160;1003.1-2001 permits, but does not require, this behavior. Historically, SIGINT was often used by  <i>vi</i> users to terminate text input mode ( &lt;control&gt;-C is often easier to enter than &lt;ESC&gt;). Some implementations of  <i>vi</i> alerted the terminal on this event, and some did not. IEEE&#160;Std&#160;1003.1-2001 requires that SIGINT behave identically to &lt;ESC&gt;, and that the terminal not be alerted.<div class="spacer">
</div>
Historically, suspending the <i>ex</i> editor during text input mode was similar to SIGINT, as completed lines were retained, but any partial line discarded, and the editor returned to command mode. IEEE&#160;Std&#160;1003.1-2001 is silent on this issue; implementations are encouraged to follow historical practice, where possible.<div class="spacer">
</div>
Historically, the <i>vi</i> editor did not treat SIGTSTP as an asynchronous event, and it was therefore impossible to suspend the editor in visual text input mode. There are two major reasons for this. The first is that SIGTSTP is a broadcast signal on UNIX systems, and the chain of events where the shell  <i>exec</i>s an application that then <i>exec</i>s <i>vi</i> usually caused confusion for the terminal state if SIGTSTP was delivered to the process group in the default manner. The second was that most implementations of the UNIX  <i>curses</i> package are not reentrant, and the receipt of SIGTSTP at the wrong time will cause them to crash. IEEE&#160;Std&#160;1003.1-2001 is silent on this issue; implementations are encouraged to treat suspension as an asynchronous event if possible.<div class="spacer">
</div>
Historically, modifications to the edit buffer made before SIGINT interrupted an operation were retained; that is, anywhere from zero to all of the lines to be modified might have been modified by the time the SIGINT arrived. These changes were not discarded by the arrival of SIGINT. IEEE&#160;Std&#160;1003.1-2001 permits this behavior, noting that the  <b>undo</b> command is required to be able to undo these partially completed commands.<div class="spacer">
</div>
The action taken for signals other than SIGINT, SIGCONT, SIGHUP, and SIGTERM is unspecified because some implementations attempt to save the edit buffer in a useful state when other signals are received.</div>
<div class="subsection">
<h2>Standard Error</h2> For  <i>ex</i>/ <i>vi</i>, diagnostic messages are those messages reported as a result of a failed attempt to invoke  <i>ex</i> or <i>vi</i>, such as invalid options or insufficient resources, or an abnormal termination condition. Diagnostic messages should not be confused with the error messages generated by inappropriate or illegal user commands.</div>
<div class="subsection">
<h2>Initialization in ex and vi</h2> If an  <i>ex</i> command (other than <b>cd</b>, <b>chdir</b>, or <b>source</b>) has a filename argument, one or both of the alternate and current pathnames will be set. Informally, they are set as follows:<dl>
<dt>
 1.</dt>
<dd>
If the <i>ex</i> command is one that replaces the contents of the edit buffer, and it succeeds, the current pathname will be set to the filename argument (the first filename argument in the case of the  <b>next</b> command) and the alternate pathname will be set to the previous current pathname, if there was one.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
In the case of the file read/write forms of the <b>read</b> and <b>write</b> commands, if there is no current pathname, the current pathname will be set to the filename argument.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
Otherwise, the alternate pathname will be set to the filename argument.</dd>
</dl>
<div class="spacer">
</div>
For example, <b>:edit foo</b> and <b>:recover foo</b>, when successful, set the current pathname, and, if there was a previous current pathname, the alternate pathname. The commands  <b>:write</b>,  <b>!command</b>, and <b>:edit</b> set neither the current or alternate pathnames. If the  <b>:edit foo</b> command were to fail for some reason, the alternate pathname would be set. The  <b>read</b> and <b>write</b> commands set the alternate pathname to their  <i>file</i> argument, unless the current pathname is not set, in which case they set the current pathname to their  <i>file</i> arguments. The alternate pathname was not historically set by the  <b>:source</b> command. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice. Implementations adding commands that take filenames as arguments are encouraged to set the alternate pathname as described here.<div class="spacer">
</div>
Historically, <i>ex</i> and <i>vi</i> read the <b>.exrc</b> file in the  <i>$HOME</i> directory twice, if the editor was executed in the  <i>$HOME</i> directory. IEEE&#160;Std&#160;1003.1-2001 prohibits this behavior.<div class="spacer">
</div>
Historically, the 4 BSD <i>ex</i> and <i>vi</i> read the <i>$HOME</i> and local  <b>.exrc</b> files if they were owned by the real ID of the user, or the  <b>sourceany</b> option was set, regardless of other considerations. This was a security problem because it is possible to put normal UNIX system commands inside a  <b>.exrc</b> file. IEEE&#160;Std&#160;1003.1-2001 does not specify the  <b>sourceany</b> option, and historical implementations are encouraged to delete it.<div class="spacer">
</div>
The <b>.exrc</b> files must be owned by the real ID of the user, and not writable by anyone other than the owner. The appropriate privileges exception is intended to permit users to acquire special privileges, but continue to use the  <b>.exrc</b> files in their home directories.<div class="spacer">
</div>
System V Release 3.2 and later <i>vi</i> implementations added the option  <b>[no]exrc</b>. The behavior is that local  <b>.exrc</b> files are read-only if the  <b>exrc</b> option is set. The default for the <b>exrc</b> option was off, so by default, local  <b>.exrc</b> files were not read. The problem this was intended to solve was that System V permitted users to give away files, so there is no possible ownership or writeability test to ensure that the file is safe. This is still a security problem on systems where users can give away files, but there is nothing additional that IEEE&#160;Std&#160;1003.1-2001 can do. The implementation-defined exception is intended to permit groups to have local  <b>.exrc</b> files that are shared by users, by creating pseudo-users to own the shared files.<div class="spacer">
</div>
IEEE&#160;Std&#160;1003.1-2001 does not mention system-wide <i>ex</i> and <i>vi</i> start-up files. While they exist in several implementations of  <i>ex</i> and  <i>vi</i>, they are not present in any implementations considered historical practice by IEEE&#160;Std&#160;1003.1-2001. Implementations that have such files should use them only if they are owned by the real user ID or an appropriate user (for example, root on UNIX systems) and if they are not writable by any user other than their owner. System-wide start-up files should be read before the  <i>EXINIT</i> variable,  <b>$HOME/.exrc</b>, or local <b>.exrc</b> files are evaluated.<div class="spacer">
</div>
Historically, any <i>ex</i> command could be entered in the <i>EXINIT</i> variable or the  <b>.exrc</b> file, although ones requiring that the edit buffer already contain lines of text generally caused historical implementations of the editor to drop  <b>core</b>. IEEE&#160;Std&#160;1003.1-2001 requires that any <i>ex</i> command be permitted in the  <i>EXINIT</i> variable and  <b>.exrc</b> files, for simplicity of specification and consistency, although many of them will obviously fail under many circumstances.<div class="spacer">
</div>
The initialization of the contents of the edit buffer uses the phrase &quot;the effect shall be&quot; with regard to various  <i>ex</i> commands. The intent of this phrase is that edit buffer contents loaded during the initialization phase not be lost; that is, loading the edit buffer should fail if the  <b>.exrc</b> file read in the contents of a file and did not subsequently write the edit buffer. An additional intent of this phrase is to specify that the initial current line and column is set as specified for the individual  <i>ex</i> commands.<div class="spacer">
</div>
Historically, the <b>-t</b> option behaved as if the tag search were a  <b>+</b> <i>command</i>; that is, it was executed from the last line of the file specified by the tag. This resulted in the search failing if the pattern was a forward search pattern and the  <b>wrapscan</b> edit option was not set. IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior, requiring that the search for the tag pattern be performed on the entire file, and, if not found, that the current line be set to a more reasonable location in the file.<div class="spacer">
</div>
Historically, the empty edit buffer presented for editing when a file was not specified by the user was unnamed. This is permitted by IEEE&#160;Std&#160;1003.1-2001; however, implementations are encouraged to provide users a temporary filename for this buffer because it permits them the use of  <i>ex</i> commands that use the current pathname during temporary edit sessions.<div class="spacer">
</div>
Historically, the file specified using the <b>-t</b> option was not part of the current argument list. This practice is permitted by IEEE&#160;Std&#160;1003.1-2001; however, implementations are encouraged to include its name in the current argument list for consistency.<div class="spacer">
</div>
Historically, the <b>-c</b> command was generally not executed until a file that already exists was edited. IEEE&#160;Std&#160;1003.1-2001 requires conformance to this historical practice. Commands that could cause the  <b>-c</b> command to be executed include the  <i>ex</i> commands <b>edit</b>, <b>next</b>,  <b>recover</b>, <b>rewind</b>, and <b>tag</b>, and the <i>vi</i> commands &lt;control&gt;-^ and &lt;control&gt;-]. Historically, reading a file into an edit buffer did not cause the  <b>-c</b> command to be executed (even though it might set the current pathname) with the exception that it did cause the  <b>-c</b> command to be executed if: the editor was in  <i>ex</i> mode, the edit buffer had no current pathname, the edit buffer was empty, and no read commands had yet been attempted. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.<div class="spacer">
</div>
Historically, the <b>-r</b> option was the same as a normal edit session if there was no recovery information available for the file. This allowed users to enter:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>vi -r *.c</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
and recover whatever files were recoverable. In some implementations, recovery was attempted only on the first file named, and the file was not entered into the argument list; in others, recovery was attempted for each file named. In addition, some historical implementations ignored  <b>-r</b> if <b>-t</b> was specified or did not support command line  <i>file</i> arguments with the  <b>-t</b> option. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 disallows these special cases, and requires that recovery be attempted the first time each file is edited.<div class="spacer">
</div>
Historically, <i>vi</i> initialized the <b>`</b> and <b>'</b> marks, but  <i>ex</i> did not. This meant that if the first command in  <i>ex</i> mode was <b>visual</b> or if an  <i>ex</i> command was executed first (for example,  <i>vi</i> +10 <i>file</i>), <i>vi</i> was entered without the marks being initialized. Because the standard developers believed the marks to be generally useful, and for consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 requires that they always be initialized if in open or visual mode, or if in  <i>ex</i> mode and the edit buffer is not empty. Not initializing it in  <i>ex</i> mode if the edit buffer is empty is historical practice; however, it has always been possible to set (and use) marks in empty edit buffers in open and visual mode edit sessions.</div>
<div class="subsection">
<h2>Addressing</h2> Historically,  <i>ex</i> and <i>vi</i> accepted the additional addressing forms  <b>'\/'</b> and  <b>'\?'</b> . They were equivalent to <b>&quot;//&quot;</b> and <b>&quot;??&quot;</b>, respectively. They are not required by IEEE&#160;Std&#160;1003.1-2001, mostly because nobody can remember whether they ever did anything different historically.<div class="spacer">
</div>
Historically, <i>ex</i> and <i>vi</i> permitted an address of zero for several commands, and permitted the  <b>%</b> address in empty files for others. For consistency, IEEE&#160;Std&#160;1003.1-2001 requires support for the former in the few commands where it makes sense, and disallows it otherwise. In addition, because IEEE&#160;Std&#160;1003.1-2001 requires that  <b>%</b> be logically equivalent to <b>&quot;1,$&quot;</b>, it is also supported where it makes sense and disallowed otherwise.<div class="spacer">
</div>
Historically, the <b>%</b> address could not be followed by further addresses. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 requires that additional addresses be supported.<div class="spacer">
</div>
All of the following are valid <i>addresses</i>:<dl>
<dt>
<b>+++</b></dt>
<dd>
Three lines after the current line.</dd>
</dl>
<dl>
<dt>
<b>/</b><i>re</i><b>/-</b></dt>
<dd>
One line before the next occurrence of <i>re</i>.</dd>
</dl>
<dl>
<dt>
<b>-2</b></dt>
<dd>
Two lines before the current line.</dd>
</dl>
<dl>
<dt>
<b>3&#160;----&#160;2</b></dt>
<dd>
Line one (note intermediate negative address).</dd>
</dl>
<dl>
<dt>
<b>1&#160;2&#160;3</b></dt>
<dd>
Line six.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
Any number of addresses can be provided to commands taking addresses; for example,  <b>&quot;1,2,3,4,5p&quot;</b> prints lines 4 and 5, because two is the greatest valid number of addresses accepted by the  <b>print</b> command. This, in combination with the semicolon delimiter, permits users to create commands based on ordered patterns in the file. For example, the command  <b>3;/foo/;+2print</b> will display the first line after line 3 that contains the pattern  <i>foo</i>, plus the next two lines. Note that the address  <b>3;</b> must be evaluated before being discarded because the search origin for the  <b>/foo/</b> command depends on this.<div class="spacer">
</div>
Historically, values could be added to addresses by including them after one or more &lt;blank&gt;s; for example,  <b>3&#160;-&#160;5p</b> wrote the seventh line of the file, and <b>/foo/&#160;5</b> was the same as  <b>/foo/+5</b>. However, only absolute values could be added; for example,  <b>5&#160;/foo/</b> was an error. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice. Address offsets are separately specified from addresses because they could historically be provided to visual mode search commands.<div class="spacer">
</div>
Historically, any missing addresses defaulted to the current line. This was true for leading and trailing comma-delimited addresses, and for trailing semicolon-delimited addresses. For consistency, IEEE&#160;Std&#160;1003.1-2001 requires it for leading semicolon addresses as well.<div class="spacer">
</div>
Historically, <i>ex</i> and <i>vi</i> accepted the <b>'^'</b> character as both an address and as a flag offset for commands. In both cases it was identical to the  <b>'-'</b> character. IEEE&#160;Std&#160;1003.1-2001 does not require or prohibit this behavior.<div class="spacer">
</div>
Historically, the enhancements to basic regular expressions could be used in addressing; for example,  <b>'~'</b>,  <b>'\&lt;'</b>, and <b>'\&gt;'</b> . IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice; that is, that regular expression usage be consistent, and that regular expression enhancements be supported wherever regular expressions are used.</div>
<div class="subsection">
<h2>Command Line Parsing in ex</h2> Historical  <i>ex</i> command parsing was even more complex than that described here. IEEE&#160;Std&#160;1003.1-2001 requires the subset of the command parsing that the standard developers believed was documented and that users could reasonably be expected to use in a portable fashion, and that was historically consistent between implementations. (The discarded functionality is obscure, at best.) Historical implementations will require changes in order to comply with IEEE&#160;Std&#160;1003.1-2001; however, users are not expected to notice any of these changes. Most of the complexity in  <i>ex</i> parsing is to handle three special termination cases:<dl>
<dt>
 1.</dt>
<dd>
The <b>!</b>, <b>global</b>, <b>v</b>, and the filter versions of the  <b>read</b> and <b>write</b> commands are delimited by &lt;newline&gt;s (they can contain vertical-line characters that are usually shell pipes).</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
The <b>ex</b>, <b>edit</b>, <b>next</b>, and <b>visual</b> in open and visual mode commands all take  <i>ex</i> commands, optionally containing vertical-line characters, as their first arguments.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
The <b>s</b> command takes a regular expression as its first argument, and uses the delimiting characters to delimit the command.</dd>
</dl>
<div class="spacer">
</div>
Historically, vertical-line characters in the <b>+</b> <i>command</i> argument of the  <b>ex</b>, <b>edit</b>, <b>next</b>,  <b>vi</b>, and <b>visual</b> commands, and in the <i>pattern</i> and  <i>replacement</i> parts of the <b>s</b> command, did not delimit the command, and in the filter cases for  <b>read</b> and <b>write</b>, and the  <b>!</b>, <b>global</b>, and <b>v</b> commands, they did not delimit the command at all. For example, the following commands are all valid:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:</b><b>edit +25 | s/abc/ABC/ file.c</b><br/>
<b></b><b>:</b><b>s/ | /PIPE/</b><br/>
<b></b><b>:</b><b>read !spell % | columnate</b><br/>
<b></b><b>:</b><b>global/pattern/p | l</b><br/>
<b></b><b>:</b><b>s/a/b/ | s/c/d | set</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
Historically, empty or &lt;blank&gt; filled lines in <b>.exrc</b> files and  <b>source</b>d files (as well as <i>EXINIT</i> variables and  <i>ex</i> command scripts) were treated as default commands; that is,  <b>print</b> commands. IEEE&#160;Std&#160;1003.1-2001 specifically requires that they be ignored when encountered in  <b>.exrc</b> and <b>source</b>d files to eliminate a common source of new user error.<div class="spacer">
</div>
Historically, <i>ex</i> commands with multiple adjacent (or &lt;blank&gt;-separated) vertical lines were handled oddly when executed from  <i>ex</i> mode. For example, the command <b>|||</b> &lt;carriage-return&gt;, when the cursor was on line 1, displayed lines 2, 3, and 5 of the file. In addition, the command  <b>|</b> would only display the line after the next line, instead of the next two lines. The former worked more logically when executed from  <i>vi</i> mode, and displayed lines 2, 3, and 4. IEEE&#160;Std&#160;1003.1-2001 requires the  <i>vi</i> behavior; that is, a single default command and line number increment for each command separator, and trailing &lt;newline&gt;s after vertical-line separators are discarded.<div class="spacer">
</div>
Historically, <i>ex</i> permitted a single extra colon as a leading command character; for example,  <b>:g/pattern/:p</b> was a valid command. IEEE&#160;Std&#160;1003.1-2001 generalizes this to require that any number of leading colon characters be stripped.<div class="spacer">
</div>
Historically, any prefix of the <b>delete</b> command could be followed without intervening &lt;blank&gt;s by a flag character because in the command  <b>d&#160;p</b>, <i>p</i> is interpreted as the buffer  <i>p</i>. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
Historically, the <b>k</b> command could be followed by the mark name without intervening &lt;blank&gt;s. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
Historically, the <b>s</b> command could be immediately followed by flag and option characters; for example,  <b>s/e/E/|s|sgc3p</b> was a valid command. However, flag characters could not stand alone; for example, the commands  <b>sp</b> and  <b>s&#160;l</b> would fail, while the command <b>sgp</b> and <b>s&#160;gl</b> would succeed. (Obviously, the  <b>'#'</b> flag character was used as a delimiter character if it followed the command.) Another issue was that option characters had to precede flag characters even when the command was fully specified; for example, the command  <b>s/e/E/pg</b> would fail, while the command  <b>s/e/E/gp</b> would succeed. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
Historically, the first command name that had a prefix matching the input from the user was the executed command; for example,  <b>ve</b>, <b>ver</b>, and <b>vers</b> all executed the <b>version</b> command. Commands were in a specific order, however, so that  <b>a</b> matched <b>append</b>, not <b>abbreviate</b>. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice. The restriction on command search order for implementations with extensions is to avoid the addition of commands such that the historical prefixes would fail to work portably.<div class="spacer">
</div>
Historical implementations of <i>ex</i> and <i>vi</i> did not correctly handle multiple  <i>ex</i> commands, separated by vertical-line characters, that entered or exited visual mode or the editor. Because implementations of  <i>vi</i> exist that do not exhibit this failure mode, IEEE&#160;Std&#160;1003.1-2001 does not permit it.<div class="spacer">
</div>
The requirement that alphabetic command names consist of all following alphabetic characters up to the next non-alphabetic character means that alphabetic command names must be separated from their arguments by one or more non-alphabetic characters, normally a &lt;blank&gt; or  <b>'!'</b> character, except as specified for the exceptions, the  <b>delete</b>, <b>k</b>, and  <b>s</b> commands.<div class="spacer">
</div>
Historically, the repeated execution of the <i>ex</i> default <b>print</b> commands ( &lt;control&gt;-D,  <i>eof</i>, &lt;newline&gt;, &lt;carriage-return&gt;) erased any prompting character and displayed the next lines without scrolling the terminal; that is, immediately below any previously displayed lines. This provided a cleaner presentation of the lines in the file for the user. IEEE&#160;Std&#160;1003.1-2001 does not require this behavior because it may be impossible in some situations; however, implementations are strongly encouraged to provide this semantic if possible.<div class="spacer">
</div>
Historically, it was possible to change files in the middle of a command, and have the rest of the command executed in the new file; for example:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:edit +25 file.c | s/abc/ABC/ | 1</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
was a valid command, and the substitution was attempted in the newly edited file. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice. The following commands are examples that exercise the  <i>ex</i> parser:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>echo 'foo | bar' &gt; file1; echo 'foo/bar' &gt; file2;</b><br/>
<b>vi</b><br/>
<b>:edit +1 | s/|/PIPE/ | w file1 | e file2 | 1 | s/\//SLASH/ | wq</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
Historically, there was no protection in editor implementations to avoid  <i>ex</i> <b>global</b>, <b>v</b>, <b>@</b>, or  <b>*</b> commands changing edit buffers during execution of their associated commands. Because this would almost invariably result in catastrophic failure of the editor, and implementations exist that do exhibit these problems, IEEE&#160;Std&#160;1003.1-2001 requires that changing the edit buffer during a  <b>global</b> or <b>v</b> command, or during a  <b>@</b> or <b>*</b> command for which there will be more than a single execution, be an error. Implementations supporting multiple edit buffers simultaneously are strongly encouraged to apply the same semantics to switching between buffers as well.<div class="spacer">
</div>
The <i>ex</i> command quoting required by IEEE&#160;Std&#160;1003.1-2001 is a superset of the quoting in historical implementations of the editor. For example, it was not historically possible to escape a &lt;blank&gt; in a filename; for example,  <b>:edit&#160;foo\\\&#160;bar</b> would report that too many filenames had been entered for the edit command, and there was no method of escaping a &lt;blank&gt; in the first argument of an  <b>edit</b>,  <b>ex</b>, <b>next</b>, or <b>visual</b> command at all. IEEE&#160;Std&#160;1003.1-2001 extends historical practice, requiring that quoting behavior be made consistent across all  <i>ex</i> commands, except for the <b>map</b>, <b>unmap</b>, <b>abbreviate</b>, and  <b>unabbreviate</b> commands, which historically used &lt;control&gt;-V instead of backslashes for quoting. For those four commands, IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
Backslash quoting in <i>ex</i> is non-intuitive. Backslash escapes are ignored unless they escape a special character; for example, when performing  <i>file</i> argument expansion, the string  <b>&quot;\\%&quot;</b> is equivalent to <b>'\%'</b>, not  <b>&quot;\&lt;</b><i>current&#160;pathname</i><b>&gt;&quot;</b>. This can be confusing for users because backslash is usually one of the characters that causes shell expansion to be performed, and therefore shell quoting rules must be taken into consideration. Generally, quoting characters are only considered if they escape a special character, and a quoting character must be provided for each layer of parsing for which the character is special. As another example, only a single backslash is necessary for the  <b>'\l'</b> sequence in substitute replacement patterns, because the character  <b>'l'</b> is not special to any parsing layer above it.<div class="spacer">
</div>
&lt;control&gt;-V quoting in <i>ex</i> is slightly different from backslash quoting. In the four commands where &lt;control&gt;-V quoting applies (  <b>abbreviate</b>, <b>unabbreviate</b>,  <b>map</b>, and <b>unmap</b>), any character may be escaped by a &lt;control&gt;-V whether it would have a special meaning or not. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
Historical implementations of the editor did not require delimiters within character classes to be escaped; for example, the command  <b>:s/[/]//</b> on the string <b>&quot;xxx/yyy&quot;</b> would delete the  <b>'/'</b> from the string. IEEE&#160;Std&#160;1003.1-2001 disallows this historical practice for consistency and because it places a large burden on implementations by requiring that knowledge of regular expressions be built into the editor parser.<div class="spacer">
</div>
Historically, quoting &lt;newline&gt;s in <i>ex</i> commands was handled inconsistently. In most cases, the &lt;newline&gt; always terminated the command, regardless of any preceding escape character, because backslash characters did not escape &lt;newline&gt;s for most  <i>ex</i> commands. However, some <i>ex</i> commands (for example,  <b>s</b>, <b>map</b>, and  <b>abbreviation</b>) permitted &lt;newline&gt;s to be escaped (although in the case of  <b>map</b> and <b>abbreviation</b>, &lt;control&gt;-V characters escaped them instead of backslashes). This was true in not only the command line, but also  <b>.exrc</b> and <b>source</b>d files. For example, the command:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>map = foo&lt;control-V&gt;&lt;newline&gt;bar</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
would succeed, although it was sometimes difficult to get the &lt;control&gt;-V and the inserted &lt;newline&gt; passed to the  <i>ex</i> parser. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 requires that it be possible to escape &lt;newline&gt;s in  <i>ex</i> commands at all times, using backslashes for most  <i>ex</i> commands, and using &lt;control&gt;-V characters for the  <b>map</b> and <b>abbreviation</b> commands. For example, the command  <b>print</b> &lt;newline&gt;  <b>list</b> is required to be parsed as the single command  <b>print</b> &lt;newline&gt; <b>list</b>. While this differs from historical practice, IEEE&#160;Std&#160;1003.1-2001 developers believed it unlikely that any script or user depended on the historical behavior.<div class="spacer">
</div>
Historically, an error in a command specified using the <b>-c</b> option did not cause the rest of the  <b>-c</b> commands to be discarded. IEEE&#160;Std&#160;1003.1-2001 disallows this for consistency with mapped keys, the  <b>@</b>, <b>global</b>,  <b>source</b>, and <b>v</b> commands, the <i>EXINIT</i> environment variable, and the  <b>.exrc</b> files.</div>
<div class="subsection">
<h2>Input Editing in ex</h2> One of the common uses of the historical  <i>ex</i> editor is over slow network connections. Editors that run in canonical mode can require far less traffic to and from, and far less processing on, the host machine, as well as more easily supporting block-mode terminals. For these reasons, IEEE&#160;Std&#160;1003.1-2001 requires that  <i>ex</i> be implemented using canonical mode input processing, as was done historically.<div class="spacer">
</div>
IEEE&#160;Std&#160;1003.1-2001 does not require the historical 4 BSD input editing characters &quot;word erase&quot; or &quot;literal next&quot;. For this reason, it is unspecified how they are handled by  <i>ex</i>, although they must have the required effect. Implementations that resolve them after the line has been ended using a &lt;newline&gt; or &lt;control&gt;-M character, and implementations that rely on the underlying system terminal support for this processing, are both conforming. Implementations are strongly urged to use the underlying system functionality, if at all possible, for compatibility with other system text input interfaces.<div class="spacer">
</div>
Historically, when the <i>eof</i> character was used to decrement the  <b>autoindent</b> level, the cursor moved to display the new end of the  <b>autoindent</b> characters, but did not move the cursor to a new line, nor did it erase the &lt;control&gt;-D character from the line. IEEE&#160;Std&#160;1003.1-2001 does not specify that the cursor remain on the same line or that the rest of the line is erased; however, implementations are strongly encouraged to provide the best possible user interface; that is, the cursor should remain on the same line, and any &lt;control&gt;-D character on the line should be erased.<div class="spacer">
</div>
IEEE&#160;Std&#160;1003.1-2001 does not require the historical 4 BSD input editing character &quot;reprint&quot;, traditionally &lt;control&gt;-R, which redisplayed the current input from the user. For this reason, and because the functionality cannot be implemented after the line has been terminated by the user, IEEE&#160;Std&#160;1003.1-2001 makes no requirements about this functionality. Implementations are strongly urged to make this historical functionality available, if possible.<div class="spacer">
</div>
Historically, &lt;control&gt;-Q did not perform a literal next function in  <i>ex</i>, as it did in <i>vi</i>. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice to avoid breaking historical  <i>ex</i> scripts and <b>.exrc</b> files.</div>
<div class="subsection">
<h2>eof</h2> Whether the  <i>eof</i> character immediately modifies the <b>autoindent</b> characters in the prompt is left unspecified so that implementations can conform in the presence of systems that do not support this functionality. Implementations are encouraged to modify the line and redisplay it immediately, if possible.<div class="spacer">
</div>
The specification of the handling of the <i>eof</i> character differs from historical practice only in that  <i>eof</i> characters are not discarded if they follow normal characters in the text input. Historically, they were always discarded.</div>
<div class="subsection">
<h2>Command Descriptions in ex</h2> Historically, several commands (for example,  <b>global</b>, <b>v</b>,  <b>visual</b>, <b>s</b>, <b>write</b>, <b>wq</b>,  <b>yank</b>, <b>!</b>, <b>&lt;</b>, <b>&gt;</b>, <b>&amp;</b>, and <b>~</b>) were executable in empty files (that is, the default address(es) were 0), or permitted explicit addresses of 0 (for example, 0 was a valid address, or 0,0 was a valid range). Addresses of 0, or command execution in an empty file, make sense only for commands that add new text to the edit buffer or write commands (because users may wish to write empty files). IEEE&#160;Std&#160;1003.1-2001 requires this behavior for such commands and disallows it otherwise, for consistency and simplicity of specification.<div class="spacer">
</div>
A count to an <i>ex</i> command has been historically corrected to be no greater than the last line in a file; for example, in a five-line file, the command  <b>1,6print</b> would fail, but the command  <b>1print300</b> would succeed. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
Historically, the use of flags in <i>ex</i> commands could be obscure. General historical practice was as described by IEEE&#160;Std&#160;1003.1-2001, but there were some special cases. For instance, the  <b>list</b>, <b>number</b>, and <b>print</b> commands ignored trailing address offsets; for example,  <b>3p&#160;+++#</b> would display line 3, and 3 would be the current line after the execution of the command. The  <b>open</b> and <b>visual</b> commands ignored both the trailing offsets and the trailing flags. Also, flags specified to the  <b>open</b> and <b>visual</b> commands interacted badly with the  <b>list</b> edit option, and setting and then unsetting it during the open/visual session would cause  <i>vi</i> to stop displaying lines in the specified format. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 does not permit any of these exceptions to the general rule.<div class="spacer">
</div>
IEEE&#160;Std&#160;1003.1-2001 uses the word <i>copy</i> in several places when discussing buffers. This is not intended to imply implementation.<div class="spacer">
</div>
Historically, <i>ex</i> users could not specify numeric buffers because of the ambiguity this would cause; for example, in the command  <b>3&#160;delete&#160;2</b>, it is unclear whether 2 is a buffer name or a  <i>count</i>. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice by default, but does not preclude extensions.<div class="spacer">
</div>
Historically, the contents of the unnamed buffer were frequently discarded after commands that did not explicitly affect it; for example, when using the  <b>edit</b> command to switch files. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.<div class="spacer">
</div>
The <i>ex</i> utility did not historically have access to the numeric buffers, and, furthermore, deleting lines in  <i>ex</i> did not modify their contents. For example, if, after doing a delete in  <i>vi</i>, the user switched to  <i>ex</i>, did another delete, and then switched back to <i>vi</i>, the contents of the numeric buffers would not have changed. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice. Numeric buffers are described in the  <i>ex</i> utility in order to confine the description of buffers to a single location in IEEE&#160;Std&#160;1003.1-2001.<div class="spacer">
</div>
The metacharacters that trigger shell expansion in <i>file</i> arguments match historical practice, as does the method for doing shell expansion. Implementations wishing to provide users with the flexibility to alter the set of metacharacters are encouraged to provide a  <b>shellmeta</b> string edit option.<div class="spacer">
</div>
Historically, <i>ex</i> commands executed from <i>vi</i> refreshed the screen when it did not strictly need to do so; for example,  <b>:!date&#160;&gt;&#160;/dev/null</b> does not require a screen refresh because the output of the UNIX  <i>date</i> command requires only a single line of the screen. IEEE&#160;Std&#160;1003.1-2001 requires that the screen be refreshed if it has been overwritten, but makes no requirements as to how an implementation should make that determination. Implementations may prompt and refresh the screen regardless.</div>
<div class="subsection">
<h2>Abbreviate</h2> Historical practice was that characters that were entered as part of an abbreviation replacement were subject to  <b>map</b> expansions, the  <b>showmatch</b> edit option, further abbreviation expansions, and so on; that is, they were logically pushed onto the terminal input queue, and were not a simple replacement. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice. Historical practice was that whenever a non-word character (that had not been escaped by a &lt;control&gt;-V) was entered after a word character,  <i>vi</i> would check for abbreviations. The check was based on the type of the character entered before the word character of the word/non-word pair that triggered the check. The word character of the word/non-word pair that triggered the check and all characters entered before the trigger pair that were of that type were included in the check, with the exception of &lt;blank&gt;s, which always delimited the abbreviation.<div class="spacer">
</div>
This means that, for the abbreviation to work, the <i>lhs</i> must end with a word character, there can be no transitions from word to non-word characters (or  <i>vice versa</i>) other than between the last and next-to-last characters in the  <i>lhs</i>, and there can be no &lt;blank&gt;s in the  <i>lhs</i>. In addition, because of the historical quoting rules, it was impossible to enter a literal &lt;control&gt;-V in the  <i>lhs</i>. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice. Historical implementations did not inform users when abbreviations that could never be used were entered; implementations are strongly encouraged to do so.<div class="spacer">
</div>
For example, the following abbreviations will work:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:ab (p  REPLACE</b><br/>
<b>:ab p   REPLACE</b><br/>
<b>:ab ((p REPLACE</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
The following abbreviations will not work:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:ab (   REPLACE</b><br/>
<b>:ab (pp REPLACE</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
Historical practice is that words on the <i>vi</i> colon command line were subject to abbreviation expansion, including the arguments to the  <b>abbrev</b> (and more interestingly) the  <b>unabbrev</b> command. Because there are implementations that do not do abbreviation expansion for the first argument to those commands, this is permitted, but not required, by IEEE&#160;Std&#160;1003.1-2001. However, the following sequence:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:ab foo bar</b><br/>
<b>:ab foo baz</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
resulted in the addition of an abbreviation of <b>&quot;baz&quot;</b> for the string  <b>&quot;bar&quot;</b> in historical <i>ex</i>/ <i>vi</i>, and the sequence:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:ab foo1 bar</b><br/>
<b>:ab foo2 bar</b><br/>
<b>:unabbreviate foo2</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
deleted the abbreviation <b>&quot;foo1&quot;</b>, not <b>&quot;foo2&quot;</b> . These behaviors are not permitted by IEEE&#160;Std&#160;1003.1-2001 because they clearly violate the expectations of the user.<div class="spacer">
</div>
It was historical practice that &lt;control&gt;-V, not backslash, characters be interpreted as escaping subsequent characters in the  <b>abbreviate</b> command. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice; however, it should be noted that an abbreviation containing a &lt;blank&gt; will never work.</div>
<div class="subsection">
<h2>Append</h2> Historically, any text following a vertical-line command separator after an  <b>append</b>, <b>change</b>, or <b>insert</b> command became part of the insert text. For example, in the command:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:g/pattern/append|stuff1</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
a line containing the text <b>&quot;stuff1&quot;</b> would be appended to each line matching pattern. It was also historically valid to enter:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:append|stuff1</b><br/>
<b>stuff2</b><br/>
<b>.</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
and the text on the <i>ex</i> command line would be appended along with the text inserted after it. There was an historical bug, however, that the user had to enter two terminating lines (the  <b>'.'</b> lines) to terminate text input mode in this case. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice, but disallows the historical need for multiple terminating lines.</div>
<div class="subsection">
<h2>Change</h2> See the RATIONALE for the  <b>append</b> command. Historical practice for cursor positioning after the change command when no text is input, is as described in IEEE&#160;Std&#160;1003.1-2001. However, one System V implementation is known to have been modified such that the cursor is positioned on the first address specified, and not on the line before the first address. IEEE&#160;Std&#160;1003.1-2001 disallows this modification for consistency.<div class="spacer">
</div>
Historically, the <b>change</b> command did not support buffer arguments, although some implementations allow the specification of an optional buffer. This behavior is neither required nor disallowed by IEEE&#160;Std&#160;1003.1-2001.</div>
<div class="subsection">
<h2>Change Directory</h2> A common extension in  <i>ex</i> implementations is to use the elements of a  <b>cdpath</b> edit option as prefix directories for  <i>path</i> arguments to <b>chdir</b> that are relative pathnames and that do not have  <b>'.'</b> or <b>&quot;..&quot;</b> as their first component. Elements in the  <b>cdpath</b> edit option are colon-separated. The initial value of the  <b>cdpath</b> edit option is the value of the shell  <i>CDPATH</i> environment variable. This feature was not included in IEEE&#160;Std&#160;1003.1-2001 because it does not exist in any of the implementations considered historical practice.</div>
<div class="subsection">
<h2>Copy</h2> Historical implementations of  <i>ex</i> permitted copies to lines inside of the specified range; for example,  <b>:2,5copy3</b> was a valid command. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.</div>
<div class="subsection">
<h2>Delete</h2> IEEE&#160;Std&#160;1003.1-2001 requires support for the historical parsing of a  <b>delete</b> command followed by flags, without any intervening &lt;blank&gt;s. For example:<dl>
<dt>
<b>1dp</b></dt>
<dd>
Deletes the first line and prints the line that was second.</dd>
</dl>
<dl>
<dt>
<b>1delep</b></dt>
<dd>
As for <b>1dp</b>.</dd>
</dl>
<dl>
<dt>
<b>1d</b></dt>
<dd>
Deletes the first line, saving it in buffer <i>p</i>.</dd>
</dl>
<dl>
<dt>
<b>1d&#160;p1l</b></dt>
<dd>
(Pee-one-ell.) Deletes the first line, saving it in buffer <i>p</i>, and listing the line that was second.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="subsection">
<h2>Edit</h2> Historically, any  <i>ex</i> command could be entered as a <b>+</b> <i>command</i> argument to the  <b>edit</b> command, although some (for example,  <b>insert</b> and <b>append</b>) were known to confuse historical implementations. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 requires that any command be supported as an argument to the  <b>edit</b> command.<div class="spacer">
</div>
Historically, the command argument was executed with the current line set to the last line of the file, regardless of whether the  <b>edit</b> command was executed from visual mode or not. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
Historically, the <b>+</b> <i>command</i> specified to the <b>edit</b> and  <b>next</b> commands was delimited by the first &lt;blank&gt;, and there was no way to quote them. For consistency, IEEE&#160;Std&#160;1003.1-2001 requires that the usual  <i>ex</i> backslash quoting be provided.<div class="spacer">
</div>
Historically, specifying the <b>+</b> <i>command</i> argument to the edit command required a filename to be specified as well; for example,  <b>:edit&#160;+100</b> would always fail. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 does not permit this usage to fail for that reason.<div class="spacer">
</div>
Historically, only the cursor position of the last file edited was remembered by the editor. IEEE&#160;Std&#160;1003.1-2001 requires that this be supported; however, implementations are permitted to remember and restore the cursor position for any file previously edited.</div>
<div class="subsection">
<h2>File</h2> Historical versions of the  <i>ex</i> editor <b>file</b> command displayed a current line and number of lines in the edit buffer of 0 when the file was empty, while the  <i>vi</i> &lt;control&gt;-G command displayed a current line and number of lines in the edit buffer of 1 in the same situation. IEEE&#160;Std&#160;1003.1-2001 does not permit this discrepancy, instead requiring that a message be displayed indicating that the file is empty.</div>
<div class="subsection">
<h2>Global</h2> The two-pass operation of the  <b>global</b> and <b>v</b> commands is not intended to imply implementation, only the required result of the operation.<div class="spacer">
</div>
The current line and column are set as specified for the individual  <i>ex</i> commands. This requirement is cumulative; that is, the current line and column must track across all the commands executed by the  <b>global</b> or <b>v</b> commands.</div>
<div class="subsection">
<h2>Insert</h2> See the RATIONALE for the  <b>append</b> command.<div class="spacer">
</div>
Historically, <b>insert</b> could not be used with an address of zero; that is, not when the edit buffer was empty. IEEE&#160;Std&#160;1003.1-2001 requires that this command behave consistently with the  <b>append</b> command.</div>
<div class="subsection">
<h2>Join</h2> The action of the  <b>join</b> command in relation to the special characters is only defined for the POSIX locale because the correct amount of white space after a period varies; in Japanese none is required, in French only a single space, and so on.</div>
<div class="subsection">
<h2>List</h2> The historical output of the  <b>list</b> command was potentially ambiguous. The standard developers believed correcting this to be more important than adhering to historical practice, and IEEE&#160;Std&#160;1003.1-2001 requires unambiguous output.</div>
<div class="subsection">
<h2>Map</h2> Historically, command mode maps only applied to command names; for example, if the character  <b>'x'</b> was mapped to  <b>'y'</b>, the command <b>fx</b> searched for the <b>'x'</b> character, not the  <b>'y'</b> character. IEEE&#160;Std&#160;1003.1-2001 requires this behavior. Historically, entering &lt;control&gt;-V as the first character of a  <i>vi</i> command was an error. Several implementations have extended the semantics of  <i>vi</i> such that &lt;control&gt;-V means that the subsequent command character is not mapped. This is permitted, but not required, by IEEE&#160;Std&#160;1003.1-2001. Regardless, using &lt;control&gt;-V to escape the second or later character in a sequence of characters that might match a  <b>map</b> command, or any character in text input mode, is historical practice, and stops the entered keys from matching a map. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
Historical implementations permitted digits to be used as a <b>map</b> command  <i>lhs</i>, but then ignored the map. IEEE&#160;Std&#160;1003.1-2001 requires that the mapped digits not be ignored.<div class="spacer">
</div>
The historical implementation of the <b>map</b> command did not permit  <b>map</b> commands that were more than a single character in length if the first character was printable. This behavior is permitted, but not required, by IEEE&#160;Std&#160;1003.1-2001.<div class="spacer">
</div>
Historically, mapped characters were remapped unless the <b>remap</b> edit option was not set, or the prefix of the mapped characters matched the mapping characters; for example, in the  <b>map</b>:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:map ab abcd</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
the characters <b>&quot;ab&quot;</b> were used as is and were not remapped, but the characters  <b>&quot;cd&quot;</b> were mapped if appropriate. This can cause infinite loops in the  <i>vi</i> mapping mechanisms. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice, and that such loops be interruptible.<div class="spacer">
</div>
Text input maps had the same problems with expanding the <i>lhs</i> for the  <i>ex</i> <b>map!</b> and <b>unmap!</b> command as did the  <i>ex</i> <b>abbreviate</b> and <b>unabbreviate</b> commands. See the RATIONALE for the  <i>ex</i> <b>abbreviate</b> command. IEEE&#160;Std&#160;1003.1-2001 requires similar modification of some historical practice for the  <b>map</b> and  <b>unmap</b> commands, as described for the <b>abbreviate</b> and <b>unabbreviate</b> commands.<div class="spacer">
</div>
Historically, <b>map</b>s that were subsets of other <b>map</b>s behaved differently depending on the order in which they were defined. For example:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:map! ab     short</b><br/>
<b>:map! abc    long</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
would always translate the characters <b>&quot;ab&quot;</b> to <b>&quot;short&quot;</b>, regardless of how fast the characters  <b>&quot;abc&quot;</b> were entered. If the entry order was reversed:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>:map! abc    long</b><br/>
<b>:map! ab     short</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
the characters <b>&quot;ab&quot;</b> would cause the editor to pause, waiting for the completing  <b>'c'</b> character, and the characters might never be mapped to  <b>&quot;short&quot;</b> . For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 requires that the shortest match be used at all times.<div class="spacer">
</div>
The length of time the editor spends waiting for the characters to complete the  <i>lhs</i> is unspecified because the timing capabilities of systems are often inexact and variable, and it may depend on other factors such as the speed of the connection. The time should be long enough for the user to be able to complete the sequence, but not long enough for the user to have to wait. Some implementations of  <i>vi</i> have added a <b>keytime</b> option, which permits users to set the number of 0,1 seconds the editor waits for the completing characters. Because mapped terminal function and cursor keys tend to start with an &lt;ESC&gt; character, and &lt;ESC&gt; is the key ending  <i>vi</i> text input mode,  <b>map</b>s starting with &lt;ESC&gt; characters are generally exempted from this timeout period, or, at least timed out differently.</div>
<div class="subsection">
<h2>Mark</h2> Historically, users were able to set the &quot;previous context&quot; marks explicitly. In addition, the  <i>ex</i> commands <b>&quot;</b> and  <b>'`</b> and the <i>vi</i> commands <b>&quot;</b>, <b>``</b>, <b>`'</b>, and  <b>'`</b> all referred to the same mark. In addition, the previous context marks were not set if the command, with which the address setting the mark was associated, failed. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice. Historically, if marked lines were deleted, the mark was also deleted, but would reappear if the change was undone. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
The description of the special events that set the <b>`</b> and <b>'</b> marks matches historical practice. For example, historically the command  <b>/a/,/b/</b> did not set the <b>`</b> and  <b>'</b> marks, but the command <b>/a/,/b/delete</b> did.</div>
<div class="subsection">
<h2>Next</h2> Historically, any  <i>ex</i> command could be entered as a <b>+</b> <i>command</i> argument to the  <b>next</b> command, although some (for example,  <b>insert</b> and <b>append</b>) were known to confuse historical implementations. IEEE&#160;Std&#160;1003.1-2001 requires that any command be permitted and that it behave as specified. The  <b>next</b> command can accept more than one file, so usage such as:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>next `ls [abc] `</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
is valid; it need not be valid for the <b>edit</b> or <b>read</b> commands, for example, because they expect only one filename.<div class="spacer">
</div>
Historically, the <b>next</b> command behaved differently from the  <b>:rewind</b> command in that it ignored the force flag if the  <b>autowrite</b> flag was set. For consistency, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.<div class="spacer">
</div>
Historically, the <b>next</b> command positioned the cursor as if the file had never been edited before, regardless. IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior, for consistency with the  <b>edit</b> command.<div class="spacer">
</div>
Implementations wanting to provide a counterpart to the <b>next</b> command that edited the previous file have used the command  <b>prev[ious],</b> which takes no <i>file</i> argument. IEEE&#160;Std&#160;1003.1-2001 does not require this command.</div>
<div class="subsection">
<h2>Open</h2> Historically, the  <b>open</b> command would fail if the <b>open</b> edit option was not set. IEEE&#160;Std&#160;1003.1-2001 does not mention the  <b>open</b> edit option and does not require this behavior. Some historical implementations do not permit entering open mode from open or visual mode, only from  <i>ex</i> mode. For consistency, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.<div class="spacer">
</div>
Historically, entering open mode from the command line (that is, <i>vi</i>  <b>+open</b>) resulted in anomalous behaviors; for example, the  <i>ex</i> file and  <i>set</i> commands, and the  <i>vi</i> command &lt;control&gt;-G did not work. For consistency, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.<div class="spacer">
</div>
Historically, the <b>open</b> command only permitted <b>'/'</b> characters to be used as the search pattern delimiter. For consistency, IEEE&#160;Std&#160;1003.1-2001 requires that the search delimiters used by the  <b>s</b>, <b>global</b>, and <b>v</b> commands be accepted as well.</div>
<div class="subsection">
<h2>Preserve</h2> The  <b>preserve</b> command does not historically cause the file to be considered unmodified for the purposes of future commands that may exit the editor. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
Historical documentation stated that mail was not sent to the user when preserve was executed; however, historical implementations did send mail in this case. IEEE&#160;Std&#160;1003.1-2001 requires conformance to the historical implementations.</div>
<div class="subsection">
<h2>Print</h2> The writing of NUL by the  <b>print</b> command is not specified as a special case because the standard developers did not want to require  <i>ex</i> to support NUL characters. Historically, characters were displayed using the ARPA standard mappings, which are as follows:<dl>
<dt>
 1.</dt>
<dd>
Printable characters are left alone.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Control characters less than \177 are represented as <b>'^'</b> followed by the character offset from the  <b>'@'</b> character in the ASCII map; for example, \007 is represented as  <b>'^G'</b> .</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
\177 is represented as <b>'^'</b> followed by <b>'?'</b> .</dd>
</dl>
<div class="spacer">
</div>
The display of characters having their eighth bit set was less standard. Existing implementations use hex (0x00), octal (\000), and a meta-bit display. (The latter displayed bytes that had their eighth bit set as the two characters  <b>&quot;M-&quot;</b> followed by the seven-bit display as described above.) The latter probably has the best claim to historical practice because it was used for the  <b>-v</b> option of 4 BSD and 4 BSD-derived versions of the <i>cat</i> utility since 1980.<div class="spacer">
</div>
No specific display format is required by IEEE&#160;Std&#160;1003.1-2001.<div class="spacer">
</div>
Explicit dependence on the ASCII character set has been avoided where possible, hence the use of the phrase an &quot;implementation-defined multi-character sequence&quot; for the display of non-printable characters in preference to the historical usage of, for instance,  <b>&quot;^I&quot;</b> for the &lt;tab&gt;. Implementations are encouraged to conform to historical practice in the absence of any strong reason to diverge.<div class="spacer">
</div>
Historically, all <i>ex</i> commands beginning with the letter <b>'p'</b> could be entered using capitalized versions of the commands; for example,  <b>P[rint]</b>, <b>Pre[serve]</b>, and <b>Pu[t]</b> were all valid command names. IEEE&#160;Std&#160;1003.1-2001 permits, but does not require, this historical practice because capital forms of the commands are used by some implementations for other purposes.</div>
<div class="subsection">
<h2>Put</h2> Historically, an  <i>ex</i> <b>put</b> command, executed from open or visual mode, was the same as the open or visual mode  <b>P</b> command, if the buffer was named and was cut in character mode, and the same as the  <b>p</b> command if the buffer was named and cut in line mode. If the unnamed buffer was the source of the text, the entire line from which the text was taken was usually  <b>put</b>, and the buffer was handled as if in line mode, but it was possible to get extremely anomalous behavior. In addition, using the  <b>Q</b> command to switch into <i>ex</i> mode, and then doing a  <b>put</b> often resulted in errors as well, such as appending text that was unrelated to the (supposed) contents of the buffer. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 does not permit these behaviors. All  <i>ex</i> <b>put</b> commands are required to operate in line mode, and the contents of the buffers are not altered by changing the mode of the editor.</div>
<div class="subsection">
<h2>Read</h2> Historically, an  <i>ex</i> <b>read</b> command executed from open or visual mode, executed in an empty file, left an empty line as the first line of the file. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior. Historically, a  <b>read</b> in open or visual mode from a program left the cursor at the last line read in, not the first. For consistency, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.<div class="spacer">
</div>
Historical implementations of <i>ex</i> were unable to undo <b>read</b> commands that read from the output of a program. For consistency, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.<div class="spacer">
</div>
Historically, the <i>ex</i> and <i>vi</i> message after a successful  <b>read</b> or  <b>write</b> command specified &quot;characters&quot;, not &quot;bytes&quot;. IEEE&#160;Std&#160;1003.1-2001 requires that the number of bytes be displayed, not the number of characters, because it may be difficult in multi-byte implementations to determine the number of characters read. Implementations are encouraged to clarify the message displayed to the user.<div class="spacer">
</div>
Historically, reads were not permitted on files other than type regular, except that FIFO files could be read (probably only because they did not exist when  <i>ex</i> and <i>vi</i> were originally written). Because the historical  <i>ex</i> evaluated <b>read!</b> and <b>read&#160;!</b> equivalently, there can be no optional way to force the read. IEEE&#160;Std&#160;1003.1-2001 permits, but does not require, this behavior.</div>
<div class="subsection">
<h2>Recover</h2> Some historical implementations of the editor permitted users to recover the edit buffer contents from a previous edit session, and then exit without saving those contents (or explicitly discarding them). The intent of IEEE&#160;Std&#160;1003.1-2001 in requiring that the edit buffer be treated as already modified is to prevent this user error.</div>
<div class="subsection">
<h2>Rewind</h2> Historical implementations supported the  <b>rewind</b> command when the user was editing the first file in the list; that is, the file that the  <b>rewind</b> command would edit. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.</div>
<div class="subsection">
<h2>Substitute</h2> Historically,  <i>ex</i> accepted an <b>r</b> option to the <b>s</b> command. The effect of the  <b>r</b> option was to use the last regular expression used in any command as the pattern, the same as the  <b>~</b> command. The <b>r</b> option is not required by IEEE&#160;Std&#160;1003.1-2001. Historically, the  <b>c</b> and  <b>g</b> options were toggled; for example, the command  <b>:s/abc/def/</b> was the same as <b>s/abc/def/ccccgggg</b>. For simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.<div class="spacer">
</div>
The tilde command is often used to replace the last search RE. For example, in the sequence:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>s/red/blue/</b><br/>
<b>/green</b><br/>
<b>~</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
the <b>~</b> command is equivalent to:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>s/green/blue/</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
Historically, <i>ex</i> accepted all of the following forms:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>s/abc/def/</b><br/>
<b>s/abc/def</b><br/>
<b>s/abc/</b><br/>
<b>s/abc</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
IEEE&#160;Std&#160;1003.1-2001 requires conformance to this historical practice.<div class="spacer">
</div>
The <b>s</b> command presumes that the <b>'^'</b> character only occupies a single column in the display. Much of the  <i>ex</i> and <i>vi</i> specification presumes that the &lt;space&gt; only occupies a single column in the display. There are no known character sets for which this is not true.<div class="spacer">
</div>
Historically, the final column position for the substitute commands was based on previous column movements; a search for a pattern followed by a substitution would leave the column position unchanged, while a 0 command followed by a substitution would change the column position to the first non- &lt;blank&gt;. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 requires that the final column position always be set to the first non- &lt;blank&gt;.</div>
<div class="subsection">
<h2>Set</h2> Historical implementations redisplayed all of the options for each occurrence of the  <b>all</b> keyword. IEEE&#160;Std&#160;1003.1-2001 permits, but does not require, this behavior.</div>
<div class="subsection">
<h2>Tag</h2> No requirement is made as to where  <i>ex</i> and <i>vi</i> shall look for the file referenced by the tag entry. Historical practice has been to look for the path found in the  <b>tags</b> file, based on the current directory. A useful extension found in some implementations is to look based on the directory containing the tags file that held the entry, as well. No requirement is made as to which reference for the tag in the tags file is used. This is deliberate, in order to permit extensions such as multiple entries in a tags file for a tag.<div class="spacer">
</div>
Because users often specify many different tags files, some of which need not be relevant or exist at any particular time, IEEE&#160;Std&#160;1003.1-2001 requires that error messages about problem tags files be displayed only if the requested tag is not found, and then, only once for each time that the  <b>tag</b> edit option is changed.<div class="spacer">
</div>
The requirement that the current edit buffer be unmodified is only necessary if the file indicated by the tag entry is not the same as the current file (as defined by the current pathname). Historically, the file would be reloaded if the filename had changed, as well as if the filename was different from the current pathname. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior, requiring that the name be the only factor in the decision.<div class="spacer">
</div>
Historically, <i>vi</i> only searched for tags in the current file from the current cursor to the end of the file, and therefore, if the  <b>wrapscan</b> option was not set, tags occurring before the current cursor were not found. IEEE&#160;Std&#160;1003.1-2001 considers this a bug, and implementations are required to search for the first occurrence in the file, regardless.</div>
<div class="subsection">
<h2>Undo</h2> The  <b>undo</b> description deliberately uses the word &quot;modified&quot;. The  <b>undo</b> command is not intended to undo commands that replace the contents of the edit buffer, such as  <b>edit</b>,  <b>next</b>, <b>tag</b>, or <b>recover</b>.<div class="spacer">
</div>
Cursor positioning after the <b>undo</b> command was inconsistent in the historical  <i>vi</i>, sometimes attempting to restore the original cursor position (  <b>global</b>, <b>undo</b>, and  <b>v</b> commands), and sometimes, in the presence of maps, placing the cursor on the last line added or changed instead of the first. IEEE&#160;Std&#160;1003.1-2001 requires a simplified behavior for consistency and simplicity of specification.</div>
<div class="subsection">
<h2>Version</h2> The  <b>version</b> command cannot be exactly specified since there is no widely-accepted definition of what the version information should contain. Implementations are encouraged to do something reasonably intelligent.</div>
<div class="subsection">
<h2>Write</h2> Historically, the  <i>ex</i> and <i>vi</i> message after a successful  <b>read</b> or  <b>write</b> command specified &quot;characters&quot;, not &quot;bytes&quot;. IEEE&#160;Std&#160;1003.1-2001 requires that the number of bytes be displayed, not the number of characters because it may be difficult in multi-byte implementations to determine the number of characters written. Implementations are encouraged to clarify the message displayed to the user.<div class="spacer">
</div>
Implementation-defined tests are permitted so that implementations can make additional checks; for example, for locks or file modification times.<div class="spacer">
</div>
Historically, attempting to append to a nonexistent file caused an error. It has been left unspecified in IEEE&#160;Std&#160;1003.1-2001 to permit implementations to let the  <b>write</b> succeed, so that the append semantics are similar to those of the historical  <i>csh</i>.<div class="spacer">
</div>
Historical <i>vi</i> permitted empty edit buffers to be written. However, since the way  <i>vi</i> got around dealing with &quot;empty&quot; files was to always have a line in the edit buffer, no matter what, it wrote them as files of a single, empty line. IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.<div class="spacer">
</div>
Historically, <i>ex</i> restored standard output and standard error to their values as of when  <i>ex</i> was invoked, before writes to programs were performed. This could disturb the terminal configuration as well as be a security issue for some terminals. IEEE&#160;Std&#160;1003.1-2001 does not permit this, requiring that the program output be captured and displayed as if by the  <i>ex</i> <b>print</b> command.</div>
<div class="subsection">
<h2>Adjust Window</h2> Historically, the line count was set to the value of the  <b>scroll</b> option if the type character was end-of-file. This feature was broken on most historical implementations long ago, however, and is not documented anywhere. For this reason, IEEE&#160;Std&#160;1003.1-2001 is resolutely silent.<div class="spacer">
</div>
Historically, the <b>z</b> command was &lt;blank&gt;-sensitive and <b>z&#160;+</b> and  <b>z&#160;-</b> did different things than  <b>z+</b> and <b>z-</b> because the type could not be distinguished from a flag. (The commands  <b>z\fP.  and </b><b>z&#160;=</b><b></b>  <b>were historically invalid.) IEEE&#160;Std&#160;1003.1-2001 requires conformance</b>  <b>to this historical practice.</b><div class="spacer">
</div>
Historically, the <b>z</b> command was further &lt;blank&gt;-sensitive in that the  <i>count</i> could not be &lt;blank&gt;-delimited; for example, the commands  <b>z=&#160;5</b> and <b>z-&#160;5</b> were also invalid. Because the  <i>count</i> is not ambiguous with respect to either the type character or the flags, this is not permitted by IEEE&#160;Std&#160;1003.1-2001.</div>
<div class="subsection">
<h2>Escape</h2> Historically,  <i>ex</i> filter commands only read the standard output of the commands, letting standard error appear on the terminal as usual. The  <i>vi</i> utility, however, read both standard output and standard error. IEEE&#160;Std&#160;1003.1-2001 requires the latter behavior for both  <i>ex</i> and  <i>vi</i>, for consistency.</div>
<div class="subsection">
<h2>Shift Left and Shift Right</h2> Historically, it was possible to add shift characters to increase the effect of the command; for example,  <b>&lt;&lt;&lt;</b> outdented (or  <b>&gt;&gt;&gt;</b> indented) the lines 3 levels of indentation instead of the default 1. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.</div>
<div class="subsection">
<h2>&lt;control&gt;-D</h2> Historically, the &lt;control&gt;-D command erased the prompt, providing the user with an unbroken presentation of lines from the edit buffer. This is not required by IEEE&#160;Std&#160;1003.1-2001; implementations are encouraged to provide it if possible. Historically, the &lt;control&gt;-D command took, and then ignored, a  <i>count</i>. IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.</div>
<div class="subsection">
<h2>Write Line Number</h2> Historically, the  <i>ex</i> <b>=</b> command, when executed in <i>ex</i> mode in an empty edit buffer, reported 0, and from open or visual mode, reported 1. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.</div>
<div class="subsection">
<h2>Execute</h2> Historically,  <i>ex</i> did not correctly handle the inclusion of text input commands (that is,  <b>append</b>, <b>insert</b>, and  <b>change</b>) in executed buffers. IEEE&#160;Std&#160;1003.1-2001 does not permit this exclusion for consistency.<div class="spacer">
</div>
Historically, the logical contents of the buffer being executed did not change if the buffer itself were modified by the commands being executed; that is, buffer execution did not support self-modifying code. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
Historically, the <b>@</b> command took a range of lines, and the <b>@</b> buffer was executed once per line, with the current line (  <b>'.'</b> ) set to each specified line. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
Some historical implementations did not notice if errors occurred during buffer execution. This, coupled with the ability to specify a range of lines for the  <i>ex</i> <b>@</b> command, makes it trivial to cause them to drop  <b>core</b>. IEEE&#160;Std&#160;1003.1-2001 requires that implementations stop buffer execution if any error occurs, if the specified line doesn't exist, or if the contents of the edit buffer itself are replaced (for example, the buffer executes the  <i>ex</i>  <b>:edit</b> command).</div>
<div class="subsection">
<h2>Regular Expressions in ex</h2> Historical practice is that the characters in the replacement part of the last  <b>s</b> command-that is, those matched by entering a  <b>'~'</b> in the regular expression-were not further expanded by the regular expression engine. So, if the characters contained the string  <b>&quot;a.,&quot;</b> they would match <b>'a'</b> followed by  <b>&quot;.,&quot;</b> and not <b>'a'</b> followed by any character. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.</div>
<div class="subsection">
<h2>Edit Options in ex</h2> The following paragraphs describe the historical behavior of some edit options that were not, for whatever reason, included in IEEE&#160;Std&#160;1003.1-2001. Implementations are strongly encouraged to only use these names if the functionality described here is fully supported.<dl>
<dt>
<b>extended</b></dt>
<dd>
The <b>extended</b> edit option has been used in some implementations of  <i>vi</i> to provide extended regular expressions instead of basic regular expressions This option was omitted from IEEE&#160;Std&#160;1003.1-2001 because it is not widespread historical practice.</dd>
</dl>
<dl>
<dt>
<b>flash</b></dt>
<dd>
The <b>flash</b> edit option historically caused the screen to flash instead of beeping on error. This option was omitted from IEEE&#160;Std&#160;1003.1-2001 because it is not found in some historical implementations.</dd>
</dl>
<dl>
<dt>
<b>hardtabs</b></dt>
<dd>
The <b>hardtabs</b> edit option historically defined the number of columns between hardware tab settings. This option was omitted from IEEE&#160;Std&#160;1003.1-2001 because it was believed to no longer be generally useful.</dd>
</dl>
<dl>
<dt>
<b>modeline</b></dt>
<dd>
The <b>modeline</b> (sometimes named <b>modelines</b>) edit option historically caused  <i>ex</i> or <i>vi</i> to read the five first and last lines of the file for editor commands. This option is a security problem, and vendors are strongly encouraged to delete it from historical implementations.</dd>
</dl>
<dl>
<dt>
<b>open</b></dt>
<dd>
The <b>open</b> edit option historically disallowed the <i>ex</i> <b>open</b> and  <b>visual</b> commands. This edit option was omitted because these commands are required by IEEE&#160;Std&#160;1003.1-2001.</dd>
</dl>
<dl>
<dt>
<b>optimize</b></dt>
<dd>
The <b>optimize</b> edit option historically expedited text throughput by setting the terminal to not do automatic &lt;carriage-return&gt;s when printing more than one logical line of output. This option was omitted from IEEE&#160;Std&#160;1003.1-2001 because it was intended for terminals without addressable cursors, which are rarely, if ever, still used.</dd>
</dl>
<dl>
<dt>
<b>ruler</b></dt>
<dd>
The <b>ruler</b> edit option has been used in some implementations of  <i>vi</i> to present a current row/column ruler for the user. This option was omitted from IEEE&#160;Std&#160;1003.1-2001 because it is not widespread historical practice.</dd>
</dl>
<dl>
<dt>
<b>sourceany</b></dt>
<dd>
The <b>sourceany</b> edit option historically caused <i>ex</i> or <i>vi</i> to source start-up files that were owned by users other than the user running the editor. This option is a security problem, and vendors are strongly encouraged to remove it from their implementations.</dd>
</dl>
<dl>
<dt>
<b>timeout</b></dt>
<dd>
The <b>timeout</b> edit option historically enabled the (now standard) feature of only waiting for a short period before returning keys that could be part of a macro. This feature was omitted from IEEE&#160;Std&#160;1003.1-2001 because its behavior is now standard, it is not widely useful, and it was rarely documented.</dd>
</dl>
<dl>
<dt>
<b>verbose</b></dt>
<dd>
The <b>verbose</b> edit option has been used in some implementations of  <i>vi</i> to cause  <i>vi</i> to output error messages for common errors; for example, attempting to move the cursor past the beginning or end of the line instead of only alerting the screen. (The historical  <i>vi</i> only alerted the terminal and presented no message for such errors. The historical editor option  <b>terse</b> did not select when to present error messages, it only made existing error messages more or less verbose.) This option was omitted from IEEE&#160;Std&#160;1003.1-2001 because it is not widespread historical practice; however, implementors are encouraged to use it if they wish to provide error messages for naive users.</dd>
</dl>
<dl>
<dt>
<b>wraplen</b></dt>
<dd>
The <b>wraplen</b> edit option has been used in some implementations of  <i>vi</i> to specify an automatic margin measured from the left margin instead of from the right margin. This is useful when multiple screen sizes are being used to edit a single file. This option was omitted from IEEE&#160;Std&#160;1003.1-2001 because it is not widespread historical practice; however, implementors are encouraged to use it if they add this functionality.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="subsection">
<h2>autoindent, ai</h2> Historically, the command  <b>0a</b> did not do any autoindentation, regardless of the current indentation of line 1. IEEE&#160;Std&#160;1003.1-2001 requires that any indentation present in line 1 be used.</div>
<div class="subsection">
<h2>autoprint, ap</h2> Historically, the  <b>autoprint</b> edit option was not completely consistent or based solely on modifications to the edit buffer. Exceptions were the  <b>read</b> command (when reading from a file, but not from a filter), the  <b>append</b>,  <b>change</b>, <b>insert</b>, <b>global</b>, and <b>v</b> commands, all of which were not affected by  <b>autoprint</b>, and the  <b>tag</b> command, which was affected by <b>autoprint</b>. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.<div class="spacer">
</div>
Historically, the <b>autoprint</b> option only applied to the last of multiple commands entered using vertical-bar delimiters; for example,  <b>delete</b> &lt;newline&gt; was affected by <b>autoprint</b>, but  <b>delete|version</b> &lt;newline&gt; was not. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.</div>
<div class="subsection">
<h2>autowrite, aw</h2> Appending the  <b>'!'</b> character to the <i>ex</i> <b>next</b> command to avoid performing an automatic write was not supported in historical implementations. IEEE&#160;Std&#160;1003.1-2001 requires that the behavior match the other  <i>ex</i> commands for consistency.</div>
<div class="subsection">
<h2>ignorecase, ic</h2> Historical implementations of case-insensitive matching (the  <b>ignorecase</b> edit option) lead to counterintuitive situations when uppercase characters were used in range expressions. Historically, the process was as follows:<dl>
<dt>
 1.</dt>
<dd>
Take a line of text from the edit buffer.</dd>
</dl>
<dl>
<dt>
 2.</dt>
<dd>
Convert uppercase to lowercase in text line.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
Convert uppercase to lowercase in regular expressions, except in character class specifications.</dd>
</dl>
<dl>
<dt>
 4.</dt>
<dd>
Match regular expressions against text.</dd>
</dl>
<div class="spacer">
</div>
This would mean that, with <b>ignorecase</b> in effect, the text:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>The cat sat on the mat</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
would be matched by<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>/^the/</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
but not by:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>/^[A-Z]he/</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
For consistency with other commands implementing regular expressions, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.</div>
<div class="subsection">
<h2>paragraphs, para</h2> The ISO&#160;POSIX-2:1993 standard made the default  <b>paragraphs</b> and  <b>sections</b> edit options implementation-defined, arguing they were historically oriented to the UNIX system  <i>troff</i> text formatter, and a &quot;portable user&quot; could use the  <b>{</b>, <b>}</b>, <b>[[</b>, <b>]]</b>, <b>(</b>, and <b>)</b> commands in open or visual mode and have the cursor stop in unexpected places. IEEE&#160;Std&#160;1003.1-2001 specifies their values in the POSIX locale because the unusual grouping (they only work when grouped into two characters at a time) means that they cannot be used for general-purpose movement, regardless.</div>
<div class="subsection">
<h2>readonly</h2> Implementations are encouraged to provide the best possible information to the user as to the read-only status of the file, with the exception that they should not consider the current special privileges of the process. This provides users with a safety net because they must force the overwrite of read-only files, even when running with additional privileges.<div class="spacer">
</div>
The <b>readonly</b> edit option specification largely conforms to historical practice. The only difference is that historical implementations did not notice that the user had set the  <b>readonly</b> edit option in cases where the file was already marked read-only for some reason, and would therefore reinitialize the  <b>readonly</b> edit option the next time the contents of the edit buffer were replaced. This behavior is disallowed by IEEE&#160;Std&#160;1003.1-2001.</div>
<div class="subsection">
<h2>report</h2> The requirement that lines copied to a buffer interact differently than deleted lines is historical practice. For example, if the  <b>report</b> edit option is set to 3, deleting 3 lines will cause a report to be written, but 4 lines must be copied before a report is written.<div class="spacer">
</div>
The requirement that the <i>ex</i> <b>global</b>, <b>v</b>, <b>open</b>,  <b>undo</b>, and <b>visual</b> commands present reports based on the total number of lines added or deleted during the command execution, and that commands executed by the  <b>global</b> and  <b>v</b> commands not present reports, is historical practice. IEEE&#160;Std&#160;1003.1-2001 extends historical practice by requiring that buffer execution be treated similarly. The reasons for this are two-fold. Historically, only the report by the last command executed from the buffer would be seen by the user, as each new report would overwrite the last. In addition, the standard developers believed that buffer execution had more in common with  <b>global</b> and <b>v</b> commands than it did with other  <i>ex</i> commands, and should behave similarly, for consistency and simplicity of specification.</div>
<div class="subsection">
<h2>showmatch, sm</h2> The length of time the cursor spends on the matching character is unspecified because the timing capabilities of systems are often inexact and variable. The time should be long enough for the user to notice, but not long enough for the user to become annoyed. Some implementations of  <i>vi</i> have added a <b>matchtime</b> option that permits users to set the number of 0,1 second intervals the cursor pauses on the matching character.</div>
<div class="subsection">
<h2>showmode</h2> The  <b>showmode</b> option has been used in some historical implementations of  <i>ex</i> and <i>vi</i> to display the current editing mode when in open or visual mode. The editing modes have generally included &quot;command&quot; and &quot;input&quot;, and sometimes other modes such as &quot;replace&quot; and &quot;change&quot;. The string was usually displayed on the bottom line of the screen at the far right-hand corner. In addition, a preceding  <b>'*'</b> character often denoted whether the contents of the edit buffer had been modified. The latter display has sometimes been part of the  <b>showmode</b> option, and sometimes based on another option. This option was not available in the 4 BSD historical implementation of  <i>vi</i>, but was viewed as generally useful, particularly to novice users, and is required by IEEE&#160;Std&#160;1003.1-2001.<div class="spacer">
</div>
The <b>smd</b> shorthand for the <b>showmode</b> option was not present in all historical implementations of the editor. IEEE&#160;Std&#160;1003.1-2001 requires it, for consistency.<div class="spacer">
</div>
Not all historical implementations of the editor displayed a mode string for command mode, differentiating command mode from text input mode by the absence of a mode string. IEEE&#160;Std&#160;1003.1-2001 permits this behavior for consistency with historical practice, but implementations are encouraged to provide a display string for both modes.</div>
<div class="subsection">
<h2>slowopen</h2> Historically the  <b>slowopen</b> option was automatically set if the terminal baud rate was less than 1200 baud, or if the baud rate was 1200 baud and the  <b>redraw</b> option was not set. The <b>slowopen</b> option had two effects. First, when inserting characters in the middle of a line, characters after the cursor would not be pushed ahead, but would appear to be overwritten. Second, when creating a new line of text, lines after the current line would not be scrolled down, but would appear to be overwritten. In both cases, ending text input mode would cause the screen to be refreshed to match the actual contents of the edit buffer. Finally, terminals that were sufficiently intelligent caused the editor to ignore the  <b>slowopen</b> option. IEEE&#160;Std&#160;1003.1-2001 permits most historical behavior, extending historical practice to require  <b>slowopen</b> behaviors if the edit option is set by the user.</div>
<div class="subsection">
<h2>tags</h2> The default path for tags files is left unspecified as implementations may have their own  <b>tags</b> implementations that do not correspond to the historical ones. The default  <b>tags</b> option value should probably at least include the file  <b>./tags</b>.</div>
<div class="subsection">
<h2>term</h2> Historical implementations of  <i>ex</i> and <i>vi</i> ignored changes to the  <b>term</b> edit option after the initial terminal information was loaded. This is permitted by IEEE&#160;Std&#160;1003.1-2001; however, implementations are encouraged to permit the user to modify their terminal type at any time.</div>
<div class="subsection">
<h2>terse</h2> Historically, the  <b>terse</b> edit option optionally provided a shorter, less descriptive error message, for some error messages. This is permitted, but not required, by IEEE&#160;Std&#160;1003.1-2001. Historically, most common visual mode errors (for example, trying to move the cursor past the end of a line) did not result in an error message, but simply alerted the terminal. Implementations wishing to provide messages for novice users are urged to do so based on the  <b>edit</b> option <b>verbose</b>, and not  <b>terse</b>.</div>
<div class="subsection">
<h2>window</h2> In historical implementations, the default for the  <b>window</b> edit option was based on the baud rate as follows:<dl>
<dt>
 1.</dt>
<dd>
If the baud rate was less than 1200, the <b>edit</b> option <b>w300</b> set the window value; for example, the line:<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>set w300=12</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
would set the window option to 12 if the baud rate was less than 1200.<dl>
<dt>
 2.</dt>
<dd>
If the baud rate was equal to 1200, the <b>edit</b> option <b>w1200</b> set the window value.</dd>
</dl>
<dl>
<dt>
 3.</dt>
<dd>
If the baud rate was greater than 1200, the <b>edit</b> option <b>w9600</b> set the window value.</dd>
</dl>
<div class="spacer">
</div>
The <b>w300</b>, <b>w1200</b>, and <b>w9600</b> options do not appear in IEEE&#160;Std&#160;1003.1-2001 because of their dependence on specific baud rates.<div class="spacer">
</div>
In historical implementations, the size of the window displayed by various commands was related to, but not necessarily the same as, the  <b>window</b> edit option. For example, the size of the window was set by the  <i>ex</i> command <b>visual 10</b>, but it did not change the value of the  <b>window</b> edit option. However, changing the value of the  <b>window</b> edit option did change the number of lines that were displayed when the screen was repainted. IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior in the interests of consistency and simplicity of specification, and requires that all commands that change the number of lines that are displayed do it by setting the value of the  <b>window</b> edit option.</div>
<div class="subsection">
<h2>wrapmargin, wm</h2> Historically, the  <b>wrapmargin</b> option did not affect maps inserting characters that also had associated  <i>count</i>s; for example  <b>:map&#160;K&#160;5aABC&#160;DEF</b>. Unfortunately, there are widely used maps that depend on this behavior. For consistency and simplicity of specification, IEEE&#160;Std&#160;1003.1-2001 does not permit this behavior.<div class="spacer">
</div>
Historically, <b>wrapmargin</b> was calculated using the column display width of all characters on the screen. For example, an implementation using  <b>&quot;^I&quot;</b> to represent &lt;tab&gt;s when the <b>list</b> edit option was set, where  <b>'^'</b> and  <b>'I'</b> each took up a single column on the screen, would calculate the  <b>wrapmargin</b> based on a value of 2 for each &lt;tab&gt;. The  <b>number</b> edit option similarly changed the effective length of the line as well. IEEE&#160;Std&#160;1003.1-2001 requires conformance to historical practice.</div>
</div>
<div class="section">
<h1>FUTURE DIRECTIONS</h1> None.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>Command Search and Execution</i>, <i>ctags</i>, <i>ed</i>, <i>sed</i>,  <i>sh</i>, <i>stty</i>, <i>vi</i>, the System Interfaces volume of IEEE&#160;Std&#160;1003.1-2001,  <i>access</i>()</div>
<div class="section">
<h1>COPYRIGHT</h1> Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1, 2003 Edition, Standard for Information Technology -- Portable Operating System Interface (POSIX), The Open Group Base Specifications Issue 6, Copyright (C) 2001-2003 by the Institute of Electrical and Electronics Engineers, Inc and The Open Group. In the event of any discrepancy between this version and the original IEEE and The Open Group Standard, the original IEEE and The Open Group Standard is the referee document. The original Standard can be obtained online at http://www.opengroup.org/unix/online.html .</div>
<table class="foot">
<tr>
<td class="foot-date">
2003</td>
<td class="foot-os">
IEEE/The Open Group</td>
</tr>
</table>
</div>
</body>
</html>

