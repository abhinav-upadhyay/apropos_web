<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
stopping(7)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
stopping(7)</td>
<td class="head-vol">
Miscellaneous Information Manual</td>
<td class="head-rtitle">
stopping(7)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> stopping - event signalling that a job is stopping</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>stopping</b> <b>JOB=</b><i>JOB</i> <b>INSTANCE=</b><i>INSTANCE</i> <b>RESULT=</b><i>RESULT</i> <i>[</i><b>PROCESS=</b><i>PROCESS</i><b>]</b> <i>[</i><b>EXIT_STATUS=</b><i>STATUS</i><b>]</b> <i>[</i><b>EXIT_SIGNAL=</b><i>SIGNAL</i><b>]</b> [<i>ENV</i>]...</div>
<div class="section">
<h1>DESCRIPTION</h1> The <b>stopping</b> event is generated by the Upstart <b>init</b>(8) daemon when an instance of a job begins stopping.  The <b>JOB</b> environment variable contains the job name, and the <b>INSTANCE</b> environment variable contains the instance name which will be empty for single-instance jobs.<div style="height: 1.00em;">
&#160;</div>
If the job is stopping normally, the <b>RESULT</b> environment variable will be <i>ok</i>, otherwise if the job is stopping because it has failed it will be <i>failed</i>.<div style="height: 1.00em;">
&#160;</div>
When the job has failed, the process that failed will be given in the <b>PROCESS</b> environment variable.  This may be <i>pre-start</i>, <i>post-start</i>, <i>main</i>, <i>pre-stop</i> or <i>post-stop</i>; it may also be the special value <i>respawn</i> to indicate that the job is stopping because it hit the respawn limit.<div style="height: 1.00em;">
&#160;</div>
Finally in the case of a failed job, one of either <b>EXIT_STATUS</b> or <b>EXIT_SIGNAL</b> may be given to indicate the cause of the stop.  Either <b>EXIT_STATUS</b> will contain the exit status code of the process, or <b>EXIT_SIGNAL</b> will contain the name of the signal that the process received.  The <b>normal exit</b> job configuration stanza can be used to prevent particular exit status values or signals resulting in a failed job, see <b>init</b>(5) for more information.<div style="height: 1.00em;">
&#160;</div>
If neither <b>EXIT_STATUS</b> or <b>EXIT_SIGNAL</b> is given for a failed process, it is because the process failed to spawn (for example, file not found).  See the system logs for the error.<div style="height: 1.00em;">
&#160;</div>
<b>init</b>(8) will wait for all services started by this event to be running, all tasks started by this event to have finished and all jobs stopped by this event to be stopped before allowing the job to continue stopping.<div style="height: 1.00em;">
&#160;</div>
This allows jobs to depend on other jobs, safely stopping themselves before their dependency goes away.  This event is typically combined with the <b>started</b>(7) event by services.<div style="height: 1.00em;">
&#160;</div>
Job configuration files may use the <b>export</b> stanza to export environment variables from their own environment into the <b>stopping</b> event.  See <b>init</b>(5) for more details.</div>
<div class="section">
<h1>EXAMPLE</h1> A service that wishes to depend on another service might use:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<br/>
start on started apache<br/>
stop on stopping apache<br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
A task that must be run before another task or service is stopped might use:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<br/>
start on stopping postgresql RESULT=ok<br/>
</div>
</div>
<div class="section">
<h1>SEE ALSO</h1> <b>starting</b>(7) <b>started</b>(7) <b>stopped</b>(7) <b>init</b>(5)</div>
<table class="foot">
<tr>
<td class="foot-date">
2009-07-09</td>
<td class="foot-os">
Upstart</td>
</tr>
</table>
</div>
</body>
</html>

