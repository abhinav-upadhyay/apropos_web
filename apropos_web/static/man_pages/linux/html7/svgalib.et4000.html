<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
svgalib.et4000(7)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
svgalib.et4000(7)</td>
<td class="head-vol">
Svgalib User Manual</td>
<td class="head-rtitle">
svgalib.et4000(7)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> svgalib.et4000, libvga.et4000 - Information for Tseng ET4000 users<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>TABLE OF CONTENTS</h1> <b>NOTE: The ET4000 register layout changed stepping from</b> <b>svgalib 0.98 to 0.99. See 8. Problems below first</b><div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b>1.</b> Basics of ET4000 cards<div style="height: 0.00em;">
&#160;</div>
<b>2.</b> How to configure <b>svgalib</b>(7)<div style="height: 0.00em;">
&#160;</div>
<b>3.</b> Creating card dependent register values<div style="height: 0.00em;">
&#160;</div>
<b>4.</b> Defining new modes<div style="height: 0.00em;">
&#160;</div>
<b>5.</b> Redefining standard modes<div style="height: 0.00em;">
&#160;</div>
<b>6.</b> Available examples<div style="height: 0.00em;">
&#160;</div>
<b>7.</b> ET4000/W32 support<div style="height: 0.00em;">
&#160;</div>
<b>8.</b> Problems<div style="height: 0.00em;">
&#160;</div>
<b>9.</b> Using dynamic loading with other cards<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>1. BASICS OF ET4000 CARDS</h1> Basically all ET4000 cards are equal, some are even more equal ...<div style="height: 1.00em;">
&#160;</div>
The Chipset is well documented (by Tseng Labs and eg. the vgadoc2.zip) and all graphics functions can be used the same way on different cards (including the ET4000/W32 based ones). There are three important points to be kept in mind:<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
<b>a.)</b></dt>
<dd>
amount of available, the organisation and timing of video memory</dd>
</dl>
<dl>
<dt>
<b>b.)</b></dt>
<dd>
type and capabilities of the DAC</dd>
</dl>
<dl>
<dt>
<b>c.)</b></dt>
<dd>
available oscillator frequencies</dd>
</dl>
<div class="spacer">
</div>
<div style="height: 1.00em;">
&#160;</div>
<b>svgalib</b>(7) will check the available video memory during startup. This should work on all DRAM cards. If there are any problems concerning VRAM equipped cards, please tell us about.<div style="height: 1.00em;">
&#160;</div>
By now we found is no reliable way to detect the memory organisation/ timing and the DAC type/capabilities. Most modern card use a frequency synthesizer and provide the following pixel frequencies (in MHz):<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<b>50.350 56.644 65.0 72.0 80.0 89.8 63.0 75.0</b></div>
<div style="height: 1.00em;">
&#160;</div>
Checking older ET4000 cards we found a wide spread range of available frequencies. Since the video timing is based on the pixel frequency, the required register values are card dependent.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>2. HOW TO CONFIGURE SVGALIB</h1> <b>svgalib</b>(7) has a somewhat 'standard' registers set that may work with modern ET4000 cards. If <b>svgalib</b>(7) fails on your machine or you have a HiColor dac, you need to configure your <b>svgalib</b>(7).<div style="height: 1.00em;">
&#160;</div>
The <b>svgalib</b>(7) may use hard linked or dynamical linked register values. If you use hard linked values, the binary will be smaller and start up faster but might fail on other machines.<div style="height: 1.00em;">
&#160;</div>
Compiling the <b>svgalib</b>(7) with DYNAMIC defined (see <i>Makefile.cfg</i>) will set up dynamic register loading. Otherwise the value from <i>svgalib/et4000.regs</i> will be hard linked.<div style="height: 1.00em;">
&#160;</div>
The dynamic configuration will be read from <i>/etc/vga/libvga.et4000</i> which is an ASCII file (see <i>Makefile.cfg</i> for exact naming). If you have a working et4000.regs for your system just copy this file to <i>/etc/vga/libvga.et4000</i> or link <i>/etc/vga/libvga.et4000</i> to your <i>svgalib/et4000.regs</i> file.<div style="height: 1.00em;">
&#160;</div>
The actual scanner/parser will handle the following entries:<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
<b>#define DAC_TYPE &lt;integer&gt;</b></dt>
<dd>
Overwrite the DAC detection</dd>
</dl>
<dl>
<dt>
<b>#define &lt;MODE1&gt; &lt;MODE2&gt;</b></dt>
<dd>
Enable MODE1 using MODE2 registers, eg. 64K modes like 32K modes</dd>
</dl>
<dl>
<dt>
<b>#define &lt;MODE&gt; DISABLE_MODE</b></dt>
<dd>
do not use MODE (eg. from vgadrv)</dd>
</dl>
<dl>
<dt>
<b>char &lt;MODE&gt;&lt;strg&gt;[..] = {&lt;integer&gt;, &lt;integer&gt;, ... };</b></dt>
<dd>
register definition</dd>
</dl>
<div class="spacer">
</div>
with<div style="height: 1.00em;">
&#160;</div>
<b>&lt;MODE&gt;    ::= 'g'&lt;decimal&gt;x&lt;decimal&gt;x&lt;color&gt;&lt;ignored&gt;</b><div style="height: 0.00em;">
&#160;</div>
<b>&lt;integer&gt; ::= &lt;decimal&gt;|&lt;hex&gt;</b><div style="height: 0.00em;">
&#160;</div>
<b>&lt;hex&gt;     ::= '0x'&lt;hexdigit&gt;{&lt;hexdigit&gt;}</b><div style="height: 0.00em;">
&#160;</div>
<b>&lt;decimal&gt; ::= ['+'|'-']&lt;digit&gt;{&lt;digit&gt;}</b><div style="height: 0.00em;">
&#160;</div>
<b>&lt;hexdigit&gt;::= &lt;digit&gt;|'a..f'|'A..F'</b><div style="height: 0.00em;">
&#160;</div>
<b>&lt;digit&gt;   ::= '0..9'</b><div style="height: 0.00em;">
&#160;</div>
<b>&lt;color&gt;   ::= '2'|'16'|'256'|'32k'|'32K'|'64k'|'64K'|'16M'</b><div style="height: 0.00em;">
&#160;</div>
<b>&lt;strg&gt;    ::= &lt;empty&gt;|[(&lt;alpha&gt;|'_'){&lt;digit&gt;|&lt;alpha&gt;|'_'}]</b><div style="height: 0.00em;">
&#160;</div>
<b>&lt;alpha&gt;   ::= 'a..z'|'A..Z'</b><div style="height: 1.00em;">
&#160;</div>
C style comments will be skipped. See the <i>et4000/</i> subdirectory of the svgalib distribution for examples.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>3. CREATING CARD DEPENDENT REGISTER VALUES</h1> You may create a <i>et4000.regs on your own with the</i> <i>tseng3.exe</i> program. This DOS program and its source is included in the svgalib distribution.<div style="height: 1.00em;">
&#160;</div>
Just boot MS-DOS and start<div style="height: 1.00em;">
&#160;</div>
<b>tseng3 et4000.reg</b><div style="height: 1.00em;">
&#160;</div>
The <i>tseng3.exe</i> will measure the video timing for each available mode. Check the <i>et4000.regs</i> file against your monitor documentation and disable all non conformant modes, eg.<div style="height: 1.00em;">
&#160;</div>
<b>#define g1024x768x256_regs DISABLE_MODE</b><div style="height: 0.00em;">
&#160;</div>
<b>/*</b><div style="height: 0.00em;">
&#160;</div>
<b>static unsigned char g1024x768x256_regs[71] = {</b><div style="height: 0.00em;">
&#160;</div>
<b>...</b><div style="height: 0.00em;">
&#160;</div>
<b>};</b><div style="height: 0.00em;">
&#160;</div>
<b>*/</b><div style="height: 1.00em;">
&#160;</div>
will disable the 1024x768x256 mode. You <b>mustn't</b> disable the 640x480x256 mode!<div style="height: 1.00em;">
&#160;</div>
Your <i>et4000.regs</i> <i>must define the following symbols (register values</i> or <b>#define ... DISABLE_MODE</b>) for hard linking:<div style="height: 1.00em;">
&#160;</div>
<b>g320x200x32K_regs</b>, <b>g640x400x256_regs</b>, <b>g640x480x256_regs</b>,  <b>g640x480x32K_regs</b>, <b>g640x480x16M_regs</b>, <b>g800x600x16_regs</b>,  <b>g800x600x256_regs</b>, <b>g800x600x32K_regs</b>, <b>g1024x768x16_regs</b>,  <b>g1024x768x256_regs</b>, and <b>g1280x1024x16_regs</b>.<div style="height: 1.00em;">
&#160;</div>
and all 64K modes handled like 32K modes by the driver:<div style="height: 1.00em;">
&#160;</div>
<b>#define g320x200x64K_regs g320x200x32K_regs</b><div style="height: 0.00em;">
&#160;</div>
<b>#define g640x480x64K_regs g640x480x32K_regs</b><div style="height: 0.00em;">
&#160;</div>
<b>#define g800x600x64K_regs g800x600x32K_regs</b><div style="height: 1.00em;">
&#160;</div>
You may omit every unusable mode in <i>/usr/lib/libvga.et4000</i>.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>4. DEFINING NEW MODES</h1> All standard <b>svgalib</b>(7) modes may be selected by the mode constants defined in <b>#include&lt;vga.h&gt;</b> (eg. <b>G320x200x16</b>). You may define new modes on your own. Just use dynamic register loading and add the register definition of the new mode. Your program may determine the related modenumber by checking the vga_getmodeinfo(1..vga_lastmodenumber()).<div style="height: 1.00em;">
&#160;</div>
Most ET4000 cards provide 640x350 and 640x400 graphics modes. The <i>tseng3.exe</i> generates the related register sets. You may also use <b>dumpreg</b>(1) from an X window to grab you favourite X graphics mode. The X mode normally isn't usable directly. See <i>cardex.w32</i> for an example and <i>et4000.c</i> for a brief description of et4000 registers (both files are included in the svgalib distribution).<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>5. REDEFINING STANDARD MODES</h1> Using dynamic register loading you may redefine any standard VGA mode except of TEXT and 640x480x16. Just add the ET4000 specific register set to <i>/etc/vga/et4000.regs</i>.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>6. AVAILABLE EXAMPLES</h1> In the <i>et4000/</i> subdir of the svgalib distribution you'll find some sample register sets:<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
<b>cardex.w32</b></dt>
<dd>
Cardex ET4000/W32 card, Music TrueColor DAC</dd>
</dl>
<dl>
<dt>
<b>speedstar+</b></dt>
<dd>
SpeedSTAR PLUS card, Normal DAC</dd>
</dl>
<dl>
<dt>
<b>orchid.pdII</b></dt>
<dd>
Orchid Prodesigner II</dd>
</dl>
<div class="spacer">
</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>7. ET4000/W32 SUPPORT</h1> The actual driver seems to be ET4000/W32 compatible. Tell us about any problems (and solutions). If you've got any information about the ET4000/W32 blitter, we would be pleased to receive it.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>8. PROBLEMS</h1> As mentioned before, the DAC detection isn't very reliable. <b>vgatest</b>(6) should print equal screens in 256 color and HiColor/TrueColor modes. You may have to edit your <i>libvga.et4000</i> register file by hand to setup the correct DAC.<div style="height: 1.00em;">
&#160;</div>
The <i>tseng3.exe</i> may fail due to incompatible mode numbering. You might use a VESA driver (eg. tlivesa.com from VPIC 6.0) or edit and recompile the <i>tseng3.exe</i>.<div style="height: 1.00em;">
&#160;</div>
Newer ET4000 chipsets (eg. W32 and W32i) allow up to 32 clock frequencies. Two additional register values were added just before the old extended register value. The new registers are CRTC/30h and CRTC/31h. The old register set had 71 values, the new has grown to 73. You may update your old register set by hand:<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
-</dt>
<dd>
run the dumpreg program, remember the first two values from last data line.</dd>
</dl>
<dl>
<dt>
-</dt>
<dd>
edit your libvga:</dd>
</dl>
<div style="margin-left: 5.00ex;">
for each mode<div style="margin-left: 5.00ex;">
change the number of register values from 71 to 73<div style="height: 0.00em;">
&#160;</div>
add the values from dumpreg output at front of last data line</div>
</div>
<dl>
<dt>
-</dt>
<dd>
run .BR vgatest (6) to check the new register set<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>9. USING DYNAMIC LOADING WITH OTHER CARDS</h1> The dynamical register loading may be used in other drivers. Since hard linked register values work fine for Cirrus and Trident cards, we didn't include this feature.<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>FILES</h1> <i>/etc/vga/libvga.config</i><div style="height: 0.00em;">
&#160;</div>
<i>/etc/vga/libvga.et4000</i><div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>SEE ALSO</h1> <b>svgalib</b>(7), <b>libvga.config</b>(5).<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>AUTHOR</h1> This documentation for the ET4000 registers was provided by Hartmut Schirmer. However, it was slightly reformatted by Michael Weller &lt;eowmob@exp-math.uni-essen.de&gt;.</div>
<table class="foot">
<tr>
<td class="foot-date">
31 July 1997</td>
<td class="foot-os">
Svgalib (&gt;= 1.2.11)</td>
</tr>
</table>
</div>
</body>
</html>

