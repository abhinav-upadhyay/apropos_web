<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
POSIX_OPENPT(3P)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
POSIX_OPENPT(3P)</td>
<td class="head-vol">
POSIX Programmer's Manual</td>
<td class="head-rtitle">
POSIX_OPENPT(3P)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>PROLOG</h1> This manual page is part of the POSIX Programmer's Manual. The Linux implementation of this interface may differ (consult the corresponding Linux manual page for details of Linux behavior), or the interface may not be implemented on Linux.</div>
<div class="section">
<h1>NAME</h1> posix_openpt - open a pseudo-terminal device</div>
<div class="section">
<h1>SYNOPSIS</h1>  <b>#include &lt;stdlib.h&gt;</b><div style="height: 0.00em;">
&#160;</div>
#include &lt;fcntl.h&gt;<div style="height: 0.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
int posix_openpt(int<b> </b><i>oflag</i><b></b><b>); </b><b></b>  <b></b><b></b><div style="height: 0.00em;">
&#160;</div>
<b></b></div>
<div class="section">
<h1>DESCRIPTION</h1> The  <i>posix_openpt</i>() function shall establish a connection between a master device for a pseudo-terminal and a file descriptor. The file descriptor is used by other I/O functions that refer to that pseudo-terminal.<div class="spacer">
</div>
The file status flags and file access modes of the open file description shall be set according to the value of  <i>oflag</i>.<div class="spacer">
</div>
Values for <i>oflag</i> are constructed by a bitwise-inclusive OR of flags from the following list, defined in  <i>&lt;fcntl.h&gt;</i>:<dl>
<dt>
O_RDWR</dt>
<dd>
Open for reading and writing.</dd>
</dl>
<dl>
<dt>
O_NOCTTY</dt>
<dd>
If set <i>posix_openpt</i>() shall not cause the terminal device to become the controlling terminal for the process.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
The behavior of other values for the <i>oflag</i> argument is unspecified.</div>
<div class="section">
<h1>RETURN VALUE</h1> Upon successful completion, the  <i>posix_openpt</i>() function shall open a master pseudo-terminal device and return a non-negative integer representing the lowest numbered unused file descriptor. Otherwise, -1 shall be returned and  <i>errno</i> set to indicate the error.</div>
<div class="section">
<h1>ERRORS</h1> The  <i>posix_openpt</i>() function shall fail if:<dl>
<dt>
<b>EMFILE</b></dt>
<dd>
{OPEN_MAX} file descriptors are currently open in the calling process.</dd>
</dl>
<dl>
<dt>
<b>ENFILE</b></dt>
<dd>
The maximum allowable number of files is currently open in the system.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
The <i>posix_openpt</i>() function may fail if:<dl>
<dt>
<b>EINVAL</b></dt>
<dd>
The value of <i>oflag</i> is not valid.</dd>
</dl>
<dl>
<dt>
<b>EAGAIN</b></dt>
<dd>
Out of pseudo-terminal resources.</dd>
</dl>
<dl>
<dt>
<b>ENOSR</b></dt>
<dd>
Out of STREAMS resources.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
<i>The following sections are informative.</i></div>
<div class="section">
<h1>EXAMPLES</h1><div class="subsection">
<h2>Opening a Pseudo-Terminal and Returning the Name of the Slave</h2> Device and a File Descriptor<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>#include &lt;fcntl.h&gt;</b><br/>
<b>#include &lt;stdio.h&gt;</b><div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
int masterfd, slavefd;<br/>
char *slavedevice;<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
masterfd = posix_openpt(O_RDWR|O_NOCTTY);<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
if (masterfd == -1<br/>
    || grantpt (masterfd) == -1<br/>
    || unlockpt (masterfd) == -1<br/>
    || (slavedevice = ptsname (masterfd)) == NULL)<br/>
    return -1;<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
printf(&quot;slave device is: %s\n&quot;, slavedevice);<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
slavefd = open(slave, O_RDWR|O_NOCTTY);<br/>
if (slavefd &lt; 0)<br/>
    return -1;<br/>
<b></b><br/>
</div>
</div>
</div>
<div class="section">
<h1>APPLICATION USAGE</h1> This function is a method for portably obtaining a file descriptor of a master terminal device for a pseudo-terminal. The  <i>grantpt</i>() and  <i>ptsname</i>() functions can be used to manipulate mode and ownership permissions, and to obtain the name of the slave device, respectively.</div>
<div class="section">
<h1>RATIONALE</h1> The standard developers considered the matter of adding a special device for cloning master pseudo-terminals: the  <b>/dev/ptmx</b> device. However, consensus could not be reached, and it was felt that adding a new function would permit other implementations. The  <i>posix_openpt</i>() function is designed to complement the  <i>grantpt</i>(), <i>ptsname</i>(), and <i>unlockpt</i>() functions.<div class="spacer">
</div>
On implementations supporting the <b>/dev/ptmx</b> clone device, opening the master device of a pseudo-terminal is simply:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>mfdp = open(&quot;/dev/ptmx&quot;, oflag );</b><br/>
<b>if (mfdp &lt; 0)</b><br/>
<b>    return -1;</b><br/>
<b></b><br/>
</div>
</div>
<div class="section">
<h1>FUTURE DIRECTIONS</h1> None.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>grantpt</i>(), <i>open</i>(), <i>ptsname</i>(), <i>unlockpt</i>(), the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001,  <i>&lt;fcntl.h&gt;</i></div>
<div class="section">
<h1>COPYRIGHT</h1> Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1, 2003 Edition, Standard for Information Technology -- Portable Operating System Interface (POSIX), The Open Group Base Specifications Issue 6, Copyright (C) 2001-2003 by the Institute of Electrical and Electronics Engineers, Inc and The Open Group. In the event of any discrepancy between this version and the original IEEE and The Open Group Standard, the original IEEE and The Open Group Standard is the referee document. The original Standard can be obtained online at http://www.opengroup.org/unix/online.html .</div>
<table class="foot">
<tr>
<td class="foot-date">
2003</td>
<td class="foot-os">
IEEE/The Open Group</td>
</tr>
</table>
</div>
</body>
</html>

