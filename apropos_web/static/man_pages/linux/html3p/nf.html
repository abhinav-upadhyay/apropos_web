<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
NFTW(3P)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
NFTW(3P)</td>
<td class="head-vol">
POSIX Programmer's Manual</td>
<td class="head-rtitle">
NFTW(3P)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>PROLOG</h1> This manual page is part of the POSIX Programmer's Manual. The Linux implementation of this interface may differ (consult the corresponding Linux manual page for details of Linux behavior), or the interface may not be implemented on Linux.</div>
<div class="section">
<h1>NAME</h1> nftw - walk a file tree</div>
<div class="section">
<h1>SYNOPSIS</h1>  <b>#include &lt;ftw.h&gt;</b><div style="height: 0.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
int nftw(const char *<b></b><i>path</i><b></b><b>, int (*</b><b></b><i>fn</i><b></b><b>)(const</b>  <b>char *,</b><div style="height: 0.00em;">
&#160;</div>
&#160;&#160;&#160;&#160;&#160;&#160; const struct stat *, int, struct FTW *), int<b> </b><i>depth</i><b></b><b>,</b>  <b>int</b><b></b>  <b></b><i>flags</i><b></b><b>);</b><div style="height: 0.00em;">
&#160;</div>
<b></b></div>
<div class="section">
<h1>DESCRIPTION</h1> The  <i>nftw</i>() function shall recursively descend the directory hierarchy rooted in  <i>path</i>. The <i>nftw</i>() function has a similar effect to  <i>ftw</i>() except that it takes an additional argument  <i>flags</i>, which is a bitwise-inclusive OR of zero or more of the following flags:<dl>
<dt>
FTW_CHDIR</dt>
<dd>
If set, <i>nftw</i>() shall change the current working directory to each directory as it reports files in that directory. If clear,  <i>nftw</i>() shall not change the current working directory.</dd>
</dl>
<dl>
<dt>
FTW_DEPTH</dt>
<dd>
If set, <i>nftw</i>() shall report all files in a directory before reporting the directory itself. If clear,  <i>nftw</i>() shall report any directory before reporting the files in that directory.</dd>
</dl>
<dl>
<dt>
FTW_MOUNT</dt>
<dd>
If set, <i>nftw</i>() shall only report files in the same file system as  <i>path</i>. If clear, <i>nftw</i>() shall report all files encountered during the walk.</dd>
</dl>
<dl>
<dt>
FTW_PHYS</dt>
<dd>
If set, <i>nftw</i>() shall perform a physical walk and shall not follow symbolic links.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
If FTW_PHYS is clear and FTW_DEPTH is set, <i>nftw</i>() shall follow links instead of reporting them, but shall not report any directory that would be a descendant of itself. If FTW_PHYS is clear and FTW_DEPTH is clear,  <i>nftw</i>() shall follow links instead of reporting them, but shall not report the contents of any directory that would be a descendant of itself.<div class="spacer">
</div>
At each file it encounters, <i>nftw</i>() shall call the user-supplied function  <i>fn</i> with four arguments:<dl>
<dt>
 *</dt>
<dd>
The first argument is the pathname of the object.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
The second argument is a pointer to the <b>stat</b> buffer containing information on the object.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
The third argument is an integer giving additional information. Its value is one of the following:</dd>
</dl>
<dl>
<dt>
FTW_F</dt>
<dd>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
The object is a file.</div>
<dl>
<dt>
FTW_D</dt>
<dd>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
The object is a directory.</div>
<dl>
<dt>
FTW_DP</dt>
<dd>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
The object is a directory and subdirectories have been visited. (This condition shall only occur if the FTW_DEPTH flag is included in  <i>flags</i>.)</div>
<dl>
<dt>
FTW_SL</dt>
<dd>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
The object is a symbolic link. (This condition shall only occur if the FTW_PHYS flag is included in  <i>flags</i>.)</div>
<dl>
<dt>
FTW_SLN</dt>
<dd>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
The object is a symbolic link that does not name an existing file. (This condition shall only occur if the FTW_PHYS flag is not included in  <i>flags</i>.)</div>
<dl>
<dt>
FTW_DNR</dt>
<dd>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
The object is a directory that cannot be read. The <i>fn</i> function shall not be called for any of its descendants.</div>
<dl>
<dt>
FTW_NS</dt>
<dd>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
The <i>stat</i>() function failed on the object because of lack of appropriate permission. The  <b>stat</b> buffer passed to <i>fn</i> is undefined. Failure of  <i>stat</i>() for any other reason is considered an error and  <i>nftw</i>() shall return -1.</div>
<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
 *</dt>
<dd>
The fourth argument is a pointer to an <b>FTW</b> structure. The value of  <b>base</b> is the offset of the object's filename in the pathname passed as the first argument to  <i>fn</i>. The value of  <b>level</b> indicates depth relative to the root of the walk, where the root level is 0.</dd>
</dl>
<div class="spacer">
</div>
The results are unspecified if the application-supplied <i>fn</i> function does not preserve the current working directory.<div class="spacer">
</div>
The argument <i>depth</i> sets the maximum number of file descriptors that shall be used by  <i>nftw</i>() while traversing the file tree. At most one file descriptor shall be used for each directory level.<div class="spacer">
</div>
The <i>nftw</i>() function need not be reentrant. A function that is not required to be reentrant is not required to be thread-safe.</div>
<div class="section">
<h1>RETURN VALUE</h1> The  <i>nftw</i>() function shall continue until the first of the following conditions occurs:<dl>
<dt>
 *</dt>
<dd>
An invocation of <i>fn</i> shall return a non-zero value, in which case  <i>nftw</i>() shall return that value.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
The <i>nftw</i>() function detects an error other than [EACCES] (see FTW_DNR and FTW_NS above), in which case  <i>nftw</i>() shall return -1 and set  <i>errno</i> to indicate the error.</dd>
</dl>
<dl>
<dt>
 *</dt>
<dd>
The tree is exhausted, in which case <i>nftw</i>() shall return 0.</dd>
</dl>
</div>
<div class="section">
<h1>ERRORS</h1> The  <i>nftw</i>() function shall fail if:<dl>
<dt>
<b>EACCES</b></dt>
<dd>
Search permission is denied for any component of <i>path</i> or read permission is denied for  <i>path</i>, or <i>fn</i> returns -1 and does not reset  <i>errno</i>.</dd>
</dl>
<dl>
<dt>
<b>ELOOP</b></dt>
<dd>
A loop exists in symbolic links encountered during resolution of the  <i>path</i> argument.</dd>
</dl>
<dl>
<dt>
<b>ENAMETOOLONG</b></dt>
<dd>
The length of the <i>path</i> argument exceeds {PATH_MAX} or a pathname component is longer than {NAME_MAX}.</dd>
</dl>
<dl>
<dt>
<b>ENOENT</b></dt>
<dd>
A component of <i>path</i> does not name an existing file or <i>path</i> is an empty string.</dd>
</dl>
<dl>
<dt>
<b>ENOTDIR</b></dt>
<dd>
A component of <i>path</i> is not a directory.</dd>
</dl>
<dl>
<dt>
<b>EOVERFLOW</b></dt>
<dd>
A field in the <b>stat</b> structure cannot be represented correctly in the current programming environment for one or more files found in the file hierarchy.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
The <i>nftw</i>() function may fail if:<dl>
<dt>
<b>ELOOP</b></dt>
<dd>
More than {SYMLOOP_MAX} symbolic links were encountered during resolution of the  <i>path</i> argument.</dd>
</dl>
<dl>
<dt>
<b>EMFILE</b></dt>
<dd>
{OPEN_MAX} file descriptors are currently open in the calling process.</dd>
</dl>
<dl>
<dt>
<b>ENAMETOOLONG</b></dt>
<dd>
Pathname resolution of a symbolic link produced an intermediate result whose length exceeds {PATH_MAX}.</dd>
</dl>
<dl>
<dt>
<b>ENFILE</b></dt>
<dd>
Too many files are currently open in the system.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div class="spacer">
</div>
In addition, <i>errno</i> may be set if the function pointed to by  <i>fn</i> causes <i>errno</i> to be set.<div class="spacer">
</div>
<i>The following sections are informative.</i></div>
<div class="section">
<h1>EXAMPLES</h1> The following example walks the  <b>/tmp</b> directory and its subdirectories, calling the  <i>nftw</i>() function for every directory entry, to a maximum of 5 levels deep.<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>#include &lt;ftw.h&gt;</b><br/>
<b>...</b><br/>
<b>int nftwfunc(const char *, const struct stat *, int, struct FTW *);</b><div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
int nftwfunc(const char *filename, const struct stat *statptr,<br/>
    int fileflags, struct FTW *pfwt)<br/>
{<br/>
    return 0;<br/>
}<br/>
...<br/>
char *startpath = &quot;/tmp&quot;;<br/>
int depth = 5;<br/>
int flags = FTW_CHDIR | FTW_DEPTH | FTW_MOUNT;<br/>
int ret;<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
ret = nftw(startpath, nftwfunc, depth, flags);<br/>
<b></b><br/>
</div>
</div>
<div class="section">
<h1>APPLICATION USAGE</h1> None.</div>
<div class="section">
<h1>RATIONALE</h1> None.</div>
<div class="section">
<h1>FUTURE DIRECTIONS</h1> None.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>lstat</i>(), <i>opendir</i>(), <i>readdir</i>(), <i>stat</i>(), the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001,  <i>&lt;ftw.h&gt;</i></div>
<div class="section">
<h1>COPYRIGHT</h1> Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1, 2003 Edition, Standard for Information Technology -- Portable Operating System Interface (POSIX), The Open Group Base Specifications Issue 6, Copyright (C) 2001-2003 by the Institute of Electrical and Electronics Engineers, Inc and The Open Group. In the event of any discrepancy between this version and the original IEEE and The Open Group Standard, the original IEEE and The Open Group Standard is the referee document. The original Standard can be obtained online at http://www.opengroup.org/unix/online.html .</div>
<table class="foot">
<tr>
<td class="foot-date">
2003</td>
<td class="foot-os">
IEEE/The Open Group</td>
</tr>
</table>
</div>
</body>
</html>

