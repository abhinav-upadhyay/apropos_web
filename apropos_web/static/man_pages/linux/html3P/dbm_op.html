<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
DBM_CLEARERR(3P)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
DBM_CLEARERR(3P)</td>
<td class="head-vol">
POSIX Programmer's Manual</td>
<td class="head-rtitle">
DBM_CLEARERR(3P)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>PROLOG</h1> This manual page is part of the POSIX Programmer's Manual. The Linux implementation of this interface may differ (consult the corresponding Linux manual page for details of Linux behavior), or the interface may not be implemented on Linux.</div>
<div class="section">
<h1>NAME</h1> dbm_clearerr, dbm_close, dbm_delete, dbm_error, dbm_fetch, dbm_firstkey, dbm_nextkey, dbm_open, dbm_store - database functions</div>
<div class="section">
<h1>SYNOPSIS</h1>  <b>#include &lt;ndbm.h&gt;</b><div style="height: 0.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
int dbm_clearerr(DBM *<b></b><i>db</i><b></b><b>);</b><div style="height: 0.00em;">
&#160;</div>
void dbm_close(DBM *<b></b><i>db</i><b></b><b>);</b><div style="height: 0.00em;">
&#160;</div>
int dbm_delete(DBM *<b></b><i>db</i><b></b><b>, datum</b><b> </b><i>key</i><b></b><b>);</b><div style="height: 0.00em;">
&#160;</div>
int dbm_error(DBM *<b></b><i>db</i><b></b><b>);</b><div style="height: 0.00em;">
&#160;</div>
datum dbm_fetch(DBM *<b></b><i>db</i><b></b><b>, datum</b><b> </b><i>key</i><b></b><b>);</b><div style="height: 0.00em;">
&#160;</div>
datum dbm_firstkey(DBM *<b></b><i>db</i><b></b><b>);</b><div style="height: 0.00em;">
&#160;</div>
datum dbm_nextkey(DBM *<b></b><i>db</i><b></b><b>);</b><div style="height: 0.00em;">
&#160;</div>
DBM *dbm_open(const char *<b></b><i>file</i><b></b><b>, int</b><b> </b><i>open_flags</i><b></b><b>,</b>  <b>mode_t</b><b> </b><i>file_mode</i><b></b><b>);</b><div style="height: 0.00em;">
&#160;</div>
int dbm_store(DBM *<b></b><i>db</i><b></b><b>, datum</b><b> </b><i>key</i><b></b><b>, datum</b><b></b>  <b></b><i>content</i><b></b><b>, int</b><b></b>  <b></b><i>store_mode</i><b></b><b>);</b><div style="height: 0.00em;">
&#160;</div>
<b></b></div>
<div class="section">
<h1>DESCRIPTION</h1> These functions create, access, and modify a database.<div class="spacer">
</div>
A <b>datum</b> consists of at least two members, <i>dptr</i> and <i>dsize</i>. The  <i>dptr</i> member points to an object that is  <i>dsize</i> bytes in length. Arbitrary binary data, as well as character strings, may be stored in the object pointed to by  <i>dptr</i>.<div class="spacer">
</div>
The database is stored in two files. One file is a directory containing a bitmap of keys and has  <b>.dir</b> as its suffix. The second file contains all data and has  <b>.pag</b> as its suffix.<div class="spacer">
</div>
The <i>dbm_open</i>() function shall open a database. The <i>file</i> argument to the function is the pathname of the database. The function opens two files named  <i>file</i><b>.dir</b> and <i>file</i><b>.pag</b>. The  <i>open_flags</i> argument has the same meaning as the  <i>flags</i> argument of <i>open</i>() except that a database opened for write-only access opens the files for read and write access and the behavior of the O_APPEND flag is unspecified. The  <i>file_mode</i> argument has the same meaning as the third argument of  <i>open</i>().<div class="spacer">
</div>
The <i>dbm_close</i>() function shall close a database. The application shall ensure that argument  <i>db</i> is a pointer to a  <b>dbm</b> structure that has been returned from a call to <i>dbm_open</i>().<div class="spacer">
</div>
These database functions shall support an internal block size large enough to support key/content pairs of at least 1023 bytes.<div class="spacer">
</div>
The <i>dbm_fetch</i>() function shall read a record from a database. The argument  <i>db</i> is a pointer to a database structure that has been returned from a call to  <i>dbm_open</i>(). The argument  <i>key</i> is a <b>datum</b> that has been initialized by the application to the value of the key that matches the key of the record the program is fetching.<div class="spacer">
</div>
The <i>dbm_store</i>() function shall write a record to a database. The argument  <i>db</i> is a pointer to a database structure that has been returned from a call to  <i>dbm_open</i>(). The argument  <i>key</i> is a <b>datum</b> that has been initialized by the application to the value of the key that identifies (for subsequent reading, writing, or deleting) the record the application is writing. The argument  <i>content</i> is a <b>datum</b> that has been initialized by the application to the value of the record the program is writing. The argument  <i>store_mode</i> controls whether  <i>dbm_store</i>() replaces any pre-existing record that has the same key that is specified by the  <i>key</i> argument. The application shall set  <i>store_mode</i> to either DBM_INSERT or DBM_REPLACE. If the database contains a record that matches the  <i>key</i> argument and  <i>store_mode</i> is DBM_REPLACE, the existing record shall be replaced with the new record. If the database contains a record that matches the  <i>key</i> argument and  <i>store_mode</i> is DBM_INSERT, the existing record shall be left unchanged and the new record ignored. If the database does not contain a record that matches the  <i>key</i> argument and <i>store_mode</i> is either DBM_INSERT or DBM_REPLACE, the new record shall be inserted in the database.<div class="spacer">
</div>
If the sum of a key/content pair exceeds the internal block size, the result is unspecified. Moreover, the application shall ensure that all key/content pairs that hash together fit on a single block. The  <i>dbm_store</i>() function shall return an error in the event that a disk block fills with inseparable data.<div class="spacer">
</div>
The <i>dbm_delete</i>() function shall delete a record and its key from the database. The argument  <i>db</i> is a pointer to a database structure that has been returned from a call to  <i>dbm_open</i>(). The argument  <i>key</i> is a <b>datum</b> that has been initialized by the application to the value of the key that identifies the record the program is deleting.<div class="spacer">
</div>
The <i>dbm_firstkey</i>() function shall return the first key in the database. The argument  <i>db</i> is a pointer to a database structure that has been returned from a call to  <i>dbm_open</i>().<div class="spacer">
</div>
The <i>dbm_nextkey</i>() function shall return the next key in the database. The argument  <i>db</i> is a pointer to a database structure that has been returned from a call to  <i>dbm_open</i>(). The application shall ensure that the  <i>dbm_firstkey</i>() function is called before calling  <i>dbm_nextkey</i>(). Subsequent calls to  <i>dbm_nextkey</i>() return the next key until all of the keys in the database have been returned.<div class="spacer">
</div>
The <i>dbm_error</i>() function shall return the error condition of the database. The argument  <i>db</i> is a pointer to a database structure that has been returned from a call to  <i>dbm_open</i>().<div class="spacer">
</div>
The <i>dbm_clearerr</i>() function shall clear the error condition of the database. The argument  <i>db</i> is a pointer to a database structure that has been returned from a call to  <i>dbm_open</i>().<div class="spacer">
</div>
The <i>dptr</i> pointers returned by these functions may point into static storage that may be changed by subsequent calls.<div class="spacer">
</div>
These functions need not be reentrant. A function that is not required to be reentrant is not required to be thread-safe.</div>
<div class="section">
<h1>RETURN VALUE</h1> The  <i>dbm_store</i>() and <i>dbm_delete</i>() functions shall return 0 when they succeed and a negative value when they fail.<div class="spacer">
</div>
The <i>dbm_store</i>() function shall return 1 if it is called with a  <i>flags</i> value of DBM_INSERT and the function finds an existing record with the same key.<div class="spacer">
</div>
The <i>dbm_error</i>() function shall return 0 if the error condition is not set and return a non-zero value if the error condition is set.<div class="spacer">
</div>
The return value of <i>dbm_clearerr</i>() is unspecified.<div class="spacer">
</div>
The <i>dbm_firstkey</i>() and <i>dbm_nextkey</i>() functions shall return a key  <b>datum</b>. When the end of the database is reached, the  <i>dptr</i> member of the key is a null pointer. If an error is detected, the  <i>dptr</i> member of the key shall be a null pointer and the error condition of the database shall be set.<div class="spacer">
</div>
The <i>dbm_fetch</i>() function shall return a content <b>datum</b>. If no record in the database matches the key or if an error condition has been detected in the database, the  <i>dptr</i> member of the content shall be a null pointer.<div class="spacer">
</div>
The <i>dbm_open</i>() function shall return a pointer to a database structure. If an error is detected during the operation,  <i>dbm_open</i>() shall return a ( <b>DBM *</b>)0.</div>
<div class="section">
<h1>ERRORS</h1> No errors are defined.<div class="spacer">
</div>
<i>The following sections are informative.</i></div>
<div class="section">
<h1>EXAMPLES</h1> None.</div>
<div class="section">
<h1>APPLICATION USAGE</h1> The following code can be used to traverse the database:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
<div class="spacer">
</div>
<br/>
<b>for(key = dbm_firstkey(db); key.dptr != NULL; key = dbm_nextkey(db))</b><br/>
<b></b><br/>
</div>
<div class="spacer">
</div>
The <i>dbm_</i>* functions provided in this library should not be confused in any way with those of a general-purpose database management system. These functions do not provide for multiple search keys per entry, they do not protect against multi-user access (in other words they do not lock records or files), and they do not provide the many other useful database functions that are found in more robust database management systems. Creating and updating databases by use of these functions is relatively slow because of data copies that occur upon hash collisions. These functions are useful for applications requiring fast lookup of relatively static information that is to be indexed by a single key.<div class="spacer">
</div>
Note that a strictly conforming application is extremely limited by these functions: since there is no way to determine that the keys in use do not all hash to the same value (although that would be rare), a strictly conforming application cannot be guaranteed that it can store more than one block's worth of data in the database. As long as a key collision does not occur, additional data may be stored, but because there is no way to determine whether an error is due to a key collision or some other error condition (  <i>dbm_error</i>() being effectively a Boolean), once an error is detected, the application is effectively limited to guessing what the error might be if it wishes to continue using these functions.<div class="spacer">
</div>
The <i>dbm_delete</i>() function need not physically reclaim file space, although it does make it available for reuse by the database.<div class="spacer">
</div>
After calling <i>dbm_store</i>() or <i>dbm_delete</i>() during a pass through the keys by  <i>dbm_firstkey</i>() and  <i>dbm_nextkey</i>(), the application should reset the database by calling  <i>dbm_firstkey</i>() before again calling  <i>dbm_nextkey</i>(). The contents of these files are unspecified and may not be portable.</div>
<div class="section">
<h1>RATIONALE</h1> None.</div>
<div class="section">
<h1>FUTURE DIRECTIONS</h1> None.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>open</i>(), the Base Definitions volume of IEEE&#160;Std&#160;1003.1-2001,  <i>&lt;ndbm.h&gt;</i></div>
<div class="section">
<h1>COPYRIGHT</h1> Portions of this text are reprinted and reproduced in electronic form from IEEE Std 1003.1, 2003 Edition, Standard for Information Technology -- Portable Operating System Interface (POSIX), The Open Group Base Specifications Issue 6, Copyright (C) 2001-2003 by the Institute of Electrical and Electronics Engineers, Inc and The Open Group. In the event of any discrepancy between this version and the original IEEE and The Open Group Standard, the original IEEE and The Open Group Standard is the referee document. The original Standard can be obtained online at http://www.opengroup.org/unix/online.html .</div>
<table class="foot">
<tr>
<td class="foot-date">
2003</td>
<td class="foot-os">
IEEE/The Open Group</td>
</tr>
</table>
</div>
</body>
</html>

