<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
PAM_PWHISTORY(8)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
PAM_PWHISTORY(8)</td>
<td class="head-vol">
Linux-PAM Manual</td>
<td class="head-rtitle">
PAM_PWHISTORY(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> pam_pwhistory - PAM module to remember last passwords</div>
<div class="section">
<h1>SYNOPSIS</h1><div style="margin-left: 18.00ex;text-indent: -18.00ex;" class="spacer">
<b>pam_pwhistory.so</b> [debug] [use_authtok] [enforce_for_root] [remember=<i>N</i>] [retry=<i>N</i>] [authtok_type=<i>STRING</i>]</div>
</div>
<div class="section">
<h1>DESCRIPTION</h1> This module saves the last passwords for each user in order to force password change history and keep the user from alternating between the same password too frequently.<div class="spacer">
</div>
This module does not work together with kerberos. In general, it does not make much sense to use this module in conjunction with NIS or LDAP, since the old passwords are stored on the local machine and are not available on another machine for password history checking.</div>
<div class="section">
<h1>OPTIONS</h1>  <b>debug</b><div style="margin-left: 4.00ex;">
Turns on debugging via  <b>syslog</b>(3).</div>
<div class="spacer">
</div>
<b>use_authtok</b><div style="margin-left: 4.00ex;">
When password changing enforce the module to use the new password provided by a previously stacked  <b>password</b> module (this is used in the example of the stacking of the  <b>pam_cracklib</b> module documented below).</div>
<div class="spacer">
</div>
<b>enforce_for_root</b><div style="margin-left: 4.00ex;">
If this option is set, the check is enforced for root, too.</div>
<div class="spacer">
</div>
<b>remember=</b><b></b><i>N</i><div style="margin-left: 4.00ex;">
The last  <i>N</i> passwords for each user are saved in /etc/security/opasswd. The default is  <i>10</i>.</div>
<div class="spacer">
</div>
<b>retry=</b><b></b><i>N</i><div style="margin-left: 4.00ex;">
Prompt user at most  <i>N</i> times before returning with error. The default is  <i>1</i>.</div>
<div class="spacer">
</div>
<b>authtok_type=</b><b></b><i>STRING</i><div style="margin-left: 4.00ex;">
See  <b>pam_get_authtok</b>(3) for more details.</div>
</div>
<div class="section">
<h1>MODULE TYPES PROVIDED</h1> Only the  <b>password</b> module type is provided.</div>
<div class="section">
<h1>RETURN VALUES</h1> PAM_AUTHTOK_ERR<div style="margin-left: 4.00ex;">
No new password was entered, the user aborted password change or new password couldn't be set.</div>
<div class="spacer">
</div>
PAM_IGNORE<div style="margin-left: 4.00ex;">
Password history was disabled.</div>
<div class="spacer">
</div>
PAM_MAXTRIES<div style="margin-left: 4.00ex;">
Password was rejected too often.</div>
<div class="spacer">
</div>
PAM_USER_UNKNOWN<div style="margin-left: 4.00ex;">
User is not known to system.</div>
</div>
<div class="section">
<h1>EXAMPLES</h1> An example password section would be:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
<br/>
#%PAM-1.0<br/>
password     required       pam_pwhistory.so<br/>
password     required       pam_unix.so        use_authtok<br/>
      <br/>
</div>
<div class="spacer">
</div>
In combination with  <b>pam_cracklib</b>:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
<br/>
#%PAM-1.0<br/>
password     required       pam_cracklib.so    retry=3<br/>
password     required       pam_pwhistory.so   use_authtok<br/>
password     required       pam_unix.so        use_authtok<br/>
      <br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>FILES</h1> /etc/security/opasswd<div style="margin-left: 4.00ex;">
File with password history</div>
</div>
<div class="section">
<h1>SEE ALSO</h1><div style="height: 1.00em;">
&#160;</div>
<b>pam.conf</b>(5),  <b>pam.d</b>(5),  <b>pam</b>(8)  <b>pam_get_authtok</b>(3)</div>
<div class="section">
<h1>AUTHOR</h1> pam_pwhistory was written by Thorsten Kukuk &lt;kukuk@thkukuk.de&gt;</div>
<table class="foot">
<tr>
<td class="foot-date">
06/04/2011</td>
<td class="foot-os">
Linux-PAM Manual</td>
</tr>
</table>
</div>
</body>
</html>

