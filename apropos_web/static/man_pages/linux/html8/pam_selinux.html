<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
PAM_SELINUX(8)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
PAM_SELINUX(8)</td>
<td class="head-vol">
Linux-PAM Manual</td>
<td class="head-rtitle">
PAM_SELINUX(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> pam_selinux - PAM module to set the default security context</div>
<div class="section">
<h1>SYNOPSIS</h1><div style="margin-left: 16.00ex;text-indent: -16.00ex;" class="spacer">
<b>pam_selinux.so</b> [close] [debug] [open] [nottys] [verbose] [select_context] [env_params] [use_current_range]</div>
</div>
<div class="section">
<h1>DESCRIPTION</h1> In a nutshell, pam_selinux sets up the default security context for the next execed shell.<div class="spacer">
</div>
When an application opens a session using pam_selinux, the shell that gets executed will be run in the default security context, or if the user chooses and the pam file allows the selected security context. Also the controlling tty will have it's security context modified to match the users.<div class="spacer">
</div>
Adding pam_selinux into a pam file could cause other pam modules to change their behavior if the exec another application. The close and open option help mitigate this problem. close option will only cause the close portion of the pam_selinux to execute, and open will only cause the open portion to run. You can add pam_selinux to the config file twice. Add the pam_selinux close as the executes the open pass through the modules, pam_selinux open_session will happen last. When PAM executes the close pass through the modules pam_selinux close_session will happen first.</div>
<div class="section">
<h1>OPTIONS</h1>  <b>close</b><div style="margin-left: 4.00ex;">
Only execute the close_session portion of the module.</div>
<div class="spacer">
</div>
<b>debug</b><div style="margin-left: 4.00ex;">
Turns on debugging via  <b>syslog</b>(3).</div>
<div class="spacer">
</div>
<b>open</b><div style="margin-left: 4.00ex;">
Only execute the open_session portion of the module.</div>
<div class="spacer">
</div>
<b>nottys</b><div style="margin-left: 4.00ex;">
Do not try to setup the ttys security context.</div>
<div class="spacer">
</div>
<b>verbose</b><div style="margin-left: 4.00ex;">
attempt to inform the user when security context is set.</div>
<div class="spacer">
</div>
<b>select_context</b><div style="margin-left: 4.00ex;">
Attempt to ask the user for a custom security context role. If MLS is on ask also for sensitivity level.</div>
<div class="spacer">
</div>
<b>env_params</b><div style="margin-left: 4.00ex;">
Attempt to obtain a custom security context role from PAM environment. If MLS is on obtain also sensitivity level. This option and the select_context option are mutually exclusive. The respective PAM environment variables are  <i>SELINUX_ROLE_REQUESTED</i>,  <i>SELINUX_LEVEL_REQUESTED</i>, and  <i>SELINUX_USE_CURRENT_RANGE</i>. The first two variables are self describing and the last one if set to 1 makes the PAM module behave as if the use_current_range was specified on the command line of the module.</div>
<div class="spacer">
</div>
<b>use_current_range</b><div style="margin-left: 4.00ex;">
Use the sensitivity level of the current process for the user context instead of the default level. Also suppresses asking of the sensitivity level from the user or obtaining it from PAM environment.</div>
</div>
<div class="section">
<h1>MODULE TYPES PROVIDED</h1> Only the  <b>session</b> module type is provided.</div>
<div class="section">
<h1>RETURN VALUES</h1> PAM_AUTH_ERR<div style="margin-left: 4.00ex;">
Unable to get or set a valid context.</div>
<div class="spacer">
</div>
PAM_SUCCESS<div style="margin-left: 4.00ex;">
The security context was set successfully.</div>
<div class="spacer">
</div>
PAM_USER_UNKNOWN<div style="margin-left: 4.00ex;">
The user is not known to the system.</div>
</div>
<div class="section">
<h1>EXAMPLES</h1><div style="margin-left: 4.00ex;">
<br/>
auth     required  pam_unix.so<br/>
session  required  pam_permit.so<br/>
session  optional  pam_selinux.so<br/>
    <br/>
</div>
</div>
<div class="section">
<h1>SEE ALSO</h1><div style="height: 1.00em;">
&#160;</div>
<b>pam.conf</b>(5),  <b>pam.d</b>(5),  <b>pam</b>(7)</div>
<div class="section">
<h1>AUTHOR</h1> pam_selinux was written by Dan Walsh &lt;dwalsh@redhat.com&gt;.</div>
<table class="foot">
<tr>
<td class="foot-date">
08/31/2010</td>
<td class="foot-os">
Linux-PAM Manual</td>
</tr>
</table>
</div>
</body>
</html>

