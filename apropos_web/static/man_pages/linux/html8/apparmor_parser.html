<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
APPARMOR_PARSER(8)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
APPARMOR_PARSER(8)</td>
<td class="head-vol">
AppArmor</td>
<td class="head-rtitle">
APPARMOR_PARSER(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> apparmor_parser - loads AppArmor profiles into the kernel</div>
<div class="section">
<h1>SYNOPSIS</h1>  <b>apparmor_parser [-adrR] [--add] [--debug]  [--replace] [--remove]</b><br/>
<b>                  [--preprocess] [--Include n] [--base n] [ --Complain ]</b><div class="spacer">
</div>
<b>apparmor_parser [-hv] [--help] [--version]</b></div>
<div class="section">
<h1>DESCRIPTION</h1>  <b>apparmor_parser</b> is used to import new <i>apparmor.d</i>(5) profiles into the Linux kernel. The profiles restrict the operations available to processes by executable name.<div class="spacer">
</div>
The profiles are loaded into the Linux kernel by the <b>apparmor_parser</b> program, which takes its input from standard input. The input supplied to  <b>apparmor_parser</b> should be in the format described in <i>apparmor.d</i>(5).</div>
<div class="section">
<h1>OPTIONS</h1><dl>
<dt>
-a, --add</dt>
<dd>
Insert the AppArmor definitions given into the kernel. This is the default action. This gives an error message if a AppArmor definition by the same name already exists in the kernel, or if the parser doesn't understand its input. It reports when an addition succeeded.</dd>
</dl>
<dl>
<dt>
-r, --replace</dt>
<dd>
This flag is required if an AppArmor definition by the same name already exists in the kernel; used to replace the definition already in the kernel with the definition given on standard input.</dd>
</dl>
<dl>
<dt>
-R, --remove</dt>
<dd>
This flag is used to remove an AppArmor definition already in the kernel. Note that it still requires a complete AppArmor definition as described in  <i>apparmor.d</i>(5) even though the contents of the definition aren't used.</dd>
</dl>
<dl>
<dt>
-C, --Complain</dt>
<dd>
For the profile to load in complain mode.</dd>
</dl>
<dl>
<dt>
-B, --binary</dt>
<dd>
Load a binary (cached) profile, as produced with the -S option.</dd>
</dl>
<dl>
<dt>
-N, --names</dt>
<dd>
Produce a list of policies from a given set of profiles (implies -K).</dd>
</dl>
<dl>
<dt>
-S, --stdout</dt>
<dd>
Writes a binary (cached) profile to stdout (implies -K and -T).</dd>
</dl>
<dl>
<dt>
-o file, --ofile file</dt>
<dd>
Writes a binary (cached) profile to the specified file (implies -K and -T)</dd>
</dl>
<dl>
<dt>
-b n, --base n</dt>
<dd>
Set the base directory for resolving #include directives defined as relative paths.</dd>
</dl>
<dl>
<dt>
-I n, --Include n</dt>
<dd>
Add element n to the search path when resolving #include directives defined as an absolute paths.</dd>
</dl>
<dl>
<dt>
-f n, --subdomainfs n</dt>
<dd>
Set the location of the apparmor security filesystem (default is &quot;/sys/kernel/security/apparmor&quot;).</dd>
</dl>
<dl>
<dt>
-m n, --match-string n</dt>
<dd>
Only use match features &quot;n&quot;.</dd>
</dl>
<dl>
<dt>
-n n, --namespace-string n</dt>
<dd>
Force a profile to load in the namespace &quot;n&quot;.</dd>
</dl>
<dl>
<dt>
-X, --readimpliesX</dt>
<dd>
In the case of profiles that are loading on systems were READ_IMPLIES_EXEC is set in the kernel for a given process, load the profile so that any &quot;r&quot; flags are processed as &quot;mr&quot;.</dd>
</dl>
<dl>
<dt>
-k, --show-cache</dt>
<dd>
Report the cache processing (hit/miss details) when loading or saving cached profiles.</dd>
</dl>
<dl>
<dt>
-K, --skip-cache</dt>
<dd>
Perform no caching at all: disables -W, implies -T.</dd>
</dl>
<dl>
<dt>
-T, --skip-read-cache</dt>
<dd>
By default, if a profile's cache is found in the location specified by --cache-loc and the timestamp is newer than the profile, it will be loaded from the cache. This option disables this cache loading behavior.</dd>
</dl>
<dl>
<dt>
-W, --write-cache</dt>
<dd>
Write out cached profiles to the location specified in --cache-loc.  Off by default. In cases where abstractions have been changed, and the parser is running with &quot;--replace&quot;, it may make sense to also use &quot;--skip-read-cache&quot; with the &quot;--write-cache&quot; option.</dd>
</dl>
<dl>
<dt>
-L, --cache-loc</dt>
<dd>
Set the location of the cache directory.  If not specified the cache location defaults to /etc/apparmor.d/cache</dd>
</dl>
<dl>
<dt>
-Q, --skip-kernel-load</dt>
<dd>
Perform all actions except the actual loading of a profile into the kernel. This is useful for testing profile generation, caching, etc, without making changes to the running kernel profiles.</dd>
</dl>
<dl>
<dt>
-q, --quiet</dt>
<dd>
Do not report on the profiles as they are loaded, and not show warnings.</dd>
</dl>
<dl>
<dt>
-v, --verbose</dt>
<dd>
Report on the profiles as they are loaded, and show warnings.</dd>
</dl>
<dl>
<dt>
-V, --version</dt>
<dd>
Print the version number and exit.</dd>
</dl>
<dl>
<dt>
-p, --preprocess</dt>
<dd>
Dump the input profile to stdout out applying preprocessing flattening includes into the output profile.</dd>
</dl>
<dl>
<dt>
-d, --debug</dt>
<dd>
Given once, only checks the profiles to ensure syntactic correctness. Given twice, dumps its interpretation of the profile for checking.</dd>
</dl>
<dl>
<dt>
-D n, --dump=n</dt>
<dd>
Debug flag for dumping various structures and passes of policy compilation. A single dump flag can be specified per --dump option, but the dump flag can be passed multiple times.  Note progress flags tend to also imply the matching stats flag.<div style="height: 1.00em;">
&#160;</div>
<br/>
  apparmor_parser --dump=dfa-stats --dump=trans-stats &lt;file&gt;<br/>
<div style="height: 1.00em;">
&#160;</div>
Use --help=dump to see a full list of which dump flags are supported</dd>
</dl>
<dl>
<dt>
-O n, --optimize=n</dt>
<dd>
Set the optimization flags used by policy compilation.  A sinlge optimization flag can be toggled per -O option, but the optimize flag can be passed multiple times.  Turning off some phases of the optimization can make it so that policy can't complete compilation due to size constraints (it is entirely possible to create a dfa with millions of states that will take days or longer to compile).<div style="height: 1.00em;">
&#160;</div>
Note: The parser is set to use a balanced default set of flags, that will result in resonable compression but not take excessive amounts of time to complete.<div style="height: 1.00em;">
&#160;</div>
Use --help=optimize to see a full list of which optimization flags are supported.</dd>
</dl>
<dl>
<dt>
-h, --help</dt>
<dd>
Give a quick reference guide.</dd>
</dl>
</div>
<div class="section">
<h1>CONFIG FILE</h1> An optional config file /etc/apparmor/parser.conf can be used to specify the default options for the parser, which then can be overridden using the command line options.<div class="spacer">
</div>
The config file ignores leading whitespace and treats lines that begin with # as comments.  Config options are specified one per line using the same format as the longform command line options (without the preceding --).<div class="spacer">
</div>
Eg.<br/>
    #comment<div class="spacer">
</div>
<br/>
    optimize=no-expr-tree<br/>
    optimize=compress-fast<br/>
<div class="spacer">
</div>
As with the command line some options accumulate and others override, ie. when there are conflicting versions of switch the last option is the one chosen.<div class="spacer">
</div>
Eg.<br/>
    Optimize=no-minimize<br/>
    Optimize=minimize<div class="spacer">
</div>
would result in Optimize=minimize being set.<div class="spacer">
</div>
The Include, Dump, and Optimize options accululate except for the inversion option (no-X vs. X), and a couple options that work by setting/clearing multiple options (compress-small).  In that case the option will override the flags it sets but will may accumulate with others.<div class="spacer">
</div>
All other options override previously set values.</div>
<div class="section">
<h1>BUGS</h1> If you find any bugs, please report them at &lt;http://https://bugs.launchpad.net/apparmor/+filebug&gt;.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>apparmor</i>(7), <i>apparmor.d</i>(5), <i>subdomain.conf</i>(5), <i>aa_change_hat</i>(2), and &lt;http://wiki.apparmor.net&gt;.</div>
<table class="foot">
<tr>
<td class="foot-date">
2012-02-24</td>
<td class="foot-os">
AppArmor 2.7.102</td>
</tr>
</table>
</div>
</body>
</html>

