<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
PAM_SUCCEED_IF(8)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
PAM_SUCCEED_IF(8)</td>
<td class="head-vol">
Linux-PAM</td>
<td class="head-rtitle">
PAM_SUCCEED_IF(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> pam_succeed_if - test account characteristics</div>
<div class="section">
<h1>SYNOPSIS</h1><div style="margin-left: 19.00ex;text-indent: -19.00ex;" class="spacer">
<b>pam_succeed_if.so</b> [<i>flag</i>...] [<i>condition</i>...]</div>
</div>
<div class="section">
<h1>DESCRIPTION</h1> pam_succeed_if.so is designed to succeed or fail authentication based on characteristics of the account belonging to the user being authenticated. One use is to select whether to load other modules based on this test.<div class="spacer">
</div>
The module should be given one or more conditions as module arguments, and authentication will succeed only if all of the conditions are met.</div>
<div class="section">
<h1>OPTIONS</h1> The following  <i>flag</i>s are supported:<div class="spacer">
</div>
<b>debug</b><div style="margin-left: 4.00ex;">
Turns on debugging messages sent to syslog.</div>
<div class="spacer">
</div>
<b>use_uid</b><div style="margin-left: 4.00ex;">
Evaluate conditions using the account of the user whose UID the application is running under instead of the user being authenticated.</div>
<div class="spacer">
</div>
<b>quiet</b><div style="margin-left: 4.00ex;">
Don't log failure or success to the system log.</div>
<div class="spacer">
</div>
<b>quiet_fail</b><div style="margin-left: 4.00ex;">
Don't log failure to the system log.</div>
<div class="spacer">
</div>
<b>quiet_success</b><div style="margin-left: 4.00ex;">
Don't log success to the system log.</div>
<div class="spacer">
</div>
<b>audit</b><div style="margin-left: 4.00ex;">
Log unknown users to the system log.</div>
<div class="spacer">
</div>
<div style="height: 1.00em;">
&#160;</div>
<i>Condition</i>s are three words: a field, a test, and a value to test for.<div class="spacer">
</div>
Available fields are  <i>user</i>,  <i>uid</i>,  <i>gid</i>,  <i>shell</i>,  <i>home</i> and  <i>service</i>:<div class="spacer">
</div>
<b>field &lt; number</b><div style="margin-left: 4.00ex;">
Field has a value numerically less than number.</div>
<div class="spacer">
</div>
<b>field &lt;= number</b><div style="margin-left: 4.00ex;">
Field has a value numerically less than or equal to number.</div>
<div class="spacer">
</div>
<b>field eq number</b><div style="margin-left: 4.00ex;">
Field has a value numerically equal to number.</div>
<div class="spacer">
</div>
<b>field &gt;= number</b><div style="margin-left: 4.00ex;">
Field has a value numerically greater than or equal to number.</div>
<div class="spacer">
</div>
<b>field &gt; number</b><div style="margin-left: 4.00ex;">
Field has a value numerically greater than number.</div>
<div class="spacer">
</div>
<b>field ne number</b><div style="margin-left: 4.00ex;">
Field has a value numerically different from number.</div>
<div class="spacer">
</div>
<b>field = string</b><div style="margin-left: 4.00ex;">
Field exactly matches the given string.</div>
<div class="spacer">
</div>
<b>field != string</b><div style="margin-left: 4.00ex;">
Field does not match the given string.</div>
<div class="spacer">
</div>
<b>field =~ glob</b><div style="margin-left: 4.00ex;">
Field matches the given glob.</div>
<div class="spacer">
</div>
<b>field !~ glob</b><div style="margin-left: 4.00ex;">
Field does not match the given glob.</div>
<div class="spacer">
</div>
<b>field in item:item:...</b><div style="margin-left: 4.00ex;">
Field is contained in the list of items separated by colons.</div>
<div class="spacer">
</div>
<b>field notin item:item:...</b><div style="margin-left: 4.00ex;">
Field is not contained in the list of items separated by colons.</div>
<div class="spacer">
</div>
<b>user ingroup group</b><div style="margin-left: 4.00ex;">
User is in given group.</div>
<div class="spacer">
</div>
<b>user notingroup group</b><div style="margin-left: 4.00ex;">
User is not in given group.</div>
<div class="spacer">
</div>
<b>user innetgr netgroup</b><div style="margin-left: 4.00ex;">
(user,host) is in given netgroup.</div>
<div class="spacer">
</div>
<b>user notinnetgr group</b><div style="margin-left: 4.00ex;">
(user,host) is not in given netgroup.</div>
</div>
<div class="section">
<h1>MODULE TYPES PROVIDED</h1> All module types ( <b>account</b>,  <b>auth</b>,  <b>password</b> and  <b>session</b>) are provided.</div>
<div class="section">
<h1>RETURN VALUES</h1> PAM_SUCCESS<div style="margin-left: 4.00ex;">
The condition was true.</div>
<div class="spacer">
</div>
PAM_AUTH_ERR<div style="margin-left: 4.00ex;">
The condition was false.</div>
<div class="spacer">
</div>
PAM_SERVICE_ERR<div style="margin-left: 4.00ex;">
A service error occurred or the arguments can't be parsed correctly.</div>
</div>
<div class="section">
<h1>EXAMPLES</h1> To emulate the behaviour of  <i>pam_wheel</i>, except there is no fallback to group 0:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
<br/>
auth required pam_succeed_if.so quiet user ingroup wheel<br/>
    <br/>
</div>
<div class="spacer">
</div>
Given that the type matches, only loads the othermodule rule if the UID is over 500. Adjust the number after default to skip several rules.<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
<br/>
type [default=1 success=ignore] pam_succeed_if.so quiet uid &gt; 500<br/>
type required othermodule.so arguments...<br/>
    <br/>
</div>
</div>
<div class="section">
<h1>SEE ALSO</h1><div style="height: 1.00em;">
&#160;</div>
<b>glob</b>(7),  <b>pam</b>(7)</div>
<div class="section">
<h1>AUTHOR</h1> Nalin Dahyabhai &lt;nalin@redhat.com&gt;</div>
<table class="foot">
<tr>
<td class="foot-date">
06/04/2011</td>
<td class="foot-os">
Linux-PAM</td>
</tr>
</table>
</div>
</body>
</html>

