<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
PUPPET-AGENT(8)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
PUPPET-AGENT(8)</td>
<td class="head-vol">
Puppet manual</td>
<td class="head-rtitle">
PUPPET-AGENT(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1>  <b>puppet-agent</b> - The puppet agent daemon</div>
<div class="section">
<h1>SYNOPSIS</h1> Retrieves the client configuration from the puppet master and applies it to the local host.<div class="spacer">
</div>
This service may be run as a daemon, run periodically using cron (or something similar), or run interactively for testing purposes.</div>
<div class="section">
<h1>USAGE</h1> puppet agent [--certname  <i>name</i>] [-D|--daemonize|--no-daemonize] [-d|--debug] [--detailed-exitcodes] [--digest <i>digest</i>] [--disable [message]] [--enable] [--fingerprint] [-h|--help] [-l|--logdest syslog|<i>file</i>|console] [--no-client] [--noop] [-o|--onetime] [-t|--test] [-v|--verbose] [-V|--version] [-w|--waitforcert <i>seconds</i>]</div>
<div class="section">
<h1>DESCRIPTION</h1> This is the main puppet client. Its job is to retrieve the local machine&#180;s configuration from a remote server and apply it. In order to successfully communicate with the remote server, the client must have a certificate signed by a certificate authority that the server trusts; the recommended method for this, at the moment, is to run a certificate authority as part of the puppet server (which is the default). The client will connect and request a signed certificate, and will continue connecting until it receives one.<div class="spacer">
</div>
Once the client has a signed certificate, it will retrieve its configuration and apply it.</div>
<div class="section">
<h1>USAGE NOTES</h1> &#180;puppet agent&#180; does its best to find a compromise between interactive use and daemon use. Run with no arguments and no configuration, it will go into the background, attempt to get a signed certificate, and retrieve and apply its configuration every 30 minutes.<div class="spacer">
</div>
Some flags are meant specifically for interactive use -- in particular, &#180;test&#180;, &#180;tags&#180; or &#180;fingerprint&#180; are useful. &#180;test&#180; enables verbose logging, causes the daemon to stay in the foreground, exits if the server&#180;s configuration is invalid (this happens if, for instance, you&#180;ve left a syntax error on the server), and exits after running the configuration once (rather than hanging around as a long-running process).<div class="spacer">
</div>
&#180;tags&#180; allows you to specify what portions of a configuration you want to apply. Puppet elements are tagged with all of the class or definition names that contain them, and you can use the &#180;tags&#180; flag to specify one of these names, causing only configuration elements contained within that class or definition to be applied. This is very useful when you are testing new configurations -- for instance, if you are just starting to manage &#180;ntpd&#180;, you would put all of the new elements into an &#180;ntpd&#180; class, and call puppet with &#180;--tags ntpd&#180;, which would only apply that small portion of the configuration during your testing, rather than applying the whole thing.<div class="spacer">
</div>
&#180;fingerprint&#180; is a one-time flag. In this mode &#180;puppet agent&#180; will run once and display on the console (and in the log) the current certificate (or certificate request) fingerprint. Providing the &#180;--digest&#180; option allows to use a different digest algorithm to generate the fingerprint. The main use is to verify that before signing a certificate request on the master, the certificate request the master received is the same as the one the client sent (to prevent against man-in-the-middle attacks when signing certificates).</div>
<div class="section">
<h1>OPTIONS</h1> Note that any configuration parameter that&#180;s valid in the configuration file is also a valid long argument. For example, &#180;server&#180; is a valid configuration parameter, so you can specify &#180;--server  <i>servername</i>&#180; as an argument.<div class="spacer">
</div>
See the configuration file documentation at http://docs.puppetlabs.com/references/stable/configuration.html for the full list of acceptable parameters. A commented list of all configuration options can also be generated by running puppet agent with &#180;--genconfig&#180;.<dl>
<dt>
--certname</dt>
<dd>
Set the certname (unique ID) of the client. The master reads this unique identifying string, which is usually set to the node&#180;s fully-qualified domain name, to determine which configurations the node will receive. Use this option to debug setup problems or implement unusual node identification schemes.</dd>
</dl>
<dl>
<dt>
--daemonize</dt>
<dd>
Send the process into the background. This is the default.</dd>
</dl>
<dl>
<dt>
--no-daemonize</dt>
<dd>
Do not send the process into the background.</dd>
</dl>
<dl>
<dt>
--debug</dt>
<dd>
Enable full debugging.</dd>
</dl>
<dl>
<dt>
--detailed-exitcodes</dt>
<dd>
Provide transaction information via exit codes. If this is enabled, an exit code of &#180;2&#180; means there were changes, an exit code of &#180;4&#180; means there were failures during the transaction, and an exit code of &#180;6&#180; means there were both changes and failures.</dd>
</dl>
<dl>
<dt>
--digest</dt>
<dd>
Change the certificate fingerprinting digest algorithm. The default is SHA256. Valid values depends on the version of OpenSSL installed, but will likely contain MD5, MD2, SHA1 and SHA256.</dd>
</dl>
<dl>
<dt>
--disable</dt>
<dd>
Disable working on the local system. This puts a lock file in place, causing &#180;puppet agent&#180; not to work on the system until the lock file is removed. This is useful if you are testing a configuration and do not want the central configuration to override the local state until everything is tested and committed.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
Disable can also take an optional message that will be reported by the &#180;puppet agent&#180; at the next disabled run.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
&#180;puppet agent&#180; uses the same lock file while it is running, so no more than one &#180;puppet agent&#180; process is working at a time.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
&#180;puppet agent&#180; exits after executing this.</dd>
</dl>
<dl>
<dt>
--enable</dt>
<dd>
Enable working on the local system. This removes any lock file, causing &#180;puppet agent&#180; to start managing the local system again (although it will continue to use its normal scheduling, so it might not start for another half hour).</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
&#180;puppet agent&#180; exits after executing this.</dd>
</dl>
<dl>
<dt>
--fingerprint</dt>
<dd>
Display the current certificate or certificate signing request fingerprint and then exit. Use the &#180;--digest&#180; option to change the digest algorithm used.</dd>
</dl>
<dl>
<dt>
--help</dt>
<dd>
Print this help message</dd>
</dl>
<dl>
<dt>
--logdest</dt>
<dd>
Where to send messages. Choose between syslog, the console, and a log file. Defaults to sending messages to syslog, or the console if debugging or verbosity is enabled.</dd>
</dl>
<dl>
<dt>
--no-client</dt>
<dd>
Do not create a config client. This will cause the daemon to start but not check configuration unless it is triggered with <b>puppet kick</b>. This only makes sense when puppet agent is being run with listen = true in puppet.conf or was started with the <b>--listen</b> option.</dd>
</dl>
<dl>
<dt>
--noop</dt>
<dd>
Use &#180;noop&#180; mode where the daemon runs in a no-op or dry-run mode. This is useful for seeing what changes Puppet will make without actually executing the changes.</dd>
</dl>
<dl>
<dt>
--onetime</dt>
<dd>
Run the configuration once. Runs a single (normally daemonized) Puppet run. Useful for interactively running puppet agent when used in conjunction with the --no-daemonize option.</dd>
</dl>
<dl>
<dt>
--test</dt>
<dd>
Enable the most common options used for testing. These are &#180;onetime&#180;, &#180;verbose&#180;, &#180;ignorecache&#180;, &#180;no-daemonize&#180;, &#180;no-usecacheonfailure&#180;, &#180;detailed-exit-codes&#180;, &#180;no-splay&#180;, and &#180;show_diff&#180;.</dd>
</dl>
<dl>
<dt>
--verbose</dt>
<dd>
Turn on verbose reporting.</dd>
</dl>
<dl>
<dt>
--version</dt>
<dd>
Print the puppet version number and exit.</dd>
</dl>
<dl>
<dt>
--waitforcert</dt>
<dd>
This option only matters for daemons that do not yet have certificates and it is enabled by default, with a value of 120 (seconds). This causes &#180;puppet agent&#180; to connect to the server every 2 minutes and ask it to sign a certificate request. This is useful for the initial setup of a puppet client. You can turn off waiting for certificates by specifying a time of 0.</dd>
</dl>
</div>
<div class="section">
<h1>EXAMPLE</h1><div class="spacer">
</div>
<br/>
$ puppet agent --server puppet.domain.com<br/>
</div>
<div class="section">
<h1>DIAGNOSTICS</h1> Puppet agent accepts the following signals:<dl>
<dt>
SIGHUP</dt>
<dd>
Restart the puppet agent daemon.</dd>
</dl>
<dl>
<dt>
SIGINT and SIGTERM</dt>
<dd>
Shut down the puppet agent daemon.</dd>
</dl>
<dl>
<dt>
SIGUSR1</dt>
<dd>
Immediately retrieve and apply configurations from the puppet master.</dd>
</dl>
<dl>
<dt>
SIGUSR2</dt>
<dd>
Close file descriptors for log files and reopen them. Used with logrotate.</dd>
</dl>
</div>
<div class="section">
<h1>AUTHOR</h1> Luke Kanies</div>
<div class="section">
<h1>COPYRIGHT</h1> Copyright (c) 2011 Puppet Labs, LLC Licensed under the Apache 2.0 License</div>
<table class="foot">
<tr>
<td class="foot-date">
January 2013</td>
<td class="foot-os">
Puppet Labs, LLC</td>
</tr>
</table>
</div>
</body>
</html>

