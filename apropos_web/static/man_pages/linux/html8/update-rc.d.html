<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
UPDATE-RC.D(8)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
UPDATE-RC.D(8)</td>
<td class="head-vol">
sysv-rc</td>
<td class="head-rtitle">
UPDATE-RC.D(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> update-rc.d - install and remove System-V style init script links</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>update-rc.d</b> [<i>-n</i>] [<i>-f</i>] <i>name</i><b> remove</b><div class="spacer">
</div>
<div style="margin-left: 5.00ex;text-indent: -5.00ex;" class="spacer">
<b>update-rc.d</b> [<i>-n</i>] <i>name</i><b> defaults</b> [<i>NN</i> | <i>SS</i> <i>KK</i>]</div>
<div class="spacer">
</div>
<div style="margin-left: 5.00ex;text-indent: -5.00ex;" class="spacer">
<b>update-rc.d</b> [<i>-n</i>] <i>name</i> <b>start</b>|<b>stop</b> <i>NN runlevel</i> [<i>runlevel</i>]... <b>.</b> <b>start</b>|<b>stop</b> <i>NN runlevel</i> [<i>runlevel</i>]... <b>.</b> ...</div>
<div class="spacer">
</div>
<div style="margin-left: 5.00ex;text-indent: -5.00ex;" class="spacer">
<b>update-rc.d</b> [<i>-n</i>] <i>name</i><b> disable|enable </b> [<i> S|2|3|4|5 </i>]</div>
</div>
<div class="section">
<h1>DESCRIPTION</h1> <b>update-rc.d</b> updates the System V style init script links <b>/etc/rc</b><i>runlevel</i><b>.d/</b><i>NNname</i> whose target is the script <b>/etc/init.d/</b><i>name</i><b>.</b> These links are run by <b>init</b> when it changes runlevels; they are generally used to start and stop system services such as daemons. <i>runlevel</i> is one of the runlevels supported by <b>init</b>, namely, <b>0123456789S</b>, and  <i>NN</i> is the two-digit sequence number that determines where in the sequence <b>init</b> will run the scripts.<div style="height: 1.00em;">
&#160;</div>
This manpage documents only the usage and behaviour of <b>update-rc.d</b>. For a discussion of the System V style init script arrangements please see <b>init</b>(8) and the <i>Debian Policy Manual</i>.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>INSTALLING INIT SCRIPT LINKS</h1> update-rc.d has two modes of operation for installing scripts into the boot sequence.  A legacy mode where command line arguments are used to decide the sequence and runlevel configuration, and the default mode where dependency and runlevel information in the init.d script LSB comment header is used instead.  Such header is required to be present in init.d scripts. See the insserv(8) manual page for details about the LSB header format.  The boot sequencing method is decided during installation or upgrades.  During upgrades, if there are no loops in the dependencies declared by LSB headers of all installed init.d scripts and no obsolete init.d scripts, the boot system is converted to dependency based boot sequencing. The conversion to dependency based boot sequencing is one-way.  The machines using the legacy mode will have a file /etc/init.d/.legacy-bootordering .<div style="height: 1.00em;">
&#160;</div>
Packages installing init.d scripts should make sure both methods work, for compatiblity with systems where the migration have not been done yet.<div style="height: 1.00em;">
&#160;</div>
For legacy mode, the following section documents the old behaviour.<div style="height: 1.00em;">
&#160;</div>
When run with either the <b>defaults</b>, <b>start</b>, or <b>stop</b> options, <b>update-rc.d</b> makes links <b>/etc/rc</b><i>runlevel</i><b>.d/[SK]</b><i>NNname</i> that point to the script <b>/etc/init.d/</b><i>name</i>.<div style="height: 1.00em;">
&#160;</div>
If any files <b>/etc/rc</b><i>runlevel</i><b>.d/[SK]??</b><i>name</i> already exist then <b>update-rc.d</b> does nothing. The program was written this way so that it will never change an existing configuration, which may have been customized by the system administrator. The program will only install links if none are present, i.e., if it appears that the service has never been installed before.<div class="spacer">
</div>
A common system administration error is to delete the links with the thought that this will &quot;disable&quot; the service, i.e., that this will prevent the service from being started. However, if all links have been deleted then the next time the package is upgraded, the package's <i>postinst</i> script will run <b>update-rc.d</b> again and this will reinstall links at their factory default locations. The correct way to disable services is to configure the service as stopped in all runlevels in which it is started by default. In the System V init system this means renaming the service's symbolic links from <b>S</b> to <b>K</b>.<div class="spacer">
</div>
If <b>defaults</b> is used then <b>update-rc.d</b> will make links to start the service in runlevels <b>2345</b> and to stop the service in runlevels <b>016</b>. By default all the links will have sequence number 20, but this should be overridden if there are dependencies. For example if daemon B depends on A, then A must be started before B and B must be killed before A. You accomplish this by supplying two NN arguments. In general, core daemons should start early and be killed late, whilst applications can start late and be killed early. See EXAMPLES below.<div class="spacer">
</div>
The first NN argument supplies the start sequence number and the second NN argument supplies the kill sequence number. Kill scripts are called first, passing a stop argument. Then start scripts are called passing a start argument. In either case, calls happen in ascending sequence number order.<div class="spacer">
</div>
Supplying a single NN argument will use the same number for both start and kill links. This is supported for backward compatibility but is discouraged, as it may lead to inconsistent settings. As a rule of thumb, if you increase the start sequence number you should also decrease the stop sequence number, and vice-versa.<div class="spacer">
</div>
As a rule of thumb, the sequence number of the stop link should be 100 minus the sequence number of the start link; this causes services to be stopped in the opposite order to that in which they are started. Obviously, therefore, the default stop sequence number should be 80. Defaulting to 20, as <b>update-rc.d</b> does, is an old bug that cannot be fixed because of the risk of breaking things.<div class="spacer">
</div>
Instead of <b>defaults</b> one can give one or more sets of arguments specifying particular runlevels in which to start or stop the service. Each of these sets of arguments starts with the keyword <b>start</b> or <b>stop</b> and a sequence number <i>NN</i>, followed by one or more runlevel numbers. The set is terminated by a solitary full stop character. When explicit specification, rather than <b>defaults</b>, is used there will usually be one <b>start</b> and one <b>stop</b> set.  If different sequence codes are required in different runlevels then several <b>start</b> sets or several <b>stop</b> sets may be specified. If this is done and the same runlevel is named in multiple sets then only the last one counts. Therefore it is not possible to create multiple <b>start</b> or multiple <b>stop</b> links for a service in a single runlevel directory.<div class="spacer">
</div>
The script <b>/etc/init.d/</b><i>name</i> must exist before <b>update-rc.d</b> is run to create the links.</div>
<div class="section">
<h1>REMOVING SCRIPTS</h1> When invoked with the <i>remove</i> option, update-rc.d removes any links in the <b>/etc/rc</b><i>runlevel</i><b>.d</b> directories to the script <b>/etc/init.d/</b><i>name.</i> The script must have been deleted already. If the script is still present then <b>update-rc.d</b> aborts with an error message.<div class="spacer">
</div>
<b>update-rc.d</b> is usually called from a package's post-removal script when that script is given the <b>purge</b> argument. Any files in the <b>/etc/rc</b><i>runlevel</i><b>.d</b> directories that are not symbolic links to the script <b>/etc/init.d/</b><i>name</i> will be left untouched.</div>
<div class="section">
<h1>DISABLING INIT SCRIPT START LINKS</h1> When run with the <b>disable</b> [ <b>S|2|3|4|5</b> ]  options, <b>update-rc.d</b> modifies existing runlevel links for the script <b>/etc/init.d/</b><i>name</i> by renaming start links to stop links with a sequence number equal to the difference of 100 minus the original sequence number.<div class="spacer">
</div>
When run with the <b>enable</b> [ <b>S|2|3|4|5</b> ]  options, <b>update-rc.d</b> modifies existing runlevel links for the script <b>/etc/init.d/</b><i>name</i> by renaming stop links to start links with a sequence number equal to the positive difference of current sequence number minus 100, thus returning to the original sequence number that the script had been installed with before disabling it.<div class="spacer">
</div>
Both of these options only operate on start runlevel links of S, 2, 3, 4 or 5. If no start runlevel is specified after the disable or enable keywords, the script will attempt to modify links in all start runlevels.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>OPTIONS</h1><dl>
<dt>
<i>-n</i></dt>
<dd>
Don't do anything, just show what we would do.</dd>
</dl>
<dl>
<dt>
<i>-f</i></dt>
<dd>
Force removal of symlinks even if <b>/etc/init.d/</b><i>name</i> still exists.</dd>
</dl>
</div>
<div class="section">
<h1>EXAMPLES</h1> Insert links using the defaults: <b>   update-rc.d foobar defaults</b><br/>
The equivalent dependency header would have start and stop<br/>
dependencies on $remote_fs and $syslog, and start in<br/>
runlevels 2-5 and stop in runlevels 0, 1 and 6.<br/>
Equivalent command using explicit argument sets: <b>   update-rc.d foobar start 20 2 3 4 5 . stop 20 0 1 6 .</b><br/>
More typical command using explicit argument sets: <b>   update-rc.d foobar start 30 2 3 4 5 . stop 70 0 1 6 .</b><br/>
Insert links at default runlevels when B requires A <b>   update-rc.d script_for_A defaults 80 20</b> <b>   update-rc.d script_for_B defaults 90 10</b><br/>
Insert a link to a service that (presumably) will not be needed by any other daemon <b>   update-rc.d top_level_app defaults 98 02</b><br/>
Insert links for a script that requires services that start/stop at sequence number 20 <b>   update-rc.d script_depends_on_svc20 defaults 21 19</b><br/>
Remove all links for a script (assuming foobar has been deleted already): <b>   update-rc.d foobar remove</b><br/>
Example of disabling a service: <b>   update-rc.d -f foobar remove</b> <b>   update-rc.d foobar stop 20 2 3 4 5 .</b><br/>
Example of a command for installing a system initialization-and-shutdown script: <b>   update-rc.d foobar start 45 S . stop 31 0 6 .</b><br/>
Example of a command for disabling a system initialization-and-shutdown script: <b>   update-rc.d -f foobar remove</b> <b>   update-rc.d foobar stop 45 S .</b><br/>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>BUGS</h1> See http://bugs.debian.org/sysv-rc.</div>
<div class="section">
<h1>FILES</h1><dl>
<dt>
<b>/etc/init.d/</b></dt>
<dd>
The directory containing the actual init scripts.</dd>
</dl>
<dl>
<dt>
<b>/etc/rc?.d/</b></dt>
<dd>
The directories containing the links used by <b>init</b> and managed by <b>update-rc.d</b>.</dd>
</dl>
<dl>
<dt>
<b>/etc/init.d/skeleton</b></dt>
<dd>
Model for use by writers of <b>init.d</b> scripts.</dd>
</dl>
<dl>
<dt>
<b>/var/lib/sysv-rc/legacy-bootsequence</b></dt>
<dd>
Flag indicating the machine is using legacy mode for boot script ordering.</dd>
</dl>
</div>
<div class="section">
<h1>SEE ALSO</h1> <i>Debian Policy Manual</i>,<div style="height: 0.00em;">
&#160;</div>
<b>/etc/init.d/skeleton</b>,<div style="height: 0.00em;">
&#160;</div>
<b>insserv</b>(8), <b>sysv-rc-conf</b>(8), <b>bum</b>(8), <b>init</b>(8).</div>
<table class="foot">
<tr>
<td class="foot-date">
14 November 2005</td>
<td class="foot-os">
Debian Project</td>
</tr>
</table>
</div>
</body>
</html>

