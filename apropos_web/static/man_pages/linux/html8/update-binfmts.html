<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
UPDATE-BINFMTS(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">update-binfmts</b> &#8212; <span class="desc">maintain registry of executable binary formats</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 14.00ex;"/>
<col/>
<tbody>
<tr>
<td>
update-binfmts</td>
<td>
[<span class="opt"><i class="arg">options</i></span>] <b class="flag">-</b><b class="flag">-install</b> <i class="arg">name path spec</i><div style="height: 0.00em;">
&#160;</div>
</td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 14.00ex;"/>
<col/>
<tbody>
<tr>
<td>
update-binfmts</td>
<td>
[<span class="opt"><i class="arg">options</i></span>] <b class="flag">-</b><b class="flag">-remove</b> <i class="arg">name path</i><div style="height: 0.00em;">
&#160;</div>
</td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 14.00ex;"/>
<col/>
<tbody>
<tr>
<td>
update-binfmts</td>
<td>
[<span class="opt"><i class="arg">options</i></span>] <b class="flag">-</b><b class="flag">-import</b> [<span class="opt"><i class="arg">name</i></span>]<div style="height: 0.00em;">
&#160;</div>
</td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 14.00ex;"/>
<col/>
<tbody>
<tr>
<td>
update-binfmts</td>
<td>
[<span class="opt"><i class="arg">options</i></span>] <b class="flag">-</b><b class="flag">-display</b> [<span class="opt"><i class="arg">name</i></span>]<div style="height: 0.00em;">
&#160;</div>
</td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 14.00ex;"/>
<col/>
<tbody>
<tr>
<td>
update-binfmts</td>
<td>
[<span class="opt"><i class="arg">options</i></span>] <b class="flag">-</b><b class="flag">-enable</b> [<span class="opt"><i class="arg">name</i></span>]<div style="height: 0.00em;">
&#160;</div>
</td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 14.00ex;"/>
<col/>
<tbody>
<tr>
<td>
update-binfmts</td>
<td>
[<span class="opt"><i class="arg">options</i></span>] <b class="flag">-</b><b class="flag">-disable</b> [<span class="opt"><i class="arg">name</i></span>]<div style="height: 0.00em;">
&#160;</div>
</td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 14.00ex;"/>
<col/>
<tbody>
<tr>
<td>
update-binfmts</td>
<td>
[<span class="opt"><i class="arg">options</i></span>] <b class="flag">-</b><b class="flag">-find</b> [<span class="opt"><i class="arg">path</i></span>]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> Versions 2.1.43 and later of the Linux kernel have contained the binfmt_misc module. This enables a system administrator to register interpreters for various binary formats based on a magic number or their file extension, and cause the appropriate interpreter to be invoked whenever a matching file is executed. Think of it as a more flexible version of the #! executable interpreter mechanism, or as something which can behave a little like &quot;associations&quot; in certain other operating systems (though in GNU/Linux the tendency is to keep this sort of thing somewhere else, like your file manager). <b class="name">update-binfmts</b> manages a persistent database of these interpreters.<div class="spacer">
</div>
When each package providing a registered interpreter is installed, changed, or removed, <b class="name">update-binfmts</b> is called to update information about that interpreter. <b class="name">update-binfmts</b> is usually called from the <i class="file">postinst</i> or <i class="file">prerm</i> scripts in Debian packages.</div>
<div class="section">
<h1 id="x4f5054494f4e53">OPTIONS</h1> Exactly one action must be specified; this may be accompanied by any one of the common options.<div class="subsection">
<h2 id="x434f4d4d4f4e204f5054494f4e53">COMMON OPTIONS</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-package</b> <i class="arg">package-name</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specifies the name of the current package, to be used by package post-installation and pre-removal scripts. System administrators installing binary formats for local use should probably ignore this option.<div class="spacer">
</div>
When installing new formats, the <b class="flag">-</b><b class="flag">-import</b> action should be used instead.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-admindir</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specifies the administrative directory, when this is to be different from the default of <i class="file">/var/lib/binfmts</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-importdir</b> <i class="arg">directory</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specifies the directory from which packaged binary formats are imported, when this is to be different from the default of <i class="file">/usr/share/binfmts</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-test</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Don't do anything, just demonstrate what would be done.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-help</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Display some usage information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-version</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Display version information.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x414354494f4e53">ACTIONS</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-install</b> <i class="arg">name path spec</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Install a binary format identified by <i class="arg">name</i> with interpreter <i class="arg">path</i> into the database. After registration, this format will be used when the kernel tries to execute a file matching <i class="arg">spec</i> (see <i class="link-sec"><a class="link-sec" href="#x42494e41525920464f524d41542053504543494649434154494f4e53">BINARY FORMAT SPECIFICATIONS</a></i> below).<div class="spacer">
</div>
<b class="flag">-</b><b class="flag">-install</b> will attempt to enable this binary format in the kernel as well as adding it to its own database; see <b class="flag">-</b><b class="flag">-enable</b> below.<div class="spacer">
</div>
You cannot install a format with any of the names &quot;.&quot;, &quot;..&quot;, &quot;register&quot;, or &quot;status&quot;, as these are used by the filesystem or the binfmt_misc module.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-remove</b> <i class="arg">name path</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Remove the binary format identified by <i class="arg">name</i> with interpreter <i class="arg">path</i> from the database. This will also attempt to disable the binary format in the kernel; see <b class="flag">-</b><b class="flag">-disable</b> below.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-import</b> [<span class="opt"><i class="arg">name</i></span>]</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Import a packaged format file called <i class="arg">name</i>, or import all format files currently on the system if no <i class="arg">name</i> is given. If <i class="arg">name</i> is not a full path, it is assumed to be a file in the import directory (<i class="file">/usr/share/binfmts</i> by default). See <i class="link-sec"><a class="link-sec" href="#x464f524d41542046494c4553">FORMAT FILES</a></i> below for the required contents of these files.<div class="spacer">
</div>
For packages, this is preferable to using the <b class="flag">-</b><b class="flag">-install</b> option, as a format file can be installed without <b class="name">update-binfmts</b> needing to be available.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-display</b> [<span class="opt"><i class="arg">name</i></span>]</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Display any information held in the database about the binary format identifier <i class="arg">name</i>, or about all known binary formats if no <i class="arg">name</i> is given. Also show whether displayed binary formats are enabled or disabled.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-enable</b> [<span class="opt"><i class="arg">name</i></span>]</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Enable binary format <i class="arg">name</i>, or all known binary formats if no <i class="arg">name</i> is given, in the kernel, thus enabling direct execution of matching files. You must have binfmt_misc compiled into the kernel or loaded as a module for this to work.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-disable</b> [<span class="opt"><i class="arg">name</i></span>]</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Disable binary format <i class="arg">name</i>, or all known binary formats if no <i class="arg">name</i> is given, in the kernel, thus disabling direct execution of matching files. You must have binfmt_misc compiled into the kernel or loaded as a module for this to work.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-find</b> [<span class="opt"><i class="arg">path</i></span>]</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Print the list of interpreters that will be tried in sequence when attempting to execute <i class="arg">path</i>, one per line. The first one for which <a class="link-man" href="/man/linux/3/execvp">execvp(3)</a> succeeds will be used.<div class="spacer">
</div>
Note that if multiple formats match an executable, then the order is in general not defined, and may not be preserved between <b class="name">update-binfmts</b> operations, so you should generally try to ensure that this option prints at most one line for any given <i class="arg">path</i>. The exception to this is that any format with a userspace detector will be run before any format without a userspace detector.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x42494e41525920464f524d41542053504543494649434154494f4e53">BINARY FORMAT SPECIFICATIONS</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-magic</b> <i class="arg">byte-sequence</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This matches all files with the magic number <i class="arg">byte-sequence</i>. Hexadecimal escapes may be included in the <i class="arg">byte-sequence</i> by preceding them with \x, for example &#8216;\x0a&#8217; for a linefeed. Remember to protect such escapes with quotes or an additional backslash to prevent their interpretation by the shell.<div class="spacer">
</div>
Also see <b class="flag">-</b><b class="flag">-offset</b> and <b class="flag">-</b><b class="flag">-mask</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-offset</b> <i class="arg">offset</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This is the offset of the magic/mask in the file, counted in bytes. The default is 0. Only valid with <b class="flag">-</b><b class="flag">-magic</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-mask</b> <i class="arg">byte-sequence</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This mask will be logically-ANDed with the string to be checked against the magic number given with <b class="flag">-</b><b class="flag">-magic</b>. The default is all 0xff, i.e. no effect. Only valid with <b class="flag">-</b><b class="flag">-magic</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-extension</b> <i class="arg">extension</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This matches all files whose names end in &#8220;.<i class="arg">extension</i>&#8221;. Hexadecimal escapes are not recognized here. Extension matching is case-sensitive.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-detector</b> <i class="arg">path</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
If this option is used, a userspace detector program will be used to check whether the file is suitable for this interpreter. This may be used when the binary format is more complex than can be handled by the kernel's format specifications alone. The program should return an exit code of zero if the file is appropriate and non-zero otherwise.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-</b><b class="flag">-credentials</b> <b class="flag">yes</b>, <b class="flag">-</b><b class="flag">-credentials</b> <b class="flag">no</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Whether to keep the credentials of the original binary to run the interpreter; this is typically useful to run setuid binaries, but has security implications.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x464f524d41542046494c4553">FORMAT FILES</h2> A format file is a sequence of options, one per line, corresponding roughly to the options given to an <b class="flag">-</b><b class="flag">-install</b> command. Each option consists of a key, followed by whitespace, followed by a value.<div class="spacer">
</div>
The <i class="arg">package</i> option should be set to the current package. The <i class="arg">interpreter</i> option should be set to the path to the interpreter that will handle this binary format. The <i class="arg">magic</i>, <i class="arg">offset</i>, <i class="arg">mask</i>, <i class="arg">extension</i>, <i class="arg">detector</i>, and <i class="arg">credentials</i> options correspond to the command-line options of the same names.</div>
</div>
<div class="section">
<h1 id="x4558495420535441545553">EXIT STATUS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
0</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The requested action was successfully performed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
2</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Problems were encountered whilst parsing the command line or performing the action.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> This format file can be used with an interpreter capable of handling Java .class files:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
    package javawrapper 
    interpreter /usr/bin/javawrapper 
    magic \xca\xfe\xba\xbe</pre>
<div class="spacer">
</div>
This corresponds roughly to the following command:<div class="spacer">
</div>
<pre style="margin-left: 0.00ex;" class="lit display">
    update-binfmts --package javawrapper \ 
        --install javawrapper /usr/bin/javawrapper \ 
        --magic '\xca\xfe\xba\xbe'</pre>
</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1> If you're not careful, you can break your system with <b class="name">update-binfmts</b>. An easy way to do this is to register an ELF binary as a handler for ELF, which will almost certainly cause your system to hang immediately; even if it doesn't, you won't be able to run <b class="name">update-binfmts</b> to fix it. In the future <b class="name">update-binfmts</b> may have some checks to prevent this sort of thing happening accidentally, though of course you can still manipulate the binfmt_misc kernel module directly.</div>
<div class="section">
<h1 id="x415554484f52">AUTHOR</h1> <b class="name">update-binfmts</b> is copyright (C) 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011 <span class="author">Colin Watson</span> &#10216;cjwatson@debian.org&#10217;. See the GNU General Public License version 3 or later for copying conditions.<div class="spacer">
</div>
You can find the GNU GPL v3 in <i class="file">/usr/share/common-licenses/GPL-3</i> on any modern Debian system.<div class="spacer">
</div>
Richard Guenther wrote the binfmt_misc kernel module.</div>
<div class="section">
<h1 id="x5448414e4b53">THANKS</h1> Ian Jackson wrote <b class="cmd">update-alternatives</b> and <b class="cmd">dpkg-divert</b>, from which this program borrows heavily.</div>
</div>
</body>
</html>

