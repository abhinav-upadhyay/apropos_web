<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
rsyncd.conf(5)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
rsyncd.conf(5)</td>
<td class="head-vol">
</td>
<td class="head-rtitle">
rsyncd.conf(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> rsyncd.conf - configuration file for rsync in daemon mode</div>
<div class="section">
<h1>SYNOPSIS</h1> rsyncd.conf</div>
<div class="section">
<h1>DESCRIPTION</h1> The rsyncd.conf file is the runtime configuration file for rsync when run as an rsync daemon.<div class="spacer">
</div>
The rsyncd.conf file controls authentication, access, logging and available modules.</div>
<div class="section">
<h1>FILE FORMAT</h1> The file consists of modules and parameters. A module begins with the name of the module in square brackets and continues until the next module begins. Modules contain parameters of the form &quot;name = value&quot;.<div class="spacer">
</div>
The file is line-based -- that is, each newline-terminated line represents either a comment, a module name or a parameter.<div class="spacer">
</div>
Only the first equals sign in a parameter is significant. Whitespace before or after the first equals sign is discarded. Leading, trailing and internal whitespace in module and parameter names is irrelevant. Leading and trailing whitespace in a parameter value is discarded. Internal whitespace within a parameter value is retained verbatim.<div class="spacer">
</div>
Any line beginning with a hash (#) is ignored, as are lines containing only whitespace. Note that a hash in the middle of a line is used as-is, hence it is not possible to put a comment at the end of a parameter; the hash and following text becomes part of the parameter.<div class="spacer">
</div>
Any line ending in a \ is &quot;continued&quot; on the next line in the customary UNIX fashion.<div class="spacer">
</div>
The values following the equals sign in parameters are all either a string (no quotes needed) or a boolean, which may be given as yes/no, 0/1 or true/false. Case is not significant in boolean values, but is preserved in string values.</div>
<div class="section">
<h1>LAUNCHING THE RSYNC DAEMON</h1> The rsync daemon is launched by specifying the  <b>--daemon</b> option to rsync.<div class="spacer">
</div>
The daemon must run with root privileges if you wish to use chroot, to bind to a port numbered under 1024 (as is the default 873), or to set file ownership.  Otherwise, it must just have permission to read and write the appropriate data, log, and lock files.<div class="spacer">
</div>
You can launch it either via inetd, as a stand-alone daemon, or from an rsync client via a remote shell.  If run as a stand-alone daemon then just run the command &quot; <b>rsync --daemon</b>&quot; from a suitable startup script.<div class="spacer">
</div>
When run via inetd you should add a line like this to /etc/services:<div class="spacer">
</div>
<br/>
  rsync           873/tcp<br/>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
and a single line something like this to /etc/inetd.conf:<div class="spacer">
</div>
<br/>
  rsync   stream  tcp     nowait  root   /usr/bin/rsync rsyncd --daemon<br/>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
Replace &quot;/usr/bin/rsync&quot; with the path to where you have rsync installed on your system.  You will then need to send inetd a HUP signal to tell it to reread its config file.<div class="spacer">
</div>
Note that you should <b>not</b> send the rsync daemon a HUP signal to force it to reread the rsyncd.conf file. The file is re-read on each client connection.</div>
<div class="section">
<h1>GLOBAL PARAMETERS</h1> The first parameters in the file (before a [module] header) are the global parameters.<div class="spacer">
</div>
You may also include any module parameters in the global part of the config file in which case the supplied value will override the default for that parameter.<dl>
<dt>
<b>motd file</b></dt>
<dd>
This parameter allows you to specify a &quot;message of the day&quot; to display to clients on each connect. This usually contains site information and any legal notices. The default is no motd file.</dd>
</dl>
<dl>
<dt>
<b>pid file</b></dt>
<dd>
This parameter tells the rsync daemon to write its process ID to that file.  If the file already exists, the rsync daemon will abort rather than overwrite the file.</dd>
</dl>
<dl>
<dt>
<b>port</b></dt>
<dd>
You can override the default port the daemon will listen on by specifying this value (defaults to 873).  This is ignored if the daemon is being run by inetd, and is superseded by the  <b>--port</b> command-line option.</dd>
</dl>
<dl>
<dt>
<b>address</b></dt>
<dd>
You can override the default IP address the daemon will listen on by specifying this value.  This is ignored if the daemon is being run by inetd, and is superseded by the  <b>--address</b> command-line option.</dd>
</dl>
<dl>
<dt>
<b>socket options</b></dt>
<dd>
This parameter can provide endless fun for people who like to tune their systems to the utmost degree. You can set all sorts of socket options which may make transfers faster (or slower!). Read the man page for the setsockopt() system call for details on some of the options you may be able to set. By default no special socket options are set.  These settings can also be specified via the  <b>--sockopts</b> command-line option.</dd>
</dl>
</div>
<div class="section">
<h1>MODULE PARAMETERS</h1> After the global parameters you should define a number of modules, each module exports a directory tree as a symbolic name. Modules are exported by specifying a module name in square brackets [module] followed by the parameters for that module. The module name cannot contain a slash or a closing square bracket.  If the name contains whitespace, each internal sequence of whitespace will be changed into a single space, while leading or trailing whitespace will be discarded.<dl>
<dt>
<b>comment</b></dt>
<dd>
This parameter specifies a description string that is displayed next to the module name when clients obtain a list of available modules. The default is no comment.</dd>
</dl>
<dl>
<dt>
<b>path</b></dt>
<dd>
This parameter specifies the directory in the daemon&#8217;s filesystem to make available in this module.  You must specify this parameter for each module in rsyncd.conf.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
It is fine if the path includes internal spaces -- they will be retained verbatim (which means that you shouldn&#8217;t try to escape them).  If your final directory has a trailing space (and this is somehow not something you wish to fix), append a trailing slash to the path to avoid losing the trailing whitespace.</dd>
</dl>
<dl>
<dt>
<b>use chroot</b></dt>
<dd>
If &quot;use chroot&quot; is true, the rsync daemon will chroot to the &quot;path&quot; before starting the file transfer with the client.  This has the advantage of extra protection against possible implementation security holes, but it has the disadvantages of requiring super-user privileges, of not being able to follow symbolic links that are either absolute or outside of the new root path, and of complicating the preservation of users and groups by name (see below).</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
As an additional safety feature, you can specify a dot-dir in the module&#8217;s &quot;path&quot; to indicate the point where the chroot should occur.  This allows rsync to run in a chroot with a non-&quot;/&quot; path for the top of the transfer hierarchy. Doing this guards against unintended library loading (since those absolute paths will not be inside the transfer hierarchy unless you have used an unwise pathname), and lets you setup libraries for the chroot that are outside of the transfer.  For example, specifying &quot;/var/rsync/./module1&quot; will chroot to the &quot;/var/rsync&quot; directory and set the inside-chroot path to &quot;/module1&quot;.  If you had omitted the dot-dir, the chroot would have used the whole path, and the inside-chroot path would have been &quot;/&quot;.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
When &quot;use chroot&quot; is false or the inside-chroot path is not &quot;/&quot;, rsync will: (1) munge symlinks by default for security reasons (see &quot;munge symlinks&quot; for a way to turn this off, but only if you trust your users), (2) substitute leading slashes in absolute paths with the module&#8217;s path (so that options such as  <b>--backup-dir</b>, <b>--compare-dest</b>, etc. interpret an absolute path as rooted in the module&#8217;s &quot;path&quot; dir), and (3) trim &quot;..&quot; path elements from args if rsync believes they would escape the module hierarchy. The default for &quot;use chroot&quot; is true, and is the safer choice (especially if the module is not read-only).</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
When this parameter is enabled, rsync will not attempt to map users and groups by name (by default), but instead copy IDs as though  <b>--numeric-ids</b> had been specified.  In order to enable name-mapping, rsync needs to be able to use the standard library functions for looking up names and IDs (i.e. getpwuid() , getgrgid() , getpwname() , and getgrnam() ). This means the rsync process in the chroot hierarchy will need to have access to the resources used by these library functions (traditionally /etc/passwd and /etc/group, but perhaps additional dynamic libraries as well).</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
If you copy the necessary resources into the module&#8217;s chroot area, you should protect them through your OS&#8217;s normal user/group or ACL settings (to prevent the rsync module&#8217;s user from being able to change them), and then hide them from the user&#8217;s view via &quot;exclude&quot; (see how in the discussion of that parameter).  At that point it will be safe to enable the mapping of users and groups by name using the &quot;numeric ids&quot; daemon parameter (see below).</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
Note also that you are free to setup custom user/group information in the chroot area that is different from your normal system.  For example, you could abbreviate the list of users and groups.</dd>
</dl>
<dl>
<dt>
<b>numeric ids</b></dt>
<dd>
Enabling this parameter disables the mapping of users and groups by name for the current daemon module.  This prevents the daemon from trying to load any user/group-related files or libraries. This enabling makes the transfer behave as if the client had passed the  <b>--numeric-ids</b> command-line option.  By default, this parameter is enabled for chroot modules and disabled for non-chroot modules.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
A chroot-enabled module should not have this parameter enabled unless you&#8217;ve taken steps to ensure that the module has the necessary resources it needs to translate names, and that it is not possible for a user to change those resources.</dd>
</dl>
<dl>
<dt>
<b>munge symlinks</b></dt>
<dd>
This parameter tells rsync to modify all incoming symlinks in a way that makes them unusable but recoverable (see below).  This should help protect your files from user trickery when your daemon module is writable.  The default is disabled when &quot;use chroot&quot; is on and the inside-chroot path is &quot;/&quot;, otherwise it is enabled.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
If you disable this parameter on a daemon that is not read-only, there are tricks that a user can play with uploaded symlinks to access daemon-excluded items (if your module has any), and, if &quot;use chroot&quot; is off, rsync can even be tricked into showing or changing data that is outside the module&#8217;s path (as access-permissions allow).</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
The way rsync disables the use of symlinks is to prefix each one with the string &quot;/rsyncd-munged/&quot;.  This prevents the links from being used as long as that directory does not exist.  When this parameter is enabled, rsync will refuse to run if that path is a directory or a symlink to a directory.  When using the &quot;munge symlinks&quot; parameter in a chroot area that has an inside-chroot path of &quot;/&quot;, you should add &quot;/rsyncd-munged/&quot; to the exclude setting for the module so that a user can&#8217;t try to create it.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
Note:  rsync makes no attempt to verify that any pre-existing symlinks in the module&#8217;s hierarchy are as safe as you want them to be (unless, of course, it just copied in the whole hierarchy).  If you setup an rsync daemon on a new area or locally add symlinks, you can manually protect your symlinks from being abused by prefixing &quot;/rsyncd-munged/&quot; to the start of every symlink&#8217;s value.  There is a perl script in the support directory of the source code named &quot;munge-symlinks&quot; that can be used to add or remove this prefix from your symlinks.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
When this parameter is disabled on a writable module and &quot;use chroot&quot; is off (or the inside-chroot path is not &quot;/&quot;), incoming symlinks will be modified to drop a leading slash and to remove &quot;..&quot; path elements that rsync believes will allow a symlink to escape the module&#8217;s hierarchy.  There are tricky ways to work around this, though, so you had better trust your users if you choose this combination of parameters.</dd>
</dl>
<dl>
<dt>
<b>charset</b></dt>
<dd>
This specifies the name of the character set in which the module&#8217;s filenames are stored.  If the client uses an  <b>--iconv</b> option, the daemon will use the value of the &quot;charset&quot; parameter regardless of the character set the client actually passed.  This allows the daemon to support charset conversion in a chroot module without extra files in the chroot area, and also ensures that name-translation is done in a consistent manner.  If the &quot;charset&quot; parameter is not set, the  <b>--iconv</b> option is refused, just as if &quot;iconv&quot; had been specified via &quot;refuse options&quot;.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
If you wish to force users to always use <b>--iconv</b> for a particular module, add &quot;no-iconv&quot; to the &quot;refuse options&quot; parameter.  Keep in mind that this will restrict access to your module to very new rsync clients.</dd>
</dl>
<dl>
<dt>
<b>max connections</b></dt>
<dd>
This parameter allows you to specify the maximum number of simultaneous connections you will allow. Any clients connecting when the maximum has been reached will receive a message telling them to try later.  The default is 0, which means no limit. A negative value disables the module. See also the &quot;lock file&quot; parameter.</dd>
</dl>
<dl>
<dt>
<b>log file</b></dt>
<dd>
When the &quot;log file&quot; parameter is set to a non-empty string, the rsync daemon will log messages to the indicated file rather than using syslog. This is particularly useful on systems (such as AIX) where syslog() doesn&#8217;t work for chrooted programs.  The file is opened before chroot() is called, allowing it to be placed outside the transfer.  If this value is set on a per-module basis instead of globally, the global log will still contain any authorization failures or config-file error messages.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
If the daemon fails to open the specified file, it will fall back to using syslog and output an error about the failure.  (Note that the failure to open the specified log file used to be a fatal error.)</dd>
</dl>
<dl>
<dt>
<b>syslog facility</b></dt>
<dd>
This parameter allows you to specify the syslog facility name to use when logging messages from the rsync daemon. You may use any standard syslog facility name which is defined on your system. Common names are auth, authpriv, cron, daemon, ftp, kern, lpr, mail, news, security, syslog, user, uucp, local0, local1, local2, local3, local4, local5, local6 and local7. The default is daemon.  This setting has no effect if the &quot;log file&quot; setting is a non-empty string (either set in the per-modules settings, or inherited from the global settings).</dd>
</dl>
<dl>
<dt>
<b>max verbosity</b></dt>
<dd>
This parameter allows you to control the maximum amount of verbose information that you&#8217;ll allow the daemon to generate (since the information goes into the log file). The default is 1, which allows the client to request one level of verbosity.</dd>
</dl>
<dl>
<dt>
<b>lock file</b></dt>
<dd>
This parameter specifies the file to use to support the &quot;max connections&quot; parameter. The rsync daemon uses record locking on this file to ensure that the max connections limit is not exceeded for the modules sharing the lock file. The default is /var/run/rsyncd.lock.</dd>
</dl>
<dl>
<dt>
<b>read only</b></dt>
<dd>
This parameter determines whether clients will be able to upload files or not. If &quot;read only&quot; is true then any attempted uploads will fail. If &quot;read only&quot; is false then uploads will be possible if file permissions on the daemon side allow them. The default is for all modules to be read only.</dd>
</dl>
<dl>
<dt>
<b>write only</b></dt>
<dd>
This parameter determines whether clients will be able to download files or not. If &quot;write only&quot; is true then any attempted downloads will fail. If &quot;write only&quot; is false then downloads will be possible if file permissions on the daemon side allow them.  The default is for this parameter to be disabled.</dd>
</dl>
<dl>
<dt>
<b>list</b></dt>
<dd>
This parameter determines if this module should be listed when the client asks for a listing of available modules. By setting this to false you can create hidden modules. The default is for modules to be listable.</dd>
</dl>
<dl>
<dt>
<b>uid</b></dt>
<dd>
This parameter specifies the user name or user ID that file transfers to and from that module should take place as when the daemon was run as root. In combination with the &quot;gid&quot; parameter this determines what file permissions are available. The default is uid -2, which is normally the user &quot;nobody&quot;.</dd>
</dl>
<dl>
<dt>
<b>gid</b></dt>
<dd>
This parameter specifies the group name or group ID that file transfers to and from that module should take place as when the daemon was run as root. This complements the &quot;uid&quot; parameter. The default is gid -2, which is normally the group &quot;nobody&quot;.</dd>
</dl>
<dl>
<dt>
<b>fake super</b></dt>
<dd>
Setting &quot;fake super = yes&quot; for a module causes the daemon side to behave as if the  <b>--fake-super</b> command-line option had been specified.  This allows the full attributes of a file to be stored without having to have the daemon actually running as root.</dd>
</dl>
<dl>
<dt>
<b>filter</b></dt>
<dd>
The daemon has its own filter chain that determines what files it will let the client access.  This chain is not sent to the client and is independent of any filters the client may have specified.  Files excluded by the daemon filter chain ( <b>daemon-excluded</b> files) are treated as non-existent if the client tries to pull them, are skipped with an error message if the client tries to push them (triggering exit code 23), and are never deleted from the module.  You can use daemon filters to prevent clients from downloading or tampering with private administrative files, such as files you may add to support uid/gid name translations.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
The daemon filter chain is built from the &quot;filter&quot;, &quot;include from&quot;, &quot;include&quot;, &quot;exclude from&quot;, and &quot;exclude&quot; parameters, in that order of priority.  Anchored patterns are anchored at the root of the module.  To prevent access to an entire subtree, for example, &quot;/secret&quot;, you  <i>must</i> exclude everything in the subtree; the easiest way to do this is with a triple-star pattern like &quot;/secret/***&quot;.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
The &quot;filter&quot; parameter takes a space-separated list of daemon filter rules, though it is smart enough to know not to split a token at an internal space in a rule (e.g. &quot;- /foo  - /bar&quot; is parsed as two rules).  You may specify one or more merge-file rules using the normal syntax.  Only one &quot;filter&quot; parameter can apply to a given module in the config file, so put all the rules you want in a single parameter.  Note that per-directory merge-file rules do not provide as much protection as global rules, but they can be used to make  <b>--delete</b> work better during a client download operation if the per-dir merge files are included in the transfer and the client requests that they be used.</dd>
</dl>
<dl>
<dt>
<b>exclude</b></dt>
<dd>
This parameter takes a space-separated list of daemon exclude patterns.  As with the client  <b>--exclude</b> option, patterns can be qualified with &quot;- &quot; or &quot;+ &quot; to explicitly indicate exclude/include.  Only one &quot;exclude&quot; parameter can apply to a given module.  See the &quot;filter&quot; parameter for a description of how excluded files affect the daemon.</dd>
</dl>
<dl>
<dt>
<b>include</b></dt>
<dd>
Use an &quot;include&quot; to override the effects of the &quot;exclude&quot; parameter.  Only one &quot;include&quot; parameter can apply to a given module.  See the &quot;filter&quot; parameter for a description of how excluded files affect the daemon.</dd>
</dl>
<dl>
<dt>
<b>exclude from</b></dt>
<dd>
This parameter specifies the name of a file on the daemon that contains daemon exclude patterns, one per line.  Only one &quot;exclude from&quot; parameter can apply to a given module; if you have multiple exclude-from files, you can specify them as a merge file in the &quot;filter&quot; parameter.  See the &quot;filter&quot; parameter for a description of how excluded files affect the daemon.</dd>
</dl>
<dl>
<dt>
<b>include from</b></dt>
<dd>
Analogue of &quot;exclude from&quot; for a file of daemon include patterns.  Only one &quot;include from&quot; parameter can apply to a given module.  See the &quot;filter&quot; parameter for a description of how excluded files affect the daemon.</dd>
</dl>
<dl>
<dt>
<b>incoming chmod</b></dt>
<dd>
This parameter allows you to specify a set of comma-separated chmod strings that will affect the permissions of all incoming files (files that are being received by the daemon).  These changes happen after all other permission calculations, and this will even override destination-default and/or existing permissions when the client does not specify  <b>--perms</b>. See the description of the  <b>--chmod</b> rsync option and the <b>chmod</b>(1) manpage for information on the format of this string.</dd>
</dl>
<dl>
<dt>
<b>outgoing chmod</b></dt>
<dd>
This parameter allows you to specify a set of comma-separated chmod strings that will affect the permissions of all outgoing files (files that are being sent out from the daemon).  These changes happen first, making the sent permissions appear to be different than those stored in the filesystem itself.  For instance, you could disable group write permissions on the server while having it appear to be on to the clients. See the description of the  <b>--chmod</b> rsync option and the <b>chmod</b>(1) manpage for information on the format of this string.</dd>
</dl>
<dl>
<dt>
<b>auth users</b></dt>
<dd>
This parameter specifies a comma and space-separated list of usernames that will be allowed to connect to this module. The usernames do not need to exist on the local system. The usernames may also contain shell wildcard characters. If &quot;auth users&quot; is set then the client will be challenged to supply a username and password to connect to the module. A challenge response authentication protocol is used for this exchange. The plain text usernames and passwords are stored in the file specified by the &quot;secrets file&quot; parameter. The default is for all users to be able to connect without a password (this is called &quot;anonymous rsync&quot;).</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
See also the section entitled &quot;USING RSYNC-DAEMON FEATURES VIA A REMOTE SHELL CONNECTION&quot; in  <b>rsync</b>(1) for information on how handle an rsyncd.conf-level username that differs from the remote-shell-level username when using a remote shell to connect to an rsync daemon.</dd>
</dl>
<dl>
<dt>
<b>secrets file</b></dt>
<dd>
This parameter specifies the name of a file that contains the username:password pairs used for authenticating this module. This file is only consulted if the &quot;auth users&quot; parameter is specified. The file is line based and contains username:password pairs separated by a single colon. Any line starting with a hash (#) is considered a comment and is skipped. The passwords can contain any characters but be warned that many operating systems limit the length of passwords that can be typed at the client end, so you may find that passwords longer than 8 characters don&#8217;t work.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
There is no default for the &quot;secrets file&quot; parameter, you must choose a name (such as /etc/rsyncd.secrets).  The file must normally not be readable by &quot;other&quot;; see &quot;strict modes&quot;.</dd>
</dl>
<dl>
<dt>
<b>strict modes</b></dt>
<dd>
This parameter determines whether or not the permissions on the secrets file will be checked.  If &quot;strict modes&quot; is true, then the secrets file must not be readable by any user ID other than the one that the rsync daemon is running under.  If &quot;strict modes&quot; is false, the check is not performed.  The default is true.  This parameter was added to accommodate rsync running on the Windows operating system.</dd>
</dl>
<dl>
<dt>
<b>hosts allow</b></dt>
<dd>
This parameter allows you to specify a list of patterns that are matched against a connecting clients hostname and IP address. If none of the patterns match then the connection is rejected.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
Each pattern can be in one of five forms:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
o</dt>
<dd>
a dotted decimal IPv4 address of the form a.b.c.d, or an IPv6 address of the form a:b:c::d:e:f. In this case the incoming machine&#8217;s IP address must match exactly.</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
an address/mask in the form ipaddr/n where ipaddr is the IP address and n is the number of one bits in the netmask.  All IP addresses which match the masked IP address will be allowed in.</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
an address/mask in the form ipaddr/maskaddr where ipaddr is the IP address and maskaddr is the netmask in dotted decimal notation for IPv4, or similar for IPv6, e.g. ffff:ffff:ffff:ffff:: instead of /64. All IP addresses which match the masked IP address will be allowed in.</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
a hostname. The hostname as determined by a reverse lookup will be matched (case insensitive) against the pattern. Only an exact match is allowed in.</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
a hostname pattern using wildcards. These are matched using the same rules as normal unix filename matching. If the pattern matches then the client is allowed in.</dd>
</dl>
</div>
<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
</dt>
<dd>
Note IPv6 link-local addresses can have a scope in the address specification:</dd>
</dl>
<div style="margin-left: 5.00ex;">
    fe80::1%link1<div style="height: 0.00em;">
&#160;</div>
    fe80::%link1/64<div style="height: 0.00em;">
&#160;</div>
    fe80::%link1/ffff:ffff:ffff:ffff::<div style="height: 0.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
</dt>
<dd>
You can also combine &quot;hosts allow&quot; with a separate &quot;hosts deny&quot; parameter. If both parameters are specified then the &quot;hosts allow&quot; parameter is checked first and a match results in the client being able to connect. The &quot;hosts deny&quot; parameter is then checked and a match means that the host is rejected. If the host does not match either the &quot;hosts allow&quot; or the &quot;hosts deny&quot; patterns then it is allowed to connect.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
The default is no &quot;hosts allow&quot; parameter, which means all hosts can connect.</dd>
</dl>
<dl>
<dt>
<b>hosts deny</b></dt>
<dd>
This parameter allows you to specify a list of patterns that are matched against a connecting clients hostname and IP address. If the pattern matches then the connection is rejected. See the &quot;hosts allow&quot; parameter for more information.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
The default is no &quot;hosts deny&quot; parameter, which means all hosts can connect.</dd>
</dl>
<dl>
<dt>
<b>ignore errors</b></dt>
<dd>
This parameter tells rsyncd to ignore I/O errors on the daemon when deciding whether to run the delete phase of the transfer. Normally rsync skips the  <b>--delete</b> step if any I/O errors have occurred in order to prevent disastrous deletion due to a temporary resource shortage or other I/O error. In some cases this test is counter productive so you can use this parameter to turn off this behavior.</dd>
</dl>
<dl>
<dt>
<b>ignore nonreadable</b></dt>
<dd>
This tells the rsync daemon to completely ignore files that are not readable by the user. This is useful for public archives that may have some non-readable files among the directories, and the sysadmin doesn&#8217;t want those files to be seen at all.</dd>
</dl>
<dl>
<dt>
<b>transfer logging</b></dt>
<dd>
This parameter enables per-file logging of downloads and uploads in a format somewhat similar to that used by ftp daemons.  The daemon always logs the transfer at the end, so if a transfer is aborted, no mention will be made in the log file.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
If you want to customize the log lines, see the &quot;log format&quot; parameter.</dd>
</dl>
<dl>
<dt>
<b>log format</b></dt>
<dd>
This parameter allows you to specify the format used for logging file transfers when transfer logging is enabled. The format is a text string containing embedded single-character escape sequences prefixed with a percent (%) character.  An optional numeric field width may also be specified between the percent and the escape letter (e.g. &quot; <b>%-50n %8l %07p</b>&quot;).</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
The default log format is &quot;%o %h [%a] %m (%u) %f %l&quot;, and a &quot;%t [%p] &quot; is always prefixed when using the &quot;log file&quot; parameter. (A perl script that will summarize this default log format is included in the rsync source code distribution in the &quot;support&quot; subdirectory: rsyncstats.)</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
The single-character escapes that are understood are as follows:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
o</dt>
<dd>
%a the remote IP address</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%b the number of bytes actually transferred</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%B the permission bits of the file (e.g. rwxrwxrwt)</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%c the total size of the block checksums received for the basis file (only when sending)</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%f the filename (long form on sender; no trailing &quot;/&quot;)</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%G the gid of the file (decimal) or &quot;DEFAULT&quot;</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%h the remote host name</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%i an itemized list of what is being updated</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%l the length of the file in bytes</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%L the string &quot; -&gt; SYMLINK&quot;, &quot; =&gt; HARDLINK&quot;, or &quot;&quot; (where <b>SYMLINK</b> or <b>HARDLINK</b> is a filename)</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%m the module name</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%M the last-modified time of the file</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%n the filename (short form; trailing &quot;/&quot; on dir)</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%o the operation, which is &quot;send&quot;, &quot;recv&quot;, or &quot;del.&quot; (the latter includes the trailing period)</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%p the process ID of this rsync session</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%P the module path</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%t the current date time</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%u the authenticated username or an empty string</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
%U the uid of the file (decimal)</dd>
</dl>
</div>
<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
</dt>
<dd>
For a list of what the characters mean that are output by &quot;%i&quot;, see the  <b>--itemize-changes</b> option in the rsync manpage.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
Note that some of the logged output changes when talking with older rsync versions.  For instance, deleted files were only output as verbose messages prior to rsync 2.6.4.</dd>
</dl>
<dl>
<dt>
<b>timeout</b></dt>
<dd>
This parameter allows you to override the clients choice for I/O timeout for this module. Using this parameter you can ensure that rsync won&#8217;t wait on a dead client forever. The timeout is specified in seconds. A value of zero means no timeout and is the default. A good choice for anonymous rsync daemons may be 600 (giving a 10 minute timeout).</dd>
</dl>
<dl>
<dt>
<b>refuse options</b></dt>
<dd>
This parameter allows you to specify a space-separated list of rsync command line options that will be refused by your rsync daemon. You may specify the full option name, its one-letter abbreviation, or a wild-card string that matches multiple options. For example, this would refuse  <b>--checksum</b> (<b>-c</b>) and all the various delete options:</dd>
</dl>
<div style="margin-left: 5.00ex;">
    refuse options = c delete</div>
<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
</dt>
<dd>
The reason the above refuses all delete options is that the options imply  <b>--delete</b>, and implied options are refused just like explicit options. As an additional safety feature, the refusal of &quot;delete&quot; also refuses  <b>remove-source-files</b> when the daemon is the sender; if you want the latter without the former, instead refuse &quot;delete-*&quot; -- that refuses all the delete modes without affecting  <b>--remove-source-files</b>.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
When an option is refused, the daemon prints an error message and exits. To prevent all compression when serving files, you can use &quot;dont compress = *&quot; (see below) instead of &quot;refuse options = compress&quot; to avoid returning an error to a client that requests compression.</dd>
</dl>
<dl>
<dt>
<b>dont compress</b></dt>
<dd>
This parameter allows you to select filenames based on wildcard patterns that should not be compressed when pulling files from the daemon (no analogous parameter exists to govern the pushing of files to a daemon). Compression is expensive in terms of CPU usage, so it is usually good to not try to compress files that won&#8217;t compress well, such as already compressed files.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
The &quot;dont compress&quot; parameter takes a space-separated list of case-insensitive wildcard patterns. Any source filename matching one of the patterns will not be compressed during transfer.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
See the <b>--skip-compress</b> parameter in the <b>rsync</b>(1) manpage for the list of file suffixes that are not compressed by default.  Specifying a value for the &quot;dont compress&quot; parameter changes the default when the daemon is the sender.</dd>
</dl>
<dl>
<dt>
<b>pre-xfer exec</b>, <b>post-xfer exec</b></dt>
<dd>
You may specify a command to be run before and/or after the transfer.  If the  <b>pre-xfer exec</b> command fails, the transfer is aborted before it begins.</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
The following environment variables will be set, though some are specific to the pre-xfer or the post-xfer environment:</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
o</dt>
<dd>
<b>RSYNC_MODULE_NAME</b>: The name of the module being accessed.</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
<b>RSYNC_MODULE_PATH</b>: The path configured for the module.</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
<b>RSYNC_HOST_ADDR</b>: The accessing host&#8217;s IP address.</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
<b>RSYNC_HOST_NAME</b>: The accessing host&#8217;s name.</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
<b>RSYNC_USER_NAME</b>: The accessing user&#8217;s name (empty if no user).</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
<b>RSYNC_PID</b>: A unique number for this transfer.</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
<b>RSYNC_REQUEST</b>: (pre-xfer only) The module/path info specified by the user (note that the user can specify multiple source files, so the request can be something like &quot;mod/path1 mod/path2&quot;, etc.).</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
<b>RSYNC_ARG#</b>: (pre-xfer only) The pre-request arguments are set in these numbered values. RSYNC_ARG0 is always &quot;rsyncd&quot;, and the last value contains a single period.</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
<b>RSYNC_EXIT_STATUS</b>: (post-xfer only) the server side&#8217;s exit value. This will be 0 for a successful run, a positive value for an error that the server generated, or a -1 if rsync failed to exit properly.  Note that an error that occurs on the client side does not currently get sent to the server side, so this is not the final exit status for the whole transfer.</dd>
</dl>
<dl>
<dt>
o</dt>
<dd>
<b>RSYNC_RAW_STATUS</b>: (post-xfer only) the raw exit value from waitpid() .</dd>
</dl>
</div>
<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
</dt>
<dd>
Even though the commands can be associated with a particular module, they are run using the permissions of the user that started the daemon (not the module&#8217;s uid/gid setting) without any chroot restrictions.</dd>
</dl>
</div>
<div class="section">
<h1>AUTHENTICATION STRENGTH</h1> The authentication protocol used in rsync is a 128 bit MD4 based challenge response system. This is fairly weak protection, though (with at least one brute-force hash-finding algorithm publicly available), so if you want really top-quality security, then I recommend that you run rsync over ssh.  (Yes, a future version of rsync will switch over to a stronger hashing method.)<div class="spacer">
</div>
Also note that the rsync daemon protocol does not currently provide any encryption of the data that is transferred over the connection. Only authentication is provided. Use ssh as the transport if you want encryption.<div class="spacer">
</div>
Future versions of rsync may support SSL for better authentication and encryption, but that is still being investigated.</div>
<div class="section">
<h1>EXAMPLES</h1> A simple rsyncd.conf file that allow anonymous rsync to a ftp area at /home/ftp would be:<div class="spacer">
</div>
<div class="spacer">
</div>
<br/>
[ftp]<br/>
        path = /home/ftp<br/>
        comment = ftp export area<div class="spacer">
</div>
<br/>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
A more sophisticated example would be:<div class="spacer">
</div>
<div class="spacer">
</div>
<br/>
uid = nobody<br/>
gid = nobody<br/>
use chroot = yes<br/>
max connections = 4<br/>
syslog facility = local5<br/>
pid file = /var/run/rsyncd.pid<div class="spacer">
</div>
<br/>
[ftp]<br/>
        path = /var/ftp/./pub<br/>
        comment = whole ftp area (approx 6.1 GB)<div class="spacer">
</div>
<br/>
[sambaftp]<br/>
        path = /var/ftp/./pub/samba<br/>
        comment = Samba ftp area (approx 300 MB)<div class="spacer">
</div>
<br/>
[rsyncftp]<br/>
        path = /var/ftp/./pub/rsync<br/>
        comment = rsync ftp area (approx 6 MB)<div class="spacer">
</div>
<br/>
[sambawww]<br/>
        path = /public_html/samba<br/>
        comment = Samba WWW pages (approx 240 MB)<div class="spacer">
</div>
<br/>
[cvs]<br/>
        path = /data/cvs<br/>
        comment = CVS repository (requires authentication)<br/>
        auth users = tridge, susan<br/>
        secrets file = /etc/rsyncd.secrets<div class="spacer">
</div>
<br/>
<div style="height: 1.00em;">
&#160;</div>
<div class="spacer">
</div>
The /etc/rsyncd.secrets file would look something like this:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
tridge:mypass<div style="height: 0.00em;">
&#160;</div>
susan:herpass<div style="height: 0.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>FILES</h1> /etc/rsyncd.conf or rsyncd.conf</div>
<div class="section">
<h1>SEE ALSO</h1>  <b>rsync</b>(1)</div>
<div class="section">
<h1>DIAGNOSTICS</h1></div>
<div class="section">
<h1>BUGS</h1> Please report bugs! The rsync bug tracking system is online at http://rsync.samba.org/</div>
<div class="section">
<h1>VERSION</h1> This man page is current for version 3.0.9 of rsync.</div>
<div class="section">
<h1>CREDITS</h1> rsync is distributed under the GNU public license.  See the file COPYING for details.<div class="spacer">
</div>
The primary ftp site for rsync is ftp://rsync.samba.org/pub/rsync.<div class="spacer">
</div>
A WEB site is available at http://rsync.samba.org/<div class="spacer">
</div>
We would be delighted to hear from you if you like this program.<div class="spacer">
</div>
This program uses the zlib compression library written by Jean-loup Gailly and Mark Adler.</div>
<div class="section">
<h1>THANKS</h1> Thanks to Warren Stanley for his original idea and patch for the rsync daemon. Thanks to Karsten Thygesen for his many suggestions and documentation!</div>
<div class="section">
<h1>AUTHOR</h1> rsync was written by Andrew Tridgell and Paul Mackerras. Many people have later contributed to it.<div class="spacer">
</div>
Mailing lists for support and development are available at http://lists.samba.org</div>
<table class="foot">
<tr>
<td class="foot-date">
23 Sep 2011</td>
<td class="foot-os">
</td>
</tr>
</table>
</div>
</body>
</html>

