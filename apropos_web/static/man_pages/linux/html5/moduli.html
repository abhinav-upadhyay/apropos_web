<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
MODULI(5)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">moduli</b> &#8212; <span class="desc">Diffie-Hellman moduli</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <i class="file">/etc/ssh/moduli</i> file contains prime numbers and generators for use by <a class="link-man" href="/man/linux/8/sshd">sshd(8)</a> in the Diffie-Hellman Group Exchange key exchange method.<div class="spacer">
</div>
New moduli may be generated with <a class="link-man" href="/man/linux/1/ssh-keygen">ssh-keygen(1)</a> using a two-step process. An initial <span class="emph">candidate generation</span> pass, using <b class="cmd">ssh-keygen -G</b>, calculates numbers that are likely to be useful. A second <span class="emph">primality testing</span> pass, using <b class="cmd">ssh-keygen -T</b>, provides a high degree of assurance that the numbers are prime and are safe for use in Diffie-Hellman operations by <a class="link-man" href="/man/linux/8/sshd">sshd(8)</a>. This <b class="name">moduli</b> format is used as the output from each pass.<div class="spacer">
</div>
The file consists of newline-separated records, one per modulus, containing seven space-separated fields. These fields are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
timestamp</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The time that the modulus was last processed as YYYYMMDDHHMMSS.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
type</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Decimal number specifying the internal structure of the prime modulus. Supported types are:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
0</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Unknown, not tested.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
2</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
&quot;Safe&quot; prime; (p-1)/2 is also prime.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
4</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Sophie Germain; (p+1)*2 is also prime.</dd>
</dl>
<div class="spacer">
</div>
Moduli candidates initially produced by <a class="link-man" href="/man/linux/1/ssh-keygen">ssh-keygen(1)</a> are Sophie Germain primes (type 4). Further primality testing with <a class="link-man" href="/man/linux/1/ssh-keygen">ssh-keygen(1)</a> produces safe prime moduli (type 2) that are ready for use in <a class="link-man" href="/man/linux/8/sshd">sshd(8)</a>. Other types are not used by OpenSSH.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
tests</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Decimal number indicating the type of primality tests that the number has been subjected to represented as a bitmask of the following values:<div class="spacer">
</div>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
0x00</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Not tested.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
0x01</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Composite number &#8211; not prime.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
0x02</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Sieve of Eratosthenes.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
0x04</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Probabilistic Miller-Rabin primality tests.</dd>
</dl>
<div class="spacer">
</div>
The <a class="link-man" href="/man/linux/1/ssh-keygen">ssh-keygen(1)</a> moduli candidate generation uses the Sieve of Eratosthenes (flag 0x02). Subsequent <a class="link-man" href="/man/linux/1/ssh-keygen">ssh-keygen(1)</a> primality tests are Miller-Rabin tests (flag 0x04).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
trials</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Decimal number indicating the number of primality trials that have been performed on the modulus.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
size</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Decimal number indicating the size of the prime in bits.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
generator</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The recommended generator for use with this modulus (hexadecimal).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
modulus</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The modulus itself in hexadecimal.</dd>
</dl>
<div class="spacer">
</div>
When performing Diffie-Hellman Group Exchange, <a class="link-man" href="/man/linux/8/sshd">sshd(8)</a> first estimates the size of the modulus required to produce enough Diffie-Hellman output to sufficiently key the selected symmetric cipher. <a class="link-man" href="/man/linux/8/sshd">sshd(8)</a> then randomly selects a modulus from <i class="farg">/etc/ssh/moduli</i> that best meets the size requirement.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="/man/linux/1/ssh-keygen">ssh-keygen(1)</a>, <a class="link-man" href="/man/linux/8/sshd">sshd(8)</a><div class="spacer">
</div>
<span class="ref"><span class="ref-title">Diffie-Hellman Group Exchange for the Secure Shell (SSH) Transport Layer Protocol</span>, <span class="ref-rep">RFC 4419</span>, <span class="ref-date">2006</span>.</span></div>
</div>
</body>
</html>

