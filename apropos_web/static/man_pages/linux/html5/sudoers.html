<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
SUDOERS(5)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
SUDOERS(5)</td>
<td class="head-vol">
MAINTENANCE COMMANDS</td>
<td class="head-rtitle">
SUDOERS(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> sudoers - default sudo security policy module</div>
<div class="section">
<h1>DESCRIPTION</h1> The  <i>sudoers</i> policy module determines a user's <b>sudo</b> privileges. It is the default  <b>sudo</b> policy plugin.  The policy is driven by the  <i>/etc/sudoers</i> file or, optionally in LDAP.  The policy format is described in detail in the &quot;SUDOERS FILE FORMAT&quot; section.  For information on storing  <i>sudoers</i> policy information in LDAP, please see  <i>sudoers.ldap</i>(5).<div class="subsection">
<h2>Authentication and Logging</h2> The  <i>sudoers</i> security policy requires that most users authenticate themselves before they can use  <b>sudo</b>.  A password is not required if the invoking user is root, if the target user is the same as the invoking user, or if the policy has disabled authentication for the user or command.  Unlike  <i>su</i>(1), when <i>sudoers</i> requires authentication, it validates the invoking user's credentials, not the target user's (or root's) credentials.  This can be changed via the  <i>rootpw</i>, <i>targetpw</i> and <i>runaspw</i> flags, described later.<div class="spacer">
</div>
If a user who is not listed in the policy tries to run a command via  <b>sudo</b>, mail is sent to the proper authorities.  The address used for such mail is configurable via the  <i>mailto</i> Defaults entry (described later) and defaults to root.<div class="spacer">
</div>
Note that mail will not be sent if an unauthorized user tries to run  <b>sudo</b> with the <b>-l</b> or <b>-v</b> option.  This allows users to determine for themselves whether or not they are allowed to use  <b>sudo</b>.<div class="spacer">
</div>
If <b>sudo</b> is run by root and the SUDO_USER environment variable is set, the  <i>sudoers</i> policy will use this value to determine who the actual user is.  This can be used by a user to log commands through sudo even when a root shell has been invoked.  It also allows the  <b>-e</b> option to remain useful even when invoked via a sudo-run script or program.  Note, however, that the  <i>sudoers</i> lookup is still done for root, not the user specified by SUDO_USER.<div class="spacer">
</div>
<i>sudoers</i> uses time stamp files for credential caching.  Once a user has been authenticated, a time stamp is updated and the user may then use sudo without a password for a short period of time (15 minutes unless overridden by the  <i>timeout</i> option. By default,  <i>sudoers</i> uses a tty-based time stamp which means that there is a separate time stamp for each of a user's login sessions. The  <i>tty_tickets</i> option can be disabled to force the use of a single time stamp for all of a user's sessions.<div class="spacer">
</div>
<i>sudoers</i> can log both successful and unsuccessful attempts (as well as errors) to  <i>syslog</i>(3), a log file, or both.  By default, <i>sudoers</i> will log via  <i>syslog</i>(3) but this is changeable via the <i>syslog</i> and  <i>logfile</i> Defaults settings.<div class="spacer">
</div>
<i>sudoers</i> also supports logging a command's input and output streams.  I/O logging is not on by default but can be enabled using the  <i>log_input</i> and <i>log_output</i> Defaults flags as well as the LOG_INPUT and LOG_OUTPUT command tags.</div>
<div class="subsection">
<h2>Command Environment</h2> Since environment variables can influence program behavior,  <i>sudoers</i> provides a means to restrict which variables from the user's environment are inherited by the command to be run.  There are two distinct ways  <i>sudoers</i> can deal with environment variables.<div class="spacer">
</div>
By default, the <i>env_reset</i> option is enabled.  This causes commands to be executed with a minimal environment containing TERM, PATH, HOME, MAIL, SHELL, LOGNAME, USER and USERNAME in addition to variables from the invoking process permitted by the  <i>env_check</i> and <i>env_keep</i> options.  This is effectively a whitelist for environment variables.<div class="spacer">
</div>
If, however, the <i>env_reset</i> option is disabled, any variables not explicitly denied by the  <i>env_check</i> and <i>env_delete</i> options are inherited from the invoking process.  In this case,  <i>env_check</i> and  <i>env_delete</i> behave like a blacklist.  Since it is not possible to blacklist all potentially dangerous environment variables, use of the default  <i>env_reset</i> behavior is encouraged.<div class="spacer">
</div>
In all cases, environment variables with a value beginning with () are removed as they could be interpreted as  <b>bash</b> functions. The list of environment variables that  <b>sudo</b> allows or denies is contained in the output of sudo -V when run as root.<div class="spacer">
</div>
Note that the dynamic linker on most operating systems will remove variables that can control dynamic linking from the environment of setuid executables, including  <b>sudo</b>.  Depending on the operating system this may include _RLD*, DYLD_*, LD_*, LDR_*, LIBPATH, SHLIB_PATH, and others.  These type of variables are removed from the environment before  <b>sudo</b> even begins execution and, as such, it is not possible for  <b>sudo</b> to preserve them.<div class="spacer">
</div>
As a special case, if <b>sudo</b>'s <b>-i</b> option (initial login) is specified,  <i>sudoers</i> will initialize the environment regardless of the value of  <i>env_reset</i>.  The <i>DISPLAY</i>, <i>PATH</i> and <i>TERM</i> variables remain unchanged;  <i>HOME</i>, <i>MAIL</i>, <i>SHELL</i>, <i>USER</i>, and  <i>LOGNAME</i> are set based on the target user.  On Linux and AIX systems the contents of  <i>/etc/environment</i> are also included.  All other environment variables are removed.</div>
</div>
<div class="section">
<h1>SUDOERS FILE FORMAT</h1> The  <i>sudoers</i> file is composed of two types of entries: aliases (basically variables) and user specifications (which specify who may run what).<div class="spacer">
</div>
When multiple entries match for a user, they are applied in order. Where there are multiple matches, the last match is used (which is not necessarily the most specific match).<div class="spacer">
</div>
The <i>sudoers</i> grammar will be described below in Extended Backus-Naur Form (EBNF).  Don't despair if you don't know what EBNF is; it is fairly simple, and the definitions below are annotated.<div class="subsection">
<h2>Quick guide to EBNF</h2> EBNF is a concise and exact way of describing the grammar of a language. Each EBNF definition is made up of  <i>production rules</i>.  E.g.,<div class="spacer">
</div>
<br/>
 symbol ::= definition | alternate1 | alternate2 ...<br/>
<div class="spacer">
</div>
Each <i>production rule</i> references others and thus makes up a grammar for the language.  EBNF also contains the following operators, which many readers will recognize from regular expressions.  Do not, however, confuse them with &quot;wildcard&quot; characters, which have different meanings.<dl>
<dt>
?</dt>
<dd>
Means that the preceding symbol (or group of symbols) is optional. That is, it may appear once or not at all.</dd>
</dl>
<dl>
<dt>
*</dt>
<dd>
Means that the preceding symbol (or group of symbols) may appear zero or more times.</dd>
</dl>
<dl>
<dt>
+</dt>
<dd>
Means that the preceding symbol (or group of symbols) may appear one or more times.</dd>
</dl>
<div class="spacer">
</div>
Parentheses may be used to group symbols together.  For clarity, we will use single quotes ('') to designate what is a verbatim character string (as opposed to a symbol name).</div>
<div class="subsection">
<h2>Aliases</h2> There are four kinds of aliases: User_Alias, Runas_Alias, Host_Alias and Cmnd_Alias.<div class="spacer">
</div>
<br/>
 Alias ::= 'User_Alias'  User_Alias (':' User_Alias)* |<br/>
           'Runas_Alias' Runas_Alias (':' Runas_Alias)* |<br/>
           'Host_Alias'  Host_Alias (':' Host_Alias)* |<br/>
           'Cmnd_Alias'  Cmnd_Alias (':' Cmnd_Alias)*<br/>
<br/>
 User_Alias ::= NAME '=' User_List<br/>
<br/>
 Runas_Alias ::= NAME '=' Runas_List<br/>
<br/>
 Host_Alias ::= NAME '=' Host_List<br/>
<br/>
 Cmnd_Alias ::= NAME '=' Cmnd_List<br/>
<br/>
 NAME ::= [A-Z]([A-Z][0-9]_)*<br/>
<div class="spacer">
</div>
Each <i>alias</i> definition is of the form<div class="spacer">
</div>
<br/>
 Alias_Type NAME = item1, item2, ...<br/>
<div class="spacer">
</div>
where <i>Alias_Type</i> is one of User_Alias, Runas_Alias, Host_Alias, or Cmnd_Alias.  A NAME is a string of uppercase letters, numbers, and underscore characters ('_').  A NAME  <b>must</b> start with an uppercase letter.  It is possible to put several alias definitions of the same type on a single line, joined by a colon (':').  E.g.,<div class="spacer">
</div>
<br/>
 Alias_Type NAME = item1, item2, item3 : NAME = item4, item5<br/>
<div class="spacer">
</div>
The definitions of what constitutes a valid <i>alias</i> member follow.<div class="spacer">
</div>
<br/>
 User_List ::= User |<br/>
               User ',' User_List<br/>
<br/>
 User ::= '!'* user name |<br/>
          '!'* #uid |<br/>
          '!'* %group |<br/>
          '!'* %#gid |<br/>
          '!'* +netgroup |<br/>
          '!'* %:nonunix_group |<br/>
          '!'* %:#nonunix_gid |<br/>
          '!'* User_Alias<br/>
<div class="spacer">
</div>
A User_List is made up of one or more user names, user ids (prefixed with '#'), system group names and ids (prefixed with '%' and '%#' respectively), netgroups (prefixed with '+'), non-Unix group names and IDs (prefixed with '%:' and '%:#' respectively) and User_Aliases.  Each list item may be prefixed with zero or more '!' operators.  An odd number of '!' operators negate the value of the item; an even number just cancel each other out.<div class="spacer">
</div>
A user name, uid, group, gid, netgroup, nonunix_group or nonunix_gid may be enclosed in double quotes to avoid the need for escaping special characters.  Alternately, special characters may be specified in escaped hex mode, e.g. \x20 for space.  When using double quotes, any prefix characters must be included inside the quotes.<div class="spacer">
</div>
The actual nonunix_group and nonunix_gid syntax depends on the underlying group provider plugin (see the  <i>group_plugin</i> description below).  For instance, the QAS AD plugin supports the following formats:<dl>
<dt>
&#8226;</dt>
<dd>
Group in the same domain: &quot;Group Name&quot;</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Group in any domain: &quot;Group Name@FULLY.QUALIFIED.DOMAIN&quot;</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Group SID: &quot;S-1-2-34-5678901234-5678901234-5678901234-567&quot;</dd>
</dl>
<div class="spacer">
</div>
Note that quotes around group names are optional.  Unquoted strings must use a backslash (\) to escape spaces and special characters. See &quot;Other special characters and reserved words&quot; for a list of characters that need to be escaped.<div class="spacer">
</div>
<br/>
 Runas_List ::= Runas_Member |<br/>
                Runas_Member ',' Runas_List<br/>
<br/>
 Runas_Member ::= '!'* user name |<br/>
                  '!'* #uid |<br/>
                  '!'* %group |<br/>
                  '!'* %#gid |<br/>
                  '!'* %:nonunix_group |<br/>
                  '!'* %:#nonunix_gid |<br/>
                  '!'* +netgroup |<br/>
                  '!'* Runas_Alias<br/>
<div class="spacer">
</div>
A Runas_List is similar to a User_List except that instead of User_Aliases it can contain Runas_Aliases.  Note that user names and groups are matched as strings.  In other words, two users (groups) with the same uid (gid) are considered to be distinct. If you wish to match all user names with the same uid (e.g.&#160;root and toor), you can use a uid instead (#0 in the example given).<div class="spacer">
</div>
<br/>
 Host_List ::= Host |<br/>
               Host ',' Host_List<br/>
<br/>
 Host ::= '!'* host name |<br/>
          '!'* ip_addr |<br/>
          '!'* network(/netmask)? |<br/>
          '!'* +netgroup |<br/>
          '!'* Host_Alias<br/>
<div class="spacer">
</div>
A Host_List is made up of one or more host names, IP addresses, network numbers, netgroups (prefixed with '+') and other aliases. Again, the value of an item may be negated with the '!' operator. If you do not specify a netmask along with the network number,  <b>sudo</b> will query each of the local host's network interfaces and, if the network number corresponds to one of the hosts's network interfaces, the corresponding netmask will be used.  The netmask may be specified either in standard IP address notation (e.g.&#160;255.255.255.0 or ffff:ffff:ffff:ffff::), or CIDR notation (number of bits, e.g.&#160;24 or 64).  A host name may include shell-style wildcards (see the Wildcards section below), but unless the host name command on your machine returns the fully qualified host name, you'll need to use the  <i>fqdn</i> option for wildcards to be useful.  Note  <b>sudo</b> only inspects actual network interfaces; this means that IP address 127.0.0.1 (localhost) will never match.  Also, the host name &quot;localhost&quot; will only match if that is the actual host name, which is usually only the case for non-networked systems.<div class="spacer">
</div>
<br/>
 Cmnd_List ::= Cmnd |<br/>
               Cmnd ',' Cmnd_List<br/>
<br/>
 commandname ::= file name |<br/>
                 file name args |<br/>
                 file name '&quot;&quot;'<br/>
<br/>
 Cmnd ::= '!'* commandname |<br/>
          '!'* directory |<br/>
          '!'* &quot;sudoedit&quot; |<br/>
          '!'* Cmnd_Alias<br/>
<div class="spacer">
</div>
A Cmnd_List is a list of one or more commandnames, directories, and other aliases.  A commandname is a fully qualified file name which may include shell-style wildcards (see the Wildcards section below).  A simple file name allows the user to run the command with any arguments he/she wishes.  However, you may also specify command line arguments (including wildcards).  Alternately, you can specify &quot;&quot; to indicate that the command may only be run  <b>without</b> command line arguments.  A directory is a fully qualified path name ending in a '/'.  When you specify a directory in a Cmnd_List, the user will be able to run any file within that directory (but not in any subdirectories therein).<div class="spacer">
</div>
If a Cmnd has associated command line arguments, then the arguments in the Cmnd must match exactly those given by the user on the command line (or match the wildcards if there are any).  Note that the following characters must be escaped with a '\' if they are used in command arguments: ',', ':', '=', '\'.  The special command &quot;sudoedit&quot; is used to permit a user to run  <b>sudo</b> with the <b>-e</b> option (or as  <b>sudoedit</b>).  It may take command line arguments just as a normal command does.</div>
<div class="subsection">
<h2>Defaults</h2> Certain configuration options may be changed from their default values at runtime via one or more Default_Entry lines.  These may affect all users on any host, all users on a specific host, a specific user, a specific command, or commands being run as a specific user. Note that per-command entries may not include command line arguments. If you need to specify arguments, define a Cmnd_Alias and reference that instead.<div class="spacer">
</div>
<br/>
 Default_Type ::= 'Defaults' |<br/>
                  'Defaults' '@' Host_List |<br/>
                  'Defaults' ':' User_List |<br/>
                  'Defaults' '!' Cmnd_List |<br/>
                  'Defaults' '&gt;' Runas_List<br/>
<br/>
 Default_Entry ::= Default_Type Parameter_List<br/>
<br/>
 Parameter_List ::= Parameter |<br/>
                    Parameter ',' Parameter_List<br/>
<br/>
 Parameter ::= Parameter '=' Value |<br/>
               Parameter '+=' Value |<br/>
               Parameter '-=' Value |<br/>
               '!'* Parameter<br/>
<div class="spacer">
</div>
Parameters may be <b>flags</b>, <b>integer</b> values, <b>strings</b>, or <b>lists</b>. Flags are implicitly boolean and can be turned off via the '!' operator.  Some integer, string and list parameters may also be used in a boolean context to disable them.  Values may be enclosed in double quotes (&quot;) when they contain multiple words.  Special characters may be escaped with a backslash (\).<div class="spacer">
</div>
Lists have two additional assignment operators, += and -=. These operators are used to add to and delete from a list respectively. It is not an error to use the -= operator to remove an element that does not exist in a list.<div class="spacer">
</div>
Defaults entries are parsed in the following order: generic, host and user Defaults first, then runas Defaults and finally command defaults.<div class="spacer">
</div>
See &quot;SUDOERS OPTIONS&quot; for a list of supported Defaults parameters.</div>
<div class="subsection">
<h2>User Specification</h2><br/>
 User_Spec ::= User_List Host_List '=' Cmnd_Spec_List \<br/>
               (':' Host_List '=' Cmnd_Spec_List)*<br/>
<br/>
 Cmnd_Spec_List ::= Cmnd_Spec |<br/>
                    Cmnd_Spec ',' Cmnd_Spec_List<br/>
<br/>
 Cmnd_Spec ::= Runas_Spec? Tag_Spec* Cmnd<br/>
<br/>
 Runas_Spec ::= '(' Runas_List? (':' Runas_List)? ')'<br/>
<br/>
 Tag_Spec ::= ('NOPASSWD:' | 'PASSWD:' | 'NOEXEC:' | 'EXEC:' |<br/>
               'SETENV:' | 'NOSETENV:' | 'LOG_INPUT:' | 'NOLOG_INPUT:' |<br/>
               'LOG_OUTPUT:' | 'NOLOG_OUTPUT:')<br/>
<div class="spacer">
</div>
A <b>user specification</b> determines which commands a user may run (and as what user) on specified hosts.  By default, commands are run as  <b>root</b>, but this can be changed on a per-command basis.<div class="spacer">
</div>
The basic structure of a user specification is `who where = (as_whom) what'.  Let's break that down into its constituent parts:</div>
<div class="subsection">
<h2>Runas_Spec</h2> A Runas_Spec determines the user and/or the group that a command may be run as.  A fully-specified Runas_Spec consists of two Runas_Lists (as defined above) separated by a colon (':') and enclosed in a set of parentheses.  The first Runas_List indicates which users the command may be run as via  <b>sudo</b>'s <b>-u</b> option. The second defines a list of groups that can be specified via  <b>sudo</b>'s <b>-g</b> option.  If both Runas_Lists are specified, the command may be run with any combination of users and groups listed in their respective Runas_Lists.  If only the first is specified, the command may be run as any user in the list but no  <b>-g</b> option may be specified.  If the first Runas_List is empty but the second is specified, the command may be run as the invoking user with the group set to any listed in the Runas_List.  If no Runas_Spec is specified the command may be run as  <b>root</b> and no group may be specified.<div class="spacer">
</div>
A Runas_Spec sets the default for the commands that follow it. What this means is that for the entry:<div class="spacer">
</div>
<br/>
 dgb    boulder = (operator) /bin/ls, /bin/kill, /usr/bin/lprm<br/>
<div class="spacer">
</div>
The user <b>dgb</b> may run <i>/bin/ls</i>, <i>/bin/kill</i>, and  <i>/usr/bin/lprm</i> -- but only as <b>operator</b>.  E.g.,<div class="spacer">
</div>
<br/>
 $ sudo -u operator /bin/ls<br/>
<div class="spacer">
</div>
It is also possible to override a Runas_Spec later on in an entry.  If we modify the entry like so:<div class="spacer">
</div>
<br/>
 dgb    boulder = (operator) /bin/ls, (root) /bin/kill, /usr/bin/lprm<br/>
<div class="spacer">
</div>
Then user <b>dgb</b> is now allowed to run <i>/bin/ls</i> as <b>operator</b>, but   <i>/bin/kill</i> and <i>/usr/bin/lprm</i> as <b>root</b>.<div class="spacer">
</div>
We can extend this to allow <b>dgb</b> to run /bin/ls with either the user or group set to  <b>operator</b>:<div class="spacer">
</div>
<br/>
 dgb    boulder = (operator : operator) /bin/ls, (root) /bin/kill, \<br/>
        /usr/bin/lprm<br/>
<div class="spacer">
</div>
Note that while the group portion of the Runas_Spec permits the user to run as command with that group, it does not force the user to do so.  If no group is specified on the command line, the command will run with the group listed in the target user's password database entry.  The following would all be permitted by the sudoers entry above:<div class="spacer">
</div>
<br/>
 $ sudo -u operator /bin/ls<br/>
 $ sudo -u operator -g operator /bin/ls<br/>
 $ sudo -g operator /bin/ls<br/>
<div class="spacer">
</div>
In the following example, user <b>tcm</b> may run commands that access a modem device file with the dialer group.<div class="spacer">
</div>
<br/>
 tcm    boulder = (:dialer) /usr/bin/tip, /usr/bin/cu, \<br/>
        /usr/local/bin/minicom<br/>
<div class="spacer">
</div>
Note that in this example only the group will be set, the command still runs as user  <b>tcm</b>.  E.g.<div class="spacer">
</div>
<br/>
 $ sudo -g dialer /usr/bin/cu<br/>
<div class="spacer">
</div>
Multiple users and groups may be present in a Runas_Spec, in which case the user may select any combination of users and groups via the  <b>-u</b> and <b>-g</b> options.  In this example:<div class="spacer">
</div>
<br/>
 alan   ALL = (root, bin : operator, system) ALL<br/>
<div class="spacer">
</div>
user <b>alan</b> may run any command as either user root or bin, optionally setting the group to operator or system.</div>
<div class="subsection">
<h2>Tag_Spec</h2> A command may have zero or more tags associated with it.  There are eight possible tag values, NOPASSWD, PASSWD, NOEXEC, EXEC, SETENV, NOSETENV, LOG_INPUT, NOLOG_INPUT, LOG_OUTPUT and NOLOG_OUTPUT.  Once a tag is set on a Cmnd, subsequent Cmnds in the Cmnd_Spec_List, inherit the tag unless it is overridden by the opposite tag (i.e.: PASSWD overrides NOPASSWD and NOEXEC overrides EXEC).<div class="spacer">
</div>
<i>NOPASSWD and PASSWD</i><div class="spacer">
</div>
By default, <b>sudo</b> requires that a user authenticate him or herself before running a command.  This behavior can be modified via the NOPASSWD tag.  Like a Runas_Spec, the NOPASSWD tag sets a default for the commands that follow it in the Cmnd_Spec_List. Conversely, the PASSWD tag can be used to reverse things. For example:<div class="spacer">
</div>
<br/>
 ray    rushmore = NOPASSWD: /bin/kill, /bin/ls, /usr/bin/lprm<br/>
<div class="spacer">
</div>
would allow the user <b>ray</b> to run <i>/bin/kill</i>, <i>/bin/ls</i>, and  <i>/usr/bin/lprm</i> as <b>root</b> on the machine rushmore without authenticating himself.  If we only want  <b>ray</b> to be able to run  <i>/bin/kill</i> without a password the entry would be:<div class="spacer">
</div>
<br/>
 ray    rushmore = NOPASSWD: /bin/kill, PASSWD: /bin/ls, /usr/bin/lprm<br/>
<div class="spacer">
</div>
Note, however, that the PASSWD tag has no effect on users who are in the group specified by the  <i>exempt_group</i> option.<div class="spacer">
</div>
By default, if the NOPASSWD tag is applied to any of the entries for a user on the current host, he or she will be able to run sudo -l without a password.  Additionally, a user may only run sudo -v without a password if the NOPASSWD tag is present for all a user's entries that pertain to the current host. This behavior may be overridden via the verifypw and listpw options.<div class="spacer">
</div>
<i>NOEXEC and EXEC</i><div class="spacer">
</div>
If <b>sudo</b> has been compiled with <i>noexec</i> support and the underlying operating system supports it, the NOEXEC tag can be used to prevent a dynamically-linked executable from running further commands itself.<div class="spacer">
</div>
In the following example, user <b>aaron</b> may run <i>/usr/bin/more</i> and  <i>/usr/bin/vi</i> but shell escapes will be disabled.<div class="spacer">
</div>
<br/>
 aaron  shanty = NOEXEC: /usr/bin/more, /usr/bin/vi<br/>
<div class="spacer">
</div>
See the &quot;PREVENTING SHELL ESCAPES&quot; section below for more details on how NOEXEC works and whether or not it will work on your system.<div class="spacer">
</div>
<i>SETENV and NOSETENV</i><div class="spacer">
</div>
These tags override the value of the <i>setenv</i> option on a per-command basis.  Note that if SETENV has been set for a command, the user may disable the  <i>env_reset</i> option from the command line via the  <b>-E</b> option.  Additionally, environment variables set on the command line are not subject to the restrictions imposed by  <i>env_check</i>,  <i>env_delete</i>, or <i>env_keep</i>.  As such, only trusted users should be allowed to set variables in this manner.  If the command matched is  <b>ALL</b>, the SETENV tag is implied for that command; this default may be overridden by use of the NOSETENV tag.<div class="spacer">
</div>
<i>LOG_INPUT and NOLOG_INPUT</i><div class="spacer">
</div>
These tags override the value of the <i>log_input</i> option on a per-command basis.  For more information, see the description of  <i>log_input</i> in the &quot;SUDOERS OPTIONS&quot; section below.<div class="spacer">
</div>
<i>LOG_OUTPUT and NOLOG_OUTPUT</i><div class="spacer">
</div>
These tags override the value of the <i>log_output</i> option on a per-command basis.  For more information, see the description of  <i>log_output</i> in the &quot;SUDOERS OPTIONS&quot; section below.</div>
<div class="subsection">
<h2>Wildcards</h2>  <b>sudo</b> allows shell-style <i>wildcards</i> (aka meta or glob characters) to be used in host names, path names and command line arguments in the  <i>sudoers</i> file.  Wildcard matching is done via the <b>POSIX</b>  <i>glob</i>(3) and <i>fnmatch</i>(3) routines.  Note that these are <i>not</i> regular expressions.<dl>
<dt>
*</dt>
<dd>
Matches any set of zero or more characters.</dd>
</dl>
<dl>
<dt>
?</dt>
<dd>
Matches any single character.</dd>
</dl>
<dl>
<dt>
[...]</dt>
<dd>
Matches any character in the specified range.</dd>
</dl>
<dl>
<dt>
[!...]</dt>
<dd>
Matches any character <b>not</b> in the specified range.</dd>
</dl>
<dl>
<dt>
\x</dt>
<dd>
For any character &quot;x&quot;, evaluates to &quot;x&quot;.  This is used to escape special characters such as: &quot;*&quot;, &quot;?&quot;, &quot;[&quot;, and &quot;}&quot;.</dd>
</dl>
<div class="spacer">
</div>
POSIX character classes may also be used if your system's <i>glob</i>(3) and  <i>fnmatch</i>(3) functions support them.  However, because the ':' character has special meaning in  <i>sudoers</i>, it must be escaped.  For example:<div class="spacer">
</div>
<br/>
    /bin/ls [[\:alpha\:]]*<br/>
<div class="spacer">
</div>
Would match any file name beginning with a letter.<div class="spacer">
</div>
Note that a forward slash ('/') will <b>not</b> be matched by wildcards used in the path name.  When matching the command line arguments, however, a slash  <b>does</b> get matched by wildcards.  This is to make a path like:<div class="spacer">
</div>
<br/>
    /usr/bin/*<br/>
<div class="spacer">
</div>
match <i>/usr/bin/who</i> but not <i>/usr/bin/X11/xterm</i>.</div>
<div class="subsection">
<h2>Exceptions to wildcard rules</h2> The following exceptions apply to the above rules:<dl>
<dt>
&quot;&quot;</dt>
<dd>
If the empty string &quot;&quot; is the only command line argument in the  <i>sudoers</i> entry it means that command is not allowed to be run with  <b>any</b> arguments.</dd>
</dl>
</div>
<div class="subsection">
<h2>Including other files from within sudoers</h2> It is possible to include other  <i>sudoers</i> files from within the  <i>sudoers</i> file currently being parsed using the #include and #includedir directives.<div class="spacer">
</div>
This can be used, for example, to keep a site-wide <i>sudoers</i> file in addition to a local, per-machine file.  For the sake of this example the site-wide  <i>sudoers</i> will be <i>/etc/sudoers</i> and the per-machine one will be  <i>/etc/sudoers.local</i>.  To include  <i>/etc/sudoers.local</i> from within <i>/etc/sudoers</i> we would use the following line in  <i>/etc/sudoers</i>:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
#include /etc/sudoers.local</div>
<div class="spacer">
</div>
When <b>sudo</b> reaches this line it will suspend processing of the current file ( <i>/etc/sudoers</i>) and switch to <i>/etc/sudoers.local</i>. Upon reaching the end of  <i>/etc/sudoers.local</i>, the rest of  <i>/etc/sudoers</i> will be processed.  Files that are included may themselves include other files.  A hard limit of 128 nested include files is enforced to prevent include file loops.<div class="spacer">
</div>
The file name may include the %h escape, signifying the short form of the host name.  I.e., if the machine's host name is &quot;xerxes&quot;, then<div class="spacer">
</div>
#include /etc/sudoers.%h<div class="spacer">
</div>
will cause <b>sudo</b> to include the file <i>/etc/sudoers.xerxes</i>.<div class="spacer">
</div>
The #includedir directive can be used to create a <i>sudo.d</i> directory that the system package manager can drop  <i>sudoers</i> rules into as part of package installation.  For example, given:<div class="spacer">
</div>
#includedir /etc/sudoers.d<div class="spacer">
</div>
<b>sudo</b> will read each file in <i>/etc/sudoers.d</i>, skipping file names that end in ~ or contain a . character to avoid causing problems with package manager or editor temporary/backup files. Files are parsed in sorted lexical order.  That is,  <i>/etc/sudoers.d/01_first</i> will be parsed before  <i>/etc/sudoers.d/10_second</i>.  Be aware that because the sorting is lexical, not numeric,  <i>/etc/sudoers.d/1_whoops</i> would be loaded  <b>after</b> <i>/etc/sudoers.d/10_second</i>.  Using a consistent number of leading zeroes in the file names can be used to avoid such problems.<div class="spacer">
</div>
Note that unlike files included via #include, <b>visudo</b> will not edit the files in a #includedir directory unless one of them contains a syntax error.  It is still possible to run  <b>visudo</b> with the -f flag to edit the files directly.</div>
<div class="subsection">
<h2>Other special characters and reserved words</h2> The pound sign ('#') is used to indicate a comment (unless it is part of a #include directive or unless it occurs in the context of a user name and is followed by one or more digits, in which case it is treated as a uid).  Both the comment character and any text after it, up to the end of the line, are ignored.<div class="spacer">
</div>
The reserved word <b>ALL</b> is a built-in <i>alias</i> that always causes a match to succeed.  It can be used wherever one might otherwise use a Cmnd_Alias, User_Alias, Runas_Alias, or Host_Alias. You should not try to define your own  <i>alias</i> called <b>ALL</b> as the built-in alias will be used in preference to your own.  Please note that using  <b>ALL</b> can be dangerous since in a command context, it allows the user to run  <b>any</b> command on the system.<div class="spacer">
</div>
An exclamation point ('!') can be used as a logical <i>not</i> operator both in an  <i>alias</i> and in front of a Cmnd.  This allows one to exclude certain values.  Note, however, that using a ! in conjunction with the built-in ALL alias to allow a user to run &quot;all but a few&quot; commands rarely works as intended (see SECURITY NOTES below).<div class="spacer">
</div>
Long lines can be continued with a backslash ('\') as the last character on the line.<div class="spacer">
</div>
Whitespace between elements in a list as well as special syntactic characters in a  <i>User Specification</i> ('=', ':', '(', ')') is optional.<div class="spacer">
</div>
The following characters must be escaped with a backslash ('\') when used as part of a word (e.g.&#160;a user name or host name): '!', '=', ':', ',', '(', ')', '\'.</div>
</div>
<div class="section">
<h1>SUDOERS OPTIONS</h1>  <b>sudo</b>'s behavior can be modified by Default_Entry lines, as explained earlier.  A list of all supported Defaults parameters, grouped by type, are listed below.<div class="spacer">
</div>
<b>Boolean Flags</b>:<dl>
<dt>
always_set_home</dt>
<dd>
If enabled, <b>sudo</b> will set the HOME environment variable to the home directory of the target user (which is root unless the  <b>-u</b> option is used).  This effectively means that the  <b>-H</b> option is always implied.  Note that HOME is already set when the the  <i>env_reset</i> option is enabled, so <i>always_set_home</i> is only effective for configurations where either  <i>env_reset</i> is disabled or HOME is present in the  <i>env_keep</i> list. This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
authenticate</dt>
<dd>
If set, users must authenticate themselves via a password (or other means of authentication) before they may run commands.  This default may be overridden via the PASSWD and NOPASSWD tags. This flag is  <i>on</i> by default.</dd>
</dl>
<dl>
<dt>
closefrom_override</dt>
<dd>
If set, the user may use <b>sudo</b>'s <b>-C</b> option which overrides the default starting point at which  <b>sudo</b> begins closing open file descriptors.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
compress_io</dt>
<dd>
If set, and <b>sudo</b> is configured to log a command's input or output, the I/O logs will be compressed using  <b>zlib</b>.  This flag is <i>on</i> by default when  <b>sudo</b> is compiled with <b>zlib</b> support.</dd>
</dl>
<dl>
<dt>
env_editor</dt>
<dd>
If set, <b>visudo</b> will use the value of the EDITOR or VISUAL environment variables before falling back on the default editor list. Note that this may create a security hole as it allows the user to run any arbitrary command as root without logging.  A safer alternative is to place a colon-separated list of editors in the editor variable.   <b>visudo</b> will then only use the EDITOR or VISUAL if they match a value specified in editor.  This flag is  <i>on</i> by default.</dd>
</dl>
<dl>
<dt>
env_reset</dt>
<dd>
If set, <b>sudo</b> will reset the environment to only contain the LOGNAME, MAIL, SHELL, USER, USERNAME and the SUDO_* variables.  Any variables in the caller's environment that match the env_keep and env_check lists are then added.  The default contents of the env_keep and env_check lists are displayed when  <b>sudo</b> is run by root with the  <i>-V</i> option.  If the <i>secure_path</i> option is set, its value will be used for the PATH environment variable. This flag is  <i>on</i> by default.</dd>
</dl>
<dl>
<dt>
fast_glob</dt>
<dd>
Normally, <b>sudo</b> uses the <i>glob</i>(3) function to do shell-style globbing when matching path names.  However, since it accesses the file system,  <i>glob</i>(3) can take a long time to complete for some patterns, especially when the pattern references a network file system that is mounted on demand (automounted).  The  <i>fast_glob</i> option causes  <b>sudo</b> to use the <i>fnmatch</i>(3) function, which does not access the file system to do its matching.  The disadvantage of  <i>fast_glob</i> is that it is unable to match relative path names such as  <i>./ls</i> or <i>../bin/ls</i>.  This has security implications when path names that include globbing characters are used with the negation operator, '!', as such rules can be trivially bypassed. As such, this option should not be used when  <i>sudoers</i> contains rules that contain negated path names which include globbing characters. This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
fqdn</dt>
<dd>
Set this flag if you want to put fully qualified host names in the  <i>sudoers</i> file.  I.e., instead of myhost you would use myhost.mydomain.edu. You may still use the short form if you wish (and even mix the two). Beware that turning on  <i>fqdn</i> requires <b>sudo</b> to make DNS lookups which may make  <b>sudo</b> unusable if DNS stops working (for example if the machine is not plugged into the network).  Also note that you must use the host's official name as DNS knows it.  That is, you may not use a host alias (CNAME entry) due to performance issues and the fact that there is no way to get all aliases from DNS.  If your machine's host name (as returned by the hostname command) is already fully qualified you shouldn't need to set  <i>fqdn</i>.  This flag is <i>on</i> by default.</dd>
</dl>
<dl>
<dt>
ignore_dot</dt>
<dd>
If set, <b>sudo</b> will ignore '.' or '' (current dir) in the PATH environment variable; the PATH itself is not modified.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
ignore_local_sudoers</dt>
<dd>
If set via LDAP, parsing of <i>/etc/sudoers</i> will be skipped. This is intended for Enterprises that wish to prevent the usage of local sudoers files so that only LDAP is used.  This thwarts the efforts of rogue operators who would attempt to add roles to  <i>/etc/sudoers</i>. When this option is present,  <i>/etc/sudoers</i> does not even need to exist. Since this option tells  <b>sudo</b> how to behave when no specific LDAP entries have been matched, this sudoOption is only meaningful for the cn=defaults section.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
insults</dt>
<dd>
If set, <b>sudo</b> will insult users when they enter an incorrect password.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
log_host</dt>
<dd>
If set, the host name will be logged in the (non-syslog) <b>sudo</b> log file. This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
log_input</dt>
<dd>
If set, <b>sudo</b> will run the command in a <i>pseudo tty</i> and log all user input. If the standard input is not connected to the user's tty, due to I/O redirection or because the command is part of a pipeline, that input is also captured and stored in a separate log file.<div style="height: 1.00em;">
&#160;</div>
Input is logged to the directory specified by the <i>iolog_dir</i> option ( <i>/var/log/sudo-io</i> by default) using a unique session ID that is included in the normal  <b>sudo</b> log line, prefixed with <i>TSID=</i>. The  <i>iolog_file</i> option may be used to control the format of the session ID.<div style="height: 1.00em;">
&#160;</div>
Note that user input may contain sensitive information such as passwords (even if they are not echoed to the screen), which will be stored in the log file unencrypted.  In most cases, logging the command output via  <i>log_output</i> is all that is required.</dd>
</dl>
<dl>
<dt>
log_output</dt>
<dd>
If set, <b>sudo</b> will run the command in a <i>pseudo tty</i> and log all output that is sent to the screen, similar to the  <i>script</i>(1) command. If the standard output or standard error is not connected to the user's tty, due to I/O redirection or because the command is part of a pipeline, that output is also captured and stored in separate log files.<div style="height: 1.00em;">
&#160;</div>
Output is logged to the directory specified by the <i>iolog_dir</i> option ( <i>/var/log/sudo-io</i> by default) using a unique session ID that is included in the normal  <b>sudo</b> log line, prefixed with <i>TSID=</i>. The  <i>iolog_file</i> option may be used to control the format of the session ID.<div style="height: 1.00em;">
&#160;</div>
Output logs may be viewed with the <i>sudoreplay</i>(8) utility, which can also be used to list or search the available logs.</dd>
</dl>
<dl>
<dt>
log_year</dt>
<dd>
If set, the four-digit year will be logged in the (non-syslog) <b>sudo</b> log file. This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
long_otp_prompt</dt>
<dd>
When validating with a One Time Password (OTP) scheme such as  <b>S/Key</b> or <b>OPIE</b>, a two-line prompt is used to make it easier to cut and paste the challenge to a local window.  It's not as pretty as the default but some people find it more convenient.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
mail_always</dt>
<dd>
Send mail to the <i>mailto</i> user every time a users runs <b>sudo</b>. This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
mail_badpass</dt>
<dd>
Send mail to the <i>mailto</i> user if the user running <b>sudo</b> does not enter the correct password.  This flag is  <i>on</i> by default.</dd>
</dl>
<dl>
<dt>
mail_no_host</dt>
<dd>
If set, mail will be sent to the <i>mailto</i> user if the invoking user exists in the  <i>sudoers</i> file, but is not allowed to run commands on the current host.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
mail_no_perms</dt>
<dd>
If set, mail will be sent to the <i>mailto</i> user if the invoking user is allowed to use  <b>sudo</b> but the command they are trying is not listed in their  <i>sudoers</i> file entry or is explicitly denied. This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
mail_no_user</dt>
<dd>
If set, mail will be sent to the <i>mailto</i> user if the invoking user is not in the  <i>sudoers</i> file.  This flag is <i>on</i> by default.</dd>
</dl>
<dl>
<dt>
noexec</dt>
<dd>
If set, all commands run via <b>sudo</b> will behave as if the NOEXEC tag has been set, unless overridden by a EXEC tag.  See the description of  <i>NOEXEC and EXEC</i> below as well as the &quot;PREVENTING SHELL ESCAPES&quot; section at the end of this manual.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
path_info</dt>
<dd>
Normally, <b>sudo</b> will tell the user when a command could not be found in their PATH environment variable.  Some sites may wish to disable this as it could be used to gather information on the location of executables that the normal user does not have access to.  The disadvantage is that if the executable is simply not in the user's PATH,  <b>sudo</b> will tell the user that they are not allowed to run it, which can be confusing.  This flag is  <i>on</i> by default.</dd>
</dl>
<dl>
<dt>
passprompt_override</dt>
<dd>
The password prompt specified by <i>passprompt</i> will normally only be used if the password prompt provided by systems such as PAM matches the string &quot;Password:&quot;.  If  <i>passprompt_override</i> is set, <i>passprompt</i> will always be used.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
preserve_groups</dt>
<dd>
By default, <b>sudo</b> will initialize the group vector to the list of groups the target user is in.  When  <i>preserve_groups</i> is set, the user's existing group vector is left unaltered.  The real and effective group IDs, however, are still set to match the target user.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
pwfeedback</dt>
<dd>
By default, <b>sudo</b> reads the password like most other Unix programs, by turning off echo until the user hits the return (or enter) key. Some users become confused by this as it appears to them that  <b>sudo</b> has hung at this point.  When  <i>pwfeedback</i> is set, <b>sudo</b> will provide visual feedback when the user presses a key.  Note that this does have a security impact as an onlooker may be able to determine the length of the password being entered. This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
requiretty</dt>
<dd>
If set, <b>sudo</b> will only run when the user is logged in to a real tty.  When this flag is set,  <b>sudo</b> can only be run from a login session and not via other means such as  <i>cron</i>(8) or cgi-bin scripts. This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
root_sudo</dt>
<dd>
If set, root is allowed to run <b>sudo</b> too.  Disabling this prevents users from &quot;chaining&quot;  <b>sudo</b> commands to get a root shell by doing something like &quot;sudo sudo /bin/sh&quot;.  Note, however, that turning off  <i>root_sudo</i> will also prevent root from running  <b>sudoedit</b>. Disabling  <i>root_sudo</i> provides no real additional security; it exists purely for historical reasons. This flag is  <i>on</i> by default.</dd>
</dl>
<dl>
<dt>
rootpw</dt>
<dd>
If set, <b>sudo</b> will prompt for the root password instead of the password of the invoking user.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
runaspw</dt>
<dd>
If set, <b>sudo</b> will prompt for the password of the user defined by the  <i>runas_default</i> option (defaults to root) instead of the password of the invoking user.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
set_home</dt>
<dd>
If enabled and <b>sudo</b> is invoked with the <b>-s</b> option the HOME environment variable will be set to the home directory of the target user (which is root unless the  <b>-u</b> option is used).  This effectively makes the  <b>-s</b> option imply <b>-H</b>.  Note that HOME is already set when the the  <i>env_reset</i> option is enabled, so <i>set_home</i> is only effective for configurations where either  <i>env_reset</i> is disabled or HOME is present in the  <i>env_keep</i> list. This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
set_logname</dt>
<dd>
Normally, <b>sudo</b> will set the LOGNAME, USER and USERNAME environment variables to the name of the target user (usually root unless the  <b>-u</b> option is given).  However, since some programs (including the RCS revision control system) use LOGNAME to determine the real identity of the user, it may be desirable to change this behavior.  This can be done by negating the set_logname option.  Note that if the  <i>env_reset</i> option has not been disabled, entries in the  <i>env_keep</i> list will override the value of  <i>set_logname</i>.  This flag is <i>on</i> by default.</dd>
</dl>
<dl>
<dt>
set_utmp</dt>
<dd>
When enabled, <b>sudo</b> will create an entry in the utmp (or utmpx) file when a pseudo-tty is allocated.  A pseudo-tty is allocated by  <b>sudo</b> when the <i>log_input</i>, <i>log_output</i> or <i>use_pty</i> flags are enabled.  By default, the new entry will be a copy of the user's existing utmp entry (if any), with the tty, time, type and pid fields updated.  This flag is  <i>on</i> by default.</dd>
</dl>
<dl>
<dt>
setenv</dt>
<dd>
Allow the user to disable the <i>env_reset</i> option from the command line via the  <b>-E</b> option.  Additionally, environment variables set via the command line are not subject to the restrictions imposed by  <i>env_check</i>, <i>env_delete</i>, or <i>env_keep</i>.  As such, only trusted users should be allowed to set variables in this manner. This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
shell_noargs</dt>
<dd>
If set and <b>sudo</b> is invoked with no arguments it acts as if the  <b>-s</b> option had been given.  That is, it runs a shell as root (the shell is determined by the SHELL environment variable if it is set, falling back on the shell listed in the invoking user's /etc/passwd entry if not).  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
stay_setuid</dt>
<dd>
Normally, when <b>sudo</b> executes a command the real and effective UIDs are set to the target user (root by default).  This option changes that behavior such that the real UID is left as the invoking user's UID.  In other words, this makes  <b>sudo</b> act as a setuid wrapper.  This can be useful on systems that disable some potentially dangerous functionality when a program is run setuid.  This option is only effective on systems with either the  <i>setreuid()</i> or <i>setresuid()</i> function.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
targetpw</dt>
<dd>
If set, <b>sudo</b> will prompt for the password of the user specified by the  <b>-u</b> option (defaults to root) instead of the password of the invoking user.  In addition, the timestamp file name will include the target user's name.  Note that this flag precludes the use of a uid not listed in the passwd database as an argument to the  <b>-u</b> option.  This flag is <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
tty_tickets</dt>
<dd>
If set, users must authenticate on a per-tty basis.  With this flag enabled,  <b>sudo</b> will use a file named for the tty the user is logged in on in the user's time stamp directory.  If disabled, the time stamp of the directory is used instead.  This flag is  <i>on</i> by default.</dd>
</dl>
<dl>
<dt>
umask_override</dt>
<dd>
If set, <b>sudo</b> will set the umask as specified by <i>sudoers</i> without modification.  This makes it possible to specify a more permissive umask in  <i>sudoers</i> than the user's own umask and matches historical behavior.  If  <i>umask_override</i> is not set, <b>sudo</b> will set the umask to be the union of the user's umask and what is specified in  <i>sudoers</i>.  This flag is <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
use_pty</dt>
<dd>
If set, <b>sudo</b> will run the command in a pseudo-pty even if no I/O logging is being gone.  A malicious program run under  <b>sudo</b> could conceivably fork a background process that retains to the user's terminal device after the main program has finished executing.  Use of this option will make that impossible.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
utmp_runas</dt>
<dd>
If set, <b>sudo</b> will store the name of the runas user when updating the utmp (or utmpx) file.  By default,  <b>sudo</b> stores the name of the invoking user.  This flag is  <i>off</i> by default.</dd>
</dl>
<dl>
<dt>
visiblepw</dt>
<dd>
By default, <b>sudo</b> will refuse to run if the user must enter a password but it is not possible to disable echo on the terminal. If the  <i>visiblepw</i> flag is set, <b>sudo</b> will prompt for a password even when it would be visible on the screen.  This makes it possible to run things like &quot;rsh somehost sudo ls&quot; since  <i>rsh</i>(1) does not allocate a tty.  This flag is  <i>off</i> by default.</dd>
</dl>
<div class="spacer">
</div>
<b>Integers</b>:<dl>
<dt>
closefrom</dt>
<dd>
Before it executes a command, <b>sudo</b> will close all open file descriptors other than standard input, standard output and standard error (ie: file descriptors 0-2).  The  <i>closefrom</i> option can be used to specify a different file descriptor at which to start closing. The default is 3.</dd>
</dl>
<dl>
<dt>
passwd_tries</dt>
<dd>
The number of tries a user gets to enter his/her password before  <b>sudo</b> logs the failure and exits.  The default is 3.</dd>
</dl>
<div class="spacer">
</div>
<b>Integers that can be used in a boolean context</b>:<dl>
<dt>
loglinelen</dt>
<dd>
Number of characters per line for the file log.  This value is used to decide when to wrap lines for nicer log files.  This has no effect on the syslog log file, only the file log.  The default is 80 (use 0 or negate the option to disable word wrap).</dd>
</dl>
<dl>
<dt>
passwd_timeout</dt>
<dd>
Number of minutes before the <b>sudo</b> password prompt times out, or 0 for no timeout.  The timeout may include a fractional component if minute granularity is insufficient, for example 2.5.  The default is 0.</dd>
</dl>
<dl>
<dt>
timestamp_timeout</dt>
<dd>
Number of minutes that can elapse before <b>sudo</b> will ask for a passwd again.  The timeout may include a fractional component if minute granularity is insufficient, for example 2.5.  The default is 15.  Set this to 0 to always prompt for a password. If set to a value less than 0 the user's timestamp will never expire.  This can be used to allow users to create or delete their own timestamps via sudo -v and sudo -k respectively.</dd>
</dl>
<dl>
<dt>
umask</dt>
<dd>
Umask to use when running the command.  Negate this option or set it to 0777 to preserve the user's umask.  The actual umask that is used will be the union of the user's umask and the value of the  <i>umask</i> option, which defaults to 0022.  This guarantees that  <b>sudo</b> never lowers the umask when running a command.  Note on systems that use PAM, the default PAM configuration may specify its own umask which will override the value set in  <i>sudoers</i>.</dd>
</dl>
<div class="spacer">
</div>
<b>Strings</b>:<dl>
<dt>
badpass_message</dt>
<dd>
Message that is displayed if a user enters an incorrect password. The default is Sorry, try again. unless insults are enabled.</dd>
</dl>
<dl>
<dt>
editor</dt>
<dd>
A colon (':') separated list of editors allowed to be used with  <b>visudo</b>.  <b>visudo</b> will choose the editor that matches the user's EDITOR environment variable if possible, or the first editor in the list that exists and is executable.  The default is &quot;/usr/local/bin/vi&quot;.</dd>
</dl>
<dl>
<dt>
iolog_dir</dt>
<dd>
The top-level directory to use when constructing the path name for the input/output log directory.  Only used if the  <i>log_input</i> or  <i>log_output</i> options are enabled or when the LOG_INPUT or LOG_OUTPUT tags are present for a command.  The session sequence number, if any, is stored in the directory. The default is &quot;/var/log/sudo-io&quot;.<div style="height: 1.00em;">
&#160;</div>
The following percent (`%') escape sequences are supported:</dd>
</dl>
<div style="margin-left: 16.00ex;">
<dl>
<dt>
%{seq}</dt>
<dd>
expanded to a monotonically increasing base-36 sequence number, such as 0100A5, where every two digits are used to form a new directory, e.g.  <i>01/00/A5</i></dd>
</dl>
<dl>
<dt>
%{user}</dt>
<dd>
expanded to the invoking user's login name</dd>
</dl>
<dl>
<dt>
%{group}</dt>
<dd>
expanded to the name of the invoking user's real group ID</dd>
</dl>
<dl>
<dt>
%{runas_user}</dt>
<dd>
expanded to the login name of the user the command will be run as (e.g. root)</dd>
</dl>
<dl>
<dt>
%{runas_group}</dt>
<dd>
expanded to the group name of the user the command will be run as (e.g. wheel)</dd>
</dl>
<dl>
<dt>
%{hostname}</dt>
<dd>
expanded to the local host name without the domain name</dd>
</dl>
<dl>
<dt>
%{command}</dt>
<dd>
expanded to the base name of the command being run</dd>
</dl>
</div>
<div style="margin-left: 16.00ex;">
<div style="height: 1.00em;">
&#160;</div>
In addition, any escape sequences supported by the system's <i>strftime()</i> function will be expanded.<div style="height: 1.00em;">
&#160;</div>
To include a literal `%' character, the string `%%' should be used.</div>
<dl>
<dt>
iolog_file</dt>
<dd>
The path name, relative to <i>iolog_dir</i>, in which to store input/output logs when the  <i>log_input</i> or <i>log_output</i> options are enabled or when the LOG_INPUT or LOG_OUTPUT tags are present for a command. Note that  <i>iolog_file</i> may contain directory components. The default is &quot;%{seq}&quot;.<div style="height: 1.00em;">
&#160;</div>
See the <i>iolog_dir</i> option above for a list of supported percent (`%') escape sequences.<div style="height: 1.00em;">
&#160;</div>
In addition to the escape sequences, path names that end in six or more Xs will have the Xs replaced with a unique combination of digits and letters, similar to the  <i>mktemp()</i> function.</dd>
</dl>
<dl>
<dt>
mailsub</dt>
<dd>
Subject of the mail sent to the <i>mailto</i> user. The escape %h will expand to the host name of the machine. Default is *** SECURITY information for %h ***.</dd>
</dl>
<dl>
<dt>
noexec_file</dt>
<dd>
This option is deprecated and will be removed in a future release of  <b>sudo</b>.  The path to the noexec file should now be set in the  <i>/etc/sudo.conf</i> file.</dd>
</dl>
<dl>
<dt>
passprompt</dt>
<dd>
The default prompt to use when asking for a password; can be overridden via the  <b>-p</b> option or the SUDO_PROMPT environment variable. The following percent (`%') escape sequences are supported:</dd>
</dl>
<div style="margin-left: 16.00ex;">
<dl>
<dt>
%H</dt>
<dd>
expanded to the local host name including the domain name (only if the machine's host name is fully qualified or the  <i>fqdn</i> option is set)</dd>
</dl>
<dl>
<dt>
%h</dt>
<dd>
expanded to the local host name without the domain name</dd>
</dl>
<dl>
<dt>
%p</dt>
<dd>
expanded to the user whose password is being asked for (respects the  <i>rootpw</i>, <i>targetpw</i> and <i>runaspw</i> flags in <i>sudoers</i>)</dd>
</dl>
<dl>
<dt>
%U</dt>
<dd>
expanded to the login name of the user the command will be run as (defaults to root)</dd>
</dl>
<dl>
<dt>
%u</dt>
<dd>
expanded to the invoking user's login name</dd>
</dl>
<dl>
<dt>
%%</dt>
<dd>
two consecutive % characters are collapsed into a single % character</dd>
</dl>
</div>
<div style="margin-left: 16.00ex;">
<div style="height: 1.00em;">
&#160;</div>
The default value is [sudo] password for %p: .</div>
<dl>
<dt>
runas_default</dt>
<dd>
The default user to run commands as if the <b>-u</b> option is not specified on the command line.  This defaults to root.</dd>
</dl>
<dl>
<dt>
syslog_badpri</dt>
<dd>
Syslog priority to use when user authenticates unsuccessfully. Defaults to alert.<div style="height: 1.00em;">
&#160;</div>
The following syslog priorities are supported: <b>alert</b>, <b>crit</b>,  <b>debug</b>, <b>emerg</b>, <b>err</b>, <b>info</b>, <b>notice</b>, and <b>warning</b>.</dd>
</dl>
<dl>
<dt>
syslog_goodpri</dt>
<dd>
Syslog priority to use when user authenticates successfully. Defaults to notice.<div style="height: 1.00em;">
&#160;</div>
See syslog_badpri for the list of supported syslog priorities.</dd>
</dl>
<dl>
<dt>
sudoers_locale</dt>
<dd>
Locale to use when parsing the sudoers file, logging commands, and sending email.  Note that changing the locale may affect how sudoers is interpreted.  Defaults to &quot;C&quot;.</dd>
</dl>
<dl>
<dt>
timestampdir</dt>
<dd>
The directory in which <b>sudo</b> stores its timestamp files. The default is  <i>/var/lib/sudo</i>.</dd>
</dl>
<dl>
<dt>
timestampowner</dt>
<dd>
The owner of the timestamp directory and the timestamps stored therein. The default is root.</dd>
</dl>
<div class="spacer">
</div>
<b>Strings that can be used in a boolean context</b>:<dl>
<dt>
env_file</dt>
<dd>
The <i>env_file</i> options specifies the fully qualified path to a file containing variables to be set in the environment of the program being run.  Entries in this file should either be of the form VARIABLE=value or export VARIABLE=value.  The value may optionally be surrounded by single or double quotes.  Variables in this file are subject to other  <b>sudo</b> environment settings such as  <i>env_keep</i> and <i>env_check</i>.</dd>
</dl>
<dl>
<dt>
exempt_group</dt>
<dd>
Users in this group are exempt from password and PATH requirements. The group name specified should not include a % prefix. This is not set by default.</dd>
</dl>
<dl>
<dt>
group_plugin</dt>
<dd>
A string containing a <i>sudoers</i> group plugin with optional arguments. This can be used to implement support for the nonunix_group syntax described earlier.  The string should consist of the plugin path, either fully-qualified or relative to the  <i>/usr/libexec</i> directory, followed by any configuration arguments the plugin requires.  These arguments (if any) will be passed to the plugin's initialization function.  If arguments are present, the string must be enclosed in double quotes (&quot;).<div style="height: 1.00em;">
&#160;</div>
For example, given <i>/etc/sudo-group</i>, a group file in Unix group format, the sample group plugin can be used:<div style="height: 1.00em;">
&#160;</div>
<br/>
    Defaults group_plugin=&quot;sample_group.so /etc/sudo-group&quot;<br/>
<div style="height: 1.00em;">
&#160;</div>
For more information see <i>sudo_plugin</i>(5).</dd>
</dl>
<dl>
<dt>
lecture</dt>
<dd>
This option controls when a short lecture will be printed along with the password prompt.  It has the following possible values:</dd>
</dl>
<div style="margin-left: 12.00ex;">
<dl>
<dt>
always</dt>
<dd>
Always lecture the user.</dd>
</dl>
<dl>
<dt>
never</dt>
<dd>
Never lecture the user.</dd>
</dl>
<dl>
<dt>
once</dt>
<dd>
Only lecture the user the first time they run <b>sudo</b>.</dd>
</dl>
</div>
<div style="margin-left: 12.00ex;">
<div style="height: 1.00em;">
&#160;</div>
If no value is specified, a value of <i>once</i> is implied. Negating the option results in a value of  <i>never</i> being used. The default value is  <i>never</i>.</div>
<dl>
<dt>
lecture_file</dt>
<dd>
Path to a file containing an alternate <b>sudo</b> lecture that will be used in place of the standard lecture if the named file exists. By default,  <b>sudo</b> uses a built-in lecture.</dd>
</dl>
<dl>
<dt>
listpw</dt>
<dd>
This option controls when a password will be required when a user runs  <b>sudo</b> with the <b>-l</b> option.  It has the following possible values:</dd>
</dl>
<div style="margin-left: 12.00ex;">
<dl>
<dt>
all</dt>
<dd>
All the user's <i>sudoers</i> entries for the current host must have the NOPASSWD flag set to avoid entering a password.</dd>
</dl>
<dl>
<dt>
always</dt>
<dd>
The user must always enter a password to use the <b>-l</b> option.</dd>
</dl>
<dl>
<dt>
any</dt>
<dd>
At least one of the user's <i>sudoers</i> entries for the current host must have the NOPASSWD flag set to avoid entering a password.</dd>
</dl>
<dl>
<dt>
never</dt>
<dd>
The user need never enter a password to use the <b>-l</b> option.</dd>
</dl>
</div>
<div style="margin-left: 12.00ex;">
<div style="height: 1.00em;">
&#160;</div>
If no value is specified, a value of <i>any</i> is implied. Negating the option results in a value of  <i>never</i> being used. The default value is  <i>any</i>.</div>
<dl>
<dt>
logfile</dt>
<dd>
Path to the <b>sudo</b> log file (not the syslog log file).  Setting a path turns on logging to a file; negating this option turns it off. By default,  <b>sudo</b> logs via syslog.</dd>
</dl>
<dl>
<dt>
mailerflags</dt>
<dd>
Flags to use when invoking mailer. Defaults to <b>-t</b>.</dd>
</dl>
<dl>
<dt>
mailerpath</dt>
<dd>
Path to mail program used to send warning mail. Defaults to the path to sendmail found at configure time.</dd>
</dl>
<dl>
<dt>
mailfrom</dt>
<dd>
Address to use for the &quot;from&quot; address when sending warning and error mail.  The address should be enclosed in double quotes (&quot;) to protect against  <b>sudo</b> interpreting the @ sign.  Defaults to the name of the user running  <b>sudo</b>.</dd>
</dl>
<dl>
<dt>
mailto</dt>
<dd>
Address to send warning and error mail to.  The address should be enclosed in double quotes (&quot;) to protect against  <b>sudo</b> interpreting the @ sign.  Defaults to root.</dd>
</dl>
<dl>
<dt>
secure_path</dt>
<dd>
Path used for every command run from <b>sudo</b>.  If you don't trust the people running  <b>sudo</b> to have a sane PATH environment variable you may want to use this.  Another use is if you want to have the &quot;root path&quot; be separate from the &quot;user path.&quot;  Users in the group specified by the  <i>exempt_group</i> option are not affected by <i>secure_path</i>. This option is not set by default.</dd>
</dl>
<dl>
<dt>
syslog</dt>
<dd>
Syslog facility if syslog is being used for logging (negate to disable syslog logging).  Defaults to authpriv.<div style="height: 1.00em;">
&#160;</div>
The following syslog facilities are supported: <b>authpriv</b> (if your OS supports it),  <b>auth</b>, <b>daemon</b>, <b>user</b>, <b>local0</b>, <b>local1</b>,  <b>local2</b>, <b>local3</b>, <b>local4</b>, <b>local5</b>, <b>local6</b>, and <b>local7</b>.</dd>
</dl>
<dl>
<dt>
verifypw</dt>
<dd>
This option controls when a password will be required when a user runs  <b>sudo</b> with the <b>-v</b> option.  It has the following possible values:</dd>
</dl>
<div style="margin-left: 12.00ex;">
<dl>
<dt>
all</dt>
<dd>
All the user's <i>sudoers</i> entries for the current host must have the NOPASSWD flag set to avoid entering a password.</dd>
</dl>
<dl>
<dt>
always</dt>
<dd>
The user must always enter a password to use the <b>-v</b> option.</dd>
</dl>
<dl>
<dt>
any</dt>
<dd>
At least one of the user's <i>sudoers</i> entries for the current host must have the NOPASSWD flag set to avoid entering a password.</dd>
</dl>
<dl>
<dt>
never</dt>
<dd>
The user need never enter a password to use the <b>-v</b> option.</dd>
</dl>
</div>
<div style="margin-left: 12.00ex;">
<div style="height: 1.00em;">
&#160;</div>
If no value is specified, a value of <i>all</i> is implied. Negating the option results in a value of  <i>never</i> being used. The default value is  <i>all</i>.</div>
<div class="spacer">
</div>
<b>Lists that can be used in a boolean context</b>:<dl>
<dt>
env_check</dt>
<dd>
Environment variables to be removed from the user's environment unless they are considered &#8220;safe&#8221;. For all variables except TZ, &#8220;safe&#8221; means that the variable's value does not contain any % or / characters.  This can be used to guard against printf-style format vulnerabilities in poorly-written programs. The TZ variable is considered unsafe if any of the following are true:</dd>
</dl>
<div class="spacer">
</div>
<div style="margin-left: 18.00ex;">
<dl>
<dt>
<b>&#8226;</b></dt>
<dd>
It consists of a fully-qualified path name, optionally prefixed with a colon (&#8216;:&#8217;), that does not match the location of the  <i>zoneinfo</i> directory.</dd>
</dl>
<dl>
<dt>
<b>&#8226;</b></dt>
<dd>
It contains a  <i>..</i> path element.</dd>
</dl>
<dl>
<dt>
<b>&#8226;</b></dt>
<dd>
It contains white space or non-printable characters.</dd>
</dl>
<dl>
<dt>
<b>&#8226;</b></dt>
<dd>
It is longer than the value of PATH_MAX.</dd>
</dl>
<div class="spacer">
</div>
The argument may be a double-quoted, space-separated list or a single value without double-quotes.  The list can be replaced, added to, deleted from, or disabled by using the =, +=, -=, and ! operators respectively.  Regardless of whether the env_reset option is enabled or disabled, variables specified by env_check will be preserved in the environment if they pass the aforementioned check.  The default list of environment variables to check is displayed when  <b>sudo</b> is run by root with the  <i>-V</i> option.<dl>
<dt>
env_delete</dt>
<dd>
Environment variables to be removed from the user's environment when the  <i>env_reset</i> option is not in effect.  The argument may be a double-quoted, space-separated list or a single value without double-quotes.  The list can be replaced, added to, deleted from, or disabled by using the =, +=, -=, and ! operators respectively.  The default list of environment variables to remove is displayed when  <b>sudo</b> is run by root with the <i>-V</i> option. Note that many operating systems will remove potentially dangerous variables from the environment of any setuid process (such as  <b>sudo</b>).</dd>
</dl>
<dl>
<dt>
env_keep</dt>
<dd>
Environment variables to be preserved in the user's environment when the  <i>env_reset</i> option is in effect.  This allows fine-grained control over the environment  <b>sudo</b>-spawned processes will receive. The argument may be a double-quoted, space-separated list or a single value without double-quotes.  The list can be replaced, added to, deleted from, or disabled by using the =, +=, -=, and ! operators respectively.  The default list of variables to keep is displayed when  <b>sudo</b> is run by root with the <i>-V</i> option.</dd>
</dl>
</div>
</div>
<div class="section">
<h1>FILES</h1><dl>
<dt>
<i>/etc/sudoers</i></dt>
<dd>
List of who can run what</dd>
</dl>
<dl>
<dt>
<i>/etc/group</i></dt>
<dd>
Local groups file</dd>
</dl>
<dl>
<dt>
<i>/etc/netgroup</i></dt>
<dd>
List of network groups</dd>
</dl>
<dl>
<dt>
<i>/var/log/sudo-io</i></dt>
<dd>
I/O log files</dd>
</dl>
<dl>
<dt>
<i>/var/lib/sudo</i></dt>
<dd>
Directory containing time stamps for the <i>sudoers</i> security policy</dd>
</dl>
<dl>
<dt>
<i>/etc/environment</i></dt>
<dd>
Initial environment for <b>-i</b> mode on Linux and AIX</dd>
</dl>
</div>
<div class="section">
<h1>EXAMPLES</h1> Below are example  <i>sudoers</i> entries.  Admittedly, some of these are a bit contrived.  First, we allow a few environment variables to pass and then define our  <i>aliases</i>:<div class="spacer">
</div>
<br/>
 # Run X applications through sudo; HOME is used to find the<br/>
 # .Xauthority file.  Note that other programs use HOME to find<br/>
 # configuration files and this may lead to privilege escalation!<br/>
 Defaults env_keep += &quot;DISPLAY HOME&quot;<br/>
<br/>
 # User alias specification<br/>
 User_Alias     FULLTIMERS = millert, mikef, dowdy<br/>
 User_Alias     PARTTIMERS = bostley, jwfox, crawl<br/>
 User_Alias     WEBMASTERS = will, wendy, wim<br/>
<br/>
 # Runas alias specification<br/>
 Runas_Alias    OP = root, operator<br/>
 Runas_Alias    DB = oracle, sybase<br/>
 Runas_Alias    ADMINGRP = adm, oper<br/>
<br/>
 # Host alias specification<br/>
 Host_Alias     SPARC = bigtime, eclipse, moet, anchor :\<br/>
                SGI = grolsch, dandelion, black :\<br/>
                ALPHA = widget, thalamus, foobar :\<br/>
                HPPA = boa, nag, python<br/>
 Host_Alias     CUNETS = 128.138.0.0/255.255.0.0<br/>
 Host_Alias     CSNETS = 128.138.243.0, 128.138.204.0/24, 128.138.242.0<br/>
 Host_Alias     SERVERS = master, mail, www, ns<br/>
 Host_Alias     CDROM = orion, perseus, hercules<br/>
<br/>
 # Cmnd alias specification<br/>
 Cmnd_Alias     DUMPS = /usr/bin/mt, /usr/sbin/dump, /usr/sbin/rdump,\<br/>
                        /usr/sbin/restore, /usr/sbin/rrestore<br/>
 Cmnd_Alias     KILL = /usr/bin/kill<br/>
 Cmnd_Alias     PRINTING = /usr/sbin/lpc, /usr/bin/lprm<br/>
 Cmnd_Alias     SHUTDOWN = /usr/sbin/shutdown<br/>
 Cmnd_Alias     HALT = /usr/sbin/halt<br/>
 Cmnd_Alias     REBOOT = /usr/sbin/reboot<br/>
 Cmnd_Alias     SHELLS = /usr/bin/sh, /usr/bin/csh, /usr/bin/ksh, \<br/>
                         /usr/local/bin/tcsh, /usr/bin/rsh, \<br/>
                         /usr/local/bin/zsh<br/>
 Cmnd_Alias     SU = /usr/bin/su<br/>
 Cmnd_Alias     PAGERS = /usr/bin/more, /usr/bin/pg, /usr/bin/less<br/>
<div class="spacer">
</div>
Here we override some of the compiled in default values.  We want  <b>sudo</b> to log via <i>syslog</i>(3) using the <i>auth</i> facility in all cases.  We don't want to subject the full time staff to the  <b>sudo</b> lecture, user  <b>millert</b> need not give a password, and we don't want to reset the LOGNAME, USER or USERNAME environment variables when running commands as root.  Additionally, on the machines in the  <i>SERVERS</i> Host_Alias, we keep an additional local log file and make sure we log the year in each log line since the log entries will be kept around for several years.  Lastly, we disable shell escapes for the commands in the PAGERS Cmnd_Alias ( <i>/usr/bin/more</i>, <i>/usr/bin/pg</i> and <i>/usr/bin/less</i>).<div class="spacer">
</div>
<br/>
 # Override built-in defaults<br/>
 Defaults               syslog=auth<br/>
 Defaults&gt;root          !set_logname<br/>
 Defaults:FULLTIMERS    !lecture<br/>
 Defaults:millert       !authenticate<br/>
 Defaults@SERVERS       log_year, logfile=/var/log/sudo.log<br/>
 Defaults!PAGERS        noexec<br/>
<div class="spacer">
</div>
The <i>User specification</i> is the part that actually determines who may run what.<div class="spacer">
</div>
<br/>
 root           ALL = (ALL) ALL<br/>
 %wheel         ALL = (ALL) ALL<br/>
<div class="spacer">
</div>
We let <b>root</b> and any user in group <b>wheel</b> run any command on any host as any user.<div class="spacer">
</div>
<br/>
 FULLTIMERS     ALL = NOPASSWD: ALL<br/>
<div class="spacer">
</div>
Full time sysadmins (<b>millert</b>, <b>mikef</b>, and <b>dowdy</b>) may run any command on any host without authenticating themselves.<div class="spacer">
</div>
<br/>
 PARTTIMERS     ALL = ALL<br/>
<div class="spacer">
</div>
Part time sysadmins (<b>bostley</b>, <b>jwfox</b>, and <b>crawl</b>) may run any command on any host but they must authenticate themselves first (since the entry lacks the NOPASSWD tag).<div class="spacer">
</div>
<br/>
 jack           CSNETS = ALL<br/>
<div class="spacer">
</div>
The user <b>jack</b> may run any command on the machines in the <i>CSNETS</i> alias (the networks 128.138.243.0, 128.138.204.0, and 128.138.242.0). Of those networks, only 128.138.204.0 has an explicit netmask (in CIDR notation) indicating it is a class C network.  For the other networks in  <i>CSNETS</i>, the local machine's netmask will be used during matching.<div class="spacer">
</div>
<br/>
 lisa           CUNETS = ALL<br/>
<div class="spacer">
</div>
The user <b>lisa</b> may run any command on any host in the <i>CUNETS</i> alias (the class B network 128.138.0.0).<div class="spacer">
</div>
<br/>
 operator       ALL = DUMPS, KILL, SHUTDOWN, HALT, REBOOT, PRINTING,\<br/>
                sudoedit /etc/printcap, /usr/oper/bin/<br/>
<div class="spacer">
</div>
The <b>operator</b> user may run commands limited to simple maintenance. Here, those are commands related to backups, killing processes, the printing system, shutting down the system, and any commands in the directory  <i>/usr/oper/bin/</i>.<div class="spacer">
</div>
<br/>
 joe            ALL = /usr/bin/su operator<br/>
<div class="spacer">
</div>
The user <b>joe</b> may only <i>su</i>(1) to operator.<div class="spacer">
</div>
<br/>
 pete           HPPA = /usr/bin/passwd [A-Za-z]*, !/usr/bin/passwd root<br/>
<br/>
 %opers         ALL = (: ADMINGRP) /usr/sbin/<br/>
<div class="spacer">
</div>
Users in the <b>opers</b> group may run commands in <i>/usr/sbin/</i> as themselves with any group in the  <i>ADMINGRP</i> Runas_Alias (the <b>adm</b> and <b>oper</b> groups).<div class="spacer">
</div>
The user <b>pete</b> is allowed to change anyone's password except for root on the  <i>HPPA</i> machines.  Note that this assumes <i>passwd</i>(1) does not take multiple user names on the command line.<div class="spacer">
</div>
<br/>
 bob            SPARC = (OP) ALL : SGI = (OP) ALL<br/>
<div class="spacer">
</div>
The user <b>bob</b> may run anything on the <i>SPARC</i> and <i>SGI</i> machines as any user listed in the  <i>OP</i> Runas_Alias (<b>root</b> and <b>operator</b>).<div class="spacer">
</div>
<br/>
 jim            +biglab = ALL<br/>
<div class="spacer">
</div>
The user <b>jim</b> may run any command on machines in the <i>biglab</i> netgroup.  <b>sudo</b> knows that &quot;biglab&quot; is a netgroup due to the '+' prefix.<div class="spacer">
</div>
<br/>
 +secretaries   ALL = PRINTING, /usr/bin/adduser, /usr/bin/rmuser<br/>
<div class="spacer">
</div>
Users in the <b>secretaries</b> netgroup need to help manage the printers as well as add and remove users, so they are allowed to run those commands on all machines.<div class="spacer">
</div>
<br/>
 fred           ALL = (DB) NOPASSWD: ALL<br/>
<div class="spacer">
</div>
The user <b>fred</b> can run commands as any user in the <i>DB</i> Runas_Alias ( <b>oracle</b> or <b>sybase</b>) without giving a password.<div class="spacer">
</div>
<br/>
 john           ALPHA = /usr/bin/su [!-]*, !/usr/bin/su *root*<br/>
<div class="spacer">
</div>
On the <i>ALPHA</i> machines, user <b>john</b> may su to anyone except root but he is not allowed to specify any options to the  <i>su</i>(1) command.<div class="spacer">
</div>
<br/>
 jen            ALL, !SERVERS = ALL<br/>
<div class="spacer">
</div>
The user <b>jen</b> may run any command on any machine except for those in the  <i>SERVERS</i> Host_Alias (master, mail, www and ns).<div class="spacer">
</div>
<br/>
 jill           SERVERS = /usr/bin/, !SU, !SHELLS<br/>
<div class="spacer">
</div>
For any machine in the <i>SERVERS</i> Host_Alias, <b>jill</b> may run any commands in the directory  <i>/usr/bin/</i> except for those commands belonging to the  <i>SU</i> and <i>SHELLS</i> Cmnd_Aliases.<div class="spacer">
</div>
<br/>
 steve          CSNETS = (operator) /usr/local/op_commands/<br/>
<div class="spacer">
</div>
The user <b>steve</b> may run any command in the directory /usr/local/op_commands/ but only as user operator.<div class="spacer">
</div>
<br/>
 matt           valkyrie = KILL<br/>
<div class="spacer">
</div>
On his personal workstation, valkyrie, <b>matt</b> needs to be able to kill hung processes.<div class="spacer">
</div>
<br/>
 WEBMASTERS     www = (www) ALL, (root) /usr/bin/su www<br/>
<div class="spacer">
</div>
On the host www, any user in the <i>WEBMASTERS</i> User_Alias (will, wendy, and wim), may run any command as user www (which owns the web pages) or simply  <i>su</i>(1) to www.<div class="spacer">
</div>
<br/>
 ALL            CDROM = NOPASSWD: /sbin/umount /CDROM,\<br/>
                /sbin/mount -o nosuid\,nodev /dev/cd0a /CDROM<br/>
<div class="spacer">
</div>
Any user may mount or unmount a CD-ROM on the machines in the CDROM Host_Alias (orion, perseus, hercules) without entering a password. This is a bit tedious for users to type, so it is a prime candidate for encapsulating in a shell script.</div>
<div class="section">
<h1>SECURITY NOTES</h1> It is generally not effective to &quot;subtract&quot; commands from ALL using the '!' operator.  A user can trivially circumvent this by copying the desired command to a different name and then executing that.  For example:<div class="spacer">
</div>
<br/>
    bill        ALL = ALL, !SU, !SHELLS<br/>
<div class="spacer">
</div>
Doesn't really prevent <b>bill</b> from running the commands listed in  <i>SU</i> or <i>SHELLS</i> since he can simply copy those commands to a different name, or use a shell escape from an editor or other program.  Therefore, these kind of restrictions should be considered advisory at best (and reinforced by policy).<div class="spacer">
</div>
Furthermore, if the <i>fast_glob</i> option is in use, it is not possible to reliably negate commands where the path name includes globbing (aka wildcard) characters.  This is because the C library's  <i>fnmatch</i>(3) function cannot resolve relative paths.  While this is typically only an inconvenience for rules that grant privileges, it can result in a security issue for rules that subtract or revoke privileges.<div class="spacer">
</div>
For example, given the following <i>sudoers</i> entry:<div class="spacer">
</div>
<br/>
 john   ALL = /usr/bin/passwd [a-zA-Z0-9]*, /usr/bin/chsh [a-zA-Z0-9]*,<br/>
      /usr/bin/chfn [a-zA-Z0-9]*, !/usr/bin/* root<br/>
<div class="spacer">
</div>
User <b>john</b> can still run /usr/bin/passwd root if <i>fast_glob</i> is enabled by changing to  <i>/usr/bin</i> and running ./passwd root instead.</div>
<div class="section">
<h1>PREVENTING SHELL ESCAPES</h1> Once  <b>sudo</b> executes a program, that program is free to do whatever it pleases, including run other programs.  This can be a security issue since it is not uncommon for a program to allow shell escapes, which lets a user bypass  <b>sudo</b>'s access control and logging. Common programs that permit shell escapes include shells (obviously), editors, paginators, mail and terminal programs.<div class="spacer">
</div>
There are two basic approaches to this problem:<dl>
<dt>
restrict</dt>
<dd>
Avoid giving users access to commands that allow the user to run arbitrary commands.  Many editors have a restricted mode where shell escapes are disabled, though  <b>sudoedit</b> is a better solution to running editors via  <b>sudo</b>.  Due to the large number of programs that offer shell escapes, restricting users to the set of programs that do not is often unworkable.</dd>
</dl>
<dl>
<dt>
noexec</dt>
<dd>
Many systems that support shared libraries have the ability to override default library functions by pointing an environment variable (usually LD_PRELOAD) to an alternate shared library. On such systems,  <b>sudo</b>'s <i>noexec</i> functionality can be used to prevent a program run by  <b>sudo</b> from executing any other programs. Note, however, that this applies only to native dynamically-linked executables.  Statically-linked executables and foreign executables running under binary emulation are not affected.<div style="height: 1.00em;">
&#160;</div>
The <i>noexec</i> feature is known to work on SunOS, Solaris, *BSD, Linux, IRIX, Tru64 UNIX, MacOS X, HP-UX 11.x and AIX 5.3 and above. It should be supported on most operating systems that support the LD_PRELOAD environment variable.  Check your operating system's manual pages for the dynamic linker (usually ld.so, ld.so.1, dyld, dld.sl, rld, or loader) to see if LD_PRELOAD is supported.<div style="height: 1.00em;">
&#160;</div>
On Solaris 10 and higher, <i>noexec</i> uses Solaris privileges instead of the LD_PRELOAD environment variable.<div style="height: 1.00em;">
&#160;</div>
To enable <i>noexec</i> for a command, use the NOEXEC tag as documented in the User Specification section above.  Here is that example again:<div style="height: 1.00em;">
&#160;</div>
<br/>
 aaron  shanty = NOEXEC: /usr/bin/more, /usr/bin/vi<br/>
<div style="height: 1.00em;">
&#160;</div>
This allows user <b>aaron</b> to run <i>/usr/bin/more</i> and <i>/usr/bin/vi</i> with  <i>noexec</i> enabled.  This will prevent those two commands from executing other commands (such as a shell).  If you are unsure whether or not your system is capable of supporting  <i>noexec</i> you can always just try it out and check whether shell escapes work when  <i>noexec</i> is enabled.</dd>
</dl>
<div class="spacer">
</div>
Note that restricting shell escapes is not a panacea.  Programs running as root are still capable of many potentially hazardous operations (such as changing or overwriting files) that could lead to unintended privilege escalation.  In the specific case of an editor, a safer approach is to give the user permission to run  <b>sudoedit</b>.</div>
<div class="section">
<h1>SECURITY NOTES</h1>  <i>sudoers</i> will check the ownership of its time stamp directory ( <i>/var/lib/sudo</i> by default) and ignore the directory's contents if it is not owned by root or if it is writable by a user other than root.  On systems that allow non-root users to give away files via  <i>chown</i>(2), if the time stamp directory is located in a world-writable directory (e.g.,  <i>/tmp</i>), it is possible for a user to create the time stamp directory before  <b>sudo</b> is run.  However, because  <i>sudoers</i> checks the ownership and mode of the directory and its contents, the only damage that can be done is to &quot;hide&quot; files by putting them in the time stamp dir.  This is unlikely to happen since once the time stamp dir is owned by root and inaccessible by any other user, the user placing files there would be unable to get them back out.<div class="spacer">
</div>
<i>sudoers</i> will not honor time stamps set far in the future.  Time stamps with a date greater than current_time + 2 * TIMEOUT will be ignored and sudo will log and complain.  This is done to keep a user from creating his/her own time stamp with a bogus date on systems that allow users to give away files if the time stamp directory is located in a world-writable directory.<div class="spacer">
</div>
On systems where the boot time is available, <i>sudoers</i> will ignore time stamps that date from before the machine booted.<div class="spacer">
</div>
Since time stamp files live in the file system, they can outlive a user's login session.  As a result, a user may be able to login, run a command with  <b>sudo</b> after authenticating, logout, login again, and run  <b>sudo</b> without authenticating so long as the time stamp file's modification time is within 15 minutes (or whatever the timeout is set to in  <i>sudoers</i>).  When the <i>tty_tickets</i> option is enabled, the time stamp has per-tty granularity but still may outlive the user's session.  On Linux systems where the devpts filesystem is used, Solaris systems with the devices filesystem, as well as other systems that utilize a devfs filesystem that monotonically increase the inode number of devices as they are created (such as Mac OS X),  <i>sudoers</i> is able to determine when a tty-based time stamp file is stale and will ignore it.  Administrators should not rely on this feature as it is not universally available.<div class="spacer">
</div>
If users have sudo ALL there is nothing to prevent them from creating their own program that gives them a root shell (or making their own copy of a shell) regardless of any '!' elements in the user specification.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>rsh</i>(1), <i>su</i>(1), <i>fnmatch</i>(3), <i>glob</i>(3), <i>mktemp</i>(3), <i>strftime</i>(3),  <i>sudoers.ldap</i>(5), <i>sudo_plugin</i>(8), <i>sudo</i>(8), <i>visudo</i>(8)</div>
<div class="section">
<h1>CAVEATS</h1> The  <i>sudoers</i> file should <b>always</b> be edited by the <b>visudo</b> command which locks the file and does grammatical checking. It is imperative that  <i>sudoers</i> be free of syntax errors since <b>sudo</b> will not run with a syntactically incorrect  <i>sudoers</i> file.<div class="spacer">
</div>
When using netgroups of machines (as opposed to users), if you store fully qualified host name in the netgroup (as is usually the case), you either need to have the machine's host name be fully qualified as returned by the hostname command or use the  <i>fqdn</i> option in  <i>sudoers</i>.</div>
<div class="section">
<h1>BUGS</h1> If you feel you have found a bug in  <b>sudo</b>, please submit a bug report at http://www.sudo.ws/sudo/bugs/</div>
<div class="section">
<h1>SUPPORT</h1> Limited free support is available via the sudo-users mailing list, see http://www.sudo.ws/mailman/listinfo/sudo-users to subscribe or search the archives.</div>
<div class="section">
<h1>DISCLAIMER</h1>  <b>sudo</b> is provided ``AS IS'' and any express or implied warranties, including, but not limited to, the implied warranties of merchantability and fitness for a particular purpose are disclaimed.  See the LICENSE file distributed with  <b>sudo</b> or http://www.sudo.ws/sudo/license.html for complete details.</div>
<table class="foot">
<tr>
<td class="foot-date">
September 16, 2011</td>
<td class="foot-os">
1.8.3</td>
</tr>
</table>
</div>
</body>
</html>

