<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
PAM.CONF(5)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
PAM.CONF(5)</td>
<td class="head-vol">
Linux-PAM Manual</td>
<td class="head-rtitle">
PAM.CONF(5)</td>
</tr>
</tbody>
</table>
<br/>
<br/>
$*<div style="height: 0.00em;">
&#160;</div>
pam.conf, pam.d - PAM configuration files<div style="height: 0.00ex;">
&#160;</div>
<br/>
<br/>
$*<div style="height: 0.00em;">
&#160;</div>
<div class="spacer">
</div>
When a  <i>PAM</i> aware privilege granting application is started, it activates its attachment to the PAM-API. This activation performs a number of tasks, the most important being the reading of the configuration file(s): /etc/pam.conf. Alternatively, this may be the contents of the /etc/pam.d/ directory. The presence of this directory will cause Linux-PAM to ignore /etc/pam.conf.<div class="spacer">
</div>
These files list the  <i>PAM</i>s that will do the authentication tasks required by this service, and the appropriate behavior of the PAM-API in the event that individual  <i>PAM</i>s fail.<div class="spacer">
</div>
The syntax of the /etc/pam.conf configuration file is as follows. The file is made up of a list of rules, each rule is typically placed on a single line, but may be extended with an escaped end of line: `\&lt;LF&gt;&#180;. Comments are preceded with `#&#180; marks and extend to the next end of line.<div class="spacer">
</div>
The format of each rule is a space separated collection of tokens, the first three being case-insensitive:<div class="spacer">
</div>
<div style="height: 1.00em;">
&#160;</div>
<b> service type control module-path module-arguments</b><div class="spacer">
</div>
The syntax of files contained in the /etc/pam.d/ directory, are identical except for the absence of any  <i>service</i> field. In this case, the  <i>service</i> is the name of the file in the /etc/pam.d/ directory. This filename must be in lower case.<div class="spacer">
</div>
An important feature of  <i>PAM</i>, is that a number of rules may be  <i>stacked</i> to combine the services of a number of PAMs for a given authentication task.<div class="spacer">
</div>
The  <i>service</i> is typically the familiar name of the corresponding application:  <i>login</i> and  <i>su</i> are good examples. The  <i>service</i>-name,  <i>other</i>, is reserved for giving  <i>default</i> rules. Only lines that mention the current service (or in the absence of such, the  <i>other</i> entries) will be associated with the given service-application.<div class="spacer">
</div>
The  <i>type</i> is the management group that the rule corresponds to. It is used to specify which of the management groups the subsequent module is to be associated with. Valid entries are:<div class="spacer">
</div>
account<div style="margin-left: 4.00ex;">
this module type performs non-authentication based account management. It is typically used to restrict/permit access to a service based on the time of day, currently available system resources (maximum number of users) or perhaps the location of the applicant user -- &#180;root&#180; login only on the console.</div>
<div class="spacer">
</div>
auth<div style="margin-left: 4.00ex;">
this module type provides two aspects of authenticating the user. Firstly, it establishes that the user is who they claim to be, by instructing the application to prompt the user for a password or other means of identification. Secondly, the module can grant group membership or other privileges through its credential granting properties.</div>
<div class="spacer">
</div>
password<div style="margin-left: 4.00ex;">
this module type is required for updating the authentication token associated with the user. Typically, there is one module for each &#180;challenge/response&#180; based authentication (auth) type.</div>
<div class="spacer">
</div>
session<div style="margin-left: 4.00ex;">
this module type is associated with doing things that need to be done for the user before/after they can be given service. Such things include the logging of information concerning the opening/closing of some data exchange with a user, mounting directories, etc.</div>
<div class="spacer">
</div>
If the  <i>type</i> value from the list above is prepended with a  <i>-</i> character the PAM library will not log to the system log if it is not possible to load the module because it is missing in the system. This can be useful especially for modules which are not always installed on the system and are not required for correct authentication and authorization of the login session.<div class="spacer">
</div>
The third field,  <i>control</i>, indicates the behavior of the PAM-API should the module fail to succeed in its authentication task. There are two types of syntax for this control field: the simple one has a single simple keyword; the more complicated one involves a square-bracketed selection of  <i>value=action</i> pairs.<div class="spacer">
</div>
For the simple (historical) syntax valid  <i>control</i> values are:<div class="spacer">
</div>
required<div style="margin-left: 4.00ex;">
failure of such a PAM will ultimately lead to the PAM-API returning failure but only after the remaining  <i>stacked</i> modules (for this  <i>service</i> and  <i>type</i>) have been invoked.</div>
<div class="spacer">
</div>
requisite<div style="margin-left: 4.00ex;">
like  <i>required</i>, however, in the case that such a module returns a failure, control is directly returned to the application. The return value is that associated with the first required or requisite module to fail. Note, this flag can be used to protect against the possibility of a user getting the opportunity to enter a password over an unsafe medium. It is conceivable that such behavior might inform an attacker of valid accounts on a system. This possibility should be weighed against the not insignificant concerns of exposing a sensitive password in a hostile environment.</div>
<div class="spacer">
</div>
sufficient<div style="margin-left: 4.00ex;">
success of such a module is enough to satisfy the authentication requirements of the stack of modules (if a prior  <i>required</i> module has failed the success of this one is  <i>ignored</i>). A failure of this module is not deemed as fatal to satisfying the application that this type has succeeded. If the module succeeds the PAM framework returns success to the application immediately without trying any other modules.</div>
<div class="spacer">
</div>
optional<div style="margin-left: 4.00ex;">
the success or failure of this module is only important if it is the only module in the stack associated with this  <i>service</i>+<i>type</i>.</div>
<div class="spacer">
</div>
include<div style="margin-left: 4.00ex;">
include all lines of given type from the configuration file specified as an argument to this control.</div>
<div class="spacer">
</div>
substack<div style="margin-left: 4.00ex;">
include all lines of given type from the configuration file specified as an argument to this control. This differs from  <i>include</i> in that evaluation of the  <i>done</i> and  <i>die</i> actions in a substack does not cause skipping the rest of the complete module stack, but only of the substack. Jumps in a substack also can not make evaluation jump out of it, and the whole substack is counted as one module when the jump is done in a parent stack. The  <i>reset</i> action will reset the state of a module stack to the state it was in as of beginning of the substack evaluation.</div>
<div class="spacer">
</div>
For the more complicated syntax valid  <i>control</i> values have the following form:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
<div style="height: -1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
      [value1=action1 value2=action2 ...]<br/>
    <br/>
</div>
<div class="spacer">
</div>
Where  <i>valueN</i> corresponds to the return code from the function invoked in the module for which the line is defined. It is selected from one of these:  <i>success</i>,  <i>open_err</i>,  <i>symbol_err</i>,  <i>service_err</i>,  <i>system_err</i>,  <i>buf_err</i>,  <i>perm_denied</i>,  <i>auth_err</i>,  <i>cred_insufficient</i>,  <i>authinfo_unavail</i>,  <i>user_unknown</i>,  <i>maxtries</i>,  <i>new_authtok_reqd</i>,  <i>acct_expired</i>,  <i>session_err</i>,  <i>cred_unavail</i>,  <i>cred_expired</i>,  <i>cred_err</i>,  <i>no_module_data</i>,  <i>conv_err</i>,  <i>authtok_err</i>,  <i>authtok_recover_err</i>,  <i>authtok_lock_busy</i>,  <i>authtok_disable_aging</i>,  <i>try_again</i>,  <i>ignore</i>,  <i>abort</i>,  <i>authtok_expired</i>,  <i>module_unknown</i>,  <i>bad_item</i>,  <i>conv_again</i>,  <i>incomplete</i>, and  <i>default</i>.<div class="spacer">
</div>
The last of these,  <i>default</i>, implies &#180;all  <i>valueN</i>&#180;s not mentioned explicitly. Note, the full list of PAM errors is available in /usr/include/security/_pam_types.h. The  <i>actionN</i> can take one of the following forms:<div class="spacer">
</div>
ignore<div style="margin-left: 4.00ex;">
when used with a stack of modules, the module&#180;s return status will not contribute to the return code the application obtains.</div>
<div class="spacer">
</div>
bad<div style="margin-left: 4.00ex;">
this action indicates that the return code should be thought of as indicative of the module failing. If this module is the first in the stack to fail, its status value will be used for that of the whole stack.</div>
<div class="spacer">
</div>
die<div style="margin-left: 4.00ex;">
equivalent to bad with the side effect of terminating the module stack and PAM immediately returning to the application.</div>
<div class="spacer">
</div>
ok<div style="margin-left: 4.00ex;">
this tells PAM that the administrator thinks this return code should contribute directly to the return code of the full stack of modules. In other words, if the former state of the stack would lead to a return of  <i>PAM_SUCCESS</i>, the module&#180;s return code will override this value. Note, if the former state of the stack holds some value that is indicative of a modules failure, this &#180;ok&#180; value will not be used to override that value.</div>
<div class="spacer">
</div>
done<div style="margin-left: 4.00ex;">
equivalent to ok with the side effect of terminating the module stack and PAM immediately returning to the application.</div>
<div class="spacer">
</div>
N (an unsigned integer)<div style="margin-left: 4.00ex;">
equivalent to ok with the side effect of jumping over the next N modules in the stack. Note that N equal to 0 is not allowed (and it would be identical to ok in such case).</div>
<div class="spacer">
</div>
reset<div style="margin-left: 4.00ex;">
clear all memory of the state of the module stack and start again with the next stacked module.</div>
<div class="spacer">
</div>
Each of the four keywords: required; requisite; sufficient; and optional, have an equivalent expression in terms of the [...] syntax. They are as follows:<div class="spacer">
</div>
required<div style="margin-left: 4.00ex;">
[success=ok new_authtok_reqd=ok ignore=ignore default=bad]</div>
<div class="spacer">
</div>
requisite<div style="margin-left: 4.00ex;">
[success=ok new_authtok_reqd=ok ignore=ignore default=die]</div>
<div class="spacer">
</div>
sufficient<div style="margin-left: 4.00ex;">
[success=done new_authtok_reqd=done default=ignore]</div>
<div class="spacer">
</div>
optional<div style="margin-left: 4.00ex;">
[success=ok new_authtok_reqd=ok default=ignore]</div>
<div class="spacer">
</div>
<div style="height: 1.00em;">
&#160;</div>
<i>module-path</i> is either the full filename of the PAM to be used by the application (it begins with a &#180;/&#180;), or a relative pathname from the default module location: /lib/security/ or /lib64/security/, depending on the architecture.<div class="spacer">
</div>
<div style="height: 1.00em;">
&#160;</div>
<i>module-arguments</i> are a space separated list of tokens that can be used to modify the specific behavior of the given PAM. Such arguments will be documented for each individual module. Note, if you wish to include spaces in an argument, you should surround that argument with square brackets.<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
<div style="height: -1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
    squid auth required pam_mysql.so user=passwd_query passwd=mada \<br/>
          db=eminence [query=select user_name from internet_service \<br/>
          where user_name=&#180;%u&#180; and password=PASSWORD(&#180;%p&#180;) and \<br/>
        service=&#180;web_proxy&#180;]<br/>
    <br/>
</div>
<div class="spacer">
</div>
When using this convention, you can include `[&#180; characters inside the string, and if you wish to include a `]&#180; character inside the string that will survive the argument parsing, you should use `\]&#180;. In other words:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
<div style="height: -1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
    [..[..\]..]    --&gt;   ..[..]..<br/>
    <br/>
</div>
<div class="spacer">
</div>
Any line in (one of) the configuration file(s), that is not formatted correctly, will generally tend (erring on the side of caution) to make the authentication process fail. A corresponding error is written to the system log files with a call to  <b>syslog</b>(3).<div class="spacer">
</div>
More flexible than the single configuration file is it to configure libpam via the contents of the /etc/pam.d/ directory. In this case the directory is filled with files each of which has a filename equal to a service-name (in lower-case): it is the personal configuration file for the named service.<div class="spacer">
</div>
The syntax of each file in /etc/pam.d/ is similar to that of the /etc/pam.conf file and is made up of lines of the following form:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
<div style="height: -1.00em;">
&#160;</div>
<div class="spacer">
</div>
<br/>
type  control  module-path  module-arguments<br/>
    <br/>
</div>
<div class="spacer">
</div>
The only difference being that the service-name is not present. The service-name is of course the name of the given configuration file. For example, /etc/pam.d/login contains the configuration for the  <b>login</b> service.<div style="height: 0.00ex;">
&#160;</div>
<br/>
<br/>
$*<div style="height: 0.00em;">
&#160;</div>
<div class="spacer">
</div>
<div style="height: 1.00em;">
&#160;</div>
<b>pam</b>(3),  <b>PAM</b>(8),  <b>pam_start</b>(3)<table class="foot">
<tr>
<td class="foot-date">
10/27/2010</td>
<td class="foot-os">
Linux-PAM Manual</td>
</tr>
</table>
</div>
</body>
</html>

