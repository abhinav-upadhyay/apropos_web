<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
OPENSSL-VULNKEY(1)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">openssl-vulnkey</b> &#8212; <span class="desc">check blacklist of compromised certificates, requests and keys</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 15.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl-vulnkey</td>
<td>
[<span class="opt"><b class="flag">-q</b></span>] <i class="arg">file ...</i></td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 15.00ex;"/>
<col/>
<tbody>
<tr>
<td>
openssl-vulnkey</td>
<td>
[<span class="opt"><b class="flag">-q</b></span>] <b class="flag">-b</b> <i class="arg">BITS</i> <b class="flag">-m</b> <i class="arg">MODULUS</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">openssl-vulnkey</b> checks a certificate, request or key against a blacklist of compromised moduli.<div class="spacer">
</div>
A substantial number of certificates, requests and keys are known to have been generated using a broken version of OpenSSL distributed by Debian which failed to seed its random number generator correctly.  x509 certificates, certificate requests and RSA keys generated using these OpenSSL versions should be assumed to be compromised.  This tool may be useful in checking for such OpenSSL x509 certificates, certificate requests and RSA keys.<div class="spacer">
</div>
Certificates, requests and keys that are compromised cannot be repaired; replacements must be generated using <a class="link-man" href="/man/linux/8/openssl">openssl(8)</a>.<div class="spacer">
</div>
If &#8220;-&#8221; is given as an argument, <b class="name">openssl-vulnkey</b> will read from standard input. This can be used to process certificate output from <a class="link-man" href="/man/linux/1ssl/s_client">s_client(1ssl)</a>, for example:<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ echo | openssl s_client -connect remote.example.org:https | openssl-vulnkey -</code></div>
</blockquote>
<div class="spacer">
</div>
will test the certificate used by remote.example.org for HTTPS.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-q</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Quiet mode. Normally, <b class="name">openssl-vulnkey</b> outputs the fingerprint of each file scanned, with a description of its status. This option suppresses that output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-b</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Number of bits for the modulus specified.  Requires -m.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-m</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Check modulus.  Requires -b.</dd>
</dl>
</div>
<div class="section">
<h1 id="x424c41434b4c495354205348413153554d20464f524d4154">BLACKLIST SHA1SUM FORMAT</h1> The blacklist file may start with comments, on lines starting with &#8220;#&#8221;. After these initial comments, it must follow a strict format:<div class="spacer">
</div>
<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 6.00ex;" class="list list-bul">
<li class="list-bul" style="margin-top: 0.00em;">
Each line must consist of the lower-case hexadecimal SHA1 fingerprint of the certificate or key's modulus, and with the first 20 characters removed (that is, the least significant 80 bits of the fingerprint).</li>
</ul>
<div class="spacer">
</div>
The fingerprint of the modulus may be generated using<div class="spacer">
</div>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl x509 -noout -modulus -in file | sha1sum | cut -d ' ' -f 1</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl rsa -noout -modulus -in file | sha1sum | cut -d ' ' -f 1</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">$ openssl req -noout -modulus -in file | sha1sum | cut -d ' ' -f 1</code></div>
</blockquote>
<div class="spacer">
</div>
This strict format is necessary to allow the blacklist file to be checked quickly.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="/man/linux/1/openssl">openssl(1)</a></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Jamie Strandboge</span> &#10216;jamie@ubuntu.com&#10217;<div class="spacer">
</div>
Much of this manpage is based on Colin Watson's <a class="link-man" href="/man/linux/1/ssh-vulnkey">ssh-vulnkey(1)</a></div>
</div>
</body>
</html>

