<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
PERL591DELTA(1)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
PERL591DELTA(1)</td>
<td class="head-vol">
Perl Programmers Reference Guide</td>
<td class="head-rtitle">
PERL591DELTA(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> perl591delta - what is new for perl v5.9.1</div>
<div class="section">
<h1>DESCRIPTION</h1> This document describes differences between the 5.9.0 and the 5.9.1 development releases. See perl590delta for the differences between 5.8.0 and 5.9.0.</div>
<div class="section">
<h1>Incompatible Changes</h1><div class="subsection">
<h2><i>substr()</i> lvalues are no longer fixed-length</h2> The lvalues returned by the three argument form of  <i>substr()</i> used to be a &quot;fixed length window&quot; on the original string. In some cases this could cause surprising action at distance or other undefined behaviour. Now the length of the window adjusts itself to the length of the string assigned to it.</div>
<div class="subsection">
<h2>The &quot;:unique&quot; attribute is only meaningful for globals</h2> Now applying &quot;:unique&quot; to lexical variables and to subroutines will result in a compilation error.</div>
</div>
<div class="section">
<h1>Core Enhancements</h1><div class="subsection">
<h2>Lexical $_</h2> The default variable $_ can now be lexicalized, by declaring it like any other lexical variable, with a simple<div class="spacer">
</div>
<br/>
    my $_;<br/>
<div class="spacer">
</div>
The operations that default on $_ will use the lexically-scoped version of $_ when it exists, instead of the global $_.<div class="spacer">
</div>
In a &quot;map&quot; or a &quot;grep&quot; block, if $_ was previously my'ed, then the $_ inside the block is lexical as well (and scoped to the block).<div class="spacer">
</div>
In a scope where $_ has been lexicalized, you can still have access to the global version of $_ by using $::_, or, more simply, by overriding the lexical declaration with &quot;our $_&quot;.</div>
<div class="subsection">
<h2>Tied hashes in scalar context</h2> As of perl 5.8.2/5.9.0, tied hashes did not return anything useful in scalar context, for example when used as boolean tests:<div class="spacer">
</div>
<br/>
        if (%tied_hash) { ... }<br/>
<div class="spacer">
</div>
The old nonsensical behaviour was always to return false, regardless of whether the hash is empty or has elements.<div class="spacer">
</div>
There is now an interface for the implementors of tied hashes to implement the behaviour of a hash in scalar context, via the SCALAR method (see perltie).  Without a SCALAR method, perl will try to guess whether the hash is empty, by testing if it's inside an iteration (in this case it can't be empty) or by calling FIRSTKEY.</div>
<div class="subsection">
<h2>Formats</h2> Formats were improved in several ways. A new field, &quot;^*&quot;, can be used for variable-width, one-line-at-a-time text. Null characters are now handled correctly in picture lines. Using &quot;@#&quot; and &quot;~~&quot; together will now produce a compile-time error, as those format fields are incompatible. perlform has been improved, and miscellaneous bugs fixed.</div>
<div class="subsection">
<h2>Stacked filetest operators</h2> As a new form of syntactic sugar, it's now possible to stack up filetest operators. You can now write &quot;-f -w -x $file&quot; in a row to mean &quot;-x $file &amp;&amp; -w _ &amp;&amp; -f _&quot;. See &quot;-X&quot; in perlfunc.</div>
</div>
<div class="section">
<h1>Modules and Pragmata</h1><dl>
<dt>
Benchmark</dt>
<dd>
In &quot;Benchmark&quot;, <i>cmpthese()</i> and <i>timestr()</i> now use the time statistics of children instead of parent when the selected style is 'nop'.</dd>
</dl>
<dl>
<dt>
Carp</dt>
<dd>
The error messages produced by &quot;Carp&quot; now include spaces between the arguments in function argument lists: this makes long error messages appear more nicely in browsers and other tools.</dd>
</dl>
<dl>
<dt>
Exporter</dt>
<dd>
&quot;Exporter&quot; will now recognize grouping tags (such as &quot;:name&quot;) anywhere in the import list, not only at the beginning.</dd>
</dl>
<dl>
<dt>
FindBin</dt>
<dd>
A function &quot;again&quot; is provided to resolve problems where modules in different directories wish to use FindBin.</dd>
</dl>
<dl>
<dt>
List::Util</dt>
<dd>
You can now weaken references to read only values.</dd>
</dl>
<dl>
<dt>
threads::shared</dt>
<dd>
&quot;cond_wait&quot; has a new two argument form. &quot;cond_timedwait&quot; has been added.</dd>
</dl>
</div>
<div class="section">
<h1>Utility Changes</h1> &quot;find2perl&quot; now assumes &quot;-print&quot; as a default action. Previously, it needed to be specified explicitly.<div class="spacer">
</div>
A new utility, &quot;prove&quot;, makes it easy to run an individual regression test at the command line. &quot;prove&quot; is part of Test::Harness, which users of earlier Perl versions can install from CPAN.<div class="spacer">
</div>
The perl debugger now supports a &quot;save&quot; command, to save the current history to a file, and an &quot;i&quot; command, which prints the inheritance tree of its argument (if the &quot;Class::ISA&quot; module is installed.)</div>
<div class="section">
<h1>Documentation</h1> The documentation has been revised in places to produce more standard manpages.<div class="spacer">
</div>
The long-existing feature of &quot;/(?{...})/&quot; regexps setting $_ and <i>pos()</i> is now documented.</div>
<div class="section">
<h1>Performance Enhancements</h1> Sorting arrays in place (&quot;@a = sort @a&quot;) is now optimized to avoid making a temporary copy of the array.<div class="spacer">
</div>
The operations involving case mapping on UTF-8 strings (<i>uc()</i>, <i>lc()</i>, &quot;//i&quot;, etc.) have been greatly speeded up.<div class="spacer">
</div>
Access to elements of lexical arrays via a numeric constant between 0 and 255 is now faster. (This used to be only the case for global arrays.)</div>
<div class="section">
<h1>Selected Bug Fixes</h1><div class="subsection">
<h2>UTF-8 bugs</h2> Using  <i>substr()</i> on a UTF-8 string could cause subsequent accesses on that string to return garbage. This was due to incorrect UTF-8 offsets being cached, and is now fixed.<div class="spacer">
</div>
<i>join()</i> could return garbage when the same <i>join()</i> statement was used to process 8 bit data having earlier processed UTF-8 data, due to the flags on that statement's temporary workspace not being reset correctly. This is now fixed.<div class="spacer">
</div>
Using Unicode keys with tied hashes should now work correctly.<div class="spacer">
</div>
<i>chop()</i> and <i>chomp()</i> used to mangle UTF-8 strings.  This has been fixed.<div class="spacer">
</div>
<i>sprintf()</i> used to misbehave when the format string was in UTF-8. This is now fixed.</div>
<div class="subsection">
<h2>Threading bugs</h2> Hashes with the &quot;:unique&quot; attribute weren't made read-only in new threads. They are now.</div>
<div class="subsection">
<h2>More bugs</h2> &quot;$a .. $b&quot; will now work as expected when either $a or $b is &quot;undef&quot;.<div class="spacer">
</div>
Reading $^E now preserves $!. Previously, the C code implementing $^E did not preserve &quot;errno&quot;, so reading $^E could cause &quot;errno&quot; and therefore $! to change unexpectedly.<div class="spacer">
</div>
&quot;strict&quot; wasn't in effect in regexp-eval blocks (&quot;/(?{...})/&quot;).</div>
</div>
<div class="section">
<h1>New or Changed Diagnostics</h1> A new deprecation warning,  <i>Deprecated use of </i><i>my()</i><i> in false conditional</i>, has been added, to warn against the use of the dubious and deprecated construct<div class="spacer">
</div>
<br/>
    my $x if 0;<br/>
<div class="spacer">
</div>
See perldiag.<div class="spacer">
</div>
The fatal error <i>DESTROY created new reference to dead object</i> is now documented in perldiag.<div class="spacer">
</div>
A new error, <i></i><i>%ENV</i><i> is aliased to </i><i>%s</i><i></i>, is produced when taint checks are enabled and when *ENV has been aliased (and thus doesn't reflect the program's environment anymore.)</div>
<div class="section">
<h1>Changed Internals</h1> These news matter to you only if you either write XS code or like to know about or hack Perl internals (using Devel::Peek or any of the &quot;B::&quot; modules counts), or like to run Perl with the &quot;-D&quot; option.<div class="subsection">
<h2>Reordering of SVt_* constants</h2> The relative ordering of constants that define the various types of &quot;SV&quot; have changed; in particular, &quot;SVt_PVGV&quot; has been moved before &quot;SVt_PVLV&quot;, &quot;SVt_PVAV&quot;, &quot;SVt_PVHV&quot; and &quot;SVt_PVCV&quot;.  This is unlikely to make any difference unless you have code that explicitly makes assumptions about that ordering. (The inheritance hierarchy of &quot;B::*&quot; objects has been changed to reflect this.)</div>
<div class="subsection">
<h2>Removal of CPP symbols</h2> The C preprocessor symbols &quot;PERL_PM_APIVERSION&quot; and &quot;PERL_XS_APIVERSION&quot;, which were supposed to give the version number of the oldest perl binary-compatible (resp. source-compatible) with the present one, were not used, and sometimes had misleading values. They have been removed.</div>
<div class="subsection">
<h2>Less space is used by ops</h2> The &quot;BASEOP&quot; structure now uses less space. The &quot;op_seq&quot; field has been removed and replaced by two one-bit fields, &quot;op_opt&quot; and &quot;op_static&quot;. &quot;opt_type&quot; is now 9 bits long. (Consequently, the &quot;B::OP&quot; class doesn't provide an &quot;seq&quot; method anymore.)</div>
<div class="subsection">
<h2>New parser</h2> perl's parser is now generated by bison (it used to be generated by byacc.) As a result, it seems to be a bit more robust.</div>
</div>
<div class="section">
<h1>Configuration and Building</h1> &quot;Configure&quot; now invokes callbacks regardless of the value of the variable they are called for. Previously callbacks were only invoked in the &quot;case $variable $define)&quot; branch. This change should only affect platform maintainers writing configuration hints files.<div class="spacer">
</div>
The portability and cleanliness of the Win32 makefiles has been improved.</div>
<div class="section">
<h1>Known Problems</h1> There are still a couple of problems in the implementation of the lexical $_: it doesn't work inside &quot;/(?{...})/&quot; blocks and with regard to the  <i>reverse()</i> built-in used without arguments. (See the TODO tests in  <i>t/op/mydef.t</i>.)<div class="subsection">
<h2>Platform Specific Problems</h2> The test  <i>ext/IPC/SysV/t/ipcsysv.t</i> may fail on OpenBSD. This hasn't been diagnosed yet.<div class="spacer">
</div>
On some configurations on AIX 5, one test in <i>lib/Time/Local.t</i> fails. When configured with long doubles, perl may fail tests 224-236 in  <i>t/op/pow.t</i> on the same platform.<div class="spacer">
</div>
For threaded builds, <i>ext/threads/shared/t/wait.t</i> has been reported to fail some tests on HP-UX 10.20.</div>
</div>
<div class="section">
<h1>To-do for perl 5.10.0</h1> This is a non-exhaustive, non-ordered, non-contractual and non-definitive list of things to do (or nice to have) for perl 5.10.0 :<div class="spacer">
</div>
Clean up and finish support for assertions. See assertions.<div class="spacer">
</div>
Reimplement the mechanism of lexical pragmas to be more extensible. Fix current pragmas that don't work well (or at all) with lexical scopes or in run-time eval(STRING) (&quot;sort&quot;, &quot;re&quot;, &quot;encoding&quot; for example). MJD has a preliminary patch that implements this.<div class="spacer">
</div>
Fix (or rewrite) the implementation of the &quot;/(?{...})/&quot; closures.<div class="spacer">
</div>
Conversions from byte strings to UTF-8 currently map high bit characters to Unicode without translation (or, depending on how you look at it, by implicitly assuming that the byte strings are in Latin-1). As perl assumes the C locale by default, upgrading a string to UTF-8 may change the meaning of its contents regarding character classes, case mapping, etc. This should probably emit a warning (at least).<div class="spacer">
</div>
Introduce a new special block, UNITCHECK, which is run at the end of a compilation unit (module, file, eval(STRING) block). This will correspond to the Perl 6 CHECK. Perl 5's CHECK cannot be changed or removed because the O.pm/B.pm backend framework depends on it.<div class="spacer">
</div>
Study the possibility of adding a new prototype character, &quot;_&quot;, meaning &quot;this argument defaults to $_&quot;.<div class="spacer">
</div>
Make the peephole optimizer optional.<div class="spacer">
</div>
Allow lexical aliases (maybe via the syntax &quot;my \$alias = \$foo&quot;.<div class="spacer">
</div>
Fix the bugs revealed by running the test suite with the &quot;-t&quot; switch (via &quot;make test.taintwarn&quot;).<div class="spacer">
</div>
Make threads more robust.<div class="spacer">
</div>
Make &quot;no 6&quot; and &quot;no v6&quot; work (opposite of &quot;use 5.005&quot;, etc.).<div class="spacer">
</div>
A test suite for the B module would be nice.<div class="spacer">
</div>
A ponie.</div>
<div class="section">
<h1>Reporting Bugs</h1> If you find what you think is a bug, you might check the articles recently posted to the comp.lang.perl.misc newsgroup and the perl bug database at http://bugs.perl.org/ .  There may also be information at http://www.perl.org/ , the Perl Home Page.<div class="spacer">
</div>
If you believe you have an unreported bug, please run the <b>perlbug</b> program included with your release.  Be sure to trim your bug down to a tiny but sufficient test case.  Your bug report, along with the output of &quot;perl -V&quot;, will be sent off to perlbug@perl.org to be analysed by the Perl porting team.</div>
<div class="section">
<h1>SEE ALSO</h1> The  <i>Changes</i> file for exhaustive details on what changed.<div class="spacer">
</div>
The <i>INSTALL</i> file for how to build Perl.<div class="spacer">
</div>
The <i>README</i> file for general stuff.<div class="spacer">
</div>
The <i>Artistic</i> and <i>Copying</i> files for copyright information.</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-09-26</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

