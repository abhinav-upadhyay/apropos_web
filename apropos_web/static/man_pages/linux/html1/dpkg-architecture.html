<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
dpkg-architecture(1)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
dpkg-architecture(1)</td>
<td class="head-vol">
dpkg utilities</td>
<td class="head-rtitle">
dpkg-architecture(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> dpkg-architecture - set and determine the architecture for package building</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>dpkg-architecture</b> [<i>option</i>...] [<i>command</i>]</div>
<div class="section">
<h1>DESCRIPTION</h1> dpkg-architecture does provide a facility to determine and set the build and host architecture for package building.<div class="spacer">
</div>
The build architecture is always determined by an external call to  <b>dpkg</b>(1), and can not be set at the command line.<div class="spacer">
</div>
You can specify the host architecture by providing one or both of the options  <b>-a</b> and <b>-t</b>. The default is determined by an external call to <b>gcc</b>(1), or the same as the build architecture if CC or gcc are both not available. One out of  <b>-a</b> and <b>-t</b> is sufficient, the value of the other will be set to a usable default. Indeed, it is often better to only specify one, because  <b>dpkg-architecture</b> will warn you if your choice does not match the default.</div>
<div class="section">
<h1>COMMANDS</h1><dl>
<dt>
<b>-l</b></dt>
<dd>
Print the environment variables, one each line, in the format  <i>VARIABLE=value</i>. This is the default action.</dd>
</dl>
<dl>
<dt>
<b>-e</b><i>debian-architecture</i></dt>
<dd>
Check for equality of architecture. By default <i>debian-architecture</i> is compared against the current Debian architecture, being the host. This action will not expand the architecture wildcards. Command finishes with an exit status of 0 if matched, 1 if not matched.</dd>
</dl>
<dl>
<dt>
<b>-i</b><i>architecture-wildcard</i></dt>
<dd>
Check for identity of architecture by expanding <i>architecture-wildcard</i> as an architecture wildcard and comparing against the current Debian architecture. Command finishes with an exit status of 0 if matched, 1 if not matched.</dd>
</dl>
<dl>
<dt>
<b>-q</b><i>variable-name</i></dt>
<dd>
Print the value of a single variable.</dd>
</dl>
<dl>
<dt>
<b>-s</b></dt>
<dd>
Print an export command. This can be used to set the environment variables using eval.</dd>
</dl>
<dl>
<dt>
<b>-u</b></dt>
<dd>
Print a similar command to <b>-s</b> but to unset all variables.</dd>
</dl>
<dl>
<dt>
<b>-c</b><i> command</i></dt>
<dd>
Execute a <i>command</i> in an environment which has all variables set to the determined value.</dd>
</dl>
<dl>
<dt>
<b>-L</b></dt>
<dd>
Print a list of valid architecture names.</dd>
</dl>
<dl>
<dt>
<b>--help</b></dt>
<dd>
Show the usage message and exit.</dd>
</dl>
<dl>
<dt>
<b>--version</b></dt>
<dd>
Show the version and exit.</dd>
</dl>
</div>
<div class="section">
<h1>OPTIONS</h1><dl>
<dt>
<b>-a</b><i>debian-architecture</i></dt>
<dd>
Set the Debian architecture.</dd>
</dl>
<dl>
<dt>
<b>-t</b><i>gnu-system-type</i></dt>
<dd>
Set the GNU system type.</dd>
</dl>
<dl>
<dt>
<b>-f</b></dt>
<dd>
Values set by existing environment variables with the same name as used by the scripts are honored (i.e. used by  <b>dpkg-architecture</b>), except if this force flag is present. This allows the user to override a value even when the call to  <b>dpkg-architecture</b> is buried in some other script (for example  <b>dpkg-buildpackage</b>(1)).</dd>
</dl>
</div>
<div class="section">
<h1>TERMS</h1><dl>
<dt>
build machine</dt>
<dd>
The machine the package is built on.</dd>
</dl>
<dl>
<dt>
host machine</dt>
<dd>
The machine the package is built for.</dd>
</dl>
<dl>
<dt>
Debian architecture</dt>
<dd>
The Debian architecture string, which specifies the binary tree in the FTP archive. Examples: i386, sparc, hurd-i386.</dd>
</dl>
<dl>
<dt>
architecture wildcard</dt>
<dd>
An architecture wildcard is a special architecture string that will match any real architecture being part of it. The general form is &lt;kernel&gt;-&lt;cpu&gt;. Examples: linux-any, any-i386, hurd-any.</dd>
</dl>
<dl>
<dt>
GNU system type</dt>
<dd>
An architecture specification string consisting of two parts separated by a dash: cpu and system. Examples: i386-linux-gnu, sparc-linux-gnu, i386-gnu, x86_64-netbsd.</dd>
</dl>
</div>
<div class="section">
<h1>VARIABLES</h1> The following variables are set by  <b>dpkg-architecture</b>:<dl>
<dt>
DEB_BUILD_ARCH</dt>
<dd>
The Debian architecture of the build machine.</dd>
</dl>
<dl>
<dt>
DEB_BUILD_ARCH_OS</dt>
<dd>
The Debian system name of the build machine.</dd>
</dl>
<dl>
<dt>
DEB_BUILD_ARCH_CPU</dt>
<dd>
The Debian cpu name of the build machine.</dd>
</dl>
<dl>
<dt>
DEB_BUILD_ARCH_BITS</dt>
<dd>
The pointer size of the build machine (in bits).</dd>
</dl>
<dl>
<dt>
DEB_BUILD_ARCH_ENDIAN</dt>
<dd>
The endianness of the build machine (little / big).</dd>
</dl>
<dl>
<dt>
DEB_BUILD_GNU_CPU</dt>
<dd>
The CPU part of DEB_BUILD_GNU_TYPE.</dd>
</dl>
<dl>
<dt>
DEB_BUILD_GNU_SYSTEM</dt>
<dd>
The System part of DEB_BUILD_GNU_TYPE.</dd>
</dl>
<dl>
<dt>
DEB_BUILD_GNU_TYPE</dt>
<dd>
The GNU system type of the build machine.</dd>
</dl>
<dl>
<dt>
DEB_BUILD_MULTIARCH</dt>
<dd>
The clarified GNU system type of the build machine, used for filesystem paths.</dd>
</dl>
<dl>
<dt>
DEB_HOST_ARCH</dt>
<dd>
The Debian architecture of the host machine.</dd>
</dl>
<dl>
<dt>
DEB_HOST_ARCH_OS</dt>
<dd>
The Debian system name of the host machine.</dd>
</dl>
<dl>
<dt>
DEB_HOST_ARCH_CPU</dt>
<dd>
The Debian cpu name of the host machine.</dd>
</dl>
<dl>
<dt>
DEB_HOST_ARCH_BITS</dt>
<dd>
The pointer size of the host machine (in bits).</dd>
</dl>
<dl>
<dt>
DEB_HOST_ARCH_ENDIAN</dt>
<dd>
The endianness of the host machine (little / big).</dd>
</dl>
<dl>
<dt>
DEB_HOST_GNU_CPU</dt>
<dd>
The CPU part of DEB_HOST_GNU_TYPE.</dd>
</dl>
<dl>
<dt>
DEB_HOST_GNU_SYSTEM</dt>
<dd>
The System part of DEB_HOST_GNU_TYPE.</dd>
</dl>
<dl>
<dt>
DEB_HOST_GNU_TYPE</dt>
<dd>
The GNU system type of the host machine.</dd>
</dl>
<dl>
<dt>
DEB_HOST_MULTIARCH</dt>
<dd>
The clarified GNU system type of the host machine, used for filesystem paths.</dd>
</dl>
</div>
<div class="section">
<h1>DEBIAN/RULES</h1> The environment variables set by  <b>dpkg-architecture</b> are passed to  <i>debian/rules</i> as make variables (see make documentation). However, you should not rely on them, as this breaks manual invocation of the script. Instead, you should always initialize them using  <b>dpkg-architecture</b> with the -q option. Here are some examples, which also show how you can improve the cross compilation support in your package:<div class="spacer">
</div>
<div style="height: 1.00em;">
&#160;</div>
Instead of:<dl>
<dt>
</dt>
<dd>
<br/>
ARCH=`dpkg --print-architecture`<br/>
configure $(ARCH)-linux<br/>
</dd>
</dl>
<div class="spacer">
</div>
please use the following:<dl>
<dt>
</dt>
<dd>
<br/>
DEB_BUILD_GNU_TYPE := $(shell dpkg-architecture -qDEB_BUILD_GNU_TYPE)<br/>
DEB_HOST_GNU_TYPE := $(shell dpkg-architecture -qDEB_HOST_GNU_TYPE)<div class="spacer">
</div>
<br/>
configure --build=$(DEB_BUILD_GNU_TYPE) --host=$(DEB_HOST_GNU_TYPE)<br/>
</dd>
</dl>
<div class="spacer">
</div>
<div style="height: 1.00em;">
&#160;</div>
Instead of:<dl>
<dt>
</dt>
<dd>
<br/>
ARCH=`dpkg --print-architecture`<br/>
ifeq ($(ARCH),alpha)<br/>
  ...<br/>
endif<br/>
</dd>
</dl>
<div class="spacer">
</div>
please use:<dl>
<dt>
</dt>
<dd>
<br/>
DEB_HOST_ARCH := $(shell dpkg-architecture -qDEB_HOST_ARCH)<div class="spacer">
</div>
<br/>
ifeq ($(DEB_HOST_ARCH),alpha)<br/>
  ...<br/>
endif<br/>
</dd>
</dl>
<div class="spacer">
</div>
or if you only need to check the CPU or OS type, use the DEB_HOST_ARCH_CPU or DEB_HOST_ARCH_OS variables.<div class="spacer">
</div>
In general, calling dpkg in the rules file to get architecture information is deprecated (unless you want to provide backward compatibility, see below). Especially the --print-architecture option is unreliable since we have Debian architectures which don't equal a processor name.</div>
<div class="section">
<h1>BACKWARD COMPATIBILITY</h1> The DEB_*_ARCH_BITS and DEB_*_ARCH_ENDIAN variables were introduced in dpkg-dev 1.15.4. Using them in  <i>debian/rules</i> thus requires a build-dependency on dpkg-dev (&gt;= 1.15.4).<div class="spacer">
</div>
The DEB_HOST_ARCH_CPU and DEB_HOST_ARCH_OS variables were introduced in dpkg-dev 1.13.2. Before this  <i>debian/rules</i> files tended to check the values of the DEB_HOST_GNU_CPU or DEB_HOST_GNU_TYPE variables which have been subject to change.<div class="spacer">
</div>
Where <i>debian/rules</i> files check these variables to decide how or what to compile, this should be updated to use the new variables and values. You may wish to retain backwards compatibility with older version of dpkg-dev by using the following code:<dl>
<dt>
</dt>
<dd>
<br/>
DEB_HOST_ARCH_CPU := $(shell dpkg-architecture -qDEB_HOST_ARCH_CPU 2&gt;/dev/null)<br/>
DEB_HOST_ARCH_OS := $(shell dpkg-architecture -qDEB_HOST_ARCH_OS 2&gt;/dev/null)<div class="spacer">
</div>
<br/>
# Take account of old dpkg-architecture output.<br/>
ifeq ($(DEB_HOST_ARCH_CPU),)<br/>
  DEB_HOST_ARCH_CPU := $(shell dpkg-architecture -qDEB_HOST_GNU_CPU)<br/>
  ifeq ($(DEB_HOST_ARCH_CPU),x86_64)<br/>
    DEB_HOST_ARCH_CPU := amd64<br/>
  endif<br/>
endif<br/>
ifeq ($(DEB_HOST_ARCH_OS),)<br/>
  DEB_HOST_ARCH_OS := $(subst -gnu,,$(shell dpkg-architecture -qDEB_HOST_GNU_SYSTEM))<br/>
  ifeq ($(DEB_HOST_ARCH_OS),gnu)<br/>
    DEB_HOST_ARCH_OS := hurd<br/>
  endif<br/>
endif<br/>
</dd>
</dl>
<div class="spacer">
</div>
And similarly for DEB_BUILD_ARCH_CPU and DEB_BUILD_ARCH_OS.<div class="spacer">
</div>
If you still wish to support versions of dpkg-dev that did not include  <b>dpkg-architecture</b>, the following does the job:<dl>
<dt>
</dt>
<dd>
<br/>
DEB_BUILD_ARCH := $(shell dpkg --print-architecture)<br/>
DEB_BUILD_GNU_CPU := $(patsubst hurd-%,%,$(DEB_BUILD_ARCH))<br/>
ifeq ($(filter-out hurd-%,$(DEB_BUILD_ARCH)),)<br/>
  DEB_BUILD_GNU_SYSTEM := gnu<br/>
else<br/>
  DEB_BUILD_GNU_SYSTEM := linux-gnu<br/>
endif<br/>
DEB_BUILD_GNU_TYPE=$(DEB_BUILD_GNU_CPU)-$(DEB_BUILD_GNU_SYSTEM)<div class="spacer">
</div>
<br/>
DEB_HOST_ARCH := $(DEB_BUILD_ARCH)<br/>
DEB_HOST_GNU_CPU := $(DEB_BUILD_GNU_CPU)<br/>
DEB_HOST_GNU_SYSTEM := $(DEB_BUILD_GNU_SYSTEM)<br/>
DEB_HOST_GNU_TYPE := $(DEB_BUILD_GNU_TYPE)<br/>
</dd>
</dl>
<div class="spacer">
</div>
Put a subset of these lines at the top of your debian/rules file; these default values will be overwritten if dpkg-architecture is used.<div class="spacer">
</div>
You don't need the full set. Choose a consistent set which contains the values you use in the rules file. For example, if you only need the host Debian architecture, `DEB_HOST_ARCH=`dpkg --print-architecture`' is sufficient (this is indeed the Debian architecture of the build machine, but remember that we are only trying to be backward compatible with native compilation).<div class="spacer">
</div>
The <b>-e</b> and <b>-i</b> options were only introduced in relatively recent versions of  <b>dpkg-architecture</b> (since dpkg 1.13.13).</div>
<div class="section">
<h1>EXAMPLES</h1>  <b>dpkg-buildpackage</b> accepts the <b>-a</b> option and passes it to  <b>dpkg-architecture</b>. Other examples:<dl>
<dt>
</dt>
<dd>
CC=i386-gnu-gcc dpkg-architecture -c debian/rules build</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
eval `dpkg-architecture -u`</dd>
</dl>
<div class="spacer">
</div>
Check if an architecture is equal to the current architecture or a given one:<dl>
<dt>
</dt>
<dd>
dpkg-architecture -elinux-alpha</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
dpkg-architecture -amips -elinux-mips</dd>
</dl>
<div class="spacer">
</div>
Check if the current architecture or an architecture provided with -a are Linux systems:<dl>
<dt>
</dt>
<dd>
dpkg-architecture -ilinux-any</dd>
</dl>
<dl>
<dt>
</dt>
<dd>
dpkg-architecture -ai386 -ilinux-any</dd>
</dl>
</div>
<div class="section">
<h1>FILES</h1> All these files have to be present for  <b>dpkg-architecture</b> to work. Their location can be overridden at runtime with the environment variable  <b>DPKG_DATADIR</b>.<dl>
<dt>
<i>/usr/share/dpkg/cputable</i></dt>
<dd>
Table of known CPU names and mapping to their GNU name.</dd>
</dl>
<dl>
<dt>
<i>/usr/share/dpkg/ostable</i></dt>
<dd>
Table of known operating system names and mapping to their GNU name.</dd>
</dl>
<dl>
<dt>
<i>/usr/share/dpkg/triplettable</i></dt>
<dd>
Mapping between Debian architecture triplets and Debian architecture names.</dd>
</dl>
</div>
<div class="section">
<h1>SEE ALSO</h1> <b>dpkg-buildpackage</b>(1), <b>dpkg-cross</b>(1).</div>
<div class="section">
<h1>AUTHOR</h1> <b>dpkg-architecture</b> and this man page were initially written by Marcus Brinkmann &lt;brinkmd@debian.org&gt;.<div style="height: 1.00em;">
&#160;</div>
</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-08-14</td>
<td class="foot-os">
Debian Project</td>
</tr>
</table>
</div>
</body>
</html>

