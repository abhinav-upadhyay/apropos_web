<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
GIT-FOR-EACH-REF(1)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
GIT-FOR-EACH-REF(1)</td>
<td class="head-vol">
Git Manual</td>
<td class="head-rtitle">
GIT-FOR-EACH-REF(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> git-for-each-ref - Output information on each ref</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
<i>git for-each-ref</i> [--count=&lt;count&gt;] [--shell|--perl|--python|--tcl]<br/>
                   [(--sort=&lt;key&gt;)...] [--format=&lt;format&gt;] [&lt;pattern&gt;...]<br/>
                   [--points-at &lt;object&gt;] [(--merged | --no-merged) [&lt;object&gt;]]<br/>
                   [--contains [&lt;object&gt;]]<br/>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>DESCRIPTION</h1> Iterate over all refs that match &lt;pattern&gt; and show them according to the given &lt;format&gt;, after sorting them according to the given set of &lt;key&gt;. If &lt;count&gt; is given, stop after showing that many refs. The interpolated values in &lt;format&gt; can optionally be quoted as string literals in the specified host language allowing their direct evaluation in that language.</div>
<div class="section">
<h1>OPTIONS</h1> &lt;count&gt;<div style="margin-left: 4.00ex;">
By default the command shows all refs that match &lt;pattern&gt;. This option makes it stop after showing that many refs.</div>
<div class="spacer">
</div>
&lt;key&gt;<div style="margin-left: 4.00ex;">
A field name to sort on. Prefix - to sort in descending order of the value. When unspecified, refname is used. You may use the --sort=&lt;key&gt; option multiple times, in which case the last key becomes the primary key.</div>
<div class="spacer">
</div>
&lt;format&gt;<div style="margin-left: 4.00ex;">
A string that interpolates %(fieldname) from the object pointed at by a ref being shown. If fieldname is prefixed with an asterisk (*) and the ref points at a tag object, the value for the field in the object tag refers is used. When unspecified, defaults to %(objectname) SPC %(objecttype) TAB %(refname). It also interpolates %% to %, and %xx where xx are hex digits interpolates to character with hex code xx; for example %00 interpolates to \0 (NUL), %09 to \t (TAB) and %0a to \n (LF).</div>
<div class="spacer">
</div>
&lt;pattern&gt;...<div style="margin-left: 4.00ex;">
If one or more patterns are given, only refs are shown that match against at least one pattern, either using fnmatch(3) or literally, in the latter case matching completely or from the beginning up to a slash.</div>
<div class="spacer">
</div>
--shell, --perl, --python, --tcl<div style="margin-left: 4.00ex;">
If given, strings that substitute %(fieldname) placeholders are quoted as string literals suitable for the specified host language. This is meant to produce a scriptlet that can directly be `eval`ed.</div>
<div class="spacer">
</div>
--points-at &lt;object&gt;<div style="margin-left: 4.00ex;">
Only list refs which points at the given object.</div>
<div class="spacer">
</div>
--merged [&lt;object&gt;]<div style="margin-left: 4.00ex;">
Only list refs whose tips are reachable from the specified commit (HEAD if not specified).</div>
<div class="spacer">
</div>
--no-merged [&lt;object&gt;]<div style="margin-left: 4.00ex;">
Only list refs whose tips are not reachable from the specified commit (HEAD if not specified).</div>
<div class="spacer">
</div>
--contains [&lt;object&gt;]<div style="margin-left: 4.00ex;">
Only list tags which contain the specified commit (HEAD if not specified).</div>
</div>
<div class="section">
<h1>FIELD NAMES</h1> Various values from structured fields in referenced objects can be used to interpolate into the resulting output, or as sort keys.<div style="height: 1.00em;">
&#160;</div>
For all objects, the following names can be used:<div class="spacer">
</div>
refname<div style="margin-left: 4.00ex;">
The name of the ref (the part after $GIT_DIR/). For a non-ambiguous short name of the ref append :short. The option core.warnAmbiguousRefs is used to select the strict abbreviation mode. If strip=&lt;N&gt; is appended, strips &lt;N&gt; slash-separated path components from the front of the refname (e.g., %(refname:strip=2) turns refs/tags/foo into foo. &lt;N&gt; must be a positive integer. If a displayed ref has fewer components than &lt;N&gt;, the command aborts with an error.</div>
<div class="spacer">
</div>
objecttype<div style="margin-left: 4.00ex;">
The type of the object (blob, tree, commit, tag).</div>
<div class="spacer">
</div>
objectsize<div style="margin-left: 4.00ex;">
The size of the object (the same as  <i>git cat-file -s</i> reports).</div>
<div class="spacer">
</div>
objectname<div style="margin-left: 4.00ex;">
The object name (aka SHA-1). For a non-ambiguous abbreviation of the object name append :short.</div>
<div class="spacer">
</div>
upstream<div style="margin-left: 4.00ex;">
The name of a local ref which can be considered &#8220;upstream&#8221; from the displayed ref. Respects :short in the same way as refname above. Additionally respects :track to show &quot;[ahead N, behind M]&quot; and :trackshort to show the terse version: &quot;&gt;&quot; (ahead), &quot;&lt;&quot; (behind), &quot;&lt;&gt;&quot; (ahead and behind), or &quot;=&quot; (in sync). Has no effect if the ref does not have tracking information associated with it.</div>
<div class="spacer">
</div>
push<div style="margin-left: 4.00ex;">
The name of a local ref which represents the @{push} location for the displayed ref. Respects :short, :track, and :trackshort options as upstream does. Produces an empty string if no @{push} ref is configured.</div>
<div class="spacer">
</div>
HEAD<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">
&#160;</div>
<i>*</i> if HEAD matches current ref (the checked out branch), ' ' otherwise.</div>
<div class="spacer">
</div>
color<div style="margin-left: 4.00ex;">
Change output color. Followed by :&lt;colorname&gt;, where names are described in color.branch.*.</div>
<div class="spacer">
</div>
align<div style="margin-left: 4.00ex;">
Left-, middle-, or right-align the content between %(align:...) and %(end). The &quot;align:&quot; is followed by width=&lt;width&gt; and position=&lt;position&gt; in any order separated by a comma, where the &lt;position&gt; is either left, right or middle, default being left and &lt;width&gt; is the total length of the content with alignment. For brevity, the &quot;width=&quot; and/or &quot;position=&quot; prefixes may be omitted, and bare &lt;width&gt; and &lt;position&gt; used instead. For instance, %(align:&lt;width&gt;,&lt;position&gt;). If the contents length is more than the width then no alignment is performed. If used with  <i>--quote</i> everything in between %(align:...) and %(end) is quoted, but if nested then only the topmost level performs quoting.</div>
<div style="height: 1.00em;">
&#160;</div>
In addition to the above, for commit and tag objects, the header field names (tree, parent, object, type, and tag) can be used to specify the value in the header field.<div style="height: 1.00em;">
&#160;</div>
For commit and tag objects, the special creatordate and creator fields will correspond to the appropriate date or name-email-date tuple from the committer or tagger fields depending on the object type. These are intended for working on a mix of annotated and lightweight tags.<div style="height: 1.00em;">
&#160;</div>
Fields that have name-email-date tuple as its value (author, committer, and tagger) can be suffixed with name, email, and date to extract the named component.<div style="height: 1.00em;">
&#160;</div>
The complete message in a commit and tag object is contents. Its first line is contents:subject, where subject is the concatenation of all lines of the commit message up to the first blank line. The next line is <i>contents:body</i>, where body is all of the lines after the first blank line. The optional GPG signature is contents:signature. The first N lines of the message is obtained using contents:lines=N.<div style="height: 1.00em;">
&#160;</div>
For sorting purposes, fields with numeric values sort in numeric order (objectsize, authordate, committerdate, creatordate, taggerdate). All other fields are used to sort in their byte-value order.<div style="height: 1.00em;">
&#160;</div>
There is also an option to sort by versions, this can be done by using the fieldname version:refname or its alias v:refname.<div style="height: 1.00em;">
&#160;</div>
In any case, a field name that refers to a field inapplicable to the object referred by the ref does not cause an error. It returns an empty string instead.<div style="height: 1.00em;">
&#160;</div>
As a special case for the date-type fields, you may specify a format for the date by adding : followed by date format name (see the values the --date option to <b>:git-rev-list</b>(1) takes).</div>
<div class="section">
<h1>EXAMPLES</h1> An example directly producing formatted text. Show the most recent 3 tagged commits:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
<br/>
#!/bin/sh<div class="spacer">
</div>
<br/>
git for-each-ref --count=3 --sort='-*authordate' \<br/>
--format='From: %(*authorname) %(*authoremail)<br/>
Subject: %(*subject)<br/>
Date: %(*authordate)<br/>
Ref: %(*refname)<div class="spacer">
</div>
<br/>
%(*body)<br/>
' 'refs/tags'<br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
A simple example showing the use of shell eval on the output, demonstrating the use of --shell. List the prefixes of all heads:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
<br/>
#!/bin/sh<div class="spacer">
</div>
<br/>
git for-each-ref --shell --format=&quot;ref=%(refname)&quot; refs/heads | \<br/>
while read entry<br/>
do<br/>
        eval &quot;$entry&quot;<br/>
        echo `dirname $ref`<br/>
done<br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
A bit more elaborate report on tags, demonstrating that the format may be an entire script:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
<br/>
#!/bin/sh<div class="spacer">
</div>
<br/>
fmt='<br/>
        r=%(refname)<br/>
        t=%(*objecttype)<br/>
        T=${r#refs/tags/}<div class="spacer">
</div>
<br/>
        o=%(*objectname)<br/>
        n=%(*authorname)<br/>
        e=%(*authoremail)<br/>
        s=%(*subject)<br/>
        d=%(*authordate)<br/>
        b=%(*body)<div class="spacer">
</div>
<br/>
        kind=Tag<br/>
        if test &quot;z$t&quot; = z<br/>
        then<br/>
                # could be a lightweight tag<br/>
                t=%(objecttype)<br/>
                kind=&quot;Lightweight tag&quot;<br/>
                o=%(objectname)<br/>
                n=%(authorname)<br/>
                e=%(authoremail)<br/>
                s=%(subject)<br/>
                d=%(authordate)<br/>
                b=%(body)<br/>
        fi<br/>
        echo &quot;$kind $T points at a $t object $o&quot;<br/>
        if test &quot;z$t&quot; = zcommit<br/>
        then<br/>
                echo &quot;The commit was authored by $n $e<br/>
at $d, and titled<div class="spacer">
</div>
<br/>
    $s<div class="spacer">
</div>
<br/>
Its message reads as:<br/>
&quot;<br/>
                echo &quot;$b&quot; | sed -e &quot;s/^/    /&quot;<br/>
                echo<br/>
        fi<br/>
'<div class="spacer">
</div>
<br/>
eval=`git for-each-ref --shell --format=&quot;$fmt&quot; \<br/>
        --sort='*objecttype' \<br/>
        --sort=-taggerdate \<br/>
        refs/tags`<br/>
eval &quot;$eval&quot;<br/>
</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>SEE ALSO</h1>  <b>git-show-ref</b>(1)</div>
<div class="section">
<h1>GIT</h1> Part of the  <b>git</b>(1) suite</div>
<table class="foot">
<tr>
<td class="foot-date">
04/03/2016</td>
<td class="foot-os">
Git 2.8.1</td>
</tr>
</table>
</div>
</body>
</html>

