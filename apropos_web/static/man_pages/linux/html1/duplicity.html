<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
DUPLICITY(1)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
DUPLICITY(1)</td>
<td class="head-vol">
User Manuals</td>
<td class="head-rtitle">
DUPLICITY(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> duplicity - Encrypted backup using rsync algorithm<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>duplicity</b> <b>[</b><i>options</i><b>]</b> <i>source_directory target_url</i><div style="height: 1.00em;">
&#160;</div>
<b>duplicity</b> <b>[</b><i>options</i><b>]</b> <i>source_url target_directory</i><div style="height: 1.00em;">
&#160;</div>
<b>duplicity full</b> <b>[</b><i>options</i><b>]</b> <i>source_directory target_url</i><div style="height: 1.00em;">
&#160;</div>
<b>duplicity incremental</b> <b>[</b><i>options</i><b>]</b> <i>source_directory target_url</i><div style="height: 1.00em;">
&#160;</div>
<b>duplicity restore</b> <b>[</b><i>options</i><b>]</b> <i>source_url target_directory</i><div style="height: 1.00em;">
&#160;</div>
<b>duplicity verify</b> <b>[</b><i>options</i><b>]</b> <i>source_url target_directory</i><div style="height: 1.00em;">
&#160;</div>
<b>duplicity collection-status</b> <b>[</b><i>options</i><b>]</b> <i>target_url</i><div style="height: 1.00em;">
&#160;</div>
<b>duplicity list-current-files</b> <b>[</b><i>options</i><b>]</b> <i>target_url</i><div style="height: 1.00em;">
&#160;</div>
<b>duplicity cleanup</b> <b>[</b><i>options</i><b>]</b> <b>[</b><i>--force</i><b>]</b> <i>target_url</i><div style="height: 1.00em;">
&#160;</div>
<b>duplicity remove-older-than</b> <i>time</i> <b>[</b><i>options</i><b>]</b> <b>[</b><i>--force</i><b>]</b> <i>target_url</i><div style="height: 1.00em;">
&#160;</div>
<b>duplicity remove-all-but-n-full</b> <i>count</i> <b>[</b><i>options</i><b>]</b> <b>[</b><i>--force</i><b>]</b> <i>target_url</i><div style="height: 1.00em;">
&#160;</div>
<b>duplicity remove-all-inc-of-but-n-full</b> <i>count</i> <b>[</b><i>options</i><b>]</b> <b>[</b><i>--force</i><b>]</b> <i>target_url</i><div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>DESCRIPTION</h1> Duplicity incrementally backs up files and directory by encrypting tar-format volumes with GnuPG and uploading them to a remote (or local) file server.  Currently local, ftp, sftp/scp, rsync, WebDAV, WebDAVs, Google Docs, HSi and Amazon S3 backends are available. Because duplicity uses librsync, the incremental archives are space efficient and only record the parts of files that have changed since the last backup.  Currently duplicity supports deleted files, full Unix permissions, directories, symbolic links, fifos, etc., but not hard links.<div style="height: 1.00em;">
&#160;</div>
If you are backing up the root directory /, remember to --exclude /proc, or else duplicity will probably crash on the weird stuff in there.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>EXAMPLES</h1> Here is an example of a backup, using scp to back up /home/me to some_dir on the other.host machine:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity /home/me scp://uid@other.host/some_dir</div>
<div class="spacer">
</div>
If the above is run repeatedly, the first will be a full backup, and subsequent ones will be incremental.  To force a full backup, use the <i>full</i> action:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity full /home/me scp://uid@other.host/some_dir</div>
<div class="spacer">
</div>
Now suppose we accidentally delete /home/me and want to restore it the way it was at the time of last backup:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity scp://uid@other.host/some_dir /home/me</div>
<div class="spacer">
</div>
Duplicity enters restore mode because the URL comes before the local directory.  If we wanted to restore just the file &quot;Mail/article&quot; in /home/me as it was three days ago into /home/me/restored_file:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity -t 3D --file-to-restore Mail/article scp://uid@other.host/some_dir /home/me/restored_file</div>
<div class="spacer">
</div>
The following command compares the files we backed up, so see what has changed since then:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity verify scp://uid@other.host/some_dir /home/me</div>
<div class="spacer">
</div>
Finally, duplicity recognizes several include/exclude options.  For instance, the following will backup the root directory, but exclude /mnt, /tmp, and /proc:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity --exclude /mnt --exclude /tmp --exclude /proc / file:///usr/local/backup</div>
<div class="spacer">
</div>
Note that in this case the destination is the local directory /usr/local/backup.  The following will backup only the /home and /etc directories under root:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity --include /home --include /etc --exclude '**' / file:///usr/local/backup</div>
<div class="spacer">
</div>
Duplicity can also access a repository via ftp.  If a user name is given, the environment variable FTP_PASSWORD is read to determine the password:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
FTP_PASSWORD=mypassword duplicity /local/dir ftp://user@other.host/some_dir<div style="height: 1.00em;">
&#160;</div>
</div>
</div>
<div class="section">
<h1>ACTIONS</h1><dl>
<dt>
<b>cleanup</b></dt>
<dd>
Delete the extraneous duplicity files on the given backend. Non-duplicity files, or files in complete data sets will not be deleted.  This should only be necessary after a duplicity session fails or is aborted prematurely.  Note that <i>--force</i> will be needed to delete the files rather than just list them.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>collection-status</b></dt>
<dd>
Summarize the status of the backup repository by printing the chains and sets found, and the number of volumes in each.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>full</b></dt>
<dd>
Indicate full backup.  If this is set, perform full backup even if signatures are available.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>incr</b></dt>
<dd>
If this is requested an incremental backup will be performed. Duplicity will abort if old signatures cannot be found.  The default is to switch to full backup under these conditions.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>list-current-files</b></dt>
<dd>
Lists the files currently backed up in the archive.  The information will be extracted from the signature files, not the archive data itself.  Thus the whole archive does not have to be downloaded, but on the other hand if the archive has been deleted or corrupted, this command may not detect it.<div style="height: 1.00em;">
&#160;</div>
<b>Note:</b> the Debian version of duplicity automatically runs a cleanup --extra-clean whenever old backup sets are removed (i.e. if one of the remove commands is run with the --force option present and if something removable is found). This is to limit the amount of old outdated material that otherwise accumulates in the archive dir.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>remove-older-than </b><i>time</i></dt>
<dd>
Delete all backup sets older than the given time.  Old backup sets will not be deleted if backup sets newer than <i>time</i> depend on them.  See the <b>TIME FORMATS</b> section for more information.  Note, this action cannot be combined with backup or other actions, such as cleanup.  Note also that <i>--force</i> will be needed to delete the files rather than just list them.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>remove-all-but-n-full </b><i>count</i></dt>
<dd>
Delete all backups sets that are older than the count:th last full backup (in other words, keep the last <i>count</i> full backups and associated incremental sets). <i>count</i> must be larger than zero. A value of 1 means that only the single most recent backup chain will be kept.  Note that <i>--force</i> will be needed to delete the files rather than just list them.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>remove-all-inc-of-but-n-full </b><i>count</i></dt>
<dd>
Delete incremental sets of all backups sets that are older than the count:th last full backup (in other words, keep only old full backups and not their increments). <i>count</i> must be larger than zero. A value of 1 means that only the single most recent backup chain will be kept intact.  Note that <i>--force</i> will be needed to delete the files rather than just list them.<div style="height: 1.00em;">
&#160;</div>
The note regarding automatic cleanups above also applies to remove-all-but-n-full.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>verify</b></dt>
<dd>
Enter verify mode instead of restore.  If the --file-to-restore option is given, restrict verify to that file or directory.  duplicity will exit with a non-zero error level if any files are different.  On verbosity level 4 or higher, log a message for each file that has changed.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>OPTIONS</h1><dl>
<dt>
<b>--allow-source-mismatch</b></dt>
<dd>
Do not abort on attempts to use the same archive dir or remote backend to back up different directories.  duplicity will tell you if you need this switch.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--archive-dir </b><i>path</i></dt>
<dd>
The archive directory. <b>NOTE:</b> This option changed in 0.6.0.  The archive directory is now necessary in order to manage persistence for current and future enhancements. As such, this option is now used only to change the location of the archive directory.  The archive directory should <b>not</b> be deleted, or duplicity will have to recreate it from the remote repository (which may require decrypting the backup contents).<div style="height: 1.00em;">
&#160;</div>
When backing up or restoring, this option specifies that the local archive directory is to be created in <i>path</i>. If the archive directory is not specified, the default will be to create the archive directory in <i>~/.cache/duplicity/</i>.<div style="height: 1.00em;">
&#160;</div>
The archive directory can be shared between backups to multiple targets, because a subdirectory of the archive dir is used for individual backups (see <b>--name</b> ).<div style="height: 1.00em;">
&#160;</div>
The combination of archive directory and backup name must be unique in order to separate the data of different backups.<div style="height: 1.00em;">
&#160;</div>
The interaction between the <b>--archive-dir</b> and the <b>--name</b> options allows for four possible combinations for the location of the archive dir:<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<div style="margin-left: 5.00ex;">
<dl>
<dt>
1.</dt>
<dd>
neither specified (default)<br/>
 ~/.cache/duplicity/<i>hash-of-url</i></dd>
</dl>
<dl>
<dt>
2.</dt>
<dd>
--archive-dir=/arch, no --name<br/>
 /arch/<i>hash-of-url</i></dd>
</dl>
<dl>
<dt>
3.</dt>
<dd>
no --archive-dir, --name=foo<br/>
 ~/.cache/duplicity/foo</dd>
</dl>
<dl>
<dt>
4.</dt>
<dd>
--archive-dir=/arch, --name=foo<br/>
 /arch/foo</dd>
</dl>
</div>
<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
<b>--asynchronous-upload </b></dt>
<dd>
(EXPERIMENTAL) Perform file uploads asynchronously in the background, with respect to volume creation. This means that duplicity can upload a volume while, at the same time, preparing the next volume for upload. The intended end-result is a faster backup, because the local CPU and your bandwidth can be more consistently utilized. Use of this option implies additional need for disk space in the temporary storage location; rather than needing to store only one volume at a time, enough storage space is required to store two volumes.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--dry-run </b></dt>
<dd>
Calculate what would be done, but do not perform any backend actions<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--encrypt-key </b><i>key</i></dt>
<dd>
When backing up, encrypt to the given public key, instead of using symmetric (traditional) encryption.  Can be specified multiple times.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--encrypt-secret-keyring </b><i>filename</i></dt>
<dd>
This option can only be used with <b>--encrypt-key</b>, and changes the path to the secret keyring for the encrypt key to <i>filename</i> This keyring is not used when creating a backup. If not specified, the default secret keyring is used which is usually located at .gnupg/secring.gpg<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--encrypt-sign-key </b><i>key</i></dt>
<dd>
Convenience parameter. Same as <b>--encrypt-key</b> <i>key</i> <b>--sign-key</b> <i>key</i>.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--exclude </b><i>shell_pattern</i></dt>
<dd>
Exclude the file or files matched by <i>shell_pattern</i>. If a directory is matched, then files under that directory will also be matched.  See the <b>FILE SELECTION</b> section for more information.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--exclude-device-files</b></dt>
<dd>
Exclude all device files.  This can be useful for security/permissions reasons or if rdiff-backup is not handling device files correctly.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--exclude-filelist </b><i>filename</i></dt>
<dd>
Excludes the files listed in <i>filename</i>. See the <b>FILE SELECTION</b> section for more information.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--exclude-filelist-stdin</b></dt>
<dd>
Like <b>--exclude-filelist,</b> but the list of files will be read from standard input.  See the <b>FILE SELECTION</b> section for more information.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--exclude-globbing-filelist </b>filename</dt>
<dd>
Like <b>--exclude-filelist</b> but each line of the filelist will be interpreted according to the same rules as <b>--include</b> and <b>--exclude.</b><div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--exclude-if-present </b>filename</dt>
<dd>
Exclude directories if filename is present. This option needs to come before any other include or exclude options.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--exclude-other-filesystems</b></dt>
<dd>
Exclude files on file systems (identified by device number) other than the file system the root of the source directory is on.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--exclude-regexp </b><i>regexp</i></dt>
<dd>
Exclude files matching the given regexp.  Unlike the <b>--exclude</b> option, this option does not match files in a directory it matches. See the <b>FILE SELECTION</b> section for more information.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--extra-clean</b></dt>
<dd>
When cleaning up, be more aggressive about saving space.  For example, this may delete signature files for old backup chains. See the <b>cleanup</b> argument for more information.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--file-to-restore </b><i>path</i></dt>
<dd>
This option may be given in restore mode, causing only <i>path</i> to be restored instead of the entire contents of the backup archive. <i>path</i> should be given relative to the root of the directory backed up.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--full-if-older-than </b><i>time</i></dt>
<dd>
Perform a full backup if an incremental backup is requested, but the latest full backup in the collection is older than the given <i>time</i>. See the <b>TIME FORMATS</b> section for more information.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--force</b></dt>
<dd>
Proceed even if data loss might result.  Duplicity will let the user know when this option is required.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--ftp-passive</b></dt>
<dd>
Use passive (PASV) data connections.  The default is to use passive, but to fallback to regular if the passive connection fails or times out.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--ftp-regular</b></dt>
<dd>
Use regular (PORT) data connections.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--gio</b></dt>
<dd>
Use the GIO backend and interpret any URLs as GIO would.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--ignore-errors</b></dt>
<dd>
Try to ignore certain errors if they happen. This option is only intended to allow the restoration of a backup in the face of certain problems that would otherwise cause the backup to fail. It is not ever recommended to use this option unless you have a situation where you are trying to restore from backup and it is failing because of an issue which you want duplicity to ignore. Even then, depending on the issue, this option may not have an effect.<div style="height: 1.00em;">
&#160;</div>
Please note that while ignored errors will be logged, there will be no summary at the end of the operation to tell you what was ignored, if anything. If this is used for emergency restoration of data, it is recommended that you run the backup in such a way that you can revisit the backup log (look for lines containing the string IGNORED_ERROR).<div style="height: 1.00em;">
&#160;</div>
If you ever have to use this option for reasons that are not understood or understood but not your own responsibility, please contact duplicity maintainers. The need to use this option under production circumstances would normally be considered a bug.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--imap-mailbox </b><i>option</i></dt>
<dd>
Allows you to specify a different mailbox.  The default is &quot;INBOX&quot;. Other languages may require a different mailbox than the default.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--gpg-options </b><i>options</i></dt>
<dd>
Allows you to pass options to gpg encryption.  The <i>options</i> list should be of the form &quot;opt1=parm1 opt2=parm2&quot; where the string is quoted and the only spaces allowed are between options.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--include </b><i>shell_pattern</i></dt>
<dd>
Similar to <b>--exclude</b> but include matched files instead.  Unlike <b>--exclude</b>, this option will also match parent directories of matched files (although not necessarily their contents).  See the <b>FILE SELECTION</b> section for more information.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--include-filelist </b><i>filename</i></dt>
<dd>
Like <b>--exclude-filelist</b>, but include the listed files instead.  See the <b>FILE SELECTION</b> section for more information.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--include-filelist-stdin</b></dt>
<dd>
Like <b>--include-filelist</b>, but read the list of included files from standard input.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--include-globbing-filelist </b><i>filename</i></dt>
<dd>
Like <b>--include-filelist</b> but each line of the filelist will be interpreted according to the same rules as <b>--include</b> and <b>--exclude.</b><div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--include-regexp </b><i>regexp</i></dt>
<dd>
Include files matching the regular expression <i>regexp</i>. Only files explicitly matched by <i>regexp</i> will be included by this option.  See the <b>FILE SELECTION</b> section for more information.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--log-fd </b><i>number</i></dt>
<dd>
Write specially-formatted versions of output messages to the specified file descriptor.  The format used is designed to be easily consumable by other programs.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--log-file </b><i>filename</i></dt>
<dd>
Write specially-formatted versions of output messages to the specified file. The format used is designed to be easily consumable by other programs.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--name </b><i>symbolicname</i></dt>
<dd>
Set the symbolic name of the backup being operated on. The intent is to use a separate name for each logically distinct backup. For example, someone may use &quot;home_daily_s3&quot; for the daily backup of a home directory to Amazon S3. The structure of the name is up to the user, it is only important that the names be distinct. The symbolic name is currently only used to affect the expansion of <b>--archive-dir</b> , but may be used for additional features in the future. Users running more than one distinct backup are encouraged to use this option.<div style="height: 1.00em;">
&#160;</div>
If not specified, the default value is a hash of the backend URL.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--no-encryption</b></dt>
<dd>
Do not use GnuPG to encrypt files on remote system.  Instead just write gzipped volumes.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--no-print-statistics</b></dt>
<dd>
By default duplicity will print statistics about the current session after a successful backup.  This switch disables that behavior.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--null-separator</b></dt>
<dd>
Use nulls (\0) instead of newlines (\n) as line separators, which may help when dealing with filenames containing newlines.  This affects the expected format of the files specified by the --{include|exclude}-filelist[-stdin] switches as well as the format of the directory statistics file.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--numeric-owner</b></dt>
<dd>
On restore always use the numeric uid/gid from the archive and not the archived user/group names, which is the default behaviour. Recommended for restoring from live cds which might have the users with identical names but different uids/gids.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--num-retries </b><i>number</i></dt>
<dd>
Number of retries to make on errors before giving up.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--old-filenames</b></dt>
<dd>
Use the old filename format (incompatible with Windows/Samba) rather than the new filename format.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--rename </b><i>orig new</i></dt>
<dd>
Treats the path <i>orig</i> in the backup as if it were the path <i>new.</i> Can be passed multiple times.  An example:</dd>
</dl>
<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity restore --rename Documents/metal Music/metal scp://uid@other.host/some_dir /home/me</div>
<div class="spacer">
</div>
<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
<b>--rsync-options </b><i>options</i></dt>
<dd>
Allows you to pass options to the rsync backend.  The <i>options</i> list should be of the form &quot;opt1=parm1 opt2=parm2&quot; where the option string is quoted and the only spaces allowed are between options. The option string will be passed verbatim to rsync, after any internally generated option designating the remote port to use.  Here is a possibly useful example:</dd>
</dl>
<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity --rsync-options=&quot;--partial-dir=.rsync-partial&quot; /home/me scp://uid@other.host/some_dir</div>
<div class="spacer">
</div>
<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
<b>--s3-european-buckets</b></dt>
<dd>
When using the Amazon S3 backend, create buckets in Europe instead of the default (requires <b>--s3-use-new-style</b> ). Also see the <b>EUROPEAN S3 BUCKETS</b> section.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--s3-unencrypted-connection</b></dt>
<dd>
Don't use SSL for connections to S3.<div style="height: 1.00em;">
&#160;</div>
This may be much faster, at some cost to confidentiality.<div style="height: 1.00em;">
&#160;</div>
With this option, anyone who can observe traffic between your computer and S3 will be able to tell: that you are using Duplicity, the name of the bucket, your AWS Access Key ID, the increment dates and the amount of data in each increment.<div style="height: 1.00em;">
&#160;</div>
This option affects only the connection, not the GPG encryption of the backup increment files.  Unless that is disabled, an observer will not be able to see the file names or contents.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--s3-use-new-style</b></dt>
<dd>
When operating on Amazon S3 buckets, use new-style subdomain bucket addressing. This is now the preferred method to access Amazon S3, but is not backwards compatible if your bucket name contains upper-case characters or other characters that are not valid in a hostname.</dd>
</dl>
<dl>
<dt>
<b>--scp-command </b><i>command</i></dt>
<dd>
Deprecated and ignored. The sftp/scp backend does no longer use an external scp client program.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--sftp-command </b><i>command</i></dt>
<dd>
Deprecated and ignored. The sftp/scp backend does no longer use an external sftp client program.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--sign-key </b><i>key</i></dt>
<dd>
This option can be used when backing up, restoring or verifying. When backing up, all backup files will be signed with keyid <i>key</i>. When restoring, duplicity will signal an error if any remote file is not signed with the given keyid. <i>key</i> should be an 8 character hex string, like AA0E73D2. Should be specified only once because currently only <b>one</b> signing key is supported. Last entry overrides all other entries.<div style="height: 0.00em;">
&#160;</div>
see also <b>A NOTE ON SYMMETRIC ENCRYPTION AND SIGNING</b><div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--ssh-askpass</b></dt>
<dd>
Tells the sftp/scp backend to use FTP_PASSWORD from the environment, or, if that is not present, to prompt the user for the remote system password. This password is also used for ssh keys that are passphrase-protected. Without this option the password is expected in the url.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--ssh-options </b><i>options</i></dt>
<dd>
Allows you to pass options to the ssh/scp/sftp backend.  The <i>options</i> list should be of the form &quot;-oopt1=parm1 -oopt2=parm2&quot; where the option string is quoted and the only spaces allowed are between options. Options must be given in the long option format described in <b>ssh_config(5)</b>. The sftp/scp backend currently supports only one ssh option, IdentityFile like in this example:</dd>
</dl>
<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity --ssh-options=&quot;-oIdentityFile=/my/backup/id&quot; /home/me sftp://uid@other.host/some_dir</div>
<div class="spacer">
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
<b>--short-filenames</b></dt>
<dd>
If this option is specified, the names of the files duplicity writes will be shorter (about 30 chars) but less understandable.  This may be useful when backing up to MacOS or another OS or FS that doesn't support long filenames.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--tempdir </b><i>directory</i></dt>
<dd>
Use this existing directory for duplicity temporary files instead of the system default, which is usually the /tmp directory. This option supersedes any environment variable.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>-t</b><i>time</i><b>, --time </b><i>time</i><b>, --restore-time </b><i>time</i></dt>
<dd>
Specify the time from which to restore or list files.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--time-separator </b><i>char</i></dt>
<dd>
Use <i>char</i> as the time separator in filenames instead of colon (&quot;:&quot;).<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--timeout </b><i>seconds</i></dt>
<dd>
Use <i>seconds</i> as the socket timeout value if duplicity begins to timeout during network operations.  The default is 30 seconds.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--use-agent</b></dt>
<dd>
If this option is specified, then <i>--use-agent</i> is passed to the GnuPG encryption process and it will try to connect to <b>gpg-agent</b> before it asks for a passphrase for <i>--encrypt-key</i> or <i>--sign-key</i> if needed.<div style="height: 0.00em;">
&#160;</div>
<b>Note:</b> GnuPG 2 and newer ignore this option and will always use a running <b>gpg-agent</b> if no passphrase was delivered.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--use-scp</b></dt>
<dd>
If this option is specified, then the sftp/scp backend will use the scp protocol rather than sftp for backend operations. The default is to use sftp, because it does not suffer from shell quoting issues like scp.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--verbosity </b><i>level</i><b>, -v</b><i>level</i></dt>
<dd>
Specify output verbosity level (log level). Named levels and corresponding values are 0 Error, 2 Warning, 4 Notice (default), 8 Info, 9 Debug (noisiest).<div style="height: 0.00em;">
&#160;</div>
<i>level</i> may also be<div style="height: 0.00em;">
&#160;</div>
<b>a character:</b> e, w, n, i, d<div style="height: 0.00em;">
&#160;</div>
<b>a word:</b> error, warning, notice, info, debug<div style="height: 1.00em;">
&#160;</div>
The options -v4, -vn and -vnotice are functionally equivalent, as are the mixed/upper-case versions -vN, -vNotice and -vNOTICE.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--version</b></dt>
<dd>
Print duplicity's version and quit.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>--volsize </b><i>number</i></dt>
<dd>
Change the volume size to <i>number</i> Mb. Default is 25Mb.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>ENVIRONMENT VARIABLES</h1><dl>
<dt>
<b>TMPDIR, TEMP, TMP</b></dt>
<dd>
In decreasing order of importance, specifies the directory to use for temporary files (inherited from Python's tempfile module).</dd>
</dl>
<dl>
<dt>
<b>FTP_PASSWORD</b></dt>
<dd>
Supported by most backends which are password capable. More secure than setting it in the backend url (which might be readable in the operating systems process listing to other users on the same machine).</dd>
</dl>
<dl>
<dt>
<b>PASSPHRASE</b></dt>
<dd>
This passphrase is passed to GnuPG. If this is not set, the user will be prompted for the passphrase.</dd>
</dl>
<dl>
<dt>
<b>SIGN_PASSPHRASE</b></dt>
<dd>
The passphrase to be used for <b>--sign-key</b> , if SIGN_PASSPHRASE is not set but PASSPHRASE is set, the latter will be used. Otherwise, if no passphrase is available, the user will be prompted for it.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>URL FORMAT</h1> Duplicity tries to maintain a standard URL format as much as possible. The generic format for a URL is:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
scheme://user[:password]@host[:port]/[/]path</div>
<div class="spacer">
</div>
It is not recommended to expose the password on the command line since it could be revealed to anyone with permissions to do process listings, however, it is permitted. Consider setting the environment variable FTP_PASSWORD instead, which is supported by most, but not all backends. Regardless of its name it can be used with other backends.<div class="spacer">
</div>
In protocols that support it, the path may be preceded by a single slash, '/path', to represent a relative path to the target home directory, or preceded by a double slash, '//path', to represent an absolute filesystem path.<div class="spacer">
</div>
Formats of each of the URL schemes follow:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
cf+http://container_name<div class="spacer">
</div>
file:///some_dir<div class="spacer">
</div>
ftp[s]://user[:password]@other.host[:port]/some_dir<div class="spacer">
</div>
hsi://user[:password]@other.host/some_dir<div class="spacer">
</div>
imap[s]://user[:password]@host.com[/from_address_prefix]<div style="height: 0.00em;">
&#160;</div>
see also <b>A NOTE ON IMAP</b><div class="spacer">
</div>
<b>using rsync daemon</b><div style="height: 0.00em;">
&#160;</div>
rsync://user[:password]@host.com[:port]::[/]module/some_dir<div class="spacer">
</div>
<b>using rsync over ssh (only key auth)</b><div style="height: 0.00em;">
&#160;</div>
rsync://user@host.com[:port]/relative_path<div style="height: 0.00em;">
&#160;</div>
rsync://user@host.com[:port]//absolute_path<div class="spacer">
</div>
s3://host/bucket_name[/prefix]<div style="height: 0.00em;">
&#160;</div>
s3+http://bucket_name[/prefix]<div style="height: 0.00em;">
&#160;</div>
see also <b>A NOTE ON EUROPEAN S3 BUCKETS</b><div class="spacer">
</div>
<b>Ubuntu One</b><div style="height: 0.00em;">
&#160;</div>
u1://host/volume_path<div style="height: 0.00em;">
&#160;</div>
u1+http://volume_path<div style="height: 0.00em;">
&#160;</div>
see also <b>A NOTE ON UBUNTU ONE</b><div style="height: 0.00em;">
&#160;</div>
<div class="spacer">
</div>
scp://.. or ssh://.. are synonymous with<div style="height: 0.00em;">
&#160;</div>
sftp://user[:password]@other.host[:port]/[/]some_dir<div style="height: 0.00em;">
&#160;</div>
see also <b>--use-scp</b><div class="spacer">
</div>
tahoe://alias/directory<div class="spacer">
</div>
webdav[s]://user[:password]@other.host/some_dir<div class="spacer">
</div>
gdocs://user[:password]@other.host/some_dir<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>TIME FORMATS</h1> duplicity uses time strings in two places.  Firstly, many of the files duplicity creates will have the time in their filenames in the w3 datetime format as described in a w3 note at http://www.w3.org/TR/NOTE-datetime.  Basically they look like &quot;2001-07-15T04:09:38-07:00&quot;, which means what it looks like.  The &quot;-07:00&quot; section means the time zone is 7 hours behind UTC.<div class="spacer">
</div>
Secondly, the <b>-t</b>, <b>--time</b>, and <b>--restore-time</b> options take a time string, which can be given in any of several formats:<dl>
<dt>
1.</dt>
<dd>
the string &quot;now&quot; (refers to the current time)</dd>
</dl>
<dl>
<dt>
2.</dt>
<dd>
a sequences of digits, like &quot;123456890&quot; (indicating the time in seconds after the epoch)</dd>
</dl>
<dl>
<dt>
3.</dt>
<dd>
A string like &quot;2002-01-25T07:00:00+02:00&quot; in datetime format</dd>
</dl>
<dl>
<dt>
4.</dt>
<dd>
An interval, which is a number followed by one of the characters s, m, h, D, W, M, or Y (indicating seconds, minutes, hours, days, weeks, months, or years respectively), or a series of such pairs.  In this case the string refers to the time that preceded the current time by the length of the interval.  For instance, &quot;1h78m&quot; indicates the time that was one hour and 78 minutes ago.  The calendar here is unsophisticated: a month is always 30 days, a year is always 365 days, and a day is always 86400 seconds.</dd>
</dl>
<dl>
<dt>
5.</dt>
<dd>
A date format of the form YYYY/MM/DD, YYYY-MM-DD, MM/DD/YYYY, or MM-DD-YYYY, which indicates midnight on the day in question, relative to the current time zone settings.  For instance, &quot;2002/3/5&quot;, &quot;03-05-2002&quot;, and &quot;2002-3-05&quot; all mean March 5th, 2002.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>FILE SELECTION</h1> duplicity accepts the same file selection options <b>rdiff-backup</b> does, including --exclude, --exclude-filelist-stdin, etc.<div style="height: 1.00em;">
&#160;</div>
When duplicity is run, it searches through the given source directory and backs up all the files specified by the file selection system.  The file selection system comprises a number of file selection conditions, which are set using one of the following command line options: <b>--exclude</b>, <b>--exclude-device-files</b>, <b>--exclude-filelist</b>, <b>--exclude-filelist-stdin</b>, <b>--exclude-globbing-filelist</b>, <b>--exclude-regexp</b>, <b>--include</b>, <b>--include-filelist</b>, <b>--include-filelist-stdin</b>, <b>--include-globbing-filelist</b>, and <b>--include-regexp</b>. Each file selection condition either matches or doesn't match a given file.  A given file is excluded by the file selection system exactly when the first matching file selection condition specifies that the file be excluded; otherwise the file is included.<div style="height: 1.00em;">
&#160;</div>
For instance,<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity --include /usr --exclude /usr /usr scp://user@host/backup</div>
<div class="spacer">
</div>
is exactly the same as<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity /usr scp://user@host/backup</div>
<div class="spacer">
</div>
because the include and exclude directives match exactly the same files, and the <b>--include</b> comes first, giving it precedence.  Similarly,<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
duplicity --include /usr/local/bin --exclude /usr/local /usr scp://user@host/backup</div>
<div class="spacer">
</div>
would backup the /usr/local/bin directory (and its contents), but not /usr/local/doc.<div style="height: 1.00em;">
&#160;</div>
The <b>include</b>, <b>exclude</b>, <b>include-globbing-filelist</b>, and <b>exclude-globbing-filelist</b> options accept <i>extended shell globbing patterns</i>. These patterns can contain the special patterns <b>*</b>, <b>**</b>, <b>?</b>, and <b>[...]</b>. As in a normal shell, <b>*</b> can be expanded to any string of characters not containing &quot;/&quot;, <b>?</b> expands to any character except &quot;/&quot;, and <b>[...]</b> expands to a single character of those characters specified (ranges are acceptable).  The new special pattern, <b>**</b>, expands to any string of characters whether or not it contains &quot;/&quot;. Furthermore, if the pattern starts with &quot;ignorecase:&quot; (case insensitive), then this prefix will be removed and any character in the string can be replaced with an upper- or lowercase version of itself.<div style="height: 1.00em;">
&#160;</div>
Remember that you may need to quote these characters when typing them into a shell, so the shell does not interpret the globbing patterns before duplicity sees them.<div style="height: 1.00em;">
&#160;</div>
The <b>--exclude </b><i>pattern</i> option matches a file iff:<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
<b>1.</b></dt>
<dd>
<i>pattern</i> can be expanded into the file's filename, or<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>2.</b></dt>
<dd>
the file is inside a directory matched by the option.</dd>
</dl>
Conversely, <b>--include </b><i>pattern</i> matches a file iff:<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
<b>1.</b></dt>
<dd>
<i>pattern</i> can be expanded into the file's filename,<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>2.</b></dt>
<dd>
the file is inside a directory matched by the option, or<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>3.</b></dt>
<dd>
the file is a directory which contains a file matched by the option.</dd>
</dl>
For example,<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
<b>--exclude</b> /usr/local</div>
<div class="spacer">
</div>
matches /usr/local, /usr/local/lib, and /usr/local/lib/netscape.  It is the same as --exclude /usr/local --exclude '/usr/local/**'.<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
<b>--include</b> /usr/local</div>
<div class="spacer">
</div>
specifies that /usr, /usr/local, /usr/local/lib, and /usr/local/lib/netscape (but not /usr/doc) all be backed up.  Thus you don't have to worry about including parent directories to make sure that included subdirectories have somewhere to go.  Finally,<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
<b>--include</b> ignorecase:'/usr/[a-z0-9]foo/*/**.py'</div>
<div class="spacer">
</div>
would match a file like /usR/5fOO/hello/there/world.py.  If it did match anything, it would also match /usr.  If there is no existing file that the given pattern can be expanded into, the option will not match /usr.<div style="height: 1.00em;">
&#160;</div>
The <b>--include-filelist</b>, <b>--exclude-filelist</b>, <b>--include-filelist-stdin</b>, and <b>--exclude-filelist-stdin</b> options also introduce file selection conditions.  They direct duplicity to read in a file, each line of which is a file specification, and to include or exclude the matching files.  Lines are separated by newlines or nulls, depending on whether the --null-separator switch was given.  Each line in a filelist is interpreted similarly to the way <i>extended shell patterns</i> are, with a few exceptions:<div style="height: 1.00em;">
&#160;</div>
<dl>
<dt>
<b>1.</b></dt>
<dd>
Globbing patterns like <b>*</b>, <b>**</b>, <b>?</b>, and <b>[...]</b> are not expanded.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>2.</b></dt>
<dd>
Include patterns do not match files in a directory that is included. So /usr/local in an include file will not match /usr/local/doc.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>3.</b></dt>
<dd>
Lines starting with &quot;+ &quot; are interpreted as include directives, even if found in a filelist referenced by <b>--exclude-filelist</b>. Similarly, lines starting with &quot;- &quot; exclude files even if they are found within an include filelist.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
For example, if file &quot;list.txt&quot; contains the lines:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
/usr/local</div>
<div style="margin-left: 5.00ex;">
- /usr/local/doc</div>
<div style="margin-left: 5.00ex;">
/usr/local/bin</div>
<div style="margin-left: 5.00ex;">
+ /var</div>
<div style="margin-left: 5.00ex;">
- /var<div style="height: 1.00em;">
&#160;</div>
</div>
then &quot;--include-filelist list.txt&quot; would include /usr, /usr/local, and /usr/local/bin.  It would exclude /usr/local/doc, /usr/local/doc/python, etc.  It neither excludes nor includes /usr/local/man, leaving the fate of this directory to the next specification condition.  Finally, it is undefined what happens with /var.  A single file list should not contain conflicting file specifications.<div style="height: 1.00em;">
&#160;</div>
The <b>--include-globbing-filelist</b> and <b>--exclude-globbing-filelist</b> options also specify filelists, but each line in the filelist will be interpreted as a globbing pattern the way <b>--include</b> and <b>--exclude</b> options are interpreted (although &quot;+ &quot; and &quot;- &quot; prefixing is still allowed).  For instance, if the file &quot;globbing-list.txt&quot; contains the lines:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 5.00ex;">
dir/foo</div>
<div style="margin-left: 5.00ex;">
+ dir/bar</div>
<div style="margin-left: 5.00ex;">
- **<div style="height: 1.00em;">
&#160;</div>
</div>
Then &quot;--include-globbing-filelist globbing-list.txt&quot; would be exactly the same as specifying &quot;--include dir/foo --include dir/bar --exclude **&quot; on the command line.<div style="height: 1.00em;">
&#160;</div>
Finally, the <b>--include-regexp</b> and <b>--exclude-regexp</b> allow files to be included and excluded if their filenames match a python regular expression.  Regular expression syntax is too complicated to explain here, but is covered in Python's library reference.  Unlike the <b>--include</b> and <b>--exclude</b> options, the regular expression options don't match files containing or contained in matched files.  So for instance<div class="spacer">
</div>
<div style="margin-left: 5.00ex;">
--include '[0-9]{7}(?!foo)'</div>
<div class="spacer">
</div>
matches any files whose full pathnames contain 7 consecutive digits which aren't followed by 'foo'.  However, it wouldn't match /home even if /home/ben/1234567 existed.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>A NOTE ON EUROPEAN S3 BUCKETS</h1> Amazon S3 provides the ability to choose the location of a bucket upon its creation. The purpose is to enable the user to choose a location which is better located network topologically relative to the user, because it may allow for faster data transfers.<div class="spacer">
</div>
duplicity will create a new bucket the first time a bucket access is attempted. At this point, the bucket will be created in Europe if <b>--s3-european-buckets</b> was given. For reasons having to do with how the Amazon S3 service works, this also requires the use of the <b>--s3-use-new-style</b> option. This option turns on subdomain based bucket addressing in S3. The details are beyond the scope of this man page, but it is important to know that your bucket must not contain upper case letters or any other characters that are not valid parts of a hostname. Consequently, for reasons of backwards compatibility, use of subdomain based bucket addressing is not enabled by default.<div class="spacer">
</div>
Note that you will need to use <b>--s3-use-new-style</b> for all operations on European buckets; not just upon initial creation.<div class="spacer">
</div>
You only need to use <b>--s3-european-buckets</b> upon initial creation, but you may may use it at all times for consistency.<div class="spacer">
</div>
Further note that when creating a new European bucket, it can take a while before the bucket is fully accessible. At the time of this writing it is unclear to what extent this is an expected feature of Amazon S3, but in practice you may experience timeouts, socket errors or HTTP errors when trying to upload files to your newly created bucket. Give it a few minutes and the bucket should function normally.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>A NOTE ON IMAP</h1> An IMAP account can be used as a target for the upload.  The userid may be specified and the password will be requested.<div class="spacer">
</div>
The <b>from_address_prefix</b> may be specified (and probably should be). The text will be used as the &quot;From&quot; address in the IMAP server.  Then on a restore (or list) command the <b>from_address_prefix</b> will distinguish between different backups.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>A NOTE ON UBUNTU ONE</h1> Connecting to Ubuntu One requires that you be running duplicity inside of an X session so that you can be prompted for your credentials if necessary by the Ubuntu One session daemon.<div class="spacer">
</div>
See https://one.ubuntu.com/ for more information about Ubuntu One.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>A NOTE ON SYMMETRIC ENCRYPTION AND SIGNING</h1> Signing and symmetrically encrypt at the same time with the gpg binary on the command line, as used within duplicity, is a specifically challenging issue. Tests showed that the following combinations proved working.<div class="spacer">
</div>
1. Setup gpg-agent properly. Use the option <b>--use-agent</b> and enter both passphrases (symmetric and sign key) in the gpg-agent's dialog.<div class="spacer">
</div>
2. Use a <b>PASSPHRASE</b> for symmetric encryption of your choice but the signing key has an <b>empty</b> passphrase.<div class="spacer">
</div>
3. The used <b>PASSPHRASE</b> for symmetric encryption and the passphrase of the signing key are identical.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>KNOWN ISSUES / BUGS</h1> Hard links currently unsupported (they will be treated as non-linked regular files).<div style="height: 1.00em;">
&#160;</div>
Bad signatures will be treated as empty instead of logging appropriate error message.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>OPERATION AND DATA FORMATS</h1> This section describes duplicity's basic operation and the format of its data files.  It should not necessary to read this section to use duplicity.<div style="height: 1.00em;">
&#160;</div>
The files used by duplicity to store backup data are tarfiles in GNU tar format.  They can be produced independently by <b>rdiffdir</b>(1). For incremental backups, new files are saved normally in the tarfile. But when a file changes, instead of storing a complete copy of the file, only a diff is stored, as generated by <b>rdiff</b>(1). If a file is deleted, a 0 length file is stored in the tar.  It is possible to restore a duplicity archive &quot;manually&quot; by using <b>tar</b> and then <b>cp</b>, <b>rdiff</b>, and <b>rm</b> as necessary.  These duplicity archives have the extension <b>difftar</b>.<div style="height: 1.00em;">
&#160;</div>
Both full and incremental backup sets have the same format.  In effect, a full backup set is an incremental one generated from an empty signature (see below).  The files in full backup sets will start with <b>duplicity-full</b> while the incremental sets start with <b>duplicity-inc</b>. When restoring, duplicity applies patches in order, so deleting, for instance, a full backup set may make related incremental backup sets unusable.<div style="height: 1.00em;">
&#160;</div>
In order to determine which files have been deleted, and to calculate diffs for changed files, duplicity needs to process information about previous sessions.  It stores this information in the form of tarfiles where each entry's data contains the signature (as produced by <b>rdiff</b>) of the file instead of the file's contents.  These signature sets have the extension <b>sigtar</b>.<div style="height: 1.00em;">
&#160;</div>
Signature files are not required to restore a backup set, but without an up-to-date signature, duplicity cannot append an incremental backup to an existing archive.<div style="height: 1.00em;">
&#160;</div>
To save bandwidth, duplicity generates full signature sets and incremental signature sets.  A full signature set is generated for each full backup, and an incremental one for each incremental backup. These start with <b>duplicity-full-signatures</b> and <b>duplicity-new-signatures</b> respectively. These signatures will be stored both locally and remotely. The remote signatures will be encrypted if encryption is enabled. The local signatures will not be encrypted and stored in the archive dir (see <b>--archive-dir</b> ).<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>AUTHOR</h1> Original Author - Ben Escoto &lt;bescoto@stanford.edu&gt;<div style="height: 1.00em;">
&#160;</div>
Current Maintainer - Kenneth Loafman &lt;kenneth@loafman.com&gt;<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>SEE ALSO</h1> <b>rdiffdir</b>(1), <b>python</b>(1), <b>rdiff</b>(1), <b>rdiff-backup</b>(1).</div>
<table class="foot">
<tr>
<td class="foot-date">
February 29, 2012</td>
<td class="foot-os">
Version 0.6.18</td>
</tr>
</table>
</div>
</body>
</html>

