<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
Net::SMTP(3perl)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
Net::SMTP(3perl)</td>
<td class="head-vol">
Perl Programmers Reference Guide</td>
<td class="head-rtitle">
Net::SMTP(3perl)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Net::SMTP - Simple Mail Transfer Protocol Client</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
    use Net::SMTP;<br/>
<br/>
    # Constructors<br/>
    $smtp = Net::SMTP-&gt;new('mailhost');<br/>
    $smtp = Net::SMTP-&gt;new('mailhost', Timeout =&gt; 60);<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> This module implements a client interface to the SMTP and ESMTP protocol, enabling a perl5 application to talk to SMTP servers. This documentation assumes that you are familiar with the concepts of the SMTP protocol described in RFC821.<div class="spacer">
</div>
A new Net::SMTP object must be created with the <i>new</i> method. Once this has been done, all SMTP commands are accessed through this object.<div class="spacer">
</div>
The Net::SMTP class is a subclass of Net::Cmd and IO::Socket::INET.</div>
<div class="section">
<h1>EXAMPLES</h1> This example prints the mail domain name of the SMTP server known as mailhost:<div class="spacer">
</div>
<br/>
    #!/usr/local/bin/perl -w<br/>
<br/>
    use Net::SMTP;<br/>
<br/>
    $smtp = Net::SMTP-&gt;new('mailhost');<br/>
    print $smtp-&gt;domain,&quot;\n&quot;;<br/>
    $smtp-&gt;quit;<br/>
<div class="spacer">
</div>
This example sends a small message to the postmaster at the SMTP server known as mailhost:<div class="spacer">
</div>
<br/>
    #!/usr/local/bin/perl -w<br/>
<br/>
    use Net::SMTP;<br/>
<br/>
    $smtp = Net::SMTP-&gt;new('mailhost');<br/>
<br/>
    $smtp-&gt;mail($ENV{USER});<br/>
    $smtp-&gt;to('postmaster');<br/>
<br/>
    $smtp-&gt;data();<br/>
    $smtp-&gt;datasend(&quot;To: postmaster\n&quot;);<br/>
    $smtp-&gt;datasend(&quot;\n&quot;);<br/>
    $smtp-&gt;datasend(&quot;A simple test message\n&quot;);<br/>
    $smtp-&gt;dataend();<br/>
<br/>
    $smtp-&gt;quit;<br/>
</div>
<div class="section">
<h1>CONSTRUCTOR</h1><dl>
<dt>
new ( [ HOST ] [, OPTIONS ] )</dt>
<dd>
This is the constructor for a new Net::SMTP object. &quot;HOST&quot; is the name of the remote host to which an SMTP connection is required.<div style="height: 1.00em;">
&#160;</div>
&quot;HOST&quot; is optional. If &quot;HOST&quot; is not given then it may instead be passed as the &quot;Host&quot; option described below. If neither is given then the &quot;SMTP_Hosts&quot; specified in &quot;Net::Config&quot; will be used.<div style="height: 1.00em;">
&#160;</div>
&quot;OPTIONS&quot; are passed in a hash like fashion, using key and value pairs. Possible options are:<div style="height: 1.00em;">
&#160;</div>
<b>Hello</b> - SMTP requires that you identify yourself. This option specifies a string to pass as your mail domain. If not given localhost.localdomain will be used.<div style="height: 1.00em;">
&#160;</div>
<b>Host</b> - SMTP host to connect to. It may be a single scalar, as defined for the &quot;PeerAddr&quot; option in IO::Socket::INET, or a reference to an array with hosts to try in turn. The &quot;host&quot; method will return the value which was used to connect to the host.<div style="height: 1.00em;">
&#160;</div>
<b>LocalAddr</b> and <b>LocalPort</b> - These parameters are passed directly to IO::Socket to allow binding the socket to a local port.<div style="height: 1.00em;">
&#160;</div>
<b>Timeout</b> - Maximum time, in seconds, to wait for a response from the SMTP server (default: 120)<div style="height: 1.00em;">
&#160;</div>
<b>ExactAddresses</b> - If true the all ADDRESS arguments must be as defined by &quot;addr-spec&quot; in RFC2822. If not given, or false, then Net::SMTP will attempt to extract the address from the value passed.<div style="height: 1.00em;">
&#160;</div>
<b>Debug</b> - Enable debugging information<div style="height: 1.00em;">
&#160;</div>
<b>Port</b> - Select a port on the remote host to connect to (default is 25)<div style="height: 1.00em;">
&#160;</div>
Example:<div style="height: 1.00em;">
&#160;</div>
<br/>
    $smtp = Net::SMTP-&gt;new('mailhost',<br/>
                           Hello =&gt; 'my.mail.domain',<br/>
                           Timeout =&gt; 30,<br/>
                           Debug   =&gt; 1,<br/>
                          );<br/>
<br/>
    # the same<br/>
    $smtp = Net::SMTP-&gt;new(<br/>
                           Host =&gt; 'mailhost',<br/>
                           Hello =&gt; 'my.mail.domain',<br/>
                           Timeout =&gt; 30,<br/>
                           Debug   =&gt; 1,<br/>
                          );<br/>
<br/>
    # Connect to the default server from Net::config<br/>
    $smtp = Net::SMTP-&gt;new(<br/>
                           Hello =&gt; 'my.mail.domain',<br/>
                           Timeout =&gt; 30,<br/>
                          );<br/>
</dd>
</dl>
</div>
<div class="section">
<h1>METHODS</h1> Unless otherwise stated all methods return either a  <i>true</i> or <i>false</i> value, with  <i>true</i> meaning that the operation was a success. When a method states that it returns a value, failure will be returned as  <i>undef</i> or an empty list.<dl>
<dt>
banner ()</dt>
<dd>
Returns the banner message which the server replied with when the initial connection was made.</dd>
</dl>
<dl>
<dt>
domain ()</dt>
<dd>
Returns the domain that the remote SMTP server identified itself as during connection.</dd>
</dl>
<dl>
<dt>
hello ( DOMAIN )</dt>
<dd>
Tell the remote server the mail domain which you are in using the EHLO command (or HELO if EHLO fails).  Since this method is invoked automatically when the Net::SMTP object is constructed the user should normally not have to call it manually.</dd>
</dl>
<dl>
<dt>
host ()</dt>
<dd>
Returns the value used by the constructor, and passed to IO::Socket::INET, to connect to the host.</dd>
</dl>
<dl>
<dt>
etrn ( DOMAIN )</dt>
<dd>
Request a queue run for the DOMAIN given.</dd>
</dl>
<dl>
<dt>
auth ( USERNAME, PASSWORD )</dt>
<dd>
Attempt SASL authentication.</dd>
</dl>
<dl>
<dt>
mail ( ADDRESS [, OPTIONS] )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
send ( ADDRESS )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
send_or_mail ( ADDRESS )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
send_and_mail ( ADDRESS )</dt>
<dd>
Send the appropriate command to the server MAIL, SEND, SOML or SAML. &quot;ADDRESS&quot; is the address of the sender. This initiates the sending of a message. The method &quot;recipient&quot; should be called for each address that the message is to be sent to.<div style="height: 1.00em;">
&#160;</div>
The &quot;mail&quot; method can some additional ESMTP OPTIONS which is passed in hash like fashion, using key and value pairs.  Possible options are:<div style="height: 1.00em;">
&#160;</div>
<br/>
 Size        =&gt; &lt;bytes&gt;<br/>
 Return      =&gt; &quot;FULL&quot; | &quot;HDRS&quot;<br/>
 Bits        =&gt; &quot;7&quot; | &quot;8&quot; | &quot;binary&quot;<br/>
 Transaction =&gt; &lt;ADDRESS&gt;<br/>
 Envelope    =&gt; &lt;ENVID&gt;     # xtext-encodes its argument<br/>
 ENVID       =&gt; &lt;ENVID&gt;     # similar to Envelope, but expects argument encoded<br/>
 XVERP       =&gt; 1<br/>
 AUTH        =&gt; &lt;submitter&gt; # encoded address according to RFC 2554<br/>
<div style="height: 1.00em;">
&#160;</div>
The &quot;Return&quot; and &quot;Envelope&quot; parameters are used for DSN (Delivery Status Notification).<div style="height: 1.00em;">
&#160;</div>
The submitter address in &quot;AUTH&quot; option is expected to be in a format as required by RFC 2554, in an RFC2821-quoted form and xtext-encoded, or &lt;&gt; .</dd>
</dl>
<dl>
<dt>
reset ()</dt>
<dd>
Reset the status of the server. This may be called after a message has been initiated, but before any data has been sent, to cancel the sending of the message.</dd>
</dl>
<dl>
<dt>
recipient ( ADDRESS [, ADDRESS, [...]] [, OPTIONS ] )</dt>
<dd>
Notify the server that the current message should be sent to all of the addresses given. Each address is sent as a separate command to the server. Should the sending of any address result in a failure then the process is aborted and a  <i>false</i> value is returned. It is up to the user to call &quot;reset&quot; if they so desire.<div style="height: 1.00em;">
&#160;</div>
The &quot;recipient&quot; method can also pass additional case-sensitive OPTIONS as an anonymous hash using key and value pairs.  Possible options are:<div style="height: 1.00em;">
&#160;</div>
<br/>
  Notify  =&gt; ['NEVER'] or ['SUCCESS','FAILURE','DELAY']  (see below)<br/>
  ORcpt   =&gt; &lt;ORCPT&gt;<br/>
  SkipBad =&gt; 1        (to ignore bad addresses)<br/>
<div style="height: 1.00em;">
&#160;</div>
If &quot;SkipBad&quot; is true the &quot;recipient&quot; will not return an error when a bad address is encountered and it will return an array of addresses that did succeed.<div style="height: 1.00em;">
&#160;</div>
<br/>
  $smtp-&gt;recipient($recipient1,$recipient2);  # Good<br/>
  $smtp-&gt;recipient($recipient1,$recipient2, { SkipBad =&gt; 1 });  # Good<br/>
  $smtp-&gt;recipient($recipient1,$recipient2, { Notify =&gt; ['FAILURE','DELAY'], SkipBad =&gt; 1 });  # Good<br/>
  @goodrecips=$smtp-&gt;recipient(@recipients, { Notify =&gt; ['FAILURE'], SkipBad =&gt; 1 });  # Good<br/>
  $smtp-&gt;recipient(&quot;$recipient,$recipient2&quot;); # BAD<br/>
<div style="height: 1.00em;">
&#160;</div>
Notify is used to request Delivery Status Notifications (DSNs), but your SMTP/ESMTP service may not respect this request depending upon its version and your site's SMTP configuration.<div style="height: 1.00em;">
&#160;</div>
Leaving out the Notify option usually defaults an SMTP service to its default behavior equivalent to ['FAILURE'] notifications only, but again this may be dependent upon your site's SMTP configuration.<div style="height: 1.00em;">
&#160;</div>
The NEVER keyword must appear by itself if used within the Notify option and &quot;requests that a DSN not be returned to the sender under any conditions.&quot;<div style="height: 1.00em;">
&#160;</div>
<br/>
  {Notify =&gt; ['NEVER']}<br/>
<br/>
  $smtp-&gt;recipient(@recipients, { Notify =&gt; ['NEVER'], SkipBad =&gt; 1 });  # Good<br/>
<div style="height: 1.00em;">
&#160;</div>
You may use any combination of these three values 'SUCCESS','FAILURE','DELAY' in the anonymous array reference as defined by RFC3461 (see http://rfc.net/rfc3461.html for more information.  Note: quotations in this topic from same.).<div style="height: 1.00em;">
&#160;</div>
A Notify parameter of 'SUCCESS' or 'FAILURE' &quot;requests that a DSN be issued on successful delivery or delivery failure, respectively.&quot;<div style="height: 1.00em;">
&#160;</div>
A Notify parameter of 'DELAY' &quot;indicates the sender's willingness to receive delayed DSNs.  Delayed DSNs may be issued if delivery of a message has been delayed for an unusual amount of time (as determined by the Message Transfer Agent (MTA) at which the message is delayed), but the final delivery status (whether successful or failure) cannot be determined.  The absence of the DELAY keyword in a NOTIFY parameter requests that a &quot;delayed&quot; DSN NOT be issued under any conditions.&quot;<div style="height: 1.00em;">
&#160;</div>
<br/>
  {Notify =&gt; ['SUCCESS','FAILURE','DELAY']}<br/>
<br/>
  $smtp-&gt;recipient(@recipients, { Notify =&gt; ['FAILURE','DELAY'], SkipBad =&gt; 1 });  # Good<br/>
<div style="height: 1.00em;">
&#160;</div>
ORcpt is also part of the SMTP DSN extension according to RFC3461. It is used to pass along the original recipient that the mail was first sent to.  The machine that generates a DSN will use this address to inform the sender, because he can't know if recipients get rewritten by mail servers. It is expected to be in a format as required by RFC3461, xtext-encoded.</dd>
</dl>
<dl>
<dt>
to ( ADDRESS [, ADDRESS [...]] )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
cc ( ADDRESS [, ADDRESS [...]] )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
bcc ( ADDRESS [, ADDRESS [...]] )</dt>
<dd>
Synonyms for &quot;recipient&quot;.</dd>
</dl>
<dl>
<dt>
data ( [ DATA ] )</dt>
<dd>
Initiate the sending of the data from the current message.<div style="height: 1.00em;">
&#160;</div>
&quot;DATA&quot; may be a reference to a list or a list. If specified the contents of &quot;DATA&quot; and a termination string &quot;.\r\n&quot; is sent to the server. And the result will be true if the data was accepted.<div style="height: 1.00em;">
&#160;</div>
If &quot;DATA&quot; is not specified then the result will indicate that the server wishes the data to be sent. The data must then be sent using the &quot;datasend&quot; and &quot;dataend&quot; methods described in Net::Cmd.</dd>
</dl>
<dl>
<dt>
expand ( ADDRESS )</dt>
<dd>
Request the server to expand the given address Returns an array which contains the text read from the server.</dd>
</dl>
<dl>
<dt>
verify ( ADDRESS )</dt>
<dd>
Verify that &quot;ADDRESS&quot; is a legitimate mailing address.<div style="height: 1.00em;">
&#160;</div>
Most sites usually disable this feature in their SMTP service configuration. Use &quot;Debug =&gt; 1&quot; option under  <i>new()</i> to see if disabled.</dd>
</dl>
<dl>
<dt>
help ( [ $subject ] )</dt>
<dd>
Request help text from the server. Returns the text or undef upon failure</dd>
</dl>
<dl>
<dt>
quit ()</dt>
<dd>
Send the QUIT command to the remote SMTP server and close the socket connection.</dd>
</dl>
</div>
<div class="section">
<h1>ADDRESSES</h1> Net::SMTP attempts to DWIM with addresses that are passed. For example an application might extract The From: line from an email and pass that to  <i>mail()</i>. While this may work, it is not recommended. The application should really use a module like Mail::Address to extract the mail address and pass that.<div class="spacer">
</div>
If &quot;ExactAddresses&quot; is passed to the constructor, then addresses should be a valid rfc2821-quoted address, although Net::SMTP will accept accept the address surrounded by angle brackets.<div class="spacer">
</div>
<br/>
 funny user@domain      WRONG<br/>
 &quot;funny user&quot;@domain    RIGHT, recommended<br/>
 &lt;&quot;funny user&quot;@domain&gt;  OK<br/>
</div>
<div class="section">
<h1>SEE ALSO</h1> Net::Cmd</div>
<div class="section">
<h1>AUTHOR</h1> Graham Barr &lt;gbarr@pobox.com&gt;</div>
<div class="section">
<h1>COPYRIGHT</h1> Copyright (c) 1995-2004 Graham Barr. All rights reserved. This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</div>
<table class="foot">
<tr>
<td class="foot-date">
2016-03-01</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

