<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
Test::Builder::Tester(3perl)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
Test::Builder::Tester(3perl)</td>
<td class="head-vol">
Perl Programmers Reference Guide</td>
<td class="head-rtitle">
Test::Builder::Tester(3perl)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Test::Builder::Tester - test testsuites that have been built with Test::Builder</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
    use Test::Builder::Tester tests =&gt; 1;<br/>
    use Test::More;<br/>
<br/>
    test_out(&quot;not ok 1 - foo&quot;);<br/>
    test_fail(+1);<br/>
    fail(&quot;foo&quot;);<br/>
    test_test(&quot;fail works&quot;);<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> A module that helps you test testing modules that are built with  <b>Test::Builder</b>.<div class="spacer">
</div>
The testing system is designed to be used by performing a three step process for each test you wish to test.  This process starts with using &quot;test_out&quot; and &quot;test_err&quot; in advance to declare what the testsuite you are testing will output with  <b>Test::Builder</b> to stdout and stderr.<div class="spacer">
</div>
You then can run the test(s) from your test suite that call  <b>Test::Builder</b>.  At this point the output of <b>Test::Builder</b> is safely captured by  <b>Test::Builder::Tester</b> rather than being interpreted as real test output.<div class="spacer">
</div>
The final stage is to call &quot;test_test&quot; that will simply compare what you predeclared to what  <b>Test::Builder</b> actually outputted, and report the results back with a &quot;ok&quot; or &quot;not ok&quot; (with debugging) to the normal output.<div class="subsection">
<h2>Functions</h2> These are the six methods that are exported as default.<dl>
<dt>
test_out</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
test_err</dt>
<dd>
Procedures for predeclaring the output that your test suite is expected to produce until &quot;test_test&quot; is called.  These procedures automatically assume that each line terminates with &quot;\n&quot;.  So<div style="height: 1.00em;">
&#160;</div>
<br/>
   test_out(&quot;ok 1&quot;,&quot;ok 2&quot;);<br/>
<div style="height: 1.00em;">
&#160;</div>
is the same as<div style="height: 1.00em;">
&#160;</div>
<br/>
   test_out(&quot;ok 1\nok 2&quot;);<br/>
<div style="height: 1.00em;">
&#160;</div>
which is even the same as<div style="height: 1.00em;">
&#160;</div>
<br/>
   test_out(&quot;ok 1&quot;);<br/>
   test_out(&quot;ok 2&quot;);<br/>
<div style="height: 1.00em;">
&#160;</div>
Once &quot;test_out&quot; or &quot;test_err&quot; (or &quot;test_fail&quot; or &quot;test_diag&quot;) have been called, all further output from  <b>Test::Builder</b> will be captured by  <b>Test::Builder::Tester</b>.  This means that you will not be able perform further tests to the normal output in the normal way until you call &quot;test_test&quot; (well, unless you manually meddle with the output filehandles)</dd>
</dl>
<dl>
<dt>
test_fail</dt>
<dd>
Because the standard failure message that <b>Test::Builder</b> produces whenever a test fails will be a common occurrence in your test error output, and because it has changed between Test::Builder versions, rather than forcing you to call &quot;test_err&quot; with the string all the time like so<div style="height: 1.00em;">
&#160;</div>
<br/>
    test_err(&quot;# Failed test ($0 at line &quot;.line_num(+1).&quot;)&quot;);<br/>
<div style="height: 1.00em;">
&#160;</div>
&quot;test_fail&quot; exists as a convenience function that can be called instead.  It takes one argument, the offset from the current line that the line that causes the fail is on.<div style="height: 1.00em;">
&#160;</div>
<br/>
    test_fail(+1);<br/>
<div style="height: 1.00em;">
&#160;</div>
This means that the example in the synopsis could be rewritten more simply as:<div style="height: 1.00em;">
&#160;</div>
<br/>
   test_out(&quot;not ok 1 - foo&quot;);<br/>
   test_fail(+1);<br/>
   fail(&quot;foo&quot;);<br/>
   test_test(&quot;fail works&quot;);<br/>
</dd>
</dl>
<dl>
<dt>
test_diag</dt>
<dd>
As most of the remaining expected output to the error stream will be created by Test::Builder's &quot;diag&quot; function,  <b>Test::Builder::Tester</b> provides a convenience function &quot;test_diag&quot; that you can use instead of &quot;test_err&quot;.<div style="height: 1.00em;">
&#160;</div>
The &quot;test_diag&quot; function prepends comment hashes and spacing to the start and newlines to the end of the expected output passed to it and adds it to the list of expected error output.  So, instead of writing<div style="height: 1.00em;">
&#160;</div>
<br/>
   test_err(&quot;# Couldn't open file&quot;);<br/>
<div style="height: 1.00em;">
&#160;</div>
you can write<div style="height: 1.00em;">
&#160;</div>
<br/>
   test_diag(&quot;Couldn't open file&quot;);<br/>
<div style="height: 1.00em;">
&#160;</div>
Remember that <b>Test::Builder</b>'s diag function will not add newlines to the end of output and test_diag will. So to check<div style="height: 1.00em;">
&#160;</div>
<br/>
   Test::Builder-&gt;new-&gt;diag(&quot;foo\n&quot;,&quot;bar\n&quot;);<br/>
<div style="height: 1.00em;">
&#160;</div>
You would do<div style="height: 1.00em;">
&#160;</div>
<br/>
  test_diag(&quot;foo&quot;,&quot;bar&quot;)<br/>
<div style="height: 1.00em;">
&#160;</div>
without the newlines.</dd>
</dl>
<dl>
<dt>
test_test</dt>
<dd>
Actually performs the output check testing the tests, comparing the data (with &quot;eq&quot;) that we have captured from  <b>Test::Builder</b> against that that was declared with &quot;test_out&quot; and &quot;test_err&quot;.<div style="height: 1.00em;">
&#160;</div>
This takes name/value pairs that effect how the test is run.</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl>
<dt>
title (synonym 'name', 'label')</dt>
<dd>
The name of the test that will be displayed after the &quot;ok&quot; or &quot;not ok&quot;.</dd>
</dl>
<dl>
<dt>
skip_out</dt>
<dd>
Setting this to a true value will cause the test to ignore if the output sent by the test to the output stream does not match that declared with &quot;test_out&quot;.</dd>
</dl>
<dl>
<dt>
skip_err</dt>
<dd>
Setting this to a true value will cause the test to ignore if the output sent by the test to the error stream does not match that declared with &quot;test_err&quot;.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;">
<div style="height: 1.00em;">
&#160;</div>
As a convenience, if only one argument is passed then this argument is assumed to be the name of the test (as in the above examples.)<div style="height: 1.00em;">
&#160;</div>
Once &quot;test_test&quot; has been run test output will be redirected back to the original filehandles that  <b>Test::Builder</b> was connected to (probably STDOUT and STDERR,) meaning any further tests you run will function normally and cause success/errors for  <b>Test::Harness</b>.</div>
<dl>
<dt>
line_num</dt>
<dd>
A utility function that returns the line number that the function was called on.  You can pass it an offset which will be added to the result.  This is very useful for working out the correct text of diagnostic functions that contain line numbers.<div style="height: 1.00em;">
&#160;</div>
Essentially this is the same as the &quot;__LINE__&quot; macro, but the &quot;line_num(+3)&quot; idiom is arguably nicer.</dd>
</dl>
<div class="spacer">
</div>
In addition to the six exported functions there exists one function that can only be accessed with a fully qualified function call.<dl>
<dt>
color</dt>
<dd>
When &quot;test_test&quot; is called and the output that your tests generate does not match that which you declared, &quot;test_test&quot; will print out debug information showing the two conflicting versions.  As this output itself is debug information it can be confusing which part of the output is from &quot;test_test&quot; and which was the original output from your original tests.  Also, it may be hard to spot things like extraneous whitespace at the end of lines that may cause your test to fail even though the output looks similar.<div style="height: 1.00em;">
&#160;</div>
To assist you &quot;test_test&quot; can colour the background of the debug information to disambiguate the different types of output. The debug output will have its background coloured green and red.  The green part represents the text which is the same between the executed and actual output, the red shows which part differs.<div style="height: 1.00em;">
&#160;</div>
The &quot;color&quot; function determines if colouring should occur or not. Passing it a true or false value will enable or disable colouring respectively, and the function called with no argument will return the current setting.<div style="height: 1.00em;">
&#160;</div>
To enable colouring from the command line, you can use the  <b>Text::Builder::Tester::Color</b> module like so:<div style="height: 1.00em;">
&#160;</div>
<br/>
   perl -Mlib=Text::Builder::Tester::Color test.t<br/>
<div style="height: 1.00em;">
&#160;</div>
Or by including the <b>Test::Builder::Tester::Color</b> module directly in the PERL5LIB.</dd>
</dl>
</div>
</div>
<div class="section">
<h1>BUGS</h1> Calls &quot;&lt;Test::Builder-&quot;no_ending&gt;&gt; turning off the ending tests. This is needed as otherwise it will trip out because we've run more tests than we strictly should have and it'll register any failures we had that we were testing for as real failures.<div class="spacer">
</div>
The color function doesn't work unless <b>Term::ANSIColor</b> is compatible with your terminal.<div class="spacer">
</div>
Bugs (and requests for new features) can be reported to the author though the CPAN RT system: http://rt.cpan.org/NoAuth/ReportBug.html?Queue=Test-Builder-Tester &lt;http://rt.cpan.org/NoAuth/ReportBug.html?Queue=Test-Builder-Tester&gt;</div>
<div class="section">
<h1>AUTHOR</h1> Copyright Mark Fowler &lt;mark@twoshortplanks.com&gt; 2002, 2004.<div class="spacer">
</div>
Some code taken from <b>Test::More</b> and <b>Test::Catch</b>, written by by Michael G Schwern &lt;schwern@pobox.com&gt;.  Hence, those parts Copyright Micheal G Schwern 2001.  Used and distributed with permission.<div class="spacer">
</div>
This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</div>
<div class="section">
<h1>NOTES</h1> Thanks to Richard Clamp &lt;richardc@unixbeard.net&gt; for letting me use his testing system to try this module out on.</div>
<div class="section">
<h1>SEE ALSO</h1> Test::Builder, Test::Builder::Tester::Color, Test::More.</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-09-19</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

