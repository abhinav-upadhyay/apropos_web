<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
CPAN::Distroprefs(3perl)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
CPAN::Distroprefs(3perl)</td>
<td class="head-vol">
Perl Programmers Reference Guide</td>
<td class="head-rtitle">
CPAN::Distroprefs(3perl)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> CPAN::Distroprefs -- read and match distroprefs</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
    use CPAN::Distroprefs;<br/>
<br/>
    my %info = (... distribution/environment info ...);<br/>
<br/>
    my $finder = CPAN::Distroprefs-&gt;find($prefs_dir, \%ext_map);<br/>
<br/>
    while (my $result = $finder-&gt;next) {<br/>
<br/>
        die $result-&gt;as_string if $result-&gt;is_fatal;<br/>
<br/>
        warn($result-&gt;as_string), next if $result-&gt;is_warning;<br/>
<br/>
        for my $pref (@{ $result-&gt;prefs }) {<br/>
            if ($pref-&gt;matches(\%info)) {<br/>
                return $pref;<br/>
            }<br/>
        }<br/>
    }<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> This module encapsulates reading Distroprefs and matching them against CPAN distributions.</div>
<div class="section">
<h1>INTERFACE</h1><br/>
    my $finder = CPAN::Distroprefs-&gt;find($dir, \%ext_map);<br/>
<br/>
    while (my $result = $finder-&gt;next) { ... }<br/>
<div class="spacer">
</div>
Build an iterator which finds distroprefs files in the given directory.<div class="spacer">
</div>
%ext_map is a hashref whose keys are file extensions and whose values are modules used to load matching files:<div class="spacer">
</div>
<br/>
    {<br/>
        'yml' =&gt; 'YAML::Syck',<br/>
        'dd'  =&gt; 'Data::Dumper',<br/>
        ...<br/>
    }<br/>
<div class="spacer">
</div>
Each time &quot;$finder-&gt;next&quot; is called, the iterator returns one of two possible values:<dl>
<dt>
&#8226;</dt>
<dd>
a CPAN::Distroprefs::Result object</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
&quot;undef&quot;, indicating that no prefs files remain to be found</dd>
</dl>
</div>
<div class="section">
<h1>RESULTS</h1> &quot;find()&quot; returns CPAN::Distroprefs::Result objects to indicate success or failure when reading a prefs file.<div class="subsection">
<h2>Common</h2> All results share some common attributes:<div class="spacer">
</div>
<i>type</i><div class="spacer">
</div>
&quot;success&quot;, &quot;warning&quot;, or &quot;fatal&quot;<div class="spacer">
</div>
<i>file</i><div class="spacer">
</div>
the file from which these prefs were read, or to which this error refers (relative filename)<div class="spacer">
</div>
<i>ext</i><div class="spacer">
</div>
the file's extension, which determines how to load it<div class="spacer">
</div>
<i>dir</i><div class="spacer">
</div>
the directory the file was read from<div class="spacer">
</div>
<i>abs</i><div class="spacer">
</div>
the absolute path to the file</div>
<div class="subsection">
<h2>Errors</h2> Error results (warning and fatal) contain:<div class="spacer">
</div>
<i>msg</i><div class="spacer">
</div>
the error message (usually either $! or a YAML error)</div>
<div class="subsection">
<h2>Successes</h2> Success results contain:<div class="spacer">
</div>
<i>prefs</i><div class="spacer">
</div>
an arrayref of CPAN::Distroprefs::Pref objects</div>
</div>
<div class="section">
<h1>PREFS</h1> CPAN::Distroprefs::Pref objects represent individual distroprefs documents. They are constructed automatically as part of &quot;success&quot; results from &quot;find()&quot;.<div class="spacer">
</div>
<i>data</i><div class="spacer">
</div>
the pref information as a hashref, suitable for e.g. passing to Kwalify<div class="spacer">
</div>
<i>match_attributes</i><div class="spacer">
</div>
returns a list of the valid match attributes (see the Distroprefs section in CPAN)<div class="spacer">
</div>
currently: &quot;env perl perlconfig distribution module&quot;<div class="spacer">
</div>
<i>has_any_match</i><div class="spacer">
</div>
true if this pref has a 'match' attribute at all<div class="spacer">
</div>
<i>has_valid_subkeys</i><div class="spacer">
</div>
true if this pref has a 'match' attribute and at least one valid match attribute<div class="spacer">
</div>
<i>matches</i><div class="spacer">
</div>
<br/>
  if ($pref-&gt;matches(\%arg)) { ... }<br/>
<div class="spacer">
</div>
true if this pref matches the passed-in hashref, which must have a value for each of the &quot;match_attributes&quot; (above)</div>
<div class="section">
<h1>LICENSE</h1> This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-09-26</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

