<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
Tie::Memoize(3perl)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
Tie::Memoize(3perl)</td>
<td class="head-vol">
Perl Programmers Reference Guide</td>
<td class="head-rtitle">
Tie::Memoize(3perl)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Tie::Memoize - add data to hash when needed</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
  require Tie::Memoize;<br/>
  tie %hash, 'Tie::Memoize',<br/>
      \&amp;fetch,                  # The rest is optional<br/>
      $DATA, \&amp;exists,<br/>
      {%ini_value}, {%ini_existence};<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> This package allows a tied hash to autoload its values on the first access, and to use the cached value on the following accesses.<div class="spacer">
</div>
Only read-accesses (via fetching the value or &quot;exists&quot;) result in calls to the functions; the modify-accesses are performed as on a normal hash.<div class="spacer">
</div>
The required arguments during &quot;tie&quot; are the hash, the package, and the reference to the &quot;FETCH&quot;ing function.  The optional arguments are an arbitrary scalar $data, the reference to the &quot;EXISTS&quot; function, and initial values of the hash and of the existence cache.<div class="spacer">
</div>
Both the &quot;FETCH&quot;ing function and the &quot;EXISTS&quot; functions have the same signature: the arguments are &quot;$key, $data&quot;; $data is the same value as given as argument during  <i>tie()</i>ing.  Both functions should return an empty list if the value does not exist.  If &quot;EXISTS&quot; function is different from the &quot;FETCH&quot;ing function, it should return a TRUE value on success.  The &quot;FETCH&quot;ing function should return the intended value if the key is valid.</div>
<div class="section">
<h1>Inheriting from <b>Tie::Memoize</b></h1> The structure of the  <i>tied()</i> data is an array reference with elements<div class="spacer">
</div>
<br/>
  0:  cache of known values<br/>
  1:  cache of known existence of keys<br/>
  2:  FETCH  function<br/>
  3:  EXISTS function<br/>
  4:  $data<br/>
<div class="spacer">
</div>
The rest is for internal usage of this package.  In particular, if TIEHASH is overwritten, it should call SUPER::TIEHASH.</div>
<div class="section">
<h1>EXAMPLE</h1><br/>
  sub slurp {<br/>
    my ($key, $dir) = shift;<br/>
    open my $h, '&lt;', &quot;$dir/$key&quot; or return;<br/>
    local $/; &lt;$h&gt;                      # slurp it all<br/>
  }<br/>
  sub exists { my ($key, $dir) = shift; return -f &quot;$dir/$key&quot; }<br/>
<br/>
  tie %hash, 'Tie::Memoize', \&amp;slurp, $directory, \&amp;exists,<br/>
      { fake_file1 =&gt; $content1, fake_file2 =&gt; $content2 },<br/>
      { pretend_does_not_exists =&gt; 0, known_to_exist =&gt; 1 };<br/>
<div class="spacer">
</div>
This example treats the slightly modified contents of $directory as a hash.  The modifications are that the keys  <i>fake_file1</i> and  <i>fake_file2</i> fetch values $content1 and $content2, and  <i>pretend_does_not_exists</i> will never be accessed.  Additionally, the existence of  <i>known_to_exist</i> is never checked (so if it does not exists when its content is needed, the user of %hash may be confused).</div>
<div class="section">
<h1>BUGS</h1> FIRSTKEY and NEXTKEY methods go through the keys which were already read, not all the possible keys of the hash.</div>
<div class="section">
<h1>AUTHOR</h1> Ilya Zakharevich mailto:perl-module-hash-memoize@ilyaz.org &lt;mailto:perl-module-hash-memoize@ilyaz.org&gt;.</div>
<table class="foot">
<tr>
<td class="foot-date">
2010-12-30</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

