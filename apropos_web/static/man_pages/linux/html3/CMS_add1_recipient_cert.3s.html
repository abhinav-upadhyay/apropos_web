<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
CMS_add1_recipient_cert(3SSL)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
CMS_add1_recipient_cert(3SSL)</td>
<td class="head-vol">
OpenSSL</td>
<td class="head-rtitle">
CMS_add1_recipient_cert(3SSL)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1><br/>
 CMS_add1_recipient_cert, CMS_add0_recipient_key - add recipients to a CMS enveloped data structure<br/>
</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
 #include &lt;openssl/cms.h&gt;<br/>
<br/>
 CMS_RecipientInfo *CMS_add1_recipient_cert(CMS_ContentInfo *cms, X509 *recip, unsigned int flags);<br/>
<br/>
 CMS_RecipientInfo *CMS_add0_recipient_key(CMS_ContentInfo *cms, int nid, unsigned char *key, size_t keylen, unsigned char *id, size_t idlen, ASN1_GENERALIZEDTIME *date, ASN1_OBJECT *otherTypeId, ASN1_TYPE *otherType);<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1>  <i>CMS_add1_recipient_cert()</i> adds recipient <b>recip</b> to CMS_ContentInfo enveloped data structure  <b>cms</b> as a KeyTransRecipientInfo structure.<div class="spacer">
</div>
<i>CMS_add0_recipient_key()</i> adds symmetric key <b>key</b> of length <b>keylen</b> using wrapping algorithm  <b>nid</b>, identifier <b>id</b> of length <b>idlen</b> and optional values  <b>date</b>, <b>otherTypeId</b> and <b>otherType</b> to CMS_ContentInfo enveloped data structure  <b>cms</b> as a KEKRecipientInfo structure.<div class="spacer">
</div>
The CMS_ContentInfo structure should be obtained from an initial call to  <i>CMS_encrypt()</i> with the flag <b>CMS_PARTIAL</b> set.</div>
<div class="section">
<h1>NOTES</h1> The main purpose of this function is to provide finer control over a CMS enveloped data structure where the simpler  <i>CMS_encrypt()</i> function defaults are not appropriate. For example if one or more KEKRecipientInfo structures need to be added. New attributes can also be added using the returned CMS_RecipientInfo structure and the CMS attribute utility functions.<div class="spacer">
</div>
OpenSSL will by default identify recipient certificates using issuer name and serial number. If  <b>CMS_USE_KEYID</b> is set it will use the subject key identifier value instead. An error occurs if all recipient certificates do not have a subject key identifier extension.<div class="spacer">
</div>
Currently only AES based key wrapping algorithms are supported for <b>nid</b>, specifically: NID_id_aes128_wrap, NID_id_aes192_wrap and NID_id_aes256_wrap. If  <b>nid</b> is set to <b>NID_undef</b> then an AES wrap algorithm will be used consistent with  <b>keylen</b>.</div>
<div class="section">
<h1>RETURN VALUES</h1>  <i>CMS_add1_recipient_cert()</i> and <i>CMS_add0_recipient_key()</i> return an internal pointer to the CMS_RecipientInfo structure just added or NULL if an error occurs.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>ERR_get_error</i>(3), <i>CMS_decrypt</i>(3),  <i>CMS_final</i>(3),</div>
<div class="section">
<h1>HISTORY</h1>  <i>CMS_add1_recipient_cert()</i> and <i>CMS_add0_recipient_key()</i> were added to OpenSSL 0.9.8</div>
<table class="foot">
<tr>
<td class="foot-date">
2008-04-10</td>
<td class="foot-os">
1.0.1</td>
</tr>
</table>
</div>
</body>
</html>

