<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
CAP_COPY_EXT(3)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
CAP_COPY_EXT(3)</td>
<td class="head-vol">
Linux Programmer's Manual</td>
<td class="head-rtitle">
CAP_COPY_EXT(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> cap_copy_ext, cap_size, cap_copy_int - capability state external representation translation</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>#include &lt;sys/capability.h&gt;</b><div style="height: 1.00em;">
&#160;</div>
<b>ssize_t cap_size(cap_t </b><i>cap_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<b>ssize_t cap_copy_ext(void *</b><i>ext_p</i><b>, cap_t </b><i>cap_p</i><b>, ssize_t </b><i>size</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<b>cap_t cap_copy_int(const void *</b><i>ext_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
Link with <i>-lcap</i>.</div>
<div class="section">
<h1>DESCRIPTION</h1> These functions translate between internal and external representations of a capability state.  The external representation is an exportable, contiguous, persistent representation of a capability state in user-managed space.  The internal representation is managed by the capability functions in working storage.<div class="spacer">
</div>
<b>cap_size</b>() returns the total length (in bytes) that the capability state in working storage identified by <i>cap_p</i> would require when converted by <b>cap_copy_ext</b>(). This function is used primarily to determine the amount of buffer space that must be provided to the <b>cap_copy_ext</b>() function in order to hold the capability data record created from <i>cap_p</i>.<div class="spacer">
</div>
<b>cap_copy_ext</b>() copies a capability state in working storage, identified by <i>cap_p</i>, from system managed space to user-managed space (pointed to by <i>ext_p</i>) and returns the length of the resulting data record.  The size parameter represents the maximum size, in bytes, of the resulting data record.  The <b>cap_copy_ext</b>() function will do any conversions necessary to convert the capability state from the undefined internal format to an exportable, contiguous, persistent data record.  It is the responsibility of the user to allocate a buffer large enough to hold the copied data.  The buffer length required to hold the copied data may be obtained by a call to the <b>cap_size</b>() function.<div class="spacer">
</div>
<b>cap_copy_int</b>() copies a capability state from a capability data record in user-managed space to a new capability state in working storage, allocating any memory necessary, and returning a pointer to the newly created capability state.  The function initializes the capability state and then copies the capability state from the record pointed to by <i>ext_p</i> into the capability state, converting, if necessary, the data from a contiguous, persistent format to an undefined, internal format.  Once copied into internal format, the object can be manipulated by the capability state manipulation functions (see <b>cap_clear</b>(3)). Note that the record pointed to by <i>ext_p</i> must have been obtained from a previous, successful call to <b>cap_copy_ext</b>() for this function to work successfully.  The caller should free any releasable memory, when the capability state in working storage is no longer required, by calling <b>cap_free</b>() with the <i>cap_t</i> as an argument.</div>
<div class="section">
<h1>RETURN VALUE</h1> <b>cap_size</b>() returns the length required to hold a capability data record on success, and -1 on failure.<div class="spacer">
</div>
<b>cap_copy_ext</b>() returns the number of bytes placed in the user managed space pointed to by <i>ext_p</i> on success, and -1 on failure.<div class="spacer">
</div>
<b>cap_copy_int</b>() returns a pointer to the newly created capability state in working storage on success, and NULL on failure.<div class="spacer">
</div>
On failure, <b>errno</b> is set to <b>EINVAL</b>, <b>ENOMEM</b>, or <b>ERANGE</b>.</div>
<div class="section">
<h1>CONFORMING TO</h1> These functions are specified in the withdrawn POSIX.1e draft specification.</div>
<div class="section">
<h1>SEE ALSO</h1> <b>libcap</b>(3), <b>cap_clear</b>(3), <b>cap_from_text</b>(3), <b>cap_get_file</b>(3), <b>cap_get_proc</b>(3), <b>cap_init</b>(3), <b>capabilities</b>(7)</div>
<table class="foot">
<tr>
<td class="foot-date">
2008-05-11</td>
<td class="foot-os">
</td>
</tr>
</table>
</div>
</body>
</html>

