<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
filetest(3perl)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
filetest(3perl)</td>
<td class="head-vol">
Perl Programmers Reference Guide</td>
<td class="head-rtitle">
filetest(3perl)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> filetest - Perl pragma to control the filetest permission operators</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
    $can_perhaps_read = -r &quot;file&quot;;      # use the mode bits<br/>
    {<br/>
        use filetest 'access';          # intuit harder<br/>
        $can_really_read = -r &quot;file&quot;;<br/>
    }<br/>
    $can_perhaps_read = -r &quot;file&quot;;      # use the mode bits again<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> This pragma tells the compiler to change the behaviour of the filetest permission operators, &quot;-r&quot; &quot;-w&quot; &quot;-x&quot; &quot;-R&quot; &quot;-W&quot; &quot;-X&quot; (see perlfunc).<div class="spacer">
</div>
The default behaviour of file test operators is to use the simple mode bits as returned by the  <i>stat()</i> family of system calls.  However, many operating systems have additional features to define more complex access rights, for example ACLs (Access Control Lists). For such environments, &quot;use filetest&quot; may help the permission operators to return results more consistent with other tools.<div class="spacer">
</div>
The &quot;use filetest&quot; or &quot;no filetest&quot; statements affect file tests defined in their block, up to the end of the closest enclosing block (they are lexically block-scoped).<div class="spacer">
</div>
Currently, only the &quot;access&quot; sub-pragma is implemented.  It enables (or disables) the use of  <i>access()</i> when available, that is, on most UNIX systems and other POSIX environments.  See details below.<div class="subsection">
<h2>Consider this carefully</h2> The  <i>stat()</i> mode bits are probably right for most of the files and directories found on your system, because few people want to use the additional features offered by  <i>access()</i>. But you may encounter surprises if your program runs on a system that uses ACLs, since the  <i>stat()</i> information won't reflect the actual permissions.<div class="spacer">
</div>
There may be a slight performance decrease in the filetest operations when the filetest pragma is in effect, because checking bits is very cheap.<div class="spacer">
</div>
Also, note that using the file tests for security purposes is a lost cause from the start: there is a window open for race conditions (who is to say that the permissions will not change between the test and the real operation?).  Therefore if you are serious about security, just try the real operation and test for its success - think in terms of atomic operations.  Filetests are more useful for filesystem administrative tasks, when you have no need for the content of the elements on disk.</div>
<div class="subsection">
<h2>The &quot;access&quot; sub-pragma</h2> UNIX and POSIX systems provide an abstract  <i>access()</i> operating system call, which should be used to query the read, write, and execute rights. This function hides various distinct approaches in additional operating system specific security features, like Access Control Lists (ACLs)<div class="spacer">
</div>
The extended filetest functionality is used by Perl only when the argument of the operators is a filename, not when it is a filehandle.</div>
<div class="subsection">
<h2>Limitation with regard to &quot;_&quot;</h2> Because  <i>access()</i> does not invoke <i>stat()</i> (at least not in a way visible to Perl),  <b>the stat result cache &quot;_&quot; is not set</b>.  This means that the outcome of the following two tests is different.  The first has the stat bits of &quot;/etc/passwd&quot; in &quot;_&quot;, and in the second case this still contains the bits of &quot;/etc&quot;.<div class="spacer">
</div>
<br/>
 { -d '/etc';<br/>
   -w '/etc/passwd';<br/>
   print -f _ ? 'Yes' : 'No';   # Yes<br/>
 }<br/>
<br/>
 { use filetest 'access';<br/>
   -d '/etc';<br/>
   -w '/etc/passwd';<br/>
   print -f _ ? 'Yes' : 'No';   # No<br/>
 }<br/>
<div class="spacer">
</div>
Of course, unless your OS does not implement <i>access()</i>, in which case the pragma is simply ignored.  Best not to use &quot;_&quot; at all in a file where the filetest pragma is active!<div class="spacer">
</div>
As a side effect, as &quot;_&quot; doesn't work, stacked filetest operators (&quot;-f -w $file&quot;) won't work either.<div class="spacer">
</div>
This limitation might be removed in a future version of perl.</div>
</div>
<table class="foot">
<tr>
<td class="foot-date">
2010-12-30</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

