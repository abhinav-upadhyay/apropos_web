<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
Pod::POM::Node(3pm)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
Pod::POM::Node(3pm)</td>
<td class="head-vol">
User Contributed Perl Documentation</td>
<td class="head-rtitle">
Pod::POM::Node(3pm)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Pod::POM::Node - base class for a POM node</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
    package Pod::POM::Node::Over;<br/>
    use base qw( Pod::POM::Node );<br/>
    use vars qw( %ATTRIBS @ACCEPT $EXPECT $ERROR );<br/>
<br/>
    %ATTRIBS =   ( indent =&gt; 4 );<br/>
    @ACCEPT  = qw( over item begin for text verbatim );<br/>
    $EXPECT  =  q( back );<br/>
<br/>
    package main;<br/>
    my $list = Pod::POM::Node::Over-&gt;new(8);<br/>
    $list-&gt;add('item', 'First Item');<br/>
    $list-&gt;add('item', 'Second Item');<br/>
    ...<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> This documentation describes the inner workings of the Pod::POM::Node module and gives a brief overview of the relationship between it and its derived classes.  It is intended more as a guide to the internals for interested hackers than as general user documentation.  See Pod::POM for information on using the modules.<div class="spacer">
</div>
This module implements a base class node which is subclassed to represent different elements within a Pod Object Model.<div class="spacer">
</div>
<br/>
    package Pod::POM::Node::Over;<br/>
    use base qw( Pod::POM::Node );<br/>
<div class="spacer">
</div>
The base class implements the <i>new()</i> constructor method to instantiate new node objects.<div class="spacer">
</div>
<br/>
    my $list = Pod::POM::Node::Over-&gt;new();<br/>
<div class="spacer">
</div>
The characteristics of a node can be specified by defining certain variables in the derived class package.  The %ATTRIBS hash can be used to denote attributes that the node should accept.  In the case of an &quot;=over&quot; node, for example, an &quot;indent&quot; attribute can be specified which otherwise defaults to 4.<div class="spacer">
</div>
<br/>
    package Pod::POM::Node::Over;<br/>
    use base qw( Pod::POM::Node );<br/>
    use vars qw( %ATTRIBS $ERROR );<br/>
<br/>
    %ATTRIBS = ( indent =&gt; 4 );<br/>
<div class="spacer">
</div>
The <i>new()</i> method will now expect an argument to set the indent value, or will use 4 as the default if no argument is provided.<div class="spacer">
</div>
<br/>
    my $list = Pod::POM::Node::Over-&gt;new(8);    # indent: 8<br/>
    my $list = Pod::POM::Node::Over-&gt;new( );    # indent: 4<br/>
<div class="spacer">
</div>
If the default value is undefined then the argument is mandatory.<div class="spacer">
</div>
<br/>
    package Pod::POM::Node::Head1;<br/>
    use base qw( Pod::POM::Node );<br/>
    use vars qw( %ATTRIBS $ERROR );<br/>
<br/>
    %ATTRIBS = ( title =&gt; undef );<br/>
<br/>
    package main;<br/>
    my $head = Pod::POM::Node::Head1-&gt;new('My Title');<br/>
<div class="spacer">
</div>
If a mandatory argument isn't provided then the constructor will return undef to indicate failure.  The $ERROR variable in the derived class package is set to contain a string of the form &quot;$type expected a $attribute&quot;.<div class="spacer">
</div>
<br/>
    # dies with error: &quot;head1 expected a title&quot;<br/>
    my $head = Pod::POM::Node::Head1-&gt;new()<br/>
        || die $Pod::POM::Node::Head1::ERROR;<br/>
<div class="spacer">
</div>
For convenience, the <i>error()</i> subroutine can be called as a class method to retrieve this value.<div class="spacer">
</div>
<br/>
    my $type = 'Pod::POM::Node::Head1';<br/>
    my $head = $type-&gt;new()<br/>
        || die $type-&gt;error();<br/>
<div class="spacer">
</div>
The @ACCEPT package variable can be used to indicate the node types that are permitted as children of a node.<div class="spacer">
</div>
<br/>
    package Pod::POM::Node::Head1;<br/>
    use base qw( Pod::POM::Node );<br/>
    use vars qw( %ATTRIBS @ACCEPT $ERROR );<br/>
<br/>
    %ATTRIBS =   ( title =&gt; undef );<br/>
    @ACCEPT  = qw( head2 over begin for text verbatim );<br/>
<div class="spacer">
</div>
The <i>add()</i> method can then be called against a node to add a new child node as part of its content.<div class="spacer">
</div>
<br/>
    $head-&gt;add('over', 8);<br/>
<div class="spacer">
</div>
The first argument indicates the node type.  The @ACCEPT list is examined to ensure that the child node type is acceptable for the parent node.  If valid, the constructor for the relevant child node class is called passing any remaining arguments as attributes.  The new node is then returned.<div class="spacer">
</div>
<br/>
    my $list = $head-&gt;add('over', 8);<br/>
<div class="spacer">
</div>
The <i>error()</i> method can be called against the <i>parent</i> node to retrieve any constructor error generated by the  <i>child</i> node.<div class="spacer">
</div>
<br/>
    my $list = $head-&gt;add('over', 8);<br/>
    die $head-&gt;error() unless defined $list;<br/>
<div class="spacer">
</div>
If the child node is not acceptable to the parent then the <i>add()</i> method returns one of the constants IGNORE, REDUCE or REJECT, as defined in Pod::POM::Constants.  These return values are used by the Pod::POM parser module to implement a simple shift/reduce parser.<div class="spacer">
</div>
In the most common case, IGNORE is returned to indicate that the parent node doesn't know anything about the new child node.  The parser uses this as an indication that it should back up through the parse stack until it finds a node which  <i>will</i> accept this child node. Through this mechanism, the parser is able to implicitly terminate certain POD blocks.  For example, a list item initiated by a &quot;=item&quot; tag will  <i>not</i> accept another &quot;=item&quot; tag, but will instead return IGNORE. The parser will back out until it finds the enclosing &quot;=over&quot; node which  <i>will</i> accept it.  Thus, a new &quot;=item&quot; implicitly terminates any previous &quot;=item&quot;.<div class="spacer">
</div>
The $EXPECT package variable can be used to indicate a node type which a parent expects to terminate itself.  An &quot;=over&quot; node, for example, should always be terminated by a matching &quot;=back&quot;.  When such a match is made, the  <i>add()</i> method returns REDUCE to indicate successful termination.<div class="spacer">
</div>
<br/>
    package Pod::POM::Node::Over;<br/>
    use base qw( Pod::POM::Node );<br/>
    use vars qw( %ATTRIBS @ACCEPT $EXPECT $ERROR );<br/>
<br/>
    %ATTRIBS =   ( indent =&gt; 4 );<br/>
    @ACCEPT  = qw( over item begin for text verbatim );<br/>
    $EXPECT  =  q( back );<br/>
<br/>
    package main;<br/>
    my $list = Pod::POM::Node::Over-&gt;new();<br/>
    my $item = $list-&gt;add('item');<br/>
    $list-&gt;add('back');                 # returns REDUCE<br/>
<div class="spacer">
</div>
If a child node isn't specified in the @ACCEPT list or doesn't match any $EXPECT specified then REJECT is returned.  The parent node sets an internal error of the form &quot;$type expected a terminating $expect&quot;. The parser uses this to detect missing POD tags.  In nearly all cases the parser is smart enough to fix the incorrect structure and downgrades any errors to warnings.<div class="spacer">
</div>
<br/>
    # dies with error 'over expected terminating back'<br/>
    ref $list-&gt;add('head1', 'My Title')     # returns REJECT<br/>
        || die $list-&gt;error();<br/>
<div class="spacer">
</div>
Each node contains a 'type' field which contains a simple string indicating the node type, e.g. 'head1', 'over', etc.  The $NODES and $NAMES package variables (in the base class) reference hash arrays which map these names to and from package names (e.g. head1 &lt;=&gt; Pod::POM::Node::Head1).<div class="spacer">
</div>
<br/>
    print $list-&gt;{ type };      # 'over'<br/>
<div class="spacer">
</div>
An AUTOLOAD method is provided to access to such internal items for those who don't like violating an object's encapsulation.<div class="spacer">
</div>
<br/>
    print $list-&gt;type();<br/>
<div class="spacer">
</div>
Nodes also contain a 'content' list, blessed into the Pod::POM::Node::Content class, which contains the content (child elements) for the node.  The AUTOLOAD method returns this as a list reference or as a list of items depending on the context in which it is called.<div class="spacer">
</div>
<br/>
    my $items = $list-&gt;content();<br/>
    my @items = $list-&gt;content();<br/>
<div class="spacer">
</div>
Each node also contains a content list for each individual child node type that it may accept.<div class="spacer">
</div>
<br/>
    my @items = $list-&gt;item();<br/>
    my @text  = $list-&gt;text();<br/>
    my @vtext = $list-&gt;verbatim();<br/>
<div class="spacer">
</div>
The <i>present()</i> method is used to present a node through a particular view. This simply maps the node type to a method which is then called against the view object.  This is known as 'double dispatch'.<div class="spacer">
</div>
<br/>
    my $view = 'Pod::POM::View::HTML';<br/>
    print $list-&gt;present($view);<br/>
<div class="spacer">
</div>
The method name is constructed from the node type prefixed by 'view_'. Thus the following are roughly equivalent.<div class="spacer">
</div>
<br/>
    $list-&gt;present($view);<br/>
<br/>
    $view-&gt;view_list($list);<br/>
<div class="spacer">
</div>
The benefit of the former over the latter is, of course, that the caller doesn't need to know or determine the type of the node.  The node itself is in the best position to determine what type it is.</div>
<div class="section">
<h1>AUTHOR</h1> Andy Wardley &lt;abw@kfs.org&gt;</div>
<div class="section">
<h1>COPYRIGHT</h1> Copyright (C) 2000, 2001 Andy Wardley.  All Rights Reserved.<div class="spacer">
</div>
This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</div>
<div class="section">
<h1>SEE ALSO</h1> Consult Pod::POM for a general overview and examples of use.</div>
<table class="foot">
<tr>
<td class="foot-date">
2010-04-02</td>
<td class="foot-os">
perl v5.10.1</td>
</tr>
</table>
</div>
</body>
</html>

