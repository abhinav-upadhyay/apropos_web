<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
LIBGRAPH(3)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
LIBGRAPH(3)</td>
<td class="head-vol">
Library Functions Manual</td>
<td class="head-rtitle">
LIBGRAPH(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1>  <b>libgraph</b> - abstract graph library</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
<br/>
#include &lt;graphviz/graph.h&gt;<br/>
void        aginit();<br/>
Agraph_t    *agread(FILE*);<br/>
int         agwrite(Agraph_t*, FILE*);<br/>
int         agerrors();<br/>
Agraph_t    *agopen(char *name, int kind);<br/>
void        agclose(Agraph_t *g);<br/>
Agraph_t    *agsubg(Agraph_t *g, char *name);<br/>
Agraph_t    *agfindsubg(Agraph_t *g, char *name);<br/>
Agnode_t    *agmetanode(Agraph_t *g);<br/>
Agraph_t    *agusergraph(Agnode_t *metanode);<br/>
int         agnnodes(Agraph_t *g), agnedges(Agraph_t *g);<div style="height: 1.00em;">
&#160;</div>
<br/>
int         agcontains(Agraph_t *g, void *obj);<br/>
int         aginsert(Agraph_t *g, void *obj);<br/>
int         agdelete(Agraph_t *g, void *obj);<div style="height: 0.10in;">
&#160;</div>
<br/>
Agnode_t    *agnode(Agraph_t *g, char *name);<br/>
Agnode_t    *agfindnode(Agraph_t *g, char *name);<br/>
Agnode_t    *agfstnode(Agraph_t *g);<br/>
Agnode_t    *agnxtnode(Agraph_t *g, Agnode_t *n);<br/>
Agnode_t    *aglstnode(Agraph_t *g);<br/>
Agnode_t    *agprvnode(Agraph_t *g, Agnode_t *n);<div style="height: 0.10in;">
&#160;</div>
<br/>
Agedge_t    *agedge(Agraph_t *g, Agnode_t *tail, Agnode_t *head);<br/>
Agedge_t    *agfindedge(Agraph_t *g, Agnode_t *tail, Agnode_t *head);<br/>
Agedge_t    *agfstedge(Agraph_t *g, Agnode_t *n);<br/>
Agedge_t    *agnxtedge(Agraph_t *g, Agedge_t *e, Agnode_t *n);<br/>
Agedge_t    *agfstin(Agraph_t *g, Agnode_t *n);<br/>
Agedge_t    *agnxtin(Agraph_t *g, Agedge_t *e);<br/>
Agedge_t    *agfstout(Agraph_t *g, Agnode_t *n);<br/>
Agedge_t    *agnxtout(Agraph_t *g, Agedge_t *e);<div style="height: 0.10in;">
&#160;</div>
<br/>
char        *agget(void *obj, char *name);<br/>
char        *agxget(void *obj, int index);<br/>
void        agset(void *obj, char *name, char *value);<br/>
void        agxset(void *obj, int index, char *value);<br/>
int         agindex(void *obj, char *name);<div style="height: 0.10in;">
&#160;</div>
<br/>
Agsym_t*    agraphattr(Agraph_t *g,char *name,char *value);<br/>
Agsym_t*    agnodeattr(Agraph_t *g,char *name,char *value);<br/>
Agsym_t*    agedgeattr(Agraph_t *g,char *name,char *value);<br/>
Agsym_t*    agfindattr(void *obj,char *name);<br/>
<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1>  <i>libgraph</i> maintains directed and undirected attributed graphs in memory and reads and writes graph files.  Graphs are composed of nodes, edges, and nested subgraphs.   A subgraph may contain any nodes and edges of its parents, and may be passed to any  <i>libgraph</i> function taking a graph pointer, except the three that create new attributes (where a main graph is required).<div style="height: 1.00em;">
&#160;</div>
Attributes are internal or external. Internal attributes are fields in the graph, node and edge structs defined at compile time. These allow efficient representation and direct access to values such as marks, weights, and pointers for writing graph algorithms. External attributes, on the other hand, are character strings (name&#8208;value pairs) dynamically allocated at runtime and accessed through  <i>libgraph</i> calls.  External attributes are used in graph file I/O; internal attributes are not.  Conversion between internal and external attributes must be explicitly programmed.<div style="height: 1.00em;">
&#160;</div>
The subgraphs in a main graph are represented by an auxiliary directed graph (a meta&#8208;graph).  Meta&#8208;nodes correspond to subgraphs, and meta&#8208;edges signify containment of one subgraph in another. agmetanode and agusergraph map between subgraphs and meta&#8208;nodes.  The nodes and edges of the meta&#8208;graph may be traversed by the usual  <i>libgraph</i> functions for this purpose.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>USE</h1> 1. Define types Agraphinfo_t, Agnodeinfo_t, and Agedgeinfo_t (usually in a header file) before including &lt;graphviz/graph.h&gt;.<div style="height: 1.00em;">
&#160;</div>
2. Call aginit() before any other <i>libgraph</i> functions. (This is a macro that calls aginitlib() to define the sizes of Agraphinfo_t, Agnodeinfo_t, and Agedgeinfo_t.)<div style="height: 1.00em;">
&#160;</div>
3. Compile with -lgraph -lcdt.<div style="height: 1.00em;">
&#160;</div>
Except for the <b>u</b> fields, <i>libgraph</i> data structures must be considered read&#8208;only. Corrupting their contents by direct updates can cause catastrophic errors.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>GRAPHS</h1><br/>
<br/>
typedef struct Agraph_t {<br/>
    char                 kind;<br/>
    char                *name;<br/>
    Agraph_t             *root;<br/>
    char                **attr;<br/>
    graphdata_t         *univ;<br/>
    Dict_t              *nodes,*inedges,*outedges;<br/>
    proto_t             *proto;<br/>
    Agraphinfo_t         u;<br/>
} Agraph_t;<div class="spacer">
</div>
<br/>
typedef struct graphdata_t {<br/>
    Dict_t              *node_dict;<br/>
    attrdict_t          *nodeattr, *edgeattr, *globattr;<br/>
} graphdata_t;<div class="spacer">
</div>
<br/>
typedef struct proto_t {<br/>
    Agnode_t            *n;<br/>
    Agedge_t            *e;<br/>
    proto_t             *prev;<br/>
} proto_t;<br/>
<br/>
A graph <i>kind</i> is one of: AGRAPH, AGRAPHSTRICT, AGDIGRAPH, or AGDIGRAPHSTRICT. There are related macros for testing the properties of a graph: AG_IS_DIRECTED(g) and AG_IS_STRICT(g). Strict graphs cannot have self&#8208;arcs or multi&#8208;edges.  <b>attr</b> is the array of external attribute values.  <b>univ</b> points to values shared by all subgraphs of a main graph.  <b>nodes</b>, <b>inedges</b>, and <b>outedges</b> are sets maintained by  <b>cdt(3)</b>.  Normally you don't access these dictionaries directly, though the edge dictionaries may be re&#8208;ordered to support programmer&#8208;defined ordered edges (see dtreorder in  <i>cdt(3)</i>).  <b>proto</b> is a stack of templates for node and edge initialization. The attributes of these nodes and edges are set in the usual way (agget, agset, etc.) to set defaults.<div class="spacer">
</div>
agread reads a file and returns a new graph if one was successfully parsed, otherwise returns NULL if EOF or a syntax error was encountered. Errors are reported on stderr and a count is returned from agerrors(). write_graph prints a graph on a file. agopen and agsubg create new empty graph and subgraphs. agfindsubg searches for a subgraph by name, returning NULL when the search fails.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>ALL OBJECTS</h1> agcontains, aginsert, agdelete are generic functions for nodes, edges, and graphs.  gcontains is a predicate that tests if an object belongs to the given graph.  aginsert inserts an object in a graph and agdelete undoes this operation. A node or edge is destroyed (and its storage freed) at the time it is deleted from the main graph.  Likewise a subgraph is destroyed when it is deleted from its last parent or when its last parent is deleted.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>NODES</h1><br/>
<br/>
typedef struct Agnode_t {<br/>
    char                *name;<br/>
    Agraph_t            *graph;<br/>
    char                **attr;<br/>
    Agnodeinfo_t        u;<br/>
} Agnode_t;<br/>
<br/>
<div style="height: 1.00em;">
&#160;</div>
agnode attempts to create a node. If one with the requested name already exists, the old node is returned unmodified. Otherwise a new node is created, with attributed copied from g-&gt;proto-&gt;n. agfstnode (agnxtnode) return the first (next) element in the node set of a graph, respectively, or NULL. aglstnode (agprvnode) return the last (previous) element in the node set of a graph, respectively, or NULL.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>EDGES</h1><br/>
<br/>
typedef struct Agedge_t {<br/>
    Agnode_t            *head,*tail;<br/>
    char                **attr;<br/>
    Agedgeinfo_t        u;<br/>
} Agedge_t;<br/>
<br/>
agedge creates a new edge with the attributes of g-&gt;proto-&gt;e including its key if not empty. agfindedge finds the first (u,v) edge in g. agfstedge (agnxtedge) return the first (next) element in the edge set of a graph, respectively, or NULL. agfstin, agnxtin, agfstout, agnxtout refer to in&#8208; or out&#8208;edge sets. The idiomatic usage in a directed graph is:<div style="height: 1.00em;">
&#160;</div>
    for (e = agfstout(g,n); e; e = agnextout(g,e)) your_fun(e);<div class="spacer">
</div>
An edge is uniquely identified by its endpoints and its key attribute (if there are multiple edges). If the key of g-&gt;proto-&gt;e is empty, new edges are assigned an internal value. Edges also have tailport and headport values. These have special syntax in the graph file language but are not otherwise interpreted.</div>
<div class="section">
<h1>ATTRIBUTES</h1><br/>
<br/>
typedef struct attrsym_t {<br/>
    char                *name,*value;<br/>
    int                 index;<br/>
    unsigned char       printed;<br/>
} attrsym_t;<br/>
typedef struct attrdict_t  {<br/>
    char                *name;<br/>
    Dict_t              *dict;<br/>
    attrsym_t           **list;<br/>
} attrdict_t;<br/>
<br/>
agraphattr, agnodeattr, and agedgeattr make new attributes. g should be a main graph, or NULL for declarations applying to all graphs subsequently read or created. agfindattr searches for an existing attribute.<div class="spacer">
</div>
External attributes are accessed by agget and agset These take a pointer to any graph, node, or edge, and an attribute name. Also, each attribute has an integer index.  For efficiency this index may be passed instead of the name, by calling agxget and agxset. The printed flag of an attribute may be set to 0 to skip it when writing a graph file.<div class="spacer">
</div>
The list in an attribute dictionary is maintained in order of creation and is NULL terminated. Here is a program fragment to print node attribute names:<br/>
    attrsym_t *aptr;<br/>
    for (i = 0; aptr = g-&gt;univ-&gt;nodedict-&gt;list[i]; i++) puts(aptr-&gt;name);<br/>
</div>
<div class="section">
<h1>EXAMPLE GRAPH FILES</h1><br/>
graph any_name {            /* an undirected graph */<br/>
    a -- b;                 /* a simple edge */<br/>
    a -- x1 -- x2 -- x3;    /* a chain of edges */<br/>
    &quot;x3.a!&quot; -- a;           /* quotes protect special characters */<br/>
    b -- {q r s t};         /* edges that fan out */<br/>
    b [color=&quot;red&quot;,size=&quot;.5,.5&quot;];   /* set various node attributes */<br/>
    node [color=blue];      /* set default attributes */<br/>
    b -- c [weight=25];     /* set edge attributes */<br/>
    subgraph sink_nodes {a b c};    /* make a subgraph */<br/>
}<div class="spacer">
</div>
<br/>
digraph G {<br/>
    size=&quot;8.5,11&quot;;            /* sets a graph attribute */<br/>
    a -&gt; b;                 /* makes a directed edge */<br/>
    chip12.pin1 -&gt; chip28.pin3; /* uses named node &quot;ports&quot; */<br/>
}<br/>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>SEE ALSO</h1> <b>dot</b>(1), <b>neato</b>(1), <b>libdict</b>(3)<div style="height: 0.00em;">
&#160;</div>
S. C. North and K. P. Vo, &quot;Dictionary and Graph Libraries'' 1993 Winter USENIX Conference Proceedings, pp. 1&#8208;11.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>AUTHOR</h1> Stephen North (north@ulysses.att.com), AT&amp;T Bell Laboratories.</div>
<table class="foot">
<tr>
<td class="foot-date">
01 MARCH 1993</td>
<td class="foot-os">
</td>
</tr>
</table>
</div>
</body>
</html>

