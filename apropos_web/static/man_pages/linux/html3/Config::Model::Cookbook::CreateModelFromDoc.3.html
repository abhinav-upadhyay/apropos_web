<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
Config::Model::Cookbook::CreateModelFromDoc(3pm)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
Config::Model::Cookbook::CreateModelFromDoc(3pm)</td>
<td class="head-vol">
User Contributed Perl Documentation</td>
<td class="head-rtitle">
Config::Model::Cookbook::CreateModelFromDoc(3pm)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Config::Model::Cookbook::CreateModelFromDoc - Create a configuration model from application documentation</div>
<div class="section">
<h1>VERSION</h1> version 2.005</div>
<div class="section">
<h1>Introduction</h1> This page shows step by step how was created &quot;Popcon&quot;'s model from &quot;Popcon&quot; documentation provided as comments in &quot;Popcon&quot;'s sample configuration file.</div>
<div class="section">
<h1>&quot;Popcon&quot; configuration file</h1> A quick looks in &quot;/etc&quot; directory shows that &quot;Popcon&quot;'s configuration is stored in &quot;/etc/popularity-contest.conf&lt;/t&quot;:<div class="spacer">
</div>
<br/>
 # Config file for Debian's popularity-contest package.<br/>
 #<br/>
 # To change this file, use:<br/>
 #        dpkg-reconfigure popularity-contest<br/>
 #<br/>
 # You can also edit it by hand, if you so choose.<br/>
 #<br/>
 # See /usr/share/popularity-contest/default.conf for more info<br/>
 # on the options.<br/>
 <br/>
 MY_HOSTID=&quot;172921501FFFFFAAAA6897etc&quot;<br/>
 PARTICIPATE=&quot;yes&quot;<br/>
 USEHTTP=&quot;yes&quot;<br/>
 DAY=&quot;5&quot;<br/>
<div class="spacer">
</div>
The important part is the mention of &quot;default.conf&quot; which contains all the required information to create &quot;Popcon&quot;'s configuration model.</div>
<div class="section">
<h1>&quot;Popcon&quot; documentation</h1> Let's start from &quot;default.conf&quot; file. Since this file is loaded by &quot;popcon&quot;  <i>before</i> loading &quot;/etc/popularity-contest.conf&lt;/t&quot;, all values there can be used as application default values (aka  <i>upstream_default</i>):<div class="spacer">
</div>
<br/>
 # Default config file for Debian's popularity-contest package.<br/>
 #<br/>
 # Local overrides are in /etc/popularity-contest.conf<br/>
 <br/>
 # PARTICIPATE can be one of &quot;yes&quot; or &quot;no&quot;.<br/>
 # If you don't want to participate in the contest, say &quot;no&quot;<br/>
 # and we won't send messages.<br/>
 #<br/>
 # If this option is missing, the default is &quot;no&quot;.<br/>
 #<br/>
 PARTICIPATE=&quot;no&quot;<br/>
 <br/>
 # MAILTO specifies the address to e-mail statistics to each week.<br/>
 #<br/>
 MAILTO=&quot;survey@popcon.debian.org&quot;<br/>
 <br/>
 # MAILFROM is the forged sender email address you want to use in<br/>
 # email submitted to the popularity-contest.  If this is commented<br/>
 # out, no From: or Sender: lines will be added to the outgoing mail,<br/>
 # and it will be your MTA's job to add them.  This is usually what<br/>
 # you want.<br/>
 #<br/>
 # If your MTA is misconfigured or impossible to configure correctly,<br/>
 # and it always generates invalid From: and/or Sender: lines, you<br/>
 # can force different results by setting MAILFROM here.  This can<br/>
 # cause problems with spam bouncers, so most people should leave it<br/>
 # commented out.<br/>
 #<br/>
 #MAILFROM=&quot;root@example.org&quot;<br/>
 <br/>
 # SUBMITURLS is a space separated list of where to submit<br/>
 # popularity-contest reports using http.<br/>
 SUBMITURLS=&quot;http://popcon.debian.org/cgi-bin/popcon.cgi&quot;<br/>
 <br/>
 # USEHTTP enables http reporting.   Set this to 'yes' to enable it.<br/>
 USEHTTP=&quot;yes&quot;<br/>
 <br/>
 # HTTP_PROXY allows one to specify an HTTP proxy server, the syntax is<br/>
 # HTTP_PROXY=&quot;http://proxy:port&quot;. This overrides the environment<br/>
 # variable http_proxy.<br/>
 <br/>
 # MY_HOSTID is a secret number that the popularity-contest receiver<br/>
 # uses to keep track of your submissions.  Whenever you send in a<br/>
 # new entry, it overwrites the last one that had the same HOSTID.<br/>
 #<br/>
 # This key was generated automatically so you should normally just<br/>
 # leave it alone.<br/>
 #<br/>
 #MY_HOSTID=&quot;_ID_&quot;<br/>
<div class="spacer">
</div>
This file contains everything we need:<dl>
<dt>
&#8226;</dt>
<dd>
Parameter names</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Documentation</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Default values</dd>
</dl>
<div class="spacer">
</div>
Now, we will use our favorite editor to edit this file and add YAML tags that can be understood by &quot;config-model-edit&quot;</div>
<div class="section">
<h1>Creating the YAML skeleton</h1> &quot;config-model-edit&quot; is able to load a model described in YAML. To do this the above file needs to be translated in YAML. That's not as complicated as it may sound.<div class="spacer">
</div>
First, a YAML file must begin with <b>---</b>. Then the class must be declared:<div class="spacer">
</div>
<br/>
 ---<br/>
 class:<br/>
   PopCon:<br/>
<div class="spacer">
</div>
Note that, like with Python language, the indentation is important to define the structure of the file. Here, the &quot;PopCon&quot; class is followed by a ':' as it defines a new hierarchical level to describes the configuration elements of this class:<div class="spacer">
</div>
<br/>
     element:<br/>
<div class="spacer">
</div>
Now we can deal with the configuration parameters. Let's detail the &quot;PARTICIPATE&quot; element. Here's the spec in from &quot;default.conf&quot;:<div class="spacer">
</div>
<br/>
 # PARTICIPATE can be one of &quot;yes&quot; or &quot;no&quot;.<br/>
 # If you don't want to participate in the contest, say &quot;no&quot;<br/>
 # and we won't send messages.<br/>
 #<br/>
 # If this option is missing, the default is &quot;no&quot;.<br/>
 #<br/>
 PARTICIPATE=&quot;no&quot;<br/>
<div class="spacer">
</div>
In the YAML file, the comments are moved in the &quot;description&quot; field and the value in the file is used as upstream default:<div class="spacer">
</div>
<br/>
      PARTICIPATE:<br/>
        upstream_default: no<br/>
        description: &gt;<br/>
         If you don't want to participate in the contest, <br/>
         say &quot;no&quot; and we won't send messages.<br/>
<div class="spacer">
</div>
Likewise for the remaining parameters:<div class="spacer">
</div>
<br/>
      MAILTO:<br/>
        description: &gt;<br/>
         specifies the address to e-mail statistics to each week.<br/>
        default: 'survey@popcon.debian.org'<br/>
      MAILFROM:<br/>
        description: &gt;-<br/>
         MAILFROM is the forged sender email address you want to use<br/>
         in email submitted to the popularity-contest.  If this is<br/>
         commented out, no From: or Sender: lines will be added to the<br/>
         outgoing mail, and it will be your MTA's job to add them.  This<br/>
         is usually what you want. <br/>
  <br/>
  <br/>
         If your MTA is misconfigured or<br/>
         impossible to configure correctly, and it always generates<br/>
         invalid From: and/or Sender: lines, you can force different<br/>
         results by setting MAILFROM here.  This can cause problems with<br/>
         spam bouncers, so most people should leave it commented out.<br/>
<div class="spacer">
</div>
In the description above, the &quot;chimping&quot; marker '-' after '&gt;' is used to keep paragraph formatting in the help.<div class="spacer">
</div>
<br/>
      SUBMITURLS:<br/>
        description: &gt;<br/>
         Space separated list of where to submit popularity-contest <br/>
         reports using http.<br/>
        default: &gt;<br/>
         http://popcon.debian.org/cgi-bin/popcon.cgi<br/>
        <br/>
      USEHTTP:<br/>
        description: &gt;<br/>
         enables http reporting.   Set this to 'yes' to enable it.<br/>
        default: &quot;yes&quot;<br/>
        <br/>
      HTTP_PROXY:<br/>
        description: &gt;<br/>
         allows one to specify an HTTP proxy server, the syntax is <br/>
         &quot;http://proxy:port&quot;. This overrides the environment variable <br/>
         http_proxy.<br/>
        <br/>
      MY_HOSTID:<br/>
        description: &gt;<br/>
         secret number that the popularity-contest receiver uses to <br/>
         keep track of your submissions.  Whenever you send in a new <br/>
         entry, it overwrites the last one that had the same HOSTID.<br/>
  <br/>
         This key was generated automatically so you should normally <br/>
         just leave it alone.<br/>
</div>
<div class="section">
<h1>Loading the YAML skeleton</h1> Now that the YAML file was created, you can turn it into a model and load it in the model editor GUI with the following command:<div class="spacer">
</div>
<br/>
 config-model-edit -model PopCon -load_yaml popcon.yml -force<br/>
<div class="spacer">
</div>
Note that the model is incomplete: some mandatory parameters are missing from the YAML file so the  <i>-force</i> option must be used. These missing parameters are also flagged with a red cross in the GUI.</div>
<div class="section">
<h1>Completing missing model parts</h1> To complete the model, the easiest way is to run the wizard to complete the missing values. In the GUI, you can use the menu &quot;File -&gt; wizard&quot; to launch the wizard. Then click on the 'OK' button in the new window.<div class="spacer">
</div>
The wizard will first stop on the parameter list (not because there's an error, but because the parameter list is flagged as  <i>important</i>)<div class="spacer">
</div>
There, you can re-order the parameters by selecting one and clicking on one of the blue arrows to move it up or down. Once you're satisfied, click on  <i>Next</i>.<div class="spacer">
</div>
The widget will now stop on the first missing information. Just select the correct type ('leaf' here), click 'store' and 'Next'.<div class="spacer">
</div>
You can repeat these steps until the wizard exits.</div>
<div class="section">
<h1>Specifying read and write backend</h1> Once the model is complete, it's time to specify how to read and write the file. In &quot;Popcon&quot; class specification:<dl>
<dt>
&#8226;</dt>
<dd>
right-click on <i>read_config</i></dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
click on <i>push new node</i> to create a new read specification</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
right-click on the created item (shown at index &quot;<i>0</i>&quot;)</dd>
</dl>
<div class="spacer">
</div>
You will get a window showing you the parameters to fill to specify the read backend.<div class="spacer">
</div>
Now fill the blank on the right side. The backend to use is &quot;ShellVar&quot; since  <i>popularity-contest.conf</i> is made of shell variables.<div class="spacer">
</div>
Since the write specification is identical, there's no need to specify it. Config::Model will do the right thing.</div>
<div class="section">
<h1>Testing the model</h1> You can test the model by clicking on menu &quot;Test -&gt; Model&quot;. You will be shown the &quot;Popcon&quot; configuration editor GUI. The same that your users will get.<div class="spacer">
</div>
If everything is fine, you can quit the model editor (menu File-&gt;quit)</div>
<div class="section">
<h1>The resulting model</h1> The model you have just created is stored in &quot;lib/Config/Model/models/Popcon.pl&quot;.<div class="spacer">
</div>
You can test directly this model with :<div class="spacer">
</div>
<br/>
  config-edit -dev -model Popcon<br/>
</div>
<div class="section">
<h1>Feedback welcome</h1> Feel free to send comments and suggestion about this page at<div class="spacer">
</div>
<br/>
 config-model-users at lists dot sourceforge dot net.<br/>
</div>
<div class="section">
<h1>AUTHORS</h1> Dominique Dumont &lt;ddumont at cpan.org&gt;</div>
<table class="foot">
<tr>
<td class="foot-date">
2012-02-24</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

