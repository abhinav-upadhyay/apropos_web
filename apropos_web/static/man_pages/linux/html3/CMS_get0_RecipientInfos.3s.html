<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
CMS_get0_RecipientInfos(3SSL)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
CMS_get0_RecipientInfos(3SSL)</td>
<td class="head-vol">
OpenSSL</td>
<td class="head-rtitle">
CMS_get0_RecipientInfos(3SSL)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1><br/>
 CMS_get0_RecipientInfos, CMS_RecipientInfo_type, CMS_RecipientInfo_ktri_get0_signer_id,CMS_RecipientInfo_ktri_cert_cmp, CMS_RecipientInfo_set0_pkey, CMS_RecipientInfo_kekri_get0_id, CMS_RecipientInfo_kekri_id_cmp, CMS_RecipientInfo_set0_key, CMS_RecipientInfo_decrypt - CMS envelopedData RecipientInfo routines<br/>
</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
 #include &lt;openssl/cms.h&gt;<br/>
<br/>
 STACK_OF(CMS_RecipientInfo) *CMS_get0_RecipientInfos(CMS_ContentInfo *cms);<br/>
 int CMS_RecipientInfo_type(CMS_RecipientInfo *ri);<br/>
<br/>
 int CMS_RecipientInfo_ktri_get0_signer_id(CMS_RecipientInfo *ri, ASN1_OCTET_STRING **keyid, X509_NAME **issuer, ASN1_INTEGER **sno);<br/>
 int CMS_RecipientInfo_ktri_cert_cmp(CMS_RecipientInfo *ri, X509 *cert);<br/>
 int CMS_RecipientInfo_set0_pkey(CMS_RecipientInfo *ri, EVP_PKEY *pkey);<br/>
<br/>
 int CMS_RecipientInfo_kekri_get0_id(CMS_RecipientInfo *ri, X509_ALGOR **palg, ASN1_OCTET_STRING **pid, ASN1_GENERALIZEDTIME **pdate, ASN1_OBJECT **potherid, ASN1_TYPE **pothertype);<br/>
 int CMS_RecipientInfo_kekri_id_cmp(CMS_RecipientInfo *ri, const unsigned char *id, size_t idlen);<br/>
 int CMS_RecipientInfo_set0_key(CMS_RecipientInfo *ri, unsigned char *key, size_t keylen);<br/>
<br/>
 int CMS_RecipientInfo_decrypt(CMS_ContentInfo *cms, CMS_RecipientInfo *ri);<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> The function  <i>CMS_get0_RecipientInfos()</i> returns all the CMS_RecipientInfo structures associated with a CMS EnvelopedData structure.<div class="spacer">
</div>
<i>CMS_RecipientInfo_type()</i> returns the type of CMS_RecipientInfo structure <b>ri</b>. It will currently return CMS_RECIPINFO_TRANS, CMS_RECIPINFO_AGREE, CMS_RECIPINFO_KEK, CMS_RECIPINFO_PASS, or CMS_RECIPINFO_OTHER.<div class="spacer">
</div>
<i>CMS_RecipientInfo_ktri_get0_signer_id()</i> retrieves the certificate recipient identifier associated with a specific CMS_RecipientInfo structure  <b>ri</b>, which must be of type CMS_RECIPINFO_TRANS. Either the keyidentifier will be set in  <b>keyid</b> or <b>both</b> issuer name and serial number in <b>issuer</b> and <b>sno</b>.<div class="spacer">
</div>
<i>CMS_RecipientInfo_ktri_cert_cmp()</i> compares the certificate <b>cert</b> against the CMS_RecipientInfo structure  <b>ri</b>, which must be of type CMS_RECIPINFO_TRANS. It returns zero if the comparison is successful and non zero if not.<div class="spacer">
</div>
<i>CMS_RecipientInfo_set0_pkey()</i> associates the private key <b>pkey</b> with the CMS_RecipientInfo structure  <b>ri</b>, which must be of type CMS_RECIPINFO_TRANS.<div class="spacer">
</div>
<i>CMS_RecipientInfo_kekri_get0_id()</i> retrieves the key information from the CMS_RecipientInfo structure  <b>ri</b> which must be of type CMS_RECIPINFO_KEK.  Any of the remaining parameters can be NULL if the application is not interested in the value of a field. Where a field is optional and absent NULL will be written to the corresponding parameter. The keyEncryptionAlgorithm field is written to  <b>palg</b>, the <b>keyIdentifier</b> field is written to <b>pid</b>, the <b>date</b> field if present is written to  <b>pdate</b>, if the <b>other</b> field is present the components  <b>keyAttrId</b> and <b>keyAttr</b> are written to parameters <b>potherid</b> and  <b>pothertype</b>.<div class="spacer">
</div>
<i>CMS_RecipientInfo_kekri_id_cmp()</i> compares the ID in the <b>id</b> and <b>idlen</b> parameters against the  <b>keyIdentifier</b> CMS_RecipientInfo structure <b>ri</b>, which must be of type CMS_RECIPINFO_KEK.  It returns zero if the comparison is successful and non zero if not.<div class="spacer">
</div>
<i>CMS_RecipientInfo_set0_key()</i> associates the symmetric key <b>key</b> of length  <b>keylen</b> with the CMS_RecipientInfo structure <b>ri</b>, which must be of type CMS_RECIPINFO_KEK.<div class="spacer">
</div>
<i>CMS_RecipientInfo_decrypt()</i> attempts to decrypt CMS_RecipientInfo structure  <b>ri</b> in structure <b>cms</b>. A key must have been associated with the structure first.</div>
<div class="section">
<h1>NOTES</h1> The main purpose of these functions is to enable an application to lookup recipient keys using any appropriate technique when the simpler method of  <i>CMS_decrypt()</i> is not appropriate.<div class="spacer">
</div>
In typical usage and application will retrieve all CMS_RecipientInfo structures using  <i>CMS_get0_RecipientInfos()</i> and check the type of each using  <i>CMS_RecpientInfo_type()</i>. Depending on the type the CMS_RecipientInfo structure can be ignored or its key identifier data retrieved using an appropriate function. Then if the corresponding secret or private key can be obtained by any appropriate means it can then associated with the structure and  <i>CMS_RecpientInfo_decrypt()</i> called. If successful <i>CMS_decrypt()</i> can be called with a NULL key to decrypt the enveloped content.</div>
<div class="section">
<h1>RETURN VALUES</h1>  <i>CMS_get0_RecipientInfos()</i> returns all CMS_RecipientInfo structures, or NULL if an error occurs.<div class="spacer">
</div>
<i>CMS_RecipientInfo_ktri_get0_signer_id()</i>, <i>CMS_RecipientInfo_set0_pkey()</i>,  <i>CMS_RecipientInfo_kekri_get0_id()</i>, <i>CMS_RecipientInfo_set0_key()</i> and  <i>CMS_RecipientInfo_decrypt()</i> return 1 for success or 0 if an error occurs.<div class="spacer">
</div>
<i>CMS_RecipientInfo_ktri_cert_cmp()</i> and <i>CMS_RecipientInfo_kekri_cmp()</i> return 0 for a successful comparison and non zero otherwise.<div class="spacer">
</div>
Any error can be obtained from <i>ERR_get_error</i>(3).</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>ERR_get_error</i>(3), <i>CMS_decrypt</i>(3)</div>
<div class="section">
<h1>HISTORY</h1> These functions were first was added to OpenSSL 0.9.8</div>
<table class="foot">
<tr>
<td class="foot-date">
2008-04-10</td>
<td class="foot-os">
1.0.1</td>
</tr>
</table>
</div>
</body>
</html>

