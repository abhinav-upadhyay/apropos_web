<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
XkbSetCompatMap(3)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
XkbSetCompatMap(3)</td>
<td class="head-vol">
XKB FUNCTIONS</td>
<td class="head-rtitle">
XkbSetCompatMap(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> XkbSetCompatMap - Modify the server's compatibility map</div>
<div class="section">
<h1>SYNOPSIS</h1><div style="margin-left: 5.00ex;text-indent: -5.00ex;" class="spacer">
<b>Bool XkbSetCompatMap</b> <b>(Display *</b><i>display</i><b>,</b> <b>unsigned int </b><i>which</i><b>,</b> <b>XkbDescPtr </b><i>xkb</i><b>,</b> <b>Bool </b><i>update_actions</i><b>);</b></div>
</div>
<div class="section">
<h1>ARGUMENTS</h1><dl>
<dt>
<i>- display</i></dt>
<dd>
connection to server</dd>
</dl>
<dl>
<dt>
<i>- which</i></dt>
<dd>
mask of compat map components to set</dd>
</dl>
<dl>
<dt>
<i>- xkb</i></dt>
<dd>
source for compat map components</dd>
</dl>
<dl>
<dt>
<i>- update_actions</i></dt>
<dd>
True =&gt; apply to server's keyboard map</dd>
</dl>
</div>
<div class="section">
<h1>DESCRIPTION</h1> To modify the server's compatibility map, first modify a local copy of the Xkb compatibility map, then call <i>XkbSetCompatMap.</i> You may allocate a new compatibility map for this purpose using <i>XkbAllocCompatMap.</i> You may also use a compatibility map from another server, although you need to adjust the <i>device_spec</i> field in the XkbDescRec accordingly. Note that symbol interpretations in a compatibility map ( <i>sym_interpret,</i> the vector of XkbSymInterpretRec structures) are also allocated using this same function.<div style="height: 1.00em;">
&#160;</div>
<i>XkbSetCompatMap</i> copies compatibility map information from the keyboard description in <i>xkb</i> to the server specified in <i>display</i> <i>device_spec</i> field of <i>xkb.</i> Unless you have specifically modified this field, it is the default keyboard device. <i>which</i> specifies the compatibility map components to be set, and is an inclusive OR of the bits shown in Table 1.<div style="height: 1.00em;">
&#160;</div>
<table class="tbl">
<col style="width: 18.00ex;"/>
<col style="width: 6.00ex;"/>
<col style="width: 32.00ex;"/>
<tbody>
<tr>
<td>
Table 1 Compatibility Map Component Masks</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="0">
</td>
</tr>
<tr>
<td>
Mask</td>
<td>
Value</td>
<td>
Affecting</td>
</tr>
<tr>
<td colspan="0">
</td>
</tr>
<tr>
<td>
XkbSymInterpMask</td>
<td>
(1&lt;&lt;0)</td>
<td>
Symbol interpretations</td>
</tr>
<tr>
<td>
XkbGroupCompatMask</td>
<td>
(1&lt;&lt;1)</td>
<td>
Group maps</td>
</tr>
<tr>
<td>
XkbAllCompatMask</td>
<td>
(0x3)</td>
<td>
All compatibility map components</td>
</tr>
</tbody>
</table>
<div style="height: 1.00em;">
&#160;</div>
After updating its compatibility map for the specified device, if <i>update_actions</i> is True, the server applies the new compatibility map to its entire keyboard for the device to generate a new set of key semantics, compatibility state, and a new core keyboard map. If <i>update_actions</i> is False, the new compatibility map is not used to generate any modifications to the current device semantics, state, or core keyboard map. One reason for not applying the compatibility map immediately would be if one server was being configured to match another on a piecemeal basis; the map should not be applied until everything is updated. To force an update at a later time, use <i>XkbSetCompatMap</i> specifying <i>which</i> as zero and <i>update_actions</i> as True.<div style="height: 1.00em;">
&#160;</div>
<i>XkbSetCompatMap</i> returns True if successful and False if unsuccessful. The server may report problems it encounters when processing the request subsequently via protocol errors.</div>
<div class="section">
<h1>RETURN VALUES</h1><dl>
<dt>
True</dt>
<dd>
The <i>XkbSetCompatMap</i> function returns True if successful.</dd>
</dl>
<dl>
<dt>
False</dt>
<dd>
The <i>XkbSetCompatMap</i> function returns False if unsuccessful.</dd>
</dl>
</div>
<div class="section">
<h1>STRUCTURES</h1> The complete description of an Xkb keyboard is given by an XkbDescRec. The component structures in the XkbDescRec represent the major Xkb components.<div style="height: 1.00em;">
&#160;</div>
<br/>
typedef struct {<br/>
   struct _XDisplay * display;      /&#8727; connection to X server */<br/>
   unsigned short     flags;        /&#8727; private to Xkb, do not modify */<br/>
   unsigned short     device_spec;  /&#8727; device of interest */<br/>
   KeyCode            min_key_code; /&#8727; minimum keycode for device */<br/>
   KeyCode            max_key_code; /&#8727; maximum keycode for device */<br/>
   XkbControlsPtr     ctrls;        /&#8727; controls */<br/>
   XkbServerMapPtr    server;       /&#8727; server keymap */<br/>
   XkbClientMapPtr    map;          /&#8727; client keymap */<br/>
   XkbIndicatorPtr    indicators;   /&#8727; indicator map */<br/>
   XkbNamesPtr        names;        /&#8727; names for all components */<br/>
   XkbCompatMapPtr    compat;       /&#8727; compatibility map */<br/>
   XkbGeometryPtr     geom;         /&#8727; physical geometry of keyboard */<br/>
} XkbDescRec, *XkbDescPtr;<div class="spacer">
</div>
<br/>
The <i>display</i> field points to an X display structure. The <i>flags field is private to the library: modifying</i> <i>flags</i> may yield unpredictable results. The <i>device_spec</i> field specifies the device identifier of the keyboard input device, or XkbUseCoreKeyboard, which specifies the core keyboard device. The <i>min_key_code</i> and <i>max_key_code</i> fields specify the least and greatest keycode that can be returned by the keyboard.<div style="height: 1.00em;">
&#160;</div>
Each structure component has a corresponding mask bit that is used in function calls to indicate that the structure should be manipulated in some manner, such as allocating it or freeing it. These masks and their relationships to the fields in the XkbDescRec are shown in Table 2.<div style="height: 1.00em;">
&#160;</div>
<table class="tbl">
<col style="width: 20.00ex;"/>
<col style="width: 16.00ex;"/>
<col style="width: 7.00ex;"/>
<tbody>
<tr>
<td>
Table 2 Mask Bits for XkbDescRec</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="0">
</td>
</tr>
<tr>
<td>
Mask Bit</td>
<td>
XkbDescRec Field</td>
<td>
Value</td>
</tr>
<tr>
<td colspan="0">
</td>
</tr>
<tr>
<td>
XkbControlsMask</td>
<td>
ctrls</td>
<td>
(1L&lt;&lt;0)</td>
</tr>
<tr>
<td>
XkbServerMapMask</td>
<td>
server</td>
<td>
(1L&lt;&lt;1)</td>
</tr>
<tr>
<td>
XkbIClientMapMask</td>
<td>
map</td>
<td>
(1L&lt;&lt;2)</td>
</tr>
<tr>
<td>
XkbIndicatorMapMask</td>
<td>
indicators</td>
<td>
(1L&lt;&lt;3)</td>
</tr>
<tr>
<td>
XkbNamesMask</td>
<td>
names</td>
<td>
(1L&lt;&lt;4)</td>
</tr>
<tr>
<td>
XkbCompatMapMask</td>
<td>
compat</td>
<td>
(1L&lt;&lt;5)</td>
</tr>
<tr>
<td>
XkbGeometryMask</td>
<td>
geom</td>
<td>
(1L&lt;&lt;6)</td>
</tr>
<tr>
<td>
XkbAllComponentsMask</td>
<td>
All Fields</td>
<td>
(0x7f)</td>
</tr>
</tbody>
</table>
<div style="height: 1.00em;">
&#160;</div>
The XkbSymInterpretRec structure specifies a symbol interpretation:<br/>
 <br/>
    typedef struct {<br/>
        KeySym        sym;         /&#8727; keysym of interest or NULL */<br/>
        unsigned char flags;       /&#8727; XkbSI_AutoRepeat, XkbSI_LockingKey */<br/>
        unsigned char match;       /&#8727; specifies how mods is interpreted */<br/>
        unsigned char mods;        /&#8727; modifier bits, correspond to eight real modifiers */<br/>
        unsigned char virtual_mod; /&#8727; 1 modifier to add to key virtual mod map */<br/>
        XkbAnyAction  act;         /&#8727; action to bind to symbol position on key */<br/>
    } XkbSymInterpretRec,*XkbSymInterpretPtr;<br/>
    <br/>
</div>
<div class="section">
<h1>SEE ALSO</h1> <b>XkbAllocCompatMap</b>(3)</div>
<table class="foot">
<tr>
<td class="foot-date">
libX11 1.4.99.1</td>
<td class="foot-os">
X Version 11</td>
</tr>
</table>
</div>
</body>
</html>

