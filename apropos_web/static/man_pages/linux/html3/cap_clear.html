<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
CAP_CLEAR(3)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
CAP_CLEAR(3)</td>
<td class="head-vol">
Linux Programmer's Manual</td>
<td class="head-rtitle">
CAP_CLEAR(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> cap_clear, cap_clear_flag, cap_get_flag, cap_set_flag, cap_compare - capability data object manipulation</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>#include &lt;sys/capability.h&gt;</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_clear(cap_t </b><i>cap_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_clear_flag(cap_t </b><i>cap_p</i><b>, cap_flag_t </b><i>flag</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_get_flag(cap_t </b><i>cap_p</i><b>, cap_value_t </b><i>cap</i><b>,</b><br/>
<b>                 cap_flag_t </b><i>flag</i><b>, cap_flag_value_t *</b><i>value_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_set_flag(cap_t </b><i>cap_p</i><b>, cap_flag_t </b><i>flag</i><b>, int </b><i>ncap</i><b>,</b><br/>
<b>                 const cap_value_t *</b><i>caps</i><b>, cap_flag_value_t </b><i>value</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_compare(cap_t </b><i>cap_a</i><b>, cap_t </b><i>cap_b</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
Link with <i>-lcap</i>.<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> These functions work on a capability state held in working storage. A <i>cap_t</i> holds information about the capabilities in each of the three sets, Permitted, Inheritable, and Effective. Each capability in a set may be clear (disabled, 0) or set (enabled, 1).<div class="spacer">
</div>
These functions work with the following data types:<dl>
<dt>
<i>cap_value_t</i></dt>
<dd>
identifies a capability, such as <b>CAP_CHOWN</b>.</dd>
</dl>
<dl>
<dt>
<i>cap_flag_t</i></dt>
<dd>
identifies one of the three flags associated with a capability (i.e., it identifies one of the three capability sets). Valid values for this type are <b>CAP_EFFECTIVE</b>, <b>CAP_INHERITABLE</b> or <b>CAP_PERMITTED</b>.</dd>
</dl>
<dl>
<dt>
<i>cap_flag_value_t</i></dt>
<dd>
identifies the setting of a particular capability flag (i.e, the value of a capability in a set). Valid values for this type are <b>CAP_CLEAR</b> (0) or <b>CAP_SET</b> (1).</dd>
</dl>
<div class="spacer">
</div>
<b>cap_clear</b>() initializes the capability state in working storage identified by <i>cap_p</i> so that all capability flags are cleared.<div class="spacer">
</div>
<b>cap_clear_flag</b>() clears all of the capabilities of the specified capability flag, <i>flag</i>.<div class="spacer">
</div>
<b>cap_get_flag</b>() obtains the current value of the capability flag, <i>flag</i>, of the capability, <i>cap</i>, from the capability state identified by <i>cap_p</i> and places it in the location pointed to by <i>value_p</i>.<div class="spacer">
</div>
<b>cap_set_flag</b>() sets the flag, <i>flag</i>, of each capability in the array <i>caps</i> in the capability state identified by <i>cap_p</i> to <i>value</i>. The argument, <i>ncap</i>, is used to specify the number of capabilities in the array, <i>caps</i>.<div class="spacer">
</div>
<b>cap_compare</b>() compares two full capability sets and, in the spirit of <b>memcmp</b>(), returns zero if the two capability sets are identical. A positive return value, <b>status</b>, indicates there is a difference between them. The returned value carries further information about which of three sets, <i>cap_flag_t</i> <b>flag</b>, differ. Specifically, the macro <b>CAP_DIFFERS</b> (<i>status</i>, <i>flag</i>) evaluates to non-zero if the returned status differs in its <i>flag</i> components.</div>
<div class="section">
<h1>RETURN VALUE</h1> <b>cap_clear</b>(), <b>cap_clear_flag</b>(), <b>cap_get_flag</b>() <b>cap_set_flag</b>() and <b>cap_compare</b>() return zero on success, and -1 on failure. Other return values for <b>cap_compare</b>() are described above.<div class="spacer">
</div>
On failure, <i>errno</i> is set to <b>EINVAL</b>, indicating that one of the arguments is invalid.</div>
<div class="section">
<h1>CONFORMING TO</h1> These functions are as per the withdrawn POSIX.1e draft specification. <b>cap_clear_flag</b>() and <b>cap_compare</b>() are Linux extensions.</div>
<div class="section">
<h1>SEE ALSO</h1> <b>libcap</b>(3), <b>cap_copy_ext</b>(3), <b>cap_from_text</b>(3), <b>cap_get_file</b>(3), <b>cap_get_proc</b>(3), <b>cap_init</b>(3), <b>capabilities</b>(7)</div>
<table class="foot">
<tr>
<td class="foot-date">
2008-05-11</td>
<td class="foot-os">
</td>
</tr>
</table>
</div>
</body>
</html>

