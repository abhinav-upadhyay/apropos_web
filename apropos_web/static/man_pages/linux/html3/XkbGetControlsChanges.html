<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
XkbGetControlsChanges(3)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
XkbGetControlsChanges(3)</td>
<td class="head-vol">
XKB FUNCTIONS</td>
<td class="head-rtitle">
XkbGetControlsChanges(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> XkbGetControlsChanges - Updates a local copy of a keyboard description with the changes previously noted by one or more calls to XkbNoteControlsChanges</div>
<div class="section">
<h1>SYNOPSIS</h1><div style="margin-left: 5.00ex;text-indent: -5.00ex;" class="spacer">
XkbGetControlsChanges <b>(Display *</b><i>dpy</i><b>,</b> <b>XkbDescPtr </b><i>xkb</i><b>,</b> <b>XkbNameChangesPtr </b><i>changes</i><b>);</b></div>
</div>
<div class="section">
<h1>ARGUMENTS</h1><dl>
<dt>
<i>- dpy</i></dt>
<dd>
connection to X server</dd>
</dl>
<dl>
<dt>
<i>- xkb</i></dt>
<dd>
xkb-&gt;ctrls will be updated</dd>
</dl>
<dl>
<dt>
<i>- changes</i></dt>
<dd>
indicates which parts of xkb-&gt;ctrls to update</dd>
</dl>
</div>
<div class="section">
<h1>DESCRIPTION</h1> Whenever a field in the controls structure changes in the server's keyboard description, the server sends an XkbControlsNotify event to all interested clients.To receive XkbControlsNotify events under all possible conditions, use <i>XkbSelectEvents</i> and pass XkbControlsNotifyMask in both <i>bits_to_change</i> and <i>values_for_bits.</i><div style="height: 1.00em;">
&#160;</div>
To receive XkbControlsNotify events only under certain conditions, use <i>XkbSelectEventDetails</i> using XkbControlsNotify as the <i>event_type</i> and specifying the desired state changes in <i>bits_to_change</i> and <i>values_for_bits</i> using mask bits from Table 1.<div style="height: 1.00em;">
&#160;</div>
Table 1 shows the actual values for the individual mask bits used to select controls for modification and to enable and disable the control. Note that the same mask bit is used to specify general modifications to the parameters used to configure the control (which), and to enable and disable the control (enabled_ctrls). The anomalies in the table (no &quot;ok&quot; in column) are for controls that have no configurable attributes; and for controls that are not boolean controls and therefore cannot be enabled or disabled.<div style="height: 1.00em;">
&#160;</div>
<table class="tbl">
<col style="width: 23.00ex;"/>
<col style="width: 13.00ex;"/>
<col style="width: 7.00ex;"/>
<col style="width: 21.00ex;"/>
<tbody>
<tr>
<td>
Table 1 Controls Mask Bits</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="0">
</td>
</tr>
<tr>
<td>
Mask Bit</td>
<td>
which or</td>
<td>
enabled</td>
<td>
Value</td>
</tr>
<tr>
<td>
</td>
<td>
changed_ctrls</td>
<td>
_ctrls</td>
<td>
</td>
</tr>
<tr>
<td colspan="0">
</td>
</tr>
<tr>
<td>
XkbRepeatKeysMask</td>
<td>
ok</td>
<td>
ok</td>
<td>
(1L&lt;&lt;0)</td>
</tr>
<tr>
<td>
XkbSlowKeysMask</td>
<td>
ok</td>
<td>
ok</td>
<td>
(1L&lt;&lt;1)</td>
</tr>
<tr>
<td>
XkbBounceKeysMask</td>
<td>
ok</td>
<td>
ok</td>
<td>
(1L&lt;&lt;2)</td>
</tr>
<tr>
<td>
XkbStickyKeysMask</td>
<td>
ok</td>
<td>
ok</td>
<td>
(1L&lt;&lt;3)</td>
</tr>
<tr>
<td>
XkbMouseKeysMask</td>
<td>
ok</td>
<td>
ok</td>
<td>
(1L&lt;&lt;4)</td>
</tr>
<tr>
<td>
XkbMouseKeysAccelMask</td>
<td>
ok</td>
<td>
ok</td>
<td>
(1L&lt;&lt;5)</td>
</tr>
<tr>
<td>
XkbAccessXKeysMask</td>
<td>
ok</td>
<td>
ok</td>
<td>
(1L&lt;&lt;6)</td>
</tr>
<tr>
<td>
XkbAccessXTimeoutMask</td>
<td>
ok</td>
<td>
ok</td>
<td>
(1L&lt;&lt;7)</td>
</tr>
<tr>
<td>
XkbAccessXFeedbackMask</td>
<td>
ok</td>
<td>
ok</td>
<td>
(1L&lt;&lt;8)</td>
</tr>
<tr>
<td>
XkbAudibleBellMask</td>
<td>
</td>
<td>
ok</td>
<td>
(1L&lt;&lt;9)</td>
</tr>
<tr>
<td>
XkbOverlay1Mask</td>
<td>
</td>
<td>
ok</td>
<td>
(1L&lt;&lt;10)</td>
</tr>
<tr>
<td>
XkbOverlay2Mask</td>
<td>
</td>
<td>
ok</td>
<td>
(1L&lt;&lt;11)</td>
</tr>
<tr>
<td>
XkbIgnoreGroupLockMask</td>
<td>
</td>
<td>
ok</td>
<td>
(1L&lt;&lt;12)</td>
</tr>
<tr>
<td>
XkbGroupsWrapMask</td>
<td>
ok</td>
<td>
</td>
<td>
(1L&lt;&lt;27)</td>
</tr>
<tr>
<td>
XkbInternalModsMask</td>
<td>
ok</td>
<td>
</td>
<td>
(1L&lt;&lt;28)</td>
</tr>
<tr>
<td>
XkbIgnoreLockModsMask</td>
<td>
ok</td>
<td>
</td>
<td>
(1L&lt;&lt;29)</td>
</tr>
<tr>
<td>
XkbPerKeyRepeatMask</td>
<td>
ok</td>
<td>
</td>
<td>
(1L&lt;&lt;30)</td>
</tr>
<tr>
<td>
XkbControlsEnabledMask</td>
<td>
ok</td>
<td>
</td>
<td>
(1L&lt;&lt;31)</td>
</tr>
<tr>
<td>
XkbAccessXOptionsMask</td>
<td>
ok</td>
<td>
ok</td>
<td>
(XkbStickyKeysMask | </td>
</tr>
<tr>
<td>
XkbAccessXFeedbackMask)</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
XkbAllBooleanCtrlsMask</td>
<td>
</td>
<td>
ok</td>
<td>
(0x00001FFF) </td>
</tr>
<tr>
<td>
XkbAllControlsMask</td>
<td>
ok</td>
<td>
</td>
<td>
(0xF8001FFF)</td>
</tr>
</tbody>
</table>
<div style="height: 1.00em;">
&#160;</div>
The <i>changed_ctrls</i> field specifies the controls components that have changed and consists of bits taken from the masks defined in Table 10.7 with &quot;ok&quot; in the <i>changed_ctrls</i> column.<div style="height: 1.00em;">
&#160;</div>
The controls currently enabled in the server are reported in the <i>enabled_ctrls</i> field. If any controls were just enabled or disabled (that is, the contents of the <i>enabled_ctrls</i> field changed), they are flagged in the <i>enabled_ctrl_changes</i> field. The valid bits for these fields are the masks listed in Table 10.7 with &quot;ok&quot; in the <i>enabled_ctrls</i> column. The <i>num_groups</i> field reports the number of groups bound to the key belonging to the most number of groups and is automatically updated when the keyboard mapping changes.<div style="height: 1.00em;">
&#160;</div>
If the change was caused by a request from a client, the <i>keycode</i> and <i>event_type</i> fields are set to zero and the <i>req_major</i> and <i>req_minor</i> fields identify the request. The <i>req_major value is the same as the major extension opcode. Otherwise,</i> <i>event_type</i> is set to the type of event that caused the change (one of KeyPress, KeyRelease, DeviceKeyPress, DeviceKeyRelease, ButtonPress or ButtonRelease), and <i>req_major</i> and <i>req_minor</i> are undefined. If <i>event_type</i> is KeyPress, KeyRelease, DeviceKeyPress, or DeviceKeyRelease, the <i>keycode</i> field is set to the key that caused the change. If <i>event_type</i> is ButtonPress or ButtonRelease, <i>keycode</i> contains the button number.<div style="height: 1.00em;">
&#160;</div>
When a client receives an XkbControlsNotify event, it can note the changes in a changes structure using <i>XkbNoteControlsChanges.</i><div style="height: 1.00em;">
&#160;</div>
<i>XkbGetControlsChanges</i> examines the <i>changes</i> parameter, queries the server for the necessary information, and copies the results into the <i>xkb-&gt;ctrls</i> keyboard description. If the <i>ctrls</i> field of <i>xkb</i> is NULL, <i>XkbGetControlsChanges</i> allocates and initializes it. To free the <i>ctrls</i> field, use XkbFreeControls.<div style="height: 1.00em;">
&#160;</div>
<i>XkbGetControlsChanges</i> returns Success if successful and can generate BadAlloc, BadImplementation, and BadMatch errors.</div>
<div class="section">
<h1>RETURN VALUES</h1><dl>
<dt>
Success</dt>
<dd>
The <i>XkbGetControlsChanges</i> function returns Success if the query of the server was successful.</dd>
</dl>
</div>
<div class="section">
<h1>STRUCTURES</h1><br/>
The structure for the XkbControlsNotify event is defined as follows:<div class="spacer">
</div>
<br/>
typedef struct {<br/>
    int           type;          /&#8727; Xkb extension base event code */<br/>
    unsigned long serial;        /&#8727; X server serial number for event */<br/>
    Bool          send_event;    /&#8727; True =&gt; synthetically generated */<br/>
    Display *     display;       /&#8727; server connection where event generated */<br/>
    Time          time;          /&#8727; server time when event generated */<br/>
    int           xkb_type;      /&#8727; XkbCompatMapNotify */<br/>
    int           device;        /&#8727; Xkb device ID, will not be XkbUseCoreKbd */<br/>
    unsigned int  changed_ctrls; /&#8727; bits indicating which controls data have <br/>
changed*/<br/>
    unsigned int  enabled_ctrls; /&#8727; controls currently enabled in server */<br/>
    unsigned int  enabled_ctrl_changes; /&#8727; bits indicating enabled/disabled <br/>
controls */<br/>
    int           num_groups;    /&#8727; current number of keyboard groups */<br/>
    KeyCode       keycode;       /&#8727; != 0 =&gt; keycode of key causing change */<br/>
    char          event_type;    /&#8727; Type of event causing change */<br/>
    char          req_major;     /&#8727; major event code of event causing change */<br/>
    char          req_minor;     /&#8727; minor event code of event causing change */<br/>
} XkbControlsNotifyEvent;<br/>
</div>
<div class="section">
<h1>DIAGNOSTICS</h1><dl>
<dt>
<b>BadAlloc</b></dt>
<dd>
Unable to allocate storage</dd>
</dl>
<dl>
<dt>
<b>BadImplementation</b></dt>
<dd>
Invalid reply from server</dd>
</dl>
<dl>
<dt>
<b>BadMatch</b></dt>
<dd>
A compatible version of Xkb was not available in the server or an argument has correct type and range, but is otherwise invalid</dd>
</dl>
</div>
<div class="section">
<h1>SEE ALSO</h1> <b>XkbFreeControls</b>(3), <b>XkbNoteControlsChanges</b>(3), <b>XkbSelectEventDetails</b>(3), <b>XkbSelectEvents</b>(3)</div>
<table class="foot">
<tr>
<td class="foot-date">
libX11 1.4.99.1</td>
<td class="foot-os">
X Version 11</td>
</tr>
</table>
</div>
</body>
</html>

