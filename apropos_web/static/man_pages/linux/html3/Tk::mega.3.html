<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
mega(3pm)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
mega(3pm)</td>
<td class="head-vol">
User Contributed Perl Documentation</td>
<td class="head-rtitle">
mega(3pm)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Tk::mega - Perl/Tk support for writing widgets in pure Perl</div>
<div class="section">
<h1>SYNOPSIS</h1> Define the widget's new class name:<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<b>package Tk::</b><i>MyNewWidget</i>;<div class="spacer">
</div>
For composite widget classes:<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<b>use base qw/ Tk::container /</b>; # where <b>container</b> is <i>Frame</i> or <i>Toplevel</i><div class="spacer">
</div>
For derived widget classes:<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<b>use base qw/ Tk::Derived Tk::DerivedWidget /;</b><div class="spacer">
</div>
Install the new widget in Tk's namespace and establish class and instance constructors.<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<b>Construct Tk::</b><i>Widget</i> <i>'MyNewWidget'</i>;<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<b>sub ClassInit</b> { <i>my ($self, </i><i>$args</i><i>) = </i><i>@_</i><i>; ...</i> }<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<b>sub Populate</b> { <i>my ($self, </i><i>$args</i><i>) = </i><i>@_</i><i>; ...</i> }</div>
<div class="section">
<h1>DESCRIPTION</h1> The goal of the mega-widget support of Perl/Tk is to make it easy to write mega-widgets that obey the same protocol and interface that the Tk core widgets support.  <i>For mega-widget sample code please run the </i><b><i>widget</i></b><i> demonstration program and go to the section </i><b><i>Sample Perl Mega-Widgets</i></b><i>.</i><div class="spacer">
</div>
There are two kinds of mega-widgets:<dl>
<dt>
&#8226;</dt>
<dd>
Composite Widgets<div style="height: 1.00em;">
&#160;</div>
A composite widget is composed with one or more existing widgets. The composite widget looks to the user like a simple single widget. A well known example is the file selection box.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Derived Widgets<div style="height: 1.00em;">
&#160;</div>
A derived widget adds/modifies/removes properties and methods from a single widget (this widget may itself be a mega-widget).</dd>
</dl>
</div>
<div class="section">
<h1>MEGA-WIDGET SUPPORT</h1><div class="subsection">
<h2>Advertise</h2> Give a subwidget a symbolic name.<div class="spacer">
</div>
Usage:<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<i></i><i>$self</i><i></i>-&gt;<b>Advertise</b>(<b>name</b>=&gt;<i></i><i>$widget</i><i></i>);<div class="spacer">
</div>
Gives a subwidget <i></i><i>$widget</i><i></i> of the mega-widget <i></i><i>$self</i><i></i> the name  <b>name</b>.  One can retrieve the reference of an advertised subwidget with the Subwidget method.<div class="spacer">
</div>
<b>Comment:</b> Mega-Widget Writers: Please make sure to document the advertised widgets that are intended for  <i>public</i> use. If there are none, document this fact, e.g.:<div class="spacer">
</div>
<br/>
        =head1 ADVERTISED WIDGETS<br/>
<br/>
        None.<br/>
</div>
<div class="subsection">
<h2>Callback</h2> Invoke a callback specified with an option.<div class="spacer">
</div>
Usage:<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<i></i><i>$self</i><i></i>-&gt;<b>Callback</b>(<i>-option</i> ?,<i>args</i> ...?);<div class="spacer">
</div>
<b>Callback</b> executes the callback defined with  <i></i><i>$self</i><i></i>-&gt;<b>ConfigSpecs</b>(<i>-option</i>, [<b>CALLBACK</b>, ...]); If  <i>args</i> are given they are passed to the callback. If  <i>-option</i> is not defined it does nothing.</div>
<div class="subsection">
<h2>ClassInit</h2> Initialization of the mega-widget class.<div class="spacer">
</div>
Usage:<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<b>sub ClassInit</b> { <i>my ($class, </i><i>$mw</i><i>) = </i><i>@_</i><i>;</i> ...  }<div class="spacer">
</div>
<b>ClassInit</b> is called once for <i>each</i> MainWindow just before the first widget instance of a class is created in the widget tree of  <b>MainWindow</b>.<div class="spacer">
</div>
<b>ClassInit</b> is often used to define bindings and/or other resources shared by all instances, e.g., images.<div class="spacer">
</div>
Examples:<div class="spacer">
</div>
<br/>
 $mw-&gt;bind($class,&quot;&lt;Tab&gt;&quot;, sub { my $w = shift; $w-&gt;Insert(&quot;\t&quot;); $w-&gt;focus; $w-&gt;break});<br/>
 $mw-&gt;bind($class,&quot;&lt;Return&gt;&quot;, ['Insert',&quot;\n&quot;]);<br/>
 $mw-&gt;bind($class,&quot;&lt;Delete&gt;&quot;,'Delete');<br/>
<div class="spacer">
</div>
Notice that <i></i><i>$class</i><i></i> is the class name (e.g. <b>Tk::MyText</b>) and <i></i><i>$mw</i><i></i> is the mainwindow.<div class="spacer">
</div>
Don't forget to call <i></i><i>$class</i><i></i>-&gt;<b>SUPER::ClassInit($mw)</b> in  <b>ClassInit</b>.</div>
<div class="subsection">
<h2>Component</h2> Convenience function to create subwidgets.<div class="spacer">
</div>
Usage:<div class="spacer">
</div>
<br/>
    $cw-&gt;Component('Whatever', 'AdvertisedName',<br/>
        -delegate =&gt; ['method1', 'method2', ...],<br/>
        ... more widget options ...,<br/>
    );<br/>
<div class="spacer">
</div>
<b>Component</b> does several things for you with one call:<div style="height: 1.00em;">
&#160;</div>
<div style="margin-left: 4.00ex;">
o Creates the widget<div style="height: 1.00em;">
&#160;</div>
o Advertises it with a given name (overridden by 'Name' option)<div style="height: 1.00em;">
&#160;</div>
o Delegates a set of methods to this widget (optional)</div>
<div class="spacer">
</div>
Example:<div class="spacer">
</div>
<br/>
    $cw-&gt;Component('Button', 'quitButton', -command =&gt; sub{$mw-&gt;'destroy'});<br/>
</div>
<div class="subsection">
<h2>ConfigSpecs</h2> Defines options and their treatment<div class="spacer">
</div>
Usage:<div class="spacer">
</div>
<br/>
    $cw-&gt;ConfigSpecs(<br/>
        -option =&gt; [ where, dbname, dbclass, default],<br/>
        ...,<br/>
        DEFAULT =&gt; [where],<br/>
    );<br/>
<div class="spacer">
</div>
Defines the options of a mega-widget and what actions are triggered by configure/cget of an option (see Tk::ConfigSpecs and Tk::Derived for details).</div>
<div class="subsection">
<h2>Construct</h2> Make the new mega-widget known to  <b>Tk</b>.<div class="spacer">
</div>
Usage:<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<b>Construct</b> <i>baseclass</i> <b>'Name'</b>;<div class="spacer">
</div>
<b>Construct</b> declares the new widget class so that your mega-widget works like normal Perl/Tk widgets.<div class="spacer">
</div>
Examples:<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<b>Construct Tk::Widget</b> <i>'Whatever'</i>; &#160;&#160;&#160;&#160; <b>Construct Tk::Menu</b>   <i>'MyItem'</i>;<div class="spacer">
</div>
First example lets one use <i></i><i>$widget</i><i></i>-&gt;<b>Whatever</b> to create new  <b>Whatever</b> widget.<div class="spacer">
</div>
The second example restricts the usage of the <b>MyItem</b> constructor method to widgets that are derived from  <b>Menu</b>:  <i></i><i>$isamenu</i><i></i>-&gt;<i>MyItem</i>.</div>
<div class="subsection">
<h2>CreateArgs</h2> Process options before any widget is created:<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<b>sub CreateArgs</b> { <i>my ($package, </i><i>$parent</i><i>, </i><i>$args</i><i>) = </i><i>@_</i><i>; ...; return </i><i>@newargs</i><i>;</i> }<div class="spacer">
</div>
<i></i><i>$package</i><i></i> is the package of the mega-widget (e.g., <b>Tk::MyText</b>,  <i></i><i>$parent</i><i></i> the parent of the widget to be created and $args the hash reference to the options specified in the widget constructor call.<div class="spacer">
</div>
Don't forget to call <i></i><i>$package</i><i></i>-&gt;<b>SUPER::CreateArgs</b>(<i></i><i>$parent</i><i></i>, <i></i><i>$args</i><i></i>) in  <b>CreateArgs</b>.</div>
<div class="subsection">
<h2>Delegates</h2> Redirect a method of the mega-widget to a subwidget of the composite widget<div class="spacer">
</div>
Usage:<div class="spacer">
</div>
<br/>
    $cw-&gt;Delegates(<br/>
        'method1' =&gt; $subwidget1,<br/>
        'method2' =&gt; 'advertived_name',<br/>
        ...,<br/>
        'Construct' =&gt; $subwidget2,<br/>
        'DEFAULT'   =&gt; $subwidget3,<br/>
    );<br/>
<div class="spacer">
</div>
The <b>'Construct'</b> delegation has a special meaning.  After 'Construct' is delegated all Widget constructors are redirected. E.g. after<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<i></i><i>$self</i><i></i>-&gt;<b>Delegates</b>(<b>'Construct'</b>=&gt;<i></i><i>$subframe</i><i></i>);<div class="spacer">
</div>
a <i></i><i>$self</i><i></i>-&gt;<b>Button</b> does really a <i></i><i>$subframe</i><i></i>-&gt;<b>Button</b> so the created button is a child of  <i></i><i>$subframe</i><i></i> and not <i></i><i>$self</i><i></i>.<div class="spacer">
</div>
<b>Comment:</b> Delegates works only with methods that <i></i><i>$cw</i><i></i> does not have itself.</div>
<div class="subsection">
<h2>InitObject</h2>  <i>Note: this method should not, in general, be used, as it has been</i>  <i>superceeded by </i><b><i>Populate</i></b><i> and specifying </i><b><i>Tk::Derived</i></b><i> as one of the base</i>  <i>classes.</i><div class="spacer">
</div>
Defines construction and interface of derived widgets.<div class="spacer">
</div>
Usage:<div class="spacer">
</div>
<br/>
    sub InitObject {<br/>
        my ($derived, $args) = @_;<br/>
        ...<br/>
    }<br/>
<div class="spacer">
</div>
where <i></i><i>$derived</i><i></i> is the widget reference of the already created baseclass widget and  <i></i><i>$args</i><i></i> is the reference to a hash of  <i>-option-value</i> pairs.<div class="spacer">
</div>
<b>InitObject</b> is almost identical to Populate method.  <b>Populate</b> does some more 'magic' things useful for mega-widgets with several widgets.<div class="spacer">
</div>
Don't forget to call <i></i><i>$derived</i><i></i>-&gt;<b>SUPER::InitObject</b>(<i></i><i>$args</i><i></i>) in  <b>InitObject</b>.</div>
<div class="subsection">
<h2>OnDestroy</h2> Define a callback invoked when the mega-widget is destroyed.<div class="spacer">
</div>
Usage:<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<i></i><i>$widget</i><i></i>-&gt;<b>OnDestroy</b>(<i>callback</i>);<div class="spacer">
</div>
<b>OnDestroy</b> installs a callback that's called when a widget is going to to be destroyed.  Useful for special cleanup actions.  It differs from a normal  <b>destroy</b> in that all the widget's data structures are still intact.<div class="spacer">
</div>
<b>Comment:</b> This method could be used with any widgets not just for mega-widgets.  It's listed here because of it's usefulness.</div>
<div class="subsection">
<h2>Populate</h2> Defines construction and interface of the composite widget.<div class="spacer">
</div>
Usage:<div class="spacer">
</div>
<br/>
    sub Populate {<br/>
        my ($self, $args) = @_;<br/>
        ...<br/>
    }<br/>
<div class="spacer">
</div>
where <i></i><i>$self</i><i></i> is the widget reference of the already created baseclass widget and  <i></i><i>$args</i><i></i> is the reference to a hash of  <i>-option-value</i> pairs.<div class="spacer">
</div>
Most the other support function are normally used inside the <b>Populate</b> subroutine.<div class="spacer">
</div>
Don't forget to call <i></i><i>$cw</i><i></i>-&gt;<b>SUPER::Populate</b>(<i></i><i>$args</i><i></i>) in  <b>Populate</b>.</div>
<div class="subsection">
<h2>privateData</h2> Set/get a private hash of a widget to storage composite internal data<div class="spacer">
</div>
Usage:<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<i></i><i>$hashref</i><i></i> = <i></i><i>$self</i><i></i>-&gt;<b>privateData</b>();<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<i></i><i>$another</i><i></i> = <i></i><i>$self</i><i></i>-&gt;<b>privateData</b>(<i>unique_key</i>|<i>package</i>);</div>
<div class="subsection">
<h2>Subwidget</h2> Get the widget reference of an advertised subwidget.<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<i></i><i>@subwidget</i><i></i> = <i></i><i>$cw</i><i></i>-&gt;<b>Subwidget</b>();<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<i></i><i>$subwidget</i><i></i> = <i></i><i>$cw</i><i></i>-&gt;<b>Subwidget</b>(<i>name</i>);<div class="spacer">
</div>
&#160;&#160;&#160;&#160;<i></i><i>@subwidget</i><i></i> = <i></i><i>$cw</i><i></i>-&gt;<b>Subwidget</b>(<i>name</i> ?,...?);<div class="spacer">
</div>
Returns the widget reference(s) of the subwidget known under the given name(s). Without arguments, return all known subwidgets of  <i></i><i>$cw</i><i></i>. See Advertise method how to define  <i>name</i> for a subwidget.<div class="spacer">
</div>
<b>Comment:</b> Mega-Widget Users: Use <b>Subwidget</b> to get <i>only</i> documented subwidgets.</div>
</div>
<div class="section">
<h1>PITFALLS</h1><dl>
<dt>
&#8226;</dt>
<dd>
Resource DB class name<div style="height: 1.00em;">
&#160;</div>
Some of the standard options use a resource date base class that is not equal to the resource database name.  E.g.,<div style="height: 1.00em;">
&#160;</div>
<br/>
  Switch:            Name:             Class:<br/>
<br/>
  -padx              padX              Pad<br/>
  -activerelief      activeRelief      Relief<br/>
  -activebackground  activeBackground  Foreground<br/>
  -status            undef             undef<br/>
<div style="height: 1.00em;">
&#160;</div>
One should do the same when one defines one of these options via  <b>ConfigSpecs</b>.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Method delegation<div style="height: 1.00em;">
&#160;</div>
Redirecting methods to a subwidget with <b>Delegate</b> can only work if the base widget itself does have a method with this name.  Therefore one can't `` <i>delegate</i>'' any of the methods listed in Tk::Widget. A common problematic method is  <b>bind</b>.  In this case one as to explicitely redirect the method.<div style="height: 1.00em;">
&#160;</div>
<br/>
  sub bind {<br/>
      my $self = shift;<br/>
      my $to = $self-&gt;privateData-&gt;{'my_bind_target'};<br/>
      $to-&gt;bind(@_);<br/>
  }<br/>
</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
privateData<div style="height: 1.00em;">
&#160;</div>
Graham Barr wrote: ... It is probably more private than most people think. Not all calls to privateData will return that same HASH reference. The HASH reference that is returned depends on the package it was called from, a different HASH is returned for each package. This allows a widget to hold private data, but then if it is sub-classed the sub-class will get a different HASH and so not cause duplicate name clashes.<div style="height: 1.00em;">
&#160;</div>
But privateData does take an optional argument if you want to force which HASH is returned.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Scrolled and Composite<div style="height: 1.00em;">
&#160;</div>
<b>Scrolled</b>(<i>Kind</i>,...) constructor can not be used with <b>Composite</b>. One has to use $cw-&gt; <b>Composite</b>(<b>Scrl</b><i>Kind</i> =&gt; <b>'name'</b>, ...);</dd>
</dl>
</div>
<div class="section">
<h1>MISSING</h1> Of course Perl/Tk does not define support function for all necessities.  Here's a short list of things you have to handle yourself:<dl>
<dt>
&#8226;</dt>
<dd>
No support to define construction-time only options.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
No support to remove an option that is known to the base widget.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
It's hard to define <b>undef</b> as fallback for an widget option that is not already  <b>undef</b>.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Frame in Perl/Tk carries magic and overhead not needed for composite widget class definition.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
No support methods for bindings that are shared between all widgets of a composite widget (makes sense at all?)</dd>
</dl>
</div>
<div class="section">
<h1>KEYWORDS</h1> mega, composite, derived, widget</div>
<div class="section">
<h1>SEE ALSO</h1> Tk::composite Tk::ConfigSpecs Tk::option Tk::callbacks Tk::bind</div>
<table class="foot">
<tr>
<td class="foot-date">
2007-02-10</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

