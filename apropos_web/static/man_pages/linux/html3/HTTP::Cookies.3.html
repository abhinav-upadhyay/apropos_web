<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
HTTP::Cookies(3pm)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
HTTP::Cookies(3pm)</td>
<td class="head-vol">
User Contributed Perl Documentation</td>
<td class="head-rtitle">
HTTP::Cookies(3pm)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> HTTP::Cookies - HTTP cookie jars</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
  use HTTP::Cookies;<br/>
  $cookie_jar = HTTP::Cookies-&gt;new(<br/>
    file =&gt; &quot;$ENV{'HOME'}/lwp_cookies.dat&quot;,<br/>
    autosave =&gt; 1,<br/>
  );<br/>
<br/>
  use LWP;<br/>
  my $browser = LWP::UserAgent-&gt;new;<br/>
  $browser-&gt;cookie_jar($cookie_jar);<br/>
<div class="spacer">
</div>
Or for an empty and temporary cookie jar:<div class="spacer">
</div>
<br/>
  use LWP;<br/>
  my $browser = LWP::UserAgent-&gt;new;<br/>
  $browser-&gt;cookie_jar( {} );<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> This class is for objects that represent a &quot;cookie jar&quot; -- that is, a database of all the HTTP cookies that a given LWP::UserAgent object knows about.<div class="spacer">
</div>
Cookies are a general mechanism which server side connections can use to both store and retrieve information on the client side of the connection.  For more information about cookies refer to &lt;URL:http://curl.haxx.se/rfc/cookie_spec.html&gt; and &lt;URL:http://www.cookiecentral.com/&gt;.  This module also implements the new style cookies described in  <i>RFC 2965</i>. The two variants of cookies are supposed to be able to coexist happily.<div class="spacer">
</div>
Instances of the class <i>HTTP::Cookies</i> are able to store a collection of Set-Cookie2: and Set-Cookie: headers and are able to use this information to initialize Cookie-headers in  <i>HTTP::Request</i> objects. The state of a  <i>HTTP::Cookies</i> object can be saved in and restored from files.</div>
<div class="section">
<h1>METHODS</h1> The following methods are provided:<dl>
<dt>
$cookie_jar = HTTP::Cookies-&gt;new</dt>
<dd>
The constructor takes hash style parameters.  The following parameters are recognized:<div style="height: 1.00em;">
&#160;</div>
<br/>
  file:            name of the file to restore cookies from and save cookies to<br/>
  autosave:        save during destruction (bool)<br/>
  ignore_discard:  save even cookies that are requested to be discarded (bool)<br/>
  hide_cookie2:    do not add Cookie2 header to requests<br/>
<div style="height: 1.00em;">
&#160;</div>
Future parameters might include (not yet implemented):<div style="height: 1.00em;">
&#160;</div>
<br/>
  max_cookies               300<br/>
  max_cookies_per_domain    20<br/>
  max_cookie_size           4096<br/>
<br/>
  no_cookies   list of domain names that we never return cookies to<br/>
</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;add_cookie_header( $request )</dt>
<dd>
The <i>add_cookie_header()</i> method will set the appropriate Cookie:-header for the  <i>HTTP::Request</i> object given as argument.  The $request must have a valid url attribute before this method is called.</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;extract_cookies( $response )</dt>
<dd>
The <i>extract_cookies()</i> method will look for Set-Cookie: and Set-Cookie2: headers in the  <i>HTTP::Response</i> object passed as argument.  Any of these headers that are found are used to update the state of the $cookie_jar.</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;set_cookie( $version, $key, $val, $path, $domain, $port, $path_spec, $secure, $maxage, $discard, \%rest )</dt>
<dd>
The <i>set_cookie()</i> method updates the state of the $cookie_jar.  The $key, $val, $domain, $port and $path arguments are strings.  The $path_spec, $secure, $discard arguments are boolean values. The $maxage value is a number indicating number of seconds that this cookie will live.  A value &lt;= 0 will delete this cookie.  %rest defines various other attributes like &quot;Comment&quot; and &quot;CommentURL&quot;.</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;save</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;save( $file )</dt>
<dd>
This method file saves the state of the $cookie_jar to a file. The state can then be restored later using the  <i>load()</i> method.  If a filename is not specified we will use the name specified during construction.  If the attribute  <i>ignore_discard</i> is set, then we will even save cookies that are marked to be discarded.<div style="height: 1.00em;">
&#160;</div>
The default is to save a sequence of &quot;Set-Cookie3&quot; lines. &quot;Set-Cookie3&quot; is a proprietary LWP format, not known to be compatible with any browser.  The  <i>HTTP::Cookies::Netscape</i> sub-class can be used to save in a format compatible with Netscape.</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;load</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;load( $file )</dt>
<dd>
This method reads the cookies from the file and adds them to the $cookie_jar.  The file must be in the format written by the  <i>save()</i> method.</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;revert</dt>
<dd>
This method empties the $cookie_jar and re-loads the $cookie_jar from the last save file.</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;clear</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;clear( $domain )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;clear( $domain, $path )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;clear( $domain, $path, $key )</dt>
<dd>
Invoking this method without arguments will empty the whole $cookie_jar.  If given a single argument only cookies belonging to that domain will be removed.  If given two arguments, cookies belonging to the specified path within that domain are removed.  If given three arguments, then the cookie with the specified key, path and domain is removed.</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;clear_temporary_cookies</dt>
<dd>
Discard all temporary cookies. Scans for all cookies in the jar with either no expire field or a true &quot;discard&quot; flag. To be called when the user agent shuts down according to RFC 2965.</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;scan( \&amp;callback )</dt>
<dd>
The argument is a subroutine that will be invoked for each cookie stored in the $cookie_jar.  The subroutine will be invoked with the following arguments:<div style="height: 1.00em;">
&#160;</div>
<br/>
  0  version<br/>
  1  key<br/>
  2  val<br/>
  3  path<br/>
  4  domain<br/>
  5  port<br/>
  6  path_spec<br/>
  7  secure<br/>
  8  expires<br/>
  9  discard<br/>
 10  hash<br/>
</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;as_string</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
$cookie_jar-&gt;as_string( $skip_discardables )</dt>
<dd>
The <i>as_string()</i> method will return the state of the $cookie_jar represented as a sequence of &quot;Set-Cookie3&quot; header lines separated by &quot;\n&quot;.  If $skip_discardables is TRUE, it will not return lines for cookies with the  <i>Discard</i> attribute.</dd>
</dl>
</div>
<div class="section">
<h1>SEE ALSO</h1> HTTP::Cookies::Netscape, HTTP::Cookies::Microsoft</div>
<div class="section">
<h1>COPYRIGHT</h1> Copyright 1997-2002 Gisle Aas<div class="spacer">
</div>
This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-02-27</td>
<td class="foot-os">
perl v5.12.3</td>
</tr>
</table>
</div>
</body>
</html>

