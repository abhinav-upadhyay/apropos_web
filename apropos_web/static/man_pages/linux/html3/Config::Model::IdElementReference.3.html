<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
Config::Model::IdElementReference(3pm)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
Config::Model::IdElementReference(3pm)</td>
<td class="head-vol">
User Contributed Perl Documentation</td>
<td class="head-rtitle">
Config::Model::IdElementReference(3pm)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Config::Model::IdElementReference - Refer to id element(s) and extract keys</div>
<div class="section">
<h1>VERSION</h1> version 2.005</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
 # synopsis shows an example of model of a network to use references<br/>
 <br/>
 use Config::Model;<br/>
 use Log::Log4perl qw(:easy);<br/>
 Log::Log4perl-&gt;easy_init($WARN);<br/>
<br/>
 my $model = Config::Model-&gt;new;<br/>
<br/>
 # model of several hosts with several NICs<br/>
 $model-&gt;create_config_class(<br/>
    name      =&gt; 'Host',<br/>
    'element' =&gt; [<br/>
        ip_nic =&gt; {<br/>
            type       =&gt; 'hash',<br/>
            index_type =&gt; 'string',<br/>
            cargo      =&gt; {<br/>
                type       =&gt; 'leaf',<br/>
                value_type =&gt; 'uniline',<br/>
            }<br/>
        },<br/>
    ]<br/>
 );<br/>
<br/>
 # model to choose a master host and a master NIC (whatever that may be)<br/>
 # among configured hosts. Once these 2 are configured, the model computes <br/>
 # the master IP<br/>
<br/>
 $model-&gt;create_config_class(<br/>
    name =&gt; &quot;MyNetwork&quot;,<br/>
<br/>
    element =&gt; [<br/>
        host =&gt; {<br/>
            type       =&gt; 'hash',<br/>
            index_type =&gt; 'string',<br/>
            cargo      =&gt; {<br/>
                type              =&gt; 'node',<br/>
                config_class_name =&gt; 'Host'<br/>
            },<br/>
        },<br/>
<br/>
        # master_host is one of the configured hosts<br/>
        master_host =&gt; {<br/>
            type       =&gt; 'leaf',<br/>
            value_type =&gt; 'reference', # provided by tConfig::Model::IdElementReference<br/>
            refer_to   =&gt; '! host'<br/>
        },<br/>
<br/>
        # master_nic is one NIC of the master host<br/>
        master_nic =&gt; {<br/>
            type              =&gt; 'leaf',<br/>
            value_type        =&gt; 'reference', # provided by tConfig::Model::IdElementReference<br/>
            computed_refer_to =&gt; {            # provided by Config::Model::ValueComputer<br/>
                formula   =&gt; '  ! host:$h ip_nic ',<br/>
                variables =&gt; { h =&gt; '- master_host' }<br/>
            }<br/>
        },<br/>
<br/>
        # provided by Config::Model::ValueComputer<br/>
        master_ip =&gt; {<br/>
            type       =&gt; 'leaf',<br/>
            value_type =&gt; 'string',<br/>
            compute    =&gt; {<br/>
                formula   =&gt; '$ip',<br/>
                variables =&gt; {<br/>
                    h   =&gt; '- master_host',<br/>
                    nic =&gt; '- master_nic',<br/>
                    ip  =&gt; '! host:$h ip_nic:$nic'<br/>
                }<br/>
            }<br/>
        },<br/>
<br/>
    ],<br/>
 );<br/>
<br/>
 my $inst = $model-&gt;instance(root_class_name =&gt; 'MyNetwork' );<br/>
<br/>
 my $root = $inst-&gt;config_root ;<br/>
<br/>
 # configure hosts on my network<br/>
 my $step = 'host:foo ip_nic:eth0=192.168.0.1 ip_nic:eth1=192.168.1.1 -<br/>
             host:bar ip_nic:eth0=192.168.0.2 ip_nic:eth1=192.168.1.2 -<br/>
             host:baz ip_nic:eth0=192.168.0.3 ip_nic:eth1=192.168.1.3 ';<br/>
 $root-&gt;load( step =&gt; $step );<br/>
<br/>
 print &quot;master host can be one of &quot;,<br/>
   join(' ',$root-&gt;fetch_element('master_host')-&gt;get_choice),&quot;\n&quot; ; <br/>
 # prints: master host can be one of bar baz foo<br/>
<br/>
 # choose master host<br/>
 $root-&gt;load('master_host=bar') ;<br/>
<br/>
 print &quot;master NIC of master host can be one of &quot;,<br/>
 join(' ',$root-&gt;fetch_element('master_nic')-&gt;get_choice),&quot;\n&quot; ; <br/>
 # prints: master NIC of master host can be one of eth0 eth1<br/>
<br/>
 # choose master nic<br/>
 $root-&gt;load('master_nic=eth1') ;<br/>
<br/>
 # check what is the master IP computed by the model<br/>
 print &quot;master IP is &quot;,$root-&gt;grab_value('master_ip'),&quot;\n&quot;;<br/>
 # prints master IP is 192.168.1.2<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> This class is user by Config::Model::Value to set up an enumerated value where the possible choice depends on the key of a Config::Model::HashId or the content of a Config::Model::ListId object.<div class="spacer">
</div>
This class is also used by Config::Model::CheckList to define the checklist items from the keys of another hash (or content of a list).</div>
<div class="section">
<h1>CONSTRUCTOR</h1> Construction is handled by the calling object (Config::Model::Node).</div>
<div class="section">
<h1>Config class parameters</h1><dl>
<dt>
refer_to</dt>
<dd>
&quot;refer_to&quot; is used to specify a hash element that will be used as a reference. &quot;refer_to&quot; points to an array or hash element in the configuration tree using the path syntax (See &quot;grab&quot; in Config::Model::Node for details).</dd>
</dl>
<dl>
<dt>
computed_refer_to</dt>
<dd>
When &quot;computed_refer_to&quot; is used, the path is computed using values from several elements in the configuration tree. &quot;computed_refer_to&quot; is a hash with 2 mandatory elements: &quot;formula&quot; and &quot;variables&quot;.</dd>
</dl>
<div class="spacer">
</div>
The available choice of this (computed or not) reference value is made from the available keys of the refered_to hash element or the values of the refered_to array element.<div class="spacer">
</div>
The example means the the value must correspond to an existing host:<div class="spacer">
</div>
<br/>
 value_type =&gt; 'reference',<br/>
 refer_to =&gt; '! host'<br/>
<div class="spacer">
</div>
This example means the the value must correspond to an existing lan within the host whose Id is specified by hostname:<div class="spacer">
</div>
<br/>
 value_type =&gt; 'reference',<br/>
 computed_refer_to =&gt; { formula =&gt; '! host:$a lan', <br/>
                        variables =&gt; { a =&gt; '- hostname' }<br/>
                      }<br/>
<div class="spacer">
</div>
If you need to combine possibilities from several hash, use the &quot;&quot;+&quot;&quot; token to separate 2 paths:<div class="spacer">
</div>
<br/>
 value_type =&gt; 'reference',<br/>
 computed_refer_to =&gt; { formula =&gt; '! host:$a lan + ! host:foobar lan', <br/>
                        variables =&gt; { a =&gt; '- hostname' }<br/>
                      }<br/>
<div class="spacer">
</div>
You can specify &quot;refer_to&quot; or &quot;computed_refer_to&quot; with a &quot;choice&quot; argument so the possible enum value will be the combination of the specified choice and the refered_to values.</div>
<div class="section">
<h1>Methods</h1><div class="subsection">
<h2>reference_info</h2> Returns a human readable string with explains how is retrieved the reference. This method is mostly used to construct an error messages.</div>
</div>
<div class="section">
<h1>AUTHOR</h1> Dominique Dumont, (ddumont at cpan dot org)</div>
<div class="section">
<h1>SEE ALSO</h1> Config::Model, Config::Model::Value, Config::Model::AnyId, Config::Model::CheckList</div>
<table class="foot">
<tr>
<td class="foot-date">
2012-02-24</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

