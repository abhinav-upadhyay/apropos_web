<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
Moose::Cookbook::Extending::Recipe4(3pm)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
Moose::Cookbook::Extending::Recipe4(3pm)</td>
<td class="head-vol">
User Contributed Perl Documentation</td>
<td class="head-rtitle">
Moose::Cookbook::Extending::Recipe4(3pm)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Moose::Cookbook::Extending::Recipe4 - Acting like Moose.pm and providing sugar Moose-style</div>
<div class="section">
<h1>VERSION</h1> version 2.0401</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
  package MyApp::Mooseish;<br/>
<br/>
  use Moose ();<br/>
  use Moose::Exporter;<br/>
<br/>
  Moose::Exporter-&gt;setup_import_methods(<br/>
      with_meta =&gt; ['has_table'],<br/>
      also      =&gt; 'Moose',<br/>
  );<br/>
<br/>
  sub init_meta {<br/>
      shift;<br/>
      return Moose-&gt;init_meta( @_, metaclass =&gt; 'MyApp::Meta::Class' );<br/>
  }<br/>
<br/>
  sub has_table {<br/>
      my $meta = shift;<br/>
      $meta-&gt;table(shift);<br/>
  }<br/>
<br/>
  package MyApp::Meta::Class;<br/>
  use Moose;<br/>
<br/>
  extends 'Moose::Meta::Class';<br/>
<br/>
  has 'table' =&gt; ( is =&gt; 'rw' );<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> This recipe expands on the use of Moose::Exporter we saw in Moose::Cookbook::Extending::Recipe1. Instead of providing our own object base class, we provide our own metaclass class, and we also export a &quot;has_table&quot; sugar function.<div class="spacer">
</div>
Given the above code, you can now replace all instances of &quot;use Moose&quot; with &quot;use MyApp::Mooseish&quot;. Similarly, &quot;no Moose&quot; is now replaced with &quot;no MyApp::Mooseish&quot;.<div class="spacer">
</div>
The &quot;with_meta&quot; parameter specifies a list of functions that should be wrapped before exporting. The wrapper simply ensures that the importing package's appropriate metaclass object is the first argument to the function, so we can do &quot;my&#160;$meta&#160;=&#160;shift;&quot;.<div class="spacer">
</div>
See the Moose::Exporter docs for more details on its API.</div>
<div class="section">
<h1>USING MyApp::Mooseish</h1> The purpose of all this code is to provide a Moose-like interface. Here's what it would look like in actual use:<div class="spacer">
</div>
<br/>
  package MyApp::User;<br/>
<br/>
  use MyApp::Mooseish;<br/>
<br/>
  has_table 'User';<br/>
<br/>
  has 'username' =&gt; ( is =&gt; 'ro' );<br/>
  has 'password' =&gt; ( is =&gt; 'ro' );<br/>
<br/>
  sub login { ... }<br/>
<br/>
  no MyApp::Mooseish;<br/>
<div class="spacer">
</div>
All of the normal Moose sugar (&quot;has()&quot;, &quot;with()&quot;, etc) is available when you &quot;use MyApp::Mooseish&quot;.</div>
<div class="section">
<h1>CONCLUSION</h1> Providing sugar functions can make your extension look much more Moose-ish. See Fey::ORM for a more extensive example.</div>
<div class="section">
<h1>AUTHOR</h1> Moose is maintained by the Moose Cabal, along with the help of many contributors. See &quot;CABAL&quot; in Moose and &quot;CONTRIBUTORS&quot; in Moose for details.</div>
<div class="section">
<h1>COPYRIGHT AND LICENSE</h1> This software is copyright (c) 2011 by Infinity Interactive, Inc..<div class="spacer">
</div>
This is free software; you can redistribute it and/or modify it under the same terms as the Perl 5 programming language system itself.</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-11-17</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

