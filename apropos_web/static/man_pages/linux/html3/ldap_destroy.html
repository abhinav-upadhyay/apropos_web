<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
LDAP_OPEN(3)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
LDAP_OPEN(3)</td>
<td class="head-vol">
Library Functions Manual</td>
<td class="head-rtitle">
LDAP_OPEN(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> ldap_dup, ldap_destroy, - Duplicate and destroy LDAP session handles</div>
<div class="section">
<h1>LIBRARY</h1> OpenLDAP LDAP (libldap, -lldap)</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
#include &lt;ldap.h&gt;<div class="spacer">
</div>
<br/>
LDAP *ldap_dup(<div style="margin-left: 5.00ex;">
<br/>
LDAP *<i>old</i><b> );</b></div>
<div class="spacer">
</div>
<br/>
int ldap_destroy(<div style="margin-left: 5.00ex;">
<br/>
LDAP *<i>old</i><b> );</b></div>
</div>
<div class="section">
<h1>DESCRIPTION</h1> <b>ldap_dup()</b> duplicates an existing LDAP (<b>LDAP *</b>) session handle. The new session handle may be used concurrently with the original session handle. In a threaded environment, different threads may execute concurrent requests on the same connection/session without fear of contamination. Each session handle manages its own private error results.<div class="spacer">
</div>
<b>ldap_destroy()</b> destroys an existing session handle.<div class="spacer">
</div>
The <b>ldap_dup()</b> and <b>ldap_destroy()</b> functions are used in conjunction with a &quot;thread safe&quot; version of <b>libldap</b> (<b>libldap_r</b>) to enable operation thread safe API calls, so that a single session may be simultaneously used across multiple threads with consistent error handling.<div class="spacer">
</div>
When a session is created through the use of one of the session creation functions including <b>ldap_open</b>(3), <b>ldap_init</b>(3), <b>ldap_initialize</b>(3) or <b>ldap_init_fd</b>(3) an <b>LDAP *</b> session handle is returned to the application. The session handle may be shared amongst threads, however the error codes are unique to a session handle. Multiple threads performing different operations using the same session handle will result in inconsistent error codes and return values.<div class="spacer">
</div>
To prevent this confusion, <b>ldap_dup()</b> is used duplicate an existing session handle so that multiple threads can share the session, and maintain consistent error information and results.<div class="spacer">
</div>
The message queues for a session are shared between sibling session handles. Results of operations on a sibling session handles are accessible to all the sibling session handles. Applications desiring results associated with a specific operation should provide the appropriate msgid to <b>ldap_result()</b>. Applications should avoid calling <b>ldap_result()</b> with <b>LDAP_RES_ANY</b> as that may &quot;steal&quot; and return results in the calling thread that another operation in a different thread, using a different session handle, may require to complete.<div class="spacer">
</div>
When <b>ldap_unbind()</b> is called on a session handle with siblings, all the siblings become invalid.<div class="spacer">
</div>
Siblings must be destroyed using <b>ldap_destroy()</b>. Session handle resources associated with the original (<b>LDAP *</b>) will be freed when the last session handle is destroyed or when <b>ldap_unbind()</b> is called, if no other session handles currently exist.</div>
<div class="section">
<h1>ERRORS</h1> If an error occurs, <b>ldap_dup()</b> will return NULL and <i>errno</i> should be set appropriately. <b>ldap_destroy()</b> will directly return the LDAP code associated to the error (or <i>LDAP_SUCCESS</i> in case of success); <i>errno</i> should be set as well whenever appropriate.</div>
<div class="section">
<h1>SEE ALSO</h1> <b>ldap_open</b>(3), <b>ldap_init</b>(3), <b>ldap_initialize</b>(3), <b>ldap_init_fd</b>(3), <b>errno</b>(3)</div>
<div class="section">
<h1>ACKNOWLEDGEMENTS</h1> This work is based on the previously proposed <b>LDAP C API Concurrency Extensions</b> draft <b>(</b>draft-zeilenga-ldap-c-api-concurrency-00.txt<b>)</b> effort. <b>OpenLDAP Software</b> is developed and maintained by The OpenLDAP Project &lt;http://www.openldap.org/&gt;. <b>OpenLDAP Software</b> is derived from University of Michigan LDAP 3.3 Release.</div>
<table class="foot">
<tr>
<td class="foot-date">
2011/11/24</td>
<td class="foot-os">
OpenLDAP </td>
</tr>
</table>
</div>
</body>
</html>

