<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
Module::Build::Authoring(3perl)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
Module::Build::Authoring(3perl)</td>
<td class="head-vol">
Perl Programmers Reference Guide</td>
<td class="head-rtitle">
Module::Build::Authoring(3perl)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Module::Build::Authoring - Authoring Module::Build modules</div>
<div class="section">
<h1>DESCRIPTION</h1> When creating a &quot;Build.PL&quot; script for a module, something like the following code will typically be used:<div class="spacer">
</div>
<br/>
  use Module::Build;<br/>
  my $build = Module::Build-&gt;new<br/>
    (<br/>
     module_name =&gt; 'Foo::Bar',<br/>
     license  =&gt; 'perl',<br/>
     requires =&gt; {<br/>
                  'perl'          =&gt; '5.6.1',<br/>
                  'Some::Module'  =&gt; '1.23',<br/>
                  'Other::Module' =&gt; '&gt;= 1.2, != 1.5, &lt; 2.0',<br/>
                 },<br/>
    );<br/>
  $build-&gt;create_build_script;<br/>
<div class="spacer">
</div>
A simple module could get away with something as short as this for its &quot;Build.PL&quot; script:<div class="spacer">
</div>
<br/>
  use Module::Build;<br/>
  Module::Build-&gt;new(<br/>
    module_name =&gt; 'Foo::Bar',<br/>
    license     =&gt; 'perl',<br/>
  )-&gt;create_build_script;<br/>
<div class="spacer">
</div>
The model used by &quot;Module::Build&quot; is a lot like the &quot;MakeMaker&quot; metaphor, with the following correspondences:<div class="spacer">
</div>
<br/>
   In Module::Build                 In ExtUtils::MakeMaker<br/>
  ---------------------------      ------------------------<br/>
   Build.PL (initial script)        Makefile.PL (initial script)<br/>
   Build (a short perl script)      Makefile (a long Makefile)<br/>
   _build/ (saved state info)       various config text in the Makefile<br/>
<div class="spacer">
</div>
Any customization can be done simply by subclassing &quot;Module::Build&quot; and adding a method called (for example) &quot;ACTION_test&quot;, overriding the default 'test' action.  You could also add a method called &quot;ACTION_whatever&quot;, and then you could perform the action &quot;Build whatever&quot;.<div class="spacer">
</div>
For information on providing compatibility with &quot;ExtUtils::MakeMaker&quot;, see Module::Build::Compat and &lt;http://www.makemaker.org/wiki/index.cgi?ModuleBuildConversionGuide&gt;.</div>
<div class="section">
<h1>STRUCTURE</h1> Module::Build creates a class hierarchy conducive to customization. Here is the parent-child class hierarchy in classy ASCII art:<div class="spacer">
</div>
<br/>
   /--------------------\<br/>
   |   Your::Parent     |  (If you subclass Module::Build)<br/>
   \--------------------/<br/>
            |<br/>
            |<br/>
   /--------------------\  (Doesn't define any functionality<br/>
   |   Module::Build    |   of its own - just figures out what<br/>
   \--------------------/   other modules to load.)<br/>
            |<br/>
            |<br/>
   /-----------------------------------\  (Some values of $^O may<br/>
   |   Module::Build::Platform::$^O    |   define specialized functionality.<br/>
   \-----------------------------------/   Otherwise it's ...::Default, a<br/>
            |                              pass-through class.)<br/>
            |<br/>
   /--------------------------\<br/>
   |   Module::Build::Base    |  (Most of the functionality of <br/>
   \--------------------------/   Module::Build is defined here.)<br/>
</div>
<div class="section">
<h1>SUBCLASSING</h1> Right now, there are two ways to subclass Module::Build.  The first way is to create a regular module (in a &quot;.pm&quot; file) that inherits from Module::Build, and use that module's class instead of using Module::Build directly:<div class="spacer">
</div>
<br/>
  ------ in Build.PL: ----------<br/>
  #!/usr/bin/perl<br/>
<br/>
  use lib q(/nonstandard/library/path);<br/>
  use My::Builder;  # Or whatever you want to call it<br/>
<br/>
  my $build = My::Builder-&gt;new<br/>
    (<br/>
     module_name =&gt; 'Foo::Bar',  # All the regular args...<br/>
     license     =&gt; 'perl',<br/>
     dist_author =&gt; 'A N Other &lt;me@here.net.au&gt;',<br/>
     requires    =&gt; { Carp =&gt; 0 }<br/>
    );<br/>
  $build-&gt;create_build_script;<br/>
<div class="spacer">
</div>
This is relatively straightforward, and is the best way to do things if your My::Builder class contains lots of code.  The &quot;create_build_script()&quot; method will ensure that the current value of @INC (including the &quot;/nonstandard/library/path&quot;) is propagated to the Build script, so that My::Builder can be found when running build actions.  If you find that you need to &quot;chdir&quot; into a different directories in your subclass methods or actions, be sure to always return to the original directory (available via the &quot;base_dir()&quot; method) before returning control to the parent class.  This is important to avoid data serialization problems.<div class="spacer">
</div>
For very small additions, Module::Build provides a &quot;subclass()&quot; method that lets you subclass Module::Build more conveniently, without creating a separate file for your module:<div class="spacer">
</div>
<br/>
  ------ in Build.PL: ----------<br/>
  #!/usr/bin/perl<br/>
<br/>
  use Module::Build;<br/>
  my $class = Module::Build-&gt;subclass<br/>
    (<br/>
     class =&gt; 'My::Builder',<br/>
     code =&gt; q{<br/>
       sub ACTION_foo {<br/>
         print &quot;I'm fooing to death!\n&quot;;<br/>
       }<br/>
     },<br/>
    );<br/>
<br/>
  my $build = $class-&gt;new<br/>
    (<br/>
     module_name =&gt; 'Foo::Bar',  # All the regular args...<br/>
     license     =&gt; 'perl',<br/>
     dist_author =&gt; 'A N Other &lt;me@here.net.au&gt;',<br/>
     requires    =&gt; { Carp =&gt; 0 }<br/>
    );<br/>
  $build-&gt;create_build_script;<br/>
<div class="spacer">
</div>
Behind the scenes, this actually does create a &quot;.pm&quot; file, since the code you provide must persist after Build.PL is run if it is to be very useful.<div class="spacer">
</div>
See also the documentation for the &quot;<i>subclass()</i>&quot; in Module::Build::API method.</div>
<div class="section">
<h1>PREREQUISITES</h1><div class="subsection">
<h2>Types of prerequisites</h2> To specify what versions of other modules are used by this distribution, several types of prerequisites can be defined with the following parameters:<dl>
<dt>
configure_requires</dt>
<dd>
Items that must be installed <i>before</i> configuring this distribution (i.e. before running the  <i>Build.PL</i> script).  This might be a specific minimum version of &quot;Module::Build&quot; or any other module the  <i>Build.PL</i> needs in order to do its stuff.  Clients like &quot;CPAN.pm&quot; or &quot;CPANPLUS&quot; will be expected to pick &quot;configure_requires&quot; out of the  <i>META.yml</i> file and install these items before running the &quot;Build.PL&quot;.<div style="height: 1.00em;">
&#160;</div>
If no configure_requires is specified, the current version of Module::Build is automatically added to configure_requires.</dd>
</dl>
<dl>
<dt>
build_requires</dt>
<dd>
Items that are necessary for building and testing this distribution, but aren't necessary after installation.  This can help users who only want to install these items temporarily.  It also helps reduce the size of the CPAN dependency graph if everything isn't smooshed into &quot;requires&quot;.</dd>
</dl>
<dl>
<dt>
requires</dt>
<dd>
Items that are necessary for basic functioning.</dd>
</dl>
<dl>
<dt>
recommends</dt>
<dd>
Items that are recommended for enhanced functionality, but there are ways to use this distribution without having them installed.  You might also think of this as &quot;can use&quot; or &quot;is aware of&quot; or &quot;changes behavior in the presence of&quot;.</dd>
</dl>
<dl>
<dt>
conflicts</dt>
<dd>
Items that can cause problems with this distribution when installed. This is pretty rare.</dd>
</dl>
</div>
<div class="subsection">
<h2>Format of prerequisites</h2> The prerequisites are given in a hash reference, where the keys are the module names and the values are version specifiers:<div class="spacer">
</div>
<br/>
  requires =&gt; {<br/>
               Foo::Module =&gt; '2.4',<br/>
               Bar::Module =&gt; 0,<br/>
               Ken::Module =&gt; '&gt;= 1.2, != 1.5, &lt; 2.0',<br/>
               perl =&gt; '5.6.0'<br/>
              },<br/>
<div class="spacer">
</div>
The above four version specifiers have different effects.  The value '2.4' means that  <b>at least</b> version 2.4 of &quot;Foo::Module&quot; must be installed.  The value 0 means that  <b>any</b> version of &quot;Bar::Module&quot; is acceptable, even if &quot;Bar::Module&quot; doesn't define a version.  The more verbose value '&gt;= 1.2, != 1.5, &lt; 2.0' means that &quot;Ken::Module&quot;'s version must be  <b>at least</b> 1.2, <b>less than</b> 2.0, and  <b>not equal to</b> 1.5.  The list of criteria is separated by commas, and all criteria must be satisfied.<div class="spacer">
</div>
A special &quot;perl&quot; entry lets you specify the versions of the Perl interpreter that are supported by your module.  The same version dependency-checking semantics are available, except that we also understand perl's new double-dotted version numbers.</div>
<div class="subsection">
<h2>XS Extensions</h2> Modules which need to compile XS code should list &quot;ExtUtils::CBuilder&quot; as a &quot;build_requires&quot; element.</div>
</div>
<div class="section">
<h1>SAVING CONFIGURATION INFORMATION</h1> Module::Build provides a very convenient way to save configuration information that your installed modules (or your regression tests) can access.  If your Build process calls the &quot;feature()&quot; or &quot;config_data()&quot; methods, then a &quot;Foo::Bar::ConfigData&quot; module will automatically be created for you, where &quot;Foo::Bar&quot; is the &quot;module_name&quot; parameter as passed to &quot;new()&quot;.  This module provides access to the data saved by these methods, and a way to update the values.  There is also a utility script called &quot;config_data&quot; distributed with Module::Build that provides a command line interface to this same functionality.  See also the generated &quot;Foo::Bar::ConfigData&quot; documentation, and the &quot;config_data&quot; script's documentation, for more information.</div>
<div class="section">
<h1>STARTING MODULE DEVELOPMENT</h1> When starting development on a new module, it's rarely worth your time to create a tree of all the files by hand.  Some automatic module-creators are available: the oldest is &quot;h2xs&quot;, which has shipped with perl itself for a long time.  Its name reflects the fact that modules were originally conceived of as a way to wrap up a C library (thus the &quot;h&quot; part) into perl extensions (thus the &quot;xs&quot; part).<div class="spacer">
</div>
These days, &quot;h2xs&quot; has largely been superseded by modules like &quot;ExtUtils::ModuleMaker&quot;, and &quot;Module::Starter&quot;.  They have varying degrees of support for &quot;Module::Build&quot;.</div>
<div class="section">
<h1>AUTOMATION</h1> One advantage of Module::Build is that since it's implemented as Perl methods, you can invoke these methods directly if you want to install a module non-interactively.  For instance, the following Perl script will invoke the entire build/install procedure:<div class="spacer">
</div>
<br/>
  my $build = Module::Build-&gt;new(module_name =&gt; 'MyModule');<br/>
  $build-&gt;dispatch('build');<br/>
  $build-&gt;dispatch('test');<br/>
  $build-&gt;dispatch('install');<br/>
<div class="spacer">
</div>
If any of these steps encounters an error, it will throw a fatal exception.<div class="spacer">
</div>
You can also pass arguments as part of the build process:<div class="spacer">
</div>
<br/>
  my $build = Module::Build-&gt;new(module_name =&gt; 'MyModule');<br/>
  $build-&gt;dispatch('build');<br/>
  $build-&gt;dispatch('test', verbose =&gt; 1);<br/>
  $build-&gt;dispatch('install', sitelib =&gt; '/my/secret/place/');<br/>
<div class="spacer">
</div>
Building and installing modules in this way skips creating the &quot;Build&quot; script.</div>
<div class="section">
<h1>MIGRATION</h1> Note that if you want to provide both a  <i>Makefile.PL</i> and a  <i>Build.PL</i> for your distribution, you probably want to add the following to &quot;WriteMakefile&quot; in your  <i>Makefile.PL</i> so that &quot;MakeMaker&quot; doesn't try to run your  <i>Build.PL</i> as a normal <i>.PL</i> file:<div class="spacer">
</div>
<br/>
  PL_FILES =&gt; {},<br/>
<div class="spacer">
</div>
You may also be interested in looking at the &quot;Module::Build::Compat&quot; module, which can automatically create various kinds of  <i>Makefile.PL</i> compatibility layers.</div>
<div class="section">
<h1>AUTHOR</h1> Ken Williams &lt;kwilliams@cpan.org&gt;<div class="spacer">
</div>
Development questions, bug reports, and patches should be sent to the Module-Build mailing list at &lt;module-build@perl.org&gt;.<div class="spacer">
</div>
Bug reports are also welcome at &lt;http://rt.cpan.org/NoAuth/Bugs.html?Dist=Module-Build&gt;.<div class="spacer">
</div>
The latest development version is available from the Git repository at &lt;https://github.com/dagolden/module-build/&gt;</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>perl</i>(1), Module::Build(3), Module::Build::API(3), Module::Build::Cookbook(3), ExtUtils::MakeMaker(3), YAML(3)<div class="spacer">
</div>
<i>META.yml</i> Specification: CPAN::META::Spec<div class="spacer">
</div>
&lt;http://www.dsmit.com/cons/&gt;<div class="spacer">
</div>
&lt;http://search.cpan.org/dist/PerlBuildSystem/&gt;</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-09-19</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

