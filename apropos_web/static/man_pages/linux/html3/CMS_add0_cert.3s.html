<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
CMS_add0_cert(3SSL)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
CMS_add0_cert(3SSL)</td>
<td class="head-vol">
OpenSSL</td>
<td class="head-rtitle">
CMS_add0_cert(3SSL)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1><br/>
 CMS_add0_cert, CMS_add1_cert, CMS_get1_certs, CMS_add0_crl, CMS_get1_crls, - CMS certificate and CRL utility functions<br/>
</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
 #include &lt;openssl/cms.h&gt;<br/>
<br/>
 int CMS_add0_cert(CMS_ContentInfo *cms, X509 *cert);<br/>
 int CMS_add1_cert(CMS_ContentInfo *cms, X509 *cert);<br/>
 STACK_OF(X509) *CMS_get1_certs(CMS_ContentInfo *cms);<br/>
<br/>
 int CMS_add0_crl(CMS_ContentInfo *cms, X509_CRL *crl);<br/>
 int CMS_add1_crl(CMS_ContentInfo *cms, X509_CRL *crl);<br/>
 STACK_OF(X509_CRL) *CMS_get1_crls(CMS_ContentInfo *cms);<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1>  <i>CMS_add0_cert()</i> and <i>CMS_add1_cert()</i> add certificate <b>cert</b> to <b>cms</b>. must be of type signed data or enveloped data.<div class="spacer">
</div>
<i>CMS_get1_certs()</i> returns all certificates in <b>cms</b>.<div class="spacer">
</div>
<i>CMS_add0_crl()</i> and <i>CMS_add1_crl()</i> add CRL <b>crl</b> to <b>cms</b>. <i>CMS_get1_crls()</i> returns any CRLs in  <b>cms</b>.</div>
<div class="section">
<h1>NOTES</h1> The CMS_ContentInfo structure  <b>cms</b> must be of type signed data or enveloped data or an error will be returned.<div class="spacer">
</div>
For signed data certificates and CRLs are added to the <b>certificates</b> and  <b>crls</b> fields of SignedData structure. For enveloped data they are added to  <b>OriginatorInfo</b>.<div class="spacer">
</div>
As the <b>0</b> implies <i>CMS_add0_cert()</i> adds <b>cert</b> internally to <b>cms</b> and it must not be freed up after the call as opposed to  <i>CMS_add1_cert()</i> where <b>cert</b> must be freed up.<div class="spacer">
</div>
The same certificate or CRL must not be added to the same cms structure more than once.</div>
<div class="section">
<h1>RETURN VALUES</h1>  <i>CMS_add0_cert()</i>, <i>CMS_add1_cert()</i> and <i>CMS_add0_crl()</i> and <i>CMS_add1_crl()</i> return 1 for success and 0 for failure.<div class="spacer">
</div>
<i>CMS_get1_certs()</i> and <i>CMS_get1_crls()</i> return the STACK of certificates or CRLs or NULL if there are none or an error occurs. The only error which will occur in practice is if the  <b>cms</b> type is invalid.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>ERR_get_error</i>(3),  <i>CMS_sign</i>(3),  <i>CMS_encrypt</i>(3)</div>
<div class="section">
<h1>HISTORY</h1>  <i>CMS_add0_cert()</i>, <i>CMS_add1_cert()</i>, <i>CMS_get1_certs()</i>, <i>CMS_add0_crl()</i> and  <i>CMS_get1_crls()</i> were all first added to OpenSSL 0.9.8</div>
<table class="foot">
<tr>
<td class="foot-date">
2008-05-02</td>
<td class="foot-os">
1.0.1</td>
</tr>
</table>
</div>
</body>
</html>

