<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
File::MimeInfo::Cookbook(3pm)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
File::MimeInfo::Cookbook(3pm)</td>
<td class="head-vol">
User Contributed Perl Documentation</td>
<td class="head-rtitle">
File::MimeInfo::Cookbook(3pm)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> File::MimeInfo::Cookbook - various code snippets</div>
<div class="section">
<h1>DESCRIPTION</h1> Some code snippets for non-basic uses of the File::MimeInfo module:<dl>
<dt>
<b>Matching an extension</b></dt>
<dd>
A file does not have to actually exist in order to get a mimetype for it. This means that the following will work:<div style="height: 1.00em;">
&#160;</div>
<br/>
  my $extension = '*.txt';<br/>
  my $mimetype = mimetype( $extension );<br/>
</dd>
</dl>
<dl>
<dt>
<b>Mimetyping an scalar</b></dt>
<dd>
If you want to find the mimetype of a scalar value you need magic mimetyping; after all a scalar doesn't have a filename or inode. What you need to do is to use IO::Scalar :<div style="height: 1.00em;">
&#160;</div>
<br/>
  use File::MimeInfo::Magic;<br/>
  use IO::Scalar;<br/>
  <br/>
  my $io_scalar = new IO::Scalar \$data;<br/>
  my $mimetype = mimetype( $io_scalar );<br/>
<div style="height: 1.00em;">
&#160;</div>
In fact most other &quot;IO::&quot; will work as long as they support the &quot;seek()&quot; and &quot;read()&quot; methods. Of course if you want really obscure things to happen you can always write your own IO object and feed it in there.<div style="height: 1.00em;">
&#160;</div>
Be aware that when using a filehandle like this you need to set the &quot;:utf8&quot; binmode yourself if apropriate.</dd>
</dl>
<dl>
<dt>
<b>Mimetyping a filehandle</b></dt>
<dd>
Regrettably for non-seekable filehandles like STDIN simply using an &quot;IO::&quot; object will not work. You will need to buffer enough of the data for a proper mimetyping. For example you could mimetype data from STDIN like this:<div style="height: 1.00em;">
&#160;</div>
<br/>
  use File::MimeInfo::Magic;<br/>
  use IO::Scalar;<br/>
<br/>
  my $data;<br/>
  read(STDIN, $data, $File::MimeInfo::Magic::max_buffer);<br/>
  my $io_scalar = new IO::Scalar \$data;<br/>
  my $mimetype = mimetype( $io_scalar );<br/>
<div style="height: 1.00em;">
&#160;</div>
Be aware that when using a filehandle like this you need to set the &quot;:utf8&quot; binmode yourself if apropriate.</dd>
</dl>
<dl>
<dt>
<b>Creating a new filename</b></dt>
<dd>
Say you have a temporary file that you want to save with a more proper filename.<div style="height: 1.00em;">
&#160;</div>
<br/>
  use File::MimeInfo::Magic qw#mimetype extensions#;<br/>
  use File::Copy;<br/>
  <br/>
  my $tmpfile = '/tmp/foo';<br/>
  my $mimetype = mimetype($tmpfile);<br/>
  my $extension = extensions($mimetype);<br/>
  my $newfile = 'untitled1';<br/>
  $newfile .= '.'.$extension if length $extension;<br/>
  move($tmpfile, $newfile);<br/>
</dd>
</dl>
<dl>
<dt>
<b>Force the use of a certain database directory</b></dt>
<dd>
Normally you just need to add the dir where your mime database lives to either the XDG_DATA_HOME or XDG_DATA_DIRS environment variables for it to be found. But in some rare cases you may want to by-pass this system all together. Try one of the following:<div style="height: 1.00em;">
&#160;</div>
<br/>
  @File::MimeInfo::DIRS = ('/home/me/share/mime');<br/>
  eval 'use File::MimeInfo';<br/>
  die if $@;<br/>
<div style="height: 1.00em;">
&#160;</div>
or:<div style="height: 1.00em;">
&#160;</div>
<br/>
  use File::MimeInfo;<br/>
  @File::MimeInfo::DIRS = ('/home/me/share/mime');<br/>
  File::MimeInfo-&gt;rehash();<br/>
<div style="height: 1.00em;">
&#160;</div>
This can also be used for switching between databases at run time while leaving other XDG configuration stuff alone.</dd>
</dl>
</div>
<div class="section">
<h1>AUTHOR</h1> Jaap Karssenberg (Pardus) &lt;pardus@cpan.org&gt;<div class="spacer">
</div>
Copyright (c) 2005,2008 Jaap G Karssenberg. All rights reserved. This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</div>
<div class="section">
<h1>SEE ALSO</h1> File::MimeInfo</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-10-17</td>
<td class="foot-os">
perl v5.12.4</td>
</tr>
</table>
</div>
</body>
</html>

