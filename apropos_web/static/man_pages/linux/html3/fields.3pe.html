<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
fields(3perl)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
fields(3perl)</td>
<td class="head-vol">
Perl Programmers Reference Guide</td>
<td class="head-rtitle">
fields(3perl)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> fields - compile-time class fields</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
    {<br/>
        package Foo;<br/>
        use fields qw(foo bar _Foo_private);<br/>
        sub new {<br/>
            my Foo $self = shift;<br/>
            unless (ref $self) {<br/>
                $self = fields::new($self);<br/>
                $self-&gt;{_Foo_private} = &quot;this is Foo's secret&quot;;<br/>
            }<br/>
            $self-&gt;{foo} = 10;<br/>
            $self-&gt;{bar} = 20;<br/>
            return $self;<br/>
        }<br/>
    }<br/>
<br/>
    my $var = Foo-&gt;new;<br/>
    $var-&gt;{foo} = 42;<br/>
<br/>
    # this will generate an error<br/>
    $var-&gt;{zap} = 42;<br/>
<br/>
    # subclassing<br/>
    {<br/>
        package Bar;<br/>
        use base 'Foo';<br/>
        use fields qw(baz _Bar_private);        # not shared with Foo<br/>
        sub new {<br/>
            my $class = shift;<br/>
            my $self = fields::new($class);<br/>
            $self-&gt;SUPER::new();                # init base fields<br/>
            $self-&gt;{baz} = 10;                  # init own fields<br/>
            $self-&gt;{_Bar_private} = &quot;this is Bar's secret&quot;;<br/>
            return $self;<br/>
        }<br/>
    }<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> The &quot;fields&quot; pragma enables compile-time verified class fields.<div class="spacer">
</div>
NOTE: The current implementation keeps the declared fields in the %FIELDS hash of the calling package, but this may change in future versions. Do  <b>not</b> update the %FIELDS hash directly, because it must be created at compile-time for it to be fully useful, as is done by this pragma.<div class="spacer">
</div>
<b>Only valid for perl before 5.9.0:</b><div class="spacer">
</div>
If a typed lexical variable holding a reference is used to access a hash element and a package with the same name as the type has declared class fields using this pragma, then the operation is turned into an array access at compile time.<div class="spacer">
</div>
The related &quot;base&quot; pragma will combine fields from base classes and any fields declared using the &quot;fields&quot; pragma.  This enables field inheritance to work properly.<div class="spacer">
</div>
Field names that start with an underscore character are made private to the class and are not visible to subclasses.  Inherited fields can be overridden but will generate a warning if used together with the &quot;-w&quot; switch.<div class="spacer">
</div>
<b>Only valid for perls before 5.9.0:</b><div class="spacer">
</div>
The effect of all this is that you can have objects with named fields which are as compact and as fast arrays to access. This only works as long as the objects are accessed through properly typed variables. If the objects are not typed, access is only checked at run time.<div class="spacer">
</div>
The following functions are supported:<dl>
<dt>
new</dt>
<dd>
<b> perl before 5.9.0: </b> <i>fields::new()</i> creates and blesses a pseudo-hash comprised of the fields declared using the &quot;fields&quot; pragma into the specified class.<div style="height: 1.00em;">
&#160;</div>
<b> perl 5.9.0 and higher: </b> <i>fields::new()</i> creates and blesses a restricted-hash comprised of the fields declared using the &quot;fields&quot; pragma into the specified class.<div style="height: 1.00em;">
&#160;</div>
This function is usable with or without pseudo-hashes.  It is the recommended way to construct a fields-based object.<div style="height: 1.00em;">
&#160;</div>
This makes it possible to write a constructor like this:<div style="height: 1.00em;">
&#160;</div>
<br/>
    package Critter::Sounds;<br/>
    use fields qw(cat dog bird);<br/>
<br/>
    sub new {<br/>
        my $self = shift;<br/>
        $self = fields::new($self) unless ref $self;<br/>
        $self-&gt;{cat} = 'meow';                          # scalar element<br/>
        @$self{'dog','bird'} = ('bark','tweet');        # slice<br/>
        return $self;<br/>
    }<br/>
</dd>
</dl>
<dl>
<dt>
phash</dt>
<dd>
<b> before perl 5.9.0: </b><div style="height: 1.00em;">
&#160;</div>
<i>fields::phash()</i> can be used to create and initialize a plain (unblessed) pseudo-hash.  This function should always be used instead of creating pseudo-hashes directly.<div style="height: 1.00em;">
&#160;</div>
If the first argument is a reference to an array, the pseudo-hash will be created with keys from that array.  If a second argument is supplied, it must also be a reference to an array whose elements will be used as the values.  If the second array contains less elements than the first, the trailing elements of the pseudo-hash will not be initialized. This makes it particularly useful for creating a pseudo-hash from subroutine arguments:<div style="height: 1.00em;">
&#160;</div>
<br/>
    sub dogtag {<br/>
       my $tag = fields::phash([qw(name rank ser_num)], [@_]);<br/>
    }<br/>
<div style="height: 1.00em;">
&#160;</div>
<i>fields::phash()</i> also accepts a list of key-value pairs that will be used to construct the pseudo hash.  Examples:<div style="height: 1.00em;">
&#160;</div>
<br/>
    my $tag = fields::phash(name =&gt; &quot;Joe&quot;,<br/>
                            rank =&gt; &quot;captain&quot;,<br/>
                            ser_num =&gt; 42);<br/>
<br/>
    my $pseudohash = fields::phash(%args);<br/>
<div style="height: 1.00em;">
&#160;</div>
<b> perl 5.9.0 and higher: </b><div style="height: 1.00em;">
&#160;</div>
Pseudo-hashes have been removed from Perl as of 5.10.  Consider using restricted hashes or  <i>fields::new()</i> instead.  Using <i>fields::phash()</i> will cause an error.</dd>
</dl>
</div>
<div class="section">
<h1>SEE ALSO</h1> base</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-09-26</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

