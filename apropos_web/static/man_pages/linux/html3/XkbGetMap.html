<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
XkbGetMap(3)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
XkbGetMap(3)</td>
<td class="head-vol">
XKB FUNCTIONS</td>
<td class="head-rtitle">
XkbGetMap(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> XkbGetMap - Allocate an XkbDescRec structure and populate it with the server's keyboard client map and server map</div>
<div class="section">
<h1>SYNOPSIS</h1><div style="margin-left: 5.00ex;text-indent: -5.00ex;" class="spacer">
<b>XkbDescPtr XkbGetMap</b> <b>(Display *</b><i>display</i><b>,</b> <b>unsigned int </b><i>which</i><b>,</b> <b>unsigned int </b><i>device_spec</i><b>);</b></div>
</div>
<div class="section">
<h1>ARGUMENTS</h1><dl>
<dt>
<i>- display</i></dt>
<dd>
connection to X server</dd>
</dl>
<dl>
<dt>
<i>- which</i></dt>
<dd>
mask selecting subcomponents to populate</dd>
</dl>
<dl>
<dt>
<i>- device_spec</i></dt>
<dd>
device_id, or XkbUseCoreKbd</dd>
</dl>
</div>
<div class="section">
<h1>DESCRIPTION</h1> Xkb provides two functions to obtain the keyboard mapping components from the server. The first function, <i>XkbGetMap,</i> allocates an XkbDescRec structure, retrieves mapping components from the server, and stores them in the XkbDescRec structure it just allocated. The second function, <i>XkbGetUpdatedMap,</i> retrieves mapping components from the server and stores them in an XkbDescRec structure that has previously been allocated.<div style="height: 1.00em;">
&#160;</div>
To allocate an XkbDescRec structure and populate it with the server's keyboard client map and server map, use <i>XkbGetMap. XkbGetMap</i> is similar to <i>XkbGetKeyboard,</i> but is used only for obtaining the address of an XkbDescRec structure that is populated with keyboard mapping components. It allows finer control over which substructures of the keyboard mapping components are to be populated. <i>XkbGetKeyboard</i> always returns fully populated components, while <i>XkbGetMap</i> can be instructed to return a partially populated component.<div style="height: 1.00em;">
&#160;</div>
The <i>which mask is a bitwise inclusive OR of the masks defined in Table 14.1. Only</i> those portions of the keyboard server map and the keyboard client maps that are specified in <i>which</i> are allocated and populated.<div style="height: 1.00em;">
&#160;</div>
In addition to allocating and obtaining the server map and the client map, <i>XkbGetMap</i> also sets the <i>device_spec,</i> the <i>min_key_code,</i> and <i>max_key_code</i> fields of the keyboard description.<div style="height: 1.00em;">
&#160;</div>
<i>XkbGetMap</i> is synchronous; it queries the server for the desired information, waits for a reply, and then returns. If successful, <i>XkbGetMap</i> returns a pointer to the XkbDescRec structure it allocated. If unsuccessful, <i>XkbGetMap</i> returns NULL. When unsuccessful, one of the following protocol errors is also generated: BadAlloc (unable to allocate the XkbDescRec structure), BadValue (some mask bits in <i>which</i> are undefined), or BadImplementation (a compatible version of the Xkb extension is not available in the server). To free the returned data, use <i>XkbFreeClientMap.</i><div style="height: 1.00em;">
&#160;</div>
Xkb also provides convenience functions to get partial component definitions from the server. These functions are specified in the &quot;convenience functions&quot; column in Table 1. Refer to the sections listed in the table for more information on these functions.<div style="height: 1.00em;">
&#160;</div>
<table class="tbl">
<col style="width: 25.00ex;"/>
<col style="width: 65.00ex;"/>
<col style="width: 3.00ex;"/>
<col style="width: 6.00ex;"/>
<col style="width: 11.00ex;"/>
<tbody>
<tr>
<td>
Table 1 Xkb Mapping Component Masks</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
and Convenience Functions</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="0">
</td>
</tr>
<tr>
<td>
Mask</td>
<td>
Value</td>
<td>
Map</td>
<td>
Fields</td>
<td>
Convenience</td>
</tr>
<tr>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
Functions</td>
</tr>
<tr>
<td colspan="0">
</td>
</tr>
<tr>
<td>
XkbKeyTypesMask</td>
<td>
(1&lt;&lt;0)</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
types</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
size_types</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
num_types</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
T}</td>
<td>
XkbGetKeyTypes  XkbResizeKeyType  XkbCopyKeyType  XkbCopyKeyTypes</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
XkbKeySymsMask</td>
<td>
(1&lt;&lt;1)</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
syms</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
size_syms</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
num_syms</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
key_sym_map</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
T}</td>
<td>
XkbGetKeySyms  XkbResizeKeySyms  XkbChangeTypesOfKey</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
XkbModifierMapMask</td>
<td>
(1&lt;&lt;2)</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
XkbGetKeyModifierMap</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
T}</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
XkbExplicitComponentsMask</td>
<td>
(1&lt;&lt;3)</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
explicit</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
T}</td>
<td>
XkbGetKeyExplicitComponents</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
XkbKeyActionsMask</td>
<td>
(1&lt;&lt;4)</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
key_acts</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
acts</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
num_acts</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
size_acts</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
T}</td>
<td>
XkbGetKeyActions  XkbResizeKeyActions</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
XkbKeyBehaviorsMask</td>
<td>
(1&lt;&lt;5)</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
behaviors</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
T}</td>
<td>
XkbGetKeyBehaviors</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
XkbVirtualModsMask</td>
<td>
(1&lt;&lt;6)</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
vmods</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
T}</td>
<td>
XkbGetVirtualMods</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
XkbVirtualModMapMask</td>
<td>
(1&lt;&lt;7)</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
vmodmap</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td>
T}</td>
<td>
XkbGetVirtualModMap</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
</tbody>
</table>
<div style="height: 1.00em;">
&#160;</div>
<br/>
Xkb defines combinations of these masks for convenience:<br/>
   <br/>
   #define XkbResizableInfoMask   (XkbKeyTypesMask)<br/>
   #define XkbAllClientInfoMask   (XkbKeyTypesMask | XkbKeySymsMask |<br/>
                                   XkbModifierMapMask)<br/>
   #define XkbAllServerInfoMask   (XkbExplicitComponentsMask |<br/>
                                   XkbKeyActionsMask | <br/>
                                   XkbKeyBehaviorsMask |<br/>
                                   XkbVirtualModsMask | <br/>
                                   XkbVirtualModMapMask)<br/>
   #define XkbAllMapComponentsMask XkbAllClientInfoMask | <br/>
                                   XkbAllServerInfoMask)<br/>
      <br/>
Key types, symbol maps, and actions are all interrelated: changes in one require changes in the others. The convenience functions make it easier to edit these components and handle the interdependencies.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>STRUCTURES</h1> The complete description of an Xkb keyboard is given by an XkbDescRec. The component structures in the XkbDescRec represent the major Xkb components.<div style="height: 1.00em;">
&#160;</div>
<br/>
typedef struct {<br/>
   struct _XDisplay * display;      /&#8727; connection to X server */<br/>
   unsigned short     flags;        /&#8727; private to Xkb, do not modify */<br/>
   unsigned short     device_spec;  /&#8727; device of interest */<br/>
   KeyCode            min_key_code; /&#8727; minimum keycode for device */<br/>
   KeyCode            max_key_code; /&#8727; maximum keycode for device */<br/>
   XkbControlsPtr     ctrls;        /&#8727; controls */<br/>
   XkbServerMapPtr    server;       /&#8727; server keymap */<br/>
   XkbClientMapPtr    map;          /&#8727; client keymap */<br/>
   XkbIndicatorPtr    indicators;   /&#8727; indicator map */<br/>
   XkbNamesPtr        names;        /&#8727; names for all components */<br/>
   XkbCompatMapPtr    compat;       /&#8727; compatibility map */<br/>
   XkbGeometryPtr     geom;         /&#8727; physical geometry of keyboard */<br/>
} XkbDescRec, *XkbDescPtr;<div class="spacer">
</div>
<br/>
The <i>display</i> field points to an X display structure. The <i>flags field is private to the library: modifying</i> <i>flags</i> may yield unpredictable results. The <i>device_spec</i> field specifies the device identifier of the keyboard input device, or XkbUseCoreKeyboard, which specifies the core keyboard device. The <i>min_key_code</i> and <i>max_key_code</i> fields specify the least and greatest keycode that can be returned by the keyboard.<div style="height: 1.00em;">
&#160;</div>
Each structure component has a corresponding mask bit that is used in function calls to indicate that the structure should be manipulated in some manner, such as allocating it or freeing it. These masks and their relationships to the fields in the XkbDescRec are shown in Table 2.<div style="height: 1.00em;">
&#160;</div>
<table class="tbl">
<col style="width: 20.00ex;"/>
<col style="width: 16.00ex;"/>
<col style="width: 7.00ex;"/>
<tbody>
<tr>
<td>
Table 2 Mask Bits for XkbDescRec</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="0">
</td>
</tr>
<tr>
<td>
Mask Bit</td>
<td>
XkbDescRec Field</td>
<td>
Value</td>
</tr>
<tr>
<td colspan="0">
</td>
</tr>
<tr>
<td>
XkbControlsMask</td>
<td>
ctrls</td>
<td>
(1L&lt;&lt;0)</td>
</tr>
<tr>
<td>
XkbServerMapMask</td>
<td>
server</td>
<td>
(1L&lt;&lt;1)</td>
</tr>
<tr>
<td>
XkbIClientMapMask</td>
<td>
map</td>
<td>
(1L&lt;&lt;2)</td>
</tr>
<tr>
<td>
XkbIndicatorMapMask</td>
<td>
indicators</td>
<td>
(1L&lt;&lt;3)</td>
</tr>
<tr>
<td>
XkbNamesMask</td>
<td>
names</td>
<td>
(1L&lt;&lt;4)</td>
</tr>
<tr>
<td>
XkbCompatMapMask</td>
<td>
compat</td>
<td>
(1L&lt;&lt;5)</td>
</tr>
<tr>
<td>
XkbGeometryMask</td>
<td>
geom</td>
<td>
(1L&lt;&lt;6)</td>
</tr>
<tr>
<td>
XkbAllComponentsMask</td>
<td>
All Fields</td>
<td>
(0x7f)</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1>SEE ALSO</h1> <b>XkbChangeTypesOfKey</b>(3), <b>XkbCopyKeyType</b>(3), <b>XkbCopyKeyTypes</b>(3), <b>XkbFreeClientMap</b>(3), <b>XkbGetKeyActions</b>(3), <b>XkbGetKeyBehaviors</b>(3), <b>XkbGetKeyboard</b>(3), <b>XkbGetKeyExplicitComponents</b>(3), <b>XkbGetKeyModifierMap</b>(3), <b>XkbGetKeySyms</b>(3), <b>XkbGetKeyTypes</b>(3), <b>XkbGetUpdatedMap</b>(3), <b>XkbGetVirtualModMap</b>(3), <b>XkbGetVirtualMods</b>(3), <b>XkbResizeKeyActions</b>(3), <b>XkbResizeKeySyms</b>(3), <b>XkbResizeKeyType</b>(3)<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<table class="foot">
<tr>
<td class="foot-date">
libX11 1.4.99.1</td>
<td class="foot-os">
X Version 11</td>
</tr>
</table>
</div>
</body>
</html>

