<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
FLOPEN(3)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">flopen</b> &#8212; <span class="desc">Reliably open and lock a file</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">library &#8220;libbsd&#8221;</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/fcntl.h</a>&gt;</b><br/>
<b class="includes">#include &lt;<a class="link-includes">bsd/libutil.h</a>&gt;</b><div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">flopen</b>(<i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">int flags</i>);<div class="spacer">
</div>
<i class="ftype">int</i><br/>
<b class="fname">flopen</b>(<i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">mode_t mode</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">flopen</b>() function opens or creates a file and acquires an exclusive lock on it. It is essentially equivalent with calling <b class="fname">open</b>() with the same parameters followed by <b class="fname">flock</b>() with an <b class="var">operation</b> argument of <span class="define">LOCK_EX</span>, except that <b class="fname">flopen</b>() will attempt to detect and handle races that may occur between opening / creating the file and locking it. Thus, it is well suited for opening lock files, PID files, spool files, mailboxes and other kinds of files which are used for synchronization between processes.<div class="spacer">
</div>
If <b class="var">flags</b> includes <span class="define">O_NONBLOCK</span> and the file is already locked, <b class="fname">flopen</b>() will fail and set <b class="var">errno</b> to <span class="define">EWOULDBLOCK</span>.<div class="spacer">
</div>
As with <b class="fname">open</b>(), the additional <b class="var">mode</b> argument is required if <b class="var">flags</b> includes <span class="define">O_CREAT</span>.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> If successful, <b class="fname">flopen</b>() returns a valid file descriptor. Otherwise, it returns -1, and sets <b class="var">errno</b> as described in <a class="link-man" href="/man/linux/2/flock">flock(2)</a> and <a class="link-man" href="/man/linux/2/open">open(2)</a>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="/man/linux/2/errno">errno(2)</a>, <a class="link-man" href="/man/linux/2/flock">flock(2)</a>, <a class="link-man" href="/man/linux/2/open">open(2)</a></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="name">flopen</b> function and this manual page were written by <span class="author">Dag-Erling Sm&#248;rgrav</span> &#10216;des@FreeBSD.org&#10217;.</div>
</div>
</body>
</html>

