<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
X509(3pm)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
X509(3pm)</td>
<td class="head-vol">
User Contributed Perl Documentation</td>
<td class="head-rtitle">
X509(3pm)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Crypt::OpenSSL::X509 - Perl extension to OpenSSL's X509 API.</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
  use Crypt::OpenSSL::X509;<br/>
<br/>
  my $x509 = Crypt::OpenSSL::X509-&gt;new_from_file('cert.pem');<br/>
<br/>
  print $x509-&gt;pubkey() . &quot;\n&quot;;<br/>
  print $x509-&gt;subject() . &quot;\n&quot;;<br/>
  print $x509-&gt;issuer() . &quot;\n&quot;;<br/>
  print $x509-&gt;email() . &quot;\n&quot;;<br/>
  print $x509-&gt;hash() . &quot;\n&quot;;<br/>
  print $x509-&gt;notBefore() . &quot;\n&quot;;<br/>
  print $x509-&gt;notAfter() . &quot;\n&quot;;<br/>
  print $x509-&gt;modulus() . &quot;\n&quot;;<br/>
  print $x509-&gt;exponent() . &quot;\n&quot;;<br/>
  print $x509-&gt;fingerprint_sha1() . &quot;\n&quot;;<br/>
  print $x509-&gt;fingerprint_md5() . &quot;\n&quot;;<br/>
  print $x509-&gt;as_string(Crypt::OpenSSL::X509::FORMAT_TEXT) . &quot;\n&quot;;<br/>
<br/>
  my $x509 = Crypt::OpenSSL::X509-&gt;new_from_string(<br/>
    $der_encoded_data, Crypt::OpenSSL::X509::FORMAT_ASN1<br/>
  );<br/>
<br/>
  # given a time offset of $seconds, will the certificate be valid?<br/>
  if ($x509-&gt;checkend($seconds)) {<br/>
    # cert is ok at $seconds offset<br/>
  } else {<br/>
    # cert is expired at $seconds offset<br/>
  }<br/>
<br/>
  my $exts = $x509-&gt;extensions_by_oid();<br/>
<br/>
  foreach my $oid (keys %$exts) {<br/>
    my $ext = $$exts{$oid};<br/>
    print $oid, &quot; &quot;, $ext-&gt;object()-&gt;name(), &quot;: &quot;, $ext-&gt;value(), &quot;\n&quot;;<br/>
  }<br/>
</div>
<div class="section">
<h1>ABSTRACT</h1><br/>
  Crypt::OpenSSL::X509 - Perl extension to OpenSSL's X509 API.<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1><br/>
  This implement a large majority of OpenSSL's useful X509 API.<br/>
<br/>
  The email() method supports both certificates where the<br/>
  subject is of the form:<br/>
  &quot;... CN=Firstname lastname/emailAddress=user@domain&quot;, and also<br/>
  certificates where there is a X509v3 Extension of the form<br/>
  &quot;X509v3 Subject Alternative Name: email=user@domain&quot;.<br/>
<div class="subsection">
<h2>EXPORT</h2> None by default.<div class="spacer">
</div>
On request:<div class="spacer">
</div>
<br/>
        FORMAT_UNDEF FORMAT_ASN1 FORMAT_TEXT FORMAT_PEM FORMAT_NETSCAPE<br/>
        FORMAT_PKCS12 FORMAT_SMIME FORMAT_ENGINE FORMAT_IISSGC<br/>
</div>
</div>
<div class="section">
<h1>FUNCTIONS</h1><div class="subsection">
<h2>X509 CONSTRUCTORS</h2><dl>
<dt>
new ( )</dt>
<dd>
Create a new X509 object.</dd>
</dl>
<dl>
<dt>
new_from_string ( STRING [ FORMAT ] )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
new_from_file ( FILENAME [ FORMAT ] )</dt>
<dd>
Create a new X509 object from a string or file. &quot;FORMAT&quot; should be &quot;FORMAT_ASN1&quot; or &quot;FORMAT_PEM&quot;.</dd>
</dl>
</div>
<div class="subsection">
<h2>X509 ACCESSORS</h2><dl>
<dt>
subject</dt>
<dd>
Subject name as a string.</dd>
</dl>
<dl>
<dt>
issuer</dt>
<dd>
Issuer name as a string.</dd>
</dl>
<dl>
<dt>
serial</dt>
<dd>
Serial number as a string.</dd>
</dl>
<dl>
<dt>
hash</dt>
<dd>
Subject name hash as a string.</dd>
</dl>
<dl>
<dt>
notBefore</dt>
<dd>
&quot;notBefore&quot; time as a string.</dd>
</dl>
<dl>
<dt>
notAfter</dt>
<dd>
&quot;notAfter&quot; time as a string.</dd>
</dl>
<dl>
<dt>
email</dt>
<dd>
Email address as a string.</dd>
</dl>
<dl>
<dt>
version</dt>
<dd>
Certificate version as a string.</dd>
</dl>
<dl>
<dt>
sig_alg_name</dt>
<dd>
Signature algorithm name as a string.</dd>
</dl>
</div>
<div class="subsection">
<h2>X509 METHODS</h2><dl>
<dt>
subject_name ( )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
issuer_name ( )</dt>
<dd>
Return a Name object for the subject or issuer name. Methods for handling Name objects are given below.</dd>
</dl>
<dl>
<dt>
is_selfsigned ( )</dt>
<dd>
Return Boolean value if subject and issuer name are the same.</dd>
</dl>
<dl>
<dt>
as_string ( [ FORMAT ] )</dt>
<dd>
Return the certificate as a string in the specified format. &quot;FORMAT&quot; can be one of &quot;FORMAT_PEM&quot; (the default), &quot;FORMAT_ASN1&quot;, or &quot;FORMAT_NETSCAPE&quot;.</dd>
</dl>
<dl>
<dt>
modulus ( )</dt>
<dd>
Return the modulus for an RSA public key as a string of hex digits. For DSA, return the public key. Other algorithms are not supported.</dd>
</dl>
<dl>
<dt>
bit_length ( )</dt>
<dd>
Return the length of the modulus as a number of bits.</dd>
</dl>
<dl>
<dt>
fingerprint_md5 ( )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
fingerprint_sha1 ( )</dt>
<dd>
Return the specified message digest for the certificate.</dd>
</dl>
<dl>
<dt>
checkend( OFFSET )</dt>
<dd>
Given an offset in seconds, will the certificate be expired?</dd>
</dl>
<dl>
<dt>
pubkey ( )</dt>
<dd>
Return the RSA or DSA public key.</dd>
</dl>
<dl>
<dt>
num_extensions ( )</dt>
<dd>
Return the number of extensions in the certificate.</dd>
</dl>
<dl>
<dt>
extension ( INDEX )</dt>
<dd>
Return the Extension specified by the integer &quot;INDEX&quot;. Methods for handling Extension objects are given below.</dd>
</dl>
<dl>
<dt>
extensions_by_oid ( ) =item extensions_by_name ( ) =item extensions_by_long_name ( )</dt>
<dd>
Return a hash of Extensions indexed by OID or name.</dd>
</dl>
<dl>
<dt>
has_extension_oid ( OID )</dt>
<dd>
Return true if the certificate has the extension specified by &quot;OID&quot;.</dd>
</dl>
</div>
<div class="subsection">
<h2>X509::Extension METHODS</h2><dl>
<dt>
critical ( )</dt>
<dd>
Return a value indicating if the extension is critical or not. FIXME: the value is an ASN.1 BOOLEAN value.</dd>
</dl>
<dl>
<dt>
object ( )</dt>
<dd>
Return the ObjectID of the extension. Methods for handling ObjectID objects are given below.</dd>
</dl>
<dl>
<dt>
value ( )</dt>
<dd>
Return the value or data of the extension. FIXME: the value is returned as a string but may represent a complex object.</dd>
</dl>
</div>
<div class="subsection">
<h2>X509::ObjectID METHODS</h2><dl>
<dt>
name ( )</dt>
<dd>
Return the long name of the object as a string.</dd>
</dl>
<dl>
<dt>
oid ( )</dt>
<dd>
Return the numeric dot-seperated form of the object identifier as a string.</dd>
</dl>
</div>
<div class="subsection">
<h2>X509::Name METHODS</h2><dl>
<dt>
as_string ( )</dt>
<dd>
Return a string representation of the Name</dd>
</dl>
<dl>
<dt>
entries ( )</dt>
<dd>
Return an array of Name_Entry objects. Methods for handling Name_Entry objects are given below.</dd>
</dl>
<dl>
<dt>
has_entry ( TYPE [ LASTPOS ] )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
has_long_entry ( TYPE [ LASTPOS ] )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
has_oid_entry ( TYPE [ LASTPOS ] )</dt>
<dd>
Return true if a name has an entry of the specified &quot;TYPE&quot;. Depending on the function the &quot;TYPE&quot; may be in the short form (e.g. &quot;CN&quot;), long form (&quot;commonName&quot;) or OID (2.5.4.3). If &quot;LASTPOS&quot; is specified then the search is made from that index rather than from the start.</dd>
</dl>
<dl>
<dt>
get_index_by_type ( TYPE [ LASTPOS ] )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
get_index_by_long_type ( TYPE [ LASTPOS ] )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
get_index_by_oid_type ( TYPE [ LASTPOS ] )</dt>
<dd>
Return the index of an entry of the specified &quot;TYPE&quot; in a name. Depending on the function the &quot;TYPE&quot; may be in the short form (e.g. &quot;CN&quot;), long form (&quot;commonName&quot;) or OID (2.5.4.3). If &quot;LASTPOS&quot; is specified then the search is made from that index rather than from the start.</dd>
</dl>
<dl>
<dt>
get_entry_by_type ( TYPE [ LASTPOS ] )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
get_entry_by_long_type ( TYPE [ LASTPOS ] )</dt>
<dd>
These methods work similarly to get_index_by_* but return the Name_Entry rather than the index.</dd>
</dl>
</div>
<div class="subsection">
<h2>X509::Name_Entry METHODS</h2><dl>
<dt>
as_string ( [ LONG ] )</dt>
<dd>
Return a string representation of the Name_Entry of the form &quot;typeName=Value&quot;. If &quot;LONG&quot; is 1, the long form of the type is used.</dd>
</dl>
<dl>
<dt>
type ( [ LONG ] )</dt>
<dd>
Return a string representation of the type of the Name_Entry. If &quot;LONG&quot; is 1, the long form of the type is used.</dd>
</dl>
<dl>
<dt>
value ( )</dt>
<dd>
Return a string representation of the value of the Name_Entry.</dd>
</dl>
<dl>
<dt>
is_printableString ( )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
is_ia5string ( )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
is_utf8string ( )</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
is_asn1_type ( [ASN1_TYPE] )</dt>
<dd>
Return true if the Name_Entry value is of the specified type. The value of &quot;ASN1_TYPE&quot; should be as listed in OpenSSL's &quot;asn1.h&quot;.</dd>
</dl>
</div>
</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>OpenSSL</i>(1), Crypt::OpenSSL::RSA, Crypt::OpenSSL::Bignum</div>
<div class="section">
<h1>AUTHOR</h1> Dan Sully, &lt;daniel@cpan.org&gt;</div>
<div class="section">
<h1>CONTRIBUTORS</h1> David O'Callaghan, &lt;david.ocallaghan@cs.tcd.ie&gt; Daniel Kahn Gillmor &lt;dkg@fifthhorseman.net&gt;</div>
<div class="section">
<h1>COPYRIGHT AND LICENSE</h1> Copyright 2004-2011 by Dan Sully<div class="spacer">
</div>
This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-05-08</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

