<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
LIBCAP(3)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
LIBCAP(3)</td>
<td class="head-vol">
Linux Programmer's Manual</td>
<td class="head-rtitle">
LIBCAP(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> cap_clear, cap_clear_flag, cap_compare, cap_copy_ext, cap_copy_int, cap_free, cap_from_name, cap_from_text, cap_get_fd, cap_get_file, cap_get_flag, cap_get_pid, cap_get_proc, cap_set_fd, cap_set_file, cap_set_flag, cap_set_proc, cap_size, cap_to_name, cap_to_text, cap_get_pid, cap_dup - capability data object manipulation</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>#include &lt;sys/capability.h&gt;</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_clear(cap_t </b><i>cap_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_clear_flag(cap_t </b><i>cap_p</i><b>, cap_flag_t </b><i>flag</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_compare(cap_t </b><i>cap_a</i><b>, cap_t </b><i>cap_b</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>ssize_t cap_copy_ext(void *</b><i>ext_p</i><b>, cap_t </b><i>cap_p</i><b>, ssize_t </b><i>size</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>cap_t cap_copy_int(const void *</b><i>ext_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_free(void *</b><i>obj_d</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_from_name(const char *</b><i>name</i><b>, cap_value_t *</b><i>cap_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>cap_t cap_from_text(const char *</b><i>buf_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>cap_t cap_get_fd(int </b><i>fd</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>cap_t cap_get_file(const char *</b><i>path_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_get_flag(cap_t </b><i>cap_p</i><b>, cap_value_t </b><i>cap</i><b>,</b><br/>
<b>                 cap_flag_t </b><i>flag</i><b>, cap_flag_value_t *</b><i>value_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<b>#include &lt;sys/types.h&gt;</b><br/>
<b>cap_t cap_get_pid(pid_t </b><i>pid</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<b>cap_t cap_get_proc(void);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_set_fd(int </b><i>fd</i><b>, cap_t </b><i>caps</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_set_file(const char *</b><i>path_p</i><b>, cap_t </b><i>cap_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int cap_set_flag(cap_t </b><i>cap_p</i><b>, cap_flag_t </b><i>flag</i><b>, int </b><i>ncap</i><b>,</b><br/>
<b>                 const cap_value_t *</b><i>caps</i><b>, cap_flag_value_t </b><i>value</i><b>);</b><br/>
<b>int cap_set_proc(cap_t </b><i>cap_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>ssize_t cap_size(cap_t </b><i>cap_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>char *cap_to_name(cap_value_t </b><i>cap</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>char *cap_to_text(cap_t </b><i>caps</i><b>, ssize_t *</b><i>length_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>cap_t cap_get_pid(pid_t </b><i>pid</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>cap_t cap_dup(cap_t </b><i>cap_p</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
Link with <i>-lcap</i>.<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> These functions work on a capability state held in working storage. A <i>cap_t</i> holds information about the capabilities in each of the three sets, Permitted, Inheritable, and Effective. Each capability in a set may be clear (disabled, 0) or set (enabled, 1).<div class="spacer">
</div>
These functions work with the following data types:<dl>
<dt>
<i>cap_value_t</i></dt>
<dd>
identifies a capability, such as <b>CAP_CHOWN</b>.</dd>
</dl>
<dl>
<dt>
<i>cap_flag_t</i></dt>
<dd>
identifies one of the three flags associated with a capability (i.e., it identifies one of the three capability sets). Valid values for this type are <b>CAP_EFFECTIVE</b>, <b>CAP_INHERITABLE</b> or <b>CAP_PERMITTED</b>.</dd>
</dl>
<dl>
<dt>
<i>cap_flag_value_t</i></dt>
<dd>
identifies the setting of a particular capability flag (i.e, the value of a capability in a set). Valid values for this type are <b>CAP_CLEAR</b>(0) or <b>CAP_SET</b>(1).</dd>
</dl>
</div>
<div class="section">
<h1>RETURN VALUE</h1> The return value is generally specific to the individual function called. On failure, <i>errno</i> is set appropriately.</div>
<div class="section">
<h1>CONFORMING TO</h1> These functions are as per the withdrawn POSIX.1e draft specification. The following functions are Linux extensions: <b>cap_clear_flag</b>(), <b>cap_compare</b>(), <b>cap_from_name</b>(), <b>cap_to_name</b>(), and <b>cap_compare</b>().</div>
<div class="section">
<h1>SEE ALSO</h1> <b>cap_clear</b>(3), <b>cap_copy_ext</b>(3), <b>cap_from_text</b>(3), <b>cap_get_file</b>(3), <b>cap_get_proc</b>(3), <b>cap_init</b>(3), <b>capabilities</b>(7), <b>getpid</b>(2) <b>capsh</b>(1)</div>
<table class="foot">
<tr>
<td class="foot-date">
2008-07-29</td>
<td class="foot-os">
</td>
</tr>
</table>
</div>
</body>
</html>

