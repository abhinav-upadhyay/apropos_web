<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
Moose::Cookbook::Roles::Recipe3(3pm)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
Moose::Cookbook::Roles::Recipe3(3pm)</td>
<td class="head-vol">
User Contributed Perl Documentation</td>
<td class="head-rtitle">
Moose::Cookbook::Roles::Recipe3(3pm)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Moose::Cookbook::Roles::Recipe3 - Applying a role to an object instance</div>
<div class="section">
<h1>VERSION</h1> version 2.0401</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
  package MyApp::Role::Job::Manager;<br/>
<br/>
  use List::Util qw( first );<br/>
<br/>
  use Moose::Role;<br/>
<br/>
  has 'employees' =&gt; (<br/>
      is  =&gt; 'rw',<br/>
      isa =&gt; 'ArrayRef[Employee]',<br/>
  );<br/>
<br/>
  sub assign_work {<br/>
      my $self = shift;<br/>
      my $work = shift;<br/>
<br/>
      my $employee = first { !$_-&gt;has_work } @{ $self-&gt;employees };<br/>
<br/>
      die 'All my employees have work to do!' unless $employee;<br/>
<br/>
      $employee-&gt;work($work);<br/>
  }<br/>
<br/>
  package main;<br/>
<br/>
  my $lisa = Employee-&gt;new( name =&gt; 'Lisa' );<br/>
  MyApp::Role::Job::Manager-&gt;meta-&gt;apply($lisa);<br/>
<br/>
  my $homer = Employee-&gt;new( name =&gt; 'Homer' );<br/>
  my $bart  = Employee-&gt;new( name =&gt; 'Bart' );<br/>
  my $marge = Employee-&gt;new( name =&gt; 'Marge' );<br/>
<br/>
  $lisa-&gt;employees( [ $homer, $bart, $marge ] );<br/>
  $lisa-&gt;assign_work('mow the lawn');<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> In this recipe, we show how a role can be applied to an object. In this specific case, we are giving an employee managerial responsibilities.<div class="spacer">
</div>
Applying a role to an object is simple. The Moose::Meta::Role object provides an &quot;apply&quot; method. This method will do the right thing when given an object instance.<div class="spacer">
</div>
<br/>
  MyApp::Role::Job::Manager-&gt;meta-&gt;apply($lisa);<br/>
<div class="spacer">
</div>
We could also use the &quot;apply_all_roles&quot; function from Moose::Util.<div class="spacer">
</div>
<br/>
  apply_all_roles( $person, MyApp::Role::Job::Manager-&gt;meta );<br/>
<div class="spacer">
</div>
The main advantage of using &quot;apply_all_roles&quot; is that it can be used to apply more than one role at a time.<div class="spacer">
</div>
We could also pass parameters to the role we're applying:<div class="spacer">
</div>
<br/>
  MyApp::Role::Job::Manager-&gt;meta-&gt;apply(<br/>
      $lisa,<br/>
      -alias =&gt; { assign_work =&gt; 'get_off_your_lazy_behind' },<br/>
  );<br/>
<div class="spacer">
</div>
We saw examples of how method exclusion and alias working in roles recipe 2.</div>
<div class="section">
<h1>CONCLUSION</h1> Applying a role to an object instance is a useful tool for adding behavior to existing objects. In our example, it is effective used to model a promotion.<div class="spacer">
</div>
It can also be useful as a sort of controlled monkey-patching for existing code, particularly non-Moose code. For example, you could create a debugging role and apply it to an object at runtime.</div>
<div class="section">
<h1>AUTHOR</h1> Moose is maintained by the Moose Cabal, along with the help of many contributors. See &quot;CABAL&quot; in Moose and &quot;CONTRIBUTORS&quot; in Moose for details.</div>
<div class="section">
<h1>COPYRIGHT AND LICENSE</h1> This software is copyright (c) 2011 by Infinity Interactive, Inc..<div class="spacer">
</div>
This is free software; you can redistribute it and/or modify it under the same terms as the Perl 5 programming language system itself.</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-11-17</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

