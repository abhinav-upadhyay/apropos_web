<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
RAND_add(3SSL)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
RAND_add(3SSL)</td>
<td class="head-vol">
OpenSSL</td>
<td class="head-rtitle">
RAND_add(3SSL)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> RAND_add, RAND_seed, RAND_status, RAND_event, RAND_screen - add entropy to the PRNG</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
 #include &lt;openssl/rand.h&gt;<br/>
<br/>
 void RAND_seed(const void *buf, int num);<br/>
<br/>
 void RAND_add(const void *buf, int num, double entropy);<br/>
<br/>
 int  RAND_status(void);<br/>
<br/>
 int  RAND_event(UINT iMsg, WPARAM wParam, LPARAM lParam);<br/>
 void RAND_screen(void);<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1>  <i>RAND_add()</i> mixes the <b>num</b> bytes at <b>buf</b> into the PRNG state. Thus, if the data at  <b>buf</b> are unpredictable to an adversary, this increases the uncertainty about the state and makes the PRNG output less predictable. Suitable input comes from user interaction (random key presses, mouse movements) and certain hardware events. The  <b>entropy</b> argument is (the lower bound of) an estimate of how much randomness is contained in  <b>buf</b>, measured in bytes. Details about sources of randomness and how to estimate their entropy can be found in the literature, e.g. RFC 1750.<div class="spacer">
</div>
<i>RAND_add()</i> may be called with sensitive data such as user entered passwords. The seed values cannot be recovered from the PRNG output.<div class="spacer">
</div>
OpenSSL makes sure that the PRNG state is unique for each thread. On systems that provide &quot;/dev/urandom&quot;, the randomness device is used to seed the PRNG transparently. However, on all other systems, the application is responsible for seeding the PRNG by calling  <i>RAND_add()</i>,  <i>RAND_egd</i>(3) or  <i>RAND_load_file</i>(3).<div class="spacer">
</div>
<i>RAND_seed()</i> is equivalent to <i>RAND_add()</i> when <b>num == entropy</b>.<div class="spacer">
</div>
<i>RAND_event()</i> collects the entropy from Windows events such as mouse movements and other user interaction. It should be called with the  <b>iMsg</b>, <b>wParam</b> and <b>lParam</b> arguments of <i>all</i> messages sent to the window procedure. It will estimate the entropy contained in the event message (if any), and add it to the PRNG. The program can then process the messages as usual.<div class="spacer">
</div>
The <i>RAND_screen()</i> function is available for the convenience of Windows programmers. It adds the current contents of the screen to the PRNG. For applications that can catch Windows events, seeding the PRNG by calling  <i>RAND_event()</i> is a significantly better source of randomness. It should be noted that both methods cannot be used on servers that run without user interaction.</div>
<div class="section">
<h1>RETURN VALUES</h1>  <i>RAND_status()</i> and <i>RAND_event()</i> return 1 if the PRNG has been seeded with enough data, 0 otherwise.<div class="spacer">
</div>
The other functions do not return values.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>rand</i>(3), <i>RAND_egd</i>(3),  <i>RAND_load_file</i>(3), <i>RAND_cleanup</i>(3)</div>
<div class="section">
<h1>HISTORY</h1>  <i>RAND_seed()</i> and <i>RAND_screen()</i> are available in all versions of SSLeay and OpenSSL.  <i>RAND_add()</i> and <i>RAND_status()</i> have been added in OpenSSL 0.9.5,  <i>RAND_event()</i> in OpenSSL 0.9.5a.</div>
<table class="foot">
<tr>
<td class="foot-date">
2000-03-22</td>
<td class="foot-os">
1.0.1</td>
</tr>
</table>
</div>
</body>
</html>

