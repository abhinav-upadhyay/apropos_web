<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
RSA(3pm)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
RSA(3pm)</td>
<td class="head-vol">
User Contributed Perl Documentation</td>
<td class="head-rtitle">
RSA(3pm)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Crypt::OpenSSL::RSA - RSA encoding and decoding, using the openSSL libraries</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
  use Crypt::OpenSSL::Random;<br/>
  use Crypt::OpenSSL::RSA;<br/>
<br/>
  # not necessary if we have /dev/random:<br/>
  Crypt::OpenSSL::Random::random_seed($good_entropy);<br/>
  Crypt::OpenSSL::RSA-&gt;import_random_seed();<br/>
  $rsa_pub = Crypt::OpenSSL::RSA-&gt;new_public_key($key_string);<br/>
  $rsa_pub-&gt;use_sslv23_padding(); # use_pkcs1_oaep_padding is the default<br/>
  $ciphertext = $rsa-&gt;encrypt($plaintext);<br/>
<br/>
  $rsa_priv = Crypt::OpenSSL::RSA-&gt;new_private_key($key_string);<br/>
  $plaintext = $rsa-&gt;encrypt($ciphertext);<br/>
<br/>
  $rsa = Crypt::OpenSSL::RSA-&gt;generate_key(1024); # or<br/>
  $rsa = Crypt::OpenSSL::RSA-&gt;generate_key(1024, $prime);<br/>
<br/>
  print &quot;private key is:\n&quot;, $rsa-&gt;get_private_key_string();<br/>
  print &quot;public key (in PKCS1 format) is:\n&quot;,<br/>
        $rsa-&gt;get_public_key_string();<br/>
  print &quot;public key (in X509 format) is:\n&quot;,<br/>
        $rsa-&gt;get_public_key_x509_string();<br/>
<br/>
  $rsa_priv-&gt;use_md5_hash(); # use_sha1_hash is the default<br/>
  $signature = $rsa_priv-&gt;sign($plaintext);<br/>
  print &quot;Signed correctly\n&quot; if ($rsa-&gt;verify($plaintext, $signature));<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> Crypt::OpenSSL::RSA provides the ability to RSA encrypt strings which are somewhat shorter than the block size of a key.  It also allows for decryption, signatures and signature verification.<div class="spacer">
</div>
<i>NOTE</i>: Many of the methods in this package can croak, so use eval, or Error.pm's try/catch mechanism to capture errors.  Also, while some methods from earlier versions of this package return true on success, this (never documented) behavior is no longer the case.</div>
<div class="section">
<h1>Class Methods</h1><dl>
<dt>
new_public_key</dt>
<dd>
Create a new Crypt::OpenSSL::RSA object by loading a public key in from a string containing Base64/DER-encoding of either the PKCS1 or X.509 representation of the key.  The string should include the -----BEGIN...----- and -----END...----- lines.<div style="height: 1.00em;">
&#160;</div>
The padding is set to PKCS1_OAEP, but can be changed with the use_xxx_padding methods</dd>
</dl>
<dl>
<dt>
new_private_key</dt>
<dd>
Create a new Crypt::OpenSSL::RSA object by loading a private key in from an string containing the Base64/DER encoding of the PKCS1 representation of the key.  The string should include the -----BEGIN...----- and -----END...----- lines.  The padding is set to PKCS1_OAEP, but can be changed with use_xxx_padding.</dd>
</dl>
<dl>
<dt>
generate_key</dt>
<dd>
Create a new Crypt::OpenSSL::RSA object by constructing a private/public key pair.  The first (mandetory) argument is the key size, while the second optional argument specifies the public exponent (the default public exponent is 65537).  The padding is set to PKCS1_OAEP, but can be changed with use_xxx_padding methods.</dd>
</dl>
<dl>
<dt>
new_key_from_parameters</dt>
<dd>
Given Crypt::OpenSSL::Bignum objects for n, e, and optionally d, p, and q, where p and q are the prime factors of n, e is the public exponent and d is the private exponent, create a new Crypt::OpenSSL::RSA object using these values.  If p and q are provided and d is undef, d is computed.  Note that while p and q are not necessary for a private key, their presence will speed up computation.</dd>
</dl>
<dl>
<dt>
import_random_seed</dt>
<dd>
Import a random seed from Crypt::OpenSSL::Random, since the OpenSSL libraries won't allow sharing of random structures across perl XS modules.</dd>
</dl>
</div>
<div class="section">
<h1>Instance Methods</h1><dl>
<dt>
DESTROY</dt>
<dd>
Clean up after ourselves.  In particular, erase and free the memory occupied by the RSA key structure.</dd>
</dl>
<dl>
<dt>
get_public_key_string</dt>
<dd>
Return the Base64/DER-encoded PKCS1 representation of the public key.  This string has header and footer lines:<div style="height: 1.00em;">
&#160;</div>
<br/>
  -----BEGIN RSA PUBLIC KEY------<br/>
  -----END RSA PUBLIC KEY------<br/>
</dd>
</dl>
<dl>
<dt>
get_public_key_x509_string</dt>
<dd>
Return the Base64/DER-encoded representation of the &quot;subject public key&quot;, suitable for use in X509 certificates.  This string has header and footer lines:<div style="height: 1.00em;">
&#160;</div>
<br/>
  -----BEGIN PUBLIC KEY------<br/>
  -----END PUBLIC KEY------<br/>
<div style="height: 1.00em;">
&#160;</div>
and is the format that is produced by running &quot;openssl rsa -pubout&quot;.</dd>
</dl>
<dl>
<dt>
get_private_key_string</dt>
<dd>
Return the DER-encoded PKCS1 representation of the private key.</dd>
</dl>
<dl>
<dt>
encrypt</dt>
<dd>
Encrypt a binary &quot;string&quot; using the public (portion of the) key.</dd>
</dl>
<dl>
<dt>
decrypt</dt>
<dd>
Decrypt a binary &quot;string&quot;.  Croaks if the key is public only.</dd>
</dl>
<dl>
<dt>
private_encrypt</dt>
<dd>
Encrypt a binary &quot;string&quot; using the private key.  Croaks if the key is public only.</dd>
</dl>
<dl>
<dt>
public_decrypt</dt>
<dd>
Decrypt a binary &quot;string&quot; using the public (portion of the) key.</dd>
</dl>
<dl>
<dt>
sign</dt>
<dd>
Sign a string using the secret (portion of the) key.</dd>
</dl>
<dl>
<dt>
verify</dt>
<dd>
Check the signature on a text.</dd>
</dl>
<dl>
<dt>
use_no_padding</dt>
<dd>
Use raw RSA encryption. This mode should only be used to implement cryptographically sound padding modes in the application code. Encrypting user data directly with RSA is insecure.</dd>
</dl>
<dl>
<dt>
use_pkcs1_padding</dt>
<dd>
Use PKCS #1 v1.5 padding. This currently is the most widely used mode of padding.</dd>
</dl>
<dl>
<dt>
use_pkcs1_oaep_padding</dt>
<dd>
Use EME-OAEP padding as defined in PKCS #1 v2.0 with SHA-1, MGF1 and an empty encoding parameter. This mode of padding is recommended for all new applications.  It is the default mode used by Crypt::OpenSSL::RSA.</dd>
</dl>
<dl>
<dt>
use_sslv23_padding</dt>
<dd>
Use PKCS #1 v1.5 padding with an SSL-specific modification that denotes that the server is SSL3 capable.</dd>
</dl>
<dl>
<dt>
use_md5_hash</dt>
<dd>
Use the RFC 1321 MD5 hashing algorithm by Ron Rivest when signing and verifying messages.</dd>
</dl>
<dl>
<dt>
use_sha1_hash</dt>
<dd>
Use the RFC 3174 Secure Hashing Algorithm (FIPS 180-1) when signing and verifying messages. This is the default.</dd>
</dl>
<dl>
<dt>
use_sha224_hash, use_sha256_hash, use_sha384_hash, use_sha512_hash</dt>
<dd>
These FIPS 180-2 hash algorithms, for use when signing and verifying messages, are only available with newer openssl versions (&gt;= 0.9.8).</dd>
</dl>
<dl>
<dt>
use_ripemd160_hash</dt>
<dd>
Dobbertin, Bosselaers and Preneel's RIPEMD hashing algorithm when signing and verifying messages.</dd>
</dl>
<dl>
<dt>
size</dt>
<dd>
Returns the size, in bytes, of the key.  All encrypted text will be of this size, and depending on the padding mode used, the length of the text to be encrypted should be:</dd>
</dl>
<div style="margin-left: 4.00ex;">
<dl>
<dt>
pkcs1_oaep_padding</dt>
<dd>
at most 42 bytes less than this size.</dd>
</dl>
<dl>
<dt>
pkcs1_padding or sslv23_padding</dt>
<dd>
at most 11 bytes less than this size.</dd>
</dl>
<dl>
<dt>
no_padding</dt>
<dd>
exactly this size.</dd>
</dl>
</div>
<div style="margin-left: 4.00ex;">
</div>
<dl>
<dt>
check_key</dt>
<dd>
This function validates the RSA key, returning a true value if the key is valid, and a false value otherwise.  Croaks if the key is public only.</dd>
</dl>
<dl>
<dt>
get_key_parameters</dt>
<dd>
Return Crypt::OpenSSL::Bignum objects representing the values of n, e, d, p, q, d mod (p-1), d mod (q-1), and 1/q mod p, where p and q are the prime factors of n, e is the public exponent and d is the private exponent.  Some of these values may return as undef; only n and e will be defined for a public key.  The Crypt::OpenSSL::Bignum module must be installed for this to work.</dd>
</dl>
<dl>
<dt>
is_private</dt>
<dd>
Return true if this is a private key, and false if it is private only.</dd>
</dl>
</div>
<div class="section">
<h1>BUGS</h1> There is a small memory leak when generating new keys of more than 512 bits.</div>
<div class="section">
<h1>AUTHOR</h1> Ian Robertson, iroberts@cpan.org.  For support, please email perl-openssl-users@lists.sourceforge.net.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>perl</i>(1), <i>Crypt::OpenSSL::Random</i>(3), <i>Crypt::OpenSSL::Bignum</i>(3),  <i>rsa</i>(3), <i>RSA_new</i>(3), <i>RSA_public_encrypt</i>(3), <i>RSA_size</i>(3),  <i>RSA_generate_key</i>(3), <i>RSA_check_key</i>(3)</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-07-03</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

