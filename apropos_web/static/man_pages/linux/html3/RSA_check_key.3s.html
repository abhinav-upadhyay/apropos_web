<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
RSA_check_key(3SSL)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
RSA_check_key(3SSL)</td>
<td class="head-vol">
OpenSSL</td>
<td class="head-rtitle">
RSA_check_key(3SSL)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> RSA_check_key - validate private RSA keys</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
 #include &lt;openssl/rsa.h&gt;<br/>
<br/>
 int RSA_check_key(RSA *rsa);<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> This function validates RSA keys. It checks that  <b>p</b> and <b>q</b> are in fact prime, and that  <b>n = p*q</b>.<div class="spacer">
</div>
It also checks that <b>d*e = 1 mod (p-1*q-1)</b>, and that  <b>dmp1</b>, <b>dmq1</b> and <b>iqmp</b> are set correctly or are <b>NULL</b>.<div class="spacer">
</div>
As such, this function can not be used with any arbitrary RSA key object, even if it is otherwise fit for regular RSA operation. See  <b>NOTES</b> for more information.</div>
<div class="section">
<h1>RETURN VALUE</h1>  <i>RSA_check_key()</i> returns 1 if <b>rsa</b> is a valid RSA key, and 0 otherwise. -1 is returned if an error occurs while checking the key.<div class="spacer">
</div>
If the key is invalid or an error occurred, the reason code can be obtained using  <i>ERR_get_error</i>(3).</div>
<div class="section">
<h1>NOTES</h1> This function does not work on RSA public keys that have only the modulus and public exponent elements populated. It performs integrity checks on all the RSA key material, so the RSA key structure must contain all the private key data too.<div class="spacer">
</div>
Unlike most other RSA functions, this function does <b>not</b> work transparently with any underlying ENGINE implementation because it uses the key data in the RSA structure directly. An ENGINE implementation can override the way key data is stored and handled, and can even provide support for HSM keys - in which case the RSA structure may contain  <b>no</b> key data at all! If the ENGINE in question is only being used for acceleration or analysis purposes, then in all likelihood the RSA key data is complete and untouched, but this can't be assumed in the general case.</div>
<div class="section">
<h1>BUGS</h1> A method of verifying the RSA key using opaque RSA API functions might need to be considered. Right now  <i>RSA_check_key()</i> simply uses the RSA structure elements directly, bypassing the RSA_METHOD table altogether (and completely violating encapsulation and object-orientation in the process). The best fix will probably be to introduce a &quot; <i>check_key()</i>&quot; handler to the RSA_METHOD function table so that alternative implementations can also provide their own verifiers.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>rsa</i>(3), <i>ERR_get_error</i>(3)</div>
<div class="section">
<h1>HISTORY</h1>  <i>RSA_check_key()</i> appeared in OpenSSL 0.9.4.</div>
<table class="foot">
<tr>
<td class="foot-date">
2002-09-25</td>
<td class="foot-os">
1.0.1</td>
</tr>
</table>
</div>
</body>
</html>

