<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
RSA_public_encrypt(3SSL)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
RSA_public_encrypt(3SSL)</td>
<td class="head-vol">
OpenSSL</td>
<td class="head-rtitle">
RSA_public_encrypt(3SSL)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> RSA_public_encrypt, RSA_private_decrypt - RSA public key cryptography</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
 #include &lt;openssl/rsa.h&gt;<br/>
<br/>
 int RSA_public_encrypt(int flen, unsigned char *from,<br/>
    unsigned char *to, RSA *rsa, int padding);<br/>
<br/>
 int RSA_private_decrypt(int flen, unsigned char *from,<br/>
     unsigned char *to, RSA *rsa, int padding);<br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1>  <i>RSA_public_encrypt()</i> encrypts the <b>flen</b> bytes at <b>from</b> (usually a session key) using the public key  <b>rsa</b> and stores the ciphertext in  <b>to</b>. <b>to</b> must point to RSA_size(<b>rsa</b>) bytes of memory.<div class="spacer">
</div>
<b>padding</b> denotes one of the following modes:<dl>
<dt>
RSA_PKCS1_PADDING</dt>
<dd>
PKCS #1 v1.5 padding. This currently is the most widely used mode.</dd>
</dl>
<dl>
<dt>
RSA_PKCS1_OAEP_PADDING</dt>
<dd>
EME-OAEP as defined in PKCS #1 v2.0 with SHA-1, MGF1 and an empty encoding parameter. This mode is recommended for all new applications.</dd>
</dl>
<dl>
<dt>
RSA_SSLV23_PADDING</dt>
<dd>
PKCS #1 v1.5 padding with an SSL-specific modification that denotes that the server is SSL3 capable.</dd>
</dl>
<dl>
<dt>
RSA_NO_PADDING</dt>
<dd>
Raw RSA encryption. This mode should <i>only</i> be used to implement cryptographically sound padding modes in the application code. Encrypting user data directly with RSA is insecure.</dd>
</dl>
<div class="spacer">
</div>
<b>flen</b> must be less than RSA_size(<b>rsa</b>) - 11 for the PKCS #1 v1.5 based padding modes, less than RSA_size( <b>rsa</b>) - 41 for RSA_PKCS1_OAEP_PADDING and exactly RSA_size( <b>rsa</b>) for RSA_NO_PADDING. The random number generator must be seeded prior to calling  <i>RSA_public_encrypt()</i>.<div class="spacer">
</div>
<i>RSA_private_decrypt()</i> decrypts the <b>flen</b> bytes at <b>from</b> using the private key  <b>rsa</b> and stores the plaintext in <b>to</b>. <b>to</b> must point to a memory section large enough to hold the decrypted data (which is smaller than RSA_size( <b>rsa</b>)). <b>padding</b> is the padding mode that was used to encrypt the data.</div>
<div class="section">
<h1>RETURN VALUES</h1>  <i>RSA_public_encrypt()</i> returns the size of the encrypted data (i.e., RSA_size( <b>rsa</b>)). <i>RSA_private_decrypt()</i> returns the size of the recovered plaintext.<div class="spacer">
</div>
On error, -1 is returned; the error codes can be obtained by  <i>ERR_get_error</i>(3).</div>
<div class="section">
<h1>CONFORMING TO</h1> SSL, PKCS #1 v2.0</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>ERR_get_error</i>(3), <i>rand</i>(3), <i>rsa</i>(3),  <i>RSA_size</i>(3)</div>
<div class="section">
<h1>HISTORY</h1> The  <b>padding</b> argument was added in SSLeay 0.8. RSA_NO_PADDING is available since SSLeay 0.9.0, OAEP was added in OpenSSL 0.9.2b.</div>
<table class="foot">
<tr>
<td class="foot-date">
2004-03-23</td>
<td class="foot-os">
1.0.1</td>
</tr>
</table>
</div>
</body>
</html>

