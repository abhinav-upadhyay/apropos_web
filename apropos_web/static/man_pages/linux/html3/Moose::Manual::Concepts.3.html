<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
Moose::Manual::Concepts(3pm)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
Moose::Manual::Concepts(3pm)</td>
<td class="head-vol">
User Contributed Perl Documentation</td>
<td class="head-rtitle">
Moose::Manual::Concepts(3pm)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> Moose::Manual::Concepts - Moose OO concepts</div>
<div class="section">
<h1>VERSION</h1> version 2.0401</div>
<div class="section">
<h1>MOOSE CONCEPTS (VS &quot;OLD SCHOOL&quot; Perl)</h1> In the past, you may not have thought too much about the difference between packages and classes, attributes and methods, constructors and methods, etc. With Moose, these are all conceptually separate, though under the hood they're implemented with plain old Perl.<div class="spacer">
</div>
Our meta-object protocol (aka MOP) provides well-defined introspection features for each of those concepts, and Moose in turn provides distinct sugar for each of them. Moose also introduces additional concepts such as roles, method modifiers, and declarative delegation.<div class="spacer">
</div>
Knowing what these concepts mean in Moose-speak, and how they used to be done in old school Perl 5 OO is a good way to start learning to use Moose.<div class="subsection">
<h2>Class</h2> When you say &quot;use Moose&quot; in a package, you are making your package a class. At its simplest, a class will consist simply of attributes and/or methods. It can also include roles, method modifiers, and more.<div class="spacer">
</div>
A class <i>has</i> zero or more <b>attributes</b>.<div class="spacer">
</div>
A class <i>has</i> zero or more <b>methods</b>.<div class="spacer">
</div>
A class <i>has</i> zero or more superclasses (aka parent classes). A class inherits from its superclass(es).<div class="spacer">
</div>
A class <i>has</i> zero or more <b>method modifiers</b>. These modifiers can apply to its own methods or methods that are inherited from its ancestors.<div class="spacer">
</div>
A class <i>does</i> (and <i>consumes</i>) zero or more <b>roles</b>.<div class="spacer">
</div>
A class <i>has</i> a <b>constructor</b> and a <b>destructor</b>. These are provided for you &quot;for free&quot; by Moose.<div class="spacer">
</div>
The <b>constructor</b> accepts named parameters corresponding to the class's attributes and uses them to initialize an  <b>object instance</b>.<div class="spacer">
</div>
A class <i>has</i> a <b>metaclass</b>, which in turn has <b>meta-attributes</b>,  <b>meta-methods</b>, and <b>meta-roles</b>. This metaclass <i>describes</i> the class.<div class="spacer">
</div>
A class is usually analogous to a category of nouns, like &quot;People&quot; or &quot;Users&quot;.<div class="spacer">
</div>
<br/>
  package Person;<br/>
<br/>
  use Moose;<br/>
  # now it's a Moose class!<br/>
</div>
<div class="subsection">
<h2>Attribute</h2> An attribute is a property of the class that defines it. It  <i>always</i> has a name, and it  <i>may have</i> a number of other properties.<div class="spacer">
</div>
These properties can include a read/write flag, a <b>type</b>, accessor method names,  <b>delegations</b>, a default value, and more.<div class="spacer">
</div>
Attributes <i>are not</i> methods, but defining them causes various accessor methods to be created. At a minimum, a normal attribute will have a reader accessor method. Many attributes have other methods, such as a writer method, a clearer method, or a predicate method (&quot;has it been set?&quot;).<div class="spacer">
</div>
An attribute may also define <b>delegations</b>, which will create additional methods based on the delegation mapping.<div class="spacer">
</div>
By default, Moose stores attributes in the object instance, which is a hashref,  <i>but this is invisible to the author of a Moose-based</i>  <i>class</i>!  It is best to think of Moose attributes as &quot;properties&quot; of the  <i>opaque</i> <b>object instance</b>. These properties are accessed through well-defined accessor methods.<div class="spacer">
</div>
An attribute is something that the class's members have. For example, People have first and last names. Users have passwords and last login datetimes.<div class="spacer">
</div>
<br/>
  has 'first_name' =&gt; (<br/>
      is  =&gt; 'rw',<br/>
      isa =&gt; 'Str',<br/>
  );<br/>
</div>
<div class="subsection">
<h2>Method</h2> A  <b>method</b> is very straightforward. Any subroutine you define in your class is a method.<div class="spacer">
</div>
<b>Methods</b> correspond to verbs, and are what your objects can do. For example, a User can login.<div class="spacer">
</div>
<br/>
  sub login { ... }<br/>
</div>
<div class="subsection">
<h2>Role</h2> A role is something that a class  <i>does</i>. We also say that classes  <i>consume</i> roles. For example, a Machine class might do the Breakable role, and so could a Bone class. A role is used to define some concept that cuts across multiple unrelated classes, like &quot;breakability&quot;, or &quot;has a color&quot;.<div class="spacer">
</div>
A role <i>has</i> zero or more <b>attributes</b>.<div class="spacer">
</div>
A role <i>has</i> zero or more <b>methods</b>.<div class="spacer">
</div>
A role <i>has</i> zero or more <b>method modifiers</b>.<div class="spacer">
</div>
A role <i>has</i> zero or more <b>required methods</b>.<div class="spacer">
</div>
A required method is not implemented by the role. Required methods are a way for the role to declare &quot;to use this role you must implement this method&quot;.<div class="spacer">
</div>
A role <i>has</i> zero or more <b>excluded roles</b>.<div class="spacer">
</div>
An excluded role is a role that the role doing the excluding says it cannot be combined with.<div class="spacer">
</div>
Roles are <i>composed</i> into classes (or other roles). When a role is composed into a class, its attributes and methods are &quot;flattened&quot; into the class. Roles  <i>do not</i> show up in the inheritance hierarchy. When a role is composed, its attributes and methods appear as if they were defined  <i>in the consuming class</i>.<div class="spacer">
</div>
Role are somewhat like mixins or interfaces in other OO languages.<div class="spacer">
</div>
<br/>
  package Breakable;<br/>
<br/>
  use Moose::Role;<br/>
<br/>
  requires 'break';<br/>
<br/>
  has 'is_broken' =&gt; (<br/>
      is  =&gt; 'rw',<br/>
      isa =&gt; 'Bool',<br/>
  );<br/>
<br/>
  after 'break' =&gt; sub {<br/>
      my $self = shift;<br/>
<br/>
      $self-&gt;is_broken(1);<br/>
  };<br/>
</div>
<div class="subsection">
<h2>Method modifiers</h2> A  <b>method modifier</b> is a hook that is called when a named method is called. For example, you could say &quot;before calling &quot;login()&quot;, call this modifier first&quot;. Modifiers come in different flavors like &quot;before&quot;, &quot;after&quot;, &quot;around&quot;, and &quot;augment&quot;, and you can apply more than one modifier to a single method.<div class="spacer">
</div>
Method modifiers are often used as an alternative to overriding a method in a parent class. They are also used in roles as a way of modifying methods in the consuming class.<div class="spacer">
</div>
Under the hood, a method modifier is just a plain old Perl subroutine that gets called before or after (or around, etc.) some named method.<div class="spacer">
</div>
<br/>
  before 'login' =&gt; sub {<br/>
      my $self = shift;<br/>
      my $pw   = shift;<br/>
<br/>
      warn &quot;Called login() with $pw\n&quot;;<br/>
  };<br/>
</div>
<div class="subsection">
<h2>Type</h2> Moose also comes with a (miniature) type system. This allows you to define types for attributes. Moose has a set of built-in types based on the types Perl provides in its core, such as &quot;Str&quot;, &quot;Num&quot;, &quot;Bool&quot;, &quot;HashRef&quot;, etc.<div class="spacer">
</div>
In addition, every class name in your application can also be used as a type name.<div class="spacer">
</div>
Finally, you can define your own types with their own constraints. For example, you could define a &quot;PosInt&quot; type, a subtype of &quot;Int&quot; which only allows positive numbers.</div>
<div class="subsection">
<h2>Delegation</h2> Moose attributes provide declarative syntax for defining delegations. A delegation is a method which in turn calls some method on an attribute to do its real work.</div>
<div class="subsection">
<h2>Constructor</h2> A constructor creates an  <b>object instance</b> for the class. In old school Perl, this was usually done by defining a method called &quot;new()&quot; which in turn called &quot;bless&quot; on a reference.<div class="spacer">
</div>
With Moose, this &quot;new()&quot; method is created for you, and it simply does the right thing. You should never need to define your own constructor!<div class="spacer">
</div>
Sometimes you want to do something whenever an object is created. In those cases, you can provide a &quot;BUILD()&quot; method in your class. Moose will call this for you after creating a new object.</div>
<div class="subsection">
<h2>Destructor</h2> This is a special method called when an object instance goes out of scope. You can specialize what your class does in this method if you need to, but you usually don't.<div class="spacer">
</div>
With old school Perl 5, this is the &quot;DESTROY()&quot; method, but with Moose it is the &quot;DEMOLISH()&quot; method.</div>
<div class="subsection">
<h2>Object instance</h2> An object instance is a specific noun in the class's &quot;category&quot;. For example, one specific Person or User. An instance is created by the class's  <b>constructor</b>.<div class="spacer">
</div>
An instance has values for its attributes. For example, a specific person has a first and last name.<div class="spacer">
</div>
In old school Perl 5, this is often a blessed hash reference. With Moose, you should never need to know what your object instance actually is. (Okay, it's usually a blessed hashref with Moose, too.)</div>
<div class="subsection">
<h2>Moose vs old school summary</h2><dl>
<dt>
&#8226;</dt>
<dd>
Class<div style="height: 1.00em;">
&#160;</div>
A package with no introspection other than mucking about in the symbol table.<div style="height: 1.00em;">
&#160;</div>
With Moose, you get well-defined declaration and introspection.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Attributes<div style="height: 1.00em;">
&#160;</div>
Hand-written accessor methods, symbol table hackery, or a helper module like &quot;Class::Accessor&quot;.<div style="height: 1.00em;">
&#160;</div>
With Moose, these are declaratively defined, and distinct from methods.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Method<div style="height: 1.00em;">
&#160;</div>
These are pretty much the same in Moose as in old school Perl.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Roles<div style="height: 1.00em;">
&#160;</div>
&quot;Class::Trait&quot; or &quot;Class::Role&quot;, or maybe &quot;mixin.pm&quot;.<div style="height: 1.00em;">
&#160;</div>
With Moose, they're part of the core feature set, and are introspectable like everything else.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Method Modifiers<div style="height: 1.00em;">
&#160;</div>
Could only be done through serious symbol table wizardry, and you probably never saw this before (at least in Perl 5).</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Type<div style="height: 1.00em;">
&#160;</div>
Hand-written parameter checking in your &quot;new()&quot; method and accessors.<div style="height: 1.00em;">
&#160;</div>
With Moose, you define types declaratively, and then use them by name with your attributes.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Delegation<div style="height: 1.00em;">
&#160;</div>
&quot;Class::Delegation&quot; or &quot;Class::Delegator&quot;, but probably even more hand-written code.<div style="height: 1.00em;">
&#160;</div>
With Moose, this is also declarative.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Constructor<div style="height: 1.00em;">
&#160;</div>
A &quot;new()&quot; method which calls &quot;bless&quot; on a reference.<div style="height: 1.00em;">
&#160;</div>
Comes for free when you define a class with Moose.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Destructor<div style="height: 1.00em;">
&#160;</div>
A &quot;DESTROY()&quot; method.<div style="height: 1.00em;">
&#160;</div>
With Moose, this is called &quot;DEMOLISH()&quot;.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Object Instance<div style="height: 1.00em;">
&#160;</div>
A blessed reference, usually a hash reference.<div style="height: 1.00em;">
&#160;</div>
With Moose, this is an opaque thing which has a bunch of attributes and methods, as defined by its class.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
Immutabilization<div style="height: 1.00em;">
&#160;</div>
Moose comes with a feature called &quot;immutabilization&quot;. When you make your class immutable, it means you're done adding methods, attributes, roles, etc. This lets Moose optimize your class with a bunch of extremely dirty in-place code generation tricks that speed up things like object construction and so on.</dd>
</dl>
</div>
</div>
<div class="section">
<h1>META WHAT?</h1> A metaclass is a class that describes classes. With Moose, every class you define gets a &quot;meta()&quot; method. The &quot;meta()&quot; method returns a Moose::Meta::Class object, which has an introspection API that can tell you about the class it represents.<div class="spacer">
</div>
<br/>
  my $meta = User-&gt;meta();<br/>
<br/>
  for my $attribute ( $meta-&gt;get_all_attributes ) {<br/>
      print $attribute-&gt;name(), &quot;\n&quot;;<br/>
<br/>
      if ( $attribute-&gt;has_type_constraint ) {<br/>
          print &quot;  type: &quot;, $attribute-&gt;type_constraint-&gt;name, &quot;\n&quot;;<br/>
      }<br/>
  }<br/>
<br/>
  for my $method ( $meta-&gt;get_all_methods ) {<br/>
      print $method-&gt;name, &quot;\n&quot;;<br/>
  }<br/>
<div class="spacer">
</div>
Almost every concept we defined earlier has a meta class, so we have Moose::Meta::Class, Moose::Meta::Attribute, Moose::Meta::Method, Moose::Meta::Role, Moose::Meta::TypeConstraint, Moose::Meta::Instance, and so on.</div>
<div class="section">
<h1>BUT I NEED TO DO IT MY WAY!</h1> One of the great things about Moose is that if you dig down and find that it does something the &quot;wrong way&quot;, you can change it by extending a metaclass. For example, you can have arrayref based objects, you can make your constructors strict (no unknown parameters allowed!), you can define a naming scheme for attribute accessors, you can make a class a Singleton, and much, much more.<div class="spacer">
</div>
Many of these extensions require surprisingly small amounts of code, and once you've done it once, you'll never have to hand-code &quot;your way of doing things&quot; again. Instead you'll just load your favorite extensions.<div class="spacer">
</div>
<br/>
  package MyWay::User;<br/>
<br/>
  use Moose;<br/>
  use MooseX::StrictConstructor<br/>
  use MooseX::MyWay;<br/>
<br/>
  has ...;<br/>
</div>
<div class="section">
<h1>WHAT NEXT?</h1> So you're sold on Moose. Time to learn how to really use it.<div class="spacer">
</div>
If you want to see how Moose would translate directly into old school Perl 5 OO code, check out Moose::Manual::Unsweetened. This might be helpful for quickly wrapping your brain around some aspects of &quot;the Moose way&quot;.<div class="spacer">
</div>
Or you can skip that and jump straight to Moose::Manual::Classes and the rest of the Moose::Manual.<div class="spacer">
</div>
After that we recommend that you start with the Moose::Cookbook. If you work your way through all the recipes under the basics section, you should have a pretty good sense of how Moose works, and all of its basic OO features.<div class="spacer">
</div>
After that, check out the Role recipes. If you're really curious, go on and read the Meta and Extending recipes, but those are mostly there for people who want to be Moose wizards and extend Moose itself.</div>
<div class="section">
<h1>AUTHOR</h1> Moose is maintained by the Moose Cabal, along with the help of many contributors. See &quot;CABAL&quot; in Moose and &quot;CONTRIBUTORS&quot; in Moose for details.</div>
<div class="section">
<h1>COPYRIGHT AND LICENSE</h1> This software is copyright (c) 2011 by Infinity Interactive, Inc..<div class="spacer">
</div>
This is free software; you can redistribute it and/or modify it under the same terms as the Perl 5 programming language system itself.</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-11-17</td>
<td class="foot-os">
perl v5.14.2</td>
</tr>
</table>
</div>
</body>
</html>

