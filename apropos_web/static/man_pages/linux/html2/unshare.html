<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
UNSHARE(2)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
UNSHARE(2)</td>
<td class="head-vol">
Linux Programmer's Manual</td>
<td class="head-rtitle">
UNSHARE(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> unshare - disassociate parts of the process execution context</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
<b>#define _GNU_SOURCE</b>             /* See feature_test_macros(7) */ <b>#include &lt;sched.h&gt;</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int unshare(int </b><i>flags</i><b>);</b><br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> <b>unshare</b>() allows a process to disassociate parts of its execution context that are currently being shared with other processes. Part of the execution context, such as the mount namespace, is shared implicitly when a new process is created using <b>fork</b>(2) or <b>vfork</b>(2), while other parts, such as virtual memory, may be shared by explicit request when creating a process using <b>clone</b>(2).<div style="height: 1.00em;">
&#160;</div>
The main use of <b>unshare</b>() is to allow a process to control its shared execution context without creating a new process.<div style="height: 1.00em;">
&#160;</div>
The <i>flags</i> argument is a bit mask that specifies which parts of the execution context should be unshared. This argument is specified by ORing together zero or more of the following constants:<dl>
<dt>
<b>CLONE_FILES</b></dt>
<dd>
Reverse the effect of the <b>clone</b>(2) <b>CLONE_FILES</b> flag. Unshare the file descriptor table, so that the calling process no longer shares its file descriptors with any other process.</dd>
</dl>
<dl>
<dt>
<b>CLONE_FS</b></dt>
<dd>
Reverse the effect of the <b>clone</b>(2) <b>CLONE_FS</b> flag. Unshare file system attributes, so that the calling process no longer shares its root directory, current directory, or umask attributes with any other process. <b>chroot</b>(2), <b>chdir</b>(2), or <b>umask</b>(2)</dd>
</dl>
<dl>
<dt>
<b>CLONE_NEWIPC</b> (since Linux 2.6.19)</dt>
<dd>
This flag has the same effect as the <b>clone</b>(2) <b>CLONE_NEWIPC</b> flag. Unshare the System V IPC namespace, so that the calling process has a private copy of the System V IPC namespace which is not shared with any other process. Specifying this flag automatically implies <b>CLONE_SYSVSEM</b> as well. Use of <b>CLONE_NEWIPC</b> requires the <b>CAP_SYS_ADMIN</b> capability.</dd>
</dl>
<dl>
<dt>
<b>CLONE_NEWNET</b> (since Linux 2.6.24)</dt>
<dd>
This flag has the same effect as the <b>clone</b>(2) <b>CLONE_NEWNET</b> flag. Unshare the network namespace, so that the calling process is moved into a new network namespace which is not shared with any previously existing process. <b>CLONE_NEWNET</b> requires the <b>CAP_SYS_ADMIN</b> capability.</dd>
</dl>
<dl>
<dt>
<b>CLONE_NEWNS</b></dt>
<dd>
This flag has the same effect as the <b>clone</b>(2) <b>CLONE_NEWNS</b> flag. Unshare the mount namespace, so that the calling process has a private copy of its namespace which is not shared with any other process. Specifying this flag automatically implies <b>CLONE_FS</b> as well. Use of <b>CLONE_NEWNS</b> requires the <b>CAP_SYS_ADMIN</b> capability.</dd>
</dl>
<dl>
<dt>
<b>CLONE_SYSVSEM</b> (since Linux 2.6.26)</dt>
<dd>
This flag reverses the effect of the <b>clone</b>(2) <b>CLONE_SYSVSEM</b> flag. Unshare System V semaphore undo values, so that the calling process has a private copy which is not shared with any other process. Use of <b>CLONE_SYSVSEM</b> requires the <b>CAP_SYS_ADMIN</b> capability.</dd>
</dl>
<dl>
<dt>
<b>CLONE_NEWUTS</b> (since Linux 2.6.19)</dt>
<dd>
This flag has the same effect as the <b>clone</b>(2) <b>CLONE_NEWUTS</b> flag. Unshare the UTS IPC namespace, so that the calling process has a private copy of the UTS namespace which is not shared with any other process. Use of <b>CLONE_NEWUTS</b> requires the <b>CAP_SYS_ADMIN</b> capability.</dd>
</dl>
<div class="spacer">
</div>
If <i>flags</i> is specified as zero, then <b>unshare</b>() is a no-op; no changes are made to the calling process's execution context.</div>
<div class="section">
<h1>RETURN VALUE</h1> On success, zero returned. On failure, -1 is returned and <i>errno</i> is set to indicate the error.</div>
<div class="section">
<h1>ERRORS</h1><dl>
<dt>
<b>EINVAL</b></dt>
<dd>
An invalid bit was specified in <i>flags</i>.</dd>
</dl>
<dl>
<dt>
<b>ENOMEM</b></dt>
<dd>
Cannot allocate sufficient memory to copy parts of caller's context that need to be unshared.</dd>
</dl>
<dl>
<dt>
<b>EPERM</b></dt>
<dd>
The calling process did not have the required privileges for this operation.</dd>
</dl>
</div>
<div class="section">
<h1>VERSIONS</h1> The <b>unshare</b>() system call was added to Linux in kernel 2.6.16.</div>
<div class="section">
<h1>CONFORMING TO</h1> The <b>unshare</b>() system call is Linux-specific.</div>
<div class="section">
<h1>NOTES</h1> Not all of the process attributes that can be shared when a new process is created using <b>clone</b>(2) can be unshared using <b>unshare</b>(). In particular, as at kernel 2.6.16, <b>unshare</b>() does not implement flags that reverse the effects of <b>CLONE_SIGHAND</b>, <b>CLONE_SYSVSEM</b>, <b>CLONE_THREAD</b>, or <b>CLONE_VM</b>. Such functionality may be added in the future, if required.</div>
<div class="section">
<h1>SEE ALSO</h1> <b>clone</b>(2), <b>fork</b>(2), <b>vfork</b>(2), Documentation/unshare.txt</div>
<div class="section">
<h1>COLOPHON</h1> This page is part of release 3.35 of the Linux <i>man-pages</i> project. A description of the project, and information about reporting bugs, can be found at http://man7.org/linux/man-pages/.</div>
<table class="foot">
<tr>
<td class="foot-date">
2010-10-30</td>
<td class="foot-os">
Linux</td>
</tr>
</table>
</div>
</body>
</html>

