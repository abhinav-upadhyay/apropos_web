<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
SYSLOG(2)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
SYSLOG(2)</td>
<td class="head-vol">
Linux Programmer's Manual</td>
<td class="head-rtitle">
SYSLOG(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> syslog, klogctl - read and/or clear kernel message ring buffer; set console_loglevel</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
<b>int syslog(int </b><i>type</i><b>, char *</b><i>bufp</i><b>, int </b><i>len</i><b>);</b> <b>                /* No wrapper provided in glibc */</b><div style="height: 1.00em;">
&#160;</div>
<br/>
/* The glibc interface */<div style="height: 0.00em;">
&#160;</div>
<b>#include &lt;sys/klog.h&gt;</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>int klogctl(int </b><i>type</i><b>, char *</b><i>bufp</i><b>, int </b><i>len</i><b>);</b><br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> If you need the C library function <b>syslog</b>() (which talks to <b>syslogd</b>(8)), then look at <b>syslog</b>(3). The system call of this name is about controlling the kernel <i>printk</i>() buffer, and the glibc wrapper function is called <b>klogctl</b>().<div style="height: 1.00em;">
&#160;</div>
The <i>type</i> argument determines the action taken by this function, as follows:<div style="height: 1.00em;">
&#160;</div>
<br/>
      0 -- Close the log.  Currently a NOP.<br/>
      1 -- Open the log. Currently a NOP.<br/>
      2 -- Read from the log.<br/>
      3 -- Read all messages remaining in the ring buffer.<br/>
      4 -- Read and clear all messages remaining in the ring buffer<br/>
      5 -- Clear ring buffer.<br/>
      6 -- Disable printk to console<br/>
      7 -- Enable printk to console<br/>
      8 -- Set level of messages printed to console<br/>
      9 -- Return number of unread characters in the log buffer<br/>
     10 -- Return size of the log buffer<br/>
<div style="height: 1.00em;">
&#160;</div>
Type 9 was added in Linux 2.4.10; type 10 in Linux 2.6.6.<div style="height: 1.00em;">
&#160;</div>
In Linux kernels before 2.6.37, only command types 3 and 10 are allowed to unprivileged processes. Since Linux 2.6.37, command types 3 and 10 are only allowed to unprivileged processes if <i>/proc/sys/kernel/dmesg_restrict</i> has the value 0. Before Linux 2.6.37, &quot;privileged&quot; means that the caller has the <b>CAP_SYS_ADMIN</b> capability. Since Linux 2.6.37, &quot;privileged&quot; means that the caller has either the <b>CAP_SYS_ADMIN</b> capability (now deprecated for this purpose) or the (new) <b>CAP_SYSLOG</b> capability.<div class="subsection">
<h2>The kernel log buffer</h2> The kernel has a cyclic buffer of length <b>LOG_BUF_LEN</b> in which messages given as arguments to the kernel function <b>printk</b>() are stored (regardless of their loglevel). In early kernels, <b>LOG_BUF_LEN</b> had the value 4096; from kernel 1.3.54, it was 8192; from kernel 2.1.113 it was 16384; since 2.4.23/2.6 the value is a kernel configuration option. In recent kernels the size can be queried with command type 10.<div style="height: 1.00em;">
&#160;</div>
The call <i>syslog(2,buf,len)</i> waits until this kernel log buffer is nonempty, and then reads at most  <i>len</i> bytes into the buffer <i>buf</i>. It returns the number of bytes read. Bytes read from the log disappear from the log buffer: the information can only be read once. This is the function executed by the kernel when a user program reads <i>/proc/kmsg</i>.<div style="height: 1.00em;">
&#160;</div>
The call <i>syslog(3,buf,len)</i> will read the last  <i>len</i> bytes from the log buffer (nondestructively), but will not read more than was written into the buffer since the last &quot;clear ring buffer&quot; command (which does not clear the buffer at all). It returns the number of bytes read.<div style="height: 1.00em;">
&#160;</div>
The call <i>syslog(4,buf,len)</i> does precisely the same, but also executes the &quot;clear ring buffer&quot; command.<div style="height: 1.00em;">
&#160;</div>
The call <i>syslog(5,dummy,dummy)</i> executes just the &quot;clear ring buffer&quot; command. (In each call where <i>buf</i> or <i>len</i> is shown as &quot;dummy&quot;, the value of the argument is ignored by the call.)<div style="height: 1.00em;">
&#160;</div>
The call <i>syslog(6,dummy,dummy)</i> sets the console log level to minimum, so that no messages are printed to the console.<div style="height: 1.00em;">
&#160;</div>
The call <i>syslog(7,dummy,dummy)</i> sets the console log level to default, so that messages are printed to the console.<div style="height: 1.00em;">
&#160;</div>
The call <i>syslog(8,dummy,level)</i> sets the console log level to <i>level</i>, which must be an integer between 1 and 8 (inclusive). See the <b>loglevel</b> section for details.<div style="height: 1.00em;">
&#160;</div>
The call <i>syslog(9,dummy,dummy)</i> returns the number of bytes currently available to be read on the kernel log buffer.<div style="height: 1.00em;">
&#160;</div>
The call <i>syslog(10,dummy,dummy)</i> returns the total size of the kernel log buffer.</div>
<div class="subsection">
<h2>The loglevel</h2> The kernel routine <b>printk</b>() will only print a message on the console, if it has a loglevel less than the value of the variable <i>console_loglevel</i>. This variable initially has the value <b>DEFAULT_CONSOLE_LOGLEVEL</b> (7), but is set to 10 if the kernel command line contains the word &quot;debug&quot;, and to 15 in case of a kernel fault (the 10 and 15 are just silly, and equivalent to 8). This variable is set (to a value in the range 1-8) by the call <i>syslog(8,dummy,value)</i>. The calls <i>syslog(type,dummy,dummy)</i> with  <i>type</i> equal to 6 or 7, set it to 1 (kernel panics only) or 7 (all except debugging messages), respectively.<div style="height: 1.00em;">
&#160;</div>
Every text line in a message has its own loglevel. This level is <i>DEFAULT_MESSAGE_LOGLEVEL - 1</i> (6) unless the line starts with &lt;d&gt; where  <i>d</i> is a digit in the range 1-7, in which case the level is  <i>d</i>. The conventional meaning of the loglevel is defined in <i>&lt;linux/kernel.h&gt;</i> as follows:<div style="height: 1.00em;">
&#160;</div>
<br/>
#define KERN_EMERG    &quot;&lt;0&gt;&quot;  /* system is unusable               */<br/>
#define KERN_ALERT    &quot;&lt;1&gt;&quot;  /* action must be taken immediately */<br/>
#define KERN_CRIT     &quot;&lt;2&gt;&quot;  /* critical conditions              */<br/>
#define KERN_ERR      &quot;&lt;3&gt;&quot;  /* error conditions                 */<br/>
#define KERN_WARNING  &quot;&lt;4&gt;&quot;  /* warning conditions               */<br/>
#define KERN_NOTICE   &quot;&lt;5&gt;&quot;  /* normal but significant condition */<br/>
#define KERN_INFO     &quot;&lt;6&gt;&quot;  /* informational                    */<br/>
#define KERN_DEBUG    &quot;&lt;7&gt;&quot;  /* debug-level messages             */<br/>
</div>
</div>
<div class="section">
<h1>RETURN VALUE</h1> For  <i>type</i> equal to 2, 3, or 4, a successful call to <b>syslog</b>() returns the number of bytes read. For  <i>type</i> 9, <b>syslog</b>() returns the number of bytes currently available to be read on the kernel log buffer. For  <i>type</i> 10, <b>syslog</b>() returns the total size of the kernel log buffer. For other values of  <i>type</i>, 0 is returned on success.<div style="height: 1.00em;">
&#160;</div>
In case of error, -1 is returned, and  <i>errno</i> is set to indicate the error.</div>
<div class="section">
<h1>ERRORS</h1><dl>
<dt>
<b>EINVAL</b></dt>
<dd>
Bad arguments (e.g., bad <i>type</i>; or for <i>type</i> 2, 3, or 4, <i>buf</i> is NULL, or <i>len</i> is less than zero; or for <i>type</i> 8, the <i>level</i> is outside the range 1 to 8).</dd>
</dl>
<dl>
<dt>
<b>ENOSYS</b></dt>
<dd>
This <b>syslog</b>() system call is not available, because the kernel was compiled with the <b>CONFIG_PRINTK</b> kernel-configuration option disabled.</dd>
</dl>
<dl>
<dt>
<b>EPERM</b></dt>
<dd>
An attempt was made to change console_loglevel or clear the kernel message ring buffer by a process without sufficient privilege (more precisely: without the <b>CAP_SYS_ADMIN</b> or <b>CAP_SYSLOG</b> capability).</dd>
</dl>
<dl>
<dt>
<b>ERESTARTSYS</b></dt>
<dd>
System call was interrupted by a signal; nothing was read. (This can be seen only during a trace.)</dd>
</dl>
</div>
<div class="section">
<h1>CONFORMING TO</h1> This system call is Linux-specific and should not be used in programs intended to be portable.</div>
<div class="section">
<h1>NOTES</h1> From the very start people noted that it is unfortunate that a system call and a library routine of the same name are entirely different animals. In libc4 and libc5 the number of this call was defined by <b>SYS_klog</b>. In glibc 2.0 the syscall is baptized <b>klogctl</b>().</div>
<div class="section">
<h1>SEE ALSO</h1> <b>syslog</b>(3), <b>capabilities</b>(7)</div>
<div class="section">
<h1>COLOPHON</h1> This page is part of release 3.35 of the Linux <i>man-pages</i> project. A description of the project, and information about reporting bugs, can be found at http://man7.org/linux/man-pages/.</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-09-07</td>
<td class="foot-os">
Linux</td>
</tr>
</table>
</div>
</body>
</html>

