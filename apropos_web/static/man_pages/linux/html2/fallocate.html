<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<link rel="stylesheet" href="/static/man_pages/linux/style.css" type="text/css" media="all"/>
<title>
FALLOCATE(2)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
FALLOCATE(2)</td>
<td class="head-vol">
Linux Programmer's Manual</td>
<td class="head-rtitle">
FALLOCATE(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> fallocate - manipulate file space</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
<b>#define _GNU_SOURCE</b>             /* See feature_test_macros(7) */ <b>#include &lt;fcntl.h&gt;</b><div class="spacer">
</div>
<br/>
<b>int fallocate(int </b><i>fd</i><b>, int </b><i>mode</i><b>, off_t </b><i>offset</i><b>, off_t </b><i>len</i><b>);</b><br/>
</div>
<div class="section">
<h1>DESCRIPTION</h1> This is a nonportable, Linux-specific system call. For the portable, POSIX.1-specified method of ensuring that space is allocated for a file, see <b>posix_fallocate</b>(3).<div style="height: 1.00em;">
&#160;</div>
<b>fallocate</b>() allows the caller to directly manipulate the allocated disk space for the file referred to by <i>fd</i> for the byte range starting at <i>offset</i> and continuing for <i>len</i> bytes.<div style="height: 1.00em;">
&#160;</div>
The <i>mode</i> argument determines the operation to be performed on the given range. Currently only one flag is supported for <i>mode</i>:<dl>
<dt>
<b>FALLOC_FL_KEEP_SIZE</b></dt>
<dd>
This flag allocates and initializes to zero the disk space within the range specified by <i>offset</i> and <i>len</i>. After a successful call, subsequent writes into this range are guaranteed not to fail because of lack of disk space. Preallocating zeroed blocks beyond the end of the file is useful for optimizing append workloads. Preallocating blocks does not change the file size (as reported by <b>stat</b>(2)) even if it is less than <i>offset</i>+<i>len</i>.</dd>
</dl>
<div class="spacer">
</div>
If <b>FALLOC_FL_KEEP_SIZE</b> flag is not specified in <i>mode</i>, the default behavior is almost same as when this flag is specified. The only difference is that on success, the file size will be changed if <i>offset + len</i> is greater than the file size. This default behavior closely resembles the behavior of the <b>posix_fallocate</b>(3) library function, and is intended as a method of optimally implementing that function.<div class="spacer">
</div>
Because allocation is done in block size chunks, <b>fallocate</b>() may allocate a larger range than that which was specified.</div>
<div class="section">
<h1>RETURN VALUE</h1> <b>fallocate</b>() returns zero on success, and -1 on failure.</div>
<div class="section">
<h1>ERRORS</h1><dl>
<dt>
<b>EBADF</b></dt>
<dd>
<i>fd</i> is not a valid file descriptor, or is not opened for writing.</dd>
</dl>
<dl>
<dt>
<b>EFBIG</b></dt>
<dd>
<i>offset</i>+<i>len</i> exceeds the maximum file size.</dd>
</dl>
<dl>
<dt>
<b>EINTR</b></dt>
<dd>
A signal was caught during execution.</dd>
</dl>
<dl>
<dt>
<b>EINVAL</b></dt>
<dd>
<i>offset</i> was less than 0, or <i>len</i> was less than or equal to 0.</dd>
</dl>
<dl>
<dt>
<b>EIO</b></dt>
<dd>
An I/O error occurred while reading from or writing to a file system.</dd>
</dl>
<dl>
<dt>
<b>ENODEV</b></dt>
<dd>
<i>fd</i> does not refer to a regular file or a directory. (If <i>fd</i> is a pipe or FIFO, a different error results.)</dd>
</dl>
<dl>
<dt>
<b>ENOSPC</b></dt>
<dd>
There is not enough space left on the device containing the file referred to by <i>fd</i>.</dd>
</dl>
<dl>
<dt>
<b>ENOSYS</b></dt>
<dd>
The file system containing the file referred to by <i>fd</i> does not support this operation.</dd>
</dl>
<dl>
<dt>
<b>EOPNOTSUPP</b></dt>
<dd>
The <i>mode</i> is not supported by the file system containing the file referred to by <i>fd</i>.</dd>
</dl>
<dl>
<dt>
<b>EPERM</b></dt>
<dd>
The file referred to by <i>fd</i> is marked immutable (see <b>chattr</b>(1)).</dd>
</dl>
<dl>
<dt>
<b>ESPIPE</b></dt>
<dd>
<i>fd</i> refers to a pipe or FIFO.</dd>
</dl>
</div>
<div class="section">
<h1>VERSIONS</h1> <b>fallocate</b>() is available on Linux since kernel 2.6.23. Support is provided by glibc since version 2.10.</div>
<div class="section">
<h1>CONFORMING TO</h1> <b>fallocate</b>() is Linux-specific.</div>
<div class="section">
<h1>SEE ALSO</h1> <b>ftruncate</b>(2), <b>posix_fadvise</b>(3), <b>posix_fallocate</b>(3)</div>
<div class="section">
<h1>COLOPHON</h1> This page is part of release 3.35 of the Linux <i>man-pages</i> project. A description of the project, and information about reporting bugs, can be found at http://man7.org/linux/man-pages/.</div>
<table class="foot">
<tr>
<td class="foot-date">
2011-09-19</td>
<td class="foot-os">
Linux</td>
</tr>
</table>
</div>
</body>
</html>

