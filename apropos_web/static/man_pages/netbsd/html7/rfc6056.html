<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
RFC6056(7)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
RFC6056(7)</td>
<td class="head-vol" align="center">
Miscellaneous Information Manual</td>
<td class="head-rtitle" align="right">
RFC6056(7)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">rfc6056</b> &#8212; <span class="desc">port randomization algorithms</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">rfc6056</b> algorithms are used in order to randomize the port allocation of outgoing UDP packets, in order to provide protection from a series of &#8220;blind&#8221; attacks based on the attacker's ability to guess the sequence of ephemeral ports associated with outgoing packets. For more information consult RFC 6056.<p>
The individual algorithms are described below.<div class="subsection">
<h2 id="x54686520524643203630353620616c676f726974686d73">The RFC 6056 algorithms</h2> The following algorithms are available:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">bsd</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
This is the default <span class="unix">NetBSD</span> port selection algorithm, which starts from <span class="define">anonportmax</span> and proceeds decreasingly through the available ephemeral ports.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">random_start</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Select ports randomly from the available ephemeral ports. In case a collision with a local port is detected, the algorithm proceeds decreasingly through the sequence of ephemeral ports until a free port is found. Note that the random port selection algorithms are not guaranteed to find a free port.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">random_pick</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Select ports randomly from the available ephemeral ports. In case a collision with a local port is detected the algorithm tries selecting a new port randomly until a free port is found.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">hash</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Select ports using a <a class="link-man" href="../html3/md5.html">md5(3)</a> hash of the local address, the foreign address, and the foreign port. Note that in the case of a <a class="link-man" href="../html2/bind.html">bind(2)</a> call some of this information might be unavailable and the port selection is delayed until the time of a <a class="link-man" href="../html2/connect.html">connect(2)</a> call, performed either explicitly or up calling <a class="link-man" href="../html2/sendto.html">sendto(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">doublehash</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Select ports using a <a class="link-man" href="../html3/md5.html">md5(3)</a> hash of the local address, foreign address, and foreign port coupled with a <a class="link-man" href="../html3/md5.html">md5(3)</a> hash of the same components obtained using a separate table that is associated with a subset of all outgoing connections. The same considerations regarding late connection as in the case of hash apply.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">randinc</span></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
Use random increments in order to select the next port.</dd>
</dl>
</div>
</div>
<div class="section">
<h1 id="x53595343544c20434f4e54524f4c53">SYSCTL CONTROLS</h1> The following sysctl controls are available for selecting the default port randomization algorithm:<table style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-col">
<col style="width: 37.00ex;">
<col style="width: 6.00ex;">
<col style="min-width: 10.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">sysctl name</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Type</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Changeable</span></td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
net.inet.ip.anonportalgo.available</td>
<td class="list-col" style="margin-top: 1.00em;">
string</td>
<td class="list-col" style="margin-top: 1.00em;">
no</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
net.inet.ip.anonportalgo.selected</td>
<td class="list-col" style="margin-top: 1.00em;">
string</td>
<td class="list-col" style="margin-top: 1.00em;">
yes</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
net.inet6.ip6.anonportalgo.available</td>
<td class="list-col" style="margin-top: 1.00em;">
string</td>
<td class="list-col" style="margin-top: 1.00em;">
no</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
net.inet6.ip6.anonportalgo.selected</td>
<td class="list-col" style="margin-top: 1.00em;">
string</td>
<td class="list-col" style="margin-top: 1.00em;">
yes</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x534f434b4554204f5054494f4e53">SOCKET OPTIONS</h1> The <span class="define">IP_PORTSEL</span> socket option at the <span class="define">IPPROTO_IP</span> level and the <span class="define">IPV6_PORTSEL</span> socket option at the <span class="define">IPPROTO_IPV6</span> level can be used with a string argument specifying the algorithm's name in order to select the port randomization algorithm for a specific socket. For more info see <a class="link-man" href="../html2/setsockopt.html">setsockopt(2)</a>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/setsockopt.html">setsockopt(2)</a>, <a class="link-man" href="../html3/sysctl.html">sysctl(3)</a>, <a class="link-man" href="../html7/sysctl.html">sysctl(7)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">rfc6056</b> algorithms first appeared in <span class="unix">NetBSD&#160;6.0</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
August 25, 2011</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

