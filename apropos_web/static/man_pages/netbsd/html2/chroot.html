<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
CHROOT(2)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
CHROOT(2)</td>
<td class="head-vol" align="center">
System Calls Manual</td>
<td class="head-rtitle" align="right">
CHROOT(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">chroot</b> &#8212; <span class="desc">change root directory</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">unistd.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">chroot</b>(<i class="farg" style="white-space:nowrap;">const char *dirname</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">fchroot</b>(<i class="farg" style="white-space:nowrap;">int fd</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <i class="farg">dirname</i> is the address of the pathname of a directory, terminated by an ASCII NUL. <b class="fname">chroot</b>() causes <i class="farg">dirname</i> to become the root directory, that is, the starting point for path searches of pathnames beginning with &#8216;<code class="lit">/</code>&#8217;.<p>
In order for a directory to become the root directory a process must have execute (search) access for that directory.<p>
If the current working directory is not at or under the new root directory, it is silently set to the new root directory. It should be noted that, on most other systems, <b class="fname">chroot</b>() has no effect on the process's current directory.<p>
This call is restricted to the super-user.<p>
The <b class="fname">fchroot</b>() function performs the same operation on an open directory file known by the file descriptor <i class="farg">fd</i>.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, a value of 0 is returned. Otherwise, a value of &#45;1 is returned and <b class="var">errno</b> is set to indicate an error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">chroot</b>() will fail and the root directory will be unchanged if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOTDIR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of the path name is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENAMETOOLONG</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded &#123;<span class="define">NAME_MAX</span>&#125; characters, or an entire path name exceeded &#123;<span class="define">PATH_MAX</span>&#125; characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named directory does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EACCES</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Search permission is denied for any component of the path name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ELOOP</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating the pathname.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">dirname</i> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading from or writing to the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EPERM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The effective user ID of the calling process is not the super-user.</dd>
</dl>
<p>
<b class="fname">fchroot</b>() will fail and the root directory will be unchanged if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EACCES</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Search permission is denied for the directory referenced by the file descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBADF</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The argument <i class="farg">fd</i> is not a valid file descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading from or writing to the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOTDIR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The argument <i class="farg">fd</i> does not reference a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EPERM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The effective user ID of the calling process is not the super-user.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/chdir">chdir(2)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">chroot</b>() function conforms to X/Open System Interfaces and Headers Issue&#160;5 (&#8220;XSH5&#8221;), with the restriction that the calling process' working directory must be at or under the new root directory. Otherwise, the working directory is silently set to the new root directory; this is an extension to the standard.<p>
<b class="fname">chroot</b>() was declared a legacy interface, and subsequently removed in IEEE Std 1003.1-2001 (&#8220;POSIX.1&#8221;).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">chroot</b>() function call appeared in <span class="unix">4.2BSD</span>. Working directory handling was changed in <span class="unix">NetBSD&#160;1.4</span> to prevent one way a process could use a second <b class="fname">chroot</b>() call to a different directory to "escape" from the restricted subtree. The <b class="fname">fchroot</b>() function appeared in <span class="unix">NetBSD&#160;1.4</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 18, 2001</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

