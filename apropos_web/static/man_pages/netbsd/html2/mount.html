<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
MOUNT(2)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
MOUNT(2)</td>
<td class="head-vol" align="center">
System Calls Manual</td>
<td class="head-rtitle" align="right">
MOUNT(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">mount</b>, <b class="name">unmount</b> &#8212; <span class="desc">mount or dismount a file system</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/param.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">sys/mount.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">mount</b>(<i class="farg" style="white-space:nowrap;">const char *type</i>, <i class="farg" style="white-space:nowrap;">const char *dir</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">void *data</i>, <i class="farg" style="white-space:nowrap;">size_t data_len</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">unmount</b>(<i class="farg" style="white-space:nowrap;">const char *dir</i>, <i class="farg" style="white-space:nowrap;">int flags</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">mount</b>() function grafts a file system object onto the system file tree at the point <i class="arg">dir</i>. The argument <i class="arg">data</i> describes the file system object to be mounted, and is <i class="arg">data_len</i> bytes long. The argument <i class="arg">type</i> tells the kernel how to interpret <i class="arg">data</i> (See <i class="arg">type</i> below). The contents of the file system become available through the new mount point <i class="arg">dir</i>. Any files in <i class="arg">dir</i> at the time of a successful mount are swept under the carpet so to speak, and are unavailable until the file system is unmounted.<p>
The following <i class="arg">flags</i> may be specified to suppress default semantics which affect file system access.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_RDONLY</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
The file system should be treated as read-only; even the super-user may not write on it.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_UNION</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Union with underlying filesystem instead of obscuring it.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_HIDDEN</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Cause the <a class="link-man" href="../1/df">df(1)</a> program, and perhaps others, to, by default, exclude this filesystem from its output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_NOEXEC</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Do not allow files to be executed from the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_NOSUID</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Do not honor setuid or setgid bits on files when executing them.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_NODEV</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Do not interpret special files on the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_NOCOREDUMP</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Do not allow programs to dump core files on the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_NOATIME</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Never update access time in the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_RELATIME</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Update access time on write and change. This helps programs that verify that the file has been read after written to work.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_NODEVMTIME</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Never update modification time of device files.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_SYMPERM</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Recognize the permission of symbolic link when reading or traversing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_SYNCHRONOUS</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
All I/O to the file system should be done synchronously. This will slow I/O performance considerably, but enhances overall filesystem reliability.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_ASYNC</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
All I/O to the file system should be done asynchronously. This vastly improves I/O throughput, but at a cost of making the filesystem likely to be completely unrecoverable should the system crash while unwritten data is pending in kernel buffers.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">MNT_LOG</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Use a filesystem journal. <span class="define">MNT_LOG</span> causes a journal (or log) to be created in the filesystem, creating a record of meta-data writes to be performed, allowing the actual writes to be deferred. This improves performance in most cases.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
MNT_EXTATTR</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Enable extended attributes, if the filesystem supports them and does not enable them by default. Currently this is only the case for UFS1.</dd>
</dl>
<p>
The <span class="define">MNT_UPDATE</span>, <span class="define">MNT_RELOAD</span>, and <span class="define">MNT_GETARGS</span> flags indicate that the mount command is being applied to an already mounted file system. The <span class="define">MNT_UPDATE</span> flag allows the mount flags to be changed without requiring that the file system be unmounted and remounted. A conversion from read-write to read-only will fail if any files are currently open for writing on the filesystem, unless the <span class="define">MNT_FORCE</span> flag is also applied. Some file systems may not allow all flags to be changed. For example, some file systems will not allow a change from read-write to read-only. The <span class="define">MNT_RELOAD</span> flag causes kernel filesystem data to be reloaded from the filesystem device. It is only permitted on filesystems mounted read-only. Its purpose is to notify the system that the filesystem data has been modified by some external process. The <span class="define">MNT_GETARGS</span> flag does not alter any of the mounted filesystem's properties, but returns the filesystem-specific arguments for the currently mounted filesystem.<p>
The <i class="farg">type</i> argument defines the type of the file system. The types of file systems known to the system are defined in <b class="includes">&lt;<a class="link-includes">sys/mount.h</a>&gt;</b>, and those supported by the current running kernel obtained using <a class="link-man" href="../8/sysctl">sysctl(8)</a> to obtain the node vfs.generic.fstypes. <i class="farg">data</i> is a pointer to a structure that contains the type specific arguments to mount. Some of the currently supported types of file systems and their type specific data are:<p>
<span class="define">MOUNT_FFS</span><pre style="margin-left: 5.00ex;" class="lit display">
struct ufs_args { 
      char      *fspec;             /* block special file to mount */ 
};</pre>
<p>
<span class="define">MOUNT_NFS</span><pre style="margin-left: 5.00ex;" class="lit display">
struct nfs_args { 
      int             version;      /* args structure version */ 
      struct sockaddr *addr;        /* file server address */ 
      int             addrlen;      /* length of address */ 
      int             sotype;       /* Socket type */ 
      int             proto;        /* and Protocol */ 
      u_char          *fh;          /* File handle to be mounted */ 
      int             fhsize;       /* Size, in bytes, of fh */ 
      int             flags;        /* flags */ 
      int             wsize;        /* write size in bytes */ 
      int             rsize;        /* read size in bytes */ 
      int             readdirsize;  /* readdir size in bytes */ 
      int             timeo;        /* initial timeout in .1 secs */ 
      int             retrans;      /* times to retry send */ 
      int             maxgrouplist; /* Max. size of group list */ 
      int             readahead;    /* # of blocks to readahead */ 
      int             leaseterm;    /* Term (sec) of lease */ 
      int             deadthresh;   /* Retrans threshold */ 
      char            *hostname;    /* server's name */ 
};</pre>
<p>
<span class="define">MOUNT_MFS</span><pre style="margin-left: 5.00ex;" class="lit display">
struct mfs_args { 
      char	*fspec;             /* name to export for statfs */ 
      struct	export_args30 pad;  /* unused */ 
      caddr_t	base;               /* base of file system in mem */ 
      u_long	size;               /* size of file system */ 
};</pre>
<p>
The <b class="fname">unmount</b>() function call disassociates the file system from the specified mount point <i class="farg">dir</i>.<p>
The <i class="farg">flags</i> argument may specify <span class="define">MNT_FORCE</span> to specify that the file system should be forcibly unmounted even if files are still active. Active special devices continue to work, but any further accesses to any other active files result in errors even if the file system is later remounted.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">mount</b>() returns the value 0 if the mount was successful, the number of bytes written to <i class="arg">data</i> for <span class="define">MNT_GETARGS</span>, otherwise &#45;1 is returned and the variable <b class="var">errno</b> is set to indicate the error.<p>
<b class="fname">unmount</b>() returns the value 0 if the unmount succeeded; otherwise &#45;1 is returned and the variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">mount</b>() will fail when one of the following occurs:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBUSY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Another process currently holds a reference to <i class="farg">dir</i>, or for an update from read-write to read-only there are files on the filesystem open for writes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">dir</i> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ELOOP</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating a pathname.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENAMETOOLONG</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded &#123;<span class="define">NAME_MAX</span>&#125; characters, or an entire path name exceeded &#123;<span class="define">PATH_MAX</span>&#125; characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of <i class="farg">dir</i> does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOTDIR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of <i class="arg">name</i> is not a directory, or a path prefix of <i class="arg">special</i> is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EPERM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The caller is not the super-user, and ordinary user mounts are not permitted or this particular request violates the rules.</dd>
</dl>
<p>
The following errors can occur for a <span class="emph">ufs</span> file system mount:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBUSY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="arg">Fspec</i> is already mounted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="arg">Fspec</i> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The super block for the file system had a bad magic number or an out of range block size.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading the super block or cylinder group information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EMFILE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
No space remains in the mount table.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENODEV</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of ufs_args <i class="arg">fspec</i> does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOMEM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Not enough memory was available to read the cylinder group information for the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOTBLK</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="arg">Fspec</i> is not a block device.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENXIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The major device number of <i class="arg">fspec</i> is out of range (this indicates no device driver exists for the associated hardware).</dd>
</dl>
<p>
The following errors can occur for a <span class="emph">nfs</span> file system mount:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Some part of the information described by nfs_args points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ETIMEDOUT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="emph">Nfs</span> timed out trying to contact the server.</dd>
</dl>
<p>
The following errors can occur for a <span class="emph">mfs</span> file system mount:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="emph">Name</span> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The super block for the file system had a bad magic number or an out of range block size.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A paging error occurred while reading the super block or cylinder group information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EMFILE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
No space remains in the mount table.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOMEM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Not enough memory was available to read the cylinder group information for the file system.</dd>
</dl>
<p>
<b class="fname">unmount</b>() may fail with one of the following errors:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBUSY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A process is holding a reference to a file located on the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">dir</i> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The requested directory is not in the mount table.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while writing cached file system information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ELOOP</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating the pathname.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENAMETOOLONG</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded &#123;<span class="define">NAME_MAX</span>&#125; characters, or an entire path name exceeded &#123;<span class="define">PATH_MAX</span>&#125; characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOTDIR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of the path is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EPERM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The caller is not the super-user.</dd>
</dl>
<p>
A <span class="emph">ufs</span> or <span class="emph">mfs</span> mount can also fail if the maximum number of file systems are currently mounted.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/df">df(1)</a>, <a class="link-man" href="../2/getvfsstat">getvfsstat(2)</a>, <a class="link-man" href="../2/nfssvc">nfssvc(2)</a>, <a class="link-man" href="../3/getmntinfo">getmntinfo(3)</a>, <a class="link-man" href="../7/symlink">symlink(7)</a>, <a class="link-man" href="../8/mount">mount(8)</a>, <a class="link-man" href="../8/sysctl">sysctl(8)</a>, <a class="link-man" href="../8/umount">umount(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">mount</b>() and <b class="fname">umount</b>() (now <b class="fname">unmount</b>()) function calls were all present in Version&#160;6 AT&amp;T UNIX.<p>
Prior to <span class="unix">NetBSD&#160;4.0</span> the <b class="name">mount</b> call was used to export NFS filesystems. This is now done through <b class="fname">nfssvc</b>().<p>
The <span class="define">data_len</span> argument was added for <span class="unix">NetBSD&#160;5.0</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Some of the error codes need translation to more obvious messages.<p>
Far more filesystems are supported than those those listed.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
November 18, 2011</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

