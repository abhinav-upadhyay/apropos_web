<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
LINK(2)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
LINK(2)</td>
<td class="head-vol" align="center">
System Calls Manual</td>
<td class="head-rtitle" align="right">
LINK(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">link</b> &#8212; <span class="desc">make a hard file link</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">unistd.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">link</b>(<i class="farg" style="white-space:nowrap;">const char *name1</i>, <i class="farg" style="white-space:nowrap;">const char *name2</i>);<p>
<b class="includes">#include &lt;<a class="link-includes">fcntl.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">linkat</b>(<i class="farg" style="white-space:nowrap;">int fd1</i>, <i class="farg" style="white-space:nowrap;">const char *name1</i>, <i class="farg" style="white-space:nowrap;">int fd2</i>, <i class="farg" style="white-space:nowrap;">const char *name2</i>, <i class="farg" style="white-space:nowrap;">int flags</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">link</b>() function call atomically creates the specified directory entry (hard link) <i class="farg">name2</i> with the attributes of the underlying object pointed at by <i class="farg">name1</i>. If the link is successful: the link count of the underlying object is incremented; <i class="farg">name1</i> and <i class="farg">name2</i> share equal access and rights to the underlying object.<p>
If <i class="farg">name1</i> is removed, the file <i class="farg">name2</i> is not deleted and the link count of the underlying object is decremented.<p>
<i class="farg">name1</i> must exist for the hard link to succeed and both <i class="farg">name1</i> and <i class="farg">name2</i> must be in the same file system. <i class="farg">name1</i> may not be a directory unless the caller is the super-user and the file system containing it supports linking to directories.<p>
<b class="fname">linkat</b>() works the same way as <b class="fname">link</b>() except if <i class="farg">name1</i> (resp. <i class="farg">name2</i>) is relative. In that case, it is looked up from a directory whose file descriptor was passed as <i class="farg">fd1</i> (resp. <i class="farg">fd2</i>). Search permission is required on the directories named by <i class="farg">fd1</i> and <i class="farg">fd2</i>. <i class="farg">fd1</i> or <i class="farg">fd2</i> can be set to <span class="define">AT_FDCWD</span> in order to specify the current directory.<p>
When operating on a symlink, <b class="fname">link</b>() resolves the symlink and creates a hard link on the target. <b class="fname">linkat</b>() will do the same if <span class="define">AT_SYMLINK_FOLLOW</span> is set in <i class="farg">flags</i>, but it will link on the symlink itself if the flag is clear.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> The <b class="fname">link</b>() and <b class="fname">linkat</b>() functions return the value 0 if successful; otherwise the value -1 is returned and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">link</b>() and <b class="fname">linkat</b>() will fail and no link will be created if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EACCES</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of either path prefix denies search permission, or the requested link requires writing in a directory with a mode that denies write permission.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EDQUOT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The directory in which the entry for the new link is being placed cannot be extended because the user's quota of disk blocks on the file system containing the directory has been exhausted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EEXIST</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The link named by <i class="farg">name2</i> does exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
One of the pathnames specified is outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading from or writing to the file system to make the directory entry.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ELOOP</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating one of the pathnames.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EMLINK</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The link count of the file named by <i class="farg">name1</i> would exceed &#123;<span class="define">LINK_MAX</span>&#125;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENAMETOOLONG</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded &#123;<span class="define">NAME_MAX</span>&#125; characters, or an entire path name exceeded &#123;<span class="define">PATH_MAX</span>&#125; characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of either path prefix does not exist, or the file named by <i class="farg">name1</i> does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOSPC</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The directory in which the entry for the new link is being placed cannot be extended because there is no space left on the file system containing the directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOTDIR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of either path prefix is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EOPNOTSUPP</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The file system containing the file named by <i class="farg">name1</i> does not support links.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EPERM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The file named by <i class="farg">name1</i> is a directory and the effective user ID is not super-user, or the file system containing the file does not permit the use of <b class="fname">link</b>() on a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EROFS</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The requested link requires writing in a directory on a read-only file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EXDEV</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The link named by <i class="farg">name2</i> and the file named by <i class="farg">name1</i> are on different file systems.</dd>
</dl>
<p>
In addition, <b class="fname">linkat</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBADF</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">name1</i> or <i class="farg">name2</i> does not specify an absolute path and <i class="farg">fd1</i> or <i class="farg">fd2</i>, respectively, is neither <span class="define">AT_FDCWD</span> nor a valid file descriptor open for reading or searching.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOTDIR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">name1</i> or <i class="farg">name2</i> is not an absolute path and <i class="farg">fd1</i> or <i class="farg">fd2</i>, respectively, is a file descriptor associated with a non-directory file.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/symlink">symlink(2)</a>, <a class="link-man" href="../2/unlink">unlink(2)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">link</b>() function conforms to IEEE Std 1003.1-1990 (&#8220;POSIX.1&#8221;). <b class="fname">linkat</b>() conforms to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;).</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
July 28, 2013</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

