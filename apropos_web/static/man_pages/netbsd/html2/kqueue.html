<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
KQUEUE(2)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
KQUEUE(2)</td>
<td class="head-vol" align="center">
System Calls Manual</td>
<td class="head-rtitle" align="right">
KQUEUE(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">kqueue</b>, <b class="name">kqueue1</b>, <b class="name">kevent</b> &#8212; <span class="desc">kernel event notification mechanism</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/event.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">sys/time.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">kqueue</b>(<i class="farg" style="white-space:nowrap;">void</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">kqueue1</b>(<i class="farg" style="white-space:nowrap;">int flags</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">kevent</b>(<i class="farg" style="white-space:nowrap;">int kq</i>, <i class="farg" style="white-space:nowrap;">const struct kevent *changelist</i>, <i class="farg" style="white-space:nowrap;">size_t nchanges</i>, <i class="farg" style="white-space:nowrap;">struct kevent *eventlist</i>, <i class="farg" style="white-space:nowrap;">size_t nevents</i>, <i class="farg" style="white-space:nowrap;">const struct timespec *timeout</i>);<p>
<b class="fname">EV_SET</b>(<i class="farg" style="white-space:nowrap;">&amp;kev</i>, <i class="farg" style="white-space:nowrap;">ident</i>, <i class="farg" style="white-space:nowrap;">filter</i>, <i class="farg" style="white-space:nowrap;">flags</i>, <i class="farg" style="white-space:nowrap;">fflags</i>, <i class="farg" style="white-space:nowrap;">data</i>, <i class="farg" style="white-space:nowrap;">udata</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">kqueue</b>() provides a generic method of notifying the user when an event happens or a condition holds, based on the results of small pieces of kernel code termed filters. A kevent is identified by the (ident, filter) pair; there may only be one unique kevent per kqueue.<p>
The filter is executed upon the initial registration of a kevent in order to detect whether a preexisting condition is present, and is also executed whenever an event is passed to the filter for evaluation. If the filter determines that the condition should be reported, then the kevent is placed on the kqueue for the user to retrieve.<p>
The filter is also run when the user attempts to retrieve the kevent from the kqueue. If the filter indicates that the condition that triggered the event no longer holds, the kevent is removed from the kqueue and is not returned.<p>
Multiple events which trigger the filter do not result in multiple kevents being placed on the kqueue; instead, the filter will aggregate the events into a single struct kevent. Calling <b class="fname">close</b>() on a file descriptor will remove any kevents that reference the descriptor.<p>
<b class="fname">kqueue</b>() creates a new kernel event queue and returns a descriptor.<p>
The <b class="fname">kqueue1</b>() also allows to set the following <i class="farg">flags</i> on the returned file descriptor:<table style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-col">
<col style="min-width: 10.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">O_CLOEXEC</span> Set the close on exec property.</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">O_NONBLOCK</span> Sets non-blocking I/O.</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">O_NOSIGPIPE</span> Return <span class="errno">EPIPE</span> instead of raising <span class="define">SIGPIPE</span>.</td>
</tr>
</tbody>
</table>
The queue is not inherited by a child created with <a class="link-man" href="../2/fork">fork(2)</a>.<p>
<b class="fname">kevent</b>() is used to register events with the queue, and return any pending events to the user. <i class="farg">changelist</i> is a pointer to an array of <b class="var">kevent</b> structures, as defined in <b class="includes">&lt;<a class="link-includes">sys/event.h</a>&gt;</b>. All changes contained in the <i class="farg">changelist</i> are applied before any pending events are read from the queue. <i class="farg">nchanges</i> gives the size of <i class="farg">changelist</i>. <i class="farg">eventlist</i> is a pointer to an array of kevent structures. <i class="farg">nevents</i> determines the size of <i class="farg">eventlist</i>. If <i class="farg">timeout</i> is a non-<span class="define">NULL</span> pointer, it specifies a maximum interval to wait for an event, which will be interpreted as a struct timespec. If <i class="farg">timeout</i> is a <span class="define">NULL</span> pointer, <b class="fname">kevent</b>() waits indefinitely. To effect a poll, the <i class="farg">timeout</i> argument should be non-<span class="define">NULL</span>, pointing to a zero-valued <b class="var">timespec</b> structure. The same array may be used for the <i class="farg">changelist</i> and <i class="farg">eventlist</i>.<p>
<b class="fname">EV_SET</b>() is a macro which is provided for ease of initializing a kevent structure.<p>
The <b class="var">kevent</b> structure is defined as:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
struct kevent { 
	uintptr_t ident;	/* identifier for this event */ 
	uint32_t  filter;	/* filter for event */ 
	uint32_t  flags;	/* action flags for kqueue */ 
	uint32_t  fflags;	/* filter flag value */ 
	int64_t   data;		/* filter data value */ 
	intptr_t  udata;	/* opaque user data identifier */ 
};</pre>
<p>
The fields of <i class="farg">struct kevent</i> are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
ident</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Value used to identify this event. The exact interpretation is determined by the attached filter, but often is a file descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
filter</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Identifies the kernel filter used to process this event. There are pre-defined system filters (which are described below), and other filters may be added by kernel subsystems as necessary.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
flags</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Actions to perform on the event.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
fflags</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Filter-specific flags.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
data</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Filter-specific data value.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
udata</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Opaque user-defined value passed through the kernel unchanged.</dd>
</dl>
<p>
The <b class="var">flags</b> field can contain the following values:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
EV_ADD</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Adds the event to the kqueue. Re-adding an existing event will modify the parameters of the original event, and not result in a duplicate entry. Adding an event automatically enables it, unless overridden by the EV_DISABLE flag.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EV_ENABLE</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Permit <b class="fname">kevent</b>() to return the event if it is triggered.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EV_DISABLE</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Disable the event so <b class="fname">kevent</b>() will not return it. The filter itself is not disabled.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EV_DELETE</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Removes the event from the kqueue. Events which are attached to file descriptors are automatically deleted on the last close of the descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EV_ONESHOT</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Causes the event to return only the first occurrence of the filter being triggered. After the user retrieves the event from the kqueue, it is deleted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EV_CLEAR</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
After the event is retrieved by the user, its state is reset. This is useful for filters which report state transitions instead of the current state. Note that some filters may automatically set this flag internally.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EV_EOF</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Filters may set this flag to indicate filter-specific EOF condition.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EV_ERROR</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
See <i class="link-sec"><a class="link-sec" href="#x52455455524e2056414c554553">RETURN VALUES</a></i> below.</dd>
</dl>
<div class="subsection">
<h2 id="x46696c74657273">Filters</h2> Filters are identified by a number. There are two types of filters; pre-defined filters which are described below, and third-party filters that may be added with <a class="link-man" href="../9/kfilter_register">kfilter_register(9)</a> by kernel sub-systems, third-party device drivers, or loadable kernel modules.<p>
As a third-party filter is referenced by a well-known name instead of a statically assigned number, two <a class="link-man" href="../2/ioctl">ioctl(2)</a>s are supported on the file descriptor returned by <b class="fname">kqueue</b>() to map a filter name to a filter number, and vice-versa (passing arguments in a structure described below):<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
KFILTER_BYFILTER</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
Map <b class="var">filter</b> to <b class="var">name</b>, which is of size <b class="var">len</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
KFILTER_BYNAME</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
Map <b class="var">name</b> to <b class="var">filter</b>. <b class="var">len</b> is ignored.</dd>
</dl>
<p>
The following structure is used to pass arguments in and out of the <a class="link-man" href="../2/ioctl">ioctl(2)</a>:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
struct kfilter_mapping { 
	char	 *name;		/* name to lookup or return */ 
	size_t	 len;		/* length of name */ 
	uint32_t filter;	/* filter to lookup or return */ 
};</pre>
<p>
Arguments may be passed to and from the filter via the <b class="var">fflags</b> and <b class="var">data</b> fields in the kevent structure.<p>
The predefined system filters are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
EVFILT_READ</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Takes a descriptor as the identifier, and returns whenever there is data available to read. The behavior of the filter is slightly different depending on the descriptor type.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
Sockets</dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
Sockets which have previously been passed to <b class="fname">listen</b>() return when there is an incoming connection pending. <b class="var">data</b> contains the size of the listen backlog (i.e., the number of connections ready to be accepted with <a class="link-man" href="../2/accept">accept(2)</a>.)<p>
Other socket descriptors return when there is data to be read, subject to the <span class="define">SO_RCVLOWAT</span> value of the socket buffer. This may be overridden with a per-filter low water mark at the time the filter is added by setting the NOTE_LOWAT flag in <b class="var">fflags</b>, and specifying the new low water mark in <b class="var">data</b>. On return, <b class="var">data</b> contains the number of bytes in the socket buffer.<p>
If the read direction of the socket has shutdown, then the filter also sets EV_EOF in <b class="var">flags</b>, and returns the socket error (if any) in <b class="var">fflags</b>. It is possible for EOF to be returned (indicating the connection is gone) while there is still data pending in the socket buffer.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
Vnodes</dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
Returns when the file pointer is not at the end of file. <b class="var">data</b> contains the offset from current position to end of file, and may be negative.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
Fifos, Pipes</dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
Returns when there is data to read; <b class="var">data</b> contains the number of bytes available.<p>
When the last writer disconnects, the filter will set EV_EOF in <b class="var">flags</b>. This may be cleared by passing in EV_CLEAR, at which point the filter will resume waiting for data to become available before returning.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EVFILT_WRITE</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Takes a descriptor as the identifier, and returns whenever it is possible to write to the descriptor. For sockets, pipes, fifos, and ttys, <b class="var">data</b> will contain the amount of space remaining in the write buffer. The filter will set EV_EOF when the reader disconnects, and for the fifo case, this may be cleared by use of EV_CLEAR. Note that this filter is not supported for vnodes.<p>
For sockets, the low water mark and socket error handling is identical to the EVFILT_READ case.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EVFILT_AIO</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
This is not implemented in <span class="unix">NetBSD</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EVFILT_VNODE</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Takes a file descriptor as the identifier and the events to watch for in <b class="var">fflags</b>, and returns when one or more of the requested events occurs on the descriptor. The events to monitor are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
NOTE_DELETE</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
<b class="fname">unlink</b>() was called on the file referenced by the descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
NOTE_WRITE</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
A write occurred on the file referenced by the descriptor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
NOTE_EXTEND</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The file referenced by the descriptor was extended.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
NOTE_ATTRIB</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The file referenced by the descriptor had its attributes changed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
NOTE_LINK</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The link count on the file changed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
NOTE_RENAME</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The file referenced by the descriptor was renamed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
NOTE_REVOKE</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Access to the file was revoked via <a class="link-man" href="../2/revoke">revoke(2)</a> or the underlying fileystem was unmounted.</dd>
</dl>
<p>
On return, <b class="var">fflags</b> contains the events which triggered the filter.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EVFILT_PROC</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Takes the process ID to monitor as the identifier and the events to watch for in <b class="var">fflags</b>, and returns when the process performs one or more of the requested events. If a process can normally see another process, it can attach an event to it. The events to monitor are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
NOTE_EXIT</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
The process has exited. The exit code of the process is stored in <b class="var">data</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
NOTE_FORK</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
The process has called <b class="fname">fork</b>().</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
NOTE_EXEC</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
The process has executed a new process via <a class="link-man" href="../2/execve">execve(2)</a> or similar call.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
NOTE_TRACK</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Follow a process across <b class="fname">fork</b>() calls. The parent process will return with NOTE_TRACK set in the <b class="var">fflags</b> field, while the child process will return with NOTE_CHILD set in <b class="var">fflags</b> and the parent PID in <b class="var">data</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
NOTE_TRACKERR</dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
This flag is returned if the system was unable to attach an event to the child process, usually due to resource limitations.</dd>
</dl>
<p>
On return, <b class="var">fflags</b> contains the events which triggered the filter.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EVFILT_SIGNAL</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Takes the signal number to monitor as the identifier and returns when the given signal is delivered to the current process. This coexists with the <b class="fname">signal</b>() and <b class="fname">sigaction</b>() facilities, and has a lower precedence. The filter will record all attempts to deliver a signal to a process, even if the signal has been marked as SIG_IGN. Event notification happens after normal signal delivery processing. <b class="var">data</b> returns the number of times the signal has occurred since the last call to <b class="fname">kevent</b>(). This filter automatically sets the EV_CLEAR flag internally.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
EVFILT_TIMER</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Establishes an arbitrary timer identified by <b class="var">ident</b>. When adding a timer, <b class="var">data</b> specifies the timeout period in milliseconds. The timer will be periodic unless EV_ONESHOT is specified. On return, <b class="var">data</b> contains the number of times the timeout has expired since the last call to <b class="fname">kevent</b>(). This filter automatically sets the EV_CLEAR flag internally.</dd>
</dl>
</div>
</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">kqueue</b>() creates a new kernel event queue and returns a file descriptor. If there was an error creating the kernel event queue, a value of &#45;1 is returned and errno set.<p>
<b class="fname">kevent</b>() returns the number of events placed in the <i class="farg">eventlist</i>, up to the value given by <i class="farg">nevents</i>. If an error occurs while processing an element of the <i class="farg">changelist</i> and there is enough room in the <i class="farg">eventlist</i>, then the event will be placed in the <i class="farg">eventlist</i> with <span class="define">EV_ERROR</span> set in <b class="var">flags</b> and the system error in <b class="var">data</b>. Otherwise, <span class="define">&#45;1</span> will be returned, and <span class="define">errno</span> will be set to indicate the error condition. If the time limit expires, then <b class="fname">kevent</b>() returns 0.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The following example program monitors a file (provided to it as the first argument) and prints information about some common events it receives notifications for:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
#include &lt;sys/types.h&gt; 
#include &lt;sys/event.h&gt; 
#include &lt;sys/time.h&gt; 
#include &lt;stdio.h&gt; 
#include &lt;unistd.h&gt; 
#include &lt;stdlib.h&gt; 
#include &lt;fcntl.h&gt; 
#include &lt;err.h&gt; 
 
int 
main(int argc, char *argv[]) 
{ 
        int fd, kq, nev; 
        struct kevent ev; 
        static const struct timespec tout = { 1, 0 }; 
 
        if ((fd = open(argv[1], O_RDONLY)) == -1) 
                err(1, "Cannot open `%s'", argv[1]); 
 
        if ((kq = kqueue()) == -1) 
                err(1, "Cannot create kqueue"); 
 
        EV_SET(&amp;ev, fd, EVFILT_VNODE, EV_ADD | EV_ENABLE | EV_CLEAR, 
            NOTE_DELETE|NOTE_WRITE|NOTE_EXTEND|NOTE_ATTRIB|NOTE_LINK| 
            NOTE_RENAME|NOTE_REVOKE, 0, 0); 
        if (kevent(kq, &amp;ev, 1, NULL, 0, &amp;tout) == -1) 
                err(1, "kevent"); 
        for (;;) { 
                nev = kevent(kq, NULL, 0, &amp;ev, 1, &amp;tout); 
                if (nev == -1) 
                        err(1, "kevent"); 
                if (nev == 0) 
                        continue; 
                if (ev.fflags &amp; NOTE_DELETE) { 
                        printf("deleted "); 
                        ev.fflags &amp;= ~NOTE_DELETE; 
                } 
                if (ev.fflags &amp; NOTE_WRITE) { 
                        printf("written "); 
                        ev.fflags &amp;= ~NOTE_WRITE; 
                } 
                if (ev.fflags &amp; NOTE_EXTEND) { 
                        printf("extended "); 
                        ev.fflags &amp;= ~NOTE_EXTEND; 
                } 
                if (ev.fflags &amp; NOTE_ATTRIB) { 
                        printf("chmod/chown/utimes "); 
                        ev.fflags &amp;= ~NOTE_ATTRIB; 
                } 
                if (ev.fflags &amp; NOTE_LINK) { 
                        printf("hardlinked "); 
                        ev.fflags &amp;= ~NOTE_LINK; 
                } 
                if (ev.fflags &amp; NOTE_RENAME) { 
                        printf("renamed "); 
                        ev.fflags &amp;= ~NOTE_RENAME; 
                } 
                if (ev.fflags &amp; NOTE_REVOKE) { 
                        printf("revoked "); 
                        ev.fflags &amp;= ~NOTE_REVOKE; 
                } 
                printf("\n"); 
                if (ev.fflags) 
                        warnx("unknown event 0x%x\n", ev.fflags); 
        } 
}</pre>
</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> The <b class="fname">kqueue</b>() function fails if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EMFILE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The per-process descriptor table is full.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENFILE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The system file table is full.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOMEM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The kernel failed to allocate enough memory for the kernel queue.</dd>
</dl>
<p>
The <b class="fname">kevent</b>() function fails if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EACCES</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The process does not have permission to register a filter.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBADF</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The specified descriptor is invalid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
There was an error reading or writing the <b class="var">kevent</b> structure.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINTR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A signal was delivered before the timeout expired and before any events were placed on the kqueue for return.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The specified time limit or filter is invalid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The event could not be found to be modified or deleted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOMEM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
No memory was available to register the event.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EOPNOTSUPP</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
This type of file descriptor is not supported for <b class="fname">kevent</b>() operations.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ESRCH</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The specified process to attach to does not exist.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/ioctl">ioctl(2)</a>, <a class="link-man" href="../2/poll">poll(2)</a>, <a class="link-man" href="../2/read">read(2)</a>, <a class="link-man" href="../2/select">select(2)</a>, <a class="link-man" href="../2/sigaction">sigaction(2)</a>, <a class="link-man" href="../2/write">write(2)</a>, <a class="link-man" href="../3/signal">signal(3)</a>, <a class="link-man" href="../9/kfilter_register">kfilter_register(9)</a>, <a class="link-man" href="../9/knote">knote(9)</a><p>
<span class="ref"><span class="ref-auth">Jonathan Lemon</span>, <span class="ref-title">Kqueue: A Generic and Scalable Event Notification Facility</span>, <i class="ref-book">Proceedings of the FREENIX Track: 2001 USENIX Annual Technical Conference</i>, <i class="ref-issue">USENIX Association</i>, <a class="link-ref" href="http://www.usenix.org/event/usenix01/freenix01/full_papers/lemon/lemon.pdf">http://www.usenix.org/event/usenix01/freenix01/full_papers/lemon/lemon.pdf</a>, <span class="ref-date">June 25-30, 2001</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">kqueue</b>() and <b class="fname">kevent</b>() functions first appeared in <span class="unix">FreeBSD&#160;4.1</span>, and then in <span class="unix">NetBSD&#160;2.0</span>. The <b class="fname">kqueue1</b>() function first appeared in <span class="unix">NetBSD&#160;6.0</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
March 2, 2015</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

