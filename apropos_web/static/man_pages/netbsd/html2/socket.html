<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
SOCKET(2)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
SOCKET(2)</td>
<td class="head-vol" align="center">
System Calls Manual</td>
<td class="head-rtitle" align="right">
SOCKET(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">socket</b> &#8212; <span class="desc">create an endpoint for communication</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/socket.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">socket</b>(<i class="farg" style="white-space:nowrap;">int domain</i>, <i class="farg" style="white-space:nowrap;">int type</i>, <i class="farg" style="white-space:nowrap;">int protocol</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">socket</b>() creates an endpoint for communication and returns a descriptor.<p>
The <i class="farg">domain</i> parameter specifies a communications domain within which communication will take place; this selects the protocol family which should be used. These families are defined in the include file &#60;<i class="file">sys/socket.h</i>&#62;. The currently understood formats are:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
PF_LOCAL	local (previously UNIX) domain protocols 
PF_INET		ARPA Internet protocols 
PF_INET6	IPv6 (Internet Protocol version 6) protocols 
PF_NS		Xerox Network Systems protocols 
PF_APPLETALK	AppleTalk protocols 
PF_BLUETOOTH	Bluetooth protocols</pre>
<p>
The socket has the indicated <i class="farg">type</i>, which specifies the semantics of communication. Currently defined types are:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
SOCK_STREAM 
SOCK_DGRAM 
SOCK_RAW 
SOCK_SEQPACKET 
SOCK_RDM</pre>
<p>
The following flags can be or'ed to the type to condition the returned file descriptor: The following flags are valid:<table style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-col">
<col style="min-width: 13.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">SOCK_CLOEXEC</span> Set the close on exec property.</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">SOCK_NONBLOCK</span> Sets non-blocking I/O.</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">SOCK_NOSIGPIPE</span> Return <span class="errno">EPIPE</span> instead of raising <span class="define">SIGPIPE</span>.</td>
</tr>
</tbody>
</table>
<p>
A <span class="define">SOCK_STREAM</span> type provides sequenced, reliable, two-way connection based byte streams. An out-of-band data transmission mechanism may be supported. A <span class="define">SOCK_DGRAM</span> socket supports datagrams (connectionless, unreliable messages of a fixed (typically small) maximum length). A <span class="define">SOCK_SEQPACKET</span> socket may provide a sequenced, reliable, two-way connection-based data transmission path for datagrams of fixed maximum length; a consumer may be required to read an entire packet with each read system call. This facility is protocol specific, and presently implemented only for <span class="define">PF_NS</span>. <span class="define">SOCK_RAW</span> sockets provide access to internal network protocols and interfaces. The types <span class="define">SOCK_RAW</span>, which is available only to the super-user, and <span class="define">SOCK_RDM</span>, which is planned, but not yet implemented, are not described here.<p>
The <i class="farg">protocol</i> specifies a particular protocol to be used with the socket. Normally only a single protocol exists to support a particular socket type within a given protocol family. However, it is possible that many protocols may exist, in which case a particular protocol must be specified in this manner. The protocol number to use is particular to the &#8220;communication domain&#8221; in which communication is to take place; see <a class="link-man" href="../5/protocols">protocols(5)</a>.<p>
Sockets of type <span class="define">SOCK_STREAM</span> are full-duplex byte streams. A stream socket must be in a <span class="emph">connected</span> state before any data may be sent or received on it. A connection to another socket is created with a <a class="link-man" href="../2/connect">connect(2)</a> call. Once connected, data may be transferred using <a class="link-man" href="../2/read">read(2)</a> and <a class="link-man" href="../2/write">write(2)</a> calls or some variant of the <a class="link-man" href="../2/send">send(2)</a> and <a class="link-man" href="../2/recv">recv(2)</a> calls. When a session has been completed a <a class="link-man" href="../2/close">close(2)</a> may be performed. Out-of-band data may also be transmitted as described in <a class="link-man" href="../2/send">send(2)</a> and received as described in <a class="link-man" href="../2/recv">recv(2)</a>.<p>
The communications protocols used to implement a <span class="define">SOCK_STREAM</span> ensure that data is not lost or duplicated. If a piece of data for which the peer protocol has buffer space cannot be successfully transmitted within a reasonable length of time, then the connection is considered broken and calls will indicate an error with &#45;1 returns and with <span class="errno">ETIMEDOUT</span> as the specific code in the global variable <b class="var">errno</b>. The protocols optionally keep sockets &#8220;warm&#8221; by forcing transmissions roughly every minute in the absence of other activity. An error is then indicated if no response can be elicited on an otherwise idle connection for an extended period (e.g., 5 minutes). A <span class="define">SIGPIPE</span> signal is raised if a process sends on a broken stream; this causes naive processes, which do not handle the signal, to exit.<p>
<span class="define">SOCK_SEQPACKET</span> sockets employ the same system calls as <span class="define">SOCK_STREAM</span> sockets. The only difference is that <a class="link-man" href="../2/read">read(2)</a> calls will return only the amount of data requested, and any remaining in the arriving packet will be discarded.<p>
<span class="define">SOCK_DGRAM</span> and <span class="define">SOCK_RAW</span> sockets allow sending of datagrams to correspondents named in <a class="link-man" href="../2/send">send(2)</a> calls. Datagrams are generally received with <a class="link-man" href="../2/recvfrom">recvfrom(2)</a>, which returns the next datagram with its return address.<p>
An <a class="link-man" href="../2/fcntl">fcntl(2)</a> call can be used to specify a process group to receive a <span class="define">SIGURG</span> signal when the out-of-band data arrives. It may also enable non-blocking I/O and asynchronous notification of I/O events via <span class="define">SIGIO</span>.<p>
The operation of sockets is controlled by socket level <span class="emph">options</span>. These options are defined in the file &#60;<i class="file">sys/socket.h</i>&#62;. The <a class="link-man" href="../2/setsockopt">setsockopt(2)</a> and <a class="link-man" href="../2/getsockopt">getsockopt(2)</a> system calls are used to set and get options, respectively.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> A &#45;1 is returned if an error occurs, otherwise the return value is a descriptor referencing the socket.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> The <b class="fname">socket</b>() call fails if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EACCES</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Permission to create a socket of the specified type and/or protocol is denied.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EAFNOSUPPORT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The address family (domain) is not supported or the specified domain is not supported by this protocol family.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EMFILE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The per-process descriptor table is full.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENFILE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The system file table is full.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOBUFS</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Insufficient buffer space is available. The socket cannot be created until sufficient resources are freed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EPROTONOSUPPORT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The protocol family is not supported or the specified protocol is not supported within this domain.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EPROTOTYPE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The socket type is not supported by the protocol.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/accept">accept(2)</a>, <a class="link-man" href="../2/bind">bind(2)</a>, <a class="link-man" href="../2/connect">connect(2)</a>, <a class="link-man" href="../2/getsockname">getsockname(2)</a>, <a class="link-man" href="../2/getsockopt">getsockopt(2)</a>, <a class="link-man" href="../2/ioctl">ioctl(2)</a>, <a class="link-man" href="../2/listen">listen(2)</a>, <a class="link-man" href="../2/poll">poll(2)</a>, <a class="link-man" href="../2/read">read(2)</a>, <a class="link-man" href="../2/recv">recv(2)</a>, <a class="link-man" href="../2/select">select(2)</a>, <a class="link-man" href="../2/send">send(2)</a>, <a class="link-man" href="../2/setsockopt">setsockopt(2)</a>, <a class="link-man" href="../2/shutdown">shutdown(2)</a>, <a class="link-man" href="../2/socketpair">socketpair(2)</a>, <a class="link-man" href="../2/write">write(2)</a>, <a class="link-man" href="../3/getprotoent">getprotoent(3)</a><p>
<span class="ref"><span class="ref-auth">Stuart Sechrest</span>, <span class="ref-title">An Introductory 4.4BSD Interprocess Communication Tutorial</span>.</span> (see <i class="file">/usr/share/doc/psd/20.ipctut</i>)<p>
<span class="ref"><span class="ref-auth">Samuel J. Leffler</span>, <span class="ref-auth">Robert S. Fabry</span>, <span class="ref-auth">William N. Joy</span>, <span class="ref-auth">Phil Lapsley</span>, <span class="ref-auth">Steve Miller</span>, and <span class="ref-auth">Chris Torek</span>, <span class="ref-title">Advanced 4.4BSD IPC Tutorial</span>.</span> (see <i class="file">/usr/share/doc/psd/21.ipc</i>)</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">socket</b>() function call appeared in <span class="unix">4.2BSD</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
February 5, 2013</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

