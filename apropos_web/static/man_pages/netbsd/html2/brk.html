<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
BRK(2)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
BRK(2)</td>
<td class="head-vol" align="center">
System Calls Manual</td>
<td class="head-rtitle" align="right">
BRK(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">brk</b>, <b class="name">sbrk</b> &#8212; <span class="desc">change data segment size</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">unistd.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">brk</b>(<i class="farg" style="white-space:nowrap;">void *addr</i>);<p>
<i class="ftype">void *</i><br>
<b class="fname">sbrk</b>(<i class="farg" style="white-space:nowrap;">intptr_t incr</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1><div class="symb" style="display:inline;margin-left: 1.00ex;">
The brk and sbrk functions are legacy interfaces from before the advent of modern virtual memory management.</div>
<p>
The <b class="fname">brk</b>() and <b class="fname">sbrk</b>() functions are used to change the amount of memory allocated in a process's data segment. They do this by moving the location of the &#8220;break&#8221;. The break is the first address after the end of the process's uninitialized data segment (also known as the &#8220;BSS&#8221;).<p>
While the actual process data segment size maintained by the kernel will only grow or shrink in page sizes, these functions allow setting the break to unaligned values (i.e. it may point to any address inside the last page of the data segment).<p>
The <b class="fname">brk</b>() function sets the break to <i class="farg">addr</i>.<p>
The <b class="fname">sbrk</b>() function raises the break by at least <i class="farg">incr</i> bytes, thus allocating at least <i class="farg">incr</i> bytes of new memory in the data segment. If <i class="farg">incr</i> is negative, the break is lowered by <i class="farg">incr</i> bytes.<p>
<b class="fname">sbrk</b>() returns the prior address of the break. The current value of the program break may be determined by calling <b class="fname">sbrk</b>(<i class="farg">0</i>). (See also <a class="link-man" href="../3/end">end(3)</a>).<p>
The <a class="link-man" href="../2/getrlimit">getrlimit(2)</a> system call may be used to determine the maximum permissible size of the <span class="emph">data</span> segment; it will not be possible to set the break beyond the <span class="define">RLIMIT_DATA</span> <span class="emph">rlim_max</span> value returned from a call to <a class="link-man" href="../2/getrlimit">getrlimit(2)</a>, e.g. &#8220;etext + rlim.rlim_max&#8221;. (see <a class="link-man" href="../3/end">end(3)</a> for the definition of <span class="emph">etext</span>).</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">brk</b>() returns 0 if successful; otherwise &#45;1 with <b class="var">errno</b> set to indicate why the allocation failed.<p>
The <b class="fname">sbrk</b>() function returns the prior break value if successful; otherwise ((void *)&#45;1) is returned and <b class="var">errno</b> is set to indicate why the allocation failed.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">brk</b>() or <b class="fname">sbrk</b>() will fail and no additional memory will be allocated if one of the following are true:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOMEM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The limit, as set by <a class="link-man" href="../2/setrlimit">setrlimit(2)</a>, was exceeded.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOMEM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The maximum possible size of a data segment (compiled into the system) was exceeded.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOMEM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Insufficient space existed in the swap area to support the expansion.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/execve">execve(2)</a>, <a class="link-man" href="../2/getrlimit">getrlimit(2)</a>, <a class="link-man" href="../2/mmap">mmap(2)</a>, <a class="link-man" href="../3/end">end(3)</a>, <a class="link-man" href="../3/free">free(3)</a>, <a class="link-man" href="../3/malloc">malloc(3)</a>, <a class="link-man" href="../3/sysconf">sysconf(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> A <b class="fname">brk</b>() function call appeared in Version&#160;7 AT&amp;T UNIX.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Note that mixing <b class="fname">brk</b>() and <b class="fname">sbrk</b>() with <a class="link-man" href="../3/malloc">malloc(3)</a>, <a class="link-man" href="../3/free">free(3)</a>, and similar functions may result in non-portable program behavior. Caution is advised.<p>
Setting the break may fail due to a temporary lack of swap space. It is not possible to distinguish this from a failure caused by exceeding the maximum size of the data segment without consulting <a class="link-man" href="../2/getrlimit">getrlimit(2)</a>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
July 12, 1999</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

