<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
CLONE(2)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
CLONE(2)</td>
<td class="head-vol" align="center">
System Calls Manual</td>
<td class="head-rtitle" align="right">
CLONE(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">clone</b>, <b class="name">__clone</b> &#8212; <span class="desc">spawn new process with options</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sched.h</a>&gt;</b><p>
<i class="ftype">pid_t</i><br>
<b class="fname">clone</b>(<i class="farg" style="white-space:nowrap;">int (*func)(void *arg)</i>, <i class="farg" style="white-space:nowrap;">void *stack</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">void *arg</i>);<p>
<i class="ftype">pid_t</i><br>
<b class="fname">__clone</b>(<i class="farg" style="white-space:nowrap;">int (*func)(void *arg)</i>, <i class="farg" style="white-space:nowrap;">void *stack</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">void *arg</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">clone</b> system call (and associated library support code) creates a new process in a way that allows the caller to specify several options for the new process creation.<p>
Unlike <a class="link-man" href="../2/fork">fork(2)</a> or <a class="link-man" href="../2/vfork">vfork(2)</a>, in which the child process returns to the call site, <b class="name">clone</b> causes the child process to begin execution at the function specified by <i class="arg">func</i>. The argument <i class="arg">arg</i> is passed to the entry point, as a means for the parent to provide context to the child. The stack pointer for the child process will be set to <i class="arg">stack</i>. Note that the <b class="name">clone</b> interface requires that the application know the stack direction for the architecture, and that the caller initialize the <i class="arg">stack</i> argument as appropriate for the stack direction.<p>
The <i class="arg">flags</i> argument specifies several options that control how the child process is created. The lower 8 bits of <i class="arg">flags</i> specify the signal that is to be sent to the parent when the child exits. The following flags may also be specified by bitwise-or'ing them with the signal value:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 2.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">CLONE_VM</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Share the virtual address space with the parent. The address space is shared in the same way as <a class="link-man" href="../2/vfork">vfork(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">CLONE_FS</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Share the &#8220;file system information&#8221; with the parent. This include the current working directory and file creation mask.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">CLONE_FILES</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Share the file descriptor table with the parent.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">CLONE_SIGHAND</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Share the signal handler set with the parent. Note that the signal mask is never shared between the parent and the child, even if <span class="define">CLONE_SIGHAND</span> is set.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">CLONE_VFORK</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Preserve the synchronization semantics of <a class="link-man" href="../2/vfork">vfork(2)</a>; the parent blocks until the child exits.</dd>
</dl>
<p>
The <b class="name">clone</b> call returns the pid of the child in the parent's context. The child is provided no return value, since it begins execution at a different address.<p>
If the child process's entry point returns, the value it returns is passed to <a class="link-man" href="../2/_exit">_exit(2)</a>, and the child process exits. Note that if the child process wants to exit directly, it should use <a class="link-man" href="../2/_exit">_exit(2)</a>, and not <a class="link-man" href="../3/exit">exit(3)</a>, since <a class="link-man" href="../3/exit">exit(3)</a> will flush and close standard I/O channels, and thereby corrupt the parent process's standard I/O data structures (even with <a class="link-man" href="../2/fork">fork(2)</a> it is wrong to call <a class="link-man" href="../3/exit">exit(3)</a> since buffered data would then be flushed twice).<p>
Note that <b class="name">clone</b> is not intended to be used for new native <span class="unix">NetBSD</span> applications. It is provided as a means to port software originally written for the Linux operating system to <span class="unix">NetBSD</span>.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Same as for <a class="link-man" href="../2/fork">fork(2)</a>.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> Same as for <a class="link-man" href="../2/fork">fork(2)</a>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/chdir">chdir(2)</a>, <a class="link-man" href="../2/chroot">chroot(2)</a>, <a class="link-man" href="../2/fork">fork(2)</a>, <a class="link-man" href="../2/sigaction">sigaction(2)</a>, <a class="link-man" href="../2/sigprocmask">sigprocmask(2)</a>, <a class="link-man" href="../2/umask">umask(2)</a>, <a class="link-man" href="../2/vfork">vfork(2)</a>, <a class="link-man" href="../2/wait">wait(2)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">clone</b>() function call appeared in <span class="unix">NetBSD&#160;1.6</span>. It is compatible with the Linux function call of the same name with respect to the described options.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The <span class="unix">NetBSD</span> implementation of <b class="fname">clone</b>() does not implement the following <i class="arg">flags</i> that are present in the Linux implementation:<p>
<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-bul">
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_CHILD_CLEARTID</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_CHILD_SETTID</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_IO</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_NEWIPC</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_NEWNET</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_NEWNS</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_NEWPID</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_NEWUTS</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_PARENT</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_PARENT_SETTID</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_PID</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_PTRACE</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_SETTLS</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_STOPPED</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_SYSVSEM</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_THREAD</span></li>
<li class="list-bul" style="margin-top: 0.00em;">
<span class="define">CLONE_UNTRACED</span></li>
</ul>
</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 4, 2010</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

