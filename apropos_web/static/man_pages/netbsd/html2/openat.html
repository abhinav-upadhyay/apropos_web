<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
OPEN(2)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
OPEN(2)</td>
<td class="head-vol" align="center">
System Calls Manual</td>
<td class="head-rtitle" align="right">
OPEN(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">open</b>, <b class="name">openat</b> &#8212; <span class="desc">open or create a file for reading or writing</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">fcntl.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">open</b>(<i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">...</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">openat</b>(<i class="farg" style="white-space:nowrap;">int fd</i>, <i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">...</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The file name specified by <i class="farg">path</i> is opened for reading and/or writing as specified by the argument <i class="farg">flags</i> and the file descriptor returned to the calling process.<p>
<b class="fname">openat</b>() works the same way as <b class="fname">open</b>() except if <i class="farg">path</i> is relative. In that case, it is looked up from a directory whose file descriptor was passed as <i class="farg">fd</i>. Search permission is required on this directory. <i class="farg">fd</i> can be set to <span class="define">AT_FDCWD</span> in order to specify the current directory.<p>
The <i class="farg">flags</i> are specified by <span class="emph">or</span>'ing the values listed below. Applications must specify exactly one of the first three values (file access methods):<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_RDONLY</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Open for reading only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_WRONLY</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Open for writing only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_RDWR</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Open for reading and writing.</dd>
</dl>
<p>
Any combination of the following may be used:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_NONBLOCK</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Do not block on open or for data to become available.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_APPEND</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Append to the file on each write.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_CREAT</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Create the file if it does not exist. The third argument of type <i class="ftype">mode_t</i> is used to compute the mode bits of the file as described in <a class="link-man" href="../2/chmod">chmod(2)</a> and modified by the process' umask value (see <a class="link-man" href="../2/umask">umask(2)</a>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_TRUNC</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Truncate size to 0.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_EXCL</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Error if <span class="define">O_CREAT</span> and the file already exists.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_SHLOCK</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Atomically obtain a shared lock.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_EXLOCK</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Atomically obtain an exclusive lock.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_NOFOLLOW</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
If last path element is a symlink, don't follow it. This option is provided for compatibility with other operating systems, but its security value is questionable.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_CLOEXEC</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Set the <a class="link-man" href="../2/close">close(2)</a> on <a class="link-man" href="../3/exec">exec(3)</a> flag.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_NOSIGPIPE</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Return <span class="errno">EPIPE</span> instead of raising <span class="define">SIGPIPE</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_DSYNC</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
If set, write operations will be performed according to synchronized I/O data integrity completion: each write will wait for the file data to be committed to stable storage.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_SYNC</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
If set, write operations will be performed according to synchronized I/O file integrity completion: each write will wait for both the file data and file status to be committed to stable storage.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_RSYNC</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
If set, read operations will complete at the same level of integrity which is in effect for write operations: if specified together with <span class="define">O_SYNC</span>, each read will wait for the file status to be committed to stable storage.<p>
Combining <span class="define">O_RSYNC</span> with <span class="define">O_DSYNC</span> only, or specifying it without any other synchronized I/O integrity completion flag set, has no further effect.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_ALT_IO</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Alternate I/O semantics will be used for read and write operations on the file descriptor. Alternate semantics are defined by the underlying layers and will not have any alternate effect in most cases.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_NOCTTY</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
If the file is a terminal device, the opened device is not made the controlling terminal for the session. This flag has no effect on <span class="unix">NetBSD</span>, since the system defaults to the abovementioned behaviour. The flag is present only for standards conformance.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_DIRECT</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
If set on a regular file, data I/O operations will not buffer the data being transferred in the kernel's cache, but rather transfer the data directly between user memory and the underlying device driver if possible. This flag is advisory; the request may be performed in the normal buffered fashion if certain conditions are not met, e.g. if the request is not sufficiently aligned or if the file is mapped.<p>
To meet the alignment requirements for direct I/O, the file offset, the length of the I/O and the address of the buffer in memory must all be multiples of <span class="define">DEV_BSIZE</span> (512 bytes). If the I/O request is made using an interface that supports scatter/gather via struct iovec, each element of the request must meet the above alignment constraints.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_DIRECTORY</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Fail if the file is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">O_ASYNC</span></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Enable the <span class="define">SIGIO</span> signal to be sent to the process group when I/O is possible, e.g., upon availability of data to be read.</dd>
</dl>
<p>
Opening a file with <span class="define">O_APPEND</span> set causes each write on the file to be appended to the end. If <span class="define">O_TRUNC</span> is specified and the file exists, the file is truncated to zero length.<p>
If <span class="define">O_EXCL</span> is set with <span class="define">O_CREAT</span> and the file already exists, <b class="fname">open</b>() returns an error. This may be used to implement a simple exclusive access locking mechanism. If <span class="define">O_EXCL</span> is set and the last component of the pathname is a symbolic link, <b class="fname">open</b>() will fail even if the symbolic link points to a non-existent name.<p>
If the <span class="define">O_NONBLOCK</span> flag is specified, do not wait for the device or file to be ready or available. If the <b class="fname">open</b>() call would result in the process being blocked for some reason (e.g., waiting for carrier on a dialup line), <b class="fname">open</b>() returns immediately. This flag also has the effect of making all subsequent I/O on the open file non-blocking.<p>
When opening a file, a lock with <a class="link-man" href="../2/flock">flock(2)</a> semantics can be obtained by setting <span class="define">O_SHLOCK</span> for a shared lock, or <span class="define">O_EXLOCK</span> for an exclusive lock. If creating a file with <span class="define">O_CREAT</span>, the request for the lock will never fail (provided that the underlying filesystem supports locking).<p>
If <b class="fname">open</b>() is successful, the file pointer used to mark the current position within the file is set to the beginning of the file.<p>
When a new file is created it is given the group of the directory which contains it.<p>
The new descriptor is set to remain open across <a class="link-man" href="../2/execve">execve(2)</a> system calls; see <a class="link-man" href="../2/close">close(2)</a> and <a class="link-man" href="../2/fcntl">fcntl(2)</a>.<p>
The system imposes a limit on the number of file descriptors open simultaneously by one process. Calling <a class="link-man" href="../3/getdtablesize">getdtablesize(3)</a> returns the current system limit.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> If successful, <b class="fname">open</b>() and <b class="fname">openat</b>() returns a non-negative integer, termed a file descriptor. Otherwise, a value of &#45;1 is returned and <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> The named file is opened unless:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EACCES</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Search permission is denied for a component of the path prefix, the required permissions (for reading and/or writing) are denied for the given flags, or <span class="define">O_CREAT</span> is specified, the file does not exist, and the directory in which it is to be created does not permit writing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EDQUOT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> is specified, the file does not exist, and the directory in which the entry for the new file is being placed cannot be extended because the user's quota of disk blocks on the file system containing the directory has been exhausted; or <span class="define">O_CREAT</span> is specified, the file does not exist, and the user's quota of inodes on the file system on which the file is being created has been exhausted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EEXIST</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> and <span class="define">O_EXCL</span> were specified and the file exists.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">path</i> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFTYPE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_NOFOLLOW</span> was specified, but the last path component is a symlink. <span class="emph">Note</span>: IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;) specifies returning &#91;<span class="errno">ELOOP</span>&#93; for this case.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINTR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <b class="fname">open</b>() operation was interrupted by a signal.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while making the directory entry or allocating the inode for <span class="define">O_CREAT</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EISDIR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file is a directory, and the arguments specify it is to be opened for writing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ELOOP</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating the pathname.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EMFILE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The process has already reached its limit for open file descriptors.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENAMETOOLONG</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded &#123;<span class="define">NAME_MAX</span>&#125; characters, or an entire path name exceeded &#123;<span class="define">PATH_MAX</span>&#125; characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENFILE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The system file table is full.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> is not set and the named file does not exist, or a component of the path name that must exist does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOSPC</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> is specified, the file does not exist, and the directory in which the entry for the new file is being placed cannot be extended because there is no space left on the file system containing the directory; or <span class="define">O_CREAT</span> is specified, the file does not exist, and there are no free inodes on the file system on which the file is being created.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOTDIR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of the path prefix is not a directory; or <span class="define">O_DIRECTORY</span> is specified and the last path component is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENXIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file is a character special or block special file, and the device associated with this special file does not exist, or the named file is a FIFO, <span class="define">O_NONBLOCK</span> and <span class="define">O_WRONLY</span> is set and no process has the file open for reading.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EOPNOTSUPP</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_SHLOCK</span> or <span class="define">O_EXLOCK</span> is specified but the underlying filesystem does not support locking; or an attempt was made to open a socket (not currently implemented).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EPERM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The file's flags (see <a class="link-man" href="../2/chflags">chflags(2)</a>) don't allow the file to be opened.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EROFS</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file resides on a read-only file system, and the file is to be modified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ETXTBSY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The file is a pure procedure (shared text) file that is being executed and the <b class="fname">open</b>() call requests write access.</dd>
</dl>
<p>
In addition, <b class="fname">openat</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBADF</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">path</i> does not specify an absolute path and <i class="farg">fd</i> is neither <span class="define">AT_FDCWD</span> nor a valid file descriptor open for reading or searching.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOTDIR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">path</i> is not an absolute path and <i class="farg">fd</i> is a file descriptor associated with a non-directory file.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/chmod">chmod(2)</a>, <a class="link-man" href="../2/close">close(2)</a>, <a class="link-man" href="../2/dup">dup(2)</a>, <a class="link-man" href="../2/faccessat">faccessat(2)</a>, <a class="link-man" href="../2/fchmodat">fchmodat(2)</a>, <a class="link-man" href="../2/fchownat">fchownat(2)</a>, <a class="link-man" href="../2/fstatat">fstatat(2)</a>, <a class="link-man" href="../2/linkat">linkat(2)</a>, <a class="link-man" href="../2/lseek">lseek(2)</a>, <a class="link-man" href="../2/mkdirat">mkdirat(2)</a>, <a class="link-man" href="../2/mkfifoat">mkfifoat(2)</a>, <a class="link-man" href="../2/mknodat">mknodat(2)</a>, <a class="link-man" href="../2/read">read(2)</a>, <a class="link-man" href="../2/readlinkat">readlinkat(2)</a>, <a class="link-man" href="../2/symlinkat">symlinkat(2)</a>, <a class="link-man" href="../2/umask">umask(2)</a>, <a class="link-man" href="../2/unlinkat">unlinkat(2)</a>, <a class="link-man" href="../2/utimensat">utimensat(2)</a>, <a class="link-man" href="../2/write">write(2)</a>, <a class="link-man" href="../3/getdtablesize">getdtablesize(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">open</b>() function conforms to IEEE Std 1003.1-1990 (&#8220;POSIX.1&#8221;). <b class="fname">openat</b>() conforms to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;).<p>
The <i class="farg">flags</i> values <span class="define">O_DSYNC</span>, <span class="define">O_SYNC</span> and <span class="define">O_RSYNC</span> are extensions defined in IEEE Std 1003.1b-1993 (&#8220;POSIX.1b&#8221;).<p>
The <span class="define">O_SHLOCK</span> and <span class="define">O_EXLOCK</span> flags are non-standard extensions and should not be used if portability is of concern.</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> An <b class="fname">open</b>() function call appeared in Version&#160;2 AT&amp;T UNIX.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
July 29, 2013</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

