<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
CHMOD(2)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
CHMOD(2)</td>
<td class="head-vol" align="center">
System Calls Manual</td>
<td class="head-rtitle" align="right">
CHMOD(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">chmod</b>, <b class="name">lchmod</b>, <b class="name">fchmod</b>, <b class="name">fchmodat</b> &#8212; <span class="desc">change mode of file</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/stat.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">chmod</b>(<i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">mode_t mode</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">lchmod</b>(<i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">mode_t mode</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">fchmod</b>(<i class="farg" style="white-space:nowrap;">int fd</i>, <i class="farg" style="white-space:nowrap;">mode_t mode</i>);<p>
<b class="includes">#include &lt;<a class="link-includes">sys/stat.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">fcntl.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">fchmodat</b>(<i class="farg" style="white-space:nowrap;">int fd</i>, <i class="farg" style="white-space:nowrap;">const char *path</i>, <i class="farg" style="white-space:nowrap;">mode_t mode</i>, <i class="farg" style="white-space:nowrap;">int flag</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The function <b class="fname">chmod</b>() sets the file permission bits of the file specified by the pathname <i class="farg">path</i> to <i class="farg">mode</i>. <b class="fname">fchmod</b>() sets the permission bits of the specified file descriptor <i class="farg">fd</i>. <b class="fname">lchmod</b>() is like <b class="fname">chmod</b>() except in the case where the named file is a symbolic link, in which case <b class="fname">lchmod</b>() sets the permission bits of the link, while <b class="fname">chmod</b>() sets the bits of the file the link references.<p>
<b class="fname">fchmodat</b>() works the same way as <b class="fname">chmod</b>() (or <b class="fname">lchmod</b>() if <span class="define">AT_SYMLINK_NOFOLLOW</span> is set in <i class="farg">flag</i>) except if <i class="farg">path</i> is relative. In that case, it is looked up from a directory whose file descriptor was passed as <i class="farg">fd</i>. Search permission is required on this directory. <i class="farg">fd</i> except if that file descriptor was opened with the <span class="define">O_SEARCH</span> flag. <i class="farg">fd</i> can be set to <span class="define">AT_FDCWD</span> in order to specify the current directory.<p>
<b class="fname">chmod</b>() verifies that the process owner (user) either owns the file specified by <i class="farg">path</i> (or <i class="farg">fd</i>), or is the super-user. A mode is created from <span class="emph">or'd</span> permission bit masks defined in <b class="includes">&lt;<a class="link-includes">sys/stat.h</a>&gt;</b>:<pre style="margin-left: 5.00ex;" class="lit display">
#define S_IRWXU 0000700    /* RWX mask for owner */ 
#define S_IRUSR 0000400    /* R for owner */ 
#define S_IWUSR 0000200    /* W for owner */ 
#define S_IXUSR 0000100    /* X for owner */ 
 
#define S_IRWXG 0000070    /* RWX mask for group */ 
#define S_IRGRP 0000040    /* R for group */ 
#define S_IWGRP 0000020    /* W for group */ 
#define S_IXGRP 0000010    /* X for group */ 
 
#define S_IRWXO 0000007    /* RWX mask for other */ 
#define S_IROTH 0000004    /* R for other */ 
#define S_IWOTH 0000002    /* W for other */ 
#define S_IXOTH 0000001    /* X for other */ 
 
#define S_ISUID 0004000    /* set user id on execution */ 
#define S_ISGID 0002000    /* set group id on execution */ 
#define S_ISVTX 0001000    /* sticky bit */</pre>
<p>
The mode <span class="define">ISVTX</span> (the &#8216;sticky bit&#8217;) can be set on regular files, but has no effect. For historical reasons this can be done only by the super-user.<p>
If mode <span class="define">ISVTX</span> (the &#8216;sticky bit&#8217;) is set on a directory, an unprivileged user may not delete or rename files of other users in that directory. The sticky bit may be set by any user on a directory which the user owns or has appropriate permissions.<p>
For more information about the history and properties of the sticky bit, see <a class="link-man" href="../7/sticky">sticky(7)</a>.<p>
Changing the owner of a file turns off the set-user-id and set-group-id bits; writing to a file turns off the set-user-id and set-group-id bits unless the user is the super-user. This makes the system somewhat more secure by protecting set-user-id (set-group-id) files from remaining set-user-id (set-group-id) if they are modified, at the expense of a degree of compatibility.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> The <b class="fname">chmod</b>(), <b class="fname">lchmod</b>(), <b class="fname">fchmod</b>(), and <b class="fname">fchmodat</b>() functions return the value 0 if successful; otherwise the value -1 is returned and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">chmod</b>(), <b class="fname">lchmod</b>() and <b class="fname">fchmodat</b>() will fail and the file mode will be unchanged if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EACCES</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Search permission is denied for a component of the path prefix.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">path</i> points outside the process's allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFTYPE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The effective user ID is not the super-user, the <i class="farg">mode</i> includes the sticky bit (<span class="define">S_ISVTX</span>), and <i class="farg">path</i> does not refer to a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading from or writing to the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ELOOP</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Too many symbolic links were encountered in translating the pathname.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENAMETOOLONG</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of a pathname exceeded &#123;<span class="define">NAME_MAX</span>&#125; characters, or an entire path name exceeded &#123;<span class="define">PATH_MAX</span>&#125; characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOTDIR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A component of the path prefix is not a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EPERM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The effective user ID does not match the owner of the file and the effective user ID is not the super-user; or the mode includes the setgid bit (<span class="define">S_ISGID</span>) but the file's group is neither the effective group ID nor is it in the group access list.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EROFS</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named file resides on a read-only file system.</dd>
</dl>
<p>
In addition, <b class="fname">fchmodat</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBADF</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">path</i> does not specify an absolute path and <i class="farg">fd</i> is neither <span class="define">AT_FDCWD</span> nor a valid file descriptor open for reading or searching.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOTDIR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">path</i> is not an absolute path and <i class="farg">fd</i> is a file descriptor associated with a non-directory file.</dd>
</dl>
<p>
<b class="fname">fchmod</b>() will fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBADF</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The descriptor is not valid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFTYPE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The effective user ID is not the super-user, the <i class="farg">mode</i> includes the sticky bit (<span class="define">S_ISVTX</span>), and <i class="farg">fd</i> does not refer to a directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">fd</i> refers to a socket, not to a file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error occurred while reading from or writing to the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EPERM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The effective user ID does not match the owner of the file and the effective user ID is not the super-user; or the mode includes the setgid bit (<span class="define">S_ISGID</span>) but the file's group is neither the effective group ID nor is it in the group access list.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EROFS</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The file resides on a read-only file system.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/chmod">chmod(1)</a>, <a class="link-man" href="../2/chflags">chflags(2)</a>, <a class="link-man" href="../2/chown">chown(2)</a>, <a class="link-man" href="../2/open">open(2)</a>, <a class="link-man" href="../2/stat">stat(2)</a>, <a class="link-man" href="../3/getmode">getmode(3)</a>, <a class="link-man" href="../3/setmode">setmode(3)</a>, <a class="link-man" href="../7/sticky">sticky(7)</a>, <a class="link-man" href="../7/symlink">symlink(7)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">chmod</b>() function conforms to IEEE Std 1003.1-1990 (&#8220;POSIX.1&#8221;). <b class="fname">fchmodat</b>() function conforms to IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">fchmod</b>() function call appeared in <span class="unix">4.2BSD</span>. The <b class="fname">lchmod</b>() function call appeared in <span class="unix">NetBSD&#160;1.3</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
July 29, 2013</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

