<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
FORK(2)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
FORK(2)</td>
<td class="head-vol" align="center">
System Calls Manual</td>
<td class="head-rtitle" align="right">
FORK(2)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">fork</b> &#8212; <span class="desc">create a new process</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">unistd.h</a>&gt;</b><p>
<i class="ftype">pid_t</i><br>
<b class="fname">fork</b>(<i class="farg" style="white-space:nowrap;">void</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">fork</b>() causes creation of a new process. The new process (child process) is an exact copy of the calling process (parent process) except for the following:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
The child process has a unique process ID.</li>
<li class="list-bul" style="margin-top: 1.00em;">
The child process has a different parent process ID (i.e., the process ID of the parent process).</li>
<li class="list-bul" style="margin-top: 1.00em;">
The child process has its own copy of the parent's descriptors. These descriptors reference the same underlying objects, so that, for instance, file pointers in file objects are shared between the child and the parent, so that an <a class="link-man" href="../2/lseek">lseek(2)</a> on a descriptor in the child process can affect a subsequent <a class="link-man" href="../2/read">read(2)</a> or <a class="link-man" href="../2/write">write(2)</a> by the parent. This descriptor copying is also used by the shell to establish standard input and output for newly created processes as well as to set up pipes.</li>
<li class="list-bul" style="margin-top: 1.00em;">
The child process' resource utilizations are set to 0; see <a class="link-man" href="../2/setrlimit">setrlimit(2)</a>.</li>
</ul>
<p>
In general, the child process should call <a class="link-man" href="../2/_exit">_exit(2)</a> rather than <a class="link-man" href="../3/exit">exit(3)</a>. Otherwise, any stdio buffers that exist both in the parent and child will be flushed twice. Similarly, <a class="link-man" href="../2/_exit">_exit(2)</a> should be used to prevent <a class="link-man" href="../3/atexit">atexit(3)</a> routines from being called twice (once in the parent and once in the child).<p>
In case of a threaded program, only the thread calling <b class="fname">fork</b>() is still running in the child processes.<p>
Child processes of a threaded program have additional restrictions, a child must only call functions that are async-signal-safe. Very few functions are asynchronously safe and applications should make sure they call <a class="link-man" href="../3/exec">exec(3)</a> as soon as possible.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, <b class="fname">fork</b>() returns a value of 0 to the child process and returns the process ID of the child process to the parent process. Otherwise, a value of &#45;1 is returned to the parent process, no child process is created, and the global variable <b class="var">errno</b> is set to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">fork</b>() will fail and no child process will be created if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EAGAIN</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The system-imposed limit on the total number of processes under execution would be exceeded. This limit is configuration-dependent.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EAGAIN</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The limit <span class="define">RLIMIT_NPROC</span> on the total number of processes under execution by this user id would be exceeded.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOMEM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
There is insufficient swap space for the new process.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/execve">execve(2)</a>, <a class="link-man" href="../2/setrlimit">setrlimit(2)</a>, <a class="link-man" href="../2/vfork">vfork(2)</a>, <a class="link-man" href="../2/wait">wait(2)</a>, <a class="link-man" href="../3/pthread_atfork">pthread_atfork(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">fork</b>() function conforms to IEEE Std 1003.1-1990 (&#8220;POSIX.1&#8221;).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> A <b class="fname">fork</b>() system call appeared in Version&#160;6 AT&amp;T UNIX.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
June 10, 2004</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

