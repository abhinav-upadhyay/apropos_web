<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
PTY(4)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
PTY(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual</td>
<td class="head-rtitle" align="right">
PTY(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">pty</b> &#8212; <span class="desc">pseudo terminal driver</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">pseudo-device pty</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">pty</b> driver provides support for a device-pair termed a <span class="emph">pseudo terminal</span>. A pseudo terminal is a pair of character devices, a <span class="emph">master</span> device and a <span class="emph">slave</span> device. The slave device provides to a process an interface identical to that described in <a class="link-man" href="../4/tty">tty(4)</a>. However, whereas all other devices which provide the interface described in <a class="link-man" href="../4/tty">tty(4)</a> have a hardware device of some sort behind them, the slave device has, instead, another process manipulating it through the master half of the pseudo terminal. That is, anything written on the master device is given to the slave device as input and anything written on the slave device is presented as input on the master device.<p>
Pseudo terminal pairs are allocated on as-needed basis, maximum number of them is controlled via <span class="emph">kern.maxptys</span> sysctl (defaults to 992).<p>
The following <a class="link-man" href="../2/ioctl">ioctl(2)</a> calls apply only to pseudo terminals:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCEXT</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Enable/disable &#8220;external processing&#8221;. This affects delivery of <span class="define">TIOCPKT_IOCTL</span> packets. External processing is enabled by specifying (by reference) a nonzero <span class="type">int</span> parameter and disabled by specifying (by reference) a zero <span class="type">int</span> parameter.<p>
<span class="define">TIOCEXT</span> is reset to its default (disabled) when the slave closes the <b class="name">pty</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCSTOP</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Stops output to a terminal (e.g. like typing &#8216;<code class="lit">^S</code>&#8217;). Takes no parameter.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCSTART</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Restarts output (stopped by <span class="define">TIOCSTOP</span> or by typing &#8216;<code class="lit">^S</code>&#8217;). Takes no parameter.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Enable/disable <span class="emph">packet</span> mode. Packet mode is enabled by specifying (by reference) a nonzero <span class="type">int</span> parameter and disabled by specifying (by reference) a zero <span class="type">int</span> parameter. When applied to the master side of a pseudo terminal, each subsequent <a class="link-man" href="../2/read">read(2)</a> from the terminal will return data written on the slave part of the pseudo terminal preceded by a zero byte (symbolically defined as <span class="define">TIOCPKT_DATA</span>), or a single byte reflecting control status information. In the latter case, the byte is an inclusive-or of zero or more of the bits:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_FLUSHREAD</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever the read queue for the terminal is flushed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_FLUSHWRITE</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever the write queue for the terminal is flushed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_STOP</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever output to the terminal is stopped a la &#8216;<code class="lit">^S</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_START</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever output to the terminal is restarted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_DOSTOP</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever <span class="emph">t_stopc</span> is &#8216;<code class="lit">^S</code>&#8217; and <span class="emph">t_startc</span> is &#8216;<code class="lit">^Q</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_NOSTOP</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
whenever the start and stop characters are not &#8216;<code class="lit">^S/^Q</code>&#8217;.<p>
While this mode is in use, the presence of control status information to be read from the master side may be detected by a <a class="link-man" href="../2/select">select(2)</a> for exceptional conditions.<p>
This mode is used by <a class="link-man" href="../1/rlogin">rlogin(1)</a> and <a class="link-man" href="../8/rlogind">rlogind(8)</a> to implement a remote-echoed, locally &#8216;<code class="lit">^S/^Q</code>&#8217; flow-controlled remote login with proper back-flushing of output; it can be used by other similar programs.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCPKT_IOCTL</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
When this bit is set, the slave has changed the <a class="link-man" href="../4/termios">termios(4)</a> structure (TTY state), and the remainder of the data read from the master side of the <b class="name">pty</b> is the new <a class="link-man" href="../4/termios">termios(4)</a> structure. The master side of the <b class="name">pty</b> can also use <a class="link-man" href="../3/tcgetattr">tcgetattr(3)</a> to read the new <a class="link-man" href="../4/termios">termios(4)</a> structure.<p>
The master will not read packets with the bit <span class="define">TIOCPKT_IOCTL</span> set until it has activated &#8220;external processing&#8221; using <span class="define">TIOCEXT</span>.<p>
This is used by <a class="link-man" href="../8/telnetd">telnetd(8)</a> to implement TELNET "line mode" - it allows the <a class="link-man" href="../8/telnetd">telnetd(8)</a> to detect <a class="link-man" href="../4/tty">tty(4)</a> state changes by the slave, and negotiate the appropriate TELNET protocol equivalents with the remote peer.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCUCNTL</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Enable/disable a mode that allows a small number of simple user <a class="link-man" href="../2/ioctl">ioctl(2)</a> commands to be passed through the pseudo-terminal, using a protocol similar to that of <span class="define">TIOCPKT</span>. The <span class="define">TIOCUCNTL</span> and <span class="define">TIOCPKT</span> modes are mutually exclusive. This mode is enabled from the master side of a pseudo terminal by specifying (by reference) a nonzero <span class="type">int</span> parameter and disabled by specifying (by reference) a zero <span class="type">int</span> parameter. Each subsequent <a class="link-man" href="../2/read">read(2)</a> from the master side will return data written on the slave part of the pseudo terminal preceded by a zero byte, or a single byte reflecting a user control operation on the slave side. A user control command consists of a special <a class="link-man" href="../2/ioctl">ioctl(2)</a> operation with no data; the command is given as <span class="define">UIOCCMD</span>(n), where <i class="arg">n</i> is a number in the range 1-255. The operation value <i class="arg">n</i> will be received as a single byte on the next <a class="link-man" href="../2/read">read(2)</a> from the master side. The <a class="link-man" href="../2/ioctl">ioctl(2)</a> <span class="define">UIOCCMD</span>(0) is a no-op that may be used to probe for the existence of this facility. As with <span class="define">TIOCPKT</span> mode, command operations may be detected with a <a class="link-man" href="../2/select">select(2)</a> for exceptional conditions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIOCREMOTE</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
A mode for the master half of a pseudo terminal, independent of <span class="define">TIOCPKT</span>. This mode causes input to the pseudo terminal to be flow controlled and not input edited (regardless of the terminal mode). Each write to the control terminal produces a record boundary for the process reading the terminal. In normal usage, a write of data is like the data typed as a line on the terminal; a write of 0 bytes is like typing an end-of-file character. <span class="define">TIOCREMOTE</span> can be used when doing remote line editing in a window manager, or whenever flow controlled input is required.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/pty[p-zP-T][0-9a-zA-Z]</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
master pseudo terminals</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/tty[p-zP-T][0-9a-zA-Z]</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
slave pseudo terminals</dd>
</dl>
</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> None.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/ioctl">ioctl(2)</a>, <a class="link-man" href="../2/read">read(2)</a>, <a class="link-man" href="../2/select">select(2)</a>, <a class="link-man" href="../2/write">write(2)</a>, <a class="link-man" href="../3/openpty">openpty(3)</a>, <a class="link-man" href="../4/tty">tty(4)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">pty</b> driver appeared in <span class="unix">4.2BSD</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
November 30, 2013</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

