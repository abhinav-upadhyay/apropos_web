<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="..//static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
RF(4) (VAX)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
RF(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual (VAX)</td>
<td class="head-rtitle" align="right">
RF(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">rf</b> &#8212; <span class="desc">DEC RX01 / RX02 floppy disk interface</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">rfc0 at uba? csr 0177170     # RX01/RX02 controller</b><br>
<b class="config">rf*  at rfc? drive?          # RX01/RX02 floppy disk drive</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">rf</b> device provides access to DEC RX01 and RX02 floppy disk drives and clones thereof. These drives use preformatted 8" single sided, soft sectored media. The RX01 and RX02 drives use a geometry of 77 cylinders, one head and 26 sectors. Each sector contains 128 bytes in case of single density ( RX01 and RX02 in RX01 mode) or 256 bytes in double density mode. As <span class="unix">NetBSD</span> is not able to handle non-512 byte media the driver translates this to a geometry of 50 cylinders, one head and 10 sectors in single density and 77 cylinders, one head and 13 sectors in double density mode. While the later matches the total number of sectors, the fake geometry in single density does not cover the last two physical sectors exact, but it is possible to access this sectors at 512 byte LBN 501. When a 512 byte block is written to LBN 501 the last 256 bytes are ignored. When this 512 byte block is read the last 256 bytes contain undefined data.<p>
This driver supports three minor devices corresponding to the slices:<table style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-col">
<col style="min-width: 5.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Slice</span></td>
<td class="list-col" style="margin-top: 1.00em;">
Description</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
a</td>
<td class="list-col" style="margin-top: 1.00em;">
Single density only mode.</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
b</td>
<td class="list-col" style="margin-top: 1.00em;">
Double density only mode.</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
c</td>
<td class="list-col" style="margin-top: 1.00em;">
Density autodetect.</td>
</tr>
</tbody>
</table>
<p>
As the RX01 and RX02 hardware is not able to support formatting a blank disk, this driver has no support for according IOCTLs. But there are clones from third party vendors that support formatting. Formatting a blank disk may be initiated by the following commands on the VAX chevron prompt:<table style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-col">
<col style="min-width: 6.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
Single density</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
d/p/w 20001E78 9</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
d/p/w 20001E7A 92</td>
</tr>
</tbody>
</table>
<table style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-col">
<col style="min-width: 6.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
Double density</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
d/p/w 20001E78 109</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
d/p/w 20001E7A 92</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/rf?[abc]</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/rrf?[abc]</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
</dd>
</dl>
</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-diag">
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">rfc_attach: Error creating bus_dma map: %d</b></dt>
<dd class="list-diag">
</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">did not respond to INIT CMD</b></dt>
<dd class="list-diag">
Possible errors during <a class="link-man" href="../../4/autoconf">autoconf(4)</a>. %d is the return code of <a class="link-man" href="../../9/bus_dmamap_create">bus_dmamap_create(9)</a>.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">%s: did not respond to CMD %x</b></dt>
<dd class="list-diag">
An error occurred while the driver tried to send command %x to drive %s.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">rfc_intr: Error while reading sector: %x</b></dt>
<dd class="list-diag">
</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">rfc_intr: Error while writing sector: %x</b></dt>
<dd class="list-diag">
</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">rfc_intr: Error while DMA: %x</b></dt>
<dd class="list-diag">
%x is status code from the controller error and status register.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">rfc_intr: Error while loading bus_dma map: %d</b></dt>
<dd class="list-diag">
%d is return code of <a class="link-man" href="../../9/bus_dmamap_load">bus_dmamap_load(9)</a>.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">%s: density error.</b></dt>
<dd class="list-diag">
A single density disk was opened in double density only mode or vice versa or the medium in the drive attached as %s was not readable at all.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../../1/dd">dd(1)</a>, <a class="link-man" href="../../1/tar">tar(1)</a>, <a class="link-man" href="../../4/intro">intro(4)</a>, <a class="link-man" href="../../5/disklabel">disklabel(5)</a>, <a class="link-man" href="../../8/disklabel">disklabel(8)</a>, <a class="link-man" href="../../8/mknod">mknod(8)</a>, <a class="link-man" href="../../8/mount">mount(8)</a>, <a class="link-man" href="../../8/newfs">newfs(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The rf driver appeared in <span class="unix">NetBSD&#160;2.0</span>. It is a complete rewrite, not related to the old 4.2BSD <b class="name">rx</b> driver.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Jochen Kunz</span></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Writing of a <a class="link-man" href="../../5/disklabel">disklabel(5)</a> is not supported. The driver return always the internally fake disklabel.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
March 23, 2003</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

