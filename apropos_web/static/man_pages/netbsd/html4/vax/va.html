<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../../style.css" type="text/css" media="all">
<title>
VA(4) (VAX)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
VA(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual (VAX)</td>
<td class="head-rtitle" align="right">
VA(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">va</b> &#8212; <span class="desc">Benson-Varian printer/plotter interface</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">va0 at uba0 csr 0164000 vector vaintr</b><br>
<b class="config">vz0 at va0 drive 0</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> NOTE: This driver has not been ported from <span class="unix">4.4BSD</span> yet.<p>
<div class="symb" style="display:inline;margin-left: 1.00ex;">
(NOTE: the configuration description, while counter-intuitive, is actually as shown above.)</div>
<p>
The Benson-Varian printer/plotter in normally used with the line printer system. This description is designed for those who wish to drive the Benson-Varian directly.<p>
In print mode, the Benson-Varian uses a modified ASCII character set. Most control characters print various non-ASCII graphics such as daggers, sigmas, copyright symbols, etc. Only LF and FF are used as format effectors. LF acts as a newline, advancing to the beginning of the next line, and FF advances to the top of the next page.<p>
In plot mode, the Benson-Varian prints one raster line at a time. An entire raster line of bits (2112 bits = 264 bytes) is sent, and then the Benson-Varian advances to the next raster line.<p>
<span class="emph">Note</span>: The Benson-Varian must be sent an even number of bytes. If an odd number is sent, the last byte will be lost. Nulls can be used in print mode to pad to an even number of bytes.<p>
To use the Benson-Varian yourself, you must realize that you cannot open the device, <i class="file">/dev/va0</i> if there is an daemon active. You can see if there is an active daemon by doing a <a class="link-man" href="../../html1/lpq.html">lpq(1)</a> and seeing if there are any files being printed. Printing should be turned off using <a class="link-man" href="../../html8/lpc.html">lpc(8)</a>.<p>
To set the Benson-Varian into plot mode include the file <b class="includes">&lt;<a class="link-includes">sys/vcmd.h</a>&gt;</b> and use the following <a class="link-man" href="../../html2/ioctl.html">ioctl(2)</a> call<p>
<pre style="margin-left: 5.00ex;" class="lit display">
ioctl(fileno(va), VSETSTATE, plotmd);</pre>
<p>
where <i class="arg">plotmd</i> is defined to be<p>
<pre style="margin-left: 5.00ex;" class="lit display">
int plotmd[] = { VPLOT, 0, 0 };</pre>
<p>
and <i class="arg">va</i> is the result of a call to <a class="link-man" href="../../html3/fopen.html">fopen(3)</a> on stdio. When you finish using the Benson-Varian in plot mode you should advance to a new page by sending it a FF after putting it back into print mode, i.e. by<p>
<pre style="margin-left: 5.00ex;" class="lit display">
int prtmd[] = { VPRINT, 0, 0 }; 
... 
fflush(va); 
ioctl(fileno(va), VSETSTATE, prtmd); 
write(fileno(va), "&#92;f&#92;0", 2);</pre>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/va0</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
</dd>
</dl>
</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> The following error numbers are significant at the time the device is opened.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENXIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The device is already in use.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The device is offline.</dd>
</dl>
<p>
The following message may be printed on the console.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-diag">
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">va%d: npr timeout.</b></dt>
<dd class="list-diag">
The device was not able to get data from the UNIBUS within the timeout period, most likely because some other device was hogging the bus.  (But see <i class="link-sec"><a class="link-sec" href="#x42554753">BUGS</a></i> below).</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../../html1/lpr.html">lpr(1)</a>, <a class="link-man" href="../../html4/vp.html">vp(4)</a>, <a class="link-man" href="../../html8/lpd.html">lpd(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">va</b> driver appeared in <span class="unix">4.0BSD</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The 1's (one's) and l's (lower-case el's) in the Benson-Varian's standard character set look very similar; caution is advised.<p>
The interface hardware is rumored to have problems which can play havoc with the UNIBUS. We have intermittent minor problems on the UNIBUS where our <a class="link-man" href="../../html4/va.html">va(4)</a> lives, but haven't ever been able to pin them down completely.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
June 5, 1993</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

