<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
UATP(4)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
UATP(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual</td>
<td class="head-rtitle" align="right">
UATP(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">uatp</b> &#8212; <span class="desc">USB Apple trackpad driver</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">uatp* at uhidev? reportid ?</b><br>
<b class="config">wsmouse* at uatp? mux 0</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">uatp</b> driver provides support for the USB trackpads found in Apple laptops since 2005, exposed through <a class="link-man" href="../4/wsmouse">wsmouse(4)</a>. Some USB Apple trackpads are standard USB HID mice supported by <a class="link-man" href="../4/ums">ums(4)</a>, but <b class="name">uatp</b> supports more features. The following <a class="link-man" href="../8/sysctl">sysctl(8)</a> variables control behavior of USB Apple trackpads:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.two_finger_buttons</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Bit mask of buttons to emulate when two fingers are on the trackpad while the button is pressed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.three_finger_buttons</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Bit mask of buttons to emulate when three fingers are on the trackpad while the button is pressed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.multifinger_track</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
What to do when multiple fingers are moved on the trackpad. If set to 0, ignore the input. If set to 1, move as if a single finger were at the mean position of the fingers. If set to 2, scroll. Note that scrolling is currently broken.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.x_sensors</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Number of sensor columns detecting the x positions of fingers on the trackpad. The driver should detect this based on the model of hardware, so you should not have to set this, and likewise for the x ratio and y sensors and ratio.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.x_ratio</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Ratio of the number of sensor columns in the trackpad to the number of distinct cursor x positions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.y_sensors</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Number of sensor rows detecting the y positions of fingers on the trackpad.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.y_ratio</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Ratio of the number of sensor rows in the trackpad to the number of distinct cursor y positions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.sensor_threshold</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Nonnegative integer giving a lower bound on the &#8220;pressure&#8221; a sensor must report for the driver to recognize input from it.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.sensor_normalizer</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Nonnegative integer to subtract from the &#8220;pressure&#8221; reported by a sensor when averaging them to estimate the pressure of a single finger.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.palm_width</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
If zero, palm detection is disabled. Otherwise, a positive integer giving the number of consecutive sensors wide or high that will be interpreted as a palm instead of a finger and therefore ignored.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.old_raw_weight</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.old_smoothed_weight</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.new_raw_weight</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
When a finger moves on the trackpad, the new smoothed (cursor) position is computed as a positive linear combination of the old raw (trackpad) position, the old smoothed position, and the new raw position. The weights of the linear combination are given by these sysctl knobs.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.motion_threshold</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Threshold below which a difference in smoothed position will not be reported as an input event to userland.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.motion_multiplier</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Positive integer by which a difference in smoothed position will be multiplied before passing it as an input event to userland.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.motion_divisor</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Positive integer by which a difference in smoothed position will be divided, after multiplying it by the motion multiplier, before passing it as an input event to userland.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.fast_motion_threshold</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Threshold above which to use the fast motion factors below.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.fast_motion_multiplier</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Positive integer by which to multiply a large difference in smoothed position.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.fast_motion_divisor</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Positive integer by which to divide a large difference in smoothed position, after multiplying it by the fast motion multiplier.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.motion_delay</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Number of input packets before <b class="name">uatp</b> reports motion to userland.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.tap_limit_msec</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Positive integer giving the number of milliseconds of a finger's contact with the trackpad before it will not be considered a tap.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.double_tap_limit_msec</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Positive integer giving the maximum number of milliseconds after a tap before a second tap will keep the button down.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.one_finger_tap_buttons</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Bit mask of buttons that a one-finger tap will press.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.two_finger_tap_buttons</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Bit mask of buttons that a two-finger tap will press.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.three_finger_tap_buttons</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Bit mask of buttons that a three-finger tap will press.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">hw.uatpN.tap_track_distance_limit</span></dt>
<dd class="list-tag" style="margin-left: 33.00ex;">
Maximum distance in smoothed position that will be interpreted as a tap instead of motion.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../4/ums">ums(4)</a>, <a class="link-man" href="../4/wsmouse">wsmouse(4)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">uatp</b> driver first appeared in <span class="unix">NetBSD&#160;7.0</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="name">uatp</b> driver was originally written by <span class="author">Taylor R. Campbell</span> &#60;<a class="link-mail" href="mailto:riastradh@NetBSD.org">riastradh@NetBSD.org</a>&#62;.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Sometimes, particularly when X starts up, the driver gets wedged in an interrupt storm and does not reset the device. Setting <code class="lit">hw.uatpN.sensor_threshold</code> to a large number, say 1000, and then back to its original value, can fix this.<p>
Palm detection is not very robust.<p>
Multi-touch scrolling is currently broken.<p>
Pinch-to-zoom and other fancy multi-touch input is not implemented.<p>
On suspending and resuming, <b class="name">uatp</b> detaches and reattaches, and loses all sysctl settings in the process.<p>
Do not submerge your <b class="name">uatp</b> devices in water: USB adenosine triphosphate is unstable in water, and will hydrolyze to USB adenosine diphosphate and phosphate, which is a lower energy state that makes your mouse narcoleptic in X.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
August 4, 2012</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

