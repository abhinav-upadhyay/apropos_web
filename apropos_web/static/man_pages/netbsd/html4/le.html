<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
LE(4)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
LE(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual</td>
<td class="head-rtitle" align="right">
LE(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">le</b> &#8212; <span class="desc">AMD 7990, 79C90, 79C960, 79C970 LANCE Ethernet interface driver</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><div class="subsection">
<h2 id="x49534120626f61726473">ISA boards</h2> <b class="config">nele0 at isa? port 0x320 irq 9 drq 7    # NE2100</b><br>
<b class="config">le* at nele?</b><br>
<b class="config">bicc0 at isa? port 0x320 irq 10 drq 7   # BICC Isolan</b><br>
<b class="config">le* at bicc?</b><br>
<b class="config">depca0 at isa? port 0x300 iomem 0xc8000 iosiz 0x8000 irq 5 # DEC DEPCA</b><br>
<b class="config">le* at depca?</b><br>
<b class="config">le* at isapnp?                          # ISA Plug-and-Play adapters</b></div>
<div class="subsection">
<h2 id="x4549534120626f61726473">EISA boards</h2> <b class="config">depca* at eisa? slot ?                  # DEC DE422</b><br>
<b class="config">le* at depca?</b></div>
<div class="subsection">
<h2 id="x4d434120626f61726473">MCA boards</h2> <b class="config">le* at mca? slot ?                      # SKNET Personal/MC2+</b></div>
<div class="subsection">
<h2 id="x50434920626f6172647320616e64206d61696e626f617264206164617074657273">PCI boards and mainboard adapters</h2> <b class="config">le* at pci? dev? function ?</b></div>
<div class="subsection">
<h2 id="x545552424f6368616e6e656c20504d41441e41206f72206f6e626f6172642028616c7068612c20706d617829">TURBOchannel PMAD-A or onboard (alpha, pmax)</h2> <b class="config">le* at tc? slot ? offset ?</b></div>
<div class="subsection">
<h2 id="x616c706861">alpha</h2> <b class="config">le* at ioasic? offset ?</b></div>
<div class="subsection">
<h2 id="x616d696761">amiga</h2> <b class="config">le* at zbus0</b></div>
<div class="subsection">
<h2 id="x6174617269">atari</h2> <b class="config">le0 at vme0 irq 4  # BVME410</b><br>
<b class="config">le0 at vme0 irq 5  # Riebl/PAM</b></div>
<div class="subsection">
<h2 id="x6870333030">hp300</h2> <b class="config">le* at dio? scode ?</b></div>
<div class="subsection">
<h2 id="x6d766d6536386b">mvme68k</h2> <b class="config">le0 at pcc? ipl 3  # MVME147</b></div>
<div class="subsection">
<h2 id="x6e65777336386b">news68k</h2> <b class="config">le0 at hb0 addr 0xe0f00000 ipl 4</b></div>
<div class="subsection">
<h2 id="x6e6577736d697073">newsmips</h2> <b class="config">le0 at hb0 addr 0xbff80000 level 1</b></div>
<div class="subsection">
<h2 id="x706d6178">pmax</h2> <b class="config">le* at ioasic? offset ?</b><br>
<b class="config">le* at ibus0 addr ?</b></div>
<div class="subsection">
<h2 id="x737061726320616e642073706172633634">sparc and sparc64</h2> <b class="config">le* at sbus? slot ? offset ?</b><br>
<b class="config">le* at ledma0 slot ? offset ?</b><br>
<b class="config">le* at lebuffer? slot ? offset ?</b></div>
<div class="subsection">
<h2 id="x73756e33">sun3</h2> <b class="config">le0 at obio0 addr 0x120000 ipl 3</b><br>
<b class="config">options LANCE_REVC_BUG</b></div>
<div class="subsection">
<h2 id="x766178">vax</h2> <b class="config">le0 at vsbus0 csr 0x200e0000</b></div>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">le</b> interface provides access to a Ethernet network via the AMD Am7990 and Am79C90 (CMOS, pin-compatible) LANCE (Local Area Network Controller - Ethernet) chip set.<p>
The <b class="name">le</b> driver also supports PCnet-PCI cards based on the AMD 79c970 chipset, which is a single-chip implementation of a LANCE chip and PCI bus interface.<p>
Each of the host's network addresses is specified at boot time with an <span class="define">SIOCSIFADDR</span> <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a>. The <b class="name">le</b> interface employs the Address Resolution Protocol (ARP) described in <a class="link-man" href="../html4/arp.html">arp(4)</a> to dynamically map between Internet and Ethernet addresses on the local network.<p>
Selective reception of multicast Ethernet frames is provided by a 64-bit mask; multicast destination addresses are hashed to a bit entry using the Ethernet CRC function.<p>
The use of &#8220;trailer&#8221; encapsulation to minimize copying data on input and output is supported by the interface but offers no advantage on systems with large page sizes. The use of trailers is automatically negotiated with ARP. This negotiation may be disabled, on a per-interface basis, with <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a>.</div>
<div class="section">
<h1 id="x4841524457415245">HARDWARE</h1><div class="subsection">
<h2 id="x616d696761">amiga</h2> The <b class="name">le</b> interface supports the following Zorro II expansion cards:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">A2065</span></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Commodore's Ethernet card, manufacturer&#160;514, product&#160;112</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">AMERISTAR</span></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Ameristar's Ethernet card, manufacturer&#160;1053, product&#160;1</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">ARIADNE</span></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Village Tronic's Ethernet card, manufacturer&#160;2167, product&#160;201</dd>
</dl>
<p>
The A2065 and Ameristar Ethernet cards support only manual media selection.<p>
The Ariadne card supports a software media selection for its two different connectors:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
10Base2/BNC</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
also known as thinwire-Ethernet</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
10BaseT/UTP</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
also known as twisted pair</dd>
</dl>
<p>
The Ariadne card uses an autoselect between UTP and BNC, so it uses UTP when an active UTP line is connected or otherwise BNC. See <a class="link-man" href="../html4/ifmedia.html">ifmedia(4)</a> for media selection options for <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a>.</div>
<div class="subsection">
<h2 id="x495341">ISA</h2> The ISA-bus Ethernet cards supported by the <b class="name">le</b> interface are:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
BICC Isolan</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
Novell NE2100</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
Digital DEPCA</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x45495341">EISA</h2> The EISA-bus Ethernet cards supported by the <b class="name">le</b> interface are:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
DEC DE422</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4d4341">MCA</h2> The MCA-bus Ethernet cards supported by the <b class="name">le</b> interface are:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
SKNET Personal MC2</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
SKNET MC2+</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x706d6178">pmax</h2> All LANCE interfaces on DECstations are supported, as are interfaces on Alpha AXP machines with a TURBOchannel bus.<p>
No support is provided for switching between media ports. The DECstation 3100 provides both AUI and BNC (thinwire or 10BASE2) connectors. Port selection is via a manual switch and is not software configurable.<p>
The DECstation model 5000/200 PMAD-AA baseboard device provides only a BNC connector.<p>
The <b class="name">ioasic</b> baseboard devices and the PMAD-AA TURBOchannel option card provide only an AUI port.</div>
<div class="subsection">
<h2 id="x7370617263">sparc</h2> The Sbus Ethernet cards supported by the <b class="name">le</b> interface include:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
SBE/S</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
SCSI and Buffered Ethernet (sun part 501-1860)</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
FSBE/S</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Fast SCSI and Buffered Ethernet (sun part 501-2015)</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
Antares SBus 10Base-T Ethernet</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Buffered Ethernet (antares part 20-050-1007)</dd>
</dl>
<p>
Interfaces attached to an <span class="symb">ledma0</span> on SPARC systems typically have two types of connectors:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
AUI/DIX</dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Standard 15 pin connector</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
10BaseT</dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
UTP, also known as twisted pair</dd>
</dl>
<p>
The appropriate connector can be selected by supplying a <b class="flag">media</b> parameter to <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a>. The supported arguments for <b class="flag">media</b> are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">10base5/AUI</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
to select the AUI connector, or</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">10baseT/UTP</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
to select the UTP connector.</dd>
</dl>
<p>
If a <b class="flag">media</b> parameter is not specified, a default connector is selected for use by examining all media types for carrier. The first connector on which a carrier is detected will be selected. Additionally, if carrier is dropped on a port, the driver will switch between the possible ports until one with carrier is found.</div>
</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-diag">
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">le%d: overflow</b></dt>
<dd class="list-diag">
More packets came in from the Ethernet than there was space in the receive buffers. Packets were missed.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">le%d: receive buffer error</b></dt>
<dd class="list-diag">
Ran out of buffer space, packet dropped.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">le%d: lost carrier</b></dt>
<dd class="list-diag">
The Ethernet carrier disappeared during an attempt to transmit. It will finish transmitting the current packet, but will not automatically retry transmission if there is a collision.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">le%d: excessive collisions, tdr %d</b></dt>
<dd class="list-diag">
Ethernet extremely busy or jammed, outbound packets dropped after 16 attempts to retransmit.<p>
<span class="symb">TDR</span> is &#8220;Time Domain Reflectometry&#8221;. The LANCE TDR value is an internal counter of the interval between the start of a transmission and the occurrence of a collision. This value can be used to determine the distance from the Ethernet tap to the point on the Ethernet cable that is shorted or open (unterminated).</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">le%d: dropping chained buffer</b></dt>
<dd class="list-diag">
Packet didn't fit into a single receive buffer, packet dropped. Since the <b class="name">le</b> driver allocates buffers large enough to receive the maximum size Ethernet packet, this means some other station on the LAN transmitted a packet larger than allowed by the Ethernet standard.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">le%d: transmit buffer error</b></dt>
<dd class="list-diag">
LANCE ran out of buffer before finishing the transmission of a packet. If this error occurs, the driver software has a bug.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">le%d: underflow</b></dt>
<dd class="list-diag">
LANCE ran out of buffer before finishing the transmission of a packet. If this error occurs, the driver software has a bug.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">le%d: controller failed to initialize</b></dt>
<dd class="list-diag">
Driver failed to start the AM7990 LANCE. This is potentially a hardware failure.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">le%d: memory error</b></dt>
<dd class="list-diag">
RAM failed to respond within the timeout when the LANCE wanted to read or write it. This is potentially a hardware failure.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">le%d: receiver disabled</b></dt>
<dd class="list-diag">
The LANCE receiver was turned off due to an error.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">le%d: transmitter disabled</b></dt>
<dd class="list-diag">
The LANCE transmitter was turned off due to an error.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/arp.html">arp(4)</a>, <a class="link-man" href="../html4/ifmedia.html">ifmedia(4)</a>, <a class="link-man" href="../html4/inet.html">inet(4)</a>, <a class="link-man" href="../html4/intro.html">intro(4)</a>, <a class="link-man" href="../html4/mca.html">mca(4)</a>, <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a><p>
<span class="ref"><span class="ref-rep">Am79C90 - CMOS Local Area Network Controller for Ethernet</span>, <span class="ref-num">17881</span>, <span class="ref-date">May 1994</span>, <span class="ref-opt">Advanced Micro Devices</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The pmax <b class="name">le</b> driver is derived from a <b class="name">le</b> driver that first appeared in <span class="unix">4.4BSD</span>. Support for multiple bus attachments first appeared in <span class="unix">NetBSD&#160;1.2</span>.<p>
The Amiga <b class="name">le</b> interface first appeared in <span class="unix">NetBSD&#160;1.0</span><p>
The Ariadne Ethernet card first appeared with the Amiga ae interface in <span class="unix">NetBSD&#160;1.1</span> and was converted to the Amiga <b class="name">le</b> interface in <span class="unix">NetBSD&#160;1.3</span></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The Am7990 Revision C chips have a bug which causes garbage to be inserted in front of the received packet occasionally. The work-around is to ignore packets with an invalid destination address (garbage will usually not match), by double-checking the destination address of every packet in the driver. This work-around is enabled with the <span class="define">LANCE_REVC_BUG</span> kernel option.<p>
When <span class="define">LANCE_REVC_BUG</span> is enabled, the <b class="name">le</b> driver executes one or two calls to an inline Ethernet address comparison function for every received packet. On the mc68000 it is exactly eight instructions of 16 bits each. There is one comparison for each unicast packet, and two comparisons for each broadcast packet.<p>
In summary, the cost of the LANCE_REVC_BUG option is:<ol style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-enum">
<li class="list-enum" style="margin-top: 0.00em;">
loss of multicast support, and</li>
<li class="list-enum" style="margin-top: 0.00em;">
eight extra CPU instructions per received packet, sometimes sixteen, depending on both the processor, and the type of packet.</li>
</ol>
<p>
All sun3 systems are presumed to have this bad revision of the Am7990, until proven otherwise. Alas, the only way to prove what revision of the chip is in a particular system is inspection of the date code on the chip package, to compare against a list of what chip revisions were fabricated between which dates.<p>
Alas, the Am7990 chip is so old that AMD has &#8220;de-archived&#8221; the production information about it; pending a search elsewhere, we don't know how to identify the revision C chip from the date codes.<p>
On all pmax front-ends, performance is impaired by hardware which forces a software copy of packets to and from DMA buffers. The <b class="name">ioasic</b> machines and the DECstation 3100 must copy packets to and from non-contiguous DMA buffers. The DECstation 5000/200 and the PMAD-AA must copy to and from an onboard SRAM DMA buffer. The CPU overhead is noticeable, but all machines can sustain full 10 Mb/s media speed.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 27, 2001</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

