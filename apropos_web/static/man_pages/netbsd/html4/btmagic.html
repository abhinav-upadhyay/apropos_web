<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
BTMAGIC(4)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
BTMAGIC(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual</td>
<td class="head-rtitle" align="right">
BTMAGIC(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">btmagic</b> &#8212; <span class="desc">Apple Magic Mouse and Apple Magic Trackpad</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">btmagic*	at bthub?</b><br>
<b class="config">wsmouse*	at btmagic?</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">btmagic</b> driver provides support for the Bluetooth &#8220;Magic Mouse&#8221; and &#8220;Magic Trackpad&#8221; from Apple, Inc. As remote devices cannot be discovered by autoconfig, configuring a mouse is normally carried out with the <a class="link-man" href="../8/btdevctl">btdevctl(8)</a> program.<p>
The Magic Mouse and Magic Trackpad use the standard USB Human Interface Device protocol to communicate, but do not provide a proper HID Descriptor, and require specific initializations to enable the proprietary touch reports.<p>
The Magic Mouse provides basic mouse functionality with two buttons, and the <b class="name">btmagic</b> driver additionally interprets the touch reports to emulate a middle mouse button when more than one firm touch is detected during a click event, plus horizontal and vertical scrolling for touch movements greater than a certain distance. The mouse has a base resolution of 1300dpi, which the driver scales by default to a less sensitive 650dpi, but this is adjustable with <a class="link-man" href="../8/sysctl">sysctl(8)</a> along with the pressure needed to discern a firm touch, the minimum distance necessary to trigger scrolling and the additional downscale factor applied to scroll movements.<p>
The Magic Trackpad provides multi touch functionality and one button. The <b class="name">btmagic</b> driver emulates 3 buttons by splitting the area at the bottom of the device in 3 equal zones and detects finger presence in one of these zones when the button is pressed. In addition, a tap in any area of the trackpad is interpreted as a left click. The timeout for tap detection defaults to 100ms and is adjustable with <a class="link-man" href="../8/sysctl">sysctl(8)</a>.<p>
Pointer movement is reported for single-touch movements over the device, and scroll is reported for multi-touch movements.<p>
The trackpad has a base resolution of 1300dpi, which the driver scales by default to a less sensitive 650dpi, but this is adjustable with <a class="link-man" href="../8/sysctl">sysctl(8)</a> along with the additional downscale factor applied to scroll movements.<p>
<b class="name">btmagic</b> interfaces to the system as usual through the <a class="link-man" href="../4/wsmouse">wsmouse(4)</a> driver, and the following properties are used during autoconfiguration:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
vendor-id</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Must be 0x05ac.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
product-id</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Must be 0x030d or 0x030e.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
local-bdaddr</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Local device address.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
remote-bdaddr</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Remote device address.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
link-mode</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
This optional string represents the link mode of the baseband link, and may be one of &#8216;auth&#8217;, &#8216;encrypt&#8217;, or &#8216;secure&#8217;.</dd>
</dl>
<p>
When the <b class="name">btmagic</b> driver has configured, it will attempt to open a connection to the mouse and, if this fails or the connection is lost, will wait for the mouse to initiate connections. The Magic Mouse requires connections to be authenticated, and should accept a PIN of &#8216;0000&#8217; during the pairing process.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../4/bluetooth">bluetooth(4)</a>, <a class="link-man" href="../4/bthub">bthub(4)</a>, <a class="link-man" href="../4/wsmouse">wsmouse(4)</a>, <a class="link-man" href="../8/btdevctl">btdevctl(8)</a>, <a class="link-man" href="../8/sysctl">sysctl(8)</a></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author"></span>The <b class="name">btmagic</b> driver was written by <span class="author">Iain Hibbert</span> with reference to the Linux driver written by <span class="author">Michael Poole</span>. <span class="author">Manuel Bouyer</span> added Magic Trackpad support, with reference to the Linux driver written by <span class="author">Michael Poole</span> and <span class="author">Chase Douglas</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
July 4, 2015</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

