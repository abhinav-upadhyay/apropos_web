<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
UBT(4)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
UBT(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual</td>
<td class="head-rtitle" align="right">
UBT(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">ubt</b> &#8212; <span class="desc">USB Bluetooth driver</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">ubt* at uhub? port ? configuration ? interface ?</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">ubt</b> driver provides support for USB Bluetooth dongles to the Bluetooth protocol stack.<p>
USB Bluetooth dongles provide two interfaces, both of which the <b class="name">ubt</b> driver claims. The second interface is used for Isochronous data and will have several alternate configurations regarding bandwidth consumption, which can be set using the hw.ubtN.config <a class="link-man" href="../8/sysctl">sysctl(8)</a> variable. The number of alternate configurations is indicated by the value in the hw.ubtN.alt_config variable, and the isoc frame size for the current configuration is shown in the hw.ubtN.sco_rxsize and hw.ubtN.sco_txsize variables.<p>
By default, configuration 0 is selected, which means that no bandwidth is used on the Isochronous interface and no SCO data can be sent. Consult the Bluetooth USB specification at https://www.bluetooth.org/ for complete instructions on setting bandwidth consumption. The following extract may be useful as a general guidance though details may differ between manufacturers.<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
0</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
No active voice channels</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
1</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
One voice channel with 8-bit encoding</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
2</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Two voice channels with 8-bit encoding, or one voice channel with 16-bit encoding.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
3</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Three voice channels with 8-bit encoding</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
4</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Two voice channels with 16-bit encoding</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
5</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Three voice channels with 16-bit encoding</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../4/bluetooth">bluetooth(4)</a>, <a class="link-man" href="../4/uhub">uhub(4)</a>, <a class="link-man" href="../8/sysctl">sysctl(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> This <b class="name">ubt</b> device driver was originally a character device written by <span class="author">David Sainty</span> and <span class="author">Lennart Augustsson</span>. It was rewritten to support socket based Bluetooth access for <span class="unix">NetBSD&#160;4.0</span> by <span class="author">Iain Hibbert</span>.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> Isochronous data is seemingly not well supported over USB in the current system and to get SCO working, you may have to calculate the SCO packet size that the stack will use. This is the sco_mtu value reported by the <a class="link-man" href="../8/btconfig">btconfig(8)</a> command, and when combined with the SCO header (3 bytes) should fit exactly into an integer number of Isochronous data frames where the frame size is indicated by the &#8216;hw.ubtN.sco_txsize&#8217; sysctl variable.<p>
For example: I want one voice channel (which is all that is supported, for now) so am using configuration #2, with a frame length of 17 bytes. This gives possible values of:<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">(17 * 1) - 3 = 14</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">(17 * 2) - 3 = 31</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">(17 * 3) - 3 = 48</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">(17 * 4) - 3 = 65</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">(17 * 5) - 3 = 82</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">etc.</code></div>
</blockquote>
<p>
<a class="link-man" href="../8/btconfig">btconfig(8)</a> shows the maximum SCO payload as 64 bytes, so I am using the next smaller size of 48, to minimize the overhead of the 3 header bytes.<p>
The SCO packet size can be changed using the &#8216;scomtu&#8217; option to <a class="link-man" href="../8/btconfig">btconfig(8)</a>.<p>
The failure mode is that the USB Bluetooth dongle locks up though generally removal/reinsertion will clear the problem.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The Isochronous configuration can only be changed when the device is not marked up.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
August 27, 2006</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

