<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
WE(4)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
WE(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual</td>
<td class="head-rtitle" align="right">
WE(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">we</b> &#8212; <span class="desc">Western Digital/SMC WD80x3, SMC Elite Ultra, and SMC EtherEZ Ethernet cards device driver</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><div class="subsection">
<h2 id="x49534120626f61726473">ISA boards</h2> <b class="config">we0 at isa? port 0x280 iomem 0xd0000 irq 9</b><br>
<b class="config">we1 at isa? port 0x300 iomem 0xcc000 irq 10</b></div>
<div class="subsection">
<h2 id="x4d434120626f61726473">MCA boards</h2> <b class="config">we* at mca? slot ?</b></div>
<div class="subsection">
<h2 id="x6174617269">atari</h2> <b class="config">we0 at vme0 irq 4 # SMC Elite Ultra with SMC_TT VME-ISA bridge</b></div>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">we</b> device driver supports Western Digital/SMC WD80x3, SMC Elite Ultra, and SMC EtherEZ Ethernet cards.</div>
<div class="section">
<h1 id="x464c41472056414c554553">FLAG VALUES</h1> For some clone boards the driver is not able to recognize 16bit or 8bit interfaces correctly. Since this makes a huge difference (see diagnostic section below) you can override this by specifying flags value in the config file:<p>
<b class="config">we2 at isa? port 0x300 iomem 0xe0000 irq 15 flags 4</b><p>
The values to add together for flags are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-diag">
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">2</b></dt>
<dd class="list-diag">
force adapter to be treated as 8bit, even if it probes as a 16bit interface. Improper use of this flag will make the driver fail or send invalid Ethernet packets.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">4</b></dt>
<dd class="list-diag">
force adapter to be treated as 16bit, even if it probes as a 8bit interface. For example the COMPEX ENT/U boards identify as WD8003 compatibles, but are in fact 16bit cards. Using this flag on a board that really is a 8bit board will result in bogus packets being sent.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">8</b></dt>
<dd class="list-diag">
disable the use of double transmit buffers to save space in the on-board RAM for more receive buffers.</dd>
</dl>
<p>
Note that all supported MCA cards are 16bit, and the SMC_TT VME-ISA bridge interface for atari supports only SMC Elite Ultra.</div>
<div class="section">
<h1 id="x4d454449412053454c454354494f4e">MEDIA SELECTION</h1> The ability to select media from software is dependent on the particular model of WD/SMC card. The following models support only manual configuration: WD8003S, WD8003E, and WD8013EBT.<p>
Other WD/SMC 80x3 interfaces support two types of media on a single card. All support the AUI media type. The other media is either BNC or UTP behind a transceiver. Software cannot differentiate between BNC and UTP cards. On some models, the AUI port is always active.<p>
The SMC Elite Ultra and SMC EtherEZ interfaces support three media a single card: AUI, BNC, and UTP. If the transceiver is active, the BNC media is selected. Otherwise, the AUI and UTP ports are both active.<p>
To enable the AUI media, select the <span class="emph">10base5</span> or <span class="emph">aui</span> media type with <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a>'s <b class="flag">media</b> directive. To select the other media (transceiver), select the <span class="emph">10base2</span> or <span class="emph">bnc</span> media type.</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-diag">
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">we0: overriding IRQ &lt;n&gt; to &lt;m&gt;</b></dt>
<dd class="list-diag">
The IRQ specified in the kernel configuration file is different from that found in the card's configuration registers. The value in the kernel configuration file is being overridden by the one configured into the card.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">we0: can't wildcard IRQ on a &lt;model&gt;</b></dt>
<dd class="list-diag">
The IRQ was wildcarded in the kernel configuration file, and the card is a WD8003S, WD8003E, or WD8013EBT, which do not support software IRQ configuration.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">we0: failed to clear shared memory at offset &lt;off&gt;</b></dt>
<dd class="list-diag">
The memory test was unable to clear the interface's shared memory region. This often indicates that the card is configured at a conflicting <span class="emph">iomem</span> address.</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">we0: warning - receiver ring buffer overrun</b></dt>
<dd class="list-diag">
The DP8390 Ethernet chip used by this board implements a shared-memory ring-buffer to store incoming packets.<p>
The 16bit boards (8013 series) have 16k of memory as well as fast memory access speed. Typical memory access speed on these boards is about 4MB/second. These boards generally have no problems keeping up with full Ethernet speed and the ring-buffer seldom overfills.<p>
However, the 8bit boards (8003) usually have only 8k bytes of shared memory. This is only enough room for about 4 full-size (1500 byte) packets. This can sometimes be a problem, especially on the original WD8003E, because these boards' shared-memory access speed is quite slow; typically only about 1MB/second. The overhead of this slow memory access, and the fact that there is only room for 4 full-sized packets means that the ring-buffer will occasionally overrun. When this happens, the board must be reset to avoid a lockup problem in early revision 8390's. Resetting the board causes all of the data in the ring-buffer to be lost, requiring it to be retransmitted/received, congesting the board further. Because of this, maximum throughput on these boards is only about 400-600k per second.<p>
This problem is exasperated by NFS because the 8bit boards lack sufficient memory to support the default 8k byte packets that NFS and other protocols use as their default. If these cards must be used with NFS, use the NFS <b class="flag">&#45;r</b> and <b class="flag">&#45;w</b> options in <i class="file">/etc/fstab</i> to limit NFS's packet size. 4096 byte packets generally work.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/ifmedia.html">ifmedia(4)</a>, <a class="link-man" href="../html4/intro.html">intro(4)</a>, <a class="link-man" href="../html4/isa.html">isa(4)</a>, <a class="link-man" href="../html4/mca.html">mca(4)</a>, <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
March 23, 2010</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

