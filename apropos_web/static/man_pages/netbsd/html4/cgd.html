<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
CGD(4)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
CGD(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual</td>
<td class="head-rtitle" align="right">
CGD(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">cgd</b> &#8212; <span class="desc">cryptographic disk driver</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">pseudo-device cgd</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">cgd</b> driver provides the capability of encrypting blocks on their way to and from a disk or partition.<p>
In order to compile support for the <b class="name">cgd</b> into your kernel, you must add the driver to your kernel configuration file. To do this, add a line similar to:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
pseudo-device   cgd     # cryptographic disk driver</pre>
<p>
The <b class="name">cgd</b> devices are allocated as needed.<div class="subsection">
<h2 id="x456e6372797074696f6e20416c676f726974686d73">Encryption Algorithms</h2> Currently the following cryptographic algorithms are supported:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">aes-cbc</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
AES in CBC mode. AES uses a 128 bit blocksize and can accept keys of length 128, 192, or 256. The default key length is 128.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">3des-cbc</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Triple DES in CBC mode. Triple DES uses a 64 bit blocksize and is performed in EDE3 mode with a 168 bit key. The key passed to the kernel is 192 bits but the parity bits are ignored.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">blowfish-cbc</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Blowfish in CBC mode. Blowfish uses a 64 bit blocksize and can accept keys between 40 and 448 bits in multiples of 8. It is strongly encouraged that keys be at least 128 bits long. There are no performance advantages of using shorter keys. The default key length is 128 bits.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4956204d6574686f6473">IV Methods</h2> Currently, the following IV Methods are supported:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">encblkno1</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
This method  encrypts the block number of the physical disk block once with the cipher and key provided and uses the result as the IV for CBC mode. This method should ensure that each block has a different IV and that the IV is reasonably unpredictable. This is the default method used by <a class="link-man" href="../8/cgdconfig">cgdconfig(8)</a> when configuring a new <b class="name">cgd</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">encblkno8</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
This is the original IV method used by <b class="name">cgd</b> and provided for backward compatibility. It repeatedly encrypts the block number of the physical disk block eight times and uses the result as the IV for CBC mode. This method should ensure that each block has a different IV and that the IV is reasonably unpredictable. The eightfold encryption was not intended and causes a notable performance loss with little (if any) increase in security over a single encryption.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x494f43544c53">IOCTLS</h2> A <b class="name">cgd</b> responds to all of the standard disk <a class="link-man" href="../2/ioctl">ioctl(2)</a> calls defined in <a class="link-man" href="../4/sd">sd(4)</a>, and also defines the following:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">CGDIOCSET</span></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Configure the <b class="name">cgd</b>. This <a class="link-man" href="../2/ioctl">ioctl(2)</a> sets up the encryption parameters and points the <b class="name">cgd</b> at the underlying disk.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">CGDIOCCLR</span></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Unconfigure the <b class="name">cgd</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">CGDIOCGET</span></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Get info about the <b class="name">cgd</b>.</dd>
</dl>
<p>
These <a class="link-man" href="../2/ioctl">ioctl(2)</a>'s and their associated data structures are defined in <b class="includes">&lt;<a class="link-includes">dev/cgdvar.h</a>&gt;</b> header.</div>
</div>
<div class="section">
<h1 id="x5741524e494e4753">WARNINGS</h1> It goes without saying that if you forget the passphrase that you used to configure a <b class="name">cgd</b>, then you have irrevocably lost all of the data on the disk. Please ensure that you are using an appropriate backup strategy.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
/dev/{,r}cgd*</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<b class="name">cgd</b> device special files.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/config">config(1)</a>, <a class="link-man" href="../2/ioctl">ioctl(2)</a>, <a class="link-man" href="../4/sd">sd(4)</a>, <a class="link-man" href="../8/cgdconfig">cgdconfig(8)</a>, <a class="link-man" href="../8/MAKEDEV">MAKEDEV(8)</a><p>
<span class="ref"><span class="ref-auth">Roland C. Dowdeswell</span> and <span class="ref-auth">John Ioannidis</span>, <span class="ref-title">The CryptoGraphic Disk Driver</span>, <i class="ref-book">Proceedings of the FREENIX Track: 2003 USENIX Annual Technical Conference</i>, <i class="ref-issue">USENIX Association</i>, <a class="link-ref" href="http://www.usenix.org/event/usenix03/tech/freenix03/full_papers/dowdeswell/dowdeswell.pdf">http://www.usenix.org/event/usenix03/tech/freenix03/full_papers/dowdeswell/dowdeswell.pdf</a>, <span class="ref-page">179-186</span>, <span class="ref-date">June 9-14, 2003</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">cgd</b> driver was written by Roland C. Dowdeswell for <span class="unix">NetBSD</span>. The <b class="name">cgd</b> driver originally appeared in <span class="unix">NetBSD&#160;2.0</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
November 30, 2013</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

