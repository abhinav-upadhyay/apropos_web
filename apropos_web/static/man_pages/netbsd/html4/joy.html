<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
JOY(4)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
JOY(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual</td>
<td class="head-rtitle" align="right">
JOY(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">joy</b> &#8212; <span class="desc">game adapter driver</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">joy* at acpi?</b><br>
<b class="config">joy* at eap?</b><br>
<b class="config">joy* at eso?</b><br>
<b class="config">joy0 at isa? port 0x201</b><br>
<b class="config">joy* at isapnp?</b><br>
<b class="config">joy* at ofisa?</b><br>
<b class="config">joy* at pci?</b><br>
<b class="config">joy* at pnpbios? index ?</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> This driver provides access to the game adapter. The lower bit in the minor device number selects the joystick: 0 is the first joystick and 1 is the second.<p>
The game control adapter allows up to two joysticks to be attached to the system. The adapter plus the driver convert the present resistive value to a relative joystick position. On receipt of an output signal, four timing circuits are started. By determining the time required for the circuit to time-out (a function of the resistance), the paddle position can be determined. The adapter could be used as a general purpose I/O card with four analog (resistive) inputs plus four digital input points.<p>
Applications may call <a class="link-man" href="../2/ioctl">ioctl(2)</a> on a game adapter driver file descriptor to set and get the offsets of the two potentiometers and the maximum time-out value for the circuit. The <a class="link-man" href="../2/ioctl">ioctl(2)</a> commands are listed in <b class="includes">&lt;<a class="link-includes">machine/joystick.h</a>&gt;</b> and currently are:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">JOY_SETTIMEOUT</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
Sets the maximum time-out for the adapter.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">JOY_GETTIMEOUT</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
Returns the current maximum time-out.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">JOY_SET_X_OFFSET</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
Sets an offset on X value.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">JOY_GET_X_OFFSET</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
Returns the current X offset.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">JOY_SET_Y_OFFSET</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
Sets an offset on Y value.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">JOY_GET_Y_OFFSET</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
Returns the current Y offset.</dd>
</dl>
<p>
All these commands take an integer parameter.<p>
<a class="link-man" href="../2/read">read(2)</a> on the file descriptor returns a <i class="farg">joystick</i> structure:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
struct joystick { 
	int x; 
	int y; 
	int b1; 
	int b2; 
};</pre>
<p>
The fields have the following functions:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">x</i></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
current X coordinate of the joystick (or position of paddle 1)</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">y</i></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
current Y coordinate of the joystick (or position of paddle 2)</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">b1</i></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
current state of button 1</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">b2</i></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
current state of button 2</dd>
</dl>
<p>
The b1 and b2 fields in struct joystick are set to 1 if the corresponding button is down, 0 otherwise.<p>
The x and y coordinates are supposed to be between 0 and 255 for a good joystick and a good adapter. Unfortunately, because of the hardware hack that is used to measure the position (by measuring the time needed to discharge an RC circuit made from the joystick's potentiometer and a capacitor on the adapter), calibration is needed to determine exactly what values are returned for a specific joystick/adapter combination. Incorrect hardware can yield negative or values greater than 255.<p>
A typical calibration procedure uses the values returned at lower left, center and upper right positions of the joystick to compute the relative position.<p>
This calibration is not part of the driver.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/joy0</i></dt>
<dd class="list-tag" style="margin-left: 32.00ex;">
first joystick</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/joy1</i></dt>
<dd class="list-tag" style="margin-left: 32.00ex;">
second joystick</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../4/acpi">acpi(4)</a>, <a class="link-man" href="../4/eap">eap(4)</a>, <a class="link-man" href="../4/eso">eso(4)</a>, <a class="link-man" href="../4/isa">isa(4)</a>, <a class="link-man" href="../4/isapnp">isapnp(4)</a>, <a class="link-man" href="../4/ofisa">ofisa(4)</a>, <a class="link-man" href="../4/pci">pci(4)</a>, <a class="link-man" href="../4/pnpbios">pnpbios(4)</a></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> Jean-Marc Zucconi wrote the <span class="unix">FreeBSD</span> driver. Matthieu Herrb ported it to <span class="unix">NetBSD</span> and wrote this manual page.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
July 22, 2006</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

