<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
NTWOC(4)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
NTWOC(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual</td>
<td class="head-rtitle" align="right">
NTWOC(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">ntwoc</b> &#8212; <span class="desc">Riscom/N2, N2pci, WANic 400 synchronous serial interfaces</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">ntwoc* at pci? dev ? function ? flags 0</b><br>
<b class="config">ntwoc0 at isa? port 0x300 irq 5 iomem 0xc8000 flags 1</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">ntwoc</b> device driver supports bit-synchronous serial communication using Cisco HDLC framing. The cards are capable of being driven by the line clock or from an internal baud rate generator. The devices all use the Hitachi hd64570 serial chip. The hd64570 supports 2 asynchronous/byte-synchronous/bit-synchronous serial ports, and has a 4-channel DMA controller for loading the serial port FIFOs.<p>
The ISA Riscom/N2 card has a jumper block to set the IRQ and a DIP switch to set the port address the card will use. The values programmed into the card must be specified with the <b class="flag">port</b> and <b class="flag">irq</b> locators in the kernel configuration line. The <b class="flag">iomem</b> locator must be specified and must occur on a 16k boundary. The driver uses a 16k region of io memory. Bit 0 of the <b class="flag">flags</b> locator indicates if there is a second serial port available on the card.<p>
Currently clock source and speed information is specified with the <b class="flag">flags</b> locator in the kernel configuration file. The flags field has the following format.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
  3                   2                   1 
1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 
+-------------+ +-----+ +-----+ + +---+ +-+     + +---+ +-+   + 
      tmc         tdiv    rdiv  e1 rxs1 ts1    e0 rxs0  txs0  np(*)</pre>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">tmc</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Defines the timer constant. The base clock frequency is divided by <b class="var">tmc</b> to generate the main clock for receiving and sending. Further division is possible with the <b class="var">tdiv</b> and <b class="var">rdiv</b> divisor options. A value of 0 is treated as 256.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">tdiv</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Defines the transmit divisor as 2^(<b class="var">tdiv</b>). The internal transmit clock frequency is determined by dividing the base clock frequency by <b class="var">tmc</b> and then dividing by 2^(<b class="var">tdiv</b>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">rdiv</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Defines the receive divisor as 2^(<b class="var">rdiv</b>). The internal receive clock frequency is determined by dividing the base clock frequency by <b class="var">tmc</b> and then dividing by 2^(<b class="var">rdiv</b>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">e0</b> <b class="var">e1</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
If true the internal clock source is used to drive the line clock for port 0 or port 1 respectively.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">rxs0</b> <b class="var">rxs1</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Specifies which clock source to use for receiving data on port 0 and port 1 respectively. The following values are accepted:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
0</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Line clock.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
1</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Line clock with noise suppression.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
2</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Internal clock.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">txs0</b> <b class="var">txs1</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Specifies which clock source to use for transmitting data on port 0 and port 1 respectively. The following values are accepted:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
0</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Line clock.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
1</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Internal clock.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
2</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Receive clock.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">np</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
(For the ISA card only) A value of 1 indicates there is a second serial port present on the card. This is auto-detected on the PCI card and need not be specified.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4841524457415245">HARDWARE</h1> Cards supported by the <b class="name">ntwoc</b> driver include:<p>
<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-item">
<li class="list-item" style="margin-top: 0.00em;">
SDL Communications Riscom/N2</li>
<li class="list-item" style="margin-top: 0.00em;">
SDL Communications N2pci</li>
<li class="list-item" style="margin-top: 0.00em;">
SDL Communications WANic 400 (untested)</li>
</ul>
</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-diag">
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">ntwoc0: TXDMA underrun - fifo depth maxed</b></dt>
<dd class="list-diag">
Indicates that the serial port's FIFO is being drained faster than DMA can fill it. The driver automatically increases the low-water mark at which to begin DMA transfers when underruns occur. This diagnostic is issued when the low-water mark is maximized (i.e., 1 less than the depth of the FIFO).</dd>
<dt class="list-diag" style="margin-top: 1.00em;">
<b class="diag">ntwoc0: RXDMA buffer overflow</b></dt>
<dd class="list-diag">
Indicates that a frame is being received by the card, but there are no free receive buffers.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../4/intro">intro(4)</a>, <a class="link-man" href="../4/isa">isa(4)</a>, <a class="link-man" href="../4/pci">pci(4)</a>, <a class="link-man" href="../8/ifconfig">ifconfig(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The PCI driver first appeared in <span class="unix">NetBSD&#160;1.4</span>. Much of the ISA driver was adapted from the <span class="unix">FreeBSD</span> <b class="name">sr</b> driver and first appeared in <span class="unix">NetBSD&#160;1.5</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Use of the <b class="flag">flags</b> locator for setting the clock sources and speeds should be replaced with ioctl's and a control program.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
October 2, 1998</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

