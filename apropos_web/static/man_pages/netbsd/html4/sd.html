<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
SD(4)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
SD(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual</td>
<td class="head-rtitle" align="right">
SD(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">sd</b> &#8212; <span class="desc">SCSI and ATAPI disk driver</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">sd* at scsibus? target ? lun ?</b><br>
<b class="config">sd3 at scsibus0 target 3 lun 0</b><br>
<b class="config">sd* at atapibus? drive ? flags 0x0000</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">sd</b> driver provides support for SCSI bus and Advanced Technology Attachment Packet Interface (ATAPI) disks. It allows the disk to be divided up into a set of pseudo devices called <span class="emph">partitions</span>. In general the interfaces are similar to those described by <a class="link-man" href="../4/wd">wd(4)</a>.<p>
Where the <a class="link-man" href="../4/wd">wd(4)</a> device has a fairly low level interface to the system, SCSI devices have a much higher level interface and talk to the system via a SCSI host adapter (e.g., <a class="link-man" href="../4/ahc">ahc(4)</a>). A SCSI adapter must also be separately configured into the system before a SCSI disk can be configured.<p>
When the SCSI adapter is probed during boot, the SCSI bus is scanned for devices. Any devices found which answer as &#8216;<span class="emph">Direct</span>&#8217; type devices will be attached to the <b class="name">sd</b> driver.<p>
For the use of flags with ATAPI devices, see <a class="link-man" href="../4/wd">wd(4)</a>.</div>
<div class="section">
<h1 id="x504152544954494f4e494e47">PARTITIONING</h1> On many systems <a class="link-man" href="../8/disklabel">disklabel(8)</a> is used to partition the drive into filesystems. On some systems the <span class="unix">NetBSD</span> portion of the disk resides within a native partition, and another program is used to create the <span class="unix">NetBSD</span> portion.<p>
For example, the i386 port uses <a class="link-man" href="../8/fdisk">fdisk(8)</a> to partition the disk into a BIOS level partition. This allows sharing the disk with other operating systems.</div>
<div class="section">
<h1 id="x434f4e46494755524154494f4e204f5054494f4e53">CONFIGURATION OPTIONS</h1> The following <a class="link-man" href="../1/config">config(1)</a> options may be applied to SCSI disks as well as to other disks.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SDRETRIES</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Set the number of retries that will be performed for operations it makes sense to retry (e.g., normal reads and writes). The default is four (4).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SD_IO_TIMEOUT</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Set amount of time, in milliseconds, a normal read or write is expected to take. The defaults is sixty seconds (60000 milliseconds). This is used to set watchdog timers in the SCSI HBA driver to catch commands that might have died on the device.</dd>
</dl>
</div>
<div class="section">
<h1 id="x494f43544c53">IOCTLS</h1> The following <a class="link-man" href="../2/ioctl">ioctl(2)</a> calls apply to SCSI disks as well as to other disks. They are defined in the header file <b class="includes">&lt;<a class="link-includes">disklabel.h</a>&gt;</b>.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DIOCGDINFO</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Read, from the kernel, the in-core copy of the disklabel for the drive. This may be a fictitious disklabel if the drive has never been initialized, in which case it will contain information read from the SCSI inquiry commands.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DIOCSDINFO</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Give the driver a new disklabel to use. The driver <span class="emph">will not</span> write the new disklabel to the disk.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DIOCKLABEL</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Keep or drop the in-core disklabel on the last close.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DIOCWLABEL</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Enable or disable the driver's software write protect of the disklabel on the disk.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DIOCWDINFO</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Give the driver a new disklabel to use. The driver <span class="emph">will</span> write the new disklabel to the disk.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DIOCLOCK</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Lock the media cartridge into the device, or unlock a cartridge previously locked. Used to prevent user and software eject while the media is in use.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DIOCEJECT</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Eject the media cartridge from a removable device.</dd>
</dl>
<p>
In addition, the <a class="link-man" href="../4/scsi">scsi(4)</a> general <b class="fname">ioctl</b>() commands may be used with the <b class="name">sd</b> driver, but only against the &#8216;<code class="lit">c</code>&#8217; (whole disk) partition.</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1> If a removable device is attached to the <b class="name">sd</b> driver, then the act of changing the media will invalidate the disklabel and information held within the kernel. To avoid corruption, all accesses to the device will be discarded until there are no more open file descriptors referencing the device. During this period, all new open attempts will be rejected. When no more open file descriptors reference the device, the first next open will load a new set of parameters (including disklabel) for the drive.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/sd</i><i class="arg">u</i><i class="arg">p</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
block mode SCSI disk unit <i class="arg">u</i>, partition <i class="arg">p</i></dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/rsd</i><i class="arg">u</i><i class="arg">p</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
raw mode SCSI disk unit <i class="arg">u</i>, partition <i class="arg">p</i></dd>
</dl>
</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> None.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/ioctl">ioctl(2)</a>, <a class="link-man" href="../4/intro">intro(4)</a>, <a class="link-man" href="../4/scsi">scsi(4)</a>, <a class="link-man" href="../4/wd">wd(4)</a>, <a class="link-man" href="../5/disklabel">disklabel(5)</a>, <a class="link-man" href="../8/disklabel">disklabel(8)</a>, <a class="link-man" href="../8/fdisk">fdisk(8)</a>, <a class="link-man" href="../8/scsictl">scsictl(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">sd</b> driver was originally written for Mach 2.5, and was ported to <span class="unix">FreeBSD</span> by Julian Elischer. It was later ported to <span class="unix">NetBSD</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
January 18, 1996</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

