<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
DM(4)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
DM(4)</td>
<td class="head-vol" align="center">
Kernel Interfaces Manual</td>
<td class="head-rtitle" align="right">
DM(4)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">dm</b> &#8212; <span class="desc">Device-mapper disk driver</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">pseudo-device dm</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">dm</b> driver provides the capability of creating one or more virtual disks based on the target mapping.<p>
This document assumes that you're familiar with how to generate kernels, how to properly configure disks and pseudo-devices in a kernel configuration file, and how to partition disks. This driver is used by the Linux lvm2tools to create and manage lvm in <span class="unix">NetBSD</span>.<p>
Currently, the <i class="file">linear</i>, <i class="file">zero</i>, and <i class="file">error</i> targets are implemented. Each component partition should be offset at least 2 sectors from the beginning of the component disk. This avoids potential conflicts between the component disk's disklabel and <b class="name">dm</b>&#39;s disklabel. In i386 it is offset by 65 sectors, where 63 sectors are the initial boot sectors and 2 sectors are used for the disklabel which is set to be read-only.<p>
In order to compile in support for <b class="name">dm</b>, you must add a line similar to the following to your kernel configuration file:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
pseudo-device	dm	 #device-mapper disk device</pre>
<p>
<b class="name">dm</b> may create linear mapped devices, zero, and error block devices. Zero and error block devices are used mostly for testing. <i class="file">Linear</i> devices are used to create virtual disks with linearly mapped virtual blocks to blocks on real disk. <b class="name">dm</b> Device-mapper devices are controlled through the <i class="file">/dev/mapper/control</i> device. For controlling this device <a class="link-man" href="../2/ioctl">ioctl(2)</a> calls are used. For the implementation of the communication channel, the <a class="link-man" href="../3/proplib">proplib(3)</a> library is used. The protocol channel is defined as a proplib dictionary with needed values. For more details, look at <i class="file">sys/dev/dm/netbsd-dm.h</i>. Before any device can be used, every device-mapper disk device must be initialized. For initialization one line must be passed to the kernel driver in the form of a proplib dictionary. Every device can have more than one table active. An example for such a line is:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
0 10240 linear /dev/wd1a 384</pre>
<p>
The first parameter is the start sector for the table defined with this line, the second is the length in sectors which is described with this table. The third parameter is the target name. All other parts of this line depend on the chosen target.<p>
For the linear target, there are two additional parameters: The fourth parameter describes the disk device to which the device-mapper disk is mapped. The fifth parameter is the offset on this disk from the start of the disk/partition.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/config">config(1)</a>, <a class="link-man" href="../3/proplib">proplib(3)</a>, <a class="link-man" href="../8/dmsetup">dmsetup(8)</a>, <a class="link-man" href="../8/fsck">fsck(8)</a>, <a class="link-man" href="../8/lvm">lvm(8)</a>, <a class="link-man" href="../8/MAKEDEV">MAKEDEV(8)</a>, <a class="link-man" href="../8/mount">mount(8)</a>, <a class="link-man" href="../8/newfs">newfs(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The device-mapper disk driver first appeared in <span class="unix">NetBSD&#160;6.0</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Adam Hamsik</span> &#60;<a class="link-mail" href="mailto:haad@NetBSD.org">haad@NetBSD.org</a>&#62; implemented the device-mapper driver for <span class="unix">NetBSD</span>.<p>
<span class="author">Brett Lymn</span> &#60;<a class="link-mail" href="mailto:blymn@NetBSD.org">blymn@NetBSD.org</a>&#62;, <span class="author">Reinoud Zandijk</span> &#60;<a class="link-mail" href="mailto:reinoud@NetBSD.org">reinoud@NetBSD.org</a>&#62;, and <span class="author">Bill Stouder-Studenmund</span> &#60;<a class="link-mail" href="mailto:wrstuden@NetBSD.org">wrstuden@NetBSD.org</a>&#62; provided guidance and answered questions about the <span class="unix">NetBSD</span> implementation.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> This driver is still a work-in-progress &#8212; there can be bugs.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 4, 2015</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

