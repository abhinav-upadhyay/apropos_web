<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
DISKLABEL(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
DISKLABEL(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
DISKLABEL(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">disklabel</b> &#8212; <span class="desc">read and write disk pack label</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 9.00ex;">
<col>
<tbody>
<tr>
<td>
disklabel</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;ACDFmrtv</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;B</b> <i class="arg">endian</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;M</b> <i class="arg">machine</i></span>&#93; <i class="arg">disk</i></td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 9.00ex;">
<col>
<tbody>
<tr>
<td>
disklabel</td>
<td>
<b class="flag">&#45;e</b> &#91;<span class="opt"><b class="flag">&#45;CDFImrv</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;B</b> <i class="arg">endian</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;M</b> <i class="arg">machine</i></span>&#93; <i class="arg">disk</i></td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 9.00ex;">
<col>
<tbody>
<tr>
<td>
disklabel</td>
<td>
<b class="flag">&#45;i</b> &#91;<span class="opt"><b class="flag">&#45;DFImrv</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;B</b> <i class="arg">endian</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;M</b> <i class="arg">machine</i></span>&#93; <i class="arg">disk</i></td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 9.00ex;">
<col>
<tbody>
<tr>
<td>
disklabel</td>
<td>
<b class="flag">&#45;R</b> &#91;<span class="opt"><b class="flag">&#45;DFmrv</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;B</b> <i class="arg">endian</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;M</b> <i class="arg">machine</i></span>&#93; <i class="arg">disk</i> <i class="arg">protofile</i></td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 9.00ex;">
<col>
<tbody>
<tr>
<td>
disklabel</td>
<td>
<b class="flag">&#45;w</b> &#91;<span class="opt"><b class="flag">&#45;DFmrv</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;B</b> <i class="arg">endian</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;M</b> <i class="arg">machine</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;f</b> <i class="arg">disktab</i></span>&#93; <i class="arg">disk</i> <i class="arg">disktype</i> &#91;<span class="opt"><i class="arg">packid</i></span>&#93;</td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 9.00ex;">
<col>
<tbody>
<tr>
<td>
disklabel</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;NW</b></span>&#93; <i class="arg">disk</i></td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 9.00ex;">
<col>
<tbody>
<tr>
<td>
disklabel</td>
<td>
<b class="flag">&#45;l</b></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">disklabel</b> can be used to install, examine, or modify the label on a disk drive or pack. When writing the label, it can be used to change the drive identification, the disk partitions on the drive, or to replace a damaged label.<p>
The <b class="flag">&#45;e</b>, <b class="flag">&#45;i</b>, <b class="flag">&#45;l</b>, <b class="flag">&#45;R</b>, <b class="flag">&#45;w</b>, <b class="flag">&#45;N</b>, and <b class="flag">&#45;W</b> options determine the basic operation. If none are specified the label is displayed.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;e</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Edit the existing label (using <span class="env">EDITOR</span>) and write it back to the disk. If <span class="env">EDITOR</span> is undefined, then <a class="link-man" href="../1/vi">vi(1)</a> is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;i</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Interactively update the existing label and write it back to the disk.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;l</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Show all known file system types (those that can be specified along a partition within the label) and exit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;R</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Write (restore) a label by reading it from <i class="arg">protofile</i>. The file should be in the same format as the default output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;w</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Write a standard label for the specified <i class="arg">disktype</i>. See <a class="link-man" href="../5/disktab">disktab(5)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;N</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Disallow writes to the disk sector that contains the label. This is the default state.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;W</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Allow writes to the disk sector that contains the label. This state may not persist if no programs have the disk open.</dd>
</dl>
<p>
The majority of the rest of the options affect more than one form of the command:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;A</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Read all labels from the disk, including ones deleted with <b class="name">disklabel</b> <b class="flag">&#45;D</b>. Implies <b class="flag">&#45;r</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;B</b> <i class="arg">endian</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specify the byteorder of the label to be written. It should be: &#8220;be&#8221; or &#8220;le&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;C</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Output the partition offset and size values in &#60;cylinder/head/sector&#62; format. Note this format is always accepted on input with either the <b class="flag">&#45;e</b> or <b class="flag">&#45;R</b> flags.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;D</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Delete all existing labels (by 1's complementing the magic number) before writing any labels to their default location. Implies <b class="flag">&#45;r</b>. If <b class="flag">&#45;D</b> is specified without a request to write the label, then existing labels are just deleted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;F</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Treat <i class="arg">disk</i> as a regular file. This suppresses all <a class="link-man" href="../2/ioctl">ioctl(2)</a> calls, and is the default if <i class="arg">disk</i> is a regular file. <i class="arg">disk</i> is always opened using <a class="link-man" href="../3/opendisk">opendisk(3)</a> even if <b class="flag">&#45;F</b> is specified. Implies <b class="flag">&#45;r</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;I</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
If a label cannot be read from <i class="arg">disk</i> request the default one from the kernel. Implies <b class="flag">&#45;r</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;f</b> <i class="arg">disktab</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specify the name of a file to use instead of <i class="file">/etc/disktab</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;M</b> <i class="arg">machine</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specify the machine to generate a label for. Defaults to the current machine it is compiled for.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;m</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
expect the label to have an MBR.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;r</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Read/write the disk directly rather than using <a class="link-man" href="../2/ioctl">ioctl(2)</a> requests on the kernel. When writing a label, the kernel will be told about the label before the label is written and asked to write afterwards. This is the historic behaviour and can be supressed by specifying <b class="flag">&#45;F</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;t</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Format the output as a <a class="link-man" href="../5/disktab">disktab(5)</a> entry.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Be verbose about the operations being done, in particular the disk sectors being read and written. Specifying <b class="flag">&#45;v</b> more than once will increase the verbosity.</dd>
</dl>
<p>
On systems that expect to have disks with MBR partitions (see <a class="link-man" href="../8/fdisk">fdisk(8)</a>) <b class="name">disklabel</b> will find, and update if requested, labels in the first 8k of type 169 (<span class="unix">NetBSD</span>) MBR labels and within the first 8k of the physical disk. On other systems <b class="name">disklabel</b> will only look at the start of the disk. The offset at which the labels are written is also system dependent.<p>
<b class="name">disklabel</b> will detect byteswapped labels, but currently cannot display them.<p>
Previous versions of <b class="name">disklabel</b> could update the bootstrap code on some architectures. This functionality has been subsumed by <a class="link-man" href="../8/installboot">installboot(8)</a>.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/disktab</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558495420535441545553">EXIT STATUS</h1> The exit status of <b class="name">disklabel</b> is set to indicate any errors or warnings. The values used are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
0</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <b class="name">disklabel</b> utility has completed successfully.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
1</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A fatal error has occurred, such as unknown options passed on the command line, or writing the disklabel failed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
4</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
An I/O error of some sort occurred.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
101..n</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
One or more warnings occured while reading the disklabel. Subtract 100 to get the number of warnings detected.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1><blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"><b class="cmd">disklabel sd0</b></code></div>
</blockquote>
<p>
Display the in-core label for sd0 as obtained via <i class="file">/dev/rsd0c</i>.<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"><b class="cmd">disklabel -i -r sd0</b></code></div>
</blockquote>
<p>
Read the on-disk label for sd0, edit it using the built-in interactive editor and reinstall in-core as well as on-disk.<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"><b class="cmd">disklabel -i -I sd0</b></code></div>
</blockquote>
<p>
As previous, but don't fail if there was no label on the disk yet; provide some default values instead.<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"><b class="cmd">disklabel -e -I sd0</b></code></div>
</blockquote>
<p>
As previous, only edit using $EDITOR<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"><b class="cmd">disklabel -w -r /dev/rsd0c sd2212 foo</b></code></div>
</blockquote>
<p>
Create a label for sd0 based on information for &#8220;sd2212&#8221; found in <i class="file">/etc/disktab</i>, using <i class="file">foo</i> as the disk pack label. If you do not have an entry for your disk in <i class="file">/etc/disktab</i>, you can use this style to put an initial label onto a new disk. Then dump the label to a file (using <b class="cmd">disklabel sd0 &gt; protofile</b>), editing the file, and replacing the label with <b class="cmd">disklabel -R sd0 protofile</b>.<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"><b class="cmd">disklabel -R sd0 mylabel</b></code></div>
</blockquote>
<p>
Restore the on-disk and in-core label for sd0 from information in <i class="file">mylabel</i>.</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> The kernel device drivers will not allow the size of a disk partition to be decreased or the offset of a partition to be changed while it is open. Some device drivers create a label containing only a single large partition if a disk is unlabeled; thus, the label must be written to the &#8220;a&#8221; partition of the disk while it is open. This sometimes requires the desired label to be set in two steps, the first one creating at least one other partition, and the second setting the label on the new partition while shrinking the &#8220;a&#8221; partition.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/opendisk">opendisk(3)</a>, <a class="link-man" href="../5/disklabel">disklabel(5)</a>, <a class="link-man" href="../5/disktab">disktab(5)</a>, <a class="link-man" href="../8/dkctl">dkctl(8)</a>, <a class="link-man" href="../8/fdisk">fdisk(8)</a>, <a class="link-man" href="../8/gpt">gpt(8)</a>, <a class="link-man" href="../8/installboot">installboot(8)</a>, <a class="link-man" href="../8/mbrlabel">mbrlabel(8)</a>, <a class="link-man" href="../8/mscdlabel">mscdlabel(8)</a></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The <b class="name">disklabel</b> structure stored on disk cannot support partitions/disks greater than 2TB. Please use <a class="link-man" href="../8/gpt">gpt(8)</a> and <a class="link-man" href="../8/dkctl">dkctl(8)</a> to manage partitions and disks larger than 2TB.<p>
If the disk partition is not specified in the disk name (i.e., <i class="arg">xy0</i> instead of <i class="arg">/dev/rxy0c</i>), <b class="name">disklabel</b> will construct the full pathname of the disk and use the &#8220;d&#8221; partition on i386, hpcmips, or arc, and the &#8220;c&#8221; partition on all others.<p>
On the sparc, sparc64, sun2, and sun3 <span class="unix">NetBSD</span> systems, the size of each partition must be a multiple of the number of sectors per cylinder (i.e., each partition must be an integer number of cylinders), or the boot ROMs will declare the label invalid and fail to boot the system.<p>
In addition, the <b class="flag">&#45;r</b> option should never be used on a sparc, sparc64, sun2, or sun3 system boot disk - the <span class="unix">NetBSD</span> kernel translates the <span class="unix">NetBSD</span> disk label into a SunOS compatible format (which is required by the boot PROMs) when it writes the label. Using the <b class="flag">&#45;r</b> flag causes <b class="name">disklabel</b> to write directly to disk, and bypass the format translation. This will result in a disk label that the PROMs will not recognize, and that therefore cannot be booted from.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 29, 2015</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

