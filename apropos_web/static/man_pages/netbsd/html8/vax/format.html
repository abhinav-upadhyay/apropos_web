<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../../style.css" type="text/css" media="all">
<title>
FORMAT(8) (VAX)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
FORMAT(8)</td>
<td class="head-vol" align="center">
System Manager's Manual (VAX)</td>
<td class="head-rtitle" align="right">
FORMAT(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">format</b> &#8212; <span class="desc">how to format disk packs</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> There are two ways to format disk packs.  The simplest is to use the <b class="name">format</b> program. The alternative is to use the DEC standard formatting software which operates under the DEC diagnostic supervisor. This manual page describes the operation of <b class="name">format</b>, then concludes with some remarks about using the DEC formatter.<p>
<b class="name">format</b> is a standalone program used to format and check disks prior to constructing file systems. In addition to the formatting operation, <b class="name">format</b> records any bad sectors encountered according to DEC standard 144. Formatting is performed one track at a time by writing the appropriate headers and a test pattern and then checking the sector by reading and verifying the pattern, using the controller's ECC for error detection. A sector is marked bad if an unrecoverable media error is detected, or if a correctable ECC error too many bits in length is detected (such errors are indicated as &#8220;ECC&#8221; in the summary printed upon completing the format operation). After the entire disk has been formatted and checked, the total number of errors are reported, any bad sectors and skip sectors are marked, and a bad sector forwarding table is written to the disk in the first five even numbered sectors of the last track. It is also possible to reformat sections of the disk in units of tracks. <b class="name">format</b> may be used on any UNIBUS or MASSBUS drive supported by the <span class="emph">up</span> and <span class="emph">hp</span> device drivers which uses 4-byte headers (everything except RP's).<p>
The test pattern used during the media check may be selected from one of: 0xf00f (RH750 worst case), 0xec6d (media worst case), and 0xa5a5 (alternating 1's and 0's). Normally the media worst case pattern is used.<p>
<b class="name">format</b> also has an option to perform an extended &#8220;severe burn-in&#8221;, which makes a number of passes using different patterns. The number of passes can be selected at run time, up to a maximum of 48, with provision for additional passes or termination after the preselected number of passes. This test runs for many hours, depending on the disk and processor.<p>
Each time <b class="name">format</b> is run to format an entire disk, a completely new bad sector table is generated based on errors encountered while formatting. The device driver, however, will always attempt to read any existing bad sector table when the device is first opened. Thus, if a disk pack has never previously been formatted, or has been formatted with different sectoring, five error messages will be printed when the driver attempts to read the bad sector table; these diagnostics should be ignored.<p>
Formatting a 400 megabyte disk on a MASSBUS disk controller usually takes about 20 minutes. Formatting on a UNIBUS disk controller takes significantly longer. For every hundredth cylinder formatted <b class="name">format</b> prints a message indicating the current cylinder being formatted. (This message is just to reassure people that nothing is amiss.)<p>
<b class="name">format</b> uses the standard notation of the standalone I/O library in identifying a drive to be formatted. A drive is  specified as <span class="emph">zz(x,y)</span>, where <span class="emph">zz</span> refers to the controller type (either <span class="emph">hp</span> or <span class="emph">up</span>), <span class="emph">x</span> is the unit number of the drive; 8 times the UNIBUS or MASSBUS adaptor number plus the MASSBUS drive number or UNIBUS drive unit number; and <span class="emph">y</span> is the file system partition on drive <span class="emph">x</span> (this should always be 0). For example, &#8220;hp(1,0)&#8221; indicates that drive 1 on MASSBUS adaptor 0 should be formatted; while &#8220;up(10,0)&#8221; indicates that UNIBUS drive 2 on UNIBUS adaptor 1 should be formatted.<p>
Before each formatting attempt, <b class="name">format</b> prompts the user in case debugging should be enabled in the appropriate device driver. A carriage return disables debugging information.<p>
<b class="name">format</b> should be used prior to building file systems (with <a class="link-man" href="../../8/newfs">newfs(8)</a> to ensure that all sectors with uncorrectable media errors are remapped. If a drive develops uncorrectable defects after formatting, either <a class="link-man" href="../../8/bad144">bad144(8)</a> or <a class="link-man" href="../../8/badsect">badsect(8)</a> should be able to avoid the bad sectors.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> A sample run of <b class="name">format</b> is shown below. In this example (using a VAX-11/780), <b class="name">format</b> is loaded from the console floppy; on an 11/750 <b class="name">format</b> will be loaded from the root file system with <a class="link-man" href="../../8/boot">boot(8)</a> following a &#8220;B/3&#8221; command. Boldface means user input. As usual, &#8220;#&#8221; and &#8220;@&#8221; may be used to edit input.<p>
<pre style="margin-left: 0.50in;" class="lit display">
&gt;&gt;&gt;<b>L FORMAT</b> 
	LOAD DONE, 00004400 BYTES LOADED 
&gt;&gt;&gt;<b>S 2</b> 
Disk format/check utility 
<div style="height: 1.00em;">
&#160;</div>
Enable debugging (0=none, 1=bse, 2=ecc, 3=bse+ecc)? <b>0</b> 
Device to format? <b>hp(8,0)</b> 
(<i>error messages may occur as old bad sector table is read</i>) 
Formatting drive hp0 on adaptor 1: verify (yes/no)? <b>yes</b> 
Device data: #cylinders=842, #tracks=20, #sectors=48 
Starting cylinder (0): 
Starting track (0): 
Ending cylinder (841): 
Ending track (19): 
Available test patterns are:</pre>
<pre style="margin-left: 1.50in;" class="lit display">
1 - (f00f) RH750 worst case 
2 - (ec6d) media worst case 
3 - (a5a5) alternating 1's and 0's 
4 - (ffff) Severe burnin (up to 48 passes)</pre>
<pre style="margin-left: 0.50in;" class="lit display">
Pattern (one of the above, other to restart)? <b>2</b> 
Maximum number of bit errors to allow for soft ECC (3): 
Start formatting...make sure the drive is online 
 ... 
(<i>soft ecc's and other errors are reported as they occur</i>) 
 ... 
(<i>if 4 write check errors were found, the program terminates like this...</i>) 
 ... 
Errors: 
Bad sector: 0 
Write check: 4 
Hard ECC: 0 
Other hard: 0 
Marked bad: 0 
Skipped: 0 
Total of 4 hard errors revectored. 
Writing bad sector table at block 808272 
(<i>808272 is the block # of the first block in the bad sector table</i>) 
Done 
(<i>...program restarts to allow formatting other disks</i>) 
(<i>...to abort halt machine with ^P</i>)</pre>
</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> The diagnostics are intended to be self explanatory.</div>
<div class="section">
<h1 id="x5553494e472044454320534f46545741524520544f20464f524d4154">USING DEC SOFTWARE TO FORMAT</h1> <span class="emph">Warning: These instructions are for people with 11/780 CPUs.</span> The steps needed for 11/750 or 11/730 CPU's are similar, but not covered in detail here.<p>
The formatting procedures are different for each type of disk. Listed here are the formatting procedures for RK07's, RP0X, and RM0X disks.<p>
You should shut down UNIX and halt the machine to do any disk formatting. Make certain you put in the pack you want formatted. It is also a good idea to spin down or write protect the disks you don't want to format, just in case.<div class="subsection">
<h2 id="x466f726d617474696e6720616e20524b3037">Formatting an RK07</h2> Load the console floppy labeled, &#8220;RX11 VAX DSK LD DEV #1&#8221; in the console disk drive, and type the following commands:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
&gt;&gt;&gt;BOOT 
DIAGNOSTIC SUPERVISOR.  ZZ-ESSAA-X5.0-119  23-JAN-1980 12:44:40.03 
DS&gt;ATTACH DW780 SBI DW0 3 5 
DS&gt;ATTACH RK611 DMA 
DS&gt;ATTACH RK07 DW0 DMA0 
DS&gt;SELECT DMA0 
DS&gt;LOAD EVRAC 
DS&gt;START/SEC:PACKINIT</pre>
</div>
<div class="subsection">
<h2 id="x466f726d617474696e6720616e2052503058">Formatting an RP0X</h2> Follow the above procedures except that the ATTACH and SELECT lines should read:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
DS&gt;ATTACH RH780 SBI RH0 8 5 
DS&gt;ATTACH RP0X RH0 DBA0		(RP0X is, e.g., RP06) 
DS&gt;SELECT DBA0</pre>
<p>
This is for drive 0 on mba0; use 9 instead of 8 for mba1, etc.</div>
<div class="subsection">
<h2 id="x466f726d617474696e6720616e20524d3058">Formatting an RM0X</h2> Follow the above procedures except that the ATTACH and SELECT lines should read:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
DS&gt;ATTACH RH780 SBI RH0 8 5 
DS&gt;ATTACH RM0X RH0 DRA0 
DS&gt;SELECT DRA0</pre>
<p>
Don't forget to put your UNIX console floppy back in the floppy disk drive.</div>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../../8/bad144">bad144(8)</a>, <a class="link-man" href="../../8/badsect">badsect(8)</a>, <a class="link-man" href="../../8/newfs">newfs(8)</a></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> An equivalent facility should be available which operates under a running UNIX system.<p>
It should be possible to reformat or verify part or all of a disk, then update the existing bad sector table.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 17, 2003</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

