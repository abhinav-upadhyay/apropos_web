<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
COMPAT_30(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
COMPAT_30(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
COMPAT_30(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">compat_30</b> &#8212; <span class="desc">setup procedure for backward compatibility on post-3.0 releases</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">options COMPAT_30</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">compat_30</b> module allows <span class="unix">NetBSD</span> to run <span class="unix">NetBSD&#160;3.0</span> executables.<p>
The support is present if the kernel was built with option <span class="define">COMPAT_30</span>. It is not available as a loadable module.<p>
Static executables typically need no additional setup. Dynamic binaries may require shared libraries whose major version number changed since <span class="unix">NetBSD&#160;3.0</span>, which are listed below. A shadow directory under <i class="file">/emul</i> is not used; the libraries can be obtained from a <span class="unix">NetBSD&#160;3.0</span> distribution and installed in the original directories shown, as the major version number in the file name will prevent conflicts. If an upgrade installation from <span class="unix">NetBSD&#160;3.0</span> has been done and these libraries are still present, nothing more need be done.<div class="subsection">
<h2 id="x4c6962726172696573206e65656465642066726f6d20332e30">Libraries needed from 3.0</h2><ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-item">
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/lib/libcrypto.so.2.1</i> <i class="file">/lib/libcrypto.so.2</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libcrypto.so.2.1</i> <i class="file">/usr/lib/libcrypto.so.2</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/lib/libevent.so.0.2</i> <i class="file">/lib/libevent.so.0</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libevent.so.0.2</i> <i class="file">/usr/lib/libevent.so.0</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libg2c.so.2.0</i> <i class="file">/usr/lib/libg2c.so.2</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libkadm.so.5.0</i> <i class="file">/usr/lib/libkadm.so.5</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libkafs.so.6.0</i> <i class="file">/usr/lib/libkafs.so.6</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libkdb.so.5.0</i> <i class="file">/usr/lib/libkdb.so.5</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libkrb5.so.19.1</i> <i class="file">/usr/lib/libkrb5.so.19</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libkrb.so.6.0</i> <i class="file">/usr/lib/libkrb.so.6</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libkstream.so.2.0</i> <i class="file">/usr/lib/libkstream.so.2</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libmagic.so.0.1</i> <i class="file">/usr/lib/libmagic.so.0</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libpcap.so.1.4</i> <i class="file">/usr/lib/libpcap.so.1</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/lib/libradius.so.0.0</i> <i class="file">/lib/libradius.so.0</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libradius.so.0.0</i> <i class="file">/usr/lib/libradius.so.0</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libssh.so.1.0</i> <i class="file">/usr/lib/libssh.so.1</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libssl.so.3.0</i> <i class="file">/usr/lib/libssl.so.3</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libstdc++.so.5.0</i> <i class="file">/usr/lib/libstdc++.so.5</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/lib/libz.so.0.4</i> <i class="file">/lib/libz.so.0</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libz.so.0.4</i> <i class="file">/usr/lib/libz.so.0</i></li>
<li class="list-item" style="margin-top: 1.00em;">
<i class="file">/usr/lib/libamu.so.2.1</i> <i class="file">/usr/lib/libamu.so.2</i></li>
</ul>
</div>
</div>
<div class="section">
<h1 id="x494d504c454d454e544154494f4e204e4f544553">IMPLEMENTATION NOTES</h1> <span class="define">COMPAT_30</span> enables the <span class="unix">NetBSD&#160;3.0</span> versions of the following system calls, whose syscall numbers and argument structures were changed after the 3.0 release to accommodate 64-bit filesystems: <a class="link-man" href="../html2/fhstat.html">fhstat(2)</a>, <a class="link-man" href="../html2/fstat.html">fstat(2)</a>, <a class="link-man" href="../html2/getdents.html">getdents(2)</a>, <a class="link-man" href="../html2/lstat.html">lstat(2)</a>, <a class="link-man" href="../html2/stat.html">stat(2)</a>.<p>
The filehandle structure (formerly <span class="type">fhandle_t</span>) was made opaque to userland and variable-sized. A <i class="farg">fh_size</i> argument was added to related syscalls: <a class="link-man" href="../html2/fhstat.html">fhstat(2)</a>, <a class="link-man" href="../html2/fhstatvfs.html">fhstatvfs(2)</a>, <a class="link-man" href="../html2/fhstatvfs1.html">fhstatvfs1(2)</a>, <a class="link-man" href="../html2/fhopen.html">fhopen(2)</a>, <a class="link-man" href="../html2/getfh.html">getfh(2)</a>. This changes the API and ABI of those syscalls, <span class="define">COMPAT_30</span> enables binary compatibility with the old ABI. Source compatibility is not provided, as use of those syscalls is supposed to be rare.<p>
The error code from the <a class="link-man" href="../html2/socket.html">socket(2)</a> syscall changed from <span class="errno">EPROTONOSUPPORT</span> to <span class="errno">EAFNOSUPPORT</span> in the case of an unsupported address family. <span class="define">COMPAT_30</span> enables binary compatibility with the old ABI. Source compatiblility is not provided.<p>
The <span class="type">struct ntptimeval</span> used by <a class="link-man" href="../html2/ntp_gettime.html">ntp_gettime(2)</a> changed with the implementation of timecounters.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/config.html">config(1)</a>, <a class="link-man" href="../html2/fhstat.html">fhstat(2)</a>, <a class="link-man" href="../html2/fstat.html">fstat(2)</a>, <a class="link-man" href="../html2/getdents.html">getdents(2)</a>, <a class="link-man" href="../html2/lstat.html">lstat(2)</a>, <a class="link-man" href="../html2/stat.html">stat(2)</a>, <a class="link-man" href="../html4/options.html">options(4)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> <span class="unix">NetBSD</span> offers back-compatibility options back to <span class="unix">NetBSD&#160;0.9</span>, but the first to be documented with a manual page is <b class="name">compat_30</b>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The compatible <a class="link-man" href="../html2/getdents.html">getdents(2)</a> is unable to see directory entries beneath the top layer of a union, even though the real 3.0 <b class="fname">getdents</b>() did not have that problem.</div>
<div class="section">
<h1 id="x534543555249545920434f4e53494445524154494f4e53">SECURITY CONSIDERATIONS</h1> Programs with security impact that receive incorrect directory contents from <b class="fname">getdents</b>() may behave improperly, as when they are unable to find, or find the wrong versions of, important files.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 15, 2007</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

