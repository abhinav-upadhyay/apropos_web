<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
AMD(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
AMD(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
AMD(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> amd &#45; automatically mount file systems</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>amd</b> <b>&#45;H</b><div style="height: 0.00em;">
&#160;</div>
<b>amd</b> [ <b>&#45;F</b><i> conf_file</i> ]<div style="height: 0.00em;">
&#160;</div>
<b>amd</b> [ <b>&#45;nprvHS</b> ] [ <b>&#45;a</b><i> mount_point</i> ] [ <b>&#45;c</b><i> duration</i> ] [ <b>&#45;d</b><i> domain</i> ] [ <b>&#45;k</b><i> kernel-arch</i> ] [ <b>&#45;l</b><i> logfile</i> ] [ <b>&#45;o</b><i> op_sys_ver</i> ] [ <b>&#45;t</b><i> interval.interval</i> ] [ <b>&#45;w</b><i> interval</i> ] [ <b>&#45;x</b><i> log-option</i> ] [ <b>&#45;y</b><i> YP-domain</i> ] [ <b>&#45;A</b><i> arch</i> ] [ <b>&#45;C</b><i> cluster-name</i> ] [ <b>&#45;D</b><i> option</i> ] [ <b>&#45;F</b><i> conf_file</i> ] [ <b>&#45;O</b><i> op_sys_name</i> ] [ <b>&#45;T</b><i> tag</i> ] [ <i>directory</i> <i>mapname</i> [<i> &#45;map-options </i>] ] ...</div>
<div class="section">
<h1>DESCRIPTION</h1> <b>Amd</b> is a daemon that automatically mounts filesystems whenever a file or directory within that filesystem is accessed. Filesystems are automatically unmounted when they appear to have become quiescent.<p>
<b>Amd</b> operates by attaching itself as an <small>NFS</small> server to each of the specified <i>directories</i><b>.</b> Lookups within the specified directories are handled by <b>amd</b>, which uses the map defined by <i>mapname</i> to determine how to resolve the lookup. Generally, this will be a host name, some filesystem information and some mount options for the given filesystem.<p>
In the first form depicted above, <b>amd</b> will print a short help string.  In the second form, if no options are specified, or the <b>-F</b> is used, <b>amd</b> will read configuration parameters from the file <i>conf_file</i> which defaults to <b>/etc/amd.conf</b>. The last form is described below.</div>
<div class="section">
<h1>OPTIONS</h1><dl>
<dt>
<b>&#45;a</b><i> temporary-directory</i></dt>
<dd>
Specify an alternative location for the real mount points. The default is <b>/a</b>.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;c</b><i> duration</i></dt>
<dd>
Specify a <i>duration</i>, in seconds, that a looked up name remains cached when not in use.  The default is 5 minutes.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;d</b><i> domain</i></dt>
<dd>
Specify the local domain name.  If this option is not given the domain name is determined from the hostname.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;k</b><i> kernel-arch</i></dt>
<dd>
Specifies the kernel architecture.  This is used solely to set the ${karch} selector.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;l</b><i> logfile</i></dt>
<dd>
Specify a logfile in which to record mount and unmount events. If <i>logfile</i> is the string <b>syslog</b> then the log messages will be sent to the system log daemon by <i>syslog</i>(3). The default syslog facility used is LOG_DAEMON.  If you wish to change it, append its name to the log file name, delimited by a single colon.  For example, if <i>logfile</i> is the string <b>syslog:local7</b> then <b>Amd</b> will log messages via <i>syslog</i>(3) using the LOG_LOCAL7 facility (if it exists on the system).<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;n</b></dt>
<dd>
Normalize hostnames. The name refereed to by ${rhost} is normalized relative to the host database before being used.  The effect is to translate aliases into ``official'' names.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;o</b><i> op_sys_ver</i></dt>
<dd>
Override the compiled-in version number of the operating system.  Useful when the built in version is not desired for backward compatibility reasons. For example, if the build in version is ``2.5.1'', you can override it to ``5.5.1'', and use older maps that were written with the latter in mind.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;p</b></dt>
<dd>
Print PID. Outputs the process-id of <b>amd</b> to standard output where it can be saved into a file.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;r</b></dt>
<dd>
Restart existing mounts. <b>Amd</b> will scan the mount file table to determine which filesystems are currently mounted.  Whenever one of these would have been auto-mounted, <b>amd</b> <i>inherits</i> it.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;t</b><i> timeout.retransmit</i></dt>
<dd>
Specify the NFS timeout <i>interval</i>, in tenths of a second, between NFS/RPC retries (for UDP only).  The default is 0.8 seconds.  The second value alters the retransmit counter, which defaults to 11 retransmissions.  Both of these values are used by the kernel to communicate with amd.  Useful defaults are supplied if either or both values are missing.<div style="height: 1.00em;">
&#160;</div>
Amd relies on the kernel RPC retransmit mechanism to trigger mount retries. The values of these parameters change the overall retry interval.  Too long an interval gives poor interactive response; too short an interval causes excessive retries.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;v</b></dt>
<dd>
Version.  Displays version and configuration information on standard error.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;w</b><i> interval</i></dt>
<dd>
Specify an <i>interval</i>, in seconds, between attempts to dismount filesystems that have exceeded their cached times. The default is 2 minutes.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;x</b><i> options</i></dt>
<dd>
Specify run-time logging options.  The options are a comma separated list chosen from: fatal, error, user, warn, info, map, stats, defaults, and all.  Note that "fatal" and "error" are mandatory and cannot be turned off.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;y</b><i> domain</i></dt>
<dd>
Specify an alternative NIS domain from which to fetch the NIS maps. The default is the system domain name.  This option is ignored if NIS support is not available.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;A</b><i> arch</i></dt>
<dd>
Specifies the OS architecture.  This is used solely to set the ${arch} selector.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;C</b><i> cluster-name</i></dt>
<dd>
Specify an alternative HP-UX cluster name to use.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;D</b><i> option</i></dt>
<dd>
Select from a variety of debug options.  Prefixing an option with the strings <b>no</b> reverses the effect of that option.  Options are cumulative. The most useful option is <b>all</b>. Since <i>&#45;D</i> is only used for debugging other options are not documented here: the current supported set of options is listed by the &#45;v option and a fuller description is available in the program source.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;F</b><i> conf_file</i></dt>
<dd>
Specify an amd configuration file to use.  See <b>amd.conf</b>(5) for description of this file's format.  This configuration file is used to specify any options in lieu of typing many of them on the command line.  The <i>amd.conf</i> file includes directives for every command line option amd has, and many more that are only available via the configuration file facility.  The configuration file specified by this option is processed after all other options had been processed, regardless of the actual location of this option on the command line.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;H</b></dt>
<dd>
Print help and usage string.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;O</b><i> op_sys_name</i></dt>
<dd>
Override the compiled-in name of the operating system.  Useful when the built in name is not desired for backward compatibility reasons.  For example, if the build in name is ``sunos5'', you can override it to ``sos5'', and use older maps which were written with the latter in mind.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;S</b></dt>
<dd>
Do not lock the running executable pages of amd into memory.  To improve amd's performance, systems that support the <b>plock</b>(3) call, could lock the amd process into memory.  This way there is less chance the operating system will schedule, page out, and swap the amd process as needed.  This tends improves amd's performance, at the cost of reserving the memory used by the amd process (making it unavailable for other processes). If this behavior is not desired, use the <b>&#45;S</b> option.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;T</b><i> tag</i></dt>
<dd>
Specify a tag to use with <b>amd.conf</b>(5). All map entries tagged with <i>tag</i> will be processed.  Map entries that are not tagged are always processed. Map entries that are tagged with a tag other than <i>tag</i> will not be processed.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>FILES</h1><dl>
<dt>
<b>/a</b></dt>
<dd>
directory under which filesystems are dynamically mounted</dd>
</dl>
<dl>
<dt>
<b>/etc/amd.conf</b></dt>
<dd>
default configuration file</dd>
</dl>
</div>
<div class="section">
<h1>CAVEATS</h1> Some care may be required when creating a mount map.<p>
Symbolic links on an NFS filesystem can be incredibly inefficient. In most implementations of NFS, their interpolations are not cached by the kernel and each time a symlink is encountered during a <i>lookuppn</i> translation it costs an RPC call to the NFS server. It would appear that a large improvement in real-time performance could be gained by adding a cache somewhere. Replacing symlinks with a suitable incarnation of the auto-mounter results in a large real-time speedup, but also causes a large number of process context switches.<p>
A weird imagination is most useful to gain full advantage of all the features.</div>
<div class="section">
<h1>SEE ALSO</h1> <b>domainname</b>(1), <b>hostname</b>(1), <b>syslog</b>(3). <b>amd.conf</b>(5), <b>mtab</b>(5), <b>amq</b>(8), <b>mount</b>(8), <b>umount</b>(8),<p>
``am-utils'' <b>info</b>(1) entry.<p>
<i>Linux NFS and Automounter Administration</i> by Erez Zadok, ISBN 0-7821-2739-8, (Sybex, 2001).<p>
<i>http://www.am-utils.org</i><p>
<i>Amd &#45; The 4.4 BSD Automounter</i></div>
<div class="section">
<h1>AUTHORS</h1> Jan-Simon Pendry &lt;jsp@doc.ic.ac.uk&gt;, Department of Computing, Imperial College, London, UK.<p>
Erez Zadok &lt;ezk@cs.sunysb.edu&gt;, Computer Science Department, Stony Brook University, Stony Brook, New York, USA.<p>
Other authors and contributors to am-utils are listed in the <b>AUTHORS</b> file distributed with am-utils.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
3 November 1989</td>
<td class="foot-os" align="right">
</td>
</tr>
</table>
</div>
</body>
</html>

