<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
AFTERBOOT(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
AFTERBOOT(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
AFTERBOOT(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">afterboot</b> &#8212; <span class="desc">things to check after the first complete boot</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1><div class="subsection">
<h2 id="x5374617274696e67204f7574">Starting Out</h2> This document attempts to list items for the system administrator to check and set up after the installation and first complete boot of the system. The idea is to create a list of items that can be checked off so that you have a warm fuzzy feeling that something obvious has not been missed. A basic knowledge of <span class="unix">UNIX</span> is assumed.<p>
Complete instructions for correcting and fixing items is not provided. There are manual pages and other methodologies available for doing that. For example, to view the man page for the <a class="link-man" href="../1/ls">ls(1)</a> command, type:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
<b class="cmd">man 1 ls</b></pre>
<p>
Administrators will rapidly become more familiar with <span class="unix">NetBSD</span> if they get used to using the manual pages.</div>
<div class="subsection">
<h2 id="x536563757269747920616c65727473">Security alerts</h2> By the time that you have installed your system, it is quite likely that bugs in the release have been found. All significant and easily fixed problems will be reported at <a class="link-ext" href="http://www.NetBSD.org/support/security/">http://www.NetBSD.org/support/security/</a>. It is recommended that you check this page regularly.<p>
Additionally, you should set &#8220;fetch_pkg_vulnerabilities=YES&#8221; in <i class="file">/etc/daily.conf</i> to allow your system to automatically update the local database of known vulnerable packages to the latest version available on-line. The system will later check, on a daily basis, if any of your installed packages are vulnerable based on the contents of this database. See <a class="link-man" href="../5/daily.conf">daily.conf(5)</a> and <a class="link-man" href="../5/security.conf">security.conf(5)</a> for more details.</div>
<div class="subsection">
<h2 id="x4c6f67696e">Login</h2> Login as &#8220;<b class="cmd">root</b>&#8221;. You can do so on the console, or over the network using <a class="link-man" href="../1/ssh">ssh(1)</a>. If you have enabled the SSH daemon (see <a class="link-man" href="../8/sshd">sshd(8)</a>) and wish to allow root logins over the network, edit the <i class="file">/etc/ssh/sshd_config</i> file and set &#8220;PermitRootLogin&#8221; to &#8220;yes&#8221; (see <a class="link-man" href="../5/sshd_config">sshd_config(5)</a>). The default is to not permit root logins over the network after fresh install in <span class="unix">NetBSD</span>.<p>
Upon successful login on the console, you may see the message &#8220;We recommend creating a non-root account...&#8221;. For security reasons, it is bad practice to login as root during regular use and maintenance of the system. In fact, the system will only let you login as root on a secure terminal. By default, only the console is considered to be a secure terminal. Instead, administrators are encouraged to add a &#8220;regular&#8221; user, add said user to the &#8220;wheel&#8221; group, then use the <a class="link-man" href="../1/su">su(1)</a> command when root privileges are required. This process is described in more detail later.</div>
<div class="subsection">
<h2 id="x526f6f742070617373776f7264">Root password</h2> Change the password for the root user. (Note that throughout the documentation, the term &#8220;superuser&#8221; is a synonym for the root user.) Choose a password that has numbers, digits, and special characters (not space) as well as from the upper and lower case alphabet. Do not choose any word in any language. It is common for an intruder to use dictionary attacks. Type the command <b class="cmd">/usr/bin/passwd</b> to change it.<p>
It is a good idea to always specify the full path name for both the <a class="link-man" href="../1/passwd">passwd(1)</a> and <a class="link-man" href="../1/su">su(1)</a> commands as this inhibits the possibility of files placed in your execution <span class="env">PATH</span> for most shells. Furthermore, the superuser's <span class="env">PATH</span> should never contain the current directory (&#8220;.&#8221;).</div>
<div class="subsection">
<h2 id="x53797374656d2064617465">System date</h2> Check the system date with the <a class="link-man" href="../1/date">date(1)</a> command. If needed, change the date, and/or change the symbolic link of <i class="file">/etc/localtime</i> to the correct time zone in the <i class="file">/usr/share/zoneinfo</i> directory.<p>
Examples:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">date 200205101820</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Set the current date to May 10th, 2002 6:20pm.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ln -fs /usr/share/zoneinfo/Europe/Helsinki /etc/localtime</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Set the time zone to Eastern Europe Summer Time.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x436f6e736f6c652073657474696e6773">Console settings</h2> One of the first things you will likely need to do is to set up your keyboard map (and maybe some other aspects about the system console). To change your keyboard encoding, edit the &#8220;<b class="var">encoding</b>&#8221; variable found in <i class="file">/etc/wscons.conf</i>.<p>
<a class="link-man" href="../5/wscons.conf">wscons.conf(5)</a> contains more information about this file.</div>
<div class="subsection">
<h2 id="x436865636b20686f73746e616d65">Check hostname</h2> Use the <b class="cmd">hostname</b> command to verify that the name of your machine is correct. See the man page for <a class="link-man" href="../1/hostname">hostname(1)</a> if it needs to be changed. You will also need to change the contents of the &#8220;<b class="var">hostname</b>&#8221; variable in <i class="file">/etc/rc.conf</i> or edit the <i class="file">/etc/myname</i> file to have it stick around for the next reboot. Note that &#8220;<b class="var">hostname</b>&#8221; is supposed include a domainname, and that this should not be confused with YP (NIS) <a class="link-man" href="../1/domainname">domainname(1)</a>. If you are using <a class="link-man" href="../8/dhcpcd">dhcpcd(8)</a> to configure network interfaces, it might override these local hostname settings if your DHCP server specifies client's hostname with other network configurations.</div>
<div class="subsection">
<h2 id="x566572696679206e6574776f726b20696e7465726661636520636f6e66696775726174696f6e">Verify network interface configuration</h2> The first thing to do is an <b class="cmd">ifconfig -a</b> to see if the network interfaces are properly configured. Correct by editing <i class="file">/etc/ifconfig.</i><i class="arg">interface</i> or the corresponding &#8220;<b class="var">ifconfig_</b><i class="arg">interface</i>&#8221; variable in <a class="link-man" href="../5/rc.conf">rc.conf(5)</a> (where <i class="arg">interface</i> is the interface name, e.g., &#8220;le0&#8221;) and then using <a class="link-man" href="../8/ifconfig">ifconfig(8)</a> to manually configure it if you do not wish to reboot.<p>
Alternatively, you can configure interfaces automatically via DHCP with <a class="link-man" href="../8/dhcpcd">dhcpcd(8)</a> if you have a DHCP server running somewhere on your network. To get <a class="link-man" href="../8/dhcpcd">dhcpcd(8)</a> to start automatically on boot, you will need to have this line in <i class="file">/etc/rc.conf</i>:<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">dhcpcd=YES</code></div>
</blockquote>
<p>
See <a class="link-man" href="../8/dhcpcd">dhcpcd(8)</a> and <a class="link-man" href="../5/dhcpcd.conf">dhcpcd.conf(5)</a> for more information on setting up a DHCP client.<p>
You can add new &#8220;virtual interfaces&#8221; by adding the required entries to <i class="file">/etc/ifconfig.</i><i class="arg">interface</i>. Read the <a class="link-man" href="../5/ifconfig.if">ifconfig.if(5)</a> man page for more information on the format of <i class="file">/etc/ifconfig.</i><i class="arg">interface</i> files. The loopback interface will look something like:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
lo0: flags=8009&lt;UP,LOOPBACK,MULTICAST&gt; mtu 32972 
	inet 127.0.0.1 netmask 0xff000000 
	inet6 fe80::1%lo0 prefixlen 64 scopeid 0x3 
	inet6 ::1 prefixlen 128</pre>
<p>
an Ethernet interface something like:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
le0: flags=9863&lt;UP,BROADCAST,NOTRAILERS,RUNNING,SIMPLEX,MULTICAST&gt; 
	inet 192.168.4.52 netmask 0xffffff00 broadcast 192.168.4.255 
	inet6 fe80::5ef0:f0f0%le0 prefixlen 64 scopeid 0x1</pre>
<p>
and a PPP interface something like:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
ppp0: flags=8051&lt;UP,POINTOPOINT,RUNNING,MULTICAST&gt; 
        inet 203.3.131.108 --&gt; 198.181.0.253 netmask 0xffff0000</pre>
<p>
See <a class="link-man" href="../8/mrouted">mrouted(8)</a> for instructions on configuring multicast routing.</div>
<div class="subsection">
<h2 id="x436865636b20726f7574696e67207461626c6573">Check routing tables</h2> Issue a <b class="cmd">netstat -rn</b> command. The output will look something like:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
Routing tables 
 
Internet: 
Destination    Gateway           Flags  Refs     Use  Mtu  Interface 
default        192.168.4.254     UGS      0 11098028    -  le0 
127            127.0.0.1         UGRS     0        0    -  lo0 
127.0.0.1      127.0.0.1         UH       3       24    -  lo0 
192.168.4      link#1            UC       0        0    -  le0 
192.168.4.52   8:0:20:73:b8:4a   UHL      1     6707    -  le0 
192.168.4.254  0:60:3e:99:67:ea  UHL      1        0    -  le0 
 
Internet6: 
Destination        Gateway       Flags  Refs  Use     Mtu  Interface 
::/96              ::1           UGRS     0     0   32972  lo0 =&gt; 
::1                ::1           UH       4     0   32972  lo0 
::ffff:0.0.0.0/96  ::1           UGRS     0     0   32972  lo0 
fc80::/10          ::1           UGRS     0     0   32972  lo0 
fe80::/10          ::1           UGRS     0     0   32972  lo0 
fe80::%le0/64      link#1        UC       0     0    1500  le0 
fe80::%lo0/64      fe80::1%lo0   U        0     0   32972  lo0 
ff01::/32          ::1           U        0     0   32972  lo0 
ff02::%le0/32      link#1        UC       0     0    1500  le0 
ff02::%lo0/32      fe80::1%lo0   UC       0     0   32972  lo0</pre>
<p>
The default gateway address is stored in the &#8220;<b class="var">defaultroute</b>&#8221; variable in <i class="file">/etc/rc.conf</i>, or in the file <i class="file">/etc/mygate</i>. If you need to edit this file, a painless way to reconfigure the network afterwards is to issue<p>
<pre style="margin-left: 5.00ex;" class="lit display">
<b class="cmd">/etc/rc.d/network restart</b></pre>
<p>
Or, you may prefer to manually configure using a series of <b class="cmd">route add</b> and <b class="cmd">route delete</b> commands (see <a class="link-man" href="../8/route">route(8)</a>). If you run <a class="link-man" href="../8/dhclient">dhclient(8)</a> you will have to kill it by running<p>
<pre style="margin-left: 5.00ex;" class="lit display">
<b class="cmd">/etc/rc.d/dhclient stop</b></pre>
<p>
If you run <a class="link-man" href="../8/dhcpcd">dhcpcd(8)</a> you will have to kill it by running<p>
<pre style="margin-left: 5.00ex;" class="lit display">
<b class="cmd">/etc/rc.d/dhcpcd stop</b></pre>
<p>
before you flush the routes.<p>
If you wish to route packets between interfaces, add one or both of the following directives (depending on whether IPv4 or IPv6 routing is required) to <i class="file">/etc/sysctl.conf</i>:<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">net.inet.ip.forwarding=1</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">net.inet6.ip6.forwarding=1</code></div>
</blockquote>
<p>
As an alternative, compile a new kernel with the &#8220;GATEWAY&#8221; option. Packets are not forwarded by default, due to RFC requirements.</div>
<div class="subsection">
<h2 id="x536563757265205368656c6c202853534829">Secure Shell (SSH)</h2> By default, all services are disabled in a fresh <span class="unix">NetBSD</span> installation, and SSH is no exception. You may wish to enable it so you can remotely control your system. Set &#8220;<b class="var">sshd=YES</b>&#8221; in <i class="file">/etc/rc.conf</i> and then starting the server with the command<p>
<pre style="margin-left: 5.00ex;" class="lit display">
<b class="cmd">/etc/rc.d/sshd start</b></pre>
<p>
The first time the server is started, it will generate a new keypair, which will be stored inside the directory <i class="file">/etc/ssh</i>.</div>
<div class="subsection">
<h2 id="x486f7374206e616d657320616e6420444e53">Host names and DNS</h2> The system resolves host names according the rules for hosts in the name service switch configuration at <i class="file">/etc/nsswitch.conf</i>. By default, it will query <i class="file">/etc/hosts</i> first, and then the DNS resolver specified in <i class="file">/etc/resolv.conf</i>.<p>
If your network does not have a usable DNS resolver, e.g. one provided by DHCP, you can run a local caching recursive resolver by setting &#8220;named=YES&#8221; in <i class="file">/etc/rc.conf</i> and either rebooting or running the following command:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
<b class="cmd">/etc/rc.d/named start</b></pre>
<p>
<a class="link-man" href="../8/named">named(8)</a> is configured in <i class="file">/etc/named.conf</i> by default to run as a local caching recursive resolver. Then, to make the system use it, put the following in <i class="file">/etc/resolv.conf</i>:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
nameserver 127.0.0.1</pre>
</div>
<div class="subsection">
<h2 id="x5250431e6261736564206e6574776f726b207365727669636573">RPC-based network services</h2> Several services depend on the RPC portmapper <a class="link-man" href="../8/rpcbind">rpcbind(8)</a> - formerly known as <b class="cmd">portmap</b> - being running for proper operation. This includes YP (NIS) and NFS exports, among other services. To get the RPC portmapper to start automatically on boot, you will need to have this line in <i class="file">/etc/rc.conf</i>:<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">rpcbind=YES</code></div>
</blockquote>
</div>
<div class="subsection">
<h2 id="x595020284e495329205365747570">YP (NIS) Setup</h2> Check the YP domain name with the <a class="link-man" href="../1/domainname">domainname(1)</a> command. If necessary, correct it by editing the <i class="file">/etc/defaultdomain</i> file or by setting the &#8220;<b class="var">domainname</b>&#8221; variable in <i class="file">/etc/rc.conf</i>. The <i class="file">/etc/rc.d/network</i> script reads this file on bootup to determine and set the domain name. You may also set the running system's domain name with the <a class="link-man" href="../1/domainname">domainname(1)</a> command. To start YP client services, simply run <b class="cmd">ypbind</b>, then perform the remaining YP activation as described in <a class="link-man" href="../5/passwd">passwd(5)</a> and <a class="link-man" href="../5/group">group(5)</a>.<p>
In particular, to enable YP passwd support, you'll need to update <i class="file">/etc/nsswitch.conf</i> to include &#8220;nis&#8221; for the &#8220;passwd&#8221; and &#8220;group&#8221; entries. A traditional way to accomplish the same thing is to add following entry to local passwd database via <a class="link-man" href="../8/vipw">vipw(8)</a>:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
<code class="lit">+:*::::::::</code></pre>
<p>
Note this entry has to be the very last one. This traditional way works with the default <a class="link-man" href="../5/nsswitch.conf">nsswitch.conf(5)</a> setting of &#8220;passwd&#8221;, which is &#8220;compat&#8221;.<p>
There are many more YP man pages available to help you. You can find more information by starting with <a class="link-man" href="../8/nis">nis(8)</a>.</div>
<div class="subsection">
<h2 id="x436865636b206469736b206d6f756e7473">Check disk mounts</h2> Check that the disks are mounted correctly by comparing the <i class="file">/etc/fstab</i> file against the output of the <a class="link-man" href="../8/mount">mount(8)</a> and <a class="link-man" href="../1/df">df(1)</a> commands. Example:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
<code class="lit">#</code> <b class="cmd">cat /etc/fstab</b> 
/dev/sd0a / ffs     rw              1 1 
/dev/sd0b none swap sw 
/dev/sd0e /usr ffs  rw              1 2 
/dev/sd0f /var ffs  rw              1 3 
/dev/sd0g /tmp ffs  rw              1 4 
/dev/sd0h /home ffs rw              1 5 
 
<code class="lit">#</code> <b class="cmd">mount</b> 
/dev/sd0a on / type ffs (local) 
/dev/sd0e on /usr type ffs (local) 
/dev/sd0f on /var type ffs (local) 
/dev/sd0g on /tmp type ffs (local) 
/dev/sd0h on /home type ffs (local) 
 
<code class="lit">#</code> <b class="cmd">df</b> 
Filesystem  1024-blocks     Used    Avail Capacity  Mounted on 
/dev/sd0a         22311    14589     6606    69%    / 
/dev/sd0e        203399   150221    43008    78%    /usr 
/dev/sd0f         10447      682     9242     7%    /var 
/dev/sd0g         18823        2    17879     0%    /tmp 
/dev/sd0h          7519     5255     1888    74%    /home 
 
<code class="lit">#</code> <b class="cmd">pstat -s</b> 
Device      512-blocks     Used    Avail Capacity  Priority 
/dev/sd0b       131072    84656    46416    65%    0</pre>
<p>
Edit <i class="file">/etc/fstab</i> and use the <a class="link-man" href="../8/mount">mount(8)</a> and <a class="link-man" href="../8/umount">umount(8)</a> commands as appropriate. Refer to the above example and <a class="link-man" href="../5/fstab">fstab(5)</a> for information on the format of this file.<p>
You may wish to do NFS mounts now too, or you can do them later.</div>
<div class="subsection">
<h2 id="x436f6e636174656e61746564206469736b73202863636429">Concatenated disks (ccd)</h2> If you are using <a class="link-man" href="../4/ccd">ccd(4)</a> concatenated disks, edit <i class="file">/etc/ccd.conf</i>. You may wish to take a look to <a class="link-man" href="../8/ccdconfig">ccdconfig(8)</a> for more information about this file. Use the <b class="cmd">ccdconfig -U</b> command to unload and the <b class="cmd">ccdconfig -C</b> command to create tables internal to the kernel for the concatenated disks. You then <a class="link-man" href="../8/mount">mount(8)</a>, <a class="link-man" href="../8/umount">umount(8)</a>, and edit <i class="file">/etc/fstab</i> as needed.</div>
<div class="subsection">
<h2 id="x4175746f6d6f756e746572206461656d6f6e2028414d4429">Automounter daemon (AMD)</h2> To use the <a class="link-man" href="../8/amd">amd(8)</a> automounter, create the <i class="file">/etc/amd</i> directory, copy example config files from <i class="file">/usr/share/examples/amd</i> to <i class="file">/etc/amd</i> and customize them as needed. Alternatively, you can get your maps with YP.</div>
<div class="subsection">
<h2 id="x436c6f636b2073796e6368726f6e697a6174696f6e">Clock synchronization</h2> In order to make sure the system clock is synchronized to that of a publicly accessible NTP server, make sure that <i class="file">/etc/rc.conf</i> contains the following:<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">ntpdate=YES</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">ntpd=YES</code></div>
</blockquote>
<p>
See <a class="link-man" href="../1/date">date(1)</a>, <a class="link-man" href="../8/ntpdate">ntpdate(8)</a>, <a class="link-man" href="../8/ntpd">ntpd(8)</a>, <a class="link-man" href="../8/rdate">rdate(8)</a>, and <a class="link-man" href="../8/timed">timed(8)</a> for more information on setting the system's date.</div>
</div>
<div class="section">
<h1 id="x4348414e47494e47202f6574632046494c4553">CHANGING /etc FILES</h1> The system should be usable now, but you may wish to do more customizing, such as adding users, etc. Many of the following sections may be skipped if you are not using that package (for example, skip the <i class="link-sec"><a class="link-sec" href="#x4b65726265726f73">Kerberos</a></i> section if you won't be using Kerberos). We suggest that you <b class="cmd">cd /etc</b> and edit most of the files in that directory.<p>
Note that the <i class="file">/etc/motd</i> file is modified by <i class="file">/etc/rc.d/motd</i> whenever the system is booted. To keep any custom message intact, ensure that you leave two blank lines at the top, or your message will be overwritten.<div class="subsection">
<h2 id="x416464206e6577207573657273">Add new users</h2> To add new users and groups, there are <a class="link-man" href="../8/useradd">useradd(8)</a> and <a class="link-man" href="../8/groupadd">groupadd(8)</a>; see also <a class="link-man" href="../8/user">user(8)</a> for further programs for user and group manipulation. You may use <a class="link-man" href="../8/vipw">vipw(8)</a> to add users to the <i class="file">/etc/passwd</i> file and edit <i class="file">/etc/group</i> by hand to add new groups. The manual page for <a class="link-man" href="../1/su">su(1)</a>, tells you to make sure to put people in the &#8216;wheel&#8217; group if they need root access (non-Kerberos). For example:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
wheel:*:0:root,myself</pre>
<p>
Follow instructions for <a class="link-man" href="../8/kerberos">kerberos(8)</a> if using Kerberos for authentication.</div>
<div class="subsection">
<h2 id="x53797374656d20626f6f74207363726970747320616e64202f6574632f72632e6c6f63616c">System boot scripts and /etc/rc.local</h2> <i class="file">/etc/rc</i> and the <i class="file">/etc/rc.d/*</i> scripts are invoked at boot time after single user mode has exited, and at shutdown. The whole process is controlled by the master script <i class="file">/etc/rc</i>. This script should not be changed by administrators.<p>
The directory <i class="file">/etc/rc.d</i> contains a series of scripts used at startup/shutdown, called by <i class="file">/etc/rc</i>. <i class="file">/etc/rc</i> is in turn influenced by the configuration variables present in <i class="file">/etc/rc.conf</i>.<p>
The script <i class="file">/etc/rc.local</i> is run as the last thing during multiuser boot, and is provided to allow any other local hooks necessary for the system.</div>
<div class="subsection">
<h2 id="x72632e636f6e66">rc.conf</h2> To enable or disable various services on system startup, corresponding entries can be made in <i class="file">/etc/rc.conf</i>. You can take a look at <i class="file">/etc/defaults/rc.conf</i> to see a list of default system variables, which you can override in <i class="file">/etc/rc.conf</i>. Note you are <span class="emph">not</span> supposed to change <i class="file">/etc/defaults/rc.conf</i> directly, edit only <i class="file">/etc/rc.conf</i>. See <a class="link-man" href="../5/rc.conf">rc.conf(5)</a> for further information.</div>
<div class="subsection">
<h2 id="x5820446973706c6179204d616e61676572">X Display Manager</h2> If you've installed X, you may want to turn on <a class="link-man" href="../1/xdm">xdm(1)</a>, the X Display Manager. To do this, set &#8220;xdm=YES&#8221; in <i class="file">/etc/rc.conf</i>.</div>
<div class="subsection">
<h2 id="x5072696e74657273">Printers</h2> Edit <i class="file">/etc/printcap</i> and <i class="file">/etc/hosts.lpd</i> to get any printers set up. Consult <a class="link-man" href="../8/lpd">lpd(8)</a> and <a class="link-man" href="../5/printcap">printcap(5)</a> if needed.</div>
<div class="subsection">
<h2 id="x5469676874656e207570207365637572697479">Tighten up security</h2> In <i class="file">/etc/inetd.conf</i> comment out any extra entries you do not need, and only add things that are really needed. Note that by default all services are disabled for security reasons.</div>
<div class="subsection">
<h2 id="x4b65726265726f73">Kerberos</h2> If you are going to use Kerberos for authentication, see <a class="link-man" href="../8/kerberos">kerberos(8)</a> and &#8220;info heimdal&#8221; for more information. If you already have a Kerberos master, change directory to <i class="file">/etc/kerberosV</i> and configure. Remember to get a <i class="file">srvtab</i> from the master so that the remote commands work.</div>
<div class="subsection">
<h2 id="x4d61696c20416c6961736573">Mail Aliases</h2> Check <i class="file">/etc/mail/aliases</i> and update appropriately if you want e-mail to be routed to non-local addresses or to different users.<p>
Run <a class="link-man" href="../1/newaliases">newaliases(1)</a> after changes.</div>
<div class="subsection">
<h2 id="x506f7374666978">Postfix</h2> <span class="unix">NetBSD</span> uses Postfix as its MTA. Postfix is started by default, but its initial configuration does not cause it to listen on the network for incoming connections. To configure Postfix, see <i class="file">/etc/postfix/main.cf</i> and <i class="file">/etc/postfix/master.cf</i>. If you wish to use a different MTA (e.g., sendmail), install your MTA of choice and edit <i class="file">/etc/mailer.conf</i> to point to the proper binaries.</div>
<div class="subsection">
<h2 id="x4448435020736572766572">DHCP server</h2> If this is a DHCP server, edit <i class="file">/etc/dhcpd.conf</i> and <i class="file">/etc/dhcpd.interfaces</i> as needed. You will have to make sure <i class="file">/etc/rc.conf</i> has &#8220;dhcpd=YES&#8221; or run <a class="link-man" href="../8/dhcpd">dhcpd(8)</a> manually.</div>
<div class="subsection">
<h2 id="x426f6f74706172616d20736572766572">Bootparam server</h2> If this is a Bootparam server, edit <i class="file">/etc/bootparams</i> as needed. You will have to turn it on in <i class="file">/etc/rc.conf</i> by adding &#8220;bootparamd=YES&#8221;.</div>
<div class="subsection">
<h2 id="x4e465320736572766572">NFS server</h2> If this is an NFS server, make sure <i class="file">/etc/rc.conf</i> has:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
nfs_server=YES 
mountd=YES 
rpcbind=YES</pre>
<p>
Edit <i class="file">/etc/exports</i> and get it correct. After this, you can start the server by issuing:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
<b class="cmd">/etc/rc.d/rpcbind start</b> 
<b class="cmd">/etc/rc.d/mountd start</b> 
<b class="cmd">/etc/rc.d/nfsd start</b></pre>
which will also start dependencies.</div>
<div class="subsection">
<h2 id="x48502072656d6f746520626f6f7420736572766572">HP remote boot server</h2> Edit <i class="file">/etc/rbootd.conf</i> if needed for remote booting. If you do not have HP computers doing remote booting, do not enable this.</div>
<div class="subsection">
<h2 id="x4461696c792c207765656b6c792c206d6f6e74686c792073637269707473">Daily, weekly, monthly scripts</h2> Look at and possibly edit the <i class="file">/etc/daily.conf</i>, <i class="file">/etc/weekly.conf</i>, and <i class="file">/etc/monthly.conf</i> configuration files. You can check which values you can set by looking to their matching files in <i class="file">/etc/defaults</i>. Your site specific things should go into <i class="file">/etc/daily.local</i>, <i class="file">/etc/weekly.local</i>, and <i class="file">/etc/monthly.local</i>.<p>
These scripts have been limited so as to keep the system running without filling up disk space from normal running processes and database updates. (You probably do not need to understand them.)</div>
<div class="subsection">
<h2 id="x4f746865722066696c657320696e202f657463">Other files in /etc</h2> Look at the other files in <i class="file">/etc</i> and edit them as needed. (Do not edit files ending in <i class="file">.db</i> &#8212; like <i class="file">pwd.db</i>, <i class="file">spwd.db</i>, nor <i class="file">localtime</i>, nor <i class="file">rmt</i>, nor any directories.)</div>
<div class="subsection">
<h2 id="x43726f6e74616220286261636b67726f756e642072756e6e696e672070726f63657373657329">Crontab (background running processes)</h2> Check what is running by typing <b class="cmd">crontab -l</b> as root and see if anything unexpected is present. Do you need anything else? Do you wish to change things? For example, if you do not like root getting standard output of the daily scripts, and want only the security scripts that are mailed internally, you can type <b class="cmd">crontab -e</b> and change some of the lines to read:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
30  1  *  *  *   /bin/sh /etc/daily 2&gt;&amp;1 &gt; /var/log/daily.out 
30  3  *  *  6   /bin/sh /etc/weekly 2&gt;&amp;1 &gt; /var/log/weekly.out 
30  5  1  *  *   /bin/sh /etc/monthly 2&gt;&amp;1 &gt; /var/log/monthly.out</pre>
<p>
See <a class="link-man" href="../5/crontab">crontab(5)</a>.</div>
<div class="subsection">
<h2 id="x4e6578742064617920636c65616e7570">Next day cleanup</h2> After the first night's security run, change ownerships and permissions on files, directories, and devices; root should have received mail with subject: "&lt;hostname&gt; daily insecurity output.". This mail contains a set of security recommendations, presented as a list looking like this:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
var/mail: 
        permissions (0755, 0775) 
etc/daily: 
        user (0, 3)</pre>
<p>
The best bet is to follow the advice in that list. The recommended setting is the first item in parentheses, while the current setting is the second one. This list is generated by <a class="link-man" href="../8/mtree">mtree(8)</a> using <i class="file">/etc/mtree/special</i>. Use <a class="link-man" href="../1/chmod">chmod(1)</a>, <a class="link-man" href="../1/chgrp">chgrp(1)</a>, and <a class="link-man" href="../8/chown">chown(8)</a> as needed.</div>
<div class="subsection">
<h2 id="x5061636b61676573">Packages</h2> Install your own packages. The <span class="unix">NetBSD</span> packages collection, pkgsrc, includes a large set of third-party software. A lot of it is available as binary packages that you can download from <a class="link-ext" href="ftp://ftp.NetBSD.org/pub/NetBSD/packages/">ftp://ftp.NetBSD.org/pub/NetBSD/packages/</a> or a mirror, and install using <a class="link-man" href="../1/pkg_add">pkg_add(1)</a>. See <a class="link-ext" href="http://www.NetBSD.org/docs/pkgsrc/">http://www.NetBSD.org/docs/pkgsrc/</a> and <i class="file">pkgsrc/doc/pkgsrc.txt</i> for more details.<p>
Copy vendor binaries and install them. You will need to install any shared libraries, etc. (Hint: <b class="cmd">man -k compat</b> to find out how to install and use compatibility mode.)<p>
There is also other third-party software that is available in source form only, either because it has not been ported to <span class="unix">NetBSD</span> yet, because licensing restrictions make binary redistribution impossible, or simply because you want to build your own binaries. Sometimes checking the mailing lists for past problems that people have encountered will result in a fix posted.</div>
<div class="subsection">
<h2 id="x436865636b207468652072756e6e696e672073797374656d">Check the running system</h2> You can use <a class="link-man" href="../1/ps">ps(1)</a>, <a class="link-man" href="../1/netstat">netstat(1)</a>, and <a class="link-man" href="../1/fstat">fstat(1)</a> to check on running processes, network connections, and opened files, respectively. Other tools you may find useful are <a class="link-man" href="../1/systat">systat(1)</a> and <a class="link-man" href="../1/top">top(1)</a>.</div>
</div>
<div class="section">
<h1 id="x434f4d50494c494e472041204b45524e454c">COMPILING A KERNEL</h1> Note: The standard <span class="unix">NetBSD</span> kernel configuration (GENERIC) is suitable for most purposes.<p>
First, review the system message buffer in <i class="file">/var/run/dmesg.boot</i> and by using the <a class="link-man" href="../8/dmesg">dmesg(8)</a> command to find out information on your system's devices as probed by the kernel at boot. In particular, note which devices were not configured. This information will prove useful when editing kernel configuration files.<p>
To compile a kernel inside a writable source tree, do the following:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
$ cd /usr/src/sys/arch/SOMEARCH/conf 
$ cp GENERIC SOMEFILE (only the first time) 
$ vi SOMEFILE (adapt to your needs) 
$ config SOMEFILE 
$ cd ../compile/SOMEFILE 
$ make depend 
$ make</pre>
<p>
where <i class="arg">SOMEARCH</i> is the architecture (e.g., i386), and <i class="arg">SOMEFILE</i> should be a name indicative of a particular configuration (often that of the hostname).<p>
If you are building your kernel again, before you do a <b class="cmd">make</b> you should do a <b class="cmd">make clean</b> after making changes to your kernel options.<p>
After either of these two methods, you can place the new kernel (called <i class="file">netbsd</i>) in <i class="file">/</i> (i.e., <i class="file">/netbsd</i>) by issuing <b class="cmd">make install</b> and the system will boot it next time. The old kernel is stored as <i class="file">/onetbsd</i> so you can boot it in case of failure.<p>
If you are using toolchain to build your kernel, you will also need to build a new set of toolchain binaries. You can do it by changing into <i class="file">/usr/src</i> and issuing:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
$ cd /usr/src 
$ K=sys/arch/`uname -m`/conf 
$ cp $K/GENERIC $K/SOMEFILE 
$ vi $K/SOMEFILE (adapt to your needs) 
$ ./build.sh tools 
$ ./build.sh kernel=SOMEFILE</pre>
</div>
<div class="section">
<h1 id="x53595354454d2054455354494e47">SYSTEM TESTING</h1> At this point, the system should be fully configured to your liking. It is now a good time to ensure that the system behaves according to its specifications and that it is stable on your hardware. Please refer to <a class="link-man" href="../7/tests">tests(7)</a> for details on how to do so.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/chgrp">chgrp(1)</a>, <a class="link-man" href="../1/chmod">chmod(1)</a>, <a class="link-man" href="../1/config">config(1)</a>, <a class="link-man" href="../1/crontab">crontab(1)</a>, <a class="link-man" href="../1/date">date(1)</a>, <a class="link-man" href="../1/df">df(1)</a>, <a class="link-man" href="../1/domainname">domainname(1)</a>, <a class="link-man" href="../1/fstat">fstat(1)</a>, <a class="link-man" href="../1/hostname">hostname(1)</a>, <a class="link-man" href="../1/make">make(1)</a>, <a class="link-man" href="../1/man">man(1)</a>, <a class="link-man" href="../1/netstat">netstat(1)</a>, <a class="link-man" href="../1/newaliases">newaliases(1)</a>, <a class="link-man" href="../1/passwd">passwd(1)</a>, <a class="link-man" href="../1/pkg_add">pkg_add(1)</a>, <a class="link-man" href="../1/ps">ps(1)</a>, <a class="link-man" href="../1/ssh">ssh(1)</a>, <a class="link-man" href="../1/su">su(1)</a>, <a class="link-man" href="../1/systat">systat(1)</a>, <a class="link-man" href="../1/top">top(1)</a>, <a class="link-man" href="../1/xdm">xdm(1)</a>, <a class="link-man" href="../4/ccd">ccd(4)</a>, <a class="link-man" href="../5/aliases">aliases(5)</a>, <a class="link-man" href="../5/crontab">crontab(5)</a>, <a class="link-man" href="../5/dhclient.conf">dhclient.conf(5)</a>, <a class="link-man" href="../5/dhcpcd.conf">dhcpcd.conf(5)</a>, <a class="link-man" href="../5/exports">exports(5)</a>, <a class="link-man" href="../5/fstab">fstab(5)</a>, <a class="link-man" href="../5/group">group(5)</a>, <a class="link-man" href="../5/hosts">hosts(5)</a>, <a class="link-man" href="../5/ifconfig.if">ifconfig.if(5)</a>, <a class="link-man" href="../5/mailer.conf">mailer.conf(5)</a>, <a class="link-man" href="../5/named.conf">named.conf(5)</a>, <a class="link-man" href="../5/nsswitch.conf">nsswitch.conf(5)</a>, <a class="link-man" href="../5/passwd">passwd(5)</a>, <a class="link-man" href="../5/printcap">printcap(5)</a>, <a class="link-man" href="../5/rc.conf">rc.conf(5)</a>, <a class="link-man" href="../5/resolv.conf">resolv.conf(5)</a>, <a class="link-man" href="../5/sshd_config">sshd_config(5)</a>, <a class="link-man" href="../5/wscons.conf">wscons.conf(5)</a>, <a class="link-man" href="../7/hier">hier(7)</a>, <a class="link-man" href="../7/hostname">hostname(7)</a>, <a class="link-man" href="../7/pkgsrc">pkgsrc(7)</a>, <a class="link-man" href="../7/tests">tests(7)</a>, <a class="link-man" href="../8/amd">amd(8)</a>, <a class="link-man" href="../8/ccdconfig">ccdconfig(8)</a>, <a class="link-man" href="../8/chown">chown(8)</a>, <a class="link-man" href="../8/dhclient">dhclient(8)</a>, <a class="link-man" href="../8/dhcpcd">dhcpcd(8)</a>, <a class="link-man" href="../8/dhcpd">dhcpd(8)</a>, <a class="link-man" href="../8/dmesg">dmesg(8)</a>, <a class="link-man" href="../8/groupadd">groupadd(8)</a>, <a class="link-man" href="../8/ifconfig">ifconfig(8)</a>, <a class="link-man" href="../8/inetd">inetd(8)</a>, <a class="link-man" href="../8/kerberos">kerberos(8)</a>, <a class="link-man" href="../8/lpd">lpd(8)</a>, <a class="link-man" href="../8/mount">mount(8)</a>, <a class="link-man" href="../8/mrouted">mrouted(8)</a>, <a class="link-man" href="../8/mtree">mtree(8)</a>, <a class="link-man" href="../8/named">named(8)</a>, <a class="link-man" href="../8/nis">nis(8)</a>, <a class="link-man" href="../8/ntpd">ntpd(8)</a>, <a class="link-man" href="../8/ntpdate">ntpdate(8)</a>, <a class="link-man" href="../8/rbootd">rbootd(8)</a>, <a class="link-man" href="../8/rc">rc(8)</a>, <a class="link-man" href="../8/rdate">rdate(8)</a>, <a class="link-man" href="../8/rmt">rmt(8)</a>, <a class="link-man" href="../8/route">route(8)</a>, <a class="link-man" href="../8/rpc.bootparamd">rpc.bootparamd(8)</a>, <a class="link-man" href="../8/rpcbind">rpcbind(8)</a>, <a class="link-man" href="../8/sshd">sshd(8)</a>, <a class="link-man" href="../8/timed">timed(8)</a>, <a class="link-man" href="../8/umount">umount(8)</a>, <a class="link-man" href="../8/useradd">useradd(8)</a>, <a class="link-man" href="../8/vipw">vipw(8)</a>, <a class="link-man" href="../8/yp">yp(8)</a>, <a class="link-man" href="../8/ypbind">ypbind(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> This document first appeared in <span class="unix">OpenBSD&#160;2.2</span>. It has been adapted to <span class="unix">NetBSD</span> and first appeared in <span class="unix">NetBSD&#160;2.0</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
October 2, 2012</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

