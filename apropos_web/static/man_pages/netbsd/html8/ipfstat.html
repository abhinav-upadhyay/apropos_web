<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
IPFSTAT(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
IPFSTAT(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
IPFSTAT(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> ipfstat &#45; reports on packet filter statistics and filter list</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>ipfstat</b> [ <b>&#45;6aAdfghIilnoRsv</b> ]<div style="height: 0.00em;">
&#160;</div>
<b>ipfstat -t</b> [ <b>&#45;6C</b> ] [ <b>&#45;D</b> &lt;addrport&gt; ] [ <b>&#45;P</b> &lt;protocol&gt; ] [ <b>&#45;S</b> &lt;addrport&gt; ] [ <b>&#45;T</b> &lt;refresh time&gt; ]</div>
<div class="section">
<h1>DESCRIPTION</h1>  <b>ipfstat</b> examines /dev/kmem using the symbols <b>_fr_flags</b>,  <b>_frstats</b>, <b>_filterin</b>, and <b>_filterout</b>. To run and work, it needs to be able to read both /dev/kmem and the kernel itself.  The kernel name defaults to  <b>/netbsd</b>.<p>
The default behaviour of <b>ipfstat</b> is to retrieve and display the accumulated statistics which have been accumulated over time as the kernel has put packets through the filter.</div>
<div class="section">
<h1>OPTIONS</h1><dl>
<dt>
<b>&#45;6</b></dt>
<dd>
Display filter lists and states for IPv6, if available.</dd>
</dl>
<dl>
<dt>
<b>&#45;a</b></dt>
<dd>
Display the accounting filter list and show bytes counted against each rule.</dd>
</dl>
<dl>
<dt>
<b>&#45;A</b></dt>
<dd>
Display packet authentication statistics.</dd>
</dl>
<dl>
<dt>
<b>&#45;C</b></dt>
<dd>
This option is only valid in combination with <b>&#45;t</b>. Display "closed" states as well in the top. Normally, a TCP connection is not displayed when it reaches the CLOSE_WAIT protocol state. With this option enabled, all state entries are displayed.</dd>
</dl>
<dl>
<dt>
<b>&#45;d</b></dt>
<dd>
Produce debugging output when displaying data.</dd>
</dl>
<dl>
<dt>
<b>&#45;D</b>&#8194;&lt;addrport&gt;</dt>
<dd>
This option is only valid in combination with <b>&#45;t</b>. Limit the state top display to show only state entries whose destination IP address and port match the addrport argument. The addrport specification is of the form ipaddress[,port].  The ipaddress and port should be either numerical or the string "any" (specifying any IP address resp. any port). If the  <b>&#45;D</b> option is not specified, it defaults to " <b>&#45;D</b> any,any".</dd>
</dl>
<dl>
<dt>
<b>&#45;f</b></dt>
<dd>
Show fragment state information (statistics) and held state information (in the kernel) if any is present.</dd>
</dl>
<dl>
<dt>
<b>&#45;g</b></dt>
<dd>
Show groups currently configured (both active and inactive).</dd>
</dl>
<dl>
<dt>
<b>&#45;h</b></dt>
<dd>
Show per-rule the number of times each one scores a "hit".  For use in combination with  <b>&#45;i</b>.</dd>
</dl>
<dl>
<dt>
<b>&#45;i</b></dt>
<dd>
Display the filter list used for the input side of the kernel IP processing.</dd>
</dl>
<dl>
<dt>
<b>&#45;I</b></dt>
<dd>
Swap between retrieving "inactive"/"active" filter list details.  For use in combination with  <b>&#45;i</b>.</dd>
</dl>
<dl>
<dt>
<b>&#45;n</b></dt>
<dd>
Show the "rule number" for each rule as it is printed.</dd>
</dl>
<dl>
<dt>
<b>&#45;o</b></dt>
<dd>
Display the filter list used for the output side of the kernel IP processing.</dd>
</dl>
<dl>
<dt>
<b>&#45;P</b>&#8194;&lt;protocol&gt;</dt>
<dd>
This option is only valid in combination with <b>&#45;t</b>. Limit the state top display to show only state entries that match a specific protocol. The argument can be a protocol name (as defined in  <b>/etc/protocols</b>) or a protocol number. If this option is not specified, state entries for any protocol are specified.</dd>
</dl>
<dl>
<dt>
<b>&#45;R</b></dt>
<dd>
Don't try to resolve addresses to hostnames and ports to services while printing statistics.</dd>
</dl>
<dl>
<dt>
<b>&#45;s</b></dt>
<dd>
Show packet/flow state information (statistics only).</dd>
</dl>
<dl>
<dt>
<b>&#45;sl</b></dt>
<dd>
Show held state information (in the kernel) if any is present (no statistics).</dd>
</dl>
<dl>
<dt>
<b>&#45;S</b>&#8194;&lt;addrport&gt;</dt>
<dd>
This option is only valid in combination with <b>&#45;t</b>. Limit the state top display to show only state entries whose source IP address and port match the addrport argument. The addrport specification is of the form ipaddress[,port].  The ipaddress and port should be either numerical or the string "any" (specifying any IP address resp. any port). If the  <b>&#45;S</b> option is not specified, it defaults to " <b>&#45;S</b> any,any".</dd>
</dl>
<dl>
<dt>
<b>&#45;t</b></dt>
<dd>
Show the state table in a way similar to the way <b>top(1)</b> shows the process table. States can be sorted using a number of different ways. This option requires  <b>curses(3)</b> and needs to be compiled in. It may not be available on all operating systems. See below, for more information on the keys that can be used while ipfstat is in top mode.</dd>
</dl>
<dl>
<dt>
<b>&#45;T</b>&#8194;&lt;refreshtime&gt;</dt>
<dd>
This option is only valid in combination with <b>&#45;t</b>. Specifies how often the state top display should be updated. The refresh time is the number of seconds between an update. Any positive integer can be used. The default (and minimal update time) is 1.</dd>
</dl>
<dl>
<dt>
<b>&#45;v</b></dt>
<dd>
Turn verbose mode on.  Displays more debugging information.  When used with either  <b>-i</b> or <b>-o</b>, counters associated with the rule, such as the number of times it has been matched and the number of bytes from such packets is displayed.  For "keep state" rules, a count of the number of state sessions active against the rule is also displayed.</dd>
</dl>
</div>
<div class="section">
<h1>SYNOPSIS</h1> The role of  <b>ipfstat</b> is to display current kernel statistics gathered as a result of applying the filters in place (if any) to packets going in and out of the kernel.  This is the default operation when no command line parameters are present.<p>
When supplied with either <b>&#45;i</b> or <b>&#45;o</b>, it will retrieve and display the appropriate list of filter rules currently installed and in use by the kernel.<p>
One of the statistics that <b>ipfstat</b> shows is <b>ticks</b>. This number indicates how long the filter has been enabled. The number is incremented every half&#45;second.</div>
<div class="section">
<h1>STATE TOP</h1> Using the  <b>&#45;t</b> option <b>ipfstat</b> will enter the state top mode. In this mode the state table is displayed similar to the way  <b>top</b> displays the process table. The  <b>&#45;C</b>, <b>&#45;D</b>, <b>&#45;P</b>, <b>&#45;S</b> and <b>&#45;T</b> command line options can be used to restrict the state entries that will be shown and to specify the frequency of display updates.<p>
In state top mode, the following keys can be used to influence the displayed information:<dl>
<dt>
<b>b</b> show packets/bytes from backward direction.</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
<b>f</b> show packets/bytes from forward direction. (default)</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
<b>l</b> redraw the screen.</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
<b>q</b> quit the program.</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
<b>s</b> switch between different sorting criterion.</dt>
<dd>
</dd>
</dl>
<dl>
<dt>
<b>r</b> reverse the sorting criterion.</dt>
<dd>
</dd>
</dl>
<p>
States can be sorted by protocol number, by number of IP packets, by number of bytes and by time-to-live of the state entry. The default is to sort by the number of bytes. States are sorted in descending order, but you can use the  <b>r</b> key to sort them in ascending order.</div>
<div class="section">
<h1>STATE TOP LIMITATIONS</h1> It is currently not possible to interactively change the source, destination and protocol filters or the refresh frequency. This must be done from the command line.<p>
The screen must have at least 80 columns. This is however not checked. When running state top in IPv6 mode, the screen must be much wider to display the very long IPv6 addresses.<p>
Only the first X-5 entries that match the sort and filter criteria are displayed (where X is the number of rows on the display. The only way to see more entries is to resize the screen.</div>
<div class="section">
<h1>FILES</h1> /dev/kmem<div style="height: 0.00em;">
&#160;</div>
/dev/ipl<div style="height: 0.00em;">
&#160;</div>
/dev/ipstate<div style="height: 0.00em;">
&#160;</div>
/netbsd</div>
<div class="section">
<h1>SEE ALSO</h1> ipf(8)</div>
<div class="section">
<h1>BUGS</h1> none known.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
</td>
<td class="foot-os" align="right">
</td>
</tr>
</table>
</div>
</body>
</html>

