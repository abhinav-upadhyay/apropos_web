<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
PAM_SSH(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
PAM_SSH(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
PAM_SSH(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">pam_ssh</b> &#8212; <span class="desc">authentication and session management with SSH private keys</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> &#91;<span class="opt"><i class="arg">service-name</i></span>&#93; <i class="arg">module-type</i> <i class="arg">control-flag</i> <i class="file">pam_ssh</i> &#91;<span class="opt"><i class="arg">options</i></span>&#93;</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The SSH authentication service module for PAM provides functionality for two PAM categories: authentication and session management. In terms of the <i class="arg">module-type</i> parameter, they are the &#8220;<code class="lit">auth</code>&#8221; and &#8220;<code class="lit">session</code>&#8221; features.<div class="subsection">
<h2 id="x5353482041757468656e7469636174696f6e204d6f64756c65">SSH Authentication Module</h2> The SSH authentication component provides a function to verify the identity of a user (<b class="fname">pam_sm_authenticate</b>()), by prompting the user for a passphrase and verifying that it can decrypt the target user's SSH key using that passphrase.<p>
The following options may be passed to the authentication module:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">use_first_pass</b></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
If the authentication module is not the first in the stack, and a previous module obtained the user's password, that password is used to authenticate the user. If this fails, the authentication module returns failure without prompting the user for a password. This option has no effect if the authentication module is the first in the stack, or if no previous modules obtained the user's password.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">try_first_pass</b></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
This option is similar to the <b class="flag">use_first_pass</b> option, except that if the previously obtained password fails, the user is prompted for another password.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">nullok</b></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Normally, keys with no passphrase are ignored for authentication purposes. If this option is set, keys with no passphrase will be taken into consideration, allowing the user to log in with a blank password.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x5353482053657373696f6e204d616e6167656d656e74204d6f64756c65">SSH Session Management Module</h2> The SSH session management component provides functions to initiate (<b class="fname">pam_sm_open_session</b>()) and terminate (<b class="fname">pam_sm_close_session</b>()) sessions. The <b class="fname">pam_sm_open_session</b>() function starts an SSH agent, passing it any private keys it decrypted during the authentication phase, and sets the environment variables the agent specifies. The <b class="fname">pam_sm_close_session</b>() function kills the previously started SSH agent by sending it a <span class="define">SIGTERM</span>.<p>
The following options may be passed to the session management module:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">want_agent</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Start an agent even if no keys were decrypted during the authentication phase.</dd>
</dl>
</div>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">$HOME/.ssh/identity</i></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
SSH1 RSA key</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">$HOME/.ssh/id_rsa</i></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
SSH2 RSA key</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">$HOME/.ssh/id_dsa</i></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
SSH2 DSA key</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">$HOME/.ssh/id_ecdsa</i></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
SSH2 ECDSA key</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/ssh-agent">ssh-agent(1)</a>, <a class="link-man" href="../5/pam.conf">pam.conf(5)</a>, <a class="link-man" href="../8/pam">pam(8)</a></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="name">pam_ssh</b> module was originally written by <span class="author"></span><span class="author">Andrew J. Korty</span> &#60;<a class="link-mail" href="mailto:ajk@iu.edu">ajk@iu.edu</a>&#62;. The current implementation was developed for the <span class="unix">FreeBSD</span> Project by ThinkSec AS and NAI Labs, the Security Research Division of Network Associates, Inc. under DARPA/SPAWAR contract N66001-01-C-8035 (&#8220;CBOSS&#8221;), as part of the DARPA CHATS research program. This manual page was written by <span class="author">Mark R V Murray</span> &#60;<a class="link-mail" href="mailto:markm@FreeBSD.org">markm@FreeBSD.org</a>&#62;.</div>
<div class="section">
<h1 id="x534543555249545920434f4e53494445524154494f4e53">SECURITY CONSIDERATIONS</h1> The <b class="name">pam_ssh</b> module implements what is fundamentally a password authentication scheme. Care should be taken to only use this module over a secure session (secure TTY, encrypted session, etc.), otherwise the user's SSH passphrase could be compromised.<p>
Additional consideration should be given to the use of <b class="name">pam_ssh</b>. Users often assume that file permissions are sufficient to protect their SSH keys, and thus use weak or no passphrases. Since the system administrator has no effective means of enforcing SSH passphrase quality, this has the potential to expose the system to security risks.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 16, 2011</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

