<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../../style.css" type="text/css" media="all">
<title>
BOOT(8) (SPARC)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
BOOT(8)</td>
<td class="head-vol" align="center">
System Manager's Manual (SPARC)</td>
<td class="head-rtitle" align="right">
BOOT(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">boot</b> &#8212; <span class="desc">system bootstrapping procedures</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 4.00ex;">
<col>
<tbody>
<tr>
<td>
boot</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;adqsv</b></span>&#93; &#91;<span class="opt"><i class="arg">--</i> &#60;<i class="arg">boot string</i>&#62;</span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1><div class="subsection">
<h2 id="x506f776572206661696c20616e64206372617368207265636f76657279">Power fail and crash recovery</h2> Normally, the system will reboot itself at power-up or after crashes. An automatic consistency check of the file systems will be performed as described in <a class="link-man" href="../../html8/fsck.html">fsck(8)</a>, and unless this fails, the system will resume multi-user operations.</div>
<div class="subsection">
<h2 id="x436f6c6420737461727473">Cold starts</h2> The Sun boot firmware, either old-style or new-style (Open Boot Prom), performs a Power On Self Test (POST), and then will boot an operating system according to configuration in Open Firmware environment variables.</div>
<div class="subsection">
<h2 id="x426f6f742070726f6772616d206f7074696f6e73">Boot program options</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;a</b></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Prompt for the root file system device, the system crash dump device, and the path to <a class="link-man" href="../../html8/init.html">init(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;d</b></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Bring the system up in debug mode. Here it waits for a kernel debugger connect; see <a class="link-man" href="../../html1/gdb.html">gdb(1)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;C</b></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Boot kernel in compat mode. Starting with revision 1.14 (introduced on 2003/03/01), the sparc boot program loads the <span class="unix">NetBSD</span> kernel at its linked virtual address. This feature requires a kernel built after 2003/02/21 (corresponding to kernel version 1.6Q). To load older kernels, the <b class="flag">&#45;C</b> option must be used, which loads the kernel at physical address 0x4000. The size of a kernel loaded in this way is limited to approximately 3MB.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;q</b></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Boot the system in quiet mode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Bring the system up in single-user mode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Boot the system in verbose mode.</dd>
</dl>
<p>
Any extra flags or arguments, or the &#60;<i class="arg">boot string</i>&#62; after the -- separator are passed to the boot PROM. Other flags are currently ignored.<p>
The SPARC boot ROM comes in two flavours: an &#8220;old-style&#8221; ROM is used in sun4 machines, while a &#8220;new-style&#8221; ROM can be found on sun4c and sun4m models. The &#8220;new-style&#8221; SPARC boot ROM is a full-featured Forth system with emacs key bindings. It can be put in &#8220;old-style&#8221; user-interface compatibility mode (in which case it shows a simple &#8216;&gt;&#8217; prompt), but this is essentially useless. However, by default on sun4c models, the ROM runs in old-mode; to enter new-mode type &#8216;n&#8217;. The ROM then shows a Forth-style &#8220;ok&#8221; prompt. It is recommended to have the ROM always start in its native &#8220;new-style&#8221; mode. Utter the following incantation in new-mode to force the ROM to always start in new-mode.<p>
<i class="file">	ok</i> setenv sunmon-compat? false<p>
The ROM will normally load the kernel from &#8220;sd(0,0,0)vmunix&#8221;. To change the default so that <span class="unix">NetBSD</span> will be loaded from somewhere else, type the following<p>
<i class="file">	ok</i> setenv boot-from sd(0,0,0)netbsd<p>
On newer SPARC machines, there are various aliases to access common devices. A typical list of usable boot devices (extracted from the output of the Open Boot PROM command <b class="cmd">devalias</b>) is:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
floppy         /obio/SUNW,fdtwo 
net-aui        /iommu/sbus/ledma@f,400010:aui/le@f,c00000 
net-tpe        /iommu/sbus/ledma@f,400010:tpe/le@f,c00000 
net            /iommu/sbus/ledma@f,400010/le@f,c00000 
disk           /iommu/sbus/espdma@f,400000/esp@f,800000/sd@3,0 
cdrom          /iommu/sbus/espdma@f,400000/esp@f,800000/sd@6,0:d 
tape           /iommu/sbus/espdma@f,400000/esp@f,800000/st@4,0 
tape1          /iommu/sbus/espdma@f,400000/esp@f,800000/st@5,0 
tape0          /iommu/sbus/espdma@f,400000/esp@f,800000/st@4,0 
disk3          /iommu/sbus/espdma@f,400000/esp@f,800000/sd@3,0 
disk2          /iommu/sbus/espdma@f,400000/esp@f,800000/sd@2,0 
disk1          /iommu/sbus/espdma@f,400000/esp@f,800000/sd@1,0 
disk0          /iommu/sbus/espdma@f,400000/esp@f,800000/sd@0,0</pre>
<p>
For new-style machines, if a device specification includes a partition letter (for example <span class="emph">cdrom</span> in above list), that partition is used by default, otherwise the first (a) partition is used. If booting from the net device, there is no partition involved.<p>
At any time you can break back to the ROM by pressing the &#8216;L1&#8217; and &#8216;a&#8217; keys at the same time (if the console is a serial port the same is achieved by sending a &#8216;break&#8217;). If you do this accidentally you can continue whatever was in progress by typing &#8216;go&#8217;.</div>
</div>
<div class="section">
<h1 id="x4f50454e20424f4f542050524f4d20454e5649524f4e4d454e54205641524941424c4553">OPEN BOOT PROM ENVIRONMENT VARIABLES</h1> This section only applies to new-style machines.<p>
All Open Boot PROM environment variables can be printed with the <b class="cmd">printenv</b> command and changed with the <b class="cmd">setenv</b> command. The boot process relevant variables and their suggested value for booting <span class="unix">NetBSD</span> are:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
auto-boot?            true 
boot-file 
boot-device           disk 
diag-switch?          false</pre>
<p>
Of course you may select any other boot device, if you do not want to boot from the device aliased to <span class="emph">disk</span>, see the discussion on devices above.</div>
<div class="section">
<h1 id="x4f50454e20424f4f542050524f4d20414242524556494154454420434f4d4d414e442053554d4d415259">OPEN BOOT PROM ABBREVIATED COMMAND SUMMARY</h1> This section only applies to new-style machines.<p>
The following Open Boot PROM commands are related to the boot process:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
boot               boot the system from the default device 
boot device filename arguments 
                   boot the specified device, filename and arguments 
probe-ide          list devices on the primary IDE controller 
probe-ide-all      list devices on all known IDE controllers 
probe-scsi         list devices on the primary SCSI controller 
probe-scsi-all     list devices on all known SCSI controllers 
reset              reset the system</pre>
For disk and tape devices, the boot device is specified as &#8216;/path/device@target,lun:partition&#8217;.</div>
<div class="section">
<h1 id="x50524f4d204d4f4e49544f5220414242524556494154454420434f4d4d414e442053554d4d415259">PROM MONITOR ABBREVIATED COMMAND SUMMARY</h1> This section only applies to old-style machines.<p>
The following PROM monitor commands are related to the boot process:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
b       boot the system from the default device 
b device filename arguments 
        boot the specified device, filename and arguments 
b?      list boot device types 
k2      reset the system</pre>
<p>
For SCSI disk and tape devices, the boot device is specified as &#8216;device(controller,unit,partition)&#8217;, where &#8216;unit&#8217; is the hexidecimal value of the SCSI id of the target multiplied by eight plus the lun, and &#8216;partition&#8217; is the partition number, starting from 0.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/netbsd</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
system code</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/boot</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
system bootstrap</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../../html8/crash.html">crash(8)</a>, <a class="link-man" href="../../html8/disklabel.html">disklabel(8)</a>, <a class="link-man" href="../../html8/fsck.html">fsck(8)</a>, <a class="link-man" href="../../html8/halt.html">halt(8)</a>, <a class="link-man" href="../../html8/init.html">init(8)</a>, <a class="link-man" href="../../html8/installboot.html">installboot(8)</a>, <a class="link-man" href="../../html8/rc.html">rc(8)</a>, <a class="link-man" href="../../html8/shutdown.html">shutdown(8)</a>, <a class="link-man" href="../../html8/sparc64/boot.html">sparc64/boot(8)</a>, <a class="link-man" href="../../html8/syslogd.html">syslogd(8)</a></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> On sun4 machines, the <span class="unix">NetBSD</span> sparc boot loader can only boot from RAID partitions that start at the beginning of the disk.<p>
On sun4 and early PROM version sun4c machines, the PROM can only boot from the first 1Gb of the disk.<p>
On later PROM version sun4c and early PROM version sun4m machines, the PROM can only boot from the first 2Gb of the disk.<p>
On later PROM version sun4m machines, the PROM can only boot from the first 4Gb of the disk.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
June 17, 2006</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

