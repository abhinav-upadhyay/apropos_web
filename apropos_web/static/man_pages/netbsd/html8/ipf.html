<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
IPF(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
IPF(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
IPF(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> ipf &#45; alters packet filtering lists for IP packet input and output</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>ipf</b> [ <b>&#45;6AcdDEInoPrsvVyzZ</b> ] [ <b>&#45;l</b> &lt;block|pass|nomatch&gt; ] [ <b>&#45;T</b> &lt;optionlist&gt; ] [ <b>&#45;F</b> &lt;i|o|a|s|S&gt; ] <b>&#45;f</b> &lt; <i>filename</i>&gt; [ <b>&#45;f</b> &lt; <i>filename</i>&gt; [...]]</div>
<div class="section">
<h1>DESCRIPTION</h1>  <b>ipf</b> opens the filenames listed (treating "&#45;" as stdin) and parses the file for a set of rules which are to be added or removed from the packet filter rule set.<p>
Each rule processed by <b>ipf</b> is added to the kernel's internal lists if there are no parsing problems. Rules are added to the end of the internal lists, matching the order in which they appear when given to  <b>ipf</b>.</div>
<div class="section">
<h1>OPTIONS</h1><dl>
<dt>
<b>&#45;6</b></dt>
<dd>
This option is required to parse IPv6 rules and to have them loaded.</dd>
</dl>
<dl>
<dt>
<b>&#45;A</b></dt>
<dd>
Set the list to make changes to the active list (default).</dd>
</dl>
<dl>
<dt>
<b>&#45;c &lt;language&gt;</b></dt>
<dd>
This option causes <b>ipf</b> to generate output files for a compiler that supports  <b>language</b><i>.  At present, the only target language supported is</i>  <i></i><b>C</b><b> (-cc) for which two files - </b><b>ip_rules.c</b><b></b>  <b>and </b><b>ip_rules.h</b><b> are generated in the </b><b>CURRENT DIRECTORY</b><b> when</b>  <b></b><b>ipf</b><b> is being run.  These files can be used with the</b>  <b></b><b>IPFILTER_COMPILED</b><b> kernel option to build filter rules staticly into</b>  <b>the kernel.</b></dd>
</dl>
<dl>
<dt>
<b>&#45;d</b></dt>
<dd>
Turn debug mode on.  Causes a hexdump of filter rules to be generated as it processes each one.</dd>
</dl>
<dl>
<dt>
<b>&#45;D</b></dt>
<dd>
Disable the filter (if enabled).  Not effective for loadable kernel versions.</dd>
</dl>
<dl>
<dt>
<b>&#45;E</b></dt>
<dd>
Enable the filter (if disabled).  Not effective for loadable kernel versions.</dd>
</dl>
<dl>
<dt>
<b>&#45;F</b>&#8194;&lt;i|o|a&gt;</dt>
<dd>
This option specifies which filter list to flush.  The parameter should either be "i" (input), "o" (output) or "a" (remove all filter rules). Either a single letter or an entire word starting with the appropriate letter maybe used.  This option maybe before, or after, any other with the order on the command line being that used to execute options.</dd>
</dl>
<dl>
<dt>
<b>&#45;F</b>&#8194;&lt;s|S&gt;</dt>
<dd>
To flush entries from the state table, the <b>-F</b> option is used in conjunction with either "s" (removes state information about any non-fully established connections) or "S" (deletes the entire state table).  Only one of the two options may be given.  A fully established connection will show up in  <b>ipfstat -s</b> output as 5/5, with deviations either way indicating it is not fully established any more.</dd>
</dl>
<dl>
<dt>
<b>&#45;F</b>&lt;5|6|7|8|9|10|11&gt;</dt>
<dd>
For the TCP states that represent the closing of a connection has begun, be it only one side or the complete connection, it is possible to flush those states directly using the number corresponding to that state. The numbers relate to the states as follows: 5 = close-wait, 6 = fin-wait-1, 7 = closing, 8 = last-ack, 9 = fin-wait-2, 10 = time-wait, 11 = closed.</dd>
</dl>
<dl>
<dt>
<b>&#45;F</b>&lt;number&gt;</dt>
<dd>
If the argument supplied to <b>-F</b> is greater than 30, then state table entries that have been idle for more than this many seconds will be flushed.</dd>
</dl>
<dl>
<dt>
<b>&#45;f</b>&#8194;&lt;filename&gt;</dt>
<dd>
This option specifies which files  <b>ipf</b> should use to get input from for modifying the packet filter rule lists.</dd>
</dl>
<dl>
<dt>
<b>&#45;I</b></dt>
<dd>
Set the list to make changes to the inactive list.</dd>
</dl>
<dl>
<dt>
<b>&#45;l &#8194;&lt;pass|block|nomatch&gt;</b></dt>
<dd>
Use of the <b>-l</b> flag toggles default logging of packets.  Valid arguments to this option are  <b>pass</b>, <b>block</b> and <b>nomatch</b>. When an option is set, any packet which exits filtering and matches the set category is logged.  This is most useful for causing all packets which don't match any of the loaded rules to be logged.</dd>
</dl>
<dl>
<dt>
<b>&#45;n</b></dt>
<dd>
This flag (no-change) prevents <b>ipf</b> from actually making any ioctl calls or doing anything which would alter the currently running kernel.</dd>
</dl>
<dl>
<dt>
<b>&#45;o</b></dt>
<dd>
Force rules by default to be added/deleted to/from the output list, rather than the (default) input list.</dd>
</dl>
<dl>
<dt>
<b>&#45;P</b></dt>
<dd>
Add rules as temporary entries in the authentication rule table.</dd>
</dl>
<dl>
<dt>
<b>&#45;r</b></dt>
<dd>
Remove matching filter rules rather than add them to the internal lists</dd>
</dl>
<dl>
<dt>
<b>&#45;s</b></dt>
<dd>
Swap the active filter list in use to be the "other" one.</dd>
</dl>
<dl>
<dt>
<b>&#45;T &lt;optionlist&gt;</b></dt>
<dd>
This option allows run-time changing of IPFilter kernel variables.  Some variables require IPFilter to be in a disabled state ( <b>-D</b>) for changing, others do not.  The optionlist parameter is a comma separated list of tuning commands.  A tuning command is either "list" (retrieve a list of all variables in the kernel, their maximum, minimum and current value), a single variable name (retrieve its current value) and a variable name with a following assignment to set a new value.  Some examples follow.<br>
# Print out all IPFilter kernel tunable parameters<br>
ipf -T list<br>
# Display the current TCP idle timeout and then set it to 3600<br>
ipf -D -T fr_tcpidletimeout,fr_tcpidletimeout=3600 -E<br>
# Display current values for fr_pass and fr_chksrc, then set fr_chksrc to 1.<br>
ipf -T fr_pass,fr_chksrc,fr_chksrc=1<br>
</dd>
</dl>
<dl>
<dt>
<b>&#45;v</b></dt>
<dd>
Turn verbose mode on.  Displays information relating to rule processing.</dd>
</dl>
<dl>
<dt>
<b>&#45;V</b></dt>
<dd>
Show version information.  This will display the version information compiled into the ipf binary and retrieve it from the kernel code (if running/present). If it is present in the kernel, information about its current state will be displayed (whether logging is active, default filtering, etc).</dd>
</dl>
<dl>
<dt>
<b>&#45;y</b></dt>
<dd>
Manually resync the in-kernel interface list maintained by IP Filter with the current interface status list.</dd>
</dl>
<dl>
<dt>
<b>&#45;z</b></dt>
<dd>
For each rule in the input file, reset the statistics for it to zero and display the statistics prior to them being zeroed.</dd>
</dl>
<dl>
<dt>
<b>&#45;Z</b></dt>
<dd>
Zero global statistics held in the kernel for filtering only (this doesn't affect fragment or state statistics).</dd>
</dl>
</div>
<div class="section">
<h1>FILES</h1> /dev/ipauth<div style="height: 0.00em;">
&#160;</div>
/dev/ipl<div style="height: 0.00em;">
&#160;</div>
/dev/ipstate</div>
<div class="section">
<h1>SEE ALSO</h1> ipftest(1), mkfilters(1), ipf(4), ipl(4), ipf(5), ipfstat(8), ipmon(8), ipnat(8)</div>
<div class="section">
<h1>DIAGNOSTICS</h1> Needs to be run as root for the packet filtering lists to actually be affected inside the kernel.</div>
<div class="section">
<h1>BUGS</h1> If you find any, please send email to me at darrenr@pobox.com</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
</td>
<td class="foot-os" align="right">
</td>
</tr>
</table>
</div>
</body>
</html>

