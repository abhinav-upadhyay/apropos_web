<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
NTPQ(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
NTPQ(8)</td>
<td class="head-vol" align="center">
User</td>
<td class="head-rtitle" align="right">
NTPQ(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">ntpq</b> &#8212; <span class="desc">standard NTP query program</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 4.00ex;">
<col>
<tbody>
<tr>
<td>
ntpq</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;flags</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;flag</b> &#91;<span class="opt"><i class="arg">value</i></span>&#93;</span>&#93; &#91;<span class="opt"><b class="flag">&#45;&#45;option&#45;name</b>&#91;<span class="opt">&#91;<span class="opt">=| </span>&#93;<i class="arg">value</i></span>&#93;</span>&#93; [ host ...]</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">ntpq</b> utility program is used to query NTP servers which implement the standard NTP mode 6 control message formats defined in Appendix B of the NTPv3 specification RFC1305, requesting information about current state and/or changes in that state. The same formats are used in NTPv4, although some of the variables have changed and new ones added. The description on this page is for the NTPv4 variables. The program may be run either in interactive mode or controlled using command line arguments. Requests to read and write arbitrary variables can be assembled, with raw and pretty&#45;printed output options being available. The <b class="name">ntpq</b> utility can also obtain and print a list of peers in a common format by sending multiple queries to the server. If one or more request options is included on the command line when <b class="name">ntpq</b> is executed, each of the requests will be sent to the NTP servers running on each of the hosts given as command line arguments, or on localhost by default. If no request options are given, <b class="name">ntpq</b> will attempt to read commands from the standard input and execute these on the NTP server running on the first host given on the command line, again defaulting to localhost when no other host is specified. The <b class="name">ntpq</b> utility will prompt for commands if the standard input is a terminal device. <b class="name">ntpq</b> uses NTP mode 6 packets to communicate with the NTP server, and hence can be used to query any compatible server on the network which permits it. Note that since NTP is a UDP protocol this communication will be somewhat unreliable, especially over large distances in terms of network topology. The <b class="name">ntpq</b> utility makes one attempt to retransmit requests, and will time requests out if the remote host is not heard from within a suitable timeout time. Specifying a command line option other than <b class="flag">&#45;i</b> or <b class="flag">&#45;n</b> will cause the specified query (queries) to be sent to the indicated host(s) immediately. Otherwise, <b class="name">ntpq</b> will attempt to read interactive format commands from the standard input.<div class="subsection">
<h2 id="x496e7465726e616c20436f6d6d616e6473">Internal Commands</h2> Interactive format commands consist of a keyword followed by zero to four arguments. Only enough characters of the full keyword to uniquely identify the command need be typed. A number of interactive format commands are executed entirely within the <b class="name">ntpq</b> utility itself and do not result in NTP mode 6 requests being sent to a server. These are described following.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
? &#91;<span class="opt"><i class="arg">command_keyword</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">help</b> &#91;<span class="opt"><i class="arg">command_keyword</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
A &#8216;<code class="lit">?</code>&#8217; by itself will print a list of all the command keywords known to this incarnation of <b class="name">ntpq</b>. A &#8216;<code class="lit">?</code>&#8217; followed by a command keyword will print function and usage information about the command. This command is probably a better source of information about <b class="name">ntpq</b> than this manual page.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">addvars</b> <i class="arg">variable_name</i> &#91;<span class="opt"><b class="cmd">=value</b></span>&#93; <b class="cmd">...</b></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">rmvars</b> <i class="arg">variable_name</i> <b class="cmd">...</b></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">clearvars</b></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
The data carried by NTP mode 6 messages consists of a list of items of the form &#8216;<code class="lit">variable_name=value</code>&#8217;, where the &#8216;<code class="lit">=value</code>&#8217; is ignored, and can be omitted, in requests to the server to read variables. The <b class="name">ntpq</b> utility maintains an internal list in which data to be included in control messages can be assembled, and sent using the <b class="cmd">readlist</b> and <b class="cmd">writelist</b> commands described below. The <b class="cmd">addvars</b> command allows variables and their optional values to be added to the list. If more than one variable is to be added, the list should be comma&#45;separated and not contain white space. The <b class="cmd">rmvars</b> command can be used to remove individual variables from the list, while the <b class="cmd">clearlist</b> command removes all variables from the list.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">authenticate</b> &#91;<span class="opt">yes | no</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
Normally <b class="name">ntpq</b> does not authenticate requests unless they are write requests. The command &#8216;<code class="lit">authenticate yes</code>&#8217; causes <b class="name">ntpq</b> to send authentication with all requests it makes. Authenticated requests causes some servers to handle requests slightly differently, and can occasionally melt the CPU in fuzzballs if you turn authentication on before doing a <b class="cmd">peer</b> display. The command &#8216;<code class="lit">authenticate</code>&#8217; causes <b class="name">ntpq</b> to display whether or not <b class="name">ntpq</b> is currently autheinticating requests.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">cooked</b></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
Causes output from query commands to be "cooked", so that variables which are recognized by <b class="name">ntpq</b> will have their values reformatted for human consumption. Variables which <b class="name">ntpq</b> thinks should have a decodable value but didn't are marked with a trailing &#8216;<code class="lit">?</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">debug</b> &#91;<span class="opt"><b class="flag">more</b> | <b class="flag">less</b> | <b class="flag">off</b></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
With no argument, displays the current debug level. Otherwise, the debug level is changed to the indicated level.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">delay</b> <i class="arg">milliseconds</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
Specify a time interval to be added to timestamps included in requests which require authentication. This is used to enable (unreliable) server reconfiguration over long delay network paths or between machines whose clocks are unsynchronized. Actually the server does not now require timestamps in authenticated requests, so this command may be obsolete.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">host</b> <i class="arg">hostname</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
Set the host to which future queries will be sent. <i class="arg">hostname</i> may be either a host name or a numeric address.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">hostnames</b> &#91;<span class="opt"><b class="flag">yes</b> | <b class="flag">no</b></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
If <b class="flag">yes</b> is specified, host names are printed in information displays. If <b class="flag">no</b> is specified, numeric addresses are printed instead. The default is <b class="flag">yes</b>, unless modified using the command line <b class="flag">&#45;n</b> switch.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">keyid</b> <i class="arg">keyid</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
This command allows the specification of a key number to be used to authenticate configuration requests. This must correspond to a key number the server has been configured to use for this purpose.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">ntpversion</b> &#91;<span class="opt"><b class="flag">1</b> | <b class="flag">2</b> | <b class="flag">3</b> | <b class="flag">4</b></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
Sets the NTP version number which <b class="name">ntpq</b> claims in packets. Defaults to 3, and note that mode 6 control messages (and modes, for that matter) didn't exist in NTP version 1. There appear to be no servers left which demand version 1. With no argument, displays the current NTP version that will be used when communicating with servers.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">quit</b></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
Exit <b class="name">ntpq</b></dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">passwd</b></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
This command prompts you to type in a password (which will not be echoed) which will be used to authenticate configuration requests. The password must correspond to the key configured for use by the NTP server for this purpose if such requests are to be successful.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">raw</b></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
Causes all output from query commands is printed as received from the remote server. The only formating/interpretation done on the data is to transform nonascii data into a printable (but barely understandable) form.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">timeout</b> <i class="arg">milliseconds</i></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
Specify a timeout period for responses to server queries. The default is about 5000 milliseconds. Note that since <b class="name">ntpq</b> retries each query once after a timeout, the total waiting time for a timeout will be twice the timeout value set.</dd>
</dl>
</div>
</div>
<div class="section">
<h1 id="x4f5054494f4e53">OPTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;4</b>, <b class="flag">&#45;&#45;ipv4</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Force IPv4 DNS name resolution. This option must not appear in combination with any of the following options: ipv6.<div style="height: 1.00em;">
&#160;</div>
Force DNS resolution of following host names on the command line to the IPv4 namespace.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;6</b>, <b class="flag">&#45;&#45;ipv6</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Force IPv6 DNS name resolution. This option must not appear in combination with any of the following options: ipv4.<div style="height: 1.00em;">
&#160;</div>
Force DNS resolution of following host names on the command line to the IPv6 namespace.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;c</b> <i class="arg">cmd</i>, <b class="flag">&#45;&#45;command</b>=<i class="arg">cmd</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
run a command and exit. This option may appear an unlimited number of times.<div style="height: 1.00em;">
&#160;</div>
The following argument is interpreted as an interactive format command and is added to the list of commands to be executed on the specified host(s).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;d</b>, <b class="flag">&#45;&#45;debug&#45;level</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Increase debug verbosity level. This option may appear an unlimited number of times.<div style="height: 1.00em;">
&#160;</div>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;D</b> <i class="arg">number</i>, <b class="flag">&#45;&#45;set&#45;debug&#45;level</b>=<i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Set the debug verbosity level. This option may appear an unlimited number of times. This option takes an integer number as its argument.<div style="height: 1.00em;">
&#160;</div>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;p</b>, <b class="flag">&#45;&#45;peers</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Print a list of the peers. This option must not appear in combination with any of the following options: interactive.<div style="height: 1.00em;">
&#160;</div>
Print a list of the peers known to the server as well as a summary of their state. This is equivalent to the 'peers' interactive command.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;i</b>, <b class="flag">&#45;&#45;interactive</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Force ntpq to operate in interactive mode. This option must not appear in combination with any of the following options: command, peers.<div style="height: 1.00em;">
&#160;</div>
Force <b>ntpq</b> to operate in interactive mode. Prompts will be written to the standard output and commands read from the standard input.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;n</b>, <b class="flag">&#45;&#45;numeric</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
numeric host addresses.<div style="height: 1.00em;">
&#160;</div>
Output all host addresses in dotted&#45;quad numeric format rather than converting to the canonical host names.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;&#45;old&#45;rv</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Always output status line with readvar.<div style="height: 1.00em;">
&#160;</div>
By default, <b>ntpq</b> now suppresses the <b>associd=...</b> line that precedes the output of  <b>readvar</b> (alias  <b>rv</b>) when a single variable is requested, such as  <b>ntpq &#45;c "rv 0 offset"</b>. This option causes  <b>ntpq</b> to include both lines of output for a single&#45;variable  <b>readvar</b>. Using an environment variable to preset this option in a script will enable both older and newer  <b>ntpq</b> to behave identically in this regard.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;?</b>, <b class="flag">&#45;&#45;help</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Display usage information and exit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;!</b>, <b class="flag">&#45;&#45;more&#45;help</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Pass the extended usage information through a pager.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;&gt;</b> &#91;<span class="opt"><i class="arg">cfgfile</i></span>&#93;, <b class="flag">&#45;&#45;save&#45;opts</b> &#91;<span class="opt">=<i class="arg">cfgfile</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Save the option state to <i>cfgfile</i>.  The default is the <i>last</i> configuration file listed in the  <b>OPTION PRESETS</b> section, below. The command will exit after updating the config file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;&lt;</b> <i class="arg">cfgfile</i>, <b class="flag">&#45;&#45;load&#45;opts</b>=<i class="arg">cfgfile</i>, <b class="flag">&#45;&#45;no&#45;load&#45;opts</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Load options from <i>cfgfile</i>. The  <i>no&#45;load&#45;opts</i> form will disable the loading of earlier config/rc/ini files.   <i>&#45;&#45;no&#45;load&#45;opts</i> is handled early, out of order.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;&#45;version</b> &#91;<span class="opt">&#123;<i class="arg">v|c|n</i>&#125;</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Output version of program and exit.  The default mode is `v', a simple version.  The `c' mode will print copyright information and `n' will print the full copyright notice.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4f5054494f4e2050524553455453">OPTION PRESETS</h1> Any option that is not marked as  <i>not presettable</i> may be preset by loading values from configuration ("RC" or ".INI") file(s) and values from environment variables named:<br>
  <b>NTPQ_&lt;option&#45;name&gt;</b> or <b>NTPQ</b> The environmental presets take precedence (are processed later than) the configuration files. The  <i>homerc</i> files are "<i>$HOME</i>", and "<i>.</i>". If any of these are directories, then the file  <i>.ntprc</i> is searched for within those directories. cvt_prog='/usr/local/gnu/share/autogen/texi2mdoc' cvt_prog=`cd &#768;dirname "$cvt_prog"&#768; &gt;/dev/null &amp;&amp; pwd<br>
         `/`basename "$cvt_prog"` cd $tmp_dir test &#45;x "$cvt_prog" || die "'$cvt_prog' is not executable" {<br>
    list='synopsis description options option&#45;presets'<br>
    for f in $list ; do cat $f ; echo ; done<br>
    rm &#45;f $list name<br>
    list='implementation&#45;notes environment files examples exit&#45;status errors<br>
        compatibility see&#45;also conforming&#45;to history authors copyright bugs<br>
        notes'<br>
    for f in $list ; do cat $f ; echo ; done &gt; .end&#45;doc<br>
    rm &#45;f $list<br>
    list=`ls &#45;1 *`' .end&#45;doc'<br>
    for f in $list ; do cat $f ; echo ; done<br>
    rm &#45;f $list } 1&gt;.doc 2&gt;/dev/null sed &#45;f .cmds .doc | /usr/local/gnu/bin/grep &#45;E &#45;v '^[ 	]*$' | $cvt_prog</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1> See  <b>OPTION PRESETS</b> for configuration environment variables.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1> See  <b>OPTION PRESETS</b> for configuration files.</div>
<div class="section">
<h1 id="x4558495420535441545553">EXIT STATUS</h1> One of the following exit values will be returned:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
0  (EXIT_SUCCESS)</dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Successful program execution.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
1  (EXIT_FAILURE)</dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
The operation failed or the command syntax was not valid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
66  (EX_NOINPUT)</dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
A specified configuration file could not be loaded.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
70  (EX_SOFTWARE)</dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
libopts had an internal operational error.  Please report it to autogen&#45;users@lists.sourceforge.net.  Thank you.</dd>
</dl>
</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The University of Delaware</div>
<div class="section">
<h1 id="x434f50595249474854">COPYRIGHT</h1> Copyright (C) 1970&#45;2013 The University of Delaware all rights reserved. This program is released under the terms of the NTP license, &lt;http://ntp.org/license&gt;.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Please send bug reports to: http://bugs.ntp.org, bugs@ntp.org</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1> This manual page was  <i>AutoGen</i>&#45;erated from the <b>ntpq</b> option definitions.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 24 2013</td>
<td class="foot-os" align="right">
SunOS 5.10</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

