<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
TIMED(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
TIMED(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
TIMED(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">timed</b> &#8212; <span class="desc">time server daemon</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 5.00ex;">
<col>
<tbody>
<tr>
<td>
timed</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;dMt</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;F</b> <i class="arg">host ...</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;G</b> <i class="arg">netgroup</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;i</b> <i class="arg">network</i> | <b class="flag">&#45;n</b> <i class="arg">network</i></span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">timed</b> utility is a time server daemon which is normally invoked at boot time from the <a class="link-man" href="../html8/rc.html">rc(8)</a> file. It synchronizes the host's time with the time of other machines, which are also running <b class="name">timed</b>, in a local area network. These time servers will slow down the clocks of some machines and speed up the clocks of others to bring them to the average network time. The average network time is computed from measurements of clock differences using the ICMP timestamp request message.<p>
The following options are available:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable debugging mode; do not detach from the terminal.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;F</b> <i class="arg">host ...</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Create a list of trusted hosts. The <b class="name">timed</b> utility will only accept trusted hosts as masters. If it finds an untrusted host claiming to be master, <b class="name">timed</b> will suppress incoming messages from that host and call for a new election. This option implies the <b class="flag">&#45;M</b> option. If this option is not specified, all hosts on the connected networks are treated as trustworthy.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;G</b> <i class="arg">netgroup</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify a netgroup of trustworthy hosts, in addition to any masters specified with the <b class="flag">&#45;M</b> flag. This option may only be specified once.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;i</b> <i class="arg">network</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Add <i class="arg">network</i> to the list of networks to ignore. All other networks to which the machine is directly connected are used by <b class="name">timed</b>. This option may be specified multiple times to add more than one network to the list.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;M</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Allow this host to become a <b class="name">timed</b> master if necessary.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;n</b> <i class="arg">network</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Add <i class="arg">network</i> to the list of allowed networks. All other networks to which the machine is directly connected are ignored by <b class="name">timed</b>. This option may be specified multiple times to add more than one network to the list.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;t</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable tracing of received messages and log to the file <i class="file">/var/log/timed.log</i>. Tracing can be turned on or off while <b class="name">timed</b> is running with the <a class="link-man" href="../html8/timedc.html">timedc(8)</a> utility.</dd>
</dl>
<p>
The <b class="flag">&#45;n</b> and <b class="flag">&#45;i</b> flags are mutually exclusive and require as arguments real networks to which the host is connected (see <a class="link-man" href="../html5/networks.html">networks(5)</a>). If neither flag is specified, <b class="name">timed</b> will listen on all connected networks.<p>
A <b class="name">timed</b> running without the <b class="flag">&#45;M</b> nor <b class="flag">&#45;F</b> flags will always remain a slave. If the <b class="flag">&#45;F</b> flag is not used, <b class="name">timed</b> will treat all machines as trustworthy.<p>
The <b class="name">timed</b> utility is based on a master-slave scheme. When <b class="name">timed</b> is started on a machine, it asks the master for the network time and sets the host's clock to that time. After that, it accepts synchronization messages periodically sent by the master and calls <a class="link-man" href="../html2/adjtime.html">adjtime(2)</a> to perform the needed corrections on the host's clock.<p>
It also communicates with <a class="link-man" href="../html1/date.html">date(1)</a> in order to set the date globally, and with <a class="link-man" href="../html8/timedc.html">timedc(8)</a>, a <b class="name">timed</b> control utility. If the machine running the master becomes unreachable, the slaves will elect a new master from among those slaves which are running with at least one of the <b class="flag">&#45;M</b> and <b class="flag">&#45;F</b> flags.<p>
At startup <b class="name">timed</b> normally checks for a master time server on each network to which it is connected, except as modified by the <b class="flag">&#45;n</b> and <b class="flag">&#45;i</b> options described above. It will request synchronization service from the first master server located. If permitted by the <b class="flag">&#45;M</b> or <b class="flag">&#45;F</b> flags, it will provide synchronization service on any attached networks on which no trusted master server was detected. Such a server propagates the time computed by the top-level master. The <b class="name">timed</b> utility will periodically check for the presence of a master on those networks for which it is operating as a slave. If it finds that there are no trusted masters on a network, it will begin the election process on that network.<p>
One way to synchronize a group of machines is to use <a class="link-man" href="../html8/ntpd.html">ntpd(8)</a> to synchronize the clock of one machine to a distant standard or a radio receiver and <b class="flag">&#45;F</b> <i class="arg">hostname</i> to tell its <b class="name">timed</b> to trust only itself.<p>
Messages printed by the kernel on the system console occur with interrupts disabled. This means that the clock stops while they are printing. A machine with many disk or network hardware problems and consequent messages cannot keep good time by itself. Each message typically causes the clock to lose a dozen milliseconds. A time daemon can correct the result.<p>
Messages in the system log about machines that failed to respond usually indicate machines that crashed or were turned off. Complaints about machines that failed to respond to initial time settings are often associated with &#8220;multi-homed&#8221; machines that looked for time masters on more than one network and eventually chose to become a slave on the other network.</div>
<div class="section">
<h1 id="x5741524e494e4753">WARNINGS</h1> Temporal chaos will result if two or more time daemons attempt to adjust the same clock. If both <b class="name">timed</b> and another time daemon are run on the same machine, ensure that the <b class="flag">&#45;F</b> flag is used, so that <b class="name">timed</b> never attempts to adjust the local clock.<p>
The protocol is based on UDP/IP broadcasts. All machines within the range of a broadcast that are using the TSP protocol must cooperate. There cannot be more than a single administrative domain using the <b class="flag">&#45;F</b> flag among all machines reached by a broadcast packet. Failure to follow this rule is usually indicated by complaints concerning &#8220;untrusted&#8221; machines in the system log.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/log/timed.log</i></dt>
<dd class="list-tag" style="margin-left: 24.00ex;">
tracing file for <b class="name">timed</b></dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/log/timed.masterlog</i></dt>
<dd class="list-tag" style="margin-left: 24.00ex;">
log file for master <b class="name">timed</b></dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/date.html">date(1)</a>, <a class="link-man" href="../html2/adjtime.html">adjtime(2)</a>, <a class="link-man" href="../html2/gettimeofday.html">gettimeofday(2)</a>, <a class="link-man" href="../html4/icmp.html">icmp(4)</a>, <a class="link-man" href="../html5/netgroup.html">netgroup(5)</a>, <a class="link-man" href="../html5/networks.html">networks(5)</a>, <a class="link-man" href="../html8/ntpd.html">ntpd(8)</a>, <a class="link-man" href="../html8/timedc.html">timedc(8)</a><p>
<span class="ref"><span class="ref-auth">R. Gusella</span> and <span class="ref-auth">S. Zatti</span>, <span class="ref-title">TSP: The Time Synchronization Protocol for UNIX 4.3BSD</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">timed</b> utility appeared in <span class="unix">4.3BSD</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 11, 1993</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

