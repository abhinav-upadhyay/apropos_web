<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
NEWFS(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
NEWFS(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
NEWFS(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">newfs</b> &#8212; <span class="desc">construct a new file system</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 5.00ex;">
<col>
<tbody>
<tr>
<td>
newfs</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;FGINZ</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;a</b> <i class="arg">maxcontig</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;B</b> <i class="arg">byte-order</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;b</b> <i class="arg">block-size</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;d</b> <i class="arg">maxbsize</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;e</b> <i class="arg">maxbpg</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;f</b> <i class="arg">frag-size</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;g</b> <i class="arg">avgfilesize</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;h</b> <i class="arg">avgfpdir</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;i</b> <i class="arg">bytes-per-inode</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;m</b> <i class="arg">free-space</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;n</b> <i class="arg">inodes</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;O</b> <i class="arg">filesystem-format</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;o</b> <i class="arg">optimization</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;q</b> <i class="arg">quota</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;S</b> <i class="arg">sector-size</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;s</b> <i class="arg">size</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;T</b> <i class="arg">disk-type</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;v</b> <i class="arg">volname</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;V</b> <i class="arg">verbose</i></span>&#93; <i class="arg">special</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">newfs</b> is used to initialize and clear file systems before first use. Before running <b class="name">newfs</b> the disk must be labeled using <a class="link-man" href="../8/disklabel">disklabel(8)</a>. <b class="name">newfs</b> builds a file system on the specified special device basing its defaults on the information in the disk label. Typically the defaults are reasonable, however <b class="name">newfs</b> has numerous options to allow the defaults to be selectively overridden.<p>
Options with numeric arguments may contain an optional (case-insensitive) suffix:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
b</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Bytes; causes no modification. (Default)</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
k</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Kilo; multiply the argument by 1024.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
m</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Mega; multiply the argument by 1048576.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
g</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Giga; multiply the argument by 1073741824.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
t</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Tera; multiply the argument by 1099511627776.</dd>
</dl>
<p>
The following options define the general layout policies.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;a</b> <i class="arg">maxcontig</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
This sets the obsolete maxcontig parameter.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;B</b> <i class="arg">byte-order</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Specify the metadata byte order of the file system to be created. Valid byte orders are &#8216;be&#8217; and &#8216;le&#8217;. If no byte order is specified, the file system is created in host byte order.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;b</b> <i class="arg">block-size</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The block size of the file system, in bytes. It must be a power of two. The smallest allowable size is 4096 bytes. The default size depends upon the size of the file system:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">file system size</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
<i class="arg">block-size</i></dd>
<dt class="list-tag" style="margin-top: 0.00em;">
&lt; 20 MB</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
4 KB</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
&lt; 1000 MB</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
8 KB</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
&lt; 128 GB</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
16 KB</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
&gt;= 128 GB</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
32 KB</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;d</b> <i class="arg">maxbsize</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Set the maximum extent size to <i class="arg">maxbsize</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;e</b> <i class="arg">maxbpg</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
This indicates the maximum number of blocks any single file can allocate out of a cylinder group before it is forced to begin allocating blocks from another cylinder group. The default is about one quarter of the total blocks in a cylinder group. See <a class="link-man" href="../8/tunefs">tunefs(8)</a> for more details on how to set this option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;F</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Create a file system image in <i class="arg">special</i>. The file system size needs to be specified with &#8220;<b class="flag">&#45;s</b> <i class="arg">size</i>&#8221;. No attempts to use or update the disk label will be made.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;f</b> <i class="arg">frag-size</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The fragment size of the file system in bytes. It must be a power of two ranging in value between <i class="arg">block-size</i>/8 and <i class="arg">block-size</i>. The optimal <i class="arg">block-size</i>:<i class="arg">frag-size</i> ratio is 8:1. Other ratios are possible, but are not recommended, and may produce unpredictable results. The default size depends upon the size of the file system:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">file system size</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
<i class="arg">frag-size</i></dd>
<dt class="list-tag" style="margin-top: 0.00em;">
&lt; 20 MB</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
0.5 KB</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
&lt; 1000 MB</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
1 KB</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
&lt; 128 GB</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
2 KB</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
&gt;= 128 GB</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
4 KB</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;G</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Treat garbage parameters as non-fatal. Using this option may result in a file system which causes a kernel panic and should only be used for testing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;g</b> <i class="arg">avgfilesize</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The expected average file size for the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;h</b> <i class="arg">avgfpdir</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The expected average number of files per directory on the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;I</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Do not require that the file system type listed in the disk label is &#8216;<code class="lit">4.2BSD</code>&#8217; or &#8216;<code class="lit">Apple UFS</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;i</b> <i class="arg">bytes-per-inode</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
This specifies the density of inodes in the file system. If fewer inodes are desired, a larger number should be used; to create more inodes a smaller number should be given. The default is to create an inode for every (4 * <i class="arg">frag-size</i>) bytes of data space:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">file system size</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
<i class="arg">bytes-per-inode</i></dd>
<dt class="list-tag" style="margin-top: 0.00em;">
&lt; 20 MB</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
2 KB</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
&lt; 1000 MB</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
4 KB</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
&lt; 128 GB</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
8 KB</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
&gt;= 128 GB</dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
16 KB</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;m</b> <i class="arg">free-space</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The percentage of space reserved from normal users; the minimum free space threshold. The default value used is 5%. See <a class="link-man" href="../8/tunefs">tunefs(8)</a> for more details on how to set this option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;N</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Causes the file system parameters to be printed out without really creating the file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;n</b> <i class="arg">inodes</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
This specifies the number of inodes for the filesystem. If both <b class="flag">&#45;i</b> and <b class="flag">&#45;n</b> are specified then <b class="flag">&#45;n</b> takes precedence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;O</b> <i class="arg">filesystem-format</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Select the filesystem-format.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
0</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
4.3BSD; This option is primarily used to build root file systems that can be understood by older boot ROMs. This generates an FFSv1 file system with level 1 format.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
1</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
FFSv1; normal Fast File System, level 4 format. Also known as &#8216;FFS&#8217;, &#8216;UFS&#8217;, or &#8216;UFS1&#8217;. This is the default.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
2</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
FFSv2; enhanced Fast File System, suited for more than 1 Terabyte capacity. This is also known as &#8216;UFS2&#8217;.</dd>
</dl>
See <a class="link-man" href="../8/fsck_ffs">fsck_ffs(8)</a> for more information about format levels.<p>
To create an LFS filesystem see <a class="link-man" href="../8/newfs_lfs">newfs_lfs(8)</a>. To create a Linux ext2 filesystem see <a class="link-man" href="../8/newfs_ext2fs">newfs_ext2fs(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;o</b> <i class="arg">optimization</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Optimization preference; either &#8220;space&#8221; or &#8220;time&#8221;. The file system can either be instructed to try to minimize the time spent allocating blocks, or to try to minimize the space fragmentation on the disk. If the value of minfree (see above) is less than 5%, the default is to optimize for space; if the value of minfree is greater than or equal to 5%, the default is to optimize for time. See <a class="link-man" href="../8/tunefs">tunefs(8)</a> for more details on how to set this option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;q</b> <i class="arg">quota</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
enable a quota. <i class="arg">quota</i> can be one of <code class="lit">user</code> or <code class="lit">group</code> to enable the specified quota type. Multiple <b class="flag">&#45;q</b> can be used to enable all types at once.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b> <i class="arg">size</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The size of the file system in sectors. An &#8216;s&#8217; suffix will be interpreted as the number of sectors (the default). All other suffixes are interpreted as per other numeric arguments, except that the number is converted into sectors by dividing by the sector size (as specified by <b class="flag">&#45;S</b> <i class="arg">secsize</i>) after suffix interpretation.<p>
If no <b class="flag">&#45;s</b> <i class="arg">size</i> is specified then the filesystem size defaults to that of the partition, or, if <b class="flag">&#45;F</b> is specified, the existing file.<p>
If <i class="arg">size</i> is negative the specified size is subtracted from the default size (reserving space at the end of the partition).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;T</b> <i class="arg">disk-type</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Uses information for the specified disk from <i class="file">/etc/disktab</i> instead of trying to get the information from the disk label.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;V</b> <i class="arg">verbose</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
This controls the amount of information written to stdout:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
0</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
No output.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
1</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Overall size and cylinder group details.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
2</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
A progress bar (dots ending at right hand margin).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
3</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
The first few super-block backup sector numbers are displayed before the progress bar.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
4</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
All the super-block backup sector numbers are displayed (no progress bar).</dd>
</dl>
The default is 3. If <b class="flag">&#45;N</b> is specified <b class="name">newfs</b> stops before outputting the progress bar.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b> <i class="arg">volname</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
This specifies that an Apple UFS filesystem should be created with the given volume name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;Z</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Pre-zeros the file system image created with <b class="flag">&#45;F</b>. This is necessary if the image is to be used by <a class="link-man" href="../4/vnd">vnd(4)</a> (which doesn't support file systems with &#8216;holes&#8217;).</dd>
</dl>
<p>
The following option overrides the standard sizes for the disk geometry. The default value is taken from the disk label. Changing this default is useful only when using <b class="name">newfs</b> to build a file system whose raw image will eventually be used on a different type of disk than the one on which it is initially created (for example on a write-once disk). Note that changing this value from its default will make it impossible for <a class="link-man" href="../8/fsck_ffs">fsck_ffs(8)</a> to find the alternative superblocks if the standard superblock is lost.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;S</b> <i class="arg">sector-size</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The size of a sector in bytes (almost never anything but 512). Defaults to 512.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1> The file system is created with &#8216;random&#8217; inode generation numbers to improve NFS security.<p>
The owner and group IDs of the root node of the new file system are set to the effective UID and GID of the user initializing the file system.<p>
For the <b class="name">newfs</b> command to succeed, the disk label should first be updated such that the fstype field for the partition is set to &#8216;<code class="lit">4.2BSD</code>&#8217; or &#8216;<code class="lit">Apple UFS</code>&#8217;, unless <b class="flag">&#45;F</b> or <b class="flag">&#45;I</b> is used.<p>
To create and populate a filesystem image within a file use the <a class="link-man" href="../8/makefs">makefs(8)</a> utility.<p>
The partition size is found using <a class="link-man" href="../2/fstat">fstat(2)</a>, not by inspecting the disk label. The block size and fragment size will be written back to the disk label only if the last character of <i class="arg">special</i> references the same partition as the minor device number.<p>
Unless <b class="flag">&#45;F</b> is specified, <i class="arg">special</i> must be a raw device. This means that for example <i class="file">wd0a</i> or <i class="file">/dev/rwd0a</i> must be specified instead of <i class="file">/dev/wd0a</i>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/fstat">fstat(2)</a>, <a class="link-man" href="../5/disktab">disktab(5)</a>, <a class="link-man" href="../5/fs">fs(5)</a>, <a class="link-man" href="../8/disklabel">disklabel(8)</a>, <a class="link-man" href="../8/diskpart">diskpart(8)</a>, <a class="link-man" href="../8/dumpfs">dumpfs(8)</a>, <a class="link-man" href="../8/fsck_ffs">fsck_ffs(8)</a>, <a class="link-man" href="../8/makefs">makefs(8)</a>, <a class="link-man" href="../8/mount">mount(8)</a>, <a class="link-man" href="../8/mount_mfs">mount_mfs(8)</a>, <a class="link-man" href="../8/newfs_ext2fs">newfs_ext2fs(8)</a>, <a class="link-man" href="../8/newfs_lfs">newfs_lfs(8)</a>, <a class="link-man" href="../8/newfs_msdos">newfs_msdos(8)</a>, <a class="link-man" href="../8/tunefs">tunefs(8)</a><p>
<span class="ref"><span class="ref-auth">M. McKusick</span>, <span class="ref-auth">W. Joy</span>, <span class="ref-auth">S. Leffler</span>, and <span class="ref-auth">R. Fabry</span>, <span class="ref-title">A Fast File System for UNIX,</span>, <i class="ref-jrnl">ACM Transactions on Computer Systems 2</i>, <span class="ref-vol">3</span>, <span class="ref-page">pp 181-197</span>, <span class="ref-date">August 1984</span>, <span class="ref-opt">(reprinted in the BSD System Manager's Manual)</span>.</span><p>
<span class="ref"><span class="ref-auth">M. McKusick</span>, <span class="ref-title">Enhancements to the fast filesystem to support multi-terabyte storage systems</span>, <i class="ref-jrnl">Proceedings of the BSD Conference 2003</i>, <span class="ref-page">pp 79-90</span>, <span class="ref-date">September 2003</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">newfs</b> command appeared in <span class="unix">4.2BSD</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
June 30, 2012</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

