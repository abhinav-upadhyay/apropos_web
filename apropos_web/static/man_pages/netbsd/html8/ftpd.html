<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
FTPD(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
FTPD(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
FTPD(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">ftpd</b> &#8212; <span class="desc">Internet File Transfer Protocol server</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 4.00ex;">
<col>
<tbody>
<tr>
<td>
ftpd</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;46DdHlnQqrsUuWwX</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;a</b> <i class="arg">anondir</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;C</b> <i class="arg">user</i>&#91;<span class="opt">@<i class="arg">host</i></span>&#93;</span>&#93; &#91;<span class="opt"><b class="flag">&#45;c</b> <i class="arg">confdir</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;e</b> <i class="arg">emailaddr</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;h</b> <i class="arg">hostname</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;L</b> <i class="arg">xferlogfile</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;P</b> <i class="arg">dataport</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;V</b> <i class="arg">version</i></span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">ftpd</b> is the Internet File Transfer Protocol server process. The server uses the TCP protocol and listens at the port specified in the &#8220;ftp&#8221; service specification; see <a class="link-man" href="../html5/services.html">services(5)</a>.<p>
Available options:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;4</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
When <b class="flag">&#45;D</b> is specified, bind to IPv4 addresses only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;6</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
When <b class="flag">&#45;D</b> is specified, bind to IPv6 addresses only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;a</b> <i class="arg">anondir</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Define <i class="arg">anondir</i> as the directory to <a class="link-man" href="../html2/chroot.html">chroot(2)</a> into for anonymous logins. Default is the home directory for the ftp user. This can also be specified with the <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a> <span class="symb">chroot</span> directive.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;C</b> <i class="arg">user</i>&#91;<span class="opt">@<i class="arg">host</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Check whether <i class="arg">user</i> (as if connecting from <i class="arg">host</i>, if provided) would be granted access under the restrictions given in <a class="link-man" href="../html5/ftpusers.html">ftpusers(5)</a>, and exit without attempting a connection. <b class="name">ftpd</b> exits with an exit code of 0 if access would be granted, or 1 otherwise. This can be useful for testing configurations.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;c</b> <i class="arg">confdir</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Change the root directory of the configuration files from &#8220;<i class="file">/etc</i>&#8221; to <i class="arg">confdir</i>. This changes the directory for the following files: <i class="file">/etc/ftpchroot</i>, <i class="file">/etc/ftpusers</i>, <i class="file">/etc/ftpwelcome</i>, <i class="file">/etc/motd</i>, and the file specified by the <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a> <span class="symb">limit</span> directive.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;D</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Run as daemon. <b class="name">ftpd</b> will listen on the default FTP port for incoming connections and fork a child for each connection. This is lower overhead than starting <b class="name">ftpd</b> from <a class="link-man" href="../html8/inetd.html">inetd(8)</a> and thus might be useful on busy servers to reduce load.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Debugging information is written to the syslog using a facility of <span class="define">LOG_FTP</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;e</b> <i class="arg">emailaddr</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use <i class="arg">emailaddr</i> for the &#8220;%E&#8221; escape sequence (see <i class="link-sec"><a class="link-sec" href="#x446973706c61792066696c65206573636170652073657175656e636573">Display file escape sequences</a></i>)</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;H</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Equivalent to &#8220;-h `hostname`&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;h</b> <i class="arg">hostname</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Explicitly set the hostname to advertise as to <i class="arg">hostname</i>. The default is the hostname associated with the IP address that <b class="name">ftpd</b> is listening on. This ability (with or without <b class="flag">&#45;h</b>), in conjunction with <b class="flag">&#45;c</b> <i class="arg">confdir</i>, is useful when configuring &#8216;virtual&#8217; FTP servers, each listening on separate addresses as separate names. Refer to <a class="link-man" href="../html5/inetd.conf.html">inetd.conf(5)</a> for more information on starting services to listen on specific IP addresses.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;L</b> <i class="arg">xferlogfile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Log wu-ftpd style &#8216;xferlog&#8217; entries to <i class="arg">xferlogfile</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;l</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Each successful and failed FTP session is logged using syslog with a facility of <span class="define">LOG_FTP</span>. If this option is specified more than once, the retrieve (get), store (put), append, delete, make directory, remove directory and rename operations and their file name arguments are also logged.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;n</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't attempt translation of IP addresses to hostnames.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;P</b> <i class="arg">dataport</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use <i class="arg">dataport</i> as the data port, overriding the default of using the port one less that the port <b class="name">ftpd</b> is listening on.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;Q</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable the use of pid files for keeping track of the number of logged-in users per class. This may reduce the load on heavily loaded FTP servers.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;q</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable the use of pid files for keeping track of the number of logged-in users per class. This is the default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;r</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Permanently drop root privileges once the user is logged in. The use of this option may result in the server using a port other than the (listening-port - 1) for <span class="symb">PORT</span> style commands, which is contrary to the <b class="flag">RFC 959</b> specification, but in practice very few clients rely upon this behaviour. See <i class="link-sec"><a class="link-sec" href="#x534543555249545920434f4e53494445524154494f4e53">SECURITY CONSIDERATIONS</a></i> below for more details.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Require a secure authentication mechanism like Kerberos or S/Key to be used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;U</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't log each concurrent FTP session to <i class="file">/var/run/utmp</i>. This is the default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;u</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Log each concurrent FTP session to <i class="file">/var/run/utmp</i>, making them visible to commands such as <a class="link-man" href="../html1/who.html">who(1)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;V</b> <i class="arg">version</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use <i class="arg">version</i> as the version to advertise in the login banner and in the output of <span class="symb">STAT</span> and <span class="symb">SYST</span> instead of the default version information. If <i class="arg">version</i> is empty or &#8216;-&#8217; then don't display any version information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;W</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Don't log each FTP session to <i class="file">/var/log/wtmp</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;w</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Log each FTP session to <i class="file">/var/log/wtmp</i>, making them visible to commands such as <a class="link-man" href="../html1/last.html">last(1)</a>. This is the default.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;X</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Log wu-ftpd style &#8216;xferlog&#8217; entries to the syslog, prefixed with &#8220;xferlog:&#160;&#8221;, using a facility of <span class="define">LOG_FTP</span>. These syslog entries can be converted to a wu-ftpd style <i class="file">xferlog</i> file suitable for input into a third-party log analysis tool with a command similar to:<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">sed -ne 's/^.*xferlog: //p' /var/log/xferlog &gt; wuxferlog</code></div>
</blockquote>
</dd>
</dl>
<p>
The file <i class="file">/etc/nologin</i> can be used to disable FTP access. If the file exists, <b class="name">ftpd</b> displays it and exits. If the file <i class="file">/etc/ftpwelcome</i> exists, <b class="name">ftpd</b> prints it before issuing the &#8220;ready&#8221; message. If the file <i class="file">/etc/motd</i> exists (under the chroot directory if applicable), <b class="name">ftpd</b> prints it after a successful login. This may be changed with the <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a> directive <span class="symb">motd</span>.<p>
The <b class="name">ftpd</b> server currently supports the following FTP requests. The case of the requests is ignored.<table style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-col">
<col style="width: 7.00ex;">
<col style="min-width: 11.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Request</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Description</span></td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
ABOR</td>
<td class="list-col" style="margin-top: 1.00em;">
abort previous command</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
ACCT</td>
<td class="list-col" style="margin-top: 1.00em;">
specify account (ignored)</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
ALLO</td>
<td class="list-col" style="margin-top: 1.00em;">
allocate storage (vacuously)</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
APPE</td>
<td class="list-col" style="margin-top: 1.00em;">
append to a file</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
CDUP</td>
<td class="list-col" style="margin-top: 1.00em;">
change to parent of current working directory</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
CWD</td>
<td class="list-col" style="margin-top: 1.00em;">
change working directory</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
DELE</td>
<td class="list-col" style="margin-top: 1.00em;">
delete a file</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
EPSV</td>
<td class="list-col" style="margin-top: 1.00em;">
prepare for server-to-server transfer</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
EPRT</td>
<td class="list-col" style="margin-top: 1.00em;">
specify data connection port</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
FEAT</td>
<td class="list-col" style="margin-top: 1.00em;">
list extra features that are not defined in <b class="flag">RFC 959</b></td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
HELP</td>
<td class="list-col" style="margin-top: 1.00em;">
give help information</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
LIST</td>
<td class="list-col" style="margin-top: 1.00em;">
give list files in a directory (&#8220;<code class="lit">ls -lA</code>&#8221;)</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
LPSV</td>
<td class="list-col" style="margin-top: 1.00em;">
prepare for server-to-server transfer</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
LPRT</td>
<td class="list-col" style="margin-top: 1.00em;">
specify data connection port</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
MLSD</td>
<td class="list-col" style="margin-top: 1.00em;">
list contents of directory in a machine-processable form</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
MLST</td>
<td class="list-col" style="margin-top: 1.00em;">
show a pathname in a machine-processable form</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
MKD</td>
<td class="list-col" style="margin-top: 1.00em;">
make a directory</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
MDTM</td>
<td class="list-col" style="margin-top: 1.00em;">
show last modification time of file</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
MODE</td>
<td class="list-col" style="margin-top: 1.00em;">
specify data transfer <span class="emph">mode</span></td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
NLST</td>
<td class="list-col" style="margin-top: 1.00em;">
give name list of files in directory</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
NOOP</td>
<td class="list-col" style="margin-top: 1.00em;">
do nothing</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
OPTS</td>
<td class="list-col" style="margin-top: 1.00em;">
define persistent options for a given command</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
PASS</td>
<td class="list-col" style="margin-top: 1.00em;">
specify password</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
PASV</td>
<td class="list-col" style="margin-top: 1.00em;">
prepare for server-to-server transfer</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
PORT</td>
<td class="list-col" style="margin-top: 1.00em;">
specify data connection port</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
PWD</td>
<td class="list-col" style="margin-top: 1.00em;">
print the current working directory</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
QUIT</td>
<td class="list-col" style="margin-top: 1.00em;">
terminate session</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
REST</td>
<td class="list-col" style="margin-top: 1.00em;">
restart incomplete transfer</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
RETR</td>
<td class="list-col" style="margin-top: 1.00em;">
retrieve a file</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
RMD</td>
<td class="list-col" style="margin-top: 1.00em;">
remove a directory</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
RNFR</td>
<td class="list-col" style="margin-top: 1.00em;">
specify rename-from file name</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
RNTO</td>
<td class="list-col" style="margin-top: 1.00em;">
specify rename-to file name</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
SITE</td>
<td class="list-col" style="margin-top: 1.00em;">
non-standard commands (see next section)</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
SIZE</td>
<td class="list-col" style="margin-top: 1.00em;">
return size of file</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
STAT</td>
<td class="list-col" style="margin-top: 1.00em;">
return status of server</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
STOR</td>
<td class="list-col" style="margin-top: 1.00em;">
store a file</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
STOU</td>
<td class="list-col" style="margin-top: 1.00em;">
store a file with a unique name</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
STRU</td>
<td class="list-col" style="margin-top: 1.00em;">
specify data transfer <span class="emph">structure</span></td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
SYST</td>
<td class="list-col" style="margin-top: 1.00em;">
show operating system type of server system</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
TYPE</td>
<td class="list-col" style="margin-top: 1.00em;">
specify data transfer <span class="emph">type</span></td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
USER</td>
<td class="list-col" style="margin-top: 1.00em;">
specify user name</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
XCUP</td>
<td class="list-col" style="margin-top: 1.00em;">
change to parent of current working directory (deprecated)</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
XCWD</td>
<td class="list-col" style="margin-top: 1.00em;">
change working directory (deprecated)</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
XMKD</td>
<td class="list-col" style="margin-top: 1.00em;">
make a directory (deprecated)</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
XPWD</td>
<td class="list-col" style="margin-top: 1.00em;">
print the current working directory (deprecated)</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
XRMD</td>
<td class="list-col" style="margin-top: 1.00em;">
remove a directory (deprecated)</td>
</tr>
</tbody>
</table>
<p>
The following non-standard or <span class="unix">UNIX</span> specific commands are supported by the SITE request.<table style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-col">
<col style="width: 7.00ex;">
<col style="min-width: 11.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Request</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="symb">Description</span></td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
CHMOD</td>
<td class="list-col" style="margin-top: 1.00em;">
change mode of a file, e.g. ``SITE CHMOD 755 filename''</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
HELP</td>
<td class="list-col" style="margin-top: 1.00em;">
give help information.</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
IDLE</td>
<td class="list-col" style="margin-top: 1.00em;">
set idle-timer, e.g. ``SITE IDLE 60''</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
RATEGET</td>
<td class="list-col" style="margin-top: 1.00em;">
set maximum get rate throttle in bytes/second, e.g. ``SITE RATEGET 5k''</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
RATEPUT</td>
<td class="list-col" style="margin-top: 1.00em;">
set maximum put rate throttle in bytes/second, e.g. ``SITE RATEPUT 5k''</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
UMASK</td>
<td class="list-col" style="margin-top: 1.00em;">
change umask, e.g. ``SITE UMASK 002''</td>
</tr>
</tbody>
</table>
<p>
The following FTP requests (as specified in <b class="flag">RFC 959</b> and <b class="flag">RFC 2228</b>) are recognized, but are not implemented: <span class="symb">ACCT</span>, <span class="symb">ADAT</span>, <span class="symb">AUTH</span>, <span class="symb">CCC</span>, <span class="symb">CONF</span>, <span class="symb">ENC</span>, <span class="symb">MIC</span>, <span class="symb">PBSZ</span>, <span class="symb">PROT</span>, <span class="symb">REIN</span>, and <span class="symb">SMNT</span>.<p>
The <b class="name">ftpd</b> server will abort an active file transfer only when the <span class="symb">ABOR</span> command is preceded by a Telnet "Interrupt Process" (IP) signal and a Telnet "Synch" signal in the command Telnet stream, as described in Internet <b class="flag">RFC 959</b>. If a <span class="symb">STAT</span> command is received during a data transfer, preceded by a Telnet IP and Synch, transfer status will be returned.<p>
<b class="name">ftpd</b> interprets file names according to the &#8220;globbing&#8221; conventions used by <a class="link-man" href="../html1/csh.html">csh(1)</a>. This allows users to use the metacharacters &#8220;<code class="lit">*?[]{}~</code>&#8221;.<div class="subsection">
<h2 id="x557365722061757468656e7469636174696f6e">User authentication</h2> <b class="name">ftpd</b> authenticates users according to five rules.<ol style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-enum">
<li class="list-enum" style="margin-top: 1.00em;">
The login name must be in the password data base, <a class="link-man" href="../html5/passwd.html">passwd(5)</a>, and not have a null password. In this case a password must be provided by the client before any file operations may be performed. If the user has an S/Key key, the response from a successful <span class="symb">USER</span> command will include an S/Key challenge. The client may choose to respond with a <span class="symb">PASS</span> command giving either a standard password or an S/Key one-time password. The server will automatically determine which type of password it has been given and attempt to authenticate accordingly. See <a class="link-man" href="../html1/skey.html">skey(1)</a> for more information on S/Key authentication. S/Key is a Trademark of Bellcore.</li>
<li class="list-enum" style="margin-top: 1.00em;">
The login name must be allowed based on the information in <a class="link-man" href="../html5/ftpusers.html">ftpusers(5)</a>.</li>
<li class="list-enum" style="margin-top: 1.00em;">
The user must have a standard shell returned by <a class="link-man" href="../html3/getusershell.html">getusershell(3)</a>. If the user's shell field in the password database is empty, the shell is assumed to be <i class="file">/bin/sh</i>. As per <a class="link-man" href="../html5/shells.html">shells(5)</a>, the user's shell must be listed with full path in <i class="file">/etc/shells</i>.</li>
<li class="list-enum" style="margin-top: 1.00em;">
If directed by the file <a class="link-man" href="../html5/ftpchroot.html">ftpchroot(5)</a> the session's root directory will be changed by <a class="link-man" href="../html2/chroot.html">chroot(2)</a> to the directory specified in the <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a> <span class="symb">chroot</span> directive (if set), or to the home directory of the user. This facility may also be triggered by enabling the boolean <span class="symb">ftp-chroot</span> in <a class="link-man" href="../html5/login.conf.html">login.conf(5)</a>. However, the user must still supply a password. This feature is intended as a compromise between a fully anonymous account and a fully privileged account. The account should also be set up as for an anonymous account.</li>
<li class="list-enum" style="margin-top: 1.00em;">
If the user name is &#8220;anonymous&#8221; or &#8220;ftp&#8221;, an anonymous FTP account must be present in the password file (user &#8220;ftp&#8221;). In this case the user is allowed to log in by specifying any password (by convention an email address for the user should be used as the password).<p>
The server performs a <a class="link-man" href="../html2/chroot.html">chroot(2)</a> to the directory specified in the <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a> <span class="symb">chroot</span> directive (if set), the <b class="flag">&#45;a</b> <i class="arg">anondir</i> directory (if set), or to the home directory of the &#8220;ftp&#8221; user.<p>
The server then performs a <a class="link-man" href="../html2/chdir.html">chdir(2)</a> to the directory specified in the <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a> <span class="symb">homedir</span> directive (if set), otherwise to <i class="file">/</i>.<p>
If other restrictions are required (such as disabling of certain commands and the setting of a specific umask), then appropriate entries in <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a> are required.<p>
If the first character of the password supplied by an anonymous user is &#8220;-&#8221;, then the verbose messages displayed at login and upon a <span class="symb">CWD</span> command are suppressed.</li>
</ol>
</div>
<div class="subsection">
<h2 id="x446973706c61792066696c65206573636170652073657175656e636573">Display file escape sequences</h2> When <b class="name">ftpd</b> displays various files back to the client (such as <i class="file">/etc/ftpwelcome</i> and <i class="file">/etc/motd</i>), various escape strings are replaced with information pertinent to the current connection.<p>
The supported escape strings are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">Escape</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<span class="symb">Description</span></dd>
<dt class="list-tag" style="margin-top: 0.00em;">
%c</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Class name.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
%C</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Current working directory.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
%E</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Email address given with <b class="flag">&#45;e</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
%L</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Local hostname.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
%M</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Maximum number of users for this class. Displays &#8220;unlimited&#8221; if there's no limit.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
%N</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Current number of users for this class.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
%R</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Remote hostname.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
%s</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If the result of the most recent &#8220;%M&#8221; or &#8220;%N&#8221; was not &#8220;<code class="lit">1</code>&#8221;, print an &#8220;s&#8221;.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
%S</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If the result of the most recent &#8220;%M&#8221; or &#8220;%N&#8221; was not &#8220;<code class="lit">1</code>&#8221;, print an &#8220;S&#8221;.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
%T</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Current time.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
%U</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
User name.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
%%</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A &#8220;%&#8221; character.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x53657474696e6720757020612072657374726963746564206674702073756274726565">Setting up a restricted ftp subtree</h2> In order that system security is not breached, it is recommended that the subtrees for the &#8220;ftp&#8221; and &#8220;chroot&#8221; accounts be constructed with care, following these rules (replace &#8220;ftp&#8221; in the following directory names with the appropriate account name for &#8216;chroot&#8217; users):<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="file">~ftp</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Make the home directory owned by &#8220;root&#8221; and unwritable by anyone.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="file">~ftp/bin</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Make this directory owned by &#8220;root&#8221; and unwritable by anyone (mode 555). Generally any conversion commands should be installed here (mode 111).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="file">~ftp/etc</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Make this directory owned by &#8220;root&#8221; and unwritable by anyone (mode 555). The files <i class="file">pwd.db</i> (see <a class="link-man" href="../html5/passwd.html">passwd(5)</a>) and <i class="file">group</i> (see <a class="link-man" href="../html5/group.html">group(5)</a>) must be present for the <span class="symb">LIST</span> command to be able to display owner and group names instead of numbers. The password field in <a class="link-man" href="../html5/passwd.html">passwd(5)</a> is not used, and should not contain real passwords. The file <i class="file">motd</i>, if present, will be printed after a successful login. These files should be mode 444.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="file">~ftp/pub</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
This directory and the subdirectories beneath it should be owned by the users and groups responsible for placing files in them, and be writable only by them (mode 755 or 775). They should <span class="emph">not</span> be owned or writable by ftp or its group.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="file">~ftp/incoming</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
This directory is where anonymous users place files they upload. The owners should be the user &#8220;ftp&#8221; and an appropriate group. Members of this group will be the only users with access to these files after they have been uploaded; these should be people who know how to deal with them appropriately. If you wish anonymous FTP users to be able to see the names of the files in this directory the permissions should be 770, otherwise they should be 370.<p>
The following <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a> directives should be used:<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">modify guest off</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">umask  guest 0707</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">upload guest on</code></div>
</blockquote>
<p>
This will result in anonymous users being able to upload files to this directory, but they will not be able to download them, delete them, or overwrite them, due to the umask and disabling of the commands mentioned above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="file">~ftp/tmp</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
This directory is used to create temporary files which contain the error messages generated by a conversion or <span class="symb">LIST</span> command. The owner should be the user &#8220;ftp&#8221;. The permissions should be 300.<p>
If you don't enable conversion commands, or don't want anonymous users uploading files here (see <i class="file">~ftp/incoming</i> above), then don't create this directory. However, error messages from conversion or <span class="symb">LIST</span> commands won't be returned to the user. (This is the traditional behaviour.) Note that the <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a> directive <span class="symb">upload</span> can be used to prevent users uploading here.</dd>
</dl>
<p>
To set up "ftp-only" accounts that provide only FTP, but no valid shell login, you can copy/link <i class="file">/sbin/nologin</i> to <i class="file">/sbin/ftplogin</i>, and enter <i class="file">/sbin/ftplogin</i> to <i class="file">/etc/shells</i> to allow logging-in via FTP into the accounts, which must have <i class="file">/sbin/ftplogin</i> as login shell.</div>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/ftpchroot</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
List of normal users whose root directory should be changed via <a class="link-man" href="../html2/chroot.html">chroot(2)</a>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/ftpd.conf</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Configure file conversions and other settings.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/ftpusers</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
List of unwelcome/restricted users.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/ftpwelcome</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Welcome notice before login.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/motd</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Welcome notice after login.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/nologin</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
If it exists, displayed and access is refused.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/run/ftpd.pids-CLASS</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
State file of logged-in processes for the <b class="name">ftpd</b> class &#8216;CLASS&#8217;.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/run/utmp</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
List of logged-in users on the system.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/log/wtmp</i></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Login history database.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/ftp.html">ftp(1)</a>, <a class="link-man" href="../html1/skey.html">skey(1)</a>, <a class="link-man" href="../html1/who.html">who(1)</a>, <a class="link-man" href="../html3/getusershell.html">getusershell(3)</a>, <a class="link-man" href="../html5/ftpchroot.html">ftpchroot(5)</a>, <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a>, <a class="link-man" href="../html5/ftpusers.html">ftpusers(5)</a>, <a class="link-man" href="../html5/login.conf.html">login.conf(5)</a>, <a class="link-man" href="../html8/syslogd.html">syslogd(8)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> <b class="name">ftpd</b> recognizes all commands in <b class="flag">RFC 959</b>, follows the guidelines in <b class="flag">RFC 1123</b>, recognizes all commands in <b class="flag">RFC 2228</b> (although they are not supported yet), and supports the extensions from <b class="flag">RFC 2389</b>, <b class="flag">RFC 2428</b>, and <b class="flag">RFC 3659</b>.</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">ftpd</b> command appeared in <span class="unix">4.2BSD</span>.<p>
Various features such as the <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a> functionality, <b class="flag">RFC 2389</b>, and <b class="flag">RFC 3659</b> support was implemented in <span class="unix">NetBSD&#160;1.3</span> and later releases by Luke Mewburn.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The server must run as the super-user to create sockets with privileged port numbers (i.e, those less than <span class="define">IPPORT_RESERVED</span>, which is 1024). If <b class="name">ftpd</b> is listening on a privileged port it maintains an effective user id of the logged in user, reverting to the super-user only when binding addresses to privileged sockets. The <b class="flag">&#45;r</b> option can be used to override this behaviour and force privileges to be permanently revoked; see <i class="link-sec"><a class="link-sec" href="#x534543555249545920434f4e53494445524154494f4e53">SECURITY CONSIDERATIONS</a></i> below for more details.<p>
<b class="name">ftpd</b> may have trouble handling connections from scoped IPv6 addresses, or IPv4 mapped addresses (IPv4 connection on <span class="define">AF_INET6</span> socket). For the latter case, running two daemons, one for IPv4 and one for IPv6, will avoid the problem.</div>
<div class="section">
<h1 id="x534543555249545920434f4e53494445524154494f4e53">SECURITY CONSIDERATIONS</h1> <b class="flag">RFC 959</b> provides no restrictions on the <span class="symb">PORT</span> command, and this can lead to security problems, as <b class="name">ftpd</b> can be fooled into connecting to any service on any host. With the &#8220;checkportcmd&#8221; feature of the <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a>, <span class="symb">PORT</span> commands with different host addresses, or TCP ports lower than <span class="define">IPPORT_RESERVED</span> will be rejected. This also prevents &#8216;third-party proxy ftp&#8217; from working. Use of this option is <span class="emph">strongly</span> recommended, and enabled by default.<p>
By default <b class="name">ftpd</b> uses a port that is one less than the port it is listening on to communicate back to the client for the <span class="symb">EPRT</span>, <span class="symb">LPRT</span>, and <span class="symb">PORT</span> commands, unless overridden with <b class="flag">&#45;P</b> <i class="arg">dataport</i>. As the default port for <b class="name">ftpd</b> (21) is a privileged port below <span class="define">IPPORT_RESERVED</span>, <b class="name">ftpd</b> retains the ability to switch back to root privileges to bind these ports. In order to increase security by reducing the potential for a bug in <b class="name">ftpd</b> providing a remote root compromise, <b class="name">ftpd</b> will permanently drop root privileges if one of the following is true:<ol style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-enum">
<li class="list-enum" style="margin-top: 1.00em;">
<b class="name">ftpd</b> is running on a port greater than <span class="define">IPPORT_RESERVED</span> and the user has logged in as a &#8216;guest&#8217; or &#8216;chroot&#8217; user.</li>
<li class="list-enum" style="margin-top: 1.00em;">
<b class="name">ftpd</b> was invoked with <b class="flag">&#45;r</b>.</li>
</ol>
<p>
Don't create <i class="file">~ftp/tmp</i> if you don't want anonymous users to upload files there. That directory is only necessary if you want to display the error messages of conversion commands to the user. Note that if uploads are disabled with the <a class="link-man" href="../html5/ftpd.conf.html">ftpd.conf(5)</a> directive <span class="symb">upload</span>, then this directory cannot be abused by the user in this way, so it should be safe to create.<p>
To avoid possible denial-of-service attacks, <span class="symb">SIZE</span> requests against files larger than 10240 bytes will be denied if the current transfer <span class="symb">TYPE</span> is &#8216;<code class="lit">A</code>&#8217; (ASCII).</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 1, 2009</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

