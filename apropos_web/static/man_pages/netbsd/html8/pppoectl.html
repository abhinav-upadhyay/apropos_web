<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
PPPOECTL(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
PPPOECTL(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
PPPOECTL(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">pppoectl</b>, <b class="name">ipppctl</b> &#8212; <span class="desc">display or set parameters for an pppoe or isdn ppp (ippp) interface</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 8.00ex;">
<col>
<tbody>
<tr>
<td>
pppoectl</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;v</b></span>&#93; <i class="arg">ifname</i> &#91;<span class="opt"><i class="arg">parameter</i>&#91;<span class="opt">=<i class="arg">value</i></span>&#93;</span>&#93; &#91;<span class="opt"><i class="arg">...</i></span>&#93;</td>
</tr>
</tbody>
</table>
<p>
<br>
<table class="synopsis">
<col style="width: 8.00ex;">
<col>
<tbody>
<tr>
<td>
ipppctl</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;v</b></span>&#93; <i class="arg">ifname</i> &#91;<span class="opt"><i class="arg">parameter</i>&#91;<span class="opt">=<i class="arg">value</i></span>&#93;</span>&#93; &#91;<span class="opt"><i class="arg">...</i></span>&#93;</td>
</tr>
</tbody>
</table>
<p>
<br>
<table class="synopsis">
<col style="width: 8.00ex;">
<col>
<tbody>
<tr>
<td>
pppoectl</td>
<td>
<b class="flag">&#45;e</b> <i class="arg">ethernet-ifname</i> &#91;<span class="opt"><b class="flag">&#45;s</b> <i class="arg">service-name</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;a</b> <i class="arg">access-concentrator-name</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;d</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;n</b> <i class="arg">1 | 2</i></span>&#93; <i class="arg">ifname</i></td>
</tr>
</tbody>
</table>
<p>
<br>
<table class="synopsis">
<col style="width: 8.00ex;">
<col>
<tbody>
<tr>
<td>
pppoectl</td>
<td>
<b class="flag">&#45;f</b> <i class="arg">config-file</i> <i class="arg">ifname</i> &#91;<span class="opt"><i class="arg">...</i></span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> There are two basic modes of operation: configuring security-related parameters and attaching a PPPoE interface to its ethernet interface, optionally passing in additional parameters for the PPPoE encapsulation.<p>
The latter usage is indicated by the presence of the <b class="flag">&#45;e</b> option, which takes the name of the ethernet interface as its argument.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;e</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
specifies the ethernet interface used to communicate with the access concentrator (typically via a DSL modem).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;a</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
specifies the name of the access concentrator.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
specifies the name of the service connected to.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
dump the current connection state information (this parameter is typically used alone, for informational purposes, not during interface configuration).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;n</b> <i class="arg">1 | 2</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
print the IP address of the primary or secondary DNS name server for this PPP connection. This is only available if DNS query is enabled, see <i class="arg">query-dns</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;f</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
parse <i class="arg">config-file</i> for <i class="arg">parameter</i>&#91;<span class="opt">=<i class="arg">value</i></span>&#93; pairs, one per line, as if they had been specified on the command line. This allows the password to be not passed as a command line argument. Unless escaped by &#92;, comments starting with # to the end of the current line are ignored.</dd>
</dl>
<p>
Typically, not both the access concentrator name and the service name are specified.<p>
The <a class="link-man" href="../html4/ippp.html">ippp(4)</a> or the <a class="link-man" href="../html4/pppoe.html">pppoe(4)</a> drivers require a number of additional arguments or optional parameters besides the settings that can be adjusted with <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a>. These are things like authentication protocol parameters, but also other tunable configuration variables. The <b class="name">pppoectl</b> utility can be used to display the current settings, or adjust these parameters as required.<p>
For whatever intent <b class="name">pppoectl</b> is being called, at least the parameter <i class="arg">ifname</i> needs to be specified, naming the interface for which the settings are to be performed or displayed. Use <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a> or <a class="link-man" href="../html1/netstat.html">netstat(1)</a> to see which interfaces are available.<p>
If no other parameter is given, <b class="name">pppoectl</b> will just list the current settings for <i class="arg">ifname</i> and exit. The reported settings include the current PPP phase the interface is in, which can be one of the names <span class="emph">dead</span>, <span class="emph">establish</span>, <span class="emph">authenticate</span>, <span class="emph">network</span>, or <span class="emph">terminate</span>. If an authentication protocol is configured for the interface, the name of the protocol to be used, as well as the system name to be used or expected will be displayed, plus any possible options to the authentication protocol if applicable. Note that the authentication secrets (sometimes also called <span class="emph">keys</span>) are not being returned by the underlying system call, and are thus not displayed.<p>
If any additional parameter is supplied, superuser privileges are required, and the command works in &#8216;<code class="lit">set</code>&#8217; mode. This is normally done quietly, unless the option <b class="flag">&#45;v</b> is also enabled, which will cause a final printout of the settings as described above once all other actions have been taken. Use of this mode will be rejected if the interface is currently in any other phase than <span class="emph">dead</span>. Note that you can force an interface into <span class="emph">dead</span> phase by calling <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a> with the parameter &#8216;<code class="lit">down</code>&#8217;.<p>
The currently supported parameters include:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">authproto</i>=<span class="emph">protoname</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Set both his and my authentication protocol to <span class="emph">protoname</span>. The protocol name can be one of &#8216;<code class="lit">chap</code>&#8217;, &#8216;<code class="lit">pap</code>&#8217;, or &#8216;<code class="lit">none</code>&#8217;. In the latter case, the use of an authentication protocol will be turned off for the named interface. This has the side-effect of clearing the other authentication-related parameters for this interface as well (i. e., system name and authentication secret will be forgotten).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">myauthproto</i>=<span class="emph">protoname</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Same as above, but only for my end of the link. I.e., this is the protocol when remote is authenticator, and I am the peer required to authenticate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">hisauthproto</i>=<span class="emph">protoname</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Same as above, but only for his end of the link.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">myauthname</i>=<span class="emph">name</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Set my system name for the authentication protocol.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">hisauthname</i>=<span class="emph">name</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Set his system name for the authentication protocol. For CHAP, this will only be used as a hint, causing a warning message if remote did supply a different name. For PAP, it's the name remote must use to authenticate himself (in connection with his secret).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">myauthsecret</i>=<span class="emph">secret</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Set my secret (key, password) for use in the authentication phase. For CHAP, this will be used to compute the response hash value, based on remote's challenge. For PAP, it will be transmitted as plaintext together with the system name. Don't forget to quote the secrets from the shell if they contain shell metacharacters (or whitespace).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">myauthkey</i>=<span class="emph">secret</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Same as above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">hisauthsecret</i>=<span class="emph">secret</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Same as above, to be used if we are authenticator and the remote peer needs to authenticate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">hisauthkey</i>=<span class="emph">secret</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Same as above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">callin</i></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Require remote to authenticate himself only when he's calling in, but not when we are caller. This is required for some peers that do not implement the authentication protocols symmetrically (like Ascend routers, for example).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">always</i></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
The opposite of <i class="arg">callin</i>. Require remote to always authenticate, regardless of which side is placing the call. This is the default, and will not be explicitly displayed in &#8216;<code class="lit">list</code>&#8217; mode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">norechallenge</i></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Only meaningful with CHAP. Do not re-challenge peer once the initial CHAP handshake was successful. Used to work around broken peer implementations that can't grok being re-challenged once the connection is up.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">rechallenge</i></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
With CHAP, send re-challenges at random intervals while the connection is in network phase. (The intervals are currently in the range of 300 through approximately 800 seconds.) This is the default, and will not be explicitly displayed in &#8216;<code class="lit">list</code>&#8217; mode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">idle-timeout</i>=<span class="emph">idle-seconds</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
For services that are charged by connection time the interface can optionally disconnect after a configured idle time. If set to 0, this feature is disabled. Note: for ISDN devices, it is preferable to use the <a class="link-man" href="../html8/isdnd.html">isdnd(8)</a> based timeout mechanism, as isdnd can predict the next charging unit for ISDN connections and optimize the timeout with this information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">lcp-timeout</i>=<span class="emph">timeout-value</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Allows to change the value of the LCP timeout. The default value of the LCP timeout is currently set to 1 second. The timeout-value must be specified in milliseconds.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">max-noreceive</i>=<span class="emph">sec</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Sets the number of seconds after last reception of data from the peer before the line state is probed by sending LCP echo requests. The <span class="emph">sec</span> interval is not used verbatim, the first echo request might be delayed upto 10 seconds after the configured interval.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">max-alive-missed</i>=<span class="emph">count</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Sets the number of unanswered LCP echo requests that we will tolerate before considering a connection to be dead. LCP echo requests are sent in 10 seconds interval after the configured <span class="emph">max-noreceive</span> interval has passed with no data received from the peer.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">max-auth-failure</i>=<span class="emph">count</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Since some ISPs disable accounts after too many unsuccessful authentication attempts, there is a maximum number of authentication failures before we will stop retrying without manual intervention. Manual intervention is either changing the authentication data (name, password) or setting the maximum retry count. If <span class="emph">count</span> is set to <span class="emph">0</span> this feature is disabled.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">clear-auth-failure</i></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
If an authentication failure has been caused by remote problems and you want to retry connecting using unchanged local settings, this command can be used to reset the failure count to zero.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">query-dns</i>=<span class="emph">flags</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
During PPP protocol negotiation we can query the peer for addresses of two name servers. If <i class="arg">flags</i> is <span class="emph">1</span> only the first server address will be requested, if <i class="arg">flags</i> is <span class="emph">2</span> the second will be requested. Setting <i class="arg">flags</i> to <span class="emph">3</span> queries both.<p>
The result of the negotiation can be retrieved with the <b class="flag">&#45;n</b> option.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1><pre style="margin-left: 0.00ex;" class="lit display">
# ipppctl ippp0 
ippp0:	phase=dead 
	myauthproto=chap myauthname="uriah" 
	hisauthproto=chap hisauthname="ifb-gw" norechallenge 
	lcp timeout: 3.000 s</pre>
<p>
Display the settings for ippp0. The interface is currently in <span class="emph">dead</span> phase, i.e. the LCP layer is down, and no traffic is possible. Both ends of the connection use the CHAP protocol, my end tells remote the system name &#8216;<code class="lit">uriah</code>&#8217;, and remote is expected to authenticate by the name &#8216;<code class="lit">ifb-gw</code>&#8217;. Once the initial CHAP handshake was successful, no further CHAP challenges will be transmitted. There are supposedly some known CHAP secrets for both ends of the link which are not being shown.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
# ipppctl ippp0 &#92; 
	authproto=chap &#92; 
	myauthname=uriah myauthsecret='some secret' &#92; 
	hisauthname=ifb-gw hisauthsecret='another' &#92; 
	norechallenge</pre>
<p>
A possible call to <b class="name">pppoectl</b> that could have been used to bring the interface into the state shown by the previous example.<p>
The following example is the complete sequence of commands to bring a PPPoE connection up:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
# Need ethernet interface UP (or it won't send any packets) 
ifconfig ne0 up 
 
# Let pppoe0 use ne0 as its ethernet interface 
pppoectl -e ne0 pppoe0 
 
# Configure authentication 
pppoectl pppoe0 &#92; 
  myauthproto=pap &#92; 
  myauthname=XXXXX &#92; 
  myauthsecret=YYYYY &#92; 
  hisauthproto=none 
 
# Configure the pppoe0 interface itself.  These addresses are magic, 
# meaning we don't care about either address and let the remote 
# ppp choose them. 
ifconfig pppoe0 0.0.0.0 0.0.0.1 netmask 0xffffffff up</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/netstat.html">netstat(1)</a>, <a class="link-man" href="../html4/ippp.html">ippp(4)</a>, <a class="link-man" href="../html4/pppoe.html">pppoe(4)</a>, <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a>, <a class="link-man" href="../html8/ifwatchd.html">ifwatchd(8)</a><p>
<span class="ref"><span class="ref-auth">B. Lloyd</span> and <span class="ref-auth">W. Simpson</span>, <span class="ref-title">PPP Authentication Protocols</span>, <span class="ref-opt">RFC 1334</span>.</span><p>
<span class="ref"><span class="ref-auth">W. Simpson, Editor</span>, <span class="ref-title">The Point-to-Point Protocol (PPP)</span>, <span class="ref-opt">RFC 1661</span>.</span><p>
<span class="ref"><span class="ref-auth">W. Simpson</span>, <span class="ref-title">PPP Challenge Handshake Authentication Protocol (CHAP)</span>, <span class="ref-opt">RFC 1994</span>.</span><p>
<span class="ref"><span class="ref-auth">L. Mamakos</span>, <span class="ref-auth">K. Lidl</span>, <span class="ref-auth">J. Evarts</span>, <span class="ref-auth">D. Carrel</span>, <span class="ref-auth">D. Simone</span>, and <span class="ref-auth">R. Wheeler</span>, <span class="ref-title">A Method for Transmitting PPP Over Ethernet (PPPoE)</span>, <span class="ref-opt">RFC 2516</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">pppoectl</b> utility is based on the <b class="cmd">spppcontrol</b> utility which appeared in <span class="unix">FreeBSD&#160;3.0</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The program was written by J&#246;rg Wunsch, Dresden, and modified for PPPoE support by Martin Husemann.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
October 11, 2011</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

