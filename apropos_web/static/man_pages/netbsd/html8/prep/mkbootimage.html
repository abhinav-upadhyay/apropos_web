<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../../style.css" type="text/css" media="all">
<title>
MKBOOTIMAGE(8) (PReP)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
MKBOOTIMAGE(8)</td>
<td class="head-vol" align="center">
System Manager's Manual (PReP)</td>
<td class="head-rtitle" align="right">
MKBOOTIMAGE(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">mkbootimage</b> &#8212; <span class="desc">create a prep boot image</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 11.00ex;">
<col>
<tbody>
<tr>
<td>
mkbootimage</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;lsv</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;b</b> <i class="arg">bootfile</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;k</b> <i class="arg">kernel</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;m</b> <i class="arg">machine_arch</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;r</b> <i class="arg">rawdev</i></span>&#93; <i class="arg">boot-image</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">mkbootimage</b> is the utility used to create a bootable kernel image on <span class="unix">NetBSD</span> for prep, bebox or rs6000.<p>
The <b class="name">mkbootimage</b> utility takes the boot-program, and the optional kernel, and creates a boot image from them. This image contains the boot code, kernel, and optionally an i386 partition table. The image can be written directly to a floppy or hard drive with the <a class="link-man" href="../../1/dd">dd(1)</a> command, or it can be directly netbooted via <a class="link-man" href="../../8/bootpd">bootpd(8)</a>.<p>
The following options are available:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;b</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies which bootloader to embed in the bootable image. Defaults to <i class="file">/usr/mdec/boot</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;k</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies which kernel binary to embed in the bootable image. Defaults to <i class="file">/netbsd</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;l</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Creates a partition table for a 2.88MB floppy instead of a 1.44MB floppy. This is primarily used for El-Torrito style CD images.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;m</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Selects the machine architecture to build the image for. Currently supports prep, rs6000 and bebox. Defaults to the machine architecture you are currently running on. This option is required if you are building an image for another machine, such as building a prep boot image on i386.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;r</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the raw device to read to gather the current partition table. This is generally <i class="file">/dev/rsd0c</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generates a standalone image with no partition table embedded.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generates verbose output, useful for debugging.</dd>
</dl>
<p>
There are three primary ways to use <b class="name">mkbootimage</b> to build a bootable image:<p>
The first method is to build an image suitable for a floppy or netboot. This will create an image with an embedded partition table with a single PReP boot partition of type 0x41(65). The image can be directly netbooted, or if it is small enough, written directly to a floppy with <a class="link-man" href="../../1/dd">dd(1)</a>. <b class="name">mkbootimage</b> will warn you if the generated image is too large to be written to a floppy.<p>
The second method is to build a standalone image with no partition table. This should be written to the PReP boot partition on your hard drive with <a class="link-man" href="../../1/dd">dd(1)</a>.<p>
The third method is for use in upgrading older systems that have been built by writing the floppy image directly to the head of the hard drive. This method reads the existing partition table and embeds that in the image. This should prevent loss of your current partition layout. This image should be written directly to the head of the disk with <a class="link-man" href="../../1/dd">dd(1)</a>.<p>
The recommended setup for a PReP machine is to build a partition table with <a class="link-man" href="../../8/fdisk">fdisk(8)</a> that contains a PReP boot partition (type 65) as partition 0, marked active, and a second partition for <span class="unix">NetBSD</span> encompassing the remainder of the disk. You should then create a disklabel on that disk with a partition (such as e) pointing to the PReP boot partition. Partition c should be the whole disk, and partition d can optionally be the <span class="unix">NetBSD</span> portion of the disk. You may then use the other partitions for your normal disk layout. The PReP boot partition can be placed anywhere on the disk, but it is recommended that it be placed at the beginning of the disk.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Create a floppy or netboot image for prep named &#8216;boot.fs&#8217;:<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"><b class="cmd">mkbootimage -m prep -b /usr/mdec/boot -k /netbsd boot.fs</b></code></div>
</blockquote>
Create a standalone bebox image for booting from a hard disk:<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"><b class="cmd">mkbootimage -s -m bebox -b /usr/mdec/boot -k /netbsd boot.fs</b></code></div>
</blockquote>
Use the partition information on &#8216;sd0&#8217; to create a new bootable image with com0 as the console:<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit"><b class="cmd">mkbootimage -b /usr/mdec/boot_com0 -k /netbsd -r /dev/rsd0c boot.fs</b></code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../../1/dd">dd(1)</a>, <a class="link-man" href="../../8/boot">boot(8)</a>, <a class="link-man" href="../../8/bootpd">bootpd(8)</a>, <a class="link-man" href="../../8/disklabel">disklabel(8)</a>, <a class="link-man" href="../../8/fdisk">fdisk(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> <b class="name">mkbootimage</b> first appeared in <span class="unix">NetBSD&#160;1.5</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <b class="name">mkbootimage</b> was written by <span class="author">NONAKA Kimihiro</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 30, 2008</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

