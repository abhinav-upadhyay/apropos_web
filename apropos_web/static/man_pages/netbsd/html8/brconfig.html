<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
BRCONFIG(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
BRCONFIG(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
BRCONFIG(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">brconfig</b> &#8212; <span class="desc">configure network bridge parameters</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 8.00ex;">
<col>
<tbody>
<tr>
<td>
brconfig</td>
<td>
<b class="flag">&#45;a</b></td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 8.00ex;">
<col>
<tbody>
<tr>
<td>
brconfig</td>
<td>
<i class="arg">bridge</i></td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 8.00ex;">
<col>
<tbody>
<tr>
<td>
brconfig</td>
<td>
<i class="arg">bridge</i> <i class="arg">command</i> &#91;<span class="opt"><i class="arg">args ...</i></span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">brconfig</b> utility is used to configure network bridge parameters and retrieve network bridge parameters and status from the kernel. The bridging function is implemented by the <a class="link-man" href="../html4/bridge.html">bridge(4)</a> driver.<p>
A network bridge creates a logical link between two or more IEEE 802 networks that use the same (or &#8220;similar enough&#8221;) framing format. For example, it is possible to bridge Ethernet and 802.11 networks together, but it is not possible to bridge Ethernet and Token Ring together.<p>
Bridge interfaces are created using the <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a> command's &#8220;create&#8221; sub-command. All other bridge configuration is performed using <b class="name">brconfig</b>.<p>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;a</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Display the status of all bridge devices present on the system. This flag is mutually exclusive with all other sub-commands.</dd>
</dl>
<p>
All other operations require that a bridge be specified. If a bridge is specified with no sub-commands, the status of that bridge is displayed. The following sub-commands are available:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">up</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Start forwarding packets on the bridge.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">down</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Stop forwarding packets on the bridge.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">add</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Add the interface named by <i class="arg">interface</i> as a member of the bridge. The interface is put into promiscuous mode so that it can receive every packet sent on the network.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">delete</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Remove the interface named by <i class="arg">interface</i> from the bridge. Promiscuous mode is disabled on the interface when it is removed from the bridge.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">addr</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Display the addresses that have been learned by the bridge.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">maxaddr</b> <i class="arg">size</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the size of the bridge address cache to <i class="arg">size</i>. The default is 100 entries.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">timeout</b> <i class="arg">seconds</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the timeout of address cache entries to <i class="arg">seconds</i> seconds. If <i class="arg">seconds</i> is zero, then address cache entries will not be expired. The default is 1200 seconds.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">deladdr</b> <i class="arg">address</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Delete <i class="arg">address</i> from the address cache.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">flush</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Delete all dynamically-learned addresses from the address cache.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">flushall</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Delete all addresses, including static addresses, from the address cache.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">discover</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Mark an interface as a &#8220;discovering&#8221; interface. When the bridge has no address cache entry (either dynamic or static) for the destination address of a packet, the bridge will forward the packet to all member interfaces marked as &#8220;discovering&#8221;. This is the default for all interfaces added to a bridge.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-discover</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Clear the &#8220;discovering&#8221; attribute on a member interface. For packets without the &#8220;discovering&#8221; attribute, the only packets forwarded on the interface are broadcast or multicast packets and packets for which the destination address is known to be on the interface's segment.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ipf</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable packet filtering with <a class="link-man" href="../html9/pfil.html">pfil(9)</a> on the bridge. The current implementation passes all ARP and RARP packets through the bridge while filtering IP and IPv6 packets through the configured packet filter, such as <a class="link-man" href="../html4/ipf.html">ipf(4)</a> or <a class="link-man" href="../html4/pf.html">pf(4)</a>. Other packet types are blocked.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">learn</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Mark an interface as a &#8220;learning&#8221; interface. When a packet arrives on such an interface, the source address of the packet is entered into the address cache as being a destination address on the interface's segment. This is the default for all interfaces added to a bridge.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-learn</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Clear the &#8220;learning&#8221; attribute on a member interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">static</b> <i class="arg">interface address</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Add a static entry into the address cache pointing to <i class="arg">interface</i>. Static entries are never aged out of the cache or replaced, even if the address is seen on a different interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">stp</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable Spanning Tree protocol on <i class="arg">interface</i>. The <a class="link-man" href="../html4/bridge.html">bridge(4)</a> driver has support for the IEEE 802.1D Spanning Tree protocol (STP). Spanning Tree is used to detect and remove loops in a network topology.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-stp</b> <i class="arg">interface</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable Spanning Tree protocol on <i class="arg">interface</i>. This is the default for all interfaces added to a bridge.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">maxage</b> <i class="arg">seconds</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the time that a Spanning Tree protocol configuration is valid. The default is 20 seconds. The minimum is 1 second and the maximum is 255 seconds.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">fwddelay</b> <i class="arg">seconds</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the time that must pass before an interface begins forwarding packets when Spanning Tree is enabled. The default is 15 seconds. The minimum is 1 second and the maximum is 255 seconds.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">hellotime</b> <i class="arg">seconds</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the time between broadcasting of Spanning Tree protocol configuration messages. The default is 2 seconds. The minimum is 1 second and the maximum is 255 seconds.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">priority</b> <i class="arg">value</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the bridge priority for Spanning Tree. The default is 32768. Allowed numerical values range from 0 (highest priority) to 65535 (lowest priority).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ifpriority</b> <i class="arg">interface</i> <i class="arg">value</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the Spanning Tree priority of <i class="arg">interface</i> to <i class="arg">value</i>. The default is 128. The minimum is 0 and the maximum is 255.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ifpathcost</b> <i class="arg">interface</i> <i class="arg">value</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the Spanning Tree path cost of <i class="arg">interface</i> to <i class="arg">value</i>. The default is 55. The minimum is 0 and the maximum is 65535.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The following, when placed in the file <i class="file">/etc/ifconfig.bridge0</i>, will cause a bridge called &#8216;bridge0&#8217; to be created, add the interfaces &#8216;ray0&#8217; and &#8216;fxp0&#8217; to the bridge, and then enable packet forwarding. Such a configuration could be used to implement a simple 802.11-to-Ethernet bridge (assuming the 802.11 interface is in ad-hoc mode).<p>
<pre style="margin-left: 5.00ex;" class="lit display">
create 
!brconfig $int add ray0 add fxp0 up</pre>
<p>
Consider a system with two 4-port Ethernet boards. The following placed in the file <i class="file">/etc/ifconfig.bridge0</i> will cause a bridge consisting of all 8 ports with Spanning Tree enabled to be created:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
create 
!brconfig $int &#92; 
    add tlp0 stp tlp0 &#92; 
    add tlp1 stp tlp1 &#92; 
    add tlp2 stp tlp2 &#92; 
    add tlp3 stp tlp3 &#92; 
    add tlp4 stp tlp4 &#92; 
    add tlp5 stp tlp5 &#92; 
    add tlp6 stp tlp6 &#92; 
    add tlp7 stp tlp7 &#92; 
    up</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/bridge.html">bridge(4)</a>, <a class="link-man" href="../html4/pf.html">pf(4)</a>, <a class="link-man" href="../html5/ifconfig.if.html">ifconfig.if(5)</a>, <a class="link-man" href="../html8/ifconfig.html">ifconfig(8)</a>, <a class="link-man" href="../html8/ipf.html">ipf(8)</a>, <a class="link-man" href="../html9/pfil.html">pfil(9)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">brconfig</b> utility first appeared in <span class="unix">NetBSD&#160;1.6</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <a class="link-man" href="../html4/bridge.html">bridge(4)</a> driver and <b class="name">brconfig</b> utility were originally written by <span class="author">Jason L. Wright</span> &#60;jason@thought.net&#62; as part of an undergraduate independent study at the University of North Carolina at Greensboro.<p>
This version of the <b class="name">brconfig</b> utility was written from scratch by <span class="author">Jason R. Thorpe</span> &#60;thorpej@wasabisystems.com&#62;.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
January 5, 2015</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

