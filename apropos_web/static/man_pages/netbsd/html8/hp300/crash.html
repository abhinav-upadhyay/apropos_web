<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../../style.css" type="text/css" media="all">
<title>
CRASH(8) (HP300)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
CRASH(8)</td>
<td class="head-vol" align="center">
System Manager's Manual (HP300)</td>
<td class="head-rtitle" align="right">
CRASH(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">crash</b> &#8212; <span class="desc">UNIX system failures</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> This section explains a bit about system crashes and (very briefly) how to analyze crash dumps.<p>
When the system crashes voluntarily it prints a message of the form<p>
<div style="margin-left: 5.00ex;" class="display">
panic: why i gave up the ghost</div>
<p>
on the console, takes a dump on a mass storage peripheral, and then invokes an automatic reboot procedure as described in <a class="link-man" href="../../8/reboot">reboot(8)</a>. Unless some unexpected inconsistency is encountered in the state of the file systems due to hardware or software failure, the system will then resume multi-user operations.<p>
The system has a large number of internal consistency checks; if one of these fails, then it will panic with a very short message indicating which one failed. In many instances, this will be the name of the routine which detected the error, or a two-word description of the inconsistency. A full understanding of most panic messages requires perusal of the source code for the system.<p>
The most common cause of system failures is hardware failure, which can reflect itself in different ways.  Here are the messages which are most likely, with some hints as to causes. Left unstated in all cases is the possibility that hardware or software error produced the message in some unexpected way.<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">iinit</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This cryptic panic message results from a failure to mount the root filesystem during the bootstrap process. Either the root filesystem has been corrupted, or the system is attempting to use the wrong device as root filesystem. Usually, an alternative copy of the system binary or an alternative root filesystem can be used to bring up the system to investigate.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">Can't exec /sbin/init</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This is not a panic message, as reboots are likely to be futile. Late in the bootstrap procedure, the system was unable to locate and execute the initialization process, <a class="link-man" href="../../8/init">init(8)</a>. The root filesystem is incorrect or has been corrupted, or the mode or type of <i class="file">/sbin/init</i> forbids execution.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">IO err in push</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">hard IO err in swap</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The system encountered an error trying to write to the paging device or an error in reading critical information from a disk drive. The offending disk should be fixed if it is broken or unreliable.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">realloccg: bad optim</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">ialloc: dup alloc</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">alloccgblk:cyl groups corrupted</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">ialloccg: map corrupted</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">free: freeing free block</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">free: freeing free frag</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">ifree: freeing free inode</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">alloccg: map corrupted</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
These panic messages are among those that may be produced when filesystem inconsistencies are detected. The problem generally results from a failure to repair damaged filesystems after a crash, hardware failures, or other condition that should not normally occur. A filesystem check will normally correct the problem.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">timeout table overflow</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This really shouldn't be a panic, but until the data structure involved is made to be extensible, running out of entries causes a crash. If this happens, make the timeout table bigger.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">trap type %d, code = %x, v = %x</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
An unexpected trap has occurred within the system; the trap types are:<table style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-col">
<col style="min-width: 4.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
0</td>
<td class="list-col" style="margin-top: 1.00em;">
bus error</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
1</td>
<td class="list-col" style="margin-top: 1.00em;">
address error</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
2</td>
<td class="list-col" style="margin-top: 1.00em;">
illegal instruction</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
3</td>
<td class="list-col" style="margin-top: 1.00em;">
divide by zero</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
4</td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="emph">chk</span> instruction</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
5</td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="emph">trapv</span> instruction</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
6</td>
<td class="list-col" style="margin-top: 1.00em;">
privileged instruction</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
7</td>
<td class="list-col" style="margin-top: 1.00em;">
trace trap</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
8</td>
<td class="list-col" style="margin-top: 1.00em;">
MMU fault</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
9</td>
<td class="list-col" style="margin-top: 1.00em;">
simulated software interrupt</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
10</td>
<td class="list-col" style="margin-top: 1.00em;">
format error</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
11</td>
<td class="list-col" style="margin-top: 1.00em;">
FP coprocessor fault</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
12</td>
<td class="list-col" style="margin-top: 1.00em;">
coprocessor fault</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
13</td>
<td class="list-col" style="margin-top: 1.00em;">
simulated AST</td>
</tr>
</tbody>
</table>
<p>
The favorite trap type in system crashes is trap type 8, indicating a wild reference. ``code'' (hex) is the concatenation of the MMU status register (see &lt;hp300/cpu.h&gt;) in the high 16 bits and the 68020 special status word (see the 68020 manual, page 6-17) in the low 16. ``v'' (hex) is the virtual address which caused the fault. Additionally, the kernel will dump about a screenful of semi-useful information. ``pid'' (decimal) is the process id of the process running at the time of the exception. Note that if we panic in an interrupt routine, this process may not be related to the panic. ``ps'' (hex) is the 68020 processor status register ``ps''. ``pc'' (hex) is the value of the program counter saved on the hardware exception frame. It may <span class="emph">not</span> be the PC of the instruction causing the fault. ``sfc'' and ``dfc'' (hex) are the 68020 source/destination function codes. They should always be one. ``p0'' and ``p1'' are the VAX-like region registers. They are of the form:<p>
<div style="margin-left: 5.00ex;" class="display">
&lt;length&gt; '@' &lt;kernel VA&gt;</div>
<p>
where both are in hex. Following these values are a dump of the processor registers (hex). Finally, is a dump of the stack (user/kernel) at the time of the offense.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">init died</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The system initialization process has exited.  This is bad news, as no new users will then be able to log in.  Rebooting is the only fix, so the system just does it right away.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="symb">out of mbufs: map full</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The network has exhausted its private page map for network buffers. This usually indicates that buffers are being lost, and rather than allow the system to slowly degrade, it reboots immediately. The map may be made larger if necessary.</dd>
</dl>
<p>
That completes the list of panic types you are likely to see.<p>
When the system crashes it writes (or at least attempts to write) an image of memory into the back end of the dump device, usually the same as the primary swap area.  After the system is rebooted, the program <a class="link-man" href="../../8/savecore">savecore(8)</a> runs and preserves a copy of this core image and the current system in a specified directory for later perusal.  See <a class="link-man" href="../../8/savecore">savecore(8)</a> for details.<p>
To analyze a dump you should begin by running <a class="link-man" href="../../1/adb">adb(1)</a> with the <b class="flag">&#45;k</b> flag on the system load image and core dump. If the core image is the result of a panic, the panic message is printed. Normally the command ``$c'' will provide a stack trace from the point of the crash and this will provide a clue as to what went wrong. For more details consult <span class="ref-title">Using ADB to Debug the UNIX Kernel.</span></div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../../1/adb">adb(1)</a>, <a class="link-man" href="../../8/reboot">reboot(8)</a><p>
<span class="ref"><span class="ref-title">MC68020 32-bit Microprocessor User's Manual</span>.</span><p>
<span class="ref"><span class="ref-title">Using ADB to Debug the UNIX Kernel</span>.</span><p>
<span class="ref"><span class="ref-title">4.3BSD for the HP300</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> A <b class="name">crash</b> man page appeared in Version&#160;6 AT&amp;T UNIX.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
January 12, 1994</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

