<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
POWERD(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
POWERD(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
POWERD(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">powerd</b> &#8212; <span class="desc">power management daemon for sysmon</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 6.00ex;">
<col>
<tbody>
<tr>
<td>
powerd</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;dn</b></span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">powerd</b> acts upon power management events posted by the kernel's power management facility. When events are posted, <b class="name">powerd</b> translates the event into a script name and a list of arguments. <b class="name">powerd</b> then runs the script in order to implement the power management policy defined by the system administrator.<p>
The following options are available:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;d</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Enable debugging mode. Verbose messages and all messages intended for <a class="link-man" href="../8/syslog">syslog(8)</a> will be sent to stderr, and <b class="name">powerd</b> will stay in the foreground of the controlling terminal.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;n</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Prevent execution of power management scripts.</dd>
</dl>
</div>
<div class="section">
<h1 id="x434f4e46494755524154494f4e2053435249505453">CONFIGURATION SCRIPTS</h1> All configuration of <b class="name">powerd</b> is encapsulated into scripts that are run when power management events occur. The daemon will look for the scripts from the directory <i class="file">/etc/powerd/scripts</i>.<p>
Configuration scripts are run synchronously; <b class="name">powerd</b> will start the script and wait for its completion before it handles the next event.<p>
Configuration scripts are called with different arguments, depending on the script class. These classes are described in the following sections.<div class="subsection">
<h2 id="x504f574552205357495443482053435249505453">POWER SWITCH SCRIPTS</h2> Power switch scripts are called when a state change event occurs on a power switch device. Power switch scripts are called with two arguments: the device with which the event is associated, and the event type.<p>
The following power switch script names are defined:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">power_button</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
This script is called when an event occurs on a power button device.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">reset_button</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
This script is called when an event occurs on a reset button device.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">sleep_button</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
This script is called when an event occurs on a sleep button device.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">lid_switch</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
This script is called when an event occurs on a lid switch device.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">acadapter</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
This script is called when an online or offline event occurs on an AC adapter device.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">hotkey_button</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
This script is called when an event occurs on a hotkey button device.</dd>
</dl>
<p>
The following events are defined for power switch devices:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">pressed</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The button was pressed, the lid was closed, or the AC adapter was connected.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">released</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The button was released, the lid was opened, or the AC adapter was disconnected. Note that power and sleep button devices usually do not post this type of event.</dd>
</dl>
<p>
The following is an example of how a power button script might be invoked when a power button is pressed by the operator:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
/etc/powerd/scripts/power_button acpibut0 pressed</pre>
</div>
<div class="subsection">
<h2 id="x454e565359532053435249505453">ENVSYS SCRIPTS</h2> <a class="link-man" href="../4/envsys">envsys(4)</a> scripts are called when a condition was triggered in a sensor. These scripts are called with three arguments: the device associated, the event type, and the sensor's name. The <span class="symb">sensor_drive</span> and the <span class="symb">sensor_battery</span> scripts uses a fourth argument: state description.<p>
The following envsys script names are defined:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">sensor_battery</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
This script is called when an event occurs on a battery sensor (Wh/Ah/Battery state).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">sensor_drive</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
This script is called when an event occurs on a drive sensor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">sensor_fan</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
This script is called when an event occurs on a fan sensor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">sensor_indicator</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
This script is called when an event ocurrs on a indicator/integer sensor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">sensor_power</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
This script is called when an event occurs on a power sensor (W/Ampere).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">sensor_resistance</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
This script is called when an event occurs on a resistance sensor (Ohm).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">sensor_temperature</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
This script is called when an event occurs on a temperature sensor.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">sensor_voltage</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
This script is called when an event occurs on a voltage sensor.</dd>
</dl>
<p>
The following events are defined for fan, indicator, power, resistance, temperature, and voltage sensors:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">critical</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
A critical condition was triggered.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">critical-under</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
A critical under condition was triggered.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">critical-over</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
A critical over condition was triggered.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">warning-under</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
A warning under condition was triggered.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">warning-over</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
A warning over condition was triggered.</dd>
</dl>
<p>
The following event is defined for all scripts, but it is only sent if any of the previous events has been previously sent:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">normal</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
A normal state/capacity/condition was triggered.</dd>
</dl>
<p>
The following events are defined only for battery sensors:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">user-capacity</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Capacity dropped below the limit set by the user.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">low-power</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
System is running in low power. This implies that the AC adapter is disconnected and all batteries are in critical or low capacity. The script shutdowns the system gracefully by default.</dd>
</dl>
<p>
The following events are defined for drive and battery sensors:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="emph">state-changed</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
The state of the sensor has been changed and it is not in the normal state.</dd>
</dl>
<p>
The following is an example of how a temperature sensor script might be invoked when a critical over condition is triggered:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
/etc/powerd/scripts/sensor_temperature lm0 critical-over "CPU Temp"</pre>
</div>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../4/acpi">acpi(4)</a>, <a class="link-man" href="../4/acpiacad">acpiacad(4)</a>, <a class="link-man" href="../4/acpibut">acpibut(4)</a>, <a class="link-man" href="../4/acpilid">acpilid(4)</a>, <a class="link-man" href="../4/envsys">envsys(4)</a>, <a class="link-man" href="../4/i386/apm">i386/apm(4)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> <b class="name">powerd</b> first appeared in <span class="unix">NetBSD&#160;2.0</span>. Support to handle <a class="link-man" href="../4/envsys">envsys(4)</a> events appeared in <span class="unix">NetBSD&#160;5.0</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <b class="name">powerd</b> was written by <span class="author">Jason R. Thorpe</span> &#60;thorpej@wasabisystems.com&#62; and contributed by Wasabi Systems, Inc. <span class="author">Juan Romero Pardines</span> added support to handle <a class="link-man" href="../4/envsys">envsys(4)</a> events.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Due to its synchronous nature <b class="name">powerd</b> cannot be trusted to handle events within a certain time.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 15, 2010</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

