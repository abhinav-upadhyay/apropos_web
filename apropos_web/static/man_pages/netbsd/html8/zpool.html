<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
zpool(1M)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
zpool(1M)</td>
<td class="head-vol" align="center">
System Administration Commands</td>
<td class="head-rtitle" align="right">
zpool(1M)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> zpool &#45; configures ZFS storage pools</div>
<div class="section">
<h1>SYNOPSIS</h1><br>
<b>zpool</b> [<b>-?</b>]<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool create</b> [<b>-fn</b>] [<b>-R</b> <i>root</i>] [<b>-m</b> <i>mountpoint</i>] <i>pool</i> <i>vdev ...</i><br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool destroy</b> [<b>-f</b>] <i>pool</i><br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool add</b> [<b>-fn</b>] <i>pool</i> <i>vdev</i><br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool remove</b> <i>pool</i> <i>vdev</i><br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool </b> <b>list</b> [<b>-H</b>] [<b>-o</b> <i>field</i>[,<i>field</i>]*] [<i>pool</i>] ...<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool iostat</b> [<b>-v</b>] [<i>pool</i>] ... [<i>interval</i> [<i>count</i>]]<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool status</b> [<b>-xv</b>] [<i>pool</i>] ...<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool offline</b> [<b>-t</b>] <i>pool</i> <i>device</i> ...<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool online</b> <i>pool</i> <i>device</i> ...<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool clear</b> <i>pool</i> [<i>device</i>] ...<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool attach</b> [<b>-f</b>] <i>pool</i> <i>device</i> <i>new_device</i><br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool detach</b> <i>pool</i> <i>device</i><br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool replace</b> [<b>-f</b>] <i>pool</i> <i>device</i> [<i>new_device</i>]<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool scrub</b> [<b>-s</b>] <i>pool</i> ...<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool export</b> [<b>-f</b>] <i>pool</i><br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool import</b> [<b>-d</b> <i>dir</i>] [<b>-D</b>]<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool import</b> [<b>-d</b> <i>dir</i>] [<b>-D</b>] [<b>-f</b>] [<b>-o </b><i>opts</i>] [<b>-R </b><i>root</i>] <i>pool</i> | <i>id</i> <br>
    [<i>newpool</i>]<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool import</b> [<b>-d</b> <i>dir</i>] [<b>-D</b>] [<b>-f</b>] [<b>-a</b>]<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool upgrade</b> <br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool upgrade</b> <b>-v</b><br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool upgrade</b> [<b>-a</b> | <i>pool</i>]<br>
<div style="height: 1.00em;">
&#160;</div>
<p>
<br>
<b>zpool history</b> [<i>pool</i>] ...<br>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>DESCRIPTION</h1> The  <b>zpool</b> command configures <b>ZFS</b> storage pools. A storage pool is a collection of devices that provides physical storage and data replication for <b>ZFS</b> datasets.<p>
All datasets within a storage pool share the same space. See <b>zfs</b>(1M) for information on managing datasets.<div class="subsection">
<h2>Virtual Devices (vdevs)</h2> A "virtual device" describes a single device or a collection of devices organized according to certain performance and fault characteristics. The following virtual devices are supported:<div style="height: 1.00em;">
&#160;</div>
<b>disk</b><div style="margin-left: 10.00ex;">
A block device, typically located under "/dev/dsk". <b>ZFS</b> can use individual slices or partitions, though the recommended mode of operation is to use whole disks. A disk can be specified by a full path, or it can be a shorthand name (the relative portion of the path under "/dev/dsk"). A whole disk can be specified by omitting the slice or partition designation. For example, "c0t0d0" is equivalent to "/dev/dsk/c0t0d0s2". When given a whole disk,  <b>ZFS</b> automatically labels the disk, if necessary.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b>file</b><div style="margin-left: 10.00ex;">
A regular file. The use of files as a backing store is strongly discouraged. It is designed primarily for experimental purposes, as the fault tolerance of a file is only as good as the file system of which it is a part. A file must be specified by a full path.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b>mirror</b><div style="margin-left: 10.00ex;">
A mirror of two or more devices. Data is replicated in an identical fashion across all components of a mirror. A mirror with <i>N</i> disks of size <i>X</i> can hold <i>X</i> bytes and can withstand (<i>N-1</i>) devices failing before data integrity is compromised.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b>raidz</b><div style="height: 0.00em;">
&#160;</div>
<b>raidz1</b><div style="height: 0.00em;">
&#160;</div>
<b>raidz2</b><div style="margin-left: 10.00ex;">
A variation on <b>RAID-5</b> that allows for better distribution of parity and eliminates the "<b>RAID-5</b> write hole" (in which data and parity become inconsistent after a power loss). Data and parity is striped across all disks within a <b>raidz</b> group.<div style="height: 1.00em;">
&#160;</div>
A <b>raidz</b> group can have either single- or double-parity, meaning that the <b>raidz</b> group can sustain one or two failures respectively without losing any data. The <b>raidz1</b> <b>vdev</b> type specifies a single-parity <b>raidz</b> group and the  <b>raidz2</b> <b>vdev</b> type specifies a double-parity <b>raidz</b> group. The <b>raidz</b> <b>vdev</b> type is an alias for <b>raidz1</b>.<div style="height: 1.00em;">
&#160;</div>
A <b>raidz</b> group with <i>N</i> disks of size <i>X</i> with <i>P</i> parity disks can hold approximately (<i>N-P</i>)*<i>X</i> bytes and can withstand one device failing before data integrity is compromised. The minimum number of devices in a  <b>raidz</b> group is one more than the number of parity disks. The recommended number is between 3 and 9.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b>spare</b><div style="margin-left: 10.00ex;">
A special pseudo-<b>vdev</b> which keeps track of available hot spares for a pool. For more information, see the "Hot Spares" section.</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
Virtual devices cannot be nested, so a mirror or <b>raidz</b> virtual device can only contain files or disks. Mirrors of mirrors (or other combinations) are not allowed.<p>
A pool can have any number of virtual devices at the top of the configuration (known as "root vdevs"). Data is dynamically distributed across all top-level devices to balance data among devices. As new virtual devices are added, <b>ZFS</b> automatically places data on the newly available devices.<p>
Virtual devices are specified one at a time on the command line, separated by whitespace. The keywords "mirror" and "raidz" are used to distinguish where a group ends and another begins. For example, the following creates two root vdevs, each a mirror of two disks:<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool create mypool mirror c0t0d0 c0t1d0 mirror c1t0d0 c1t1d0</b><br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>Device Failure and Recovery</h2>  <b>ZFS</b> supports a rich set of mechanisms for handling device failure and data corruption. All metadata and data is checksummed, and <b>ZFS</b> automatically repairs bad data from a good copy when corruption is detected.<p>
In order to take advantage of these features, a pool must make use of some form of redundancy, using either mirrored or <b>raidz</b> groups. While <b>ZFS</b> supports running in a non-redundant configuration, where each root vdev is simply a disk or file, this is strongly discouraged. A single case of bit corruption can render some or all of your data unavailable.<p>
A pool's health status is described by one of three states: online, degraded, or faulted. An online pool has all devices operating normally. A degraded pool is one in which one or more devices have failed, but the data is still available due to a redundant configuration. A faulted pool has one or more failed devices, and there is insufficient redundancy to replicate the missing data.</div>
<div class="subsection">
<h2>Hot Spares</h2>  <b>ZFS</b> allows devices to be associated with pools as "hot spares". These devices are not actively used in the pool, but when an active device fails, it is automatically replaced by a hot spare. To create a pool with hot spares, specify a "spare" <b>vdev</b> with any number of devices. For example,<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
# zpool create pool mirror c0d0 c1d0 spare c2d0 c3d0<br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
Spares can be shared across multiple pools, and can be added with the "zpool add" command and removed with the "zpool remove" command. Once a spare replacement is initiated, a new "spare" <b>vdev</b> is created within the configuration that will remain there until the original device is replaced. At this point, the hot spare becomes available again if another device fails.<p>
An in-progress spare replacement can be cancelled by detaching the hot spare. If the original faulted device is detached, then the hot spare assumes its place in the configuration, and is removed from the spare list of all active pools.</div>
<div class="subsection">
<h2>Alternate Root Pools</h2> The "zpool create -R" and "zpool import -R" commands allow users to create and import a pool with a different root path. By default, whenever a pool is created or imported on a system, it is permanently added so that it is available whenever the system boots. For removable media, or when in recovery situations, this may not always be desirable. An alternate root pool does not persist on the system. Instead, it exists only until exported or the system is rebooted, at which point it will have to be imported again.<p>
In addition, all mount points in the pool are prefixed with the given root, so a pool can be constrained to a particular area of the file system. This is most useful when importing unknown pools from removable media, as the mount points of any file systems cannot be trusted.<p>
When creating an alternate root pool, the default mount point is "/", rather than the normal default "/<i>pool</i>".</div>
<div class="subsection">
<h2>Subcommands</h2> All subcommands that modify state are logged persistently to the pool in their original form.<p>
The <b>zpool</b> command provides subcommands to create and destroy storage pools, add capacity to storage pools, and provide information about the storage pools. The following subcommands are supported:<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool</b> <b>-?</b><div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Displays a help message.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool create</b> [<b>-fn</b>] [<b>-R</b> <i>root</i>] [<b>-m</b> <i>mountpoint</i>] <i>pool</i> <i>vdev ...</i><div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Creates a new storage pool containing the virtual devices specified on the command line. The pool name must begin with a letter, and can only contain alphanumeric characters as well as underscore ("_"), dash ("-"), and period ("."). The pool names "mirror", "raidz", and "spare" are reserved, as are names beginning with the pattern "c[0-9]". The  <b>vdev</b> specification is described in the "Virtual Devices" section.<div style="height: 1.00em;">
&#160;</div>
The command verifies that each device specified is accessible and not currently in use by another subsystem. There are some uses, such as being currently mounted, or specified as the dedicated dump device, that prevents a device from ever being used by <b>ZFS</b>. Other uses, such as having a preexisting  <b>UFS</b> file system, can be overridden with the <b>-f</b> option.<div style="height: 1.00em;">
&#160;</div>
The command also checks that the replication strategy for the pool is consistent. An attempt to combine redundant and non-redundant storage in a single pool, or to mix disks and files, results in an error unless <b>-f</b> is specified. The use of differently sized devices within a single  <b>raidz</b> or mirror group is also flagged as an error unless <b>-f</b> is specified.<div style="height: 1.00em;">
&#160;</div>
Unless the <b>-R</b> option is specified, the default mount point is "/<i>pool</i>". The mount point must not exist or must be empty, or else the root dataset cannot be mounted. This can be overridden with the <b>-m</b> option.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-f</b><div style="margin-left: 17.00ex;">
Forces use of <b>vdev</b>s, even if they appear in use or specify a conflicting replication level. Not all devices can be overridden in this manner.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-n</b><div style="margin-left: 17.00ex;">
Displays the configuration that would be used without actually creating the pool. The actual pool creation can still fail due to insufficient privileges or device sharing.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-R</b> <i>root</i><div style="margin-left: 17.00ex;">
Creates the pool with an alternate <i>root</i>. See the "Alternate Root Pools" section. The root dataset has its mount point set to "/" as part of this operation.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-m</b> <i>mountpoint</i><div style="margin-left: 17.00ex;">
Sets the mount point for the root dataset. The default mount point is "/<i>pool</i>". The mount point must be an absolute path, "<b>legacy</b>", or "<b>none</b>". For more information on dataset mount points, see  <b>zfs</b>(1M).</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool destroy</b> [<b>-f</b>] <i>pool</i><div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Destroys the given pool, freeing up any devices for other use. This command tries to unmount any active datasets before destroying the pool.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-f</b><div style="margin-left: 6.00ex;">
Forces any active datasets contained within the pool to be unmounted.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool add</b> [<b>-fn</b>] <i>pool</i> <i>vdev ...</i><div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Adds the specified virtual devices to the given pool. The <i>vdev</i> specification is described in the "Virtual Devices" section. The behavior of the <b>-f</b> option, and the device checks performed are described in the "zpool create" subcommand.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-f</b><div style="margin-left: 6.00ex;">
Forces use of <b>vdev</b>s, even if they appear in use or specify a conflicting replication level. Not all devices can be overridden in this manner.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-n</b><div style="margin-left: 6.00ex;">
Displays the configuration that would be used without actually adding the <b>vdev</b>s. The actual pool creation can still fail due to insufficient privileges or device sharing.</div>
<div style="height: 1.00em;">
&#160;</div>
Do not add a disk that is currently configured as a quorum device to a zpool. Once a disk is in a zpool, that disk can then be configured as a quorum device.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool remove</b> <i>pool</i> <i>vdev</i><div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Removes the given <b>vdev</b> from the pool. This command currently only supports removing hot spares. Devices which are part of a mirror can be removed using the "zpool detach" command. <b>Raidz</b> and top-level <b>vdevs</b> cannot be removed from a pool.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool list</b> [<b>-H</b>] [<b>-o</b> <i>field</i>[,<i>field*</i>]] [<i>pool</i>] ...<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Lists the given pools along with a health status and space usage. When given no arguments, all pools in the system are listed.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-H</b><div style="margin-left: 12.00ex;">
Scripted mode. Do not display headers, and separate fields by a single tab instead of arbitrary space.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-o</b> <i>field</i><div style="margin-left: 12.00ex;">
Comma-separated list of fields to display. Each field must be one of:<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
name            Pool name<br>
size            Total size<br>
used            Amount of space used<br>
available       Amount of space available<br>
capacity        Percentage of pool space used<br>
health          Health status<br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
The default is all fields.</div>
<div style="height: 1.00em;">
&#160;</div>
This command reports actual physical space available to the storage pool. The physical space can be different from the total amount of space that any contained datasets can actually use. The amount of space used in a <b>raidz</b> configuration depends on the characteristics of the data being written. In addition,  <b>ZFS</b> reserves some space for internal accounting that the <b>zfs</b>(1M) command takes into account, but the <b>zpool</b> command does not. For non-full pools of a reasonable size, these effects should be invisible. For small pools, or pools that are close to being completely full, these discrepancies may become more noticeable.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool iostat</b> [<b>-v</b>] [<i>pool</i>] ... [<i>interval</i> [<i>count</i>]]<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Displays <b>I/O</b> statistics for the given pools. When given an interval, the statistics are printed every <i>interval</i> seconds until <b>Ctrl-C</b> is pressed. If no <i>pools</i> are specified, statistics for every pool in the system is shown. If  <i>count</i> is specified, the command exits after <i>count</i> reports are printed.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-v</b><div style="margin-left: 6.00ex;">
Verbose statistics. Reports usage statistics for individual <i>vdevs</i> within the pool, in addition to the pool-wide statistics.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool status</b> [<b>-xv</b>] [<i>pool</i>] ...<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Displays the detailed health status for the given pools. If no <i>pool</i> is specified, then the status of each pool in the system is displayed.<div style="height: 1.00em;">
&#160;</div>
If a scrub or resilver is in progress, this command reports the percentage done and the estimated time to completion. Both of these are only approximate, because the amount of data in the pool and the other workloads on the system can change.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-x</b><div style="margin-left: 6.00ex;">
Only display status for pools that are exhibiting errors or are otherwise unavailable.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-v</b><div style="margin-left: 6.00ex;">
Displays verbose data error information, printing out a complete list of all data errors since the last complete pool scrub.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool offline</b> [<b>-t</b>] <i>pool</i> <i>device</i> ...<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Takes the specified physical device offline. While the <i>device</i> is offline, no attempt is made to read or write to the device.<div style="height: 1.00em;">
&#160;</div>
This command is not applicable to spares.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-t</b><div style="margin-left: 6.00ex;">
Temporary. Upon reboot, the specified physical device reverts to its previous state.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool online</b> <i>pool</i> <i>device</i> ...<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Brings the specified physical device online.<div style="height: 1.00em;">
&#160;</div>
This command is not applicable to spares.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool clear</b> <i>pool</i> [<i>device</i>] ...<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Clears device errors in a pool. If no arguments are specified, all device errors within the pool are cleared. If one or more devices is specified, only those errors associated with the specified device or devices are cleared.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool attach</b> [<b>-f</b>] <i>pool</i> <i>device</i> <i>new_device</i><div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Attaches <i>new_device</i> to an existing <b>zpool</b> device. The existing device cannot be part of a <b>raidz</b> configuration. If <i>device</i> is not currently part of a mirrored configuration, <i>device</i> automatically transforms into a two-way mirror of  <i>device</i> and <i>new_device</i>. If <i>device</i> is part of a two-way mirror, attaching <i>new_device</i> creates a three-way mirror, and so on. In either case, <i>new_device</i> begins to resilver immediately.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-f</b><div style="margin-left: 6.00ex;">
Forces use of <i>new_device</i>, even if its appears to be in use. Not all devices can be overridden in this manner.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool detach</b> <i>pool</i> <i>device</i><div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Detaches <i>device</i> from a mirror. The operation is refused if there are no other valid replicas of the data.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool replace</b> [<b>-f</b>] <i>pool</i> <i>old_device</i> [<i>new_device</i>]<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Replaces <i>old_device</i> with <i>new_device</i>. This is equivalent to attaching <i>new_device</i>, waiting for it to resilver, and then detaching <i>old_device</i>.<div style="height: 1.00em;">
&#160;</div>
The size of <i>new_device</i> must be greater than or equal to the minimum size of all the devices in a mirror or <b>raidz</b> configuration.<div style="height: 1.00em;">
&#160;</div>
If <i>new_device</i> is not specified, it defaults to <i>old_device</i>. This form of replacement is useful after an existing disk has failed and has been physically replaced. In this case, the new disk may have the same <b>/dev/dsk</b> path as the old device, even though it is actually a different disk.  <b>ZFS</b> recognizes this.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-f</b><div style="margin-left: 6.00ex;">
Forces use of <i>new_device</i>, even if its appears to be in use. Not all devices can be overridden in this manner.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool scrub</b> [<b>-s</b>] <i>pool</i> ...<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Begins a scrub. The scrub examines all data in the specified pools to verify that it checksums correctly. For replicated (mirror or <b>raidz</b>) devices, <b>ZFS</b> automatically repairs any damage discovered during the scrub. The "<b>zpool</b>  <b>status</b>" command reports the progress of the scrub and summarizes the results of the scrub upon completion.<div style="height: 1.00em;">
&#160;</div>
Scrubbing and resilvering are very similar operations. The difference is that resilvering only examines data that <b>ZFS</b> knows to be out of date (for example, when attaching a new device to a mirror or replacing an existing device), whereas scrubbing examines all data to discover silent errors due to hardware faults or disk failure.<div style="height: 1.00em;">
&#160;</div>
Because scrubbing and resilvering are <b>I/O</b>-intensive operations, <b>ZFS</b> only allows one at a time. If a scrub is already in progress, the "<b>zpool scrub</b>" command terminates it and starts a new scrub. If a resilver is in progress, <b>ZFS</b> does not allow a scrub to be started until the resilver completes.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-s</b><div style="margin-left: 6.00ex;">
Stop scrubbing.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool export</b> [<b>-f</b>] <i>pool</i> ...<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Exports the given pools from the system. All devices are marked as exported, but are still considered in use by other subsystems. The devices can be moved between systems (even those of different endianness) and imported as long as a sufficient number of devices are present.<div style="height: 1.00em;">
&#160;</div>
Before exporting the pool, all datasets within the pool are unmounted.<div style="height: 1.00em;">
&#160;</div>
For pools to be portable, you must give the <b>zpool</b> command whole disks, not just slices, so that <b>ZFS</b> can label the disks with portable <b>EFI</b> labels. Otherwise, disk drivers on platforms of different endianness will not recognize the disks.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-f</b><div style="margin-left: 6.00ex;">
Forcefully unmount all datasets, using the "<b>unmount -f</b>" command.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool import</b> [<b>-d</b> <i>dir</i>] [<b>-D</b>]<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Lists pools available to import. If the <b>-d</b> option is not specified, this command searches for devices in "/dev/dsk". The <b>-d</b> option can be specified multiple times, and all directories are searched. If the device appears to be part of an exported pool, this command displays a summary of the pool with the name of the pool, a numeric identifier, as well as the  <i>vdev</i> layout and current health of the device for each device or file. Destroyed pools, pools that were previously destroyed with the "<b>-zpool destroy</b>" command, are not listed unless the <b>-D</b> option is specified.<div style="height: 1.00em;">
&#160;</div>
The numeric identifier is unique, and can be used instead of the pool name when multiple exported pools of the same name are available.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-d</b> <i>dir</i><div style="margin-left: 10.00ex;">
Searches for devices or files in <i>dir</i>. The <b>-d</b> option can be specified multiple times.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-D</b><div style="margin-left: 10.00ex;">
Lists destroyed pools only.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool import</b> [<b>-d</b> <i>dir</i>] [<b>-D</b>] [<b>-f</b>] [<b>-o</b> <i>opts</i>] [<b>-R</b> <i>root</i>] <i>pool</i> | <i>id</i> [<i>newpool</i>]<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Imports a specific pool. A pool can be identified by its name or the numeric identifier. If <i>newpool</i> is specified, the pool is imported using the name <i>newpool</i>. Otherwise, it is imported with the same name as its exported name.<div style="height: 1.00em;">
&#160;</div>
If a device is removed from a system without running "<b>zpool export</b>" first, the device appears as potentially active. It cannot be determined if this was a failed export, or whether the device is really in use from another host. To import a pool in this state, the  <b>-f</b> option is required.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-d</b> <i>dir</i><div style="margin-left: 11.00ex;">
Searches for devices or files in <i>dir</i>. The <b>-d</b> option can be specified multiple times.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-D</b><div style="margin-left: 11.00ex;">
Imports destroyed pool. The <b>-f</b> option is also required.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-f</b><div style="margin-left: 11.00ex;">
Forces import, even if the pool appears to be potentially active.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-o</b> <i>opts</i><div style="margin-left: 11.00ex;">
Comma-separated list of mount options to use when mounting datasets within the pool. See <b>zfs</b>(1M) for a description of dataset properties and mount options.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-R</b> <i>root</i><div style="margin-left: 11.00ex;">
Imports pool(s) with an alternate <i>root</i>. See the "Alternate Root Pools" section.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool import</b> [<b>-d</b> <i>dir</i>] [<b>-D</b>] [<b>-f</b>] [<b>-a</b>]<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Imports all pools found in the search directories. Identical to the previous command, except that all pools with a sufficient number of devices available are imported. Destroyed pools, pools that were previously destroyed with the "<b>-zpool destroy</b>" command, will not be imported unless the  <b>-D</b> option is specified.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-d</b> <i>dir</i><div style="margin-left: 10.00ex;">
Searches for devices or files in <i>dir</i>. The <b>-d</b> option can be specified multiple times.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-D</b><div style="margin-left: 10.00ex;">
Imports destroyed pools only. The <b>-f</b> option is also required.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-f</b><div style="margin-left: 10.00ex;">
Forces import, even if the pool appears to be potentially active.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool upgrade</b><div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Displays all pools formatted using a different <b>ZFS</b> on-disk version. Older versions can continue to be used, but some features may not be available. These pools can be upgraded using "<b>zpool upgrade -a</b>". Pools that are formatted with a more recent version are also displayed, although these pools will be inaccessible on the system.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool upgrade</b> <b>-v</b><div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Displays <b>ZFS</b> versions supported by the current software. The current <b>ZFS</b> versions and all previous supportedversions are displayed, along with an explanation of the features provided with each version.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool upgrade</b> [<b>-a</b> | <i>pool</i>]<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Upgrades the given pool to the latest on-disk version. Once this is done, the pool will no longer be accessible on systems running older versions of the software.<div style="height: 1.00em;">
&#160;</div>
<b></b><b>-a</b><div style="margin-left: 6.00ex;">
Upgrades all pools.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>zpool history</b> [<i>pool</i>] ...<div style="height: 0.60ex;">
&#160;</div>
<div style="margin-left: 4.00ex;">
Displays the command history of the specified pools (or all pools if no pool is specified).</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
</div>
<div class="section">
<h1>EXAMPLES</h1>  <b>Example 1 </b>Creating a RAID-Z Storage Pool<p>
The following command creates a pool with a single <b>raidz</b> root <i>vdev</i> that consists of six disks.<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool create tank raidz c0t0d0 c0t1d0 c0t2d0 c0t3d0 c0t4d0 c0t5d0</b><br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
<b>Example 2 </b>Creating a Mirrored Storage Pool<p>
The following command creates a pool with two mirrors, where each mirror contains two disks.<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool create tank mirror c0t0d0 c0t1d0 mirror c0t2d0 c0t3d0</b><br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
<b>Example 3 </b>Creating a ZFS Storage Pool by Using Slices<p>
The following command creates an unmirrored pool using two disk slices.<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool create tank /dev/dsk/c0t0d0s1 c0t1d0s4</b><br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
<b>Example 4 </b>Creating a ZFS Storage Pool by Using Files<p>
The following command creates an unmirrored pool using files. While not recommended, a pool based on files can be useful for experimental purposes.<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool create tank /path/to/file/a /path/to/file/b</b><br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
<b>Example 5 </b>Adding a Mirror to a ZFS Storage Pool<p>
The following command adds two mirrored disks to the pool "<i>tank</i>", assuming the pool is already made up of two-way mirrors. The additional space is immediately available to any datasets within the pool.<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool add tank mirror c1t0d0 c1t1d0</b><br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
<b>Example 6 </b>Listing Available ZFS Storage Pools<p>
The following command lists all available pools on the system. In this case, the pool <i>zion</i> is faulted due to a missing device.<div style="height: 1.00em;">
&#160;</div>
<p>
The results from this command are similar to the following:<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool list</b><br>
    NAME              SIZE    USED   AVAIL    CAP  HEALTH     ALTROOT<br>
    pool             67.5G   2.92M   67.5G     0%  ONLINE     -<br>
    tank             67.5G   2.92M   67.5G     0%  ONLINE     -<br>
    zion                 -       -       -     0%  FAULTED    -<br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
<b>Example 7 </b>Destroying a ZFS Storage Pool<p>
The following command destroys the pool "<i>tank</i>" and any datasets contained within.<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool destroy -f tank</b><br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
<b>Example 8 </b>Exporting a ZFS Storage Pool<p>
The following command exports the devices in pool <i>tank</i> so that they can be relocated or later imported.<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool export tank</b><br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
<b>Example 9 </b>Importing a ZFS Storage Pool<p>
The following command displays available pools, and then imports the pool "tank" for use on the system.<div style="height: 1.00em;">
&#160;</div>
<p>
The results from this command are similar to the following:<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool import</b><br>
 pool: tank<br>
   id: 15451357997522795478<br>
state: ONLINE<br>
action: The pool can be imported using its name or numeric identifier.<br>
config:<p>
<br>
       tank        ONLINE<br>
         mirror    ONLINE<br>
           c1t2d0  ONLINE<br>
           c1t3d0  ONLINE<p>
<br>
<b># zpool import tank</b><br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
<b>Example 10 </b>Upgrading All ZFS Storage Pools to the Current Version<p>
The following command upgrades all ZFS Storage pools to the current version of the software.<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool upgrade -a</b><br>
This system is currently running ZFS version 2.<br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
<b>Example 11 </b>Managing Hot Spares<p>
The following command creates a new pool with an available hot spare:<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool create tank mirror c0t0d0 c0t1d0 spare c0t2d0</b><br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
If one of the disks were to fail, the pool would be reduced to the degraded state. The failed device can be replaced using the following command:<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool replace tank c0t0d0 c0t3d0</b><br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<p>
Once the data has been resilvered, the spare is automatically removed and is made available should another device fails.  The hot spare can be permanently removed from the pool using the following command:<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<br>
<br>
<b># zpool remove tank c0t2d0</b><br>
<br>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>EXIT STATUS</h1> The following exit values are returned:<div style="height: 1.00em;">
&#160;</div>
<b></b><b>0</b><div style="margin-left: 5.00ex;">
Successful completion.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>1</b><div style="margin-left: 5.00ex;">
An error occurred.</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<b></b><b>2</b><div style="margin-left: 5.00ex;">
Invalid command line options were specified.</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>ATTRIBUTES</h1> See  <b>attributes</b>(5) for descriptions of the following attributes:<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>SEE ALSO</h1>  <b>zfs</b>(1M), <b>attributes</b>(5)</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
14 Nov 2006</td>
<td class="foot-os" align="right">
SunOS 5.11</td>
</tr>
</table>
</div>
</body>
<>

