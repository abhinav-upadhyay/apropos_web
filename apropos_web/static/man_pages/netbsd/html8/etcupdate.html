<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
ETCUPDATE(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
ETCUPDATE(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
ETCUPDATE(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">etcupdate</b> &#8212; <span class="desc">update the configuration and startup files in <i class="file">/etc</i></span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 9.00ex;">
<col>
<tbody>
<tr>
<td>
etcupdate</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;ahlv</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;d</b> <i class="arg">destdir</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;p</b> <i class="arg">pager</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;s</b> &#123;<i class="arg">srcdir</i> | <i class="arg">tgzdir</i> | <i class="arg">tgzfile</i>&#125;</span>&#93; &#91;<span class="opt"><b class="flag">&#45;t</b> <i class="arg">temproot</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;w</b> <i class="arg">width</i></span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">etcupdate</b> is a tool that lets the administrator update the configuration and startup files in <i class="file">/etc</i> (and some other directories like <i class="file">/dev</i>, <i class="file">/root</i> and <i class="file">/var</i>) without having to manually check and modify every file. The administrator should run this script after performing an operating system update (e.g. after running <i class="file">make build</i> in <i class="file">/usr/src</i> or after extracting new binary distribution files) to update to the latest configuration and startup files.<p>
<b class="name">etcupdate</b> compares the new configuration files against the currently installed files. The user is given the option of installing, merging or deleting each modified or missing file. The user can also view the differences between the files. By default, it shows the differences in the unified diff format. The default format can be toggled to show the differences in unified, context, or side by side formats or an user-defined command may be used to view differences. (And if <b class="name">wdiff</b> is installed, it can also show differences on a word by word basis.)<p>
<b class="name">etcupdate</b> also detects if the user installs certain special files and performs corresponding tasks like remaking device nodes or rebuilding a database from the <a class="link-man" href="../5/aliases">aliases(5)</a> file. Finally, <b class="name">etcupdate</b> runs <a class="link-man" href="../8/postinstall">postinstall(8)</a> to check the results.<p>
<b class="name">etcupdate</b> needs a clean set of new configuration files to compare the existing files against. These files, called the &#8220;reference files&#8221; in this manual, may be derived from either a source or binary distribution of <span class="unix">NetBSD</span>.<p>
If the user is updating from sources (which is the default mode), <b class="name">etcupdate</b> will first create a copy of the reference files by running <i class="file">make distribution</i> in <i class="file">/usr/src/etc</i>, installing the files to a so-called <i class="file">temproot</i>. (See usage of the <b class="flag">&#45;s</b> <i class="arg">srcdir</i> and <b class="flag">&#45;t</b> <i class="arg">temproot</i> options later in this manual page.) Although this is the default mode, it is not recommended (see the &#8220;BUGS&#8221; section).<p>
Instead of using sources, it is recommended that the user should extract one or more binary distribution sets in a special location and use those as the reference files (see usage of the <b class="flag">&#45;s</b> <i class="arg">tgzdir</i> option later in this manual page), or specify one or more binary distribution sets directly (see usage of the <b class="flag">&#45;s</b> <i class="arg">tgzfile</i> option later in this manual page).<p>
The following options are available:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;a</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
<b class="name">etcupdate</b> can automatically update files which have not been modified locally. The <b class="flag">&#45;a</b> flag instructs <b class="name">etcupdate</b> to store MD5 checksums in <i class="file">/var/etcupdate</i> and use these checksums to determine if there have been any local modifications.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;d</b> <i class="arg">destdir</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Use <i class="arg">destdir</i> instead of <i class="file">/</i> as the top of the file system hierarchy to be updated. For example, <i class="arg">destdir</i><i class="file">/etc</i> will be used instead of <i class="file">/etc</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;h</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Prints a help text.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;l</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Automatically skip files with unchanged RCS IDs. This has the effect of leaving alone files that have been altered locally but which have not been changed in the reference files. Since this works using RCS IDs, files without RCS IDs will not be skipped even if only modified locally. This flag may be used together with the <b class="flag">&#45;a</b> flag described above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;p</b> <i class="arg">pager</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The pager to use when displaying files. By default this is <a class="link-man" href="../1/more">more(1)</a> but it can be changed either with this option or by defining the <span class="env">PAGER</span> variable.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b> &#123;<i class="arg">srcdir</i> | <i class="arg">tgzdir</i> | <i class="arg">tgzfile</i>&#125;</dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The location of the reference files, or the <span class="unix">NetBSD</span> source files used to create the reference files. This may be specified in one of three ways:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b> <i class="arg">srcdir</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The top level directory of the <span class="unix">NetBSD</span> source tree. By default this is <i class="file">/usr/src</i> but it can be changed either with this option or the <span class="env">SRCDIR</span> variable. The reference files will be created by running &#8220;make distribution&#8221; in the <i class="arg">srcdir</i><i class="file">/etc</i> directory. Note that <i class="arg">srcdir</i> should refer to the top of the source directory tree; earlier versions of <b class="name">etcupdate</b> expected <i class="arg">srcdir</i> to refer to the <i class="file">etc</i> subdirectory within the source tree.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b> <i class="arg">tgzdir</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
A directory in which reference files have been extracted from a binary distribution of <span class="unix">NetBSD</span>. The files that are distributed in the &#8220;<i class="file">etc.tgz</i>&#8221; set file must be present. The files that are distributed in the &#8220;<i class="file">xetc.tgz</i>&#8221; set file are optional. The reference files from the specified directory will be copied to the <i class="file">temproot</i> directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b> <i class="arg">tgzfile</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The location of a set file (or &#8220;tgz file&#8221;) such as &#8220;<i class="file">etc.tgz</i>&#8221; or &#8220;<i class="file">xetc.tgz</i>&#8221; from a binary distribution of <span class="unix">NetBSD</span>. Each set file is a compressed archive containing reference files, which will be extracted to the <i class="file">temproot</i> directory. Multiple <b class="flag">&#45;s</b> options may be used to specify multiple set files. The &#8220;<i class="file">etc.tgz</i>&#8221; set file must be specified. The &#8220;<i class="file">xetc.tgz</i>&#8221; set file is optional.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;t</b> <i class="arg">temproot</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Specifies the location of the <i class="file">temproot</i> directory. This directory will be used for a temporary copy of the reference files created by running &#8220;make distribution&#8221; in the source directory specified by <b class="flag">&#45;s</b> <i class="arg">srcdir</i>, or a temporary copy of the reference files extracted from the binary sets specified by <b class="flag">&#45;s</b> <i class="arg">tgzfile</i>, or a temporary copy of the reference files from the directory specified by <b class="flag">&#45;s</b> <i class="arg">tempdir</i>. By default this is <i class="file">/tmp/temproot</i> but can be changed either with this option or the <span class="env">TEMPROOT</span> environment variable.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Makes <b class="name">etcupdate</b> verbose about its actions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;w</b> <i class="arg">width</i></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Sets screen width used during interactive merge. By default this is the number of columns <a class="link-man" href="../1/stty">stty(1)</a> reports but it can be changed either with this option or by defining the <span class="env">WIDTH</span> variable. This is useful for <a class="link-man" href="../1/xterm">xterm(1)</a> users with wider shell windows.</dd>
</dl>
</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">TEMPROOT</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Sets a default value for <i class="file">temproot</i>. See <b class="flag">&#45;t</b> above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">SRCDIR</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The location of the <span class="unix">NetBSD</span> sources files. See <b class="flag">&#45;s</b> above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">PAGER</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The pager to use when displaying files. See <b class="flag">&#45;p</b> above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">WIDTH</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The screen width used during interactive merge. See <b class="flag">&#45;w</b> above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">IGNOREFILES</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
A list of files that <b class="name">etcupdate</b> should ignore. Files listed in this variable will never be considered for updating by <b class="name">etcupdate</b>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1> The environment variables can also be defined in the following configuration files. The user's personal configuration file settings override the global settings.<p>
/etc/etcupdate.conf<p>
~/.etcupdaterc</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> You have just upgraded your <span class="unix">NetBSD</span> host from 3.0 to 4.0 and now it's time to update the configuration files as well. To update the configuration files from the sources (if you have the <i class="file">/usr/src/etc</i> directory):<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">etcupdate</code></div>
</blockquote>
<p>
The default location of the source files is <i class="file">/usr/src</i> but this may be overridden with the <b class="flag">&#45;s</b> <i class="arg">srcdir</i> command line argument:<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">etcupdate -s /some/where/src</code></div>
</blockquote>
<p>
To update the configuration files from binary distribution sets do something like this:<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">etcupdate -s /some/where/etc.tgz -s /some/where/xetc.tgz</code></div>
</blockquote>
<p>
or like this:<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">mkdir /tmp/temproot</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">cd /tmp/temproot</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">tar -xpzf /some/where/etc.tgz</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">tar -xpzf /some/where/xetc.tgz</code></div>
</blockquote>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">etcupdate -s /tmp/temproot</code></div>
</blockquote>
<p>
You have modified only few files in the <i class="file">/etc</i> directory so you would like install most of the updates without being asked. To automatically update the unmodified configuration files:<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">etcupdate -a</code></div>
</blockquote>
<p>
To get a better idea what's going on, use the <b class="flag">&#45;v</b> flag:<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">etcupdate -v</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/cmp">cmp(1)</a>, <a class="link-man" href="../1/more">more(1)</a>, <a class="link-man" href="../1/rcs">rcs(1)</a>, <a class="link-man" href="../1/sdiff">sdiff(1)</a>, <a class="link-man" href="../1/stty">stty(1)</a>, <a class="link-man" href="../5/aliases">aliases(5)</a>, <a class="link-man" href="../8/postinstall">postinstall(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">etcupdate</b> command appeared in <span class="unix">NetBSD&#160;1.6</span>.<p>
In <span class="unix">NetBSD&#160;4.0</span>, the <b class="flag">&#45;s</b> <i class="arg">tgzfile</i> option was added, the <b class="flag">&#45;b</b> <i class="arg">tempdir</i> option was converted to <b class="flag">&#45;s</b> <i class="arg">tgzdir</i>, and the <b class="flag">&#45;s</b> <i class="arg">srcdir</i> option was changed to refer to the top of the source directory tree rather than to the <i class="file">etc</i> subdirectory.<p>
In <span class="unix">NetBSD&#160;5.0</span>, the ability to specify multiple colon-separated files with a single <b class="flag">&#45;s</b> option was deprecated, and options deprecated in <span class="unix">NetBSD&#160;4.0</span> were removed.<p>
In <span class="unix">NetBSD&#160;7.0</span>, the ability to specify multiple colon-separated files with a single <b class="flag">&#45;s</b> option was removed (multiple <b class="flag">&#45;s</b> options must be used instead), and the <b class="flag">&#45;d</b> <i class="arg">destdir</i> option was added.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The script was written by <span class="author">Martti Kuparinen</span> &#60;martti@NetBSD.org&#62; and improved by several other <span class="unix">NetBSD</span> users.<p>
The idea for this script (including code fragments, variable names etc.) came from the <span class="unix">FreeBSD</span> mergemaster (by Douglas Barton). Unlike the <span class="unix">FreeBSD</span> mergemaster, this does not use CVS version tags by default to compare if the files need to be updated. Files are compared with <a class="link-man" href="../1/cmp">cmp(1)</a> as this is more reliable and the only way if the version numbers are the same even though the files are different.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> If a source directory is specified via the &#8220;<b class="flag">&#45;s</b> <i class="arg">srcdir</i>&#8221; option (or if the <i class="file">/usr/src</i> directory is used by default), then <b class="name">etcupdate</b> will run &#8220;make distribution&#8221; in the <i class="file">etc</i> subdirectory of the source directory, but it will not use the same options or environment variables that would be used during a full build of the operating system. For this reason, use of the &#8220;<b class="flag">&#45;s</b> <i class="arg">srcdir</i>&#8221; option is not recommended, and use of the &#8220;<b class="flag">&#45;s</b> <i class="arg">tgzdir</i>&#8221; or &#8220;<b class="flag">&#45;s</b> <i class="arg">tgzfile</i>&#8221; options is recommended.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
June 12, 2014</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

