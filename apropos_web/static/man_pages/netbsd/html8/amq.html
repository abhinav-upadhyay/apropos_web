<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
AMQ(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
AMQ(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
AMQ(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> amq &#45; automounter query tool</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>amq</b> [ <b>&#45;fimpqsvwHTU</b> ] [ <b>&#45;h</b><i> hostname</i> ] [ <b>&#45;l</b><i> log_file</i> ] [ <b>&#45;x</b><i> log_options</i> ] [ <b>&#45;D</b><i> debug_options</i> ] [ <b>&#45;P</b><i> program_number</i> ] [[ <b>&#45;u</b> ] <i>directory ...</i> ]</div>
<div class="section">
<h1>DESCRIPTION</h1> <b>Amq</b> provides a simple way of determining the current state of <b>amd</b> program. Communication is by <small>RPC.</small> Three modes of operation are supported by the current protocol.  By default a list of mount points and auto-mounted filesystems is output.  An alternative host can be specified using the <i>&#45;h</i> option.<p>
If <i>directory</i> names are given, as output by default, then per-filesystem information is displayed.</div>
<div class="section">
<h1>OPTIONS</h1><dl>
<dt>
<b>&#45;f</b></dt>
<dd>
Ask the automounter to flush the internal caches and reload all the maps.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;h</b><i> hostname</i></dt>
<dd>
Specify an alternate host to query.  By default the local host is used.  In an <small>HP-UX</small> cluster, the root server is queried by default, since that is the system on which the automounter is normally run.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;i</b></dt>
<dd>
Print information about the mount maps.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;l</b><i> log_file</i></dt>
<dd>
Tell amd to use <i>log_file</i> as the log file name.  For security reasons, this must be the same log file which amd used when started.  This option is therefore only useful to refresh amd's open file handle on the log file, so that it can be rotated and compressed via daily cron jobs.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;m</b></dt>
<dd>
Ask the automounter to provide a list of mounted filesystems, including the number of references to each filesystem and any error which occurred while mounting.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;p</b></dt>
<dd>
Return the process ID of the remote or locally running amd.  Useful when you need to send a signal to the local amd process, and would rather not have to search through the process table.  This option is used in the <i>ctl-amd</i> script.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;q</b></dt>
<dd>
Suppress error messages produced when attempting synchronous unmounts with the <b>&#45;u</b> option.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;s</b></dt>
<dd>
Ask the automounter to provide system-wide mount statistics.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;u</b></dt>
<dd>
Ask the automounter to unmount the filesystems named in <i>directory</i> instead of providing information about them.  Unmounts are requested, not forced.  They merely cause the mounted filesystem to timeout, which will be picked up by <b>amd</b>'s main scheduler thus causing the normal timeout action to be taken. If the <b>&#45;u</b> option is repeated, <b>amq</b> will attempt to unmount the file system synchronously by waiting until the timeout action is taken and returning an error if the unmount fails. Any error messages produced may be suppressed with the <b>&#45;q</b> option.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;v</b></dt>
<dd>
Ask the automounter for its version information.  This is a subset of the information output by <b>amd</b>'s <i>-v</i> option.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;w</b></dt>
<dd>
Translate a full pathname as returned by <i>getcwd</i>(3) into a short <b>Amd</b> pathname that goes through its mount points.   This option requires that <b>Amd</b> is running.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;x</b><i> log_options</i></dt>
<dd>
Ask the automounter to use the logging options specified in <i>log_options</i> from now on.  Note that the "fatal" and "error" options cannot be turned off.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;D</b><i> debug_options</i></dt>
<dd>
Ask the automounter to use the debugging options specified in <i>debug_options</i> from now on.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;H</b></dt>
<dd>
Display short usage message.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;P</b><i> program_number</i></dt>
<dd>
Contact an alternate running amd that had registered itself on a different RPC <i>program_number</i> and apply all other operations to that instance of the automounter.  This is useful when you run multiple copies of amd, and need to manage each one separately.  If not specified, amq will use the default program number for amd, 300019.  For security reasons, the only alternate program numbers amd can use range from 300019 to 300029, inclusive.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;T</b></dt>
<dd>
Contact <b>amd</b> using the TCP transport only.  Normally <b>amq</b> will try TCP, and if that failed, will try UDP.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
<dl>
<dt>
<b>&#45;U</b></dt>
<dd>
Contact <b>amd</b> using UDP (connectionless) transport only.  Normally <b>amq</b> will try TCP, and if that failed, will try UDP.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>FILES</h1><dl>
<dt>
<b>amq.x</b></dt>
<dd>
<small>RPC</small> protocol description.<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>CAVEATS</h1> <b>Amq</b> uses a Sun registered <small>RPC</small> program number (300019 decimal) which may not be in the /etc/rpc database.<p>
If the TCP wrappers library is available, and the <b>use_tcpwrappers</b> global <b>amd.conf</b> option is set to ``yes'', then <b>amd</b> will verify that the host running <b>amq</b> is authorized to connect.  The <i>amd</i> service name must used in the <b>/etc/hosts.allow</b> and <b>/etc/hosts.deny</b> files.  For example, to allow only localhost to connect to <b>amd,</b> add this line to <b>/etc/hosts.allow:</b><p>
<div style="margin-left: 5.00ex;">
amd: localhost</div>
<p>
and this line to <b>/etc/hosts.deny:</b><p>
<div style="margin-left: 5.00ex;">
amd: ALL</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>SEE ALSO</h1> <b>amd</b>(8), <b>amd.conf</b>(5), <b>hosts_access</b>(5).<p>
``am-utils'' <b>info</b>(1) entry.<p>
<i>Linux NFS and Automounter Administration</i> by Erez Zadok, ISBN 0-7821-2739-8, (Sybex, 2001).<p>
<i>http://www.am-utils.org</i><p>
<i>Amd &#45; The 4.4 BSD Automounter</i><div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>AUTHORS</h1> Jan-Simon Pendry &lt;jsp@doc.ic.ac.uk&gt;, Department of Computing, Imperial College, London, UK.<p>
Erez Zadok &lt;ezk@cs.sunysb.edu&gt;, Computer Science Department, Stony Brook University, Stony Brook, New York, USA.<p>
Other authors and contributors to am-utils are listed in the <b>AUTHORS</b> file distributed with am-utils.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
15 September 2011</td>
<td class="foot-os" align="right">
</td>
</tr>
</table>
</div>
</body>
</html>

