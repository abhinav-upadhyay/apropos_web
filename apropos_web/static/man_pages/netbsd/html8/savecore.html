<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
SAVECORE(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
SAVECORE(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
SAVECORE(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">savecore</b> &#8212; <span class="desc">save a core dump of the operating system</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 8.00ex;">
<col>
<tbody>
<tr>
<td>
savecore</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;fvz</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;N</b> <i class="arg">system</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;Z</b> <i class="arg">level</i></span>&#93; &#91;<span class="opt"><i class="arg">directory</i></span>&#93;</td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 8.00ex;">
<col>
<tbody>
<tr>
<td>
savecore</td>
<td>
<b class="flag">&#45;c</b> &#91;<span class="opt"><b class="flag">&#45;v</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;N</b> <i class="arg">system</i></span>&#93;</td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 8.00ex;">
<col>
<tbody>
<tr>
<td>
savecore</td>
<td>
<b class="flag">&#45;n</b> &#91;<span class="opt"><b class="flag">&#45;v</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;N</b> <i class="arg">system</i></span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> When the <span class="unix">NetBSD</span> kernel encounters a fatal error, the <a class="link-man" href="../9/panic">panic(9)</a> routine arranges for a snapshot of the contents of physical memory to be written into a dump area, typically in the swap partition.<p>
Upon a subsequent reboot, <b class="name">savecore</b> is typically run out of <a class="link-man" href="../8/rc">rc(8)</a>, before swapping is enabled, to copy the kernel and the saved memory image into <i class="farg">directory</i>, and enters a reboot message and information about the core dump into the system log. If a directory is not specified, then <i class="file">/var/crash</i> is used.<p>
The kernel and core file can then be analyzed using various tools, including <a class="link-man" href="../8/crash">crash(8)</a>, <a class="link-man" href="../8/dmesg">dmesg(8)</a>, <a class="link-man" href="../1/fstat">fstat(1)</a>, <a class="link-man" href="../1/gdb">gdb(1)</a>, <a class="link-man" href="../8/iostat">iostat(8)</a>, <a class="link-man" href="../1/netstat">netstat(1)</a>, <a class="link-man" href="../1/ps">ps(1)</a>, and <a class="link-man" href="../8/pstat">pstat(8)</a>, to attempt to deduce the cause of the crash.<p>
Crashes are usually the result of hardware faults or kernel bugs. If a kernel bug is suspected, a full bug report should be filed at <a class="link-ext" href="http://www.netbsd.org/">http://www.netbsd.org/</a>, or using <a class="link-man" href="../1/send-pr">send-pr(1)</a>, containing as much information as possible about the circumstances of the crash. Since crash dumps are typically very large and may contain whatever (potentially confidential) information was in memory at the time of the crash, do <span class="emph">NOT</span> include a copy of the crash dump file in the bug report; instead, save it somewhere in the event that a <span class="unix">NetBSD</span> developer wants to examine it.<p>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;c</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Only clears the dump without saving it, so that future invocations of <b class="name">savecore</b> will ignore it.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;f</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Forces a dump to be taken even if the dump doesn't appear correct or there is insufficient disk space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;n</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Check whether a dump is present without taking further action. The command exits with zero status if a dump is present, or with non-zero status otherwise.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;N</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Use <i class="arg">system</i> as the kernel instead of the default (returned by <a class="link-man" href="../3/getbootfile">getbootfile(3)</a>). Note that <a class="link-man" href="../3/getbootfile">getbootfile(3)</a> uses <a class="link-man" href="../3/secure_path">secure_path(3)</a> to check that kernel file is &#8220;secure&#8221; and will default to <i class="file">/netbsd</i> if the check fails.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Prints out some additional debugging information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;z</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Compresses the core dump and kernel (see <a class="link-man" href="../1/gzip">gzip(1)</a>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;Z</b> <i class="arg">level</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Set the compression level for <b class="flag">&#45;z</b> to <i class="arg">level</i>. Defaults to 1 (the fastest compression mode). Refer to <a class="link-man" href="../1/gzip">gzip(1)</a> for more information regarding the compression level.</dd>
</dl>
<p>
<b class="name">savecore</b> checks the core dump in various ways to make sure that it is current and that it corresponds to the currently running system. If it passes these checks, it saves the core image in <i class="arg">directory</i><i class="file">/netbsd.#.core</i> and the system in <i class="arg">directory</i><i class="file">/netbsd.#</i> (or in <i class="arg">directory</i><i class="file">/netbsd.#.core.gz</i> and <i class="arg">directory</i><i class="file">/netbsd.#.gz</i>, respectively, if the <b class="flag">&#45;z</b> option is used). The &#8220;#&#8221; is the number from the first line of the file <i class="arg">directory</i><i class="file">/bounds</i>, and it is incremented and stored back into the file each time <b class="name">savecore</b> successfully runs.<p>
<b class="name">savecore</b> also checks the available disk space before attempting to make the copies. If there is insufficient disk space in the file system containing <i class="arg">directory</i>, or if the file <i class="arg">directory</i><i class="file">/minfree</i> exists and the number of free kilobytes (for non-superusers) in the file system after the copies were made would be less than the number in the first line of this file, the copies are not attempted.<p>
If <b class="name">savecore</b> successfully copies the kernel and the core dump, the core dump is cleared so that future invocations of <b class="name">savecore</b> will ignore it.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/fstat">fstat(1)</a>, <a class="link-man" href="../1/gdb">gdb(1)</a>, <a class="link-man" href="../1/gzip">gzip(1)</a>, <a class="link-man" href="../1/netstat">netstat(1)</a>, <a class="link-man" href="../1/ps">ps(1)</a>, <a class="link-man" href="../1/send-pr">send-pr(1)</a>, <a class="link-man" href="../8/crash">crash(8)</a>, <a class="link-man" href="../8/dmesg">dmesg(8)</a>, <a class="link-man" href="../8/iostat">iostat(8)</a>, <a class="link-man" href="../8/pstat">pstat(8)</a>, <a class="link-man" href="../8/rc">rc(8)</a>, <a class="link-man" href="../8/syslogd">syslogd(8)</a>, <a class="link-man" href="../9/panic">panic(9)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">savecore</b> command appeared in <span class="unix">4.1BSD</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The minfree code does not consider the effect of compression.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
September 13, 2011</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

