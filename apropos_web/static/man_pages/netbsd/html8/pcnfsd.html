<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
RPC.PCNFSD(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
RPC.PCNFSD(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
RPC.PCNFSD(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> pcnfsd, rpc.pcnfsd &#45; (PC)NFS authentication and print request server</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>/usr/sbin/rpc.pcnfsd</b></div>
<div class="section">
<h1>DESCRIPTION</h1> <b>pcnfsd</b> is an <small>RPC</small> server that supports Sun ONC clients on PC (DOS, OS/2, Macintosh, and other) systems. This page describes version two of the <b>pcnfsd</b> server.<p>
<b>rpc.pcnfsd</b> may be started from <b>/etc/rc.local</b> or by the <b>inetd</b>(8) superdaemon. It reads the configuration file <b>/etc/pcnfsd.conf</b> if present, and then services RPC requests directed to program number 150001. This release of the <b>pcnfsd</b> daemon supports both version 1 and version 2 of the pcnfsd protocol. Consult the <b>rpcgen</b> source file <b>pcnfsd.x</b> for details of the protocols.<p>
The requests serviced by <b>pcnfsd</b> fall into three categories: authentication, printing, and other. Only the authentication and printing services have administrative significance.</div>
<div class="section">
<h1>AUTHENTICATION</h1> When <b>pcnfsd</b> receives a <b>PCNFSD_AUTH</b> or <b>PCNFSD2_AUTH</b> request, it will "log in" the user by validating the username and password and returning the corresponding uid, gids, home directory, and umask. If <b>pcnfsd</b> was built with the <b>WTMP</b> compile-time option, it will also append a record to the <b>wtmp</b>(5) data base. If you do not wish to record PC "logins" in this way, you should add a line of the form<div style="margin-left: 5.00ex;">
<div style="height: 1.00em;">
&#160;</div>
<b>wtmp off</b><div style="height: 1.00em;">
&#160;</div>
</div>
to the <b>/etc/pcnfsd.conf</b> file.</div>
<div class="section">
<h1>PRINTING</h1> <b>pcnfsd</b> supports a printing model based on the use of NFS to transfer the actual print data from the client to the server. The client system issues a <b>PCNFSD_PR_INIT</b> or <b>PCNFSD2_PR_INIT</b> request, and the server returns the path to a spool directory which the client may use and which is exported by NFS. <b>pcnfsd</b> creates a subdirectory for each of its clients: the parent directory is normally <b>/export/pcnfs</b> and the subdirectory is the hostname of the client system. If you wish to use a different parent directory, you should add a line of the form<div style="margin-left: 5.00ex;">
<div style="height: 1.00em;">
&#160;</div>
<b>spooldir</b> <i>path</i><div style="height: 1.00em;">
&#160;</div>
</div>
to the <b>/etc/pcnfsd.conf</b> file.<p>
Once a client has mounted the spool directory using NFS and has transferred print data to a file in this directory, it will issue a <b>PCNFSD_PR_START</b> or <b>PCNFSD2_PR_START</b> request. <b>pcnfsd</b> handles this, and most other print-related requests, by constructing a command based on the printing services of the server operating system and executing the command using the identity of the PC user. Since this involves set-user-id privileges, <b>pcnfsd</b> must be run as root.<p>
Every print request from the client includes the name of the printer which is to be used. In SunOS, this name corresponds to a printer definition in the <b>/etc/printcap</b>(5) database. If you wish to define a non-standard way of processing print data, you should define a new printer and arrange for the client to print to this printer. There are two ways of setting up a new printer. The first involves the addition of an entry to <b>/etc/printcap</b>(5) and the creation of filters to perform the required processing. This is outside the scope of this discussion. In addition, <b>pcnfsd</b> includes a mechanism by which  you can define virtual printers known only to <b>pcnfsd</b> clients. Each printer is defined by a line in the <b>/etc/pcnfsd.conf</b> file of the following form<div style="margin-left: 5.00ex;">
<div style="height: 1.00em;">
&#160;</div>
<b>printer</b> <i>name alias-for command</i><div style="height: 1.00em;">
&#160;</div>
</div>
<i>name</i> is the name of the printer you want to define. <i>alias-for</i> is the name of a "real" printer which corresponds to this printer. For example, a request to display the queue for  <i>name</i> will be translated into the corresponding request for the printer  <i>alias-for</i>. If you have defined a printer in such a way that there is no "real" printer to which it corresponds, use a single "-" for this field. (See the definition of the printer <b>test</b> below for an example.)  <i>command</i> is a command which will be executed whenever a file is printed on  <i>name</i>. This command is executed by the Bourne shell, <b>/bin/sh</b> using the <b>-c</b> option. For complex operations you should construct an executable shell program and invoke that in  <i>command</i>. Within  <i>command</i> the following tokens will be replaced:<dl>
<dt>
<b>Token</b></dt>
<dd>
<b>Substitution</b></dd>
</dl>
<dl>
<dt>
<small><b>$FILE</b></small></dt>
<dd>
Replaced by the full path name of the print data file. When the command has been executed, the file will be unlinked.</dd>
</dl>
<dl>
<dt>
<small><b>$USER</b></small></dt>
<dd>
Replaced by the username of the user logged in to the client system.</dd>
</dl>
<dl>
<dt>
<small><b>$HOST</b></small></dt>
<dd>
Replaced by the host name of the client system.</dd>
</dl>
<p>
Consider the following example <b>/etc/pcnfsd.conf</b> file:<div style="margin-left: 5.00ex;">
<div style="height: 1.00em;">
&#160;</div>
printer rotated lw /usr/local/bin/enscript -2r $FILE<div style="height: 0.00em;">
&#160;</div>
printer test - /usr/bin/cp $FILE /usr/tmp/$HOST-$USER<div style="height: 1.00em;">
&#160;</div>
</div>
If a client system prints a job on the printer <b>rotated</b> the utility <b>enscript</b> will be invoked to pre-process the file $FILE. In this case, the <b>-2r</b> option causes the file to be printed in two-column rotated format on the default PostScript&#174; printer. If the client requests a list of the print queue for the printer <b>rotated</b> the <b>pcnfsd</b> daemon will translate this into a request for a listing for the printer <b>lw.</b><p>
The printer <b>test</b> is used only for testing. Any file sent to this printer will be copied into <b>/usr/tmp.</b> Any request to list the queue, check the status, etc. of printer <b>test</b> will be rejected because the  <i>alias-for</i> has been specified as "-".</div>
<div class="section">
<h1>FILES</h1><dl>
<dt>
<b>/etc/pcnfsd.conf</b></dt>
<dd>
configuration file</dd>
</dl>
<dl>
<dt>
<b>/export/pcnfs</b></dt>
<dd>
default print spool directory</dd>
</dl>
</div>
<div class="section">
<h1>SEE ALSO</h1> <b>lpr</b>(1), <b>lpc</b>(8)</div>
<div class="section">
<h1>HISTORY</h1> The <b>pcnfsd</b> source code is distributed by Sun Microsystems, Inc. with their <small>PC/NFS</small> product under terms described in common.h in that source code. Those terms require that you be informed that this version of <b>pcnfsd</b> was modified to run on NetBSD and is NOT supported by Sun.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
25 April 1991</td>
<td class="foot-os" align="right">
</td>
</tr>
</table>
</div>
</body>
<>

