<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
APMD(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
APMD(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
APMD(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">apmd</b> &#8212; <span class="desc">Advanced Power Management monitor daemon</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 4.00ex;">
<col>
<tbody>
<tr>
<td>
apmd</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;adlqsv</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;f</b> <i class="arg">devname</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;m</b> <i class="arg">sockmode</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;o</b> <i class="arg">sockowner:sockgroup</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;S</b> <i class="arg">sockname</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;t</b> <i class="arg">rate</i></span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">apmd</b> daemon monitors the Advanced Power Management (APM) pseudo-device, acting on signaled events and upon user requests as sent by the <a class="link-man" href="../8/apm">apm(8)</a> utility. The <b class="name">apmd</b> daemon is only installed on supported platforms.<p>
<span class="emph">The</span> <b class="name">apmd</b> <span class="emph">is largely deprecated.</span> Modern systems supporting ACPI should rely on <a class="link-man" href="../4/acpi">acpi(4)</a>, <a class="link-man" href="../8/powerd">powerd(8)</a>, and the <a class="link-man" href="../4/envsys">envsys(4)</a> framework instead.<p>
For suspend and standby request events delivered by the BIOS, or via <a class="link-man" href="../8/apm">apm(8)</a>, <b class="name">apmd</b> runs the appropriate configuration program (if one exists), syncs the buffer cache to disk and initiates the requested mode. When resuming after suspend or standby, <b class="name">apmd</b> runs the appropriate configuration utility (if one exists). For power status change events, <b class="name">apmd</b> fetches the current status and reports it via <a class="link-man" href="../3/syslog">syslog(3)</a> with logging facility <span class="define">LOG_DAEMON</span>.<p>
<b class="name">apmd</b> announces the transition to standby mode with a single high tone on the speaker (using the <i class="file">/dev/speaker</i> device). Suspends are announced with two high tones.<p>
<b class="name">apmd</b> periodically polls the APM driver for the current power state. If the battery charge level changes substantially or the external power status changes, the new status is logged. The polling rate defaults to once per 10 minutes, but this may be altered by using the <b class="flag">&#45;t</b> command-line flag.<p>
<b class="name">apmd</b> supports the following options:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;a</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Any BIOS-initiated suspend or standby requests are ignored if the system is connected to line current and not running from batteries (user requests are still honored).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;d</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Enter debug mode, log to facility <span class="define">LOG_LOCAL1</span> and stay in the foreground on the controlling terminal.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;f</b> <i class="arg">devname</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Specify an alternate device file name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;l</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
A low-battery event causes a suspend request to occur.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;m</b> <i class="arg">sockmode</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Use <i class="arg">sockmode</i> instead of &#8216;0660&#8217; for the mode of <i class="file">/var/run/apmdev</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;o</b> <i class="arg">sockowner:sockgroup</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Use <i class="arg">sockowner:sockgroup</i> instead of &#8216;`0:0'&#8217; for the owner/group of <i class="file">/var/run/apmdev</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;q</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Do not announce suspend and standby requests on the speaker.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;S</b> <i class="arg">sockname</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Specify an alternate socket name (used by <a class="link-man" href="../8/apm">apm(8)</a> to communicate with <b class="name">apmd</b>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The current battery statistics are reported via <a class="link-man" href="../3/syslog">syslog(3)</a> and exit without monitoring the APM status.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;t</b> <i class="arg">rate</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Change the polling rate from 600 seconds to <i class="arg">rate</i> seconds.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Periodically log the power status via <a class="link-man" href="../3/syslog">syslog(3)</a>.</dd>
</dl>
<p>
When a client requests a suspend or stand-by mode, <b class="name">apmd</b> does not wait for positive confirmation that the requested mode has been entered before replying to the client; to do so would mean the client does not get a reply until the system resumes from its sleep state. Rather, <b class="name">apmd</b> replies with the intended state to the client and then places the system in the requested mode after running the configuration script and flushing the buffer cache.<p>
Actions can be configured for the five transitions: <b class="flag">suspend</b>, <b class="flag">standby</b>, <b class="flag">resume</b>, <b class="flag">line</b> or <b class="flag">battery</b>. The suspend and standby actions are run prior to <b class="name">apmd</b> performing any other actions (such as disk syncs) and entering the new mode. The resume program is run after resuming from a stand-by or suspended state.<p>
The line and battery actions are run after switching power sources to AC (line) or battery, respectively. The appropriate line or battery action is also run upon the startup of apmd based on the current power source.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/apm/suspend</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/apm/standby</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/apm/resume</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/apm/line</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/apm/battery</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
Contain the host's customized actions. Each file must be an executable binary or shell script suitable for execution by the <a class="link-man" href="../2/execve">execve(2)</a> function. If you wish to have the same program or script control all transitions, it may determine which transition is in progress by examining its <b class="var">argv[0]</b> which is set to one of <i class="arg">suspend</i>, <i class="arg">standby</i>, <i class="arg">resume</i>, <i class="arg">line</i> or <i class="arg">battery</i>. See <i class="file">/usr/share/examples/apm/script</i> for such an example script.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/run/apmdev</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
The default UNIX-domain socket used for communication with <a class="link-man" href="../8/apm">apm(8)</a>. The socket is protected by default to mode 0660, UID 0, GID 0.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/apmctl</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
The default device used to control the APM kernel driver.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/execve">execve(2)</a>, <a class="link-man" href="../3/syslog">syslog(3)</a>, <a class="link-man" href="../4/apm">apm(4)</a>, <a class="link-man" href="../4/speaker">speaker(4)</a>, <a class="link-man" href="../8/apm">apm(8)</a>, <a class="link-man" href="../8/syslogd">syslogd(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">apmd</b> daemon appeared in <span class="unix">NetBSD&#160;1.3</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
March 20, 2010</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

