<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
DHCPCD-RUN-HOOKS(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
DHCPCD-RUN-HOOKS(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
DHCPCD-RUN-HOOKS(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">dhcpcd-run-hooks</b> &#8212; <span class="desc">DHCP client configuration script</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">dhcpcd-run-hooks</b> is used by <a class="link-man" href="../8/dhcpcd">dhcpcd(8)</a> to run any system and user defined hook scripts. System hook scripts are found in <i class="file">/libexec/dhcpcd-hooks</i> and the user defined hooks are <i class="file">/etc/dhcpcd.enter-hook</i>. and <i class="file">/etc/dhcpcd.exit-hook</i>. The default install supplies hook scripts for configuring <i class="file">/etc/resolv.conf</i> and the hostname. Your distribution may have included other hook scripts to say configure ntp or ypbind. A test hook is also supplied that simply echos the dhcp variables to the console from DISCOVER message.<p>
Each time <b class="name">dhcpcd-run-hooks</b> is invoked, <span class="env">$interface</span> is set to the interface that <b class="name">dhcpcd</b> is run on and <span class="env">$reason</span> is to the reason why <b class="name">dhcpcd-run-hooks</b> was invoked. DHCP information to be configured is held in variables starting with the word new_ and old DHCP information to be removed is held in variables starting with the word old_. <b class="name">dhcpcd</b> can display the full list of variables it knows how about by using the <b class="flag">&#45;V</b>, <b class="flag">&#45;-variables</b> argument.<p>
Here's a list of reasons why <b class="name">dhcpcd-run-hooks</b> could be invoked:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">PREINIT</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd is starting up and any pre-initialisation should be done.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">CARRIER</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd has detected the carrier is up. This is generally just a notification and no action need be taken.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">NOCARRIER</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd lost the carrier. The cable may have been unplugged or association to the wireless point lost.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">INFORM</span> | <span class="define">INFORM6</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd informed a DHCP server about it's address and obtained other configuration details.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">BOUND</span> | <span class="define">BOUND6</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd obtained a new lease from a DHCP server.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">RENEW</span> | <span class="define">RENEW6</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd renewed it's lease.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">REBIND</span> | <span class="define">REBIND6</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd has rebound to a new DHCP server.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">REBOOT</span> | <span class="define">REBOOT6</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd successfully requested a lease from a DHCP server.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DELEGATED6</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd assigned a delegated prefix to the interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">IPV4LL</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd obtaind an IPV4LL address, or one was removed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">STATIC</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd has been configured with a static configuration which has not been obtained from a DHCP server.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">3RDPARTY</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd is monitoring the interface for a 3rd party to give it an IP address.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TIMEOUT</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd failed to contact any DHCP servers but was able to use an old lease.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">EXPIRE</span> | <span class="define">EXPIRE6</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd's lease or state expired and it failed to obtain a new one.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">NAK</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd received a NAK from the DHCP server. This should be treated as EXPIRE.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">RECONFIGURE</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd has been instructed to reconfigure an interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ROUTERADVERT</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd has received an IPv6 Router Advertisment, or one has expired.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">STOP</span> | <span class="define">STOP6</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd stopped running on the interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">STOPPED</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd has stopped entirely.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DEPARTED</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
The interface has been removed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">FAIL</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd failed to operate on the interface. This normally happens when dhcpcd does not support the raw interface, which means it cannot work as a DHCP or ZeroConf client. Static configuration and DHCP INFORM is still allowed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DUMP</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd has been asked to dump the last lease for the interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">TEST</span></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
dhcpcd received an OFFER from a DHCP server but will not configure the interface. This is primarily used to test the variables are filled correctly for the script to process them.</dd>
</dl>
</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1> <b class="name">dhcpcd</b> will clear the environment variables aside from <span class="env">$PATH</span> and <span class="env">$RC_SVCNAME</span>. The following variables will then be set, along with any protocol supplied ones.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$interface</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
the name of the interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$reason</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
as described above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$pid</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
the pid of <b class="name">dhcpcd</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$ifcarrier</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
the link status of <span class="env">$interface</span>: <span class="define">unknown</span>, <span class="define">up</span> or <span class="define">down</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$ifmetric</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
<span class="env">$interface</span> preference, lower is better.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$ifwireless</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
<span class="define">1 if</span> <span class="env">$interface</span> is wireless, otherwise <span class="define">0</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$ifflags</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
<span class="env">$interface</span> flags.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$ifmtu</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
<span class="env">$interface</span> MTU.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$ifssid</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
the name of the SSID the <span class="env">interface</span> is connected to.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$interface_order</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
A list of interfaces, in order of preference.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$if_up</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
<span class="define">true</span> if the <span class="env">interface</span> is up, otherwise <span class="define">false</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$if_down</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
<span class="define">true</span> if the <span class="env">interface</span> is down, otherwise <span class="define">false</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$af_waiting</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
Address family waiting for, as defined in <a class="link-man" href="../5/dhcpcd.conf">dhcpcd.conf(5)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$profile</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
the name of the profile selected from <a class="link-man" href="../5/dhcpcd.conf">dhcpcd.conf(5)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">$new_delegated_dhcp6_prefix</span></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
space separated list of delegated prefixes.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1> When <b class="name">dhcpcd-run-hooks</b> runs, it loads <i class="file">/etc/dhcpcd.enter-hook</i> and any scripts found in <i class="file">/libexec/dhcpcd-hooks</i> in a lexical order and then finally <i class="file">/etc/dhcpcd.exit-hook</i></div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../8/dhcpcd">dhcpcd(8)</a></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Roy Marples</span> &#60;<a class="link-mail" href="mailto:roy@marples.name">roy@marples.name</a>&#62;</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Please report them to <a class="link-ext" href="http://roy.marples.name/projects/dhcpcd">http://roy.marples.name/projects/dhcpcd</a></div>
<div class="section">
<h1 id="x534543555249545920434f4e53494445524154494f4e53">SECURITY CONSIDERATIONS</h1> <b class="name">dhcpcd</b> will validate the content of each option against its encoding. For string, ascii, raw or binhex encoding it's up to the user to validate it for the intended purpose.<p>
When used in a shell script, each variable must be quoted correctly.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
June 29, 2015</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

