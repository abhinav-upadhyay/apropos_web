<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
NEWFS_LFS(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
NEWFS_LFS(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
NEWFS_LFS(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">newfs_lfs</b> &#8212; <span class="desc">construct a new LFS file system</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 9.00ex;">
<col>
<tbody>
<tr>
<td>
newfs_lfs</td>
<td>
&#91;<span class="opt"><i class="arg">newfs_lfs-options</i></span>&#93; <i class="arg">special</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">newfs_lfs</b> builds a log-structured file system on the specified special device basing its defaults on the information in the disk label. Before running <b class="name">newfs_lfs</b> the disk must be labeled using <a class="link-man" href="../8/disklabel">disklabel(8)</a>, the proper fstype is 4.4LFS. Reasonable values for the <code class="lit">fsize</code>, <code class="lit">bsize</code>, and <code class="lit">sgs</code> fields are 1024, 8192, and 7 respectively.<p>
The following options define the general layout policies.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;A</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Attempt to compute the appropriate segment size using the formula <span class="emph">4 * bandwidth * access time</span>. The disk is tested for twenty seconds to discover its bandwidth and seek time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;B</b> <i class="arg">logical-segment-size</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The logical segment size of the file system in bytes. If not specified, the segment size is computed by left-shifting the partition label's block size by the amount indicated in the partition table's segshift. If the disklabel indicates a zero block size or segment shift, a compile-time default segment size of 1M is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;b</b> <i class="arg">block-size</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The block size of the file system in bytes. If not specified, the block size is taken from the partition label, or if the partition label indicates 0, a compile-time default of 8K is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;F</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Force creation of an LFS even on a partition labeled as another type. <b class="name">newfs_lfs</b> will use compile-time default values for block and fragment size, and segment shift, unless these are overridden by command-line flags.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;f</b> <i class="arg">fragment-size</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The fragment size of the file system in bytes. If not specified, the fragment size is taken from the partition label, or if the partition label indicates 0, a compile-time default of 1K is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;I</b> <i class="arg">interleave</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Specify the interleave between segments. The default is zero.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;i</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The size of an inode block, in bytes. The default is to use the same size as a fragment, or in a v1 filesystem, the same size as a data block.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;L</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Create a log-structured file system (LFS). This is the default, and this option is provided for compatibility only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;M</b> <i class="arg">nsegs</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Specify <span class="emph">lfs_minfreeseg</span>, the number of segments left out of the amount allocated to user data. A higher number increases cleaner performance, while a lower number gives more usable space. The default is based on the size of the filesystem, either 5% of the total number of segments or 20 segments, whichever is larger.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;m</b> <i class="arg">free space %</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The percentage of space reserved from normal users; the minimum free space threshold. The default value used is 10%.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;N</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Do not actually create the filesystem.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;O</b> <i class="arg">offset</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Start the first segment this many sectors from the beginning of the partition. The default is zero.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;R</b> <i class="arg">nsegs</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Specify <span class="emph">lfs_resvseg</span>, the number of segments set aside for the exclusive use of the cleaner. A larger figure reduces the likelihood of running out of clean segments, but if <span class="emph">lfs_resvseg</span> is too close to <span class="emph">lfs_minfreeseg</span>, the cleaner will run without ceasing when the filesystem becomes close to full. The default is the larger of 15 or the quantity <span class="emph">lfs_minfreeseg</span> / 2 + 1 .</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;r</b> <i class="arg">ident</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
For a v2 filesystem, specify the roll-forward identifier for the filesystem. This identifier, a 32-bit numeric quantity, should be different from that of any LFS that may previously have existed on the same disk. By default the identifier is chosen at random.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b> <i class="arg">size</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The size of the file system in sectors.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b> <i class="arg">version</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Make a filesystem with the specified disk layout version. Valid options are 1 or 2 (the default). <span class="emph">Note</span>, however, that LFS version 1 is deprecated.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../5/disktab">disktab(5)</a>, <a class="link-man" href="../8/disklabel">disklabel(8)</a>, <a class="link-man" href="../8/diskpart">diskpart(8)</a>, <a class="link-man" href="../8/dumplfs">dumplfs(8)</a><p>
<span class="ref"><span class="ref-auth">M. Seltzer</span>, <span class="ref-auth">K. Bostic</span>, <span class="ref-auth">M. McKusick</span>, and <span class="ref-auth">C. Staelin</span>, <span class="ref-title">An Implementation of a Log-Structured File System for UNIX</span>, <i class="ref-jrnl">Proceedings of the Winter 1993 USENIX Conference</i>, <span class="ref-page">pp. 315-331</span>, <span class="ref-date">January 25-29, 1993</span>.</span><p>
<span class="ref"><span class="ref-auth">J. Matthews</span>, <span class="ref-auth">D. Roselli</span>, <span class="ref-auth">A. Costello</span>, <span class="ref-auth">R. Wang</span>, and <span class="ref-auth">T. Anderson</span>, <span class="ref-title">Improving the Performance of Log-Structured File Systems with Adaptive Methods</span>, <i class="ref-jrnl">Proceedings of the Sixteenth ACM SOSP</i>, <span class="ref-date">October 1997</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> A <b class="cmd">newlfs</b> command appeared in <span class="unix">4.4BSD</span>, and was renamed to <b class="name">newfs_lfs</b> for <span class="unix">NetBSD&#160;1.4</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
July 12, 2001</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

