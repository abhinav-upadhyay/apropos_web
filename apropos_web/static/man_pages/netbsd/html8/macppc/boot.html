<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
BOOT(8) (MacPPC)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
BOOT(8)</td>
<td class="head-vol" align="center">
System Manager's Manual (MacPPC)</td>
<td class="head-rtitle" align="right">
BOOT(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">boot</b> &#8212; <span class="desc">Macppc system bootstrapping procedures</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1><div class="subsection">
<h2 id="x506f776572206661696c20616e64206372617368207265636f76657279">Power fail and crash recovery</h2> Normally, the system will reboot itself at power-up or after crashes. An automatic consistency check of the file systems will be performed as described in <a class="link-man" href="../../8/fsck">fsck(8)</a>, and unless this fails, the system will resume multi-user operations.</div>
<div class="subsection">
<h2 id="x436f6c6420737461727473">Cold starts</h2> The boot ROM performs a Power On Self Test (POST) then loads Open Firmware. Depending on the Open Firmware variable &#8216;<span class="env">auto-boot?</span>&#8217; it will either stop at the Open Firmware prompt or attempt to boot an operating system. Depending on the contents of the &#8216;<span class="env">use-nvramrc?</span>&#8217;, &#8216;<span class="env">boot-command</span>&#8217;, &#8216;<span class="env">boot-device</span>&#8217;, and &#8216;<span class="env">boot-file</span>&#8217; Open Firmware variables, it will attempt to boot MacOS, MacOS X, or <span class="unix">NetBSD</span>.<p>
To boot <span class="unix">NetBSD</span>, Open Firmware loads the bootloader <a class="link-man" href="../../8/ofwboot">ofwboot(8)</a> from the specified &#8216;<span class="env">boot-device</span>&#8217;. The bootloader then loads the kernel from the &#8216;<span class="env">boot-file</span>&#8217;, (if it exists). Otherwise, it tries to load (in the following order): <i class="file">netbsd</i>, <i class="file">netbsd.gz</i>, or <i class="file">netbsd.macppc</i> on the &#8220;a&#8221; partition of the same device that had the bootloader.</div>
<div class="subsection">
<h2 id="x4f70656e204669726d7761726520436f6d6d616e6473">Open Firmware Commands</h2> An essential but incomplete list of Open Firmware commands follows. A more thorough list is contained in the FAQ. <a class="link-ext" href="http://www.NetBSD.org/ports/macppc/faq#ofw-use">http://www.NetBSD.org/ports/macppc/faq#ofw-use</a><p>
<b class="cmd">boot</b> &#91;<span class="opt"><i class="arg">boot-device</i> &#91;<span class="opt"><i class="arg">boot-file</i></span>&#93;</span>&#93; &#91;<span class="opt"><i class="arg">options</i></span>&#93;<p>
Boot an operating system. The default arguments for this command are taken from the Open Firmware environment variables:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">boot-device</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
primary bootloader location</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">boot-file</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
kernel location</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">options</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
flags passed to the kernel</dd>
</dl>
<p>
<b class="cmd">reset-all</b><p>
Reset the system, and proceed as specified by the &#8216;<span class="env">use-nvramrc?</span>&#8217; and &#8216;<span class="env">auto-boot?</span>&#8217; variables. If &#8216;<span class="env">use-nvramrc?</span>&#8217; is set to &#8216;<span class="env">true</span>&#8217;, then the system will attempt to execute the commands stored in the &#8216;<span class="env">nvramrc</span>&#8217; variable. If &#8216;<span class="env">auto-boot?</span>&#8217; is set to &#8216;<span class="env">true</span>&#8217;, the system will attempt to use the values stored in &#8216;<span class="env">boot-command</span>&#8217;, &#8216;<span class="env">boot-device</span>&#8217;, and &#8216;<span class="env">boot-file</span>&#8217; to boot the system. If &#8216;<span class="env">auto-boot?</span>&#8217; is set to &#8216;<span class="env">false</span>&#8217;, the system will halt at the Open Firmware prompt.<p>
<b class="cmd">shut-down</b><p>
Power off the system.<p>
<b class="cmd">setenv</b> <i class="arg">variable</i> <i class="arg">value</i><p>
Set an Open Firmware variable, e.g.,<p>
<pre style="margin-left: 5.00ex;" class="lit display">
setenv auto-boot? false 
setenv boot-device hd:,&#92;ofwboot.xcf 
setenv boot-file netbsd-GENERIC.gz</pre>
<p>
<b class="cmd">set-default</b> <i class="arg">variable</i><p>
Set an Open Firmware variable to its default value.<p>
<b class="cmd">printenv</b> &#91;<span class="opt"><i class="arg">variable</i></span>&#93;<p>
Show Open Firmware variables and values.<p>
<b class="cmd">eject fd</b><p>
Eject floppy disk on systems with on-board floppy drives.<p>
<b class="cmd">mac-boot</b><p>
Attempt to boot MacOS on an Open Firmware 3 system.<p>
<b class="cmd">bye</b><p>
Attempt to boot MacOS on an Open Firmware 1.0.5, 2.0.x, or 2.4 system.</div>
<div class="subsection">
<h2 id="x4f70656e204669726d77617265205661726961626c6573">Open Firmware Variables</h2> An essential but incomplete list of Open Firmware variables follows. A more thorough list is contained in the FAQ. <a class="link-ext" href="http://www.NetBSD.org/ports/macppc/faq#ofw-variables">http://www.NetBSD.org/ports/macppc/faq#ofw-variables</a><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">auto-boot?</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
What Open Firmware will do at system startup or reset:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">true</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
automatically bootstrap an operating system using values from the &#8216;<span class="env">boot-command</span>&#8217;, &#8216;<span class="env">boot-device</span>&#8217;, and &#8216;<span class="env">boot-file</span>&#8217; variables.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">false</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
stop at the Open Firmware prompt.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">use-nvramrc?</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
If &#8216;<span class="env">true</span>&#8217; runs commands in variable &#8216;<span class="env">nvramrc</span>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">real-base</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Kernel memory location. <span class="emph">Do not modify this value on Open Firmware 3 systems &#8212; you may</span> <span class="emph">damage your computer</span>. All other Open Firmware versions should use <code class="lit">F00000</code>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">load-base</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Bootloader memory location. <span class="emph">Do not modify this value on Open Firmware 3 systems &#8212; you may</span> <span class="emph">damage your computer</span>. All other Open Firmware versions should use <code class="lit">600000</code>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">boot-command</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The command to use for booting. Typically, the default of &#8216;<span class="env">boot</span>&#8217; is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">boot-device</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Device from which to load primary bootloader. Value depends on a variety of factors. See <a class="link-man" href="../../8/ofwboot">ofwboot(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">boot-file</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Kernel location. Value depends on a variety of factors. See <a class="link-man" href="../../8/ofwboot">ofwboot(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">input-device</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
What type of console input device (ADB keyboard, USB keyboard, or serial port).<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">kbd</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
ADB keyboard on models with ADB, USB keyboard on models with USB, and built-in keyboard on laptops. This is the default on some Open Firmware 2.0.x machines and all Open Firmware 2.4 and 3 machines.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">ttya</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
&#8216;Modem&#8217; serial port on machines with serial ports. Properties are 38400 bps, 8 bits, no parity, 1 stop bit, no handshaking. This is the default on all Open Firmware 1.0.5 systems and some Open Firmware 2.0.x systems.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">ttyb</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
&#8216;Printer&#8217; serial port on machines with serial ports. Properties are the same as the &#8216;Modem&#8217; port.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">scca</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Serial port on Xserve models. Properties are 57600 bps, 8 bits, no parity, 1 stop bit, no handshaking.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
output-device</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
What type of console output device (On-board video, AGP video, PCI video, built-in LCD, or serial console). Value depends on a variety of factors. See <a class="link-man" href="../../8/ofwboot">ofwboot(8)</a> and <a class="link-ext" href="http://www.NetBSD.org/ports/macppc/faq#ofw-input-output-devices">http://www.NetBSD.org/ports/macppc/faq#ofw-input-output-devices</a></dd>
<dt class="list-tag" style="margin-top: 1.00em;">
nvramrc</dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
If &#8216;<span class="env">use-nvramrc?</span>&#8217; is set to true, these FORTH commands will be run when the computer is reset</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4e6f726d616c204f7065726174696f6e">Normal Operation</h2> When Open Firmware loads the primary bootloader, it will print something like the following:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
 loading XCOFF 
 tsize=CC50 dsize=14AC bsize=2668 entry=640000 
 SECTIONS: 
 .text    00640000 00640000 0000CC50 000000E0 
 .data    0064D000 0064D000 000014AC 0000CD30 
 .bss     0064E4B0 0064E4B0 00002668 00000000 
 loading .text, done.. 
 loading .data, done.. 
 clearing .bss, done..</pre>
<p>
When <a class="link-man" href="../../8/ofwboot">ofwboot(8)</a> is started, it prints something like the following:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
 &gt;&gt; NetBSD/macppc OpenFirmware Boot, Revision 1.7 
 &gt;&gt; (autobuild@tgm.daemon.org, Thu Feb  6 17:50:27 UTC 2003)</pre>
<p>
When <a class="link-man" href="../../8/ofwboot">ofwboot(8)</a> is loading the kernel, it prints something like the following:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
 4395364+254568 [220144+193803]=0x4d477c 
  start=0x100000</pre>
<p>
When the <span class="unix">NetBSD</span> kernel has started it prints a banner similar to the following:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
 Copyright (c) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003 
     The NetBSD Foundation, Inc.  All rights reserved. 
 Copyright (c) 1982, 1986, 1989, 1991, 1993 
     The Regents of the University of California.  All rights reserved. 
 
 NetBSD 1.6ZC (GENERIC) #0: Tue Sep 30 13:09:10 UTC 2003 
        autobuild@tgm.NetBSD.org:/autobuild/HEAD/macppc/OBJ/autobuild/HEAD/src/sys/arch/macppc/compile/GENERIC</pre>
</div>
<div class="subsection">
<h2 id="x416674657220626f6f747374726170">After bootstrap</h2> Once the <span class="unix">NetBSD</span>/macppc kernel is booted normally it initializes itself and proceeds to start the system. An automatic consistency check of the file systems takes place, and unless this fails, the system comes up to multi-user operation.<p>
The proper way to shut the system down is with the <a class="link-man" href="../../8/shutdown">shutdown(8)</a> command.<p>
If the system crashes, it will enter the kernel debugger, <a class="link-man" href="../../4/ddb">ddb(4)</a>, if it is configured in the kernel. If the crash occurred during initialization and the debugger is not present or is exited, the kernel will halt the system.<p>
If the crash occurred during normal operation and the debugger is not present or is exited, the system will attempt a dump to the configured dump device (which will be automatically recovered with <a class="link-man" href="../../8/savecore">savecore(8)</a> during the next bootstrap cycle), and after the dump is complete (successful or not) the kernel will attempt a reboot.</div>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/boot</i></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
<span class="unix">NetBSD</span> secondary bootstrap program (Open Firmware 1.x and 2.x)</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/netbsd</i></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
default <span class="unix">NetBSD</span> system kernel</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/usr/mdec/bootxx</i></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
<span class="unix">NetBSD</span> primary bootstrap program (Open Firmware 1.x and 2.x) a.k.a. &#8220;partition zero&#8221; bootloader</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/usr/mdec/ofwboot</i></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
<span class="unix">NetBSD</span> secondary bootstrap program (Open Firmware 1.x and 2.x)</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/usr/mdec/ofwboot.xcf</i></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
primary bootstrap for netboot and &#8220;cd9660&#8221; (ISO 9660), &#8220;MS-DOS&#8221;, &#8220;HFS&#8221;, and &#8220;HFS+&#8221; file systems.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../../4/ddb">ddb(4)</a>, <a class="link-man" href="../../4/intro">intro(4)</a>, <a class="link-man" href="../../8/diskless">diskless(8)</a>, <a class="link-man" href="../../8/halt">halt(8)</a>, <a class="link-man" href="../../8/init">init(8)</a>, <a class="link-man" href="../../8/installboot">installboot(8)</a>, <a class="link-man" href="../../8/ofwboot">ofwboot(8)</a>, <a class="link-man" href="../../8/rc">rc(8)</a>, <a class="link-man" href="../../8/reboot">reboot(8)</a>, <a class="link-man" href="../../8/savecore">savecore(8)</a>, <a class="link-man" href="../../8/shutdown">shutdown(8)</a><p>
<a class="link-ext" href="http://www.NetBSD.org/ports/macppc/faq">http://www.NetBSD.org/ports/macppc/faq</a><div style="height: 0.00em;">
&#160;</div>
<a class="link-ext" href="http://www.NetBSD.org/docs/network/netboot/">http://www.NetBSD.org/docs/network/netboot/</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> IEEE Std 1275-1994 (&#8220;Open Firmware&#8221;) <a class="link-ext" href="http://playground.sun.com/1275/home">http://playground.sun.com/1275/home</a></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The device names used by <span class="unix">NetBSD</span>/macppc and Open Firmware often have no relation to each other.<p>
Apple Computer's Open Firmware implementation is easily confused. It is best to reboot your computer after a failed boot attempt, <b class="cmd">halt</b>, or <b class="cmd">shutdown -h</b>. Use the Open Firmware <b class="cmd">reset-all</b> command.<p>
Apple Computer's Open Firmware implementation is notoriously bad. Thorough instructions for installing and booting <span class="unix">NetBSD</span> are in the install notes (<i class="file">INSTALL</i>) included with every release of <span class="unix">NetBSD</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
March 28, 2004</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

