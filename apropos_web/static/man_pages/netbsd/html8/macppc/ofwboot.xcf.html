<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
OFWBOOT(8) (MacPPC)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
OFWBOOT(8)</td>
<td class="head-vol" align="center">
System Manager's Manual (MacPPC)</td>
<td class="head-rtitle" align="right">
OFWBOOT(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">ofwboot</b>, <b class="name">ofwboot.elf</b>, <b class="name">ofwboot.xcf</b> &#8212; <span class="desc">Open Firmware boot command</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 7.00ex;">
<col>
<tbody>
<tr>
<td>
ofwboot</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> Open Firmware is a FORTH-like command interpreter started by the BootROM after the power-on self test (POST). This command interpreter allows the user flexibility in choosing how their machine boots an operating system. <span class="unix">NetBSD</span> uses Open Firmware to initialize many of the devices in a system and uses it to load the primary bootloader, <b class="name">ofwboot</b>.<p>
The information in this man page should only serve as a guideline for users. Apple has made many revisions to Open Firmware, and the earlier versions had many problems and inconsistencies. You may find that a boot command that works on one model will not work on another.<p>
In this man page, only one Open Firmware command will be described, <b class="cmd">boot</b>, because it is used to pass arguments to <b class="name">ofwboot</b>. The Open Firmware <b class="cmd">boot</b> command takes up to three arguments:<p>
<b class="cmd">boot</b> &#91;<span class="opt"><i class="arg">boot-device</i> &#91;<span class="opt"><i class="arg">boot-file</i></span>&#93;</span>&#93; &#91;<span class="opt"><i class="arg">options</i></span>&#93;<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">boot-device</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
primary bootloader location</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">boot-file</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
kernel location</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">options</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
flags passed to the kernel (see below)</dd>
</dl>
<div class="subsection">
<h2 id="x626f6f741e646576696365">boot-device</h2> The first argument, <i class="arg">boot-device</i>, actually designates the primary bootloader location and its name in the form:<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">boot-device:[partition-num],[bootloader-filename]</code></div>
</blockquote>
A typical example, from a PowerBook (FireWire), is<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">/pci@f2000000/mac-io@17/ata-4@1f000/@0:9,ofwboot.xcf</code></div>
</blockquote>
Note that colon (`:') delimits the device to the left, and comma (`,') separates the boot loader filename from the first part. For Open Firmware versions before 3, the primary bootloader is installed in partition &#8220;zero&#8221;, and it is not necessary to specify the bootloader-filename. For Open Firmware version 3, you must specify the bootloader-filename.<p>
Open Firmware stores aliases to common devices in NVRAM. In the example above, <i class="file">/pci@f2000000/mac-io@17/ata-4@1f000/@0</i> is the path on a PowerBook (FireWire) to the built-in ATA/100 hard drive. Use the <b class="cmd">devalias</b> command in Open Firmware to print out a list of common device names on a particular model. The command above could then be simplified to:<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">hd:9,ofwboot.xcf</code></div>
</blockquote>
<p>
<i class="arg">boot-loader-file-name</i> is usually <b class="name">ofwboot.xcf</b>. (See also the <i class="link-sec"><a class="link-sec" href="#x46494c4553">FILES</a></i> section for further discussion.)<p>
If omitted, the Open Firmware variable <b class="var">boot-device</b> is used.</div>
<div class="subsection">
<h2 id="x626f6f741e66696c65">boot-file</h2> It may be necessary to specify the <i class="arg">boot-file</i> if Open Firmware does not know where to find the kernel. The default is to load the file named <b class="name">netbsd</b> on partition &#8220;<i class="file">a</i>&#8221; from the device used to load the primary bootloader.<p>
For systems with Open Firmware versions less than 3 which are set up using <b class="cmd">sysinst</b>, the <i class="arg">boot-file</i> argument is not necessary. Systems with Open Firmware version 3 may need to specify the <i class="arg">boot-file</i>.<p>
The syntax is similar to the <i class="arg">boot-device</i> argument:<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">[boot-file-device:partition-num/][kernel-name]</code></div>
</blockquote>
This is a little different, since a kernel-name may be specified without listing a boot-file-device and partition-num. Additionally, a boot-file-device and partition-num may need to be specified, while using the default kernel-name.<p>
If no kernel-name is specified, the primary bootloader will try to find kernels named either <i class="arg">netbsd</i> or <i class="arg">netbsd.gz</i> on the boot-device or (if specified) boot-file-device.</div>
<div class="subsection">
<h2 id="x6f7074696f6e73">options</h2> Possible options are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;a</b></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
ask for the boot device</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;s</b></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
single-user mode boot</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;d</b></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
debug mode</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">exit</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
exit to Open Firmware after processing arguments</dd>
</dl>
</div>
</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1> If set, the following Open Firmware variables will be used to determine which <i class="arg">boot-device</i> and <i class="arg">boot-file</i> Open Firmware should use when booting a system. If the user specifies arguments on the command line, these values are overridden.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">boot-device</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
used as the first argument</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">boot-file</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
used as the second argument</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">auto-boot?</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
setting this variable to <i class="arg">false</i> will present the user with an Open Firmware command prompt after power-on reset. A value of <i class="arg">true</i> will automatically boot the system using the variables <b class="var">boot-device</b> and <b class="var">boot-file</b>. (This is not really related to the boot command, but is included for completeness.)</dd>
</dl>
To restore these variables to their default values, use the <b class="cmd">set-default</b> Open Firmware command: <b class="cmd">set-default</b> <i class="arg">boot-device</i></div>
<div class="section">
<h1 id="x46494c4553">FILES</h1> The three files <b class="name">ofwboot</b>, <b class="name">ofwboot.elf</b>, and <b class="name">ofwboot.xcf</b> are the same program, in different executable formats.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
ofwboot</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
<b class="name">ofwboot</b> is installed via <a class="link-man" href="../../8/installboot">installboot(8)</a> on systems with Open Firmware versions less than 3. It is not necessary to specify this file name, as it is stored in a special location on the disk, partition &#8220;zero&#8221;. For example, the following command might be used to boot from a SCSI device with ID 2: <b class="cmd">0 &gt;boot scsi-int/sd@2:0</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
ofwboot.xcf</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
<b class="name">ofwboot.xcf</b> is in XCOFF format. This file is used on all Open Firmware 3 systems, and on Open Firmware systems prior to 3 when the bootloader is not installed in partition &#8220;zero&#8221;, such as from an ISO-9660 format CD-ROM.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
ofwboot.elf</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
<b class="name">ofwboot.elf</b> is in <a class="link-man" href="../../5/elf">elf(5)</a> format and only functions on systems with Open Firmware version 3. To avoid confusion, all users should be using <b class="name">ofwboot.xcf</b>, as <b class="name">ofwboot.elf</b> offers no additional functionality. It is only included for historical reasons.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
boot.fs</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
This 1.44 MB disk image contains everything necessary to boot and install <span class="unix">NetBSD</span>. It includes the partition &#8220;zero&#8221; bootloader (<b class="name">ofwboot</b>), an INSTALL kernel (with limited device drivers), and the <b class="cmd">sysinst</b> utility in a RAM disk. Since Open Firmware does not care what media files are loaded from, only whether they are supported and in the correct format, this disk image may be placed on media other than floppy disks, such as hard drives or Zip disks. Use <a class="link-man" href="../../1/dd">dd(1)</a> on Unix, or <b class="cmd">DiskCopy</b> on MacOS 9.1 or later, or <b class="cmd">suntar</b> on any MacOS version to copy this image onto the media.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
netbsd</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
production kernel, using the GENERIC set of devices which supports almost all hardware available for this platform.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
netbsd_GENERIC_MD.gz</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
GENERIC kernel (the same as <i class="arg">netbsd</i>), with RAM disk and <b class="cmd">sysinst</b> included.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
NetBSD-{RELEASE}-macppc.iso</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
bootable CDROM image for all supported systems. Usually located at <i class="file">ftp://ftp.NetBSD.org/pub/NetBSD/images/{RELEASE}/NetBSD-{RELEASE}-macppc.iso</i></dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1><ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-item">
<li class="list-item" style="margin-top: 1.00em;">
Boot an Open Firmware 3 system, with <i class="arg">netbsd</i> installed on partition &#8220;<i class="file">a</i>&#8221;:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot hd:,ofwboot.xcf</pre>
</li>
<li class="list-item" style="margin-top: 1.00em;">
Boot into single user mode:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot hd:,ofwboot.xcf netbsd -s</pre>
</li>
<li class="list-item" style="margin-top: 1.00em;">
Boot from bootable CDROM with Open Firmware 3 or higher:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot cd:,&#92;ofwboot.xcf netbsd.macppc</pre>
</li>
<li class="list-item" style="margin-top: 1.00em;">
Boot from bootable CDROM (internal SCSI, id=3) of <span class="unix">NetBSD&#160;1.5</span> release with Open Firmware versions prior to 3:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot scsi/sd@3:0,OFWBOOT.XCF NETBSD.MACPPC</pre>
</li>
<li class="list-item" style="margin-top: 1.00em;">
Boot from floppy disk:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot fd:0</pre>
</li>
<li class="list-item" style="margin-top: 1.00em;">
Boot from network, with bootps, <a class="link-man" href="../../5/bootptab">bootptab(5)</a>, <a class="link-man" href="../../8/tftpd">tftpd(8)</a>, and <a class="link-man" href="../../8/nfsd">nfsd(8)</a> server available:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot enet:0</pre>
</li>
<li class="list-item" style="margin-top: 1.00em;">
Boot from network, but use internal root partition of second drive:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot enet:0 ultra1:0</pre>
</li>
<li class="list-item" style="margin-top: 1.00em;">
Boot MacOS, looking for the first available bootable disk:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot hd:,&#92;&#92;:tbxi</pre>
</li>
<li class="list-item" style="margin-top: 1.00em;">
Boot MacOS X residing on partition 10:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot hd:10,&#92;&#92;:tbxi</pre>
</li>
</ul>
</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1><pre style="margin-left: 0.00ex;" class="lit display">
DEFAULT CATCH!, code=FF00300 at %SRR0: FF80AD38 %SRR1: 00001070</pre>
Could be &#8220;device not found&#8221; or I/O errors on the device. The numbers are just for example.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
Can't LOAD from this device</pre>
Open Firmware found the device, but it is not supported by <b class="cmd">load</b>.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot yy:0/netbsd 
RESETing to change Configuration!</pre>
<i class="arg">yy:0</i> doesn't exist, so Open Firmware ignores the string and uses the default parameters to boot MacOS; the MacOS boot routine then clears some of the Open Firmware variables.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot ata/ata-disk@0:9 specified partition is not bootable 
 ok</pre>
As it says.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot ata/ata-disk@0:0 
&gt;&gt; NetBSD/macppc OpenFirmware Boot, Revision 1.3 
&gt;&gt; (root@nazuha, Fri Jun  8 22:21:55 JST 2001) 
no active package3337696/</pre>
and hangs: See the real-base part in the FAQ.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../../8/installboot">installboot(8)</a><p>
<i class="file">INSTALL</i><p>
<a class="link-ext" href="http://www.NetBSD.org/ports/macppc/faq">NetBSD/macppc Frequently Asked Questions</a><p>
<a class="link-ext" href="http://www.NetBSD.org/docs/network/netboot/">Diskless NetBSD HOW-TO</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> IEEE Std 1275-1994 (&#8220;Open Firmware&#8221;)</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> <b class="name">ofwboot</b> can only boot from devices recognized by Open Firmware.<p>
Early PowerMacintosh systems (particularly the 7500) seem to have problems with netbooting. Adding an arp entry at the tftp server with<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">arp -s booting-host-name its-ethernet-address</code></div>
</blockquote>
may resolve this problem (see <a class="link-man" href="../../8/arp">arp(8)</a>).<p>
<pre style="margin-left: 0.00ex;" class="lit display">
0 &gt; boot CLAIM failed 
 ok</pre>
Once boot failed, successive boots may not be possible. You need to type <b class="cmd">reset-all</b> or power-cycle to initialize Open Firmware.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
August 18, 2001</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

