<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../../style.css" type="text/css" media="all">
<title>
MBR(8) (x86)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
MBR(8)</td>
<td class="head-vol" align="center">
System Manager's Manual (x86)</td>
<td class="head-rtitle" align="right">
MBR(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">mbr</b>, <b class="name">bootselect</b> &#8212; <span class="desc">Master Boot Record bootcode</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> An IBM PC boots from a disk by loading its first sector and executing the code in it. For a hard disk, this first sector usually contains a table of partitions present on the disk. The first sector of a disk containing such a table is called the Master Boot Record (MBR).<p>
The code present in the MBR will typically examine the partition table, find the partition that is marked active, and boot from it. Booting from a partition simply means loading the first sector in that partition, and executing the code in it, as is done for the MBR itself.<p>
<span class="unix">NetBSD</span> supplies several versions of the MBR bootcode:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">Normal boot code</span> <i class="file">/usr/mdec/mbr</i></dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
This version has the same functionality as that supplied by DOS/Windows and other operating systems: it picks the active partition and boots from it. Its advantage over other, older MBRs, is that it can detect and use extensions to the BIOS interface that will allow it to boot partitions that cross or start beyond the 8 Gigabyte boundary.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">Bootselector</span> <i class="file">/usr/mdec/mbr_bootsel</i></dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
The bootselecting MBR contains configurable code that will present the user with a simple menu, allowing a choice between partitions to boot from, and hard disks to boot from. The choices and default settings can be configured through <a class="link-man" href="../../8/fdisk">fdisk(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">Extended Bootselector</span> <i class="file">/usr/mdec/mbr_ext</i></dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
The extended bootselecting MBR additionally allows <span class="unix">NetBSD</span> to be loaded from an Extended partition. It only supports systems whose BIOS supports the extensions to boot partitions beyond the 8 Gigabyte boundary.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">Serial Bootselector</span> <i class="file">/usr/mdec/mbr_com0</i></dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
This has the same features as <i class="file">mbr_ext</i> but will read and write from the first serial port. It assumes that the BIOS has initialized the baud rate.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">Serial Bootselector</span> <i class="file">/usr/mdec/mbr_com0_9600</i></dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
This has the same features as <i class="file">mbr_com0</i>. Additionally, it initializes the serial port to 9600 baud.</dd>
</dl>
<p>
The rest of this manual page will discuss the bootselecting versions of the MBR. The configurable items of the bootselector are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
timeout</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The number of seconds that the bootcode will wait for the user to press a key, selecting a menu item. Must be in the range 0-3600, or &#45;1 when it will wait forever.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
default</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The default partition or disk to boot from, should the timeout expire.</dd>
</dl>
<p>
The bootselector will output a menu of the <span class="emph">bootmenu</span> names for each partition (as configured by <a class="link-man" href="../../8/fdisk">fdisk(8)</a>). The user can then select the partition or drive to boot from via the keyboard.<p>
The numeric keys <span class="symb">1</span> upwards will initiate a startup from the corresponding partition.<p>
Function keys <span class="symb">F1</span> through <span class="symb">F8</span> (keys <span class="symb">a</span> through <span class="symb">h</span> for the serial versions) will boot from hard disks 0 through 7 (BIOS numbers 0x80 through 0x87). Booting from a drive is simply done by reading the MBR of that drive and executing it, so the bootcode present in the MBR of the chosen drive determines which partition (if any) will be booted in the end.<p>
The <span class="symb">Enter</span> key will cause the bootcode to find the active partition, and boot from it. If no key is pressed, the (configurable) default selection is picked.</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> The following error are detected:<table style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-col">
<col style="width: 4.00ex;">
<col style="min-width: 19.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="emph">Code</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="emph">Text message</span></td>
<td class="list-col" style="margin-top: 1.00em;">
<span class="emph">Explanation</span></td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
1</td>
<td class="list-col" style="margin-top: 1.00em;">
No active partition</td>
<td class="list-col" style="margin-top: 1.00em;">
The MBR has a partition table without an active partition.</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
2</td>
<td class="list-col" style="margin-top: 1.00em;">
Disk read error</td>
<td class="list-col" style="margin-top: 1.00em;">
There was an error reading the bootsector for the partition or drive selected.</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
3</td>
<td class="list-col" style="margin-top: 1.00em;">
No operating system</td>
<td class="list-col" style="margin-top: 1.00em;">
The bootsector was loaded successfully, but it was not valid (i.e., the magic number check failed, or it contained no code).</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
L</td>
<td class="list-col" style="margin-top: 1.00em;">
Invalid CHS read</td>
<td class="list-col" style="margin-top: 1.00em;">
The boot partition cannot be read using a CHS read and the system BIOS doesn't support LBA reads.</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
?</td>
<td class="list-col" style="margin-top: 1.00em;">
</td>
<td class="list-col" style="margin-top: 1.00em;">
Unknown key.</td>
</tr>
</tbody>
</table>
<p>
The standard boot code will output the text message and stop. It may be necessary to reset to the system to continue.<p>
The bootselect code will output 'Error &lt;code&gt;' and await further input.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../../8/boot">boot(8)</a>, <a class="link-man" href="../../8/disklabel">disklabel(8)</a>, <a class="link-man" href="../../8/fdisk">fdisk(8)</a>, <a class="link-man" href="../../8/installboot">installboot(8)</a>, <a class="link-man" href="../../8/mbrlabel">mbrlabel(8)</a></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The bootselect code has constraints because of the limited amount of space available. The only way to be absolutely sure that a bootselector will always fit on the disk when a partition table is used, is to make it small enough to fit into the first sector (512 bytes, 404 excluding the partition table and bootselect menu).<p>
The error messages are necessarily terse.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
January 20, 2008</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

