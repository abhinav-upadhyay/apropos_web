<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="..//static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
PXEBOOT(8) (x86)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
PXEBOOT(8)</td>
<td class="head-vol" align="center">
System Manager's Manual (x86)</td>
<td class="head-rtitle" align="right">
PXEBOOT(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">pxeboot</b> &#8212; <span class="desc">network boot NetBSD/x86 through a PXE BIOS extension</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">pxeboot</b> is a <span class="unix">NetBSD</span> boot program running on top of a PXE BIOS extension which is provided by the motherboard or a plug-in network adapter, in accordance with the Intel Preboot eXecution Environement (PXE) specification.<p>
By default, the <b class="name">pxeboot</b> program is configured with modules loading and <a class="link-man" href="../../5/boot.cfg">boot.cfg(5)</a> support disabled. See <i class="link-sec"><a class="link-sec" href="#x4558414d504c4553">EXAMPLES</a></i> for how to enable these options individually. This manual page assumes that <a class="link-man" href="../../5/boot.cfg">boot.cfg(5)</a> support is enabled.<p>
Network booting a system through PXE is a two-stage process:<ol style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-enum">
<li class="list-enum" style="margin-top: 1.00em;">
The PXE BIOS issues a DHCP request and fetches the <span class="unix">NetBSD</span> <b class="name">pxeboot</b> program using TFTP.</li>
<li class="list-enum" style="margin-top: 1.00em;">
The <span class="unix">NetBSD</span> <b class="name">pxeboot</b> program takes control. It immediately issues another DHCP request to get the name of a <a class="link-man" href="../../5/boot.cfg">boot.cfg(5)</a> file to load, using &#8220;boot.cfg&#8221; by default. If the boot config file is not found, or if the supplied file appears not to be a boot configuration file, the file is skipped. Otherwise it is loaded and obeyed as described in <a class="link-man" href="../../5/boot.cfg">boot.cfg(5)</a>. If a boot configuration is not loaded, the user has the option to enter a limited version of the standard interactive boot mode by pressing a key within five seconds. After this time, or after the user's <b class="cmd">boot</b> command, another DHCP request is issued and the kernel filename returned by the DHCP reply, using &#8220;netbsd&#8221; by default, is loaded. To read the kernel file, the NFS (version 2) or TFTP protocols can be used.</li>
</ol>
<p>
The DHCP request issued by the <span class="unix">NetBSD</span> <b class="name">pxeboot</b> program has the following special parameters:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
Bootfile name</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
is set to &#8220;boot.cfg&#8221; during the first request, and then to the <b class="var">filename</b> argument on the <b class="cmd">boot</b> command line typed in by the user (can be empty), using &#8220;netbsd&#8221; in the non-interactive case.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
DHCP Vendor class identifier tag</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
is set to &#8220;NetBSD:i386:libsa&#8221;.</dd>
</dl>
<p>
The DHCP server can use these fields (i.e. the DHCP vendor class identifier tag and the requested file name, possibly supplied by the user's command line input to the <b class="name">pxeboot</b> program) to distinguish between the various originators of requests (PXE BIOS, first and second <b class="name">pxeboot</b> stage, <span class="unix">NetBSD</span> kernel), and to alter its behaviour. For example, this can be used to support alternative <span class="unix">NetBSD</span> installations on one machine.<p>
In addition to the standard network interface configuration, the following fields in the DHCP reply are interpreted:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
Bootfile name</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
specifies the protocol to be used, and the filename of the boot config or <span class="unix">NetBSD</span> kernel to be booted, separated by a colon. Available protocols are &#8220;nfs&#8221; and &#8220;tftp&#8221;. The boot config or kernel filename part is interpreted relatively to the NFS root directory (see the <span class="emph">Root path</span> reply field below) or the TFTP server's root directory (which might be a subdirectory within the TFTP server's filesystem, depending on the implementation), respectively. If the <span class="emph">Bootfile name</span> field replied by the DHCP server does not contain a colon, it is ignored, and the <b class="var">filename</b> typed in at the <b class="name">pxeboot</b> command line prompt (or the &#8220;netbsd&#8221; default, see the section about the <span class="emph">Bootfile name</span> field in the DHCP request above) is used. If no protocol was specified, &#8220;nfs&#8221; is assumed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
Next server</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
is used as the location of the tftp server.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
Swap server</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
can be used to override the &#8220;server IP address&#8221; if NFS is used to access the kernel. This matches the behaviour of the <span class="unix">NetBSD</span> kernel to access its root file system on NFS. This way, different TFTP and NFS servers can be communicated to the DHCP client (it is actually a deficiency of the DHCP protocol to provide a &#8220;root path&#8221; field but no corresponding IP address).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
Root path</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
is used as path to be mounted in the NFS case to access the kernel file, matching the <span class="unix">NetBSD</span> kernel's behaviour.</dd>
</dl>
<p>
The commands accepted in interactive mode are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 4.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">boot</b> &#91;<span class="opt"><b class="var">device</b>:</span>&#93;&#91;<span class="opt"><b class="var">filename</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;1234abcdmqsvxz</b></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Boot <span class="unix">NetBSD</span>. See <b class="flag">boot</b> in <a class="link-man" href="../../8/boot">boot(8)</a> for full details.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">help</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Print an overview about commands and arguments.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">quit</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Leave the <b class="name">pxeboot</b> program.</dd>
</dl>
<p>
By default the output from <b class="name">pxeboot</b> and from the booted kernel will go to the system's BIOS console. This can be changed to be one of the serial ports by using <b class="name">installboot</b> to modify the boot options contained in the <i class="file">pxeboot_ia32.bin</i> file.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="file">/usr/mdec/pxeboot_ia32.bin</i></dt>
<dd class="list-tag" style="margin-left: 26.00ex;">
</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> To enable <a class="link-man" href="../../5/boot.cfg">boot.cfg(5)</a> support in the <b class="name">pxeboot</b> program:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
installboot -e -o bootconf pxeboot_ia32.bin</pre>
<p>
To enable modules loading support in the <b class="name">pxeboot</b> program:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
installboot -e -o modules pxeboot_ia32.bin</pre>
<p>
The first <i class="file">/etc/dhcpd.conf</i> example shows a simple configuration which just loads &#8220;boot.cfg&#8221; and &#8220;netbsd&#8221; from the client's NFS root directory, using the defaults for protocol and kernel filename. Similar setups should be possible with any BOOTP/DHCP server.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
host myhost { 
    hardware ethernet 00:00:00:00:00:00; 
    fixed-address myhost; 
    option host-name "myhost"; 
    filename "pxeboot_ia32.bin"; 
    option swap-server mynfsserver; 
    option root-path "/export/myhost"; 
}</pre>
<p>
The following <i class="file">/etc/dhcpd.conf</i> entry sets loads the boot config and kernel over tftp. This can be used, for example, for installing machines by using an install kernel.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
host myhost { 
    hardware ethernet 00:00:00:00:00:00; 
    fixed-address myhost; 
    option host-name "myhost"; 
    next-server mytftpserver; 
 
    # This section allows dhcpd to respond with different answers 
    # for the different tftp requests for the bootloader and kernel. 
    if substring (option vendor-class-identifier, 0, 20) 
      = "PXEClient:Arch:00000" { 
        filename "pxeboot_ia32.bin"; 
    } elsif substring (option vendor-class-identifier, 0, 17) 
      = "NetBSD:i386:libsa" { 
        if filename = "boot.cfg" { 
            filename "tftp:boot.cfg"; 
        } else if filename = "netbsd" { 
            filename "tftp:netbsd-INSTALL.gz"; 
        } 
    } 
}</pre>
<p>
The following <i class="file">/etc/dhcpd.conf</i> entry shows how different system installations can be booted depending on the user's input on the <b class="name">pxeboot</b> command line.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
host myhost { 
    hardware ethernet 00:00:00:00:00:00; 
    fixed-address myhost; 
    option host-name "myhost"; 
    next-server mytftpserver; 
    if substring (option vendor-class-identifier, 0, 9) = "PXEClient" { 
        filename "pxeboot_ia32.bin"; 
    } elsif filename = "boot.cfg" { 
        filename "tftp:boot.cfg"; 
    } elsif filename = "tftp" { 
        filename "tftp:netbsd.myhost"; 
    } else { 
        option swap-server mynfsserver; 
        option root-path "/export/myhost"; 
        if filename = "generic" { 
            filename "nfs:gennetbsd"; 
        } else { 
            filename "nfs:netbsd"; 
        } 
    } 
}</pre>
<p>
The TFTP server is supplied using the <span class="emph">next-server</span> directive. The NFS server for the root file system is <span class="emph">mynfsserver</span>. The <span class="emph">swap-server:root-path</span> is only used in the NFS case and by the <span class="unix">NetBSD</span> kernel to mount the root file system.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../../5/boot.cfg">boot.cfg(5)</a>, <a class="link-man" href="../../8/boot">boot(8)</a>, <a class="link-man" href="../../8/dhcpd">dhcpd(8)</a>, <a class="link-man" href="../../8/diskless">diskless(8)</a>, <a class="link-man" href="../../8/installboot">installboot(8)</a><p>
<span class="ref"><span class="ref-auth">Intel Corporation</span>, <span class="ref-title">Preboot Execution Environment (PXE) Specification</span>, <span class="ref-num">Version 2.1</span>, <span class="ref-date">September 20, 1999</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <span class="unix">NetBSD</span>/x86 <b class="name">pxeboot</b> command first appeared in <span class="unix">NetBSD&#160;1.6</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> If an error is encountered while reading the <span class="unix">NetBSD</span> kernel file or if its file format wasn't recognized, it is impossible to retry the operation because the PXE network stack is already removed from the system RAM.<p>
You need the <b class="name">pxeboot</b> from an i386 build to boot an i386 kernel, and that from an amd64 build to boot an amd64 kernel.<p>
In a Xen setup, the <span class="unix">NetBSD</span> DOM0 kernel is loaded as a module, and cannot know the device from which the Xen hypervisor was booted. In this case, the DOM0 kernel will fall back to the default boot device (typically the first disk on the host). If the boot device is different from the default one, consider passing additional arguments, like <i class="arg">bootdev</i>, to the DOM0 kernel as explained in the <b class="flag">load</b> command subsection in <a class="link-man" href="../../8/boot">boot(8)</a>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
August 16, 2014</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

