<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
DKCTL(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
DKCTL(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
DKCTL(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">dkctl</b> &#8212; <span class="desc">program to manipulate disks</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 5.00ex;">
<col>
<tbody>
<tr>
<td>
dkctl</td>
<td>
<i class="arg">device</i></td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 5.00ex;">
<col>
<tbody>
<tr>
<td>
dkctl</td>
<td>
<i class="arg">device</i> <i class="arg">command</i> &#91;<span class="opt"><i class="arg">arg</i> &#91;<span class="opt">...</span>&#93;</span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">dkctl</b> allows a user or system administrator to manipulate and configure disks in various ways. It is used by specifying a disk to manipulate, the command to perform, and any arguments the command may require. <i class="arg">device</i> is the disk (wdN, sdN, ...) containing the wedges unless noted otherwise. If <b class="name">dkctl</b> is called without any command, it displays strategy, cache, and all of the wedges of the specified device.</div>
<div class="section">
<h1 id="x434f4d4d414e4453">COMMANDS</h1> The following commands are supported:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">getcache</b></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Get and display the cache enables for the specified device.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">setcache</b> <i class="arg">none</i> | <i class="arg">r</i> | <i class="arg">w</i> | <i class="arg">rw</i> &#91;<span class="opt"><i class="arg">save</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Set the cache enables for the specified device. The enables are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
none</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disable all caches on the disk.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
r</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable the read cache, and disable all other caches on the disk.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
w</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable the write cache, and disable all other caches on the disk.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
rw</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable both the read and write caches on the disk.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
save</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If specified, and the cache enables are savable, saves the cache enables in the disk's non-volatile parameter storage.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">synccache</b> &#91;<span class="opt"><i class="arg">force</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Causes the cache on the disk to be synchronized, flushing all dirty write cache blocks to the media. If <i class="arg">force</i> is specified, the cache synchronization command will be issued even if the kernel does not believe that there are any dirty cache blocks in the disk's cache.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">keeplabel</b> &#91;<span class="opt"><i class="arg">yes</i> | <i class="arg">no</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Specify to keep or drop the in-core disklabel on the last close of the disk device. (Keep if <i class="arg">yes</i> is specified, drop if <i class="arg">no</i> is specified.)</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">badsector</b> <i class="arg">flush</i> | <i class="arg">list</i> | <i class="arg">retry</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Used for managing the kernel's bad sector list for <a class="link-man" href="../html4/wd.html">wd(4)</a> devices. The software bad sector list is only maintained if the option &#8220;WD_SOFTBADSECT&#8221; was specified on kernel configuration.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
flush</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Clears the in kernel list of bad sectors.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
list</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Prints out the list of bad sector ranges recorded by the kernel.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
retry</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Flushes the in kernel list and then retries all of the previously recorded bad sectors, causing the list to self update. This option <span class="emph">can only</span> be used with character devices.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">addwedge</b> <i class="arg">name</i> <i class="arg">startblk</i> <i class="arg">blkcnt</i> <i class="arg">ptype</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Define a &#8220;wedge&#8221; on the specified disk starting at block number <i class="arg">startblk</i> and spanning <i class="arg">blkcnt</i> blocks. You need to create the partition first with <a class="link-man" href="../html8/fdisk.html">fdisk(8)</a> or <a class="link-man" href="../html8/gpt.html">gpt(8)</a>, <b class="name">dkctl</b> will just name it. The wedge will have the volume name <i class="arg">name</i> and the partition type <i class="arg">ptype</i>. Valid choices for ptype would be <i class="arg">unused</i>, <i class="arg">swap</i>, <i class="arg">ffs</i>, <i class="arg">lfs</i>, <i class="arg">ext2fs</i>, <i class="arg">cd9660</i>, <i class="arg">ados</i>, <i class="arg">hfs</i>, <i class="arg">msdos</i>, <i class="arg">filecore</i>, <i class="arg">raidframe</i>, <i class="arg">ccd</i>, <i class="arg">appleufs</i>, <i class="arg">ntfs</i>, and <i class="arg">cgd</i>.<p>
The device name of the virtual block device assigned to the wedge will be displayed after the wedge has been successfully created. See <a class="link-man" href="../html4/dk.html">dk(4)</a> for more information about disk wedges.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">delwedge</b> <i class="arg">dk</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Delete the wedge specified by its device name <i class="arg">dk</i> from the specified disk.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">getwedgeinfo</b></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Display information about the specified disk wedge. <i class="arg">device</i> in this case is the wedge name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">listwedges</b></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
List all of the wedges configured on the specified disk.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">makewedges</b></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Delete all wedges configured on the specified disk, and autodiscover the wedges again. Wedges that are in use are not deleted and conflicting or overlapping wedges are not created. You need to list wedges to find out what has changed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="cmd">strategy</b> &#91;<span class="opt"><i class="arg">name</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Get and set the disk I/O scheduler (buffer queue strategy) on the drive. If you do not provide a <i class="arg">name</i> argument, the currently selected strategy will be shown. To set the bufq strategy, the <i class="arg">name</i> argument must be specified. <i class="arg">name</i> must be the name of one of the built-in kernel disk I/O schedulers. To get the list of supported schedulers, use the following command:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
$ sysctl kern.bufq.strategies</pre>
</dd>
</dl>
<p>
Note: The <b class="cmd">addwedge</b> and <b class="cmd">delwedge</b> commands only modify the in-kernel representation of disks; for modifying information on the disks themselves, refer to <a class="link-man" href="../html8/fdisk.html">fdisk(8)</a> or <a class="link-man" href="../html8/gpt.html">gpt(8)</a>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a>, <a class="link-man" href="../html4/dk.html">dk(4)</a>, <a class="link-man" href="../html4/sd.html">sd(4)</a>, <a class="link-man" href="../html4/wd.html">wd(4)</a>, <a class="link-man" href="../html5/disklabel.html">disklabel(5)</a>, <a class="link-man" href="../html8/atactl.html">atactl(8)</a>, <a class="link-man" href="../html8/fdisk.html">fdisk(8)</a>, <a class="link-man" href="../html8/gpt.html">gpt(8)</a>, <a class="link-man" href="../html8/scsictl.html">scsictl(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">dkctl</b> command first appeared in <span class="unix">NetBSD&#160;1.6</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="name">dkctl</b> command was written by <span class="author">Jason R. Thorpe</span> of Wasabi Systems, Inc.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
November 4, 2014</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

