<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
ISDND(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
ISDND(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
ISDND(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">isdnd</b> &#8212; <span class="desc">isdn4bsd ISDN connection management daemon</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 5.00ex;">
<col>
<tbody>
<tr>
<td>
isdnd</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;c</b> <i class="arg">configfile</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;d</b> <i class="arg">debuglevel</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;f</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;F</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;l</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;L</b> <i class="arg">logfile</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;P</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;r</b> <i class="arg">device</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;s</b> <i class="arg">facility</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;t</b> <i class="arg">terminaltype</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;u</b> <i class="arg">charging unit length</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;m</b></span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">isdnd</b> is the isdn4bsd package demon which manages all ISDN related connection and disconnection of ISDN devices supported by the package.<p>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;c</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use <i class="arg">configfile</i> as the name of the runtime configuration filename for <b class="name">isdnd</b> instead of the default file <i class="file">/etc/isdn/isdnd.rc</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If debugging support is compiled into <b class="name">isdnd</b> this option is used to specify the debugging level, or better which kind of debugging messages are displayed. The debugging level is the sum of the following values:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">0x001</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
general debugging.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">0x002</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
rates calculation.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">0x004</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
timing calculations.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">0x008</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
state transitions.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">0x010</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
retry handling.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">0x020</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
dialing.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">0x040</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
process handling.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">0x080</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
isdn4bsd kernel i/o calls.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">0x100</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
controller and channel busy/free messages.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">0x200</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
isdnd.rc configuration file processing.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">0x400</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
outgoing call budget handling.</dd>
</dl>
<p>
The value can be specified in any number base supported by the <a class="link-man" href="../3/sscanf">sscanf(3)</a> library routine.<p>
In addition, this option accepts also the character &#8216;n&#8217; as an argument to disable displaying debug messages on the full-screen display.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;f</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifying this option causes <b class="name">isdnd</b> to enter the full-screen mode of operation. When operating in this mode, entering the control character <span class="emph">Control-L</span> causes the display to be refreshed and entering <span class="emph">Carriage-Return</span> or <span class="emph">Enter</span> will pop-up a command window. Because the <b class="name">isdnd</b> daemon will not listen to messages while the command window is active, this command window will disappear automatically after 5 seconds without any command key press.<p>
While the command window is active, <span class="emph">Tab</span> or <span class="emph">Space</span> advances to the next menu item. To execute a command, press <span class="emph">Return</span> or <span class="emph">Enter</span> for the highlighted menu item, or enter the number corresponding to the item to be executed or enter the capitalized character in the menu item description.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;l</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If this option is set, logging is not done via the <a class="link-man" href="../8/syslogd">syslogd(8)</a> facility but instead is appended to a file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;L</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the name of the logfile which is used when the option <b class="flag">&#45;l</b> is set. See also the keyword <span class="emph">rotatesuffix</span> in the system section of <a class="link-man" href="../5/isdnd.rc">isdnd.rc(5)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;P</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option prints out the parsed and verified isdnd configuration in the same format as the isdnd.rc file. This output can be used as an isdnd.rc file. This feature is especially useful when debugging an isdnd.rc file to see what the default settings of options are when they are not set in the isdnd.rc input file.<p>
The <b class="name">isdnd</b> exits after the printout is done.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;F</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option prevents <b class="name">isdnd</b> to detach from the controlling tty and become a daemon.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;r</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
In conjunction with the <b class="flag">&#45;t</b> option, <i class="arg">device</i> specifies a terminal device which becomes the controlling tty for <b class="name">isdnd</b> and on which the full-screen mode output is displayed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option may be used to specify the logging facility in case <a class="link-man" href="../3/syslog">syslog(3)</a> logging is configured and another facility than the default LOCAL0 facility shall be used. The facility is to be specified as an integer in the range 0-11 or 16-23 (see the file <i class="file">/usr/include/syslog.h</i>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;t</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
In conjunction with the <b class="flag">&#45;f</b> and <b class="flag">&#45;r</b> options, <i class="arg">terminaltype</i> specifies a terminal type or terminfo entry name (such as vt220) for the device used for <b class="name">isdnd</b> full-screen output. This is useful if an unused (no getty running) tty line is used for full-screen output for which no <code class="lit">TERM</code> environment variable exists.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;u</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the length of a charging unit in case the config file entry keyword <span class="emph">unitlengthsrc</span> is set to <span class="emph">cmdl</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;m</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If the ISDN daemon is compiled with local or remote monitoring support, this option disables all monitoring access. It overrides the config file option <span class="emph">monitor-allowed</span>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x494e544552414354494f4e205749544820544845204b45524e454c">INTERACTION WITH THE KERNEL</h1> <b class="name">isdnd</b> communicates with the kernel part of isdn4bsd by receiving status and event messages (via <a class="link-man" href="../2/read">read(2)</a> from device <i class="file">/dev/isdn</i>) and by transmitting commands and responses (via <a class="link-man" href="../2/ioctl">ioctl(2)</a> on device <i class="file">/dev/isdn</i>).<p>
The messages and message parameters are documented in the include file <span class="emph">/usr/include/machine/i4b_ioctl.h</span>.<p>
Supported command and response messages (ioctl's) to the kernel are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">I4B_CDID_REQ</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Request a unique Call Description IDentifier (cdid) which identifies uniquely a single interaction of the local D channel with the exchange.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">I4B_CONNECT_REQ</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Actively request a call setup to a remote ISDN subscriber.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">I4B_CONNECT_RESP</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Respond to an incoming call, either accept, reject or ignore it.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">I4B_DISCONNECT_REQ</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Actively terminate a connection.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">I4B_CTRL_INFO_REQ</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Request information about an installed ISDN controller card.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">I4B_DIALOUT_RESP</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Give information about call setup to driver who requested dialing out.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">I4B_TIMEOUT_UPD</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Update the kernels timeout value(s) in case of dynamically calculated shorthold mode timing changes.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">I4B_UPDOWN_IND</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Inform the kernel userland drivers about interface soft up/down status changes.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">I4B_CTRL_DOWNLOAD</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Download firmware to active card(s).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">I4B_ACTIVE_DIAGNOSTIC</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Return diagnostic information from active cards.</dd>
</dl>
<p>
Supported status and event messages from the kernel are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">MSG_CONNECT_IND</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
An incoming call from a remote ISDN user is indicated.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">MSG_CONNECT_ACTIVE_IND</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
After an incoming call has been accepted locally or an outgoing call has been accepted by a remote, the exchange signaled an active connection and the corresponding B-channel is switched through.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">MSG_DISCONNECT_IND</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A call was terminated.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">MSG_DIALOUT_IND</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A userland interface driver requests the daemon to dial out (typically a network interface when a packet arrives in its send queue).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">MSG_IDLE_TIMEOUT_IND</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A call was terminated by the isdn4bsd kernel driver because a B-channel idle timeout occurred.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">MSG_ACCT_IND</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Accounting information from a network driver.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">MSG_CHARGING_IND</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Charging information from the kernel.</dd>
</dl>
<div class="subsection">
<h2 id="x4f5554474f494e472043414c4c53">OUTGOING CALLS</h2> Currently the only possibility to trigger an outgoing call is that an isdn4bsd network driver (<span class="emph">isdn&lt;n&gt;</span>) sends a <span class="emph">MSG_DIALOUT_IND</span> to the <b class="name">isdnd</b> daemon.<p>
The daemon requests a new CDID from the kernel by using the <span class="emph">I4B_CDID_REQ</span> ioctl message, this CDID is now used in all interactions with the kernel to identify this single call until a disconnect occurs.<p>
After getting the CDID, the daemon looks up several additional information in its entry section of the configuration corresponding to that connection and issues a <span class="emph">I4B_CONNECT_REQ</span> ioctl message to the kernel. The kernel now dials the remote side and if the remote side accepts the call, the kernel sends a <span class="emph">MSG_CONNECT_ACTIVE_IND</span> to the daemon.<p>
The call is terminated by either the local site timing out or the remote side hanging up the connection or the local side actively sending a <span class="emph">I4B_DISCONNECT_REQ</span> ioctl message, both events are signaled to the <b class="name">isdnd</b> by the kernel sending the <span class="emph">I4B_DISCONNECT_IND</span> message and the CDID corresponding to the call is no longer valid.</div>
<div class="subsection">
<h2 id="x494e434f4d494e472043414c4c53">INCOMING CALLS</h2> Incoming calls are signaled to <b class="name">isdnd</b> by the kernel transmitting the <span class="emph">MSG_CONNECT_IND</span> message to the daemon.<p>
With the information contained in this message, <b class="name">isdnd</b> searches the entry section of its configuration database and if a match is found, it accepts or rejects the call or, if no match is found, it ignores the call - all by issuing a <span class="emph">I4B_CONNECT_RESP</span> ioctl message with the appropriate parameters to the kernel.<p>
In case the daemon decided to accept the call, the kernel signals this by sending a <span class="emph">MSG_CONNECT_ACTIVE_IND</span> message to the daemon.<p>
The call is terminated by either the local site timing out or the remote side hanging up the connection or the local side actively sending a <span class="emph">I4B_DISCONNECT_REQ</span> ioctl message, both events are signaled to <b class="name">isdnd</b> by the kernel sending the <span class="emph">I4B_DISCONNECT_IND</span> message and the CDID corresponding to the call is no longer valid.</div>
</div>
<div class="section">
<h1 id="x5349474e414c53">SIGNALS</h1> Sending a HUP signal to <b class="name">isdnd</b> causes all open connections to be terminated and the configuration file is reread. In case aliasfile handling was enabled, the aliasfile is also reread.<p>
Sending a USR1 signal to <b class="name">isdnd</b> causes the accounting file and the logfile (if logging to a file is used instead of logging via the <a class="link-man" href="../3/syslog">syslog(3)</a> facility) to be closed and reopened to make logfile rotation possible.</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1> The following environment variables affect the execution of <b class="name">isdnd</b>:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">TERM</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The terminal type when running in full-screen display mode. See <a class="link-man" href="../7/environ">environ(7)</a> for more information.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/isdn</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The device-file used to communicate with the kernel ISDN driver subsystem.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/log/messages</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
A record of the actions in case of syslogd logging support.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/log/isdnd.acct</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The default accounting information filename (if accounting is configured).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/log/isdnd.log</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The default logging filename (if logging to a file is configured).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/run/isdnd.pid</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The process id of the ISDN daemon (also known as "lockfile" to isdnd, preventing multiple invocations of it).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/isdn</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The directory where isdnd expects some supplementary data files and programs for telephone answering support.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/isdn/isdnd.rc</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The default runtime configuration file.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/isdn/isdnd.rates</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The default unit charging rates specification file.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/isdn/isdntel.alias</i></dt>
<dd class="list-tag" style="margin-left: 21.00ex;">
The default table (if aliasing is enabled) to convert phone number to caller's name.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> For a first try, the following command should be used to start <b class="name">isdnd</b> in foreground mode for better debugging the configuration setup:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
isdnd -d0xf9 -F</pre>
<p>
This will start isdnd with reasonable debugging settings and produce output on the current terminal. <b class="name">isdnd</b> can then be terminated by entering <span class="emph">Control-C</span>.<p>
Another example, the command:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
isdnd -d0xf9 -f -r /dev/ttyv3 -t vt100</pre>
<p>
will start <b class="name">isdnd</b> with reasonable debugging messages enabled, full-screen mode of operation, full-screen display redirected to /dev/ttyv03 and using a terminfo entry for vt100 on this display.</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> Exit status is 0 on success, 1 on error.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../4/ippp">ippp(4)</a>, <a class="link-man" href="../4/irip">irip(4)</a>, <a class="link-man" href="../5/isdnd.rates">isdnd.rates(5)</a>, <a class="link-man" href="../5/isdnd.rc">isdnd.rc(5)</a>, <a class="link-man" href="../8/isdntel">isdntel(8)</a>, <a class="link-man" href="../8/isdntrace">isdntrace(8)</a>, <a class="link-man" href="../8/syslogd">syslogd(8)</a></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="name">isdnd</b> daemon and this manual page were written by <span class="author">Hellmuth Michaelis</span> &#60;<a class="link-mail" href="mailto:hm@kts.org">hm@kts.org</a>&#62;.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 5, 2012</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

