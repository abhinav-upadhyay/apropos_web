<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
TUNEFS(8)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
TUNEFS(8)</td>
<td class="head-vol" align="center">
System Manager's Manual</td>
<td class="head-rtitle" align="right">
TUNEFS(8)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">tunefs</b> &#8212; <span class="desc">tune up an existing file system</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 6.00ex;">
<col>
<tbody>
<tr>
<td>
tunefs</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;AFN</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;e</b> <i class="arg">maxbpg</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;g</b> <i class="arg">avgfilesize</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;h</b> <i class="arg">avgfpdir</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;l</b> <i class="arg">logsize</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;m</b> <i class="arg">minfree</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;o</b> <i class="arg">optimize_preference</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;q</b> <i class="arg">quota</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;S</b> <i class="arg">sectorsize</i></span>&#93; <i class="arg">special</i> | <i class="arg">filesys</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">tunefs</b> is designed to change the dynamic parameters of a file system which affect the layout policies.<p>
The following options are supported by <b class="name">tunefs</b>:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;A</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Cause the values to be updated in all the alternate superblocks instead of just the standard superblock. If this option is not used, then use of a backup superblock by <a class="link-man" href="../html8/fsck.html">fsck(8)</a> will lose anything changed by <b class="name">tunefs</b>. <b class="flag">&#45;A</b> is ignored when <b class="flag">&#45;N</b> is specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;F</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Indicates that <i class="arg">special</i> is a file system image, rather than a device name or file system mount point. <i class="arg">special</i> will be accessed &#8216;as-is&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;N</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Display all the settable options (after any changes from the tuning options) but do not cause any of them to be changed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;e</b> <i class="arg">maxbpg</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This indicates the maximum number of blocks any single file can allocate out of a cylinder group before it is forced to begin allocating blocks from another cylinder group. Typically this value is set to about one quarter of the total blocks in a cylinder group. The intent is to prevent any single file from using up all the blocks in a single cylinder group, thus degrading access times for all files subsequently allocated in that cylinder group. The effect of this limit is to cause big files to do long seeks more frequently than if they were allowed to allocate all the blocks in a cylinder group before seeking elsewhere. For file systems with exclusively large files, this parameter should be set higher.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;g</b> <i class="arg">avgfilesize</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the expected average file size.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;h</b> <i class="arg">avgfpdir</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This specifies the expected number of files per directory.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;l</b> <i class="arg">logsize</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This value specifies the size of the in-filesystem journaling log file. The default journaling log file size is described in <a class="link-man" href="../html4/wapbl.html">wapbl(4)</a>. Specifying a size of zero will cause the in-filesystem journaling log file to be removed the next time the filesystem is mounted. The size of an existing in-filesystem journaling log file can not be changed directly. You need to first set the log file size to zero, then mount the filesystem without logging enabled (which will remove the log without creating a new one), unmount, set the size to the new value and finally re-mount with logging enabled.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;m</b> <i class="arg">minfree</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This value specifies the percentage of space held back from normal users; the minimum free space threshold. The default value is set during creation of the filesystem, see <a class="link-man" href="../html8/newfs.html">newfs(8)</a>. This value can be set to zero, however up to a factor of three in throughput will be lost over the performance obtained at a 5% threshold. Note that if the value is raised above the current usage level, users will be unable to allocate files until enough files have been deleted to get under the higher threshold.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;o</b> <i class="arg">optimize_preference</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The file system can either try to minimize the time spent allocating blocks, or it can attempt to minimize the space fragmentation on the disk. If the value of minfree (see above) is less than 5%, then the file system should optimize for space to avoid running out of full sized blocks. For values of minfree greater than or equal to 5%, fragmentation is unlikely to be problematical, and the file system can be optimized for time.<p>
<i class="arg">optimize_preference</i> can be specified as either <code class="lit">space</code> or <code class="lit">time</code>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;q</b> <i class="arg">quota</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
enable or disable a quota. <i class="arg">quota</i> can be one of <code class="lit">user</code>, <code class="lit">group</code>, <code class="lit">nouser</code> or <code class="lit">nogroup</code> to enable or disable the specified quota type. Multiple <b class="flag">&#45;q</b> can be used to enable/disable all types at once.<p>
After enabling a quota, <a class="link-man" href="../html8/fsck_ffs.html">fsck_ffs(8)</a> has to be run to compute the correct quota values.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;S</b> <i class="arg">sectorsize</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
changes the fsbtodb value in the superblock to reflect a particular physical sector size. This value is ignored by the <span class="unix">NetBSD</span> kernel but needed by tools like <a class="link-man" href="../html8/fsck_ffs.html">fsck_ffs(8)</a> to access disk blocks correctly. The minimum value is <span class="define">DEV_BSIZE</span> (512).<p>
Changing the fsbtodb value becomes necessary when a filesystem image is created for one sector size and then transferred to a device with a different sector size and should be applied also to the alternate superblocks.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/wapbl.html">wapbl(4)</a>, <a class="link-man" href="../html5/fs.html">fs(5)</a>, <a class="link-man" href="../html8/dumpfs.html">dumpfs(8)</a>, <a class="link-man" href="../html8/fsck_ffs.html">fsck_ffs(8)</a>, <a class="link-man" href="../html8/newfs.html">newfs(8)</a><p>
<span class="ref"><span class="ref-auth">M. McKusick</span>, <span class="ref-auth">W. Joy</span>, <span class="ref-auth">S. Leffler</span>, and <span class="ref-auth">R. Fabry</span>, <span class="ref-title">A Fast File System for UNIX</span>, <i class="ref-jrnl">ACM Transactions on Computer Systems 2</i>, <span class="ref-num">3</span>, <span class="ref-page">pp 181-197</span>, <span class="ref-date">August 1984</span>, <span class="ref-opt">(reprinted in the BSD System Manager's Manual, SMM:5)</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">tunefs</b> command appeared in <span class="unix">4.2BSD</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> This program should work on mounted and active file systems. Because the super-block is not kept in the buffer cache, the changes will only take effect if the program is run on unmounted file systems. To change the root file system, the system must be rebooted after the file system is tuned.<p>
You can tune a file system, but you can't tune a fish.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
August 9, 2014</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

