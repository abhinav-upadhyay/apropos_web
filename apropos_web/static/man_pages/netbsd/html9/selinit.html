<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
SELECT(9)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
SELECT(9)</td>
<td class="head-vol" align="center">
Kernel Developer's Manual</td>
<td class="head-rtitle" align="right">
SELECT(9)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">seldestroy</b>, <b class="name">selinit</b>, <b class="name">selrecord</b>, <b class="name">selnotify</b> &#8212; <span class="desc">select and poll subsystem</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/param.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">sys/select.h</a>&gt;</b><p>
<i class="ftype">void</i><br>
<b class="fname">seldestroy</b>(<i class="farg" style="white-space:nowrap;">struct selinfo *sip</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">selinit</b>(<i class="farg" style="white-space:nowrap;">struct selinfo *sip</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">selrecord</b>(<i class="farg" style="white-space:nowrap;">struct lwp *selector</i>, <i class="farg" style="white-space:nowrap;">struct selinfo *sip</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">selnotify</b>(<i class="farg" style="white-space:nowrap;">struct selinfo *sip</i>, <i class="farg" style="white-space:nowrap;">int events</i>, <i class="farg" style="white-space:nowrap;">long knhint</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="fname">selinit</b>() and <b class="fname">seldestroy</b>() functions must be used to initialize and destroy the <b class="var">struct selinfo</b>. The <b class="fname">seldestroy</b>() function may block.<p>
<b class="fname">selrecord</b>() and <b class="fname">selnotify</b>() are used by device drivers to coordinate with the kernel implementation of <a class="link-man" href="../2/select">select(2)</a> and <a class="link-man" href="../2/poll">poll(2)</a>. Each object that can be polled contains a <span class="define">selinfo</span> record. Device drivers provide locking for the <span class="define">selinfo</span> record.<p>
<b class="fname">selrecord</b>() records that the calling thread is interested in events related to a given object. <b class="fname">selrecord</b>() should only be called when the poll routine determines that the object is not ready for I/O: there are no events of interest pending. The check for pending I/O and call to <b class="fname">selrecord</b>() must be atomic. Atomicity can be provided by holding the object's lock across the test and call to <b class="fname">selrecord</b>(). For non-MPSAFE drivers, the global <span class="define">kernel_lock</span> is enough to provide atomicity.<p>
<b class="fname">selnotify</b>() is called by the underlying object handling code in order to notify any waiting threads that an event of interest has occurred. The same lock held across the poll method and call to <b class="fname">selrecord</b>() must be held across the call to <b class="fname">selnotify</b>(). The lock prevents an event of interest being signalled while a thread is in the process of recording its interest.<p>
The <i class="farg">events</i> indicates which event happen. Zero may be used if unknown.<p>
<b class="fname">selnotify</b>() also calls <b class="fname">KNOTE</b>() passing <b class="var">knhint</b> as an argument.</div>
<div class="section">
<h1 id="x434f4445205245464552454e434553">CODE REFERENCES</h1> The core of the select and poll subsystem implementation is in <i class="file">sys/kern/sys_select.c</i>. Data structures and function prototypes are located in <i class="file">sys/sys/select.h</i>, <i class="file">sys/sys/poll.h</i> and <i class="file">sys/sys/selinfo.h</i>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/poll">poll(2)</a>, <a class="link-man" href="../2/select">select(2)</a>, <a class="link-man" href="../9/knote">knote(9)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 13, 2008</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

