<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
WSFONT(9)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
WSFONT(9)</td>
<td class="head-vol" align="center">
Kernel Developer's Manual</td>
<td class="head-rtitle" align="right">
WSFONT(9)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">wsfont</b>, <b class="name">wsfont_init</b>, <b class="name">wsfont_matches</b>, <b class="name">wsfont_find</b>, <b class="name">wsfont_add</b>, <b class="name">wsfont_remove</b>, <b class="name">wsfont_enum</b>, <b class="name">wsfont_lock</b>, <b class="name">wsfont_unlock</b>, <b class="name">wsfont_map_unichar</b> &#8212; <span class="desc">wscons font support</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">dev/wscons/wsconsio.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">dev/wsfont/wsfont.h</a>&gt;</b><p>
<i class="ftype">void</i><br>
<b class="fname">wsfont_init</b>(<i class="farg" style="white-space:nowrap;">void</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">wsfont_matches</b>(<i class="farg" style="white-space:nowrap;">struct wsdisplay_font *font</i>, <i class="farg" style="white-space:nowrap;">const char *name</i>, <i class="farg" style="white-space:nowrap;">int width</i>, <i class="farg" style="white-space:nowrap;">int height</i>, <i class="farg" style="white-space:nowrap;">int stride</i>, <i class="farg" style="white-space:nowrap;">int flags</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">wsfont_find</b>(<i class="farg" style="white-space:nowrap;">const char *name</i>, <i class="farg" style="white-space:nowrap;">int width</i>, <i class="farg" style="white-space:nowrap;">int height</i>, <i class="farg" style="white-space:nowrap;">int stride</i>, <i class="farg" style="white-space:nowrap;">int bitorder</i>, <i class="farg" style="white-space:nowrap;">int byteorder</i>, <i class="farg" style="white-space:nowrap;">int flags</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">wsfont_add</b>(<i class="farg" style="white-space:nowrap;">struct wsdisplay_font *font</i>, <i class="farg" style="white-space:nowrap;">int copy</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">wsfont_remove</b>(<i class="farg" style="white-space:nowrap;">int cookie</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">wsfont_enum</b>(<i class="farg" style="white-space:nowrap;">void (*callback)(const char *, int, int, int)</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">wsfont_lock</b>(<i class="farg" style="white-space:nowrap;">int cookie</i>, <i class="farg" style="white-space:nowrap;">struct wsdisplay_font **ptr</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">wsfont_unlock</b>(<i class="farg" style="white-space:nowrap;">int cookie</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">wsfont_map_unichar</b>(<i class="farg" style="white-space:nowrap;">struct wsdisplay_font *font</i>, <i class="farg" style="white-space:nowrap;">int c</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">wsfont</b> module is a component of the <a class="link-man" href="../9/wscons">wscons(9)</a> framework to provide access to display fonts. Fonts may be loaded dynamically into the kernel or included statically in the kernel at compile time. Display drivers which emulate a glass-tty console on a bit-mapped display can add, remove and find fonts for use by device-dependent blitter operations.<p>
The primary data type for manipulating fonts is the <span class="emph">wsdisplay_font</span> structure in <i class="file">dev/wscons/wsconsio.h</i>:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
struct wsdisplay_font { 
	const char *name;	/* font name */ 
	int firstchar; 
	int numchars;		/* size of font table */ 
	int encoding;		/* font encoding */ 
	u_int fontwidth;	/* character width */ 
	u_int fontheight;	/* character height */ 
	u_int stride; 
	int bitorder; 
	int byteorder; 
	void *data;		/* pointer to font table */ 
};</pre>
<p>
The maximum font table size is <span class="emph">WSDISPLAY_MAXFONTSZ</span>.<p>
The <b class="name">wsfont</b> framework supports fonts with the following encodings:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">WSDISPLAY_FONTENC_ISO</span></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
ISO-encoded fonts.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">WSDISPLAY_FONTENC_IBM</span></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
IBM-encoded fonts commonly available for IBM CGA, EGA and VGA display adapters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">WSDISPLAY_FONTENC_PCVT</span></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
PCVT-encoding fonts distributed as part of the old PCVT terminal emulation driver.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">WSDISPLAY_FONTENC_ISO7</span></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
ISO-encoded Greek fonts.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">WSDISPLAY_FONTENC_ISO2</span></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
ISO-encoded East European fonts.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46554e4354494f4e53">FUNCTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">wsfont_init</b>(<i class="farg">void</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Initialise the font list with the built-in fonts.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">wsfont_matches</b>(<i class="farg">font</i>, <i class="farg">name</i>, <i class="farg">width</i>, <i class="farg">height</i>, <i class="farg">stride</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Matches the font <i class="farg">font</i> with the specifications <i class="farg">name</i>, <i class="farg">width</i>, <i class="farg">height</i>, <i class="farg">stride</i> and <i class="farg">flags</i>. Return zero if not matched and non-zero if matched. The <i class="farg">flags</i> parameter has the same meaning as in <b class="fname">wsfont_find</b>().</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">wsfont_find</b>(<i class="farg">name</i>, <i class="farg">width</i>, <i class="farg">height</i>, <i class="farg">stride</i>, <i class="farg">bitorder</i>, <i class="farg">byteorder</i>, <i class="farg">flags</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Find the font called <i class="farg">name</i> from the fonts loaded into the kernel. The font aspect is specified by <i class="farg">width</i>, <i class="farg">height</i>, and <i class="farg">stride</i>. If <b class="fname">wsfont_find</b>() is called with any of the parameters as 0, it indicates that we don't care about that aspect of the font. If the font is found, a (nonnegative-valued) cookie is returned which can be used with the other functions.<p>
The <i class="farg">bitorder</i> and <i class="farg">byteorder</i> arguments are the bit order and byte order required. Valid values are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">WSDISPLAY_FONTORDER_KNOWN</span></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The font is in known ordered format and doesn't need converting.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">WSDISPLAY_FONTORDER_L2R</span></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The font is ordered left to right.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">WSDISPLAY_FONTORDER_R2L</span></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The font is ordered right to left.</dd>
</dl>
<p>
The <i class="farg">flags</i> parameter determines what type of font can be returned. Any combination of the following values is allowed:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">WSFONT_FIND_BITMAP</span></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
To search bitmap fonts,</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">WSFONT_FIND_ALPHA</span></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
to search anti-aliased fonts.</dd>
</dl>
When more flexibility is required, <b class="fname">wsfont_enum</b>() should be used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">wsfont_add</b>(<i class="farg">font</i>, <i class="farg">copy</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Add a font <i class="farg">font</i> to the font list. If the <i class="farg">copy</i> argument is non-zero, then the font is physically copied, otherwise a reference to the original font is made.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">wsfont_remove</b>(<i class="farg">cookie</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Remove the font specified by <i class="farg">cookie</i> from the font list. The value of cookie was returned by <b class="fname">wsfont_add</b>().</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">wsfont_enum</b>(<i class="farg">callback</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Enumerate the list of fonts. For each font in the font list, the <i class="farg">callback</i> function argument is called with the arguments specifying the font name, width, height and stride.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">wsfont_lock</b>(<i class="farg">cookie</i>, <i class="farg">ptr</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Lock access to the font specified by <i class="farg">cookie</i> so that it cannot be unloaded from the kernel while is being used. If the bit or byte order of the font to be locked differs from what has been requested with <b class="fname">wsfont_find</b>() then the glyph data will be modified to match. At this point it may be necessary for <b class="fname">wsfont_lock</b>() to make a copy of the font data; this action is transparent to the caller. A later call to <b class="fname">wsfont_unlock</b>() will free resources used by temporary copies.<p>
The address of the wsdisplay_font pointer for the specified font is returned in the <i class="farg">ptr</i> argument.<p>
<b class="fname">wsfont_lock</b>() returns zero on success, or an error code on failure.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">wsfont_unlock</b>(<i class="farg">cookie</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Unlock the font specified by <i class="farg">cookie</i>. Returns zero on success, or an error code on failure.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">wsfont_map_unichar</b>(<i class="farg">font</i>, <i class="farg">c</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Remap the unicode character <i class="farg">c</i> to glyph for font <i class="farg">font</i>. Returns the glyph on success or &#45;1 on error.</dd>
</dl>
</div>
<div class="section">
<h1 id="x434f4445205245464552454e434553">CODE REFERENCES</h1> The wscons subsystem is implemented within the directory <i class="file">sys/dev/wscons</i>. The wsfont subsystem itself is implemented within the file <i class="file">sys/dev/wsfont/wsfont.c</i>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../4/wsfont">wsfont(4)</a>, <a class="link-man" href="../8/wsfontload">wsfontload(8)</a>, <a class="link-man" href="../9/autoconf">autoconf(9)</a>, <a class="link-man" href="../9/driver">driver(9)</a>, <a class="link-man" href="../9/intro">intro(9)</a>, <a class="link-man" href="../9/wscons">wscons(9)</a>, <a class="link-man" href="../9/wsdisplay">wsdisplay(9)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
January 13, 2012</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

