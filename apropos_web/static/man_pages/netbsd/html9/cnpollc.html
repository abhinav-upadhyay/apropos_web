<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
CONS(9)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
CONS(9)</td>
<td class="head-vol" align="center">
Kernel Developer's Manual</td>
<td class="head-rtitle" align="right">
CONS(9)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">cnbell</b>, <b class="name">cnflush</b>, <b class="name">cngetc</b>, <b class="name">cngetsn</b>, <b class="name">cnhalt</b>, <b class="name">cnpollc</b>, <b class="name">cnputc</b> &#8212; <span class="desc">console access interface</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">dev/cons.h</a>&gt;</b><p>
<i class="ftype">void</i><br>
<b class="fname">cnbell</b>(<i class="farg" style="white-space:nowrap;">u_int pitch</i>, <i class="farg" style="white-space:nowrap;">u_int period</i>, <i class="farg" style="white-space:nowrap;">u_int volume</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">cnflush</b>(<i class="farg" style="white-space:nowrap;">void</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">cngetc</b>(<i class="farg" style="white-space:nowrap;">void</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">cngetsn</b>(<i class="farg" style="white-space:nowrap;">char *cp</i>, <i class="farg" style="white-space:nowrap;">int size</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">cnhalt</b>(<i class="farg" style="white-space:nowrap;">void</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">cnpollc</b>(<i class="farg" style="white-space:nowrap;">int on</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">cnputc</b>(<i class="farg" style="white-space:nowrap;">int c</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> These functions operate over the current console device. The console must be initialized before these functions can be used.<p>
Console input polling functions <b class="fname">cngetc</b>(), <b class="fname">cngetsn</b>() and <b class="fname">cnpollc</b>() are only to be used during initial system boot, e.g., when asking for root and dump device or to get necessary user input within mountroothooks. Once the system boots, user input is read via standard <a class="link-man" href="../html4/tty.html">tty(4)</a> facilities.<p>
The following is a brief description of each function:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">cnbell</b>()</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Ring a bell at appropriate <i class="farg">pitch</i>, for duration of <i class="farg">period</i> milliseconds at given <i class="farg">volume</i>. Note that the <i class="farg">volume</i> value is ignored commonly.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">cnflush</b>()</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Waits for all pending output to finish.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">cngetc</b>()</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Poll (busy wait) for an input and return the input key. Returns 0 if there is no console input device. <b class="fname">cnpollc</b>() <span class="emph">must</span> be called before <b class="fname">cngetc</b>() could be used. <b class="fname">cngetc</b>() should be used during kernel startup only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">cngetsn</b>()</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Read one line of user input, stop reading once the newline key is input. Input is echoed back. This uses <b class="fname">cnpollc</b>() and <b class="fname">cngetc</b>(). Number of read characters is <i class="farg">size</i> at maximum, user is notified by console bell when the end of input buffer is reached. &lt;Backspace&gt; key works as expected. &lt;@&gt; or &lt;CTRL&gt;-u make <b class="fname">cngetsn</b>() discard input read so far, print newline and wait for next input. <b class="fname">cngetsn</b>() returns number of characters actually read, excluding the final newline. <i class="farg">cp</i> is <span class="emph">not</span> zero-ended before return. <b class="fname">cngetsn</b>() should be used during kernel startup only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">cnhalt</b>()</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Terminates the console device (i.e. cleanly shuts down the console hardware.)</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">cnpollc</b>()</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Switch the console driver to polling mode if <i class="farg">on</i> is nonzero, or back to interrupt driven mode if <i class="farg">on</i> is zero. <b class="fname">cnpollc</b>() should be used during kernel startup only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">cnputc</b>()</dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Console kernel output character routine. Commonly, kernel code uses <a class="link-man" href="../html9/printf.html">printf(9)</a> rather than using this low-level interface.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> This waits until a &lt;Enter&gt; key is pressed:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
int c; 
 
cnpollc(1); 
for(;;) { 
	c = cngetc(); 
	if ((c == '&#92;r' || (c == '&#92;n')) { 
		printf("&#92;n"); 
		break; 
	} 
} 
cnpollc(0);</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html4/pckbd.html">pckbd(4)</a>, <a class="link-man" href="../html4/pcppi.html">pcppi(4)</a>, <a class="link-man" href="../html4/tty.html">tty(4)</a>, <a class="link-man" href="../html4/wscons.html">wscons(4)</a>, <a class="link-man" href="../html4/wskbd.html">wskbd(4)</a>, <a class="link-man" href="../html9/printf.html">printf(9)</a>, <a class="link-man" href="../html9/spl.html">spl(9)</a>, <a class="link-man" href="../html9/wscons.html">wscons(9)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
June 8, 2010</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

