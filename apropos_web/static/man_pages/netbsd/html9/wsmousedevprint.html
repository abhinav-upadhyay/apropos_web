<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
WSMOUSE(9)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
WSMOUSE(9)</td>
<td class="head-vol" align="center">
Kernel Developer's Manual</td>
<td class="head-rtitle" align="right">
WSMOUSE(9)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">wsmouse</b>, <b class="name">wsmouse_input</b>, <b class="name">wsmousedevprint</b> &#8212; <span class="desc">wscons mouse support</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">dev/wscons/wsconsio.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">dev/wscons/wsmousevar.h</a>&gt;</b><p>
<i class="ftype">void</i><br>
<b class="fname">wsmouse_input</b>(<i class="farg" style="white-space:nowrap;">struct device *msdev</i>, <i class="farg" style="white-space:nowrap;">u_int btns</i>, <i class="farg" style="white-space:nowrap;">int x</i>, <i class="farg" style="white-space:nowrap;">int y</i>, <i class="farg" style="white-space:nowrap;">int z</i>, <i class="farg" style="white-space:nowrap;">int w</i>, <i class="farg" style="white-space:nowrap;">u_int flags</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">wsmousedevprint</b>(<i class="farg" style="white-space:nowrap;">void *aux</i>, <i class="farg" style="white-space:nowrap;">const char *pnp</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">wsmouse</b> module is a component of the <a class="link-man" href="../9/wscons">wscons(9)</a> framework to provide machine-independent mouse support. Most of the support is provided by the <a class="link-man" href="../4/wsmouse">wsmouse(4)</a> device driver, which must be a child of the hardware device driver.</div>
<div class="section">
<h1 id="x44415441205459504553">DATA TYPES</h1> Mouse drivers providing support for wscons pointer devices will make use of the following data types:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">struct wsmouse_accessops</i></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
A structure used to specify the mouse access functions. All pointer devices must provide this structure and pass it to the <a class="link-man" href="../4/wsmouse">wsmouse(4)</a> child device. It has the following members:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
	int	(*enable)(void *); 
	int	(*ioctl)(void *v, u_long cmd, void *data, 
			int flag, struct lwp *l); 
	void	(*disable)(void *);</pre>
<p>
The <i class="farg">enable</i> member defines the function to be called to enable monitoring pointer movements and passing these events to wscons. The <i class="farg">disable</i> member defines the function to disable movement events. The <i class="farg">ioctl</i> member defines the function to be called to perform mouse-specific ioctl calls.<p>
There is a <i class="farg">void *</i> cookie provided by the mouse driver associated with these functions, which is passed to them when they are invoked.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">struct wsmousedev_attach_args</i></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
A structure used to attach the <a class="link-man" href="../4/wsmouse">wsmouse(4)</a> child device. It has the following members:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
	const struct wsmouse_accessops *accessops; 
	void *accesscookie;</pre>
</dd>
</dl>
</div>
<div class="section">
<h1 id="x46554e4354494f4e53">FUNCTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">wsmouse_input</b>(<i class="farg">msdev</i>, <i class="farg">btns</i>, <i class="farg">x</i>, <i class="farg">y</i>, <i class="farg">z</i>, <i class="farg">w</i>, <i class="farg">flags</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Callback from the mouse driver to the wsmouse interface driver. Arguments are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="farg">msdev</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
This is the <i class="farg">struct device</i> pointer passed from <b class="fname">config_found</b>() on attaching the child <a class="link-man" href="../4/wsmouse">wsmouse(4)</a> to specify the mouse device.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="farg">btns</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
This specifies the current button status. Bits for pressed buttons (which will cause the <span class="define">WSCONS_EVENT_MOUSE_DOWN</span> event on <a class="link-man" href="../4/wsmouse">wsmouse(4)</a> device) should be set, and bits for released buttons (which will cause the <span class="define">WSCONS_EVENT_MOUSE_UP</span> event) should be zero. The left most button state should be in LSB, i.e. for typical three button mouse, the left button is 0x01, the middle button is 0x02, and the right button is 0x04.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="farg">x</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
Absolute or relative X-axis value to specify the pointer coordinate. Rightward (moving the mouse right) is positive.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="farg">y</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
Absolute or relative Y-axis value to specify the pointer coordinate. Upward (moving the mouse forward) is positive. Note that this aspect is opposite from the one used in the X server dix layer.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="farg">z</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
Absolute or relative Z-axis value to specify the pointer coordinate. Usually this axis is used for the wheel. Downward (turning the wheel backward) is positive.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="farg">w</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
Absolute or relative W-axis value to specify the pointer coordinate. Usually this axis would be used for the horizontal component of the wheel.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="farg">flags</i></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
This argument specifies whether the pointer device and the measurement of the <i class="farg">x</i>, <i class="farg">y</i>, <i class="farg">z</i>, and <i class="farg">w</i> axes is in relative or absolute mode. Valid values for <i class="farg">flags</i> are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
WSMOUSE_INPUT_DELTA</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Relative mode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
WSMOUSE_INPUT_ABSOLUTE_X</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Absolute mode in <i class="farg">x</i> axis.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
WSMOUSE_INPUT_ABSOLUTE_Y</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Absolute mode in <i class="farg">y</i> axis.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
WSMOUSE_INPUT_ABSOLUTE_Z</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Absolute mode in <i class="farg">z</i> axis.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
WSMOUSE_INPUT_ABSOLUTE_W</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Absolute mode in <i class="farg">w</i> axis.</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">wsmousedevprint</b>(<i class="farg">aux</i>, <i class="farg">pnp</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The default wsmouse printing routine used by <b class="fname">config_found</b>(). (see <a class="link-man" href="../9/autoconf">autoconf(9)</a>).</dd>
</dl>
</div>
<div class="section">
<h1 id="x4155544f434f4e46494755524154494f4e">AUTOCONFIGURATION</h1> Mouse drivers which want to use the wsmouse module must be a parent to the <a class="link-man" href="../4/wsmouse">wsmouse(4)</a> device and provide an attachment interface. To attach the <a class="link-man" href="../4/wsmouse">wsmouse(4)</a> device, the mouse driver must allocate and populate a <i class="farg">wsmousedev_attach_args</i> structure with the supported operations and callbacks and call <b class="fname">config_found</b>() to perform the attach (see <a class="link-man" href="../9/autoconf">autoconf(9)</a>).</div>
<div class="section">
<h1 id="x4f5045524154494f4e">OPERATION</h1> When a mouse-movement event is received, the device driver must perform any necessary movement decoding to wscons events and pass the events to wscons via <b class="fname">wsmouse_input</b>().<p>
The wscons framework calls back into the hardware driver by invoking the functions that are specified in the <span class="emph">accessops</span> structure. The <b class="fname">enable</b>() and <b class="fname">disable</b>() functions are relatively simple and self-explanatory. The <b class="fname">ioctl</b>() function is called by the wscons interface to perform mouse-specific ioctl operations (see <a class="link-man" href="../2/ioctl">ioctl(2)</a>). The argument <i class="farg">cmd</i> to the <b class="fname">ioctl</b>() function specifies the specific command to perform using the data <i class="farg">data</i>. Valid commands are listed in <i class="file">sys/dev/wscons/wsconsio.h</i>.</div>
<div class="section">
<h1 id="x434f4445205245464552454e434553">CODE REFERENCES</h1> The wscons subsystem is implemented within the directory <i class="file">sys/dev/wscons</i>. The <b class="name">wsmouse</b> module itself is implement within the file <i class="file">sys/dev/wscons/wsmouse.c</i>. <a class="link-man" href="../2/ioctl">ioctl(2)</a> operations are listed in <i class="file">sys/dev/wscons/wsconsio.h</i>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/ioctl">ioctl(2)</a>, <a class="link-man" href="../4/pms">pms(4)</a>, <a class="link-man" href="../4/wscons">wscons(4)</a>, <a class="link-man" href="../4/wsmouse">wsmouse(4)</a>, <a class="link-man" href="../9/autoconf">autoconf(9)</a>, <a class="link-man" href="../9/driver">driver(9)</a>, <a class="link-man" href="../9/intro">intro(9)</a>, <a class="link-man" href="../9/wscons">wscons(9)</a>, <a class="link-man" href="../9/wsdisplay">wsdisplay(9)</a>, <a class="link-man" href="../9/wskbd">wskbd(9)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
November 12, 2006</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

