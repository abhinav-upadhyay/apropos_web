<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
KFILTER_REGISTER(9)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
KFILTER_REGISTER(9)</td>
<td class="head-vol" align="center">
Kernel Developer's Manual</td>
<td class="head-rtitle" align="right">
KFILTER_REGISTER(9)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">kfilter_register</b>, <b class="name">kfilter_unregister</b> &#8212; <span class="desc">add or remove kernel event filters</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/event.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">kfilter_register</b>(<i class="farg" style="white-space:nowrap;">const char *name</i>, <i class="farg" style="white-space:nowrap;">struct filterops *filtops</i>, <i class="farg" style="white-space:nowrap;">int *retfilter</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">kfilter_unregister</b>(<i class="farg" style="white-space:nowrap;">const char *name</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">kfilter_register</b>() function adds a new kernel event filter (kfilter) to the system, for use by callers of <a class="link-man" href="../html2/kqueue.html">kqueue(2)</a> and <a class="link-man" href="../html2/kevent.html">kevent(2)</a>. <i class="farg">name</i> is the name of the new filter (which must not already exist), and <i class="farg">filtops</i> is a pointer to a <b class="var">filterops</b> structure which describes the filter operations. Both <i class="farg">name</i> and <i class="farg">filtops</i> will be copied to an internal data structure, and a new filter number will be allocated. If <i class="farg">retfilter</i> is not <span class="define">NULL</span>, then the new filter number will be returned in the address pointed at by <i class="farg">retfilter</i>.<p>
The <b class="fname">kfilter_unregister</b>() function removes a kfilter named <i class="farg">name</i> that was previously registered with <b class="fname">kfilter_register</b>(). If a filter with the same <i class="farg">name</i> is later reregistered with <b class="fname">kfilter_register</b>(), it will get a different filter number (i.e., filter numbers are not recycled). It is not possible to unregister the system filters (i.e., those that start with &#8220;EVFILT_&#8221; and are documented in <a class="link-man" href="../html2/kqueue.html">kqueue(2)</a>).<p>
The <b class="var">filterops</b> structure is defined as follows:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
struct filterops { 
	int	f_isfd;		/* true if ident == filedescriptor */ 
	int	(*f_attach)(struct knote *kn); 
				/* called when knote is ADDed */ 
	void	(*f_detach)(struct knote *kn); 
				/* called when knote is DELETEd */ 
	int	(*f_event)(struct knote *kn, long hint); 
				/* called when event is triggered */ 
};</pre>
<p>
If the filter operation is for a file descriptor, <b class="var">f_isfd</b> should be non-zero, otherwise it should be zero. This controls where the <a class="link-man" href="../html2/kqueue.html">kqueue(2)</a> system stores the knotes for an object.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> <b class="fname">kfilter_register</b>() returns 0 on success, <span class="errno">EINVAL</span> if there's an invalid argument, or <span class="errno">EEXIST</span> if the filter already exists,<p>
<b class="fname">kfilter_unregister</b>() returns 0 on success, <span class="errno">EINVAL</span> if there's an invalid argument, or <span class="errno">ENOENT</span> if the filter doesn't exist.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/kqueue.html">kqueue(2)</a>, <a class="link-man" href="../html9/free.html">free(9)</a>, <a class="link-man" href="../html9/knote.html">knote(9)</a>, <a class="link-man" href="../html9/malloc.html">malloc(9)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">kfilter_register</b>() and <b class="fname">kfilter_unregister</b>() functions first appeared in <span class="unix">NetBSD&#160;2.0</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="fname">kfilter_register</b>() and <b class="fname">kfilter_unregister</b>() functions were implemented by <span class="author">Luke Mewburn</span> &#60;lukem@NetBSD.org&#62;.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
October 23, 2002</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

