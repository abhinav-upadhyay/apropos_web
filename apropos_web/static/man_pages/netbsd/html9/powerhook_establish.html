<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
POWERHOOK_ESTABLISH(9)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
POWERHOOK_ESTABLISH(9)</td>
<td class="head-vol" align="center">
Kernel Developer's Manual</td>
<td class="head-rtitle" align="right">
POWERHOOK_ESTABLISH(9)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">powerhook_establish</b>, <b class="name">powerhook_disestablish</b> &#8212; <span class="desc">add or remove a power change hook</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <i class="ftype">void *</i><br>
<b class="fname">powerhook_establish</b>(<i class="farg" style="white-space:nowrap;">const char *name</i>, <i class="farg" style="white-space:nowrap;">void (*fn)(int why, void *a)</i>, <i class="farg" style="white-space:nowrap;">void *arg</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">powerhook_disestablish</b>(<i class="farg" style="white-space:nowrap;">void *cookie</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <span class="emph">The</span> <b class="name">powerhook_establish</b> <span class="emph">API is deprecated.</span><p>
The <b class="fname">powerhook_establish</b>() function adds <i class="farg">fn</i> of the list of hooks invoked by <a class="link-man" href="../9/dopowerhooks">dopowerhooks(9)</a> at power change. When invoked, the hook function <i class="farg">fn</i> will be passed the new power state as the first argument and <i class="farg">arg</i> as its second argument.<p>
The <b class="fname">powerhook_disestablish</b>() function removes the hook described by the opaque pointer <i class="farg">cookie</i> from the list of hooks to be invoked at power change. If <i class="farg">cookie</i> is invalid, the result of <b class="fname">powerhook_disestablish</b>() is undefined.<p>
Power hooks should be used to perform activities that must happen when the power situation to the computer changes. Because of the environment in which they are run, power hooks cannot rely on many system services (including file systems, and timeouts and other interrupt-driven services). The power hooks are typically executed from an interrupt context.<p>
The different reasons for calling the power hooks are: suspend, standby, and resume. The reason is reflected in the <i class="farg">why</i> argument and the values <span class="define">PWR_SOFTSUSPEND</span>, <span class="define">PWR_SUSPEND</span>, <span class="define">PWR_SOFTSTANDBY</span>, <span class="define">PWR_STANDBY</span>, <span class="define">PWR_SOFTRESUME</span>, and <span class="define">PWR_RESUME</span>. It calls with PWR_SOFTxxx in the normal priority level while the other callings are protected with <a class="link-man" href="../9/splhigh">splhigh(9)</a>. At suspend the system is going to lose (almost) all power, standby retains some power (e.g., minimal power to USB devices), and at resume power is back to normal.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> If successful, <b class="fname">powerhook_establish</b>() returns an opaque pointer describing the newly-established power hook. Otherwise, it returns NULL.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../9/dopowerhooks">dopowerhooks(9)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 14, 2009</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

