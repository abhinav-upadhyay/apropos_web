<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
M_TAG(9)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
M_TAG(9)</td>
<td class="head-vol" align="center">
Kernel Developer's Manual</td>
<td class="head-rtitle" align="right">
M_TAG(9)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">m_tag</b>, <b class="name">m_tag_get</b>, <b class="name">m_tag_free</b>, <b class="name">m_tag_prepend</b>, <b class="name">m_tag_unlink</b>, <b class="name">m_tag_delete</b>, <b class="name">m_tag_delete_chain</b>, <b class="name">m_tag_delete_nonpersistent</b>, <b class="name">m_tag_find</b>, <b class="name">m_tag_copy</b>, <b class="name">m_tag_copy_chain</b>, <b class="name">m_tag_init</b>, <b class="name">m_tag_first</b>, <b class="name">m_tag_next</b> &#8212; <span class="desc">mbuf tagging interfaces</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/mbuf.h</a>&gt;</b><p>
<i class="ftype">struct m_tag *</i><br>
<b class="fname">m_tag_get</b>(<i class="farg" style="white-space:nowrap;">int type</i>, <i class="farg" style="white-space:nowrap;">int len</i>, <i class="farg" style="white-space:nowrap;">int wait</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">m_tag_free</b>(<i class="farg" style="white-space:nowrap;">struct m_tag *t</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">m_tag_prepend</b>(<i class="farg" style="white-space:nowrap;">struct mbuf *m</i>, <i class="farg" style="white-space:nowrap;">struct m_tag *t</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">m_tag_unlink</b>(<i class="farg" style="white-space:nowrap;">struct mbuf *m</i>, <i class="farg" style="white-space:nowrap;">struct m_tag *t</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">m_tag_delete</b>(<i class="farg" style="white-space:nowrap;">struct mbuf *m</i>, <i class="farg" style="white-space:nowrap;">struct m_tag *t</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">m_tag_delete_chain</b>(<i class="farg" style="white-space:nowrap;">struct mbuf *m</i>, <i class="farg" style="white-space:nowrap;">struct m_tag *t</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">m_tag_delete_nonpersistent</b>(<i class="farg" style="white-space:nowrap;">struct mbuf *</i>);<p>
<i class="ftype">struct m_tag *</i><br>
<b class="fname">m_tag_find</b>(<i class="farg" style="white-space:nowrap;">struct mbuf *m</i>, <i class="farg" style="white-space:nowrap;">int type</i>, <i class="farg" style="white-space:nowrap;">struct m_tag *t</i>);<p>
<i class="ftype">struct m_tag *</i><br>
<b class="fname">m_tag_copy</b>(<i class="farg" style="white-space:nowrap;">struct m_tag *m</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">m_tag_copy_chain</b>(<i class="farg" style="white-space:nowrap;">struct mbuf *to</i>, <i class="farg" style="white-space:nowrap;">struct mbuf *from</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">m_tag_init</b>(<i class="farg" style="white-space:nowrap;">struct mbuf *m</i>);<p>
<i class="ftype">struct m_tag *</i><br>
<b class="fname">m_tag_first</b>(<i class="farg" style="white-space:nowrap;">struct mbuf *m</i>);<p>
<i class="ftype">struct m_tag *</i><br>
<b class="fname">m_tag_next</b>(<i class="farg" style="white-space:nowrap;">struct mbuf *m</i>, <i class="farg" style="white-space:nowrap;">struct m_tag *t</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">m_tag</b> interface is used to &#8220;tag&#8221; mbufs.</div>
<div class="section">
<h1 id="x46554e4354494f4e53">FUNCTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_get</b>(<i class="farg">type</i>, <i class="farg">len</i>, <i class="farg">wait</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Allocate an mbuf tag. <i class="farg">type</i> is one of the <span class="define">PACKET_TAG_</span> macros. <i class="farg">len</i> is the size of the data associated with the tag, in bytes. <i class="farg">wait</i> is either <span class="define">M_WAITOK</span> or <span class="define">M_NOWAIT</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_free</b>(<i class="farg">t</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Free the mbuf tag <i class="farg">t</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_prepend</b>(<i class="farg">m</i>, <i class="farg">t</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Prepend the mbuf tag <i class="farg">t</i> to the mbuf <i class="farg">m</i>. <i class="farg">t</i> will become the first tag of the mbuf <i class="farg">m</i>. When <i class="farg">m</i> is freed, <i class="farg">t</i> will also be freed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_unlink</b>(<i class="farg">m</i>, <i class="farg">t</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Unlink the mbuf tag <i class="farg">t</i> from the mbuf <i class="farg">m</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_delete</b>(<i class="farg">m</i>, <i class="farg">t</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The same as <b class="fname">m_tag_unlink</b>() followed by <b class="fname">m_tag_free</b>().</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_delete_chain</b>(<i class="farg">m</i>, <i class="farg">t</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Unlink and free mbuf tags beginning with the mbuf tag <i class="farg">t</i> from the mbuf <i class="farg">m</i>. If <i class="farg">t</i> is <span class="define">NULL</span>, <b class="fname">m_tag_delete_chain</b>() unlinks and frees all mbuf tags associated with the mbuf <i class="farg">m</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_delete_nonpersistent</b>(<i class="farg">m</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Unlink and free all non persistent tags associated with the mbuf <i class="farg">m</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_find</b>(<i class="farg">m</i>, <i class="farg">type</i>, <i class="farg">t</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Find an mbuf tag with type <i class="farg">type</i> after the mbuf tag <i class="farg">t</i> in the tag chain associated with the mbuf <i class="farg">m</i>. If <i class="farg">t</i> is <span class="define">NULL</span>, search from the first mbuf tag. If an mbuf tag is found, return a pointer to it. Otherwise return <span class="define">NULL</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_copy</b>(<i class="farg">t</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Copy an mbuf tag <i class="farg">t</i>. Return a new mbuf tag on success. Otherwise return <span class="define">NULL</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_copy_chain</b>(<i class="farg">to</i>, <i class="farg">from</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Copy all mbuf tags associated with the mbuf <i class="farg">from</i> to the mbuf <i class="farg">to</i>. If <i class="farg">to</i> already has any mbuf tags, they will be unlinked and freed beforehand. Return 1 on success. Otherwise return 0.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_init</b>(<i class="farg">m</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Initialize mbuf tag chain of the mbuf <i class="farg">m</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_first</b>(<i class="farg">m</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Return the first mbuf tag associated with the mbuf <i class="farg">m</i>. Return <span class="define">NULL</span> if no mbuf tags are found.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">m_tag_next</b>(<i class="farg">m</i>, <i class="farg">t</i>)</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Return the next mbuf tag after <i class="farg">t</i> associated with the mbuf <i class="farg">m</i>. Return <span class="define">NULL</span> if <i class="farg">t</i> is the last tag in the chain.</dd>
</dl>
</div>
<div class="section">
<h1 id="x434f4445205245464552454e434553">CODE REFERENCES</h1> The mbuf tagging interfaces are implemented within the file <i class="file">sys/kern/uipc_mbuf2.c</i>.<p>
The <span class="define">PACKET_TAG_</span> macros are defined in the file <i class="file">sys/sys/mbuf.h</i>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../9/intro">intro(9)</a>, <a class="link-man" href="../9/malloc">malloc(9)</a>, <a class="link-man" href="../9/mbuf">mbuf(9)</a></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The semantics of the term "persistent tag" are vague.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
September 7, 2004</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

