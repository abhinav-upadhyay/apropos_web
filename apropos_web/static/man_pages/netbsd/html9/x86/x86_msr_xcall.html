<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="..//static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
X86_MSR_XCALL(9) (x86)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
X86_MSR_XCALL(9)</td>
<td class="head-vol" align="center">
Kernel Developer's Manual (x86)</td>
<td class="head-rtitle" align="right">
X86_MSR_XCALL(9)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">x86_msr_xcall</b> &#8212; <span class="desc">MSR specific cross-call</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">x86/cpu_msr.h</a>&gt;</b><p>
<i class="ftype">void</i><br>
<b class="fname">x86_msr_xcall</b>(<i class="farg" style="white-space:nowrap;">void *arg1</i>, <i class="farg" style="white-space:nowrap;">void *arg1</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">x86_msr_xcall</b>() function provides a x86-specific IPI handler suitable for use with the <a class="link-man" href="../../9/xcall">xcall(9)</a> interface. It can be used to ensure that a given MSR call is executed on all processors. The prototype follows the <i class="ftype">xcfunc_t</i> function pointer type and the opaque <i class="farg">arg1</i> pointer is casted to the following structure:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
struct msr_rw_info { 
	int		msr_read; 
	int		msr_type; 
	uint64_t	msr_value; 
	uint64_t	msr_mask; 
};</pre>
<p>
This structure must be filled prior to the call. Two fields are compulsory: <i class="farg">msr_type</i> is used as the address of the MSR and <i class="farg">msr_value</i> is the value to be written. If <i class="farg">msr_read</i> is not zero, <b class="fname">x86_msr_xcall</b>() will first read from <i class="farg">msr_type</i> and then clear the mask specified in <i class="farg">msr_mask</i> before the write operation.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The following example writes a value zero to the MSR_THERM_CONTROL model-specific register on all processors in the system:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
struct msr_rw_info msr; 
uint64_t xc; 
 
msr.msr_value = 0; 
msr.msr_read = true; 
msr.msr_type = MSR_THERM_CONTROL; 
msr.msr_mask = 0x1e; 
 
xc = xc_broadcast(0, (xcfunc_t)x86_msr_xcall, &amp;msr, NULL); 
xc_wait(xc);</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../../9/rdmsr">rdmsr(9)</a>, <a class="link-man" href="../../9/xcall">xcall(9)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
October 25, 2011</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

