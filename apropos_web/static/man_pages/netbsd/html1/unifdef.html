<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
UNIFDEF(1)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
UNIFDEF(1)</td>
<td class="head-vol" align="center">
General Commands Manual</td>
<td class="head-rtitle" align="right">
UNIFDEF(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">unifdef</b>, <b class="name">unifdefall</b> &#8212; <span class="desc">remove preprocessor conditionals from code</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 7.00ex;">
<col>
<tbody>
<tr>
<td>
unifdef</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;ceklst</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;I</b><i class="arg">path</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;D</b><i class="arg">sym</i>&#91;<span class="opt">=<i class="arg">val</i></span>&#93;</span>&#93; &#91;<span class="opt"><b class="flag">&#45;U</b><i class="arg">sym</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;iD</b><i class="arg">sym</i>&#91;<span class="opt">=<i class="arg">val</i></span>&#93;</span>&#93; &#91;<span class="opt"><b class="flag">&#45;iU</b><i class="arg">sym</i></span>&#93; <i class="arg">...</i> &#91;<span class="opt"><b class="flag">&#45;o</b> <i class="arg">output</i></span>&#93; &#91;<span class="opt"><i class="arg">file</i></span>&#93;</td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 7.00ex;">
<col>
<tbody>
<tr>
<td>
unifdefall</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;I</b><i class="arg">path</i></span>&#93; <i class="arg">...</i> <i class="arg">file</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">unifdef</b> utility selectively processes conditional <a class="link-man" href="../1/cpp">cpp(1)</a> directives. It removes from a file both the directives and any additional text that they specify should be removed, while otherwise leaving the file alone.<p>
The <b class="name">unifdef</b> utility acts on <b class="cmd">#if</b>, <b class="cmd">#ifdef</b>, <b class="cmd">#ifndef</b>, <b class="cmd">#elif</b>, <b class="cmd">#else</b>, and <b class="cmd">#endif</b> lines, and it understands only the commonly-used subset of the expression syntax for <b class="cmd">#if</b> and <b class="cmd">#elif</b> lines. It handles integer values of symbols defined on the command line, the <b class="fname">defined</b>() operator applied to symbols defined or undefined on the command line, the operators <b class="cmd">!</b>, <b class="cmd">&lt;</b>, <b class="cmd">&gt;</b>, <b class="cmd">&lt;=</b>, <b class="cmd">&gt;=</b>, <b class="cmd">==</b>, <b class="cmd">!=</b>, <b class="cmd">&amp;&amp;</b>, <b class="cmd">||</b>, and parenthesized expressions. Anything that it does not understand is passed through unharmed. It only processes <b class="cmd">#ifdef</b> and <b class="cmd">#ifndef</b> directives if the symbol is specified on the command line, otherwise they are also passed through unchanged. By default, it ignores <b class="cmd">#if</b> and <b class="cmd">#elif</b> lines with constant expressions, or they may be processed by specifying the <b class="flag">&#45;k</b> flag on the command line.<p>
The <b class="name">unifdef</b> utility also understands just enough about C to know when one of the directives is inactive because it is inside a comment, or affected by a backslash-continued line. It spots unusually-formatted preprocessor directives and knows when the layout is too odd to handle.<p>
A script called <b class="name">unifdefall</b> can be used to remove all conditional <a class="link-man" href="../1/cpp">cpp(1)</a> directives from a file. It uses <b class="name">unifdef</b> <b class="flag">&#45;s</b> and <b class="name">cpp</b> <b class="flag">&#45;dM</b> to get lists of all the controlling symbols and their definitions (or lack thereof), then invokes <b class="name">unifdef</b> with appropriate arguments to process the file.<p>
Available options:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;D</b><i class="arg">sym</i>&#91;<span class="opt">=<i class="arg">val</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify that a symbol is defined, and optionally specify what value to give it for the purpose of handling <b class="cmd">#if</b> and <b class="cmd">#elif</b> directives.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;U</b><i class="arg">sym</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify that a symbol is undefined. If the same symbol appears in more than one argument, the last occurrence dominates.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;c</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If the <b class="flag">&#45;c</b> flag is specified, then the operation of <b class="name">unifdef</b> is complemented, i.e., the lines that would have been removed or blanked are retained and vice versa.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;e</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Because <b class="name">unifdef</b> processes its input one line at a time, it cannot remove preprocessor directives that span more than one line. The most common example of this is a directive with a multi-line comment hanging off its right hand end. By default, if <b class="name">unifdef</b> has to process such a directive, it will complain that the line is too obfuscated. The <b class="flag">&#45;e</b> option changes the behaviour so that, where possible, such lines are left unprocessed instead of reporting an error.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;k</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Process <b class="cmd">#if</b> and <b class="cmd">#elif</b> lines with constant expressions. By default, sections controlled by such lines are passed through unchanged because they typically start &#8220;<code class="lit">#if 0</code>&#8221; and are used as a kind of comment to sketch out future or past development. It would be rude to strip them out, just as it would be for normal comments.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;l</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Replace removed lines with blank lines instead of deleting them.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;o</b> <i class="arg">output</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The argument given is the name of an <i class="arg">output</i> file to be used instead of the standard output. This file can be the same as the input file.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;s</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Instead of processing the input file as usual, this option causes <b class="name">unifdef</b> to produce a list of symbols that appear in expressions that <b class="name">unifdef</b> understands. It is useful in conjunction with the <b class="flag">&#45;dM</b> option of <a class="link-man" href="../1/cpp">cpp(1)</a> for creating <b class="name">unifdef</b> command lines.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;t</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Disables parsing for C comments and line continuations, which is useful for plain text.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;iD</b><i class="arg">sym</i>&#91;<span class="opt">=<i class="arg">val</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;iU</b><i class="arg">sym</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Ignore <b class="cmd">#ifdef</b>s. If your C code uses <b class="cmd">#ifdef</b>s to delimit non-C lines, such as comments or code which is under construction, then you must tell <b class="name">unifdef</b> which symbols are used for that purpose so that it will not try to parse comments and line continuations inside those <b class="cmd">#ifdef</b>s. One specifies ignored symbols with <b class="flag">&#45;iD</b><i class="arg">sym</i>&#91;<span class="opt">=<i class="arg">val</i></span>&#93; and <b class="flag">&#45;iU</b><i class="arg">sym</i> similar to <b class="flag">&#45;D</b><i class="arg">sym</i>&#91;<span class="opt">=<i class="arg">val</i></span>&#93; and <b class="flag">&#45;U</b><i class="arg">sym</i> above.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;I</b><i class="arg">path</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies to <b class="name">unifdefall</b> an additional place to look for <b class="cmd">#include</b> files. This option is ignored by <b class="name">unifdef</b> for compatibility with <a class="link-man" href="../1/cpp">cpp(1)</a> and to simplify the implementation of <b class="name">unifdefall</b>.</dd>
</dl>
<p>
The <b class="name">unifdef</b> utility copies its output to <span class="emph">stdout</span> and will take its input from <span class="emph">stdin</span> if no <i class="arg">file</i> argument is given.<p>
The <b class="name">unifdef</b> utility works nicely with the <b class="flag">&#45;D</b><i class="arg">sym</i> option of <a class="link-man" href="../1/diff">diff(1)</a>.</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1><ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-item">
<li class="list-item" style="margin-top: 1.00em;">
Too many levels of nesting.</li>
<li class="list-item" style="margin-top: 1.00em;">
Inappropriate <b class="cmd">#elif</b>, <b class="cmd">#else</b> or <b class="cmd">#endif</b>.</li>
<li class="list-item" style="margin-top: 1.00em;">
Obfuscated preprocessor control line.</li>
<li class="list-item" style="margin-top: 1.00em;">
Premature <span class="define">EOF</span> (with the line number of the most recent unterminated <b class="cmd">#if</b>).</li>
<li class="list-item" style="margin-top: 1.00em;">
<span class="define">EOF</span> in comment.</li>
</ul>
<p>
The <b class="name">unifdef</b> utility exits 0 if the output is an exact copy of the input, 1 if not, and 2 if in trouble.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/cpp">cpp(1)</a>, <a class="link-man" href="../1/diff">diff(1)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">unifdef</b> command appeared in <span class="unix">4.3BSD</span>. ANSI&#160;C support was added in <span class="unix">FreeBSD&#160;4.7</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Expression evaluation is very limited.<p>
Preprocessor control lines split across more than one physical line (because of comments or backslash-newline) cannot be handled in every situation.<p>
Trigraphs are not recognized.<p>
There is no support for symbols with different definitions at different points in the source file.<p>
The text-mode and ignore functionality does not correspond to modern <a class="link-man" href="../1/cpp">cpp(1)</a> behaviour.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
June 5, 2009</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

