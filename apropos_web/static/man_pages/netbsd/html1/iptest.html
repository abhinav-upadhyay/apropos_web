<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
IPTEST(1)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
IPTEST(1)</td>
<td class="head-vol" align="center">
General Commands Manual</td>
<td class="head-rtitle" align="right">
IPTEST(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> iptest &#45; automatically generate packets to test IP functionality</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>iptest</b> [ <b>&#45;1234567</b> ] [ <b>&#45;d</b> &lt;device&gt; ] [ <b>&#45;g</b> &lt;gateway&gt; ] [ <b>&#45;m</b> &lt; <i>MTU</i>&gt; ] [ <b>&#45;p</b> &lt; <i>pointtest</i>&gt; ] [ <b>&#45;s</b> &lt; <i>source</i>&gt; ] &lt;destination&gt;</div>
<div class="section">
<h1>DESCRIPTION</h1>  <b>iptest</b> ...</div>
<div class="section">
<h1>OPTIONS</h1><dl>
<dt>
<b>&#45;1</b></dt>
<dd>
Run IP test group #1.  This group of tests generates packets with the IP header fields set to invalid values given other packet characteristics. The point tests are: 1 (ip_hl &lt; ip_len), 2 (ip_hl &gt; ip_len), 3 (ip_v &lt; 4), 4 (ip_v &gt; 4), 5 (ip_len &lt; packetsize, long packets), 6 (ip_len &gt; packet size, short packets), 7 (Zero length fragments), 8 (packet &gt; 64k after reassembly), 9 (IP offset with MSB set), 10 (ttl variations).</dd>
</dl>
<dl>
<dt>
<b>&#45;2</b></dt>
<dd>
Run IP test group #2.  This group of tests generates packets with the IP options constructed with invalid values given other packet characteristics. The point tests are: 1 (option length &gt; packet length), 2 (option length = 0).</dd>
</dl>
<dl>
<dt>
<b>&#45;3</b></dt>
<dd>
Run IP test group #3.  This group of tests generates packets with the ICMP header fields set to non-standard values.  The point tests are: 1 (ICMP types 0-31 &amp; 255), 2 (type 3 &amp; code 0 - 31), 3 (type 4 &amp; code 0, 127, 128, 255), 4 (type 5 &amp; code 0, 127, 128, 255), 5 (types 8-10,13-18 with codes 0, 127, 128 and 255), 6 (type 12 &amp; code 0, 127, 128, 129, 255) and 7 (type 3 &amp; codes 9-10, 13-14 and 17-18 - shortened packets).</dd>
</dl>
<dl>
<dt>
<b>&#45;4</b></dt>
<dd>
Run IP test group #4.  This group of tests generates packets with the UDP header fields set to non-standard values.  The point tests are: 1 (UDP length &gt; packet size), 2 (UDP length &lt; packetsize), 3 (sport = 0, 1, 32767, 32768, 65535), 4 (dport = 0, 1, 32767, 32768, 65535) and 5 (sizeof(struct ip) &lt;= MTU &lt;= sizeof(struct udphdr) + sizeof(struct ip)).</dd>
</dl>
<dl>
<dt>
<b>&#45;5</b></dt>
<dd>
Run IP test group #5.  This group of tests generates packets with the TCP header fields set to non-standard values.  The point tests are: 1 (TCP flags variations, all combinations), 2 (seq = 0, 0x7fffffff, 0x8000000, 0xa0000000, 0xffffffff),  3 (ack = 0, 0x7fffffff, 0x8000000, 0xa0000000, 0xffffffff), 4 (SYN packet with window of 0, 32768, 65535), 5 (set urgent pointer to 1, 0x7fff, 0x8000, 0xffff), 6 (data offset), 7 (sport = 0, 1, 32767, 32768, 65535) and 8 (dport = 0, 1, 32767, 32768, 65535).</dd>
</dl>
<dl>
<dt>
<b>&#45;6</b></dt>
<dd>
Run IP test group #6.  This test generates a large number of fragments in an attempt to exhaust the network buffers used for holding packets for later reassembly.  WARNING: this may crash or cause serious performance degradation to the target host.</dd>
</dl>
<dl>
<dt>
<b>&#45;7</b></dt>
<dd>
Run IP test group #7.  This test generates 1024 random IP packets with only the IP version, checksum, length and IP offset field correct.</dd>
</dl>
<dl>
<dt>
<b>&#45;d</b>&#8194;&lt;interface&gt;</dt>
<dd>
Set the interface name to be the name supplied.</dd>
</dl>
<dl>
<dt>
<b>&#45;g</b>&#8194;&lt;gateway&gt;</dt>
<dd>
Specify the hostname of the gateway through which to route packets.  This is required whenever the destination host isn't directly attached to the same network as the host from which you're sending.</dd>
</dl>
<dl>
<dt>
<b>&#45;m</b>&#8194;&lt;MTU&gt;</dt>
<dd>
Specify the MTU to be used when sending out packets.  This option allows you to set a fake MTU, allowing the simulation of network interfaces with small MTU's without setting them so.</dd>
</dl>
<dl>
<dt>
<b>&#45;p &lt;test&gt;</b></dt>
<dd>
Run a...</dd>
</dl>
</div>
<div class="section">
<h1>SEE ALSO</h1> ipresend(1), ipsend(1), bpf(4), ipsend(5)</div>
<div class="section">
<h1>DIAGNOSTICS</h1> Only one of the numeric test options may be given when  <i>iptest</i> is run.<p>
Needs to be run as root.</div>
<div class="section">
<h1>BUGS</h1> If you find any, please send email to me at darrenr@pobox.com</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
</td>
<td class="foot-os" align="right">
</td>
</tr>
</table>
</div>
</body>
<>

