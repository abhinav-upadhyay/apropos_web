<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
NBSVTOOL(1)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
NBSVTOOL(1)</td>
<td class="head-vol" align="center">
General Commands Manual</td>
<td class="head-rtitle" align="right">
NBSVTOOL(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">nbsvtool</b> &#8212; <span class="desc">create and verify detached signatures of files</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 8.00ex;">
<col>
<tbody>
<tr>
<td>
nbsvtool</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;v</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;a</b> <i class="arg">anchor-certificates</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;c</b> <i class="arg">certificate-chain</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;f</b> <i class="arg">certificate-file</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;k</b> <i class="arg">private-key-file</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;u</b> <i class="arg">required-key-usage</i></span>&#93; <i class="arg">command</i> <i class="arg">args ...</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">nbsvtool</b> is used to create and verify detached X509 signatures of files. Private keys and certificates are expected to be PEM encoded, signatures are in PEM/SMIME format.<p>
Supported commands:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
sign <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 32.00ex;">
Sign <i class="arg">file</i>, placing the signature in <i class="arg">file</i><i class="file">.sp7</i>. The options <b class="flag">&#45;f</b> and <b class="flag">&#45;k</b> are required for this command.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
verify <i class="arg">file</i> &#91;<span class="opt"><i class="arg">signature</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 32.00ex;">
Verify signature for <i class="arg">file</i>. If <i class="arg">signature</i> is not specified, <i class="arg">file</i><i class="file">.sp7</i> is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
verify-code <i class="arg">file</i> &#91;<span class="opt"><i class="arg">signature</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 32.00ex;">
This is a short cut for verify with the option <b class="flag">&#45;u</b> code.</dd>
</dl>
<p>
Supported options:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;a</b> <i class="arg">anchor-certificates</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
A file containing one or more (concatenated) keys that are considered trusted.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;c</b> <i class="arg">certificate-chain</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
A file containing additional certificates that will be added to the signature when creating one. They will be used to fill missing links in the trust chain when verifying the signature.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;f</b> <i class="arg">certificate-file</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
A file containing the certificate to use for signing. The certificate must match the key given by <b class="flag">&#45;k</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;k</b> <i class="arg">private-key-file</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
A file containing the private key to use for signing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;u</b> <i class="arg">required-key-usage</i></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
Verify that the extended key-usage attribute in the signing certificate matches <i class="arg">required-key-usage</i>. Otherwise, the signature is rejected. <i class="arg">key usage</i> can be one of: &#8220;ssl-server&#8221;, &#8220;ssl-client&#8221;, &#8220;code&#8221;, or &#8220;smime&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b></dt>
<dd class="list-tag" style="margin-left: 28.00ex;">
Print verbose information about the signing certificate.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558495420535441545553">EXIT STATUS</h1> The <b class="utility">nbsvtool</b> utility exits 0 on success, and &gt;0 if an error occurs.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Create signature file <i class="file">hello.sp7</i> for file <i class="file">hello</i>. The private key is found in file <i class="file">key</i>, the matching certificate is in <i class="file">cert</i>, additional certificates from <i class="file">cert-chain</i> are included in the created signature.<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">nbsvtool -k key -f cert -c cert-chain sign hello hello.sp7</code></div>
</blockquote>
<p>
Verify that the signature <i class="file">hello.sp7</i> is valid for file <i class="file">hello</i> and that the signing certificate allows code signing. Certificates in <i class="file">anchor-file</i> are considered trusted, and there must be a certificate chain from one of those certificates to the signing certificate.<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">nbsvtool -a anchor-file verify-code hello hello.sp7</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/openssl_smime">openssl_smime(1)</a></div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> As there is currently no default trust anchor, you must explicilty specify one with <b class="flag">&#45;a</b>, otherwise no verification can succeed.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
March 11, 2009</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

