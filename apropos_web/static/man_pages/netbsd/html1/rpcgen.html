<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
RPCGEN(1)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
RPCGEN(1)</td>
<td class="head-vol" align="center">
General Commands Manual</td>
<td class="head-rtitle" align="right">
RPCGEN(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">rpcgen</b> &#8212; <span class="desc">Remote Procedure Call (RPC) protocol compiler</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 6.00ex;">
<col>
<tbody>
<tr>
<td>
rpcgen</td>
<td>
<i class="arg">infile</i></td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 6.00ex;">
<col>
<tbody>
<tr>
<td>
rpcgen</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;AaBbILMNTv</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;D</b> <i class="arg">name</i> &#91;<span class="opt">=value</span>&#93;</span>&#93; &#91;<span class="opt"><b class="flag">&#45;i</b> <i class="arg">size</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;K</b> <i class="arg">secs</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;Y</b> <i class="arg">pathname</i></span>&#93; <i class="arg">infile</i></td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 6.00ex;">
<col>
<tbody>
<tr>
<td>
rpcgen</td>
<td>
<b class="flag">&#45;c</b> | <b class="flag">&#45;h</b> | <b class="flag">&#45;l</b> | <b class="flag">&#45;m</b> | <b class="flag">&#45;t</b> | <b class="flag">&#45;Sc</b> | <b class="flag">&#45;Ss</b> &#91;<span class="opt"><b class="flag">&#45;o</b> <i class="arg">outfile</i></span>&#93; &#91;<span class="opt"><i class="arg">infile</i></span>&#93;</td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 6.00ex;">
<col>
<tbody>
<tr>
<td>
rpcgen</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;s</b> <i class="arg">nettype</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;o</b> <i class="arg">outfile</i></span>&#93; &#91;<span class="opt"><i class="arg">infile</i></span>&#93;</td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 6.00ex;">
<col>
<tbody>
<tr>
<td>
rpcgen</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;n</b> <i class="arg">netid</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;o</b> <i class="arg">outfile</i></span>&#93; &#91;<span class="opt"><i class="arg">infile</i></span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">rpcgen</b> is a tool that generates C code to implement an RPC protocol. The input to <b class="name">rpcgen</b> is a language similar to C known as RPC Language (Remote Procedure Call Language). <b class="name">rpcgen</b> is normally used as in the first synopsis where it takes an input file and generates up to four output files. If the <i class="arg">infile</i> is named <i class="file">proto.x</i>, then <b class="name">rpcgen</b> will generate a header file in <i class="file">proto.h</i>, XDR routines in <i class="file">proto_xdr.c</i>, server-side stubs in <i class="file">proto_svc.c</i>, and client-side stubs in <i class="file">proto_clnt.c</i>. With the <b class="flag">&#45;T</b> option, it will also generate the RPC dispatch table in <i class="file">proto_tbl.i</i>. With the <b class="flag">&#45;Sc</b> option, it will also generate sample code which would illustrate how to use the remote procedures on the client side. This code would be created in <i class="file">proto_client.c</i>. With the <b class="flag">&#45;Ss</b> option, it will also generate a sample server code which would illustrate how to write the remote procedures. This code would be created in <i class="file">proto_server.c</i>.<p>
The server created can be started both by the port monitors (for example, <span class="emph">inetd</span> or <span class="emph">listen</span>) or by itself. When it is started by a port monitor, it creates servers only for the transport for which the file descriptor 0 was passed. The name of the transport must be specified by setting up the environmental variable <span class="env">PM_TRANSPORT</span>. When the server generated by <b class="name">rpcgen</b> is executed, it creates server handles for all the transports specified in <span class="env">NETPATH</span> environment variable, or if it is unset, it creates server handles for all the visible transports from <i class="file">/etc/netconfig</i> file.<p>
<span class="emph">Note</span>: the transports are chosen at run time and not at compile time. When the server is self-started, it backgrounds itself by default. A special define symbol <span class="define">RPC_SVC_FG</span> can be used to run the server process in foreground.<p>
The second synopsis provides special features which allow for the creation of more sophisticated RPC servers. These features include support for user provided <code class="lit">#defines</code> and RPC dispatch tables. The entries in the RPC dispatch table contain:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-inset">
<dt class="list-inset" style="margin-top: 0.00em;">
+</dt>
<dd class="list-inset">
pointers to the service routine corresponding to that procedure,</dd>
<dt class="list-inset" style="margin-top: 0.00em;">
+</dt>
<dd class="list-inset">
a pointer to the input and output arguments,</dd>
<dt class="list-inset" style="margin-top: 0.00em;">
+</dt>
<dd class="list-inset">
the size of these routines</dd>
</dl>
<p>
A server can use the dispatch table to check authorization and then to execute the service routine; a client library may use it to deal with the details of storage management and XDR data conversion.<p>
The other three synopses shown above are used when one does not want to generate all the output files, but only a particular one. Some examples of their usage is described in the <i class="link-sec"><a class="link-sec" href="#x4558414d504c4553">EXAMPLES</a></i> section below. When <b class="name">rpcgen</b> is executed with the <b class="flag">&#45;s</b> option, it creates servers for that particular class of transports. When executed with the <b class="flag">&#45;n</b> option, it creates a server for the transport specified by <span class="emph">netid</span>. If <i class="arg">infile</i> is not specified, <b class="name">rpcgen</b> accepts the standard input.<p>
The C preprocessor, <a class="link-man" href="../1/cpp">cpp(1)</a> is run on the input file before it is actually interpreted by <b class="name">rpcgen</b> For each type of output file, <b class="name">rpcgen</b> defines a special preprocessor symbol for use by the <b class="name">rpcgen</b> programmer:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">RPC_HDR</span></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
defined when compiling into header files</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">RPC_XDR</span></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
defined when compiling into XDR routines</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">RPC_SVC</span></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
defined when compiling into server-side stubs</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">RPC_CLNT</span></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
defined when compiling into client-side stubs</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">RPC_TBL</span></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
defined when compiling into RPC dispatch tables</dd>
</dl>
<p>
Any line beginning with &#8216;%&#8217; is passed directly into the output file, uninterpreted by <b class="name">rpcgen</b>.<p>
For every data type referred to in <i class="arg">infile</i> <b class="name">rpcgen</b> assumes that there exists a routine with the string &#8220;xdr_&#8221; prepended to the name of the data type. If this routine does not exist in the RPC/XDR library, it must be provided. Providing an undefined data type allows customization of XDR routines.</div>
<div class="section">
<h1 id="x4f5054494f4e53">OPTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;A</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate an <b class="fname">svc_caller</b>() function.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;a</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate all the files including sample code for client and server side.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;B</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate BSD cplusplus macros (__BEGIN_DECLS, __END_DECLS).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;b</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Compile stubs in "backwards compatible" mode, disabling support for transport-independent RPC. The <b class="flag">&#45;b</b> should always be specified when generating files for <span class="unix">NetBSD</span>, since there is no transport-independent RPC support in <span class="unix">NetBSD</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;c</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Compile into XDR routines.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;D</b> <i class="arg">name</i>&#91;<span class="opt"><i class="arg">=value</i></span>&#93;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Define a symbol <span class="define">name</span>. Equivalent to the <span class="define">#define</span> directive in the source. If no <span class="define">value</span> is given, <span class="define">value</span> is defined as 1. This option may be specified more than once.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;h</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Compile into C data-definitions (a header file). The <b class="flag">&#45;T</b> option can be used in conjunction to produce a header file which supports RPC dispatch tables.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;I</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Support <a class="link-man" href="../8/inetd">inetd(8)</a> in the server side stubs. Servers generated using this flag can either be standalone or started from <a class="link-man" href="../8/inetd">inetd(8)</a>. If a server is started as standalone, then it places itself in the background, unless <span class="define">RCP_SVC_FG</span> is defined, or the server is compiled without <b class="flag">&#45;I</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;i</b> <i class="arg">size</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Size to decide when to start generating inline code. The default size is 3.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;K</b> <i class="arg">secs</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default, services created using <b class="name">rpcgen</b> wait 120 seconds after servicing a request before exiting. That interval can be changed using the <b class="flag">&#45;K</b> flag. To create a server that exits immediately upon servicing a request, &#8220;<b class="flag">&#45;K</b> 0&#8221; can be used. To create a server that never exits, the appropriate argument is &#8220;<b class="flag">&#45;K</b> -1&#8221;.<p>
When monitoring for a server, some port monitors, like the AT&amp;T System&#160;V Release&#160;4 UNIX utility <b class="cmd">listen</b>, <span class="emph">always</span> spawn a new process in response to a service request. If it is known that a server will be used with such a monitor, the server should exit immediately on completion. For such servers, <b class="name">rpcgen</b> should be used with &#8220;<b class="flag">&#45;K</b> -1&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;L</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Server errors will be sent to syslog instead of stderr.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;l</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Compile into client-side stubs. <a class="link-man" href="../8/inetd">inetd(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;M</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate thread-safe stubs. This alters the calling pattern of client and server stubs so that storage for results is allocated by the caller. Note that all components for a particular service (stubs, client and service wrappers, etc.) must be built either with or without the <b class="flag">&#45;M</b> flag.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;m</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Compile into server-side stubs, but do not generate a <b class="fname">main</b>() routine. This option is useful for doing callback-routines and for users who need to write their own <b class="fname">main</b>() routine to do initialization.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;N</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the newstyle of <b class="name">rpcgen</b>. This allows procedures to have multiple arguments. It also uses the style of parameter passing that closely resembles C. So, when passing an argument to a remote procedure you do not have to pass a pointer to the argument but the argument itself. This behaviour is different from the oldstyle of <b class="name">rpcgen</b> generated code. The newstyle is not the default case because of backward compatibility.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;n</b> <i class="arg">netid</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Compile into server-side stubs for the transport specified by <i class="arg">netid</i>. There should be an entry for <i class="arg">netid</i> in the netconfig database. This option may be specified more than once, so as to compile a server that serves multiple transports.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;o</b> <i class="arg">outfile</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the name of the output file. If none is specified, standard output is used (<b class="flag">&#45;c</b> <b class="flag">&#45;h</b> <b class="flag">&#45;l</b> <b class="flag">&#45;m</b> <b class="flag">&#45;n</b> <b class="flag">&#45;s</b> modes only)</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b> <i class="arg">nettype</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Compile into server-side stubs for all the transports belonging to the class <i class="arg">nettype</i>. The supported classes are <span class="emph">netpath</span>, <span class="emph">visible</span>, <span class="emph">circuit_n</span>, <span class="emph">circuit_v</span>, <span class="emph">datagram_n</span>, <span class="emph">datagram_v</span>, <span class="emph">tcp</span>, and <span class="emph">udp</span> [see <a class="link-man" href="../3/rpc">rpc(3)</a> for the meanings associated with these classes. <span class="emph">Note</span>: <span class="unix">BSD</span> currently supports only the <span class="emph">tcp</span> and <span class="emph">udp</span> classes]. This option may be specified more than once. <span class="emph">Note</span>: the transports are chosen at run time and not at compile time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;Sc</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate sample code to show the use of remote procedure and how to bind to the server before calling the client side stubs generated by <b class="name">rpcgen</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;Ss</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate skeleton code for the remote procedures on the server side. You would need to fill in the actual code for the remote procedures.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;T</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate the code to support RPC dispatch tables.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;t</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Compile into RPC dispatch table.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Display the version number.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;Y</b> <i class="arg">pathname</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the directory where <b class="name">rpcgen</b> looks for the C pre-processor.</dd>
</dl>
<p>
The options <b class="flag">&#45;c</b>, <b class="flag">&#45;h</b>, <b class="flag">&#45;l</b>, <b class="flag">&#45;m</b>, <b class="flag">&#45;s</b>, and <b class="flag">&#45;t</b> are used exclusively to generate a particular type of file, while the options <b class="flag">&#45;D</b> and <b class="flag">&#45;T</b> are global and can be used with the other options.</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1> If the <span class="env">RPCGEN_CPP</span> environment variable is set, its value is used as the pathname of the C preprocessor to be run on the input file.</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1> The RPC Language does not support nesting of structures. As a work-around, structures can be declared at the top-level, and their name used inside other structures in order to achieve the same effect.<p>
Name clashes can occur when using program definitions, since the apparent scoping does not really apply. Most of these can be avoided by giving unique names for programs, versions, procedures and types.<p>
The server code generated with <b class="flag">&#45;n</b> option refers to the transport indicated by <span class="emph">netid</span> and hence is very site specific.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The command<p>
<pre style="margin-left: 5.00ex;" class="lit display">
$ rpcgen -T prot.x</pre>
<p>
generates the five files: <i class="file">prot.h</i>, <i class="file">prot_clnt.c</i>, <i class="file">prot_svc.c</i>, <i class="file">prot_xdr.c</i> and <i class="file">prot_tbl.i</i>.<p>
The following example sends the C data-definitions (header file) to standard output.<p>
<pre style="margin-left: 5.00ex;" class="lit display">
$ rpcgen -h prot.x</pre>
<p>
To send the test version of the <span class="define">-DTEST</span>, server side stubs for all the transport belonging to the class <span class="emph">datagram_n</span> to standard output, use:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
$ rpcgen -s datagram_n -DTEST prot.x</pre>
<p>
To create the server side stubs for the transport indicated by <span class="emph">netid</span> <span class="emph">tcp</span>, use:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
$ rpcgen -n tcp -o prot_svc.c prot.x</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/cpp">cpp(1)</a>, <a class="link-man" href="../8/inetd">inetd(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="flag">&#45;M</b> option was first implemented in RedHat Linux, and was reimplemented by Charles M. Hannum in <span class="unix">NetBSD&#160;1.6</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 14, 2013</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

