<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
ATF-RUN(1)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
ATF-RUN(1)</td>
<td class="head-vol" align="center">
General Commands Manual</td>
<td class="head-rtitle" align="right">
ATF-RUN(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">atf-run</b> &#8212; <span class="desc">executes a collection of test programs</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 7.00ex;">
<col>
<tbody>
<tr>
<td>
atf-run</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;v</b> <i class="arg">var1=value1</i> &#91;<span class="opt">.. <b class="flag">&#45;v</b> <i class="arg">varN=valueN</i></span>&#93;</span>&#93; &#91;<span class="opt"><i class="arg">test_program1</i> &#91;<span class="opt"><i class="arg">.. test_programN</i></span>&#93;</span>&#93;</td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 7.00ex;">
<col>
<tbody>
<tr>
<td>
atf-run</td>
<td>
<b class="flag">&#45;h</b></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">atf-run</b> executes a collection of test programs or, in other words, a complete test suite. The results of each test program are collected by the tool, and are then multiplexed into a single machine-parseable report; see <a class="link-man" href="../html5/atf-formats.html">atf-formats(5)</a> for more details. This report can later be transformed into many different and saner formats using the <b class="name">atf-report</b> tool.<p>
The list of test programs to execute is read from an <i class="file">Atffile</i> present in the current directory. This file describes the test suite stored in the directory it lives in, which aside from the list of test programs also includes meta-data and configuration variables.<p>
<b class="name">atf-run</b> is also in charge of reading the configuration files that tune the behavior of each test program and passing down the necessary variables to them. More details on how this is done are given in the <i class="link-sec"><a class="link-sec" href="#x436f6e66696775726174696f6e">Configuration</a></i> section.<p>
In the first synopsis form, <b class="name">atf-run</b> parses the <i class="file">Atffile</i> in the current directory and runs all the test programs specified in it. If any test program names are given as part of the command line, those are the ones executed instead of the complete list.<p>
In the second synopsis form, <b class="name">atf-run</b> will print information about all supported options and their purpose.<p>
The following options are available:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;h</b></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Shows a short summary of all available options and their purpose.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b> <i class="arg">var=value</i></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Sets the configuration variable <i class="arg">var</i> to the given value <i class="arg">value</i>.</dd>
</dl>
<div class="subsection">
<h2 id="x436f6e66696775726174696f6e">Configuration</h2> <b class="name">atf-run</b> reads configuration data from multiple places. After all of these places have been analyzed, a list of variable-value pairs are passed to the test programs to be run.<p>
The following locations are scanned for configuration data, in order. Items down the list override values defined above them:<ol style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-enum">
<li class="list-enum" style="margin-top: 1.00em;">
Configuration variables defined in the <i class="file">Atffile</i>.</li>
<li class="list-enum" style="margin-top: 1.00em;">
Configuration variables defined in the system-wide configuration file shared among all test suites. This lives in <i class="file">${ATF_CONFDIR}/common.conf</i>.</li>
<li class="list-enum" style="margin-top: 1.00em;">
Configuration variables defined in the system-wide test-suite-specific configuration file. This lives in <i class="file">${ATF_CONFDIR}/&lt;test-suite&gt;.conf</i>.</li>
<li class="list-enum" style="margin-top: 1.00em;">
Configuration variables defined in the user-specific configuration file shared among all test suites. This lives in <i class="file">${HOME}/.atf/common.conf</i>.</li>
<li class="list-enum" style="margin-top: 1.00em;">
Configuration variables defined in the user-specific test-suite-specific configuration file. This lives in <i class="file">${HOME}/.atf/&lt;test-suite&gt;.conf</i>.</li>
<li class="list-enum" style="margin-top: 1.00em;">
Configuration variables provided as part of the command line through the <b class="flag">&#45;v</b> option.</li>
</ol>
<p>
The value of <b class="var">ATF_CONFDIR</b> in the above list determined as detailed in <a class="link-man" href="../html1/atf-config.html">atf-config(1)</a>.<p>
The following configuration variables are globally recognized:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">unprivileged-user</b></dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
The name of the system user that atf-run will drop root privileges into for test cases defining &#8216;require.user=unprivileged&#8217;. Note that this is <span class="emph">not provided for security purposes</span>; this feature is only for the convenience of the user.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x486f6f6b73">Hooks</h2> <b class="name">atf-run</b>'s internal behavior can be customized by the system administrator and the user by means of hooks. These hooks are written in the shell script language for simplicity and are stored in the following files, which are read in the order provided below:<ol style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-enum">
<li class="list-enum" style="margin-top: 1.00em;">
${ATF_CONFDIR}/atf-run.hooks</li>
<li class="list-enum" style="margin-top: 1.00em;">
${HOME}/.atf/atf-run.hooks</li>
</ol>
<p>
The following hooks are supported:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
info_start_hook</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Called before <b class="name">atf-run</b> executes any test program. The purpose of this hook is to write additional &#8216;info&#8217; stanzas to the top of the output report; these are defined by the &#8216;application/X-atf-tps format&#8217; described in <a class="link-man" href="../html5/atf-formats.html">atf-formats(5)</a>. Always use the &#8216;atf_tps_writer_info&#8217; function to print these.<p>
This takes no parameters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
info_end_hook</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Similar to &#8216;info_start_hook&#8217; but executed after all test programs have been run so that additional &#8216;info&#8217; stanzas can be added to the bottom of the output report.<p>
This takes no parameters.</dd>
</dl>
<p>
All hooks are accompanied by a function named &#8216;default_&lt;hook_name&gt;&#8217; that can be executed by them to invoke the default behavior built into <b class="name">atf-run</b>. For example, in order to extend the default &#8216;info_start_hook&#8217; hook, we could write the following function:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
info_start_hook() 
{ 
    default_info_start_hook "${@}" 
 
    atf_tps_writer_info "uptime" "$(uptime)" 
}</pre>
</div>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/atf-report.html">atf-report(1)</a>, <a class="link-man" href="../html1/atf-test-program.html">atf-test-program(1)</a>, <a class="link-man" href="../html7/atf.html">atf(7)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
November 1, 2010</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

