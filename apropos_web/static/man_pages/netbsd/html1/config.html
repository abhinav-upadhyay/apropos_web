<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
CONFIG(1)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
CONFIG(1)</td>
<td class="head-vol" align="center">
General Commands Manual</td>
<td class="head-rtitle" align="right">
CONFIG(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">config</b> &#8212; <span class="desc">build kernel compilation directories</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 6.00ex;">
<col>
<tbody>
<tr>
<td>
config</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;MPpv</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;b</b> <i class="arg">builddir</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;D</b> <i class="arg">var=value</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;s</b> <i class="arg">srcdir</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;U</b> <i class="arg">value</i></span>&#93; &#91;<span class="opt"><i class="arg">config-file</i></span>&#93;</td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 6.00ex;">
<col>
<tbody>
<tr>
<td>
config</td>
<td>
<b class="flag">&#45;x</b> &#91;<span class="opt"><i class="arg">kernel-file</i></span>&#93;</td>
</tr>
</tbody>
</table>
<br>
<table class="synopsis">
<col style="width: 6.00ex;">
<col>
<tbody>
<tr>
<td>
config</td>
<td>
<b class="flag">&#45;L</b> &#91;<span class="opt"><b class="flag">&#45;v</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;s</b> <i class="arg">srcdir</i></span>&#93; &#91;<span class="opt"><i class="arg">config-file</i></span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> In its first synopsis form, <b class="name">config</b> creates a kernel build directory from the machine description file <i class="arg">config-file</i>, which describes the system to configure. Refer to section <i class="link-sec"><a class="link-sec" href="#x4b45524e454c204255494c4420434f4e46494755524154494f4e">KERNEL BUILD CONFIGURATION</a></i> for the details of that use of <b class="name">config</b>.<p>
In its second synopsis form, <b class="name">config</b> takes the binary kernel <i class="arg">kernel-file</i> as its single argument (aside from the mandatory <b class="flag">&#45;x</b> flag), then extracts the embedded configuration file (if any) and writes it to standard output. If <i class="arg">kernel-file</i> is not given, and the system is not running <span class="unix">NetBSD</span> an error is printed. On systems running <span class="unix">NetBSD</span> the booted kernel is looked up using the <a class="link-man" href="../3/sysctl">sysctl(3)</a> variable <span class="define">machdep.booted_kernel</span> and if that is not found, <span class="define">_PATH_UNIX</span> (<i class="file">/netbsd</i>) is used. Configuration data will be available if the given kernel was compiled with either <b class="var">INCLUDE_CONFIG_FILE</b> or <b class="var">INCLUDE_JUST_CONFIG</b> options.<p>
In its third synopsis form, <b class="name">config</b> is a tool for the kernel developer and generates a &#8220;lint&#8221; configuration file to be used during regression testing. Refer to section <i class="link-sec"><a class="link-sec" href="#x4c494e5420434f4e46494755524154494f4e">LINT CONFIGURATION</a></i> for the details of that use of <b class="name">config</b>.<p>
<b class="name">config</b> accepts the following parameters:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;b</b> <i class="arg">builddir</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use <i class="arg">builddir</i> as the kernel build directory, instead of computing and creating one automatically.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;D</b> <i class="arg">var=value</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Define a makeoptions variable to the given value. This is equivalent to appending a <code class="lit">makeoptions var=value</code> line to the config file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;L</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate a lint configuration. See section <i class="link-sec"><a class="link-sec" href="#x4c494e5420434f4e46494755524154494f4e">LINT CONFIGURATION</a></i> for details.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;M</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Do modular build (experimental). Instead of linking all object files (*.o) at once, collect related object files into an intermediate relocatable object (*.ko), then link those *.ko files into the final kernel. This changes the order of objects in the kernel binary.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;P</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Pack locators to save space in the resulting kernel binary. The amount of space saved that way is so small that this option should be considered historical, and of no actual use.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;p</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate a build directory suited for kernel profiling. However, this options should be avoided in favor of the relevant options inside the configuration file as described in section <i class="link-sec"><a class="link-sec" href="#x4b45524e454c204255494c4420434f4e46494755524154494f4e">KERNEL BUILD CONFIGURATION</a></i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;s</b> <i class="arg">srcdir</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Point to the top of the kernel source tree. It must be an absolute path when <b class="name">config</b> is used to prepare a kernel build directory, but can be relative when it is used in combination with the <b class="flag">&#45;L</b> flag.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;U</b> <i class="arg">var</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Undefine the makeoption <i class="arg">var</i>. This is equivalent to appending the line <code class="lit">no makeoptions var</code> to the config file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Increase verbosity by enabling some more warnings.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;x</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Extract the configuration embedded in a kernel binary.</dd>
</dl>
<div class="subsection">
<h2 id="x4b45524e454c204255494c4420434f4e46494755524154494f4e">KERNEL BUILD CONFIGURATION</h2> There are several different ways to run the <b class="name">config</b> program. The traditional way is to run <b class="name">config</b> from the <i class="file">conf</i> subdirectory of the machine-specific directory of the system source (usually <i class="file">/sys/arch/MACHINE/conf</i>, where <i class="file">MACHINE</i> is one of <i class="file">vax</i>, <i class="file">hp300</i>, and so forth), and to specify as the <i class="arg">config-file</i> the name of a machine description file located in that directory. <b class="name">config</b> will by default create files in the directory <i class="file">../compile/SYSTEMNAME</i>, where <i class="file">SYSTEMNAME</i> is the last path component of <i class="arg">config-file</i>. <b class="name">config</b> will assume that the top-level kernel source directory is located four directories above the build directory.<p>
Another way is to create the build directory yourself, place the machine description file in the build directory with the name <i class="file">CONFIG</i>, and run <b class="name">config</b> from within the build directory without specifying a <i class="arg">config-file</i>. <b class="name">config</b> will then by default create files in the current directory. If you run <b class="name">config</b> this way, you must specify the location of the top-level kernel source directory using the <b class="flag">&#45;s</b> option or by using the &#8220;<code class="lit">source</code>&#8221; directive at the beginning of the machine description file.<p>
Finally, you can specify the build directory for <b class="name">config</b> and run it from anywhere. You can specify a build directory with the <b class="flag">&#45;b</b> option or by using the &#8220;<code class="lit">build</code>&#8221; directive at the beginning of the machine description file. You must specify the location of the top-level kernel source directory if you specify a build directory.<p>
If <i class="arg">config-file</i> is a binary kernel, <b class="name">config</b> will try to extract the configuration file embedded into it, which will be present if that kernel was built either with <b class="var">INCLUDE_CONFIG_FILE</b> or <b class="var">INCLUDE_JUST_CONFIG</b> options. This work mode requires you to manually specify a build directory with the <b class="flag">&#45;b</b> option, which implies the need to provide a source tree too.<p>
If the <b class="flag">&#45;p</b> option is supplied, <i class="file">.PROF</i> is appended to the default compilation directory name, and <b class="name">config</b> acts as if the lines &#8220;<code class="lit">makeoptions PROF="-pg"</code>&#8221; and &#8220;<code class="lit">options GPROF</code>&#8221; appeared in the machine description file. This will build a system that includes profiling code; see <a class="link-man" href="../8/kgmon">kgmon(8)</a> and <a class="link-man" href="../1/gprof">gprof(1)</a>. The <b class="flag">&#45;p</b> flag is expected to be used for &#8220;one-shot&#8221; profiles of existing systems; for regular profiling, it is probably wiser to create a separate machine description file containing the <code class="lit">makeoptions</code> line.<p>
The old undocumented <b class="flag">&#45;g</b> flag is no longer supported. Instead, use &#8220;<code class="lit">makeoptions DEBUG="-g"</code>&#8221; and (typically) &#8220;<code class="lit">options KGDB</code>&#8221;.<p>
The output of <b class="name">config</b> consists of a number of files, principally <i class="file">ioconf.c</i>, a description of I/O devices that may be attached to the system; and a <i class="file">Makefile</i>, used by <a class="link-man" href="../1/make">make(1)</a> in building the kernel.<p>
After running <b class="name">config</b>, it is wise to run &#8220;<code class="lit">make depend</code>&#8221; in the directory where the new makefile was created. <b class="name">config</b> prints a reminder of this when it completes.<p>
If <b class="name">config</b> stops due to errors, the problems reported should be corrected and <b class="name">config</b> should be run again. <b class="name">config</b> attempts to avoid changing the compilation directory if there are configuration errors, but this code is not well-tested, and some problems (such as running out of disk space) are unrecoverable.</div>
<div class="subsection">
<h2 id="x4c494e5420434f4e46494755524154494f4e">LINT CONFIGURATION</h2> A so-called &#8220;lint&#8221; configuration should include everything from the kernel that can possibly be selected. The rationale is to provide a way to reach all the code a user might select, in order to make sure all options and drivers compile without error for a given source tree.<p>
When used with the <b class="flag">&#45;L</b> flag, <b class="name">config</b> takes the regular configuration file <i class="arg">config-file</i> and prints on the standard output a configuration file that includes <i class="arg">config-file</i>, selects all options and file-systems the user can possibly select, and defines an instance of every possible attachment as described by the kernel option definition files used by <i class="arg">config-file</i>.<p>
The resulting configuration file is meant as a way to select all possible features in order to test that each of them compiles. It is not meant to result in a kernel binary that can run on any hardware.<p>
Unlike the first synopsis form, the provided <i class="arg">srcdir</i> is relative to the current working directory. In the first synopsis form, it is relative to the build directory.</div>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> The SYNOPSIS portion of each device in section 4.<p>
<a class="link-man" href="../4/options">options(4)</a>, <a class="link-man" href="../5/config">config(5)</a>, <a class="link-man" href="../9/config">config(9)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">config</b> command appeared in <span class="unix">4.1BSD</span>. It was completely revised in <span class="unix">4.4BSD</span>. The <b class="flag">&#45;x</b> option appeared in <span class="unix">NetBSD&#160;2.0</span>. The <b class="flag">&#45;L</b> option appeared in <span class="unix">NetBSD&#160;5.0</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
October 10, 2014</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

