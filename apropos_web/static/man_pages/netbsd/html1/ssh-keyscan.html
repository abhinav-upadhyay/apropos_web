<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
SSH-KEYSCAN(1)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
SSH-KEYSCAN(1)</td>
<td class="head-vol" align="center">
General Commands Manual</td>
<td class="head-rtitle" align="right">
SSH-KEYSCAN(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">ssh-keyscan</b> &#8212; <span class="desc">gather ssh public keys</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 11.00ex;">
<col>
<tbody>
<tr>
<td>
ssh-keyscan</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;46Hv</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;f</b>&#160;<i class="arg">file</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;p</b>&#160;<i class="arg">port</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;T</b>&#160;<i class="arg">timeout</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;t</b>&#160;<i class="arg">type</i></span>&#93; &#91;<span class="opt"><i class="arg">host</i>&#160;|&#160;<i class="arg">addrlist&#160;namelist</i></span>&#93;&#160;<i class="arg">...</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">ssh-keyscan</b> is a utility for gathering the public ssh host keys of a number of hosts. It was designed to aid in building and verifying <i class="file">ssh_known_hosts</i> files. <b class="name">ssh-keyscan</b> provides a minimal interface suitable for use by shell and perl scripts.<p>
<b class="name">ssh-keyscan</b> uses non-blocking socket I/O to contact as many hosts as possible in parallel, so it is very efficient. The keys from a domain of 1,000 hosts can be collected in tens of seconds, even when some of those hosts are down or do not run ssh. For scanning, one does not need login access to the machines that are being scanned, nor does the scanning process involve any encryption.<p>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;4</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Forces <b class="name">ssh-keyscan</b> to use IPv4 addresses only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;6</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Forces <b class="name">ssh-keyscan</b> to use IPv6 addresses only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;f</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Read hosts or &#8220;addrlist namelist&#8221; pairs from <i class="arg">file</i>, one per line. If <i class="file">-</i> is supplied instead of a filename, <b class="name">ssh-keyscan</b> will read hosts or &#8220;addrlist namelist&#8221; pairs from the standard input.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;H</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Hash all hostnames and addresses in the output. Hashed names may be used normally by <b class="name">ssh</b> and <b class="name">sshd</b>, but they do not reveal identifying information should the file's contents be disclosed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;p</b> <i class="arg">port</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Port to connect to on the remote host.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;T</b> <i class="arg">timeout</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Set the timeout for connection attempts. If <i class="arg">timeout</i> seconds have elapsed since a connection was initiated to a host or since the last time anything was read from that host, then the connection is closed and the host in question considered unavailable. Default is 5 seconds.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;t</b> <i class="arg">type</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the type of the key to fetch from the scanned hosts. The possible values are &#8220;rsa1&#8221; for protocol version 1 and &#8220;dsa&#8221;, &#8220;ecdsa&#8221;, &#8220;ed25519&#8221;, or &#8220;rsa&#8221; for protocol version 2. Multiple values may be specified by separating them with commas. The default is to fetch &#8220;rsa&#8221;, &#8220;ecdsa&#8221;, and &#8220;ed25519&#8221; keys.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;v</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Verbose mode. Causes <b class="name">ssh-keyscan</b> to print debugging messages about its progress.</dd>
</dl>
</div>
<div class="section">
<h1 id="x5345435552495459">SECURITY</h1> If an ssh_known_hosts file is constructed using <b class="name">ssh-keyscan</b> without verifying the keys, users will be vulnerable to <span class="emph">man in the middle</span> attacks. On the other hand, if the security model allows such a risk, <b class="name">ssh-keyscan</b> can help in the detection of tampered keyfiles or man in the middle attacks which have begun after the ssh_known_hosts file was created.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1> Input format:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
1.2.3.4,1.2.4.4 name.my.domain,name,n.my.domain,n,1.2.3.4,1.2.4.4</pre>
<p>
Output format for RSA1 keys:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
host-or-namelist bits exponent modulus</pre>
<p>
Output format for RSA, DSA, ECDSA, and Ed25519 keys:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
host-or-namelist keytype base64-encoded-key</pre>
<p>
Where <i class="arg">keytype</i> is either &#8220;ecdsa-sha2-nistp256&#8221;, &#8220;ecdsa-sha2-nistp384&#8221;, &#8220;ecdsa-sha2-nistp521&#8221;, &#8220;ssh-ed25519&#8221;, &#8220;ssh-dss&#8221; or &#8220;ssh-rsa&#8221;.<p>
<i class="file">/etc/ssh/ssh_known_hosts</i></div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Print the rsa host key for machine <i class="arg">hostname</i>:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
$ ssh-keyscan hostname</pre>
<p>
Find all hosts from the file <i class="file">ssh_hosts</i> which have new or different keys from those in the sorted file <i class="file">ssh_known_hosts</i>:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
$ ssh-keyscan -t rsa,dsa,ecdsa,ed25519 -f ssh_hosts | &#92; 
	sort -u - ssh_known_hosts | diff ssh_known_hosts -</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/ssh">ssh(1)</a>, <a class="link-man" href="../8/sshd">sshd(8)</a></div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author"></span><span class="author">David Mazieres</span> &#60;<a class="link-mail" href="mailto:dm@lcs.mit.edu">dm@lcs.mit.edu</a>&#62; wrote the initial version, and <span class="author">Wayne Davison</span> &#60;<a class="link-mail" href="mailto:wayned@users.sourceforge.net">wayned@users.sourceforge.net</a>&#62; added support for protocol version 2.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> It generates "Connection closed by remote host" messages on the consoles of all the machines it scans if the server is older than version 2.9. This is because it opens a connection to the ssh port, reads the public key, and drops the connection as soon as it gets the key.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
August 30 2014</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

