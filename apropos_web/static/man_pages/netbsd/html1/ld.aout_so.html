<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
LD.AOUT_SO(1)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
LD.AOUT_SO(1)</td>
<td class="head-vol" align="center">
General Commands Manual</td>
<td class="head-rtitle" align="right">
LD.AOUT_SO(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">ld.aout_so</b> &#8212; <span class="desc">run-time link-editor</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">ld.aout_so</b> is a self-contained, position independent program image providing run-time support for loading and link-editing shared objects into a process' address space. It uses the data structures (see <a class="link-man" href="../html5/link.html">link(5)</a>) contained within dynamically linked programs to determine which shared libraries are needed and loads them at a convenient virtual address using the <a class="link-man" href="../html2/mmap.html">mmap(2)</a> system call.<p>
After all shared libraries have been successfully loaded, <b class="name">ld.aout_so</b> proceeds to resolve external references from both the main program and all objects loaded. A mechanism is provided for initialization routines to be called, on a per-object basis, giving a shared object an opportunity to perform any extra set-up, before execution of the program proper begins. <b class="name">ld.aout_so</b> looks for a symbol named <span class="emph">.init</span> in each object's symbol table. If present, this symbol is assumed to represent a C-function declared as <i class="ftype">void</i> <b class="fname">.init</b>(<i class="farg">void</i>), which is then called. Similarly, a <i class="ftype">void</i> <b class="fname">.fini</b>(<i class="farg">void</i>) function is called just before an object is unloaded from the process address space as a result of calling <a class="link-man" href="../html3/dlclose.html">dlclose(3)</a>. Note that while an object's <span class="emph">.init</span> is always called, whether the object is loaded automatically at program startup or programmatically by using <a class="link-man" href="../html3/dlopen.html">dlopen(3)</a>, the <span class="emph">.fini</span> function is called only on &#8216;last <a class="link-man" href="../html3/dlclose.html">dlclose(3)</a>&#8217;.<p>
This mechanism is exploited by the system-supplied C++ constructor initialization code located in <i class="file">/usr/lib/c++rt.o</i>. This file should be included in the list of object-code files passed to <a class="link-man" href="../html1/ld.html">ld(1)</a> when building a shared C++ library.<p>
<b class="name">ld.aout_so</b> is itself a shared object that is initially loaded by the startup module <span class="emph">crt0</span>. Since <a class="link-man" href="../html5/a.out.html">a.out(5)</a> formats do not provide easy access to the file header from within a running process, <span class="emph">crt0</span> uses the special symbol <b class="var">_DYNAMIC</b> to determine whether a program is in fact dynamically linked or not. Whenever the linker <a class="link-man" href="../html1/ld.html">ld(1)</a> has relocated this symbol to a location other than 0, <span class="emph">crt0</span> assumes the services of <b class="name">ld.aout_so</b> are needed (see <a class="link-man" href="../html5/link.html">link(5)</a> for details). <span class="emph">crt0</span> passes control to <b class="name">rtld</b>'s entry point before the program's <b class="fname">main</b>() routine is called. Thus, <b class="name">ld.aout_so</b> can complete the link-editing process before the dynamic program calls upon services of any dynamic library.<p>
To quickly locate the required shared objects in the filesystem, <b class="name">ld.aout_so</b> may use a &#8220;hints&#8221; file, prepared by the <a class="link-man" href="../html8/ldconfig.html">ldconfig(8)</a> utility, in which the full path specification of the shared objects can be looked up by hashing on the 3-tuple &#60;library-name, major-version-number, minor-version-number&#62;.<p>
<b class="name">ld.aout_so</b> recognizes a number of environment variables that can be used to modify its behavior as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">LD_LIBRARY_PATH</span></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
A colon separated list of directories, overriding the default search path for shared libraries.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">LD_PRELOAD</span></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
A colon separated list of shared object filenames to be loaded <span class="emph">after</span> the main program but <span class="emph">before</span> its shared object dependencies.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">LD_WARN_NON_PURE_CODE</span></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
When set, issue a warning whenever a link-editing operation requires modification of the text segment of some loaded object. This is usually indicative of an incorrectly built library.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">LD_SUPPRESS_WARNINGS</span></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
When set, no warning messages of any kind are issued. Normally, a warning is given if satisfactorily versioned library could not be found.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">LD_TRACE_LOADED_OBJECTS</span></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
When set, causes <b class="name">ld.aout_so</b> to exit after loading the shared objects and printing a summary which includes the absolute pathnames of all objects, to standard output.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">LD_TRACE_LOADED_OBJECTS_FMT1</span></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">LD_TRACE_LOADED_OBJECTS_FMT2</span></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
When set, these variables are interpreted as format strings a la <a class="link-man" href="../html3/printf.html">printf(3)</a> to customize the trace output and are used by <a class="link-man" href="../html1/ldd.html">ldd(1)</a>'s <b class="flag">&#45;f</b> option and allows <a class="link-man" href="../html1/ldd.html">ldd(1)</a> to be operated as a filter more conveniently. The following conversions can be used:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
%a</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The main program's name (also known as &#8220;__progname&#8221;).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%A</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The value of the environment variable <span class="env">LD_TRACE_LOADED_OBJECTS_PROGNAME</span></dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%o</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The library name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%m</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The library's major version number.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%n</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The library's minor version number.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%p</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The full pathname as determined by <b class="name">rtld</b>'s library search rules.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
%x</dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The library's load address.</dd>
</dl>
<p>
Additionally, <span class="symb">&#92;n</span> and <span class="symb">&#92;t</span> are recognized and have their usual meaning.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">LD_NO_INTERN_SEARCH</span></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
When set, <b class="name">ld.aout_so</b> does not process any internal search paths that were recorded in the executable.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">LD_NOSTD_PATH</span></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
When set, do not include a set of built-in standard directory paths for searching. This might be useful when running on a system with a completely non-standard filesystem layout.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/var/run/ld.so.hints</i></dt>
<dd class="list-tag" style="margin-left: 23.00ex;">
library location hints built by <a class="link-man" href="../html8/ldconfig.html">ldconfig(8)</a></dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/ld.html">ld(1)</a>, <a class="link-man" href="../html1/ld.elf_so.html">ld.elf_so(1)</a>, <a class="link-man" href="../html1/ld.so.html">ld.so(1)</a>, <a class="link-man" href="../html5/link.html">link(5)</a>, <a class="link-man" href="../html8/ldconfig.html">ldconfig(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The shared library model employed first appeared in SunOS 4.0.</div>
<div class="section">
<h1 id="x534543555249545920434f4e53494445524154494f4e53">SECURITY CONSIDERATIONS</h1> The environment variables <span class="env">LD_LIBRARY_PATH</span> and <span class="env">LD_PRELOAD</span> are not honored when executing in a set-user-ID or set-group-ID environment. This action is taken to prevent malicious substitution of shared object dependencies or interposition of symbols.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
January 1, 2011</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

