<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
BDES(1)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
BDES(1)</td>
<td class="head-vol" align="center">
General Commands Manual</td>
<td class="head-rtitle" align="right">
BDES(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">bdes</b> &#8212; <span class="desc">encrypt/decrypt using the Data Encryption Standard</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 4.00ex;">
<col>
<tbody>
<tr>
<td>
bdes</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;abdp</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;F</b> <i class="arg">N</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;f</b> <i class="arg">N</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;k</b> <i class="arg">key</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;m</b> <i class="arg">N</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;o</b> <i class="arg">N</i></span>&#93; &#91;<span class="opt"><b class="flag">&#45;v</b> <i class="arg">vector</i></span>&#93;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">bdes</b> implements all DES modes of operation described in FIPS PUB 81, including alternative cipher feedback mode and both authentication modes. <b class="name">bdes</b> reads from the standard input and writes to the standard output. By default, the input is encrypted using cipher block chaining mode. Using the same key for encryption and decryption preserves plain text.<p>
All modes but the electronic code book mode require an initialization vector; if none is supplied, the zero vector is used. If no <i class="arg">key</i> is specified on the command line, the user is prompted for one (see <a class="link-man" href="../3/getpass">getpass(3)</a> for more details).<p>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;a</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
The key and initialization vector strings are to be taken as ASCII, suppressing the special interpretation given to leading &#8220;0X&#8221;, &#8220;0x&#8221;, &#8220;0B&#8221;, and &#8220;0b&#8221; characters. This flag applies to <span class="emph">both</span> the key and initialization vector.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;b</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Use electronic code book mode. This is not recommended for messages longer than 8 bytes, as patterns in the input will show through to the output.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;d</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Decrypt the input.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;F</b> <i class="arg">N</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Use <i class="arg">N</i>-bit alternative cipher feedback mode. Currently <i class="arg">N</i> must be a multiple of 7 between 7 and 56 inclusive (this does not conform to the alternative CFB mode specification).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;f</b> <i class="arg">N</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Use <i class="arg">N</i>-bit cipher feedback mode. Currently <i class="arg">N</i> must be a multiple of 8 between 8 and 64 inclusive (this does not conform to the standard CFB mode specification).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;k</b> <i class="arg">key</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Use <i class="arg">key</i> as the cryptographic key.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;m</b> <i class="arg">N</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Compute a message authentication code (MAC) of <i class="arg">N</i> bits on the input. The value of <i class="arg">N</i> must be between 1 and 64 inclusive; if <i class="arg">N</i> is not a multiple of 8, enough 0 bits will be added to pad the MAC length to the nearest multiple of 8. Only the MAC is output. MACs are only available in cipher block chaining mode or in cipher feedback mode.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;o</b> <i class="arg">N</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Use <i class="arg">N</i>-bit output feedback mode. Currently <i class="arg">N</i> must be a multiple of 8 between 8 and 64 inclusive (this does not conform to the OFB mode specification).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;p</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Disable the resetting of the parity bit. This flag forces the parity bit of the key to be used as typed, rather than making each character be of odd parity. It is used only if the key is given in ASCII.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">&#45;v</b> <i class="arg">vector</i></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
Set the initialization vector to <i class="arg">vector</i>; the vector is interpreted in the same way as the key. The vector is ignored in electronic codebook mode. For best security, a different initialization vector should be used for each file.</dd>
</dl>
<p>
The key and initialization vector are taken as sequences of ASCII characters which are then mapped into their bit representations. If either begins with &#8220;0X&#8221; or &#8220;0x&#8221;, that one is taken as a sequence of hexadecimal digits indicating the bit pattern; if either begins with &#8220;0B&#8221; or &#8220;0b&#8221;, that one is taken as a sequence of binary digits indicating the bit pattern. In either case, only the leading 64 bits of the key or initialization vector are used, and if fewer than 64 bits are provided, enough 0 bits are appended to pad the key to 64 bits.<p>
According to the DES standard, the low-order bit of each character in the key string is deleted. Since most ASCII representations set the high-order bit to 0, simply deleting the low-order bit effectively reduces the size of the key space from 2**56 to 2**48 keys. To prevent this, the high-order bit must be a function depending in part upon the low-order bit; so, the high-order bit is set to whatever value gives odd parity. This preserves the key space size. Note this resetting of the parity bit is <span class="emph">not</span> done if the key is given in binary or hex, and can be disabled for ASCII keys as well.<p>
The DES is considered a very strong cryptosystem hobbled by a short key, and other than table lookup attacks, key search attacks, and Hellman's time-memory tradeoff (all of which are very expensive and time-consuming), no practical cryptanalytic methods for breaking the DES are known in the open literature. As of this writing, the best known cryptanalytic method is linear cryptanalysis, which requires an average of 2**43 known plaintext-ciphertext pairs to succeed. Unfortunately for the DES, key search attacks (requiring only a single known plaintext-ciphertext pair and trying 2**55 keys on average) are becoming practical.<p>
As with all cryptosystems, the choice of keys and key security remain the most vulnerable aspect of <b class="name">bdes</b>.</div>
<div class="section">
<h1 id="x494d504c454d454e544154494f4e204e4f544553">IMPLEMENTATION NOTES</h1> For implementors wishing to write software compatible with this program, the following notes are provided. This software is believed to be compatible with the implementation of the data encryption standard distributed by Sun Microsystems, Inc.<p>
In the ECB and CBC modes, plaintext is encrypted in units of 64 bits (8 bytes, also called a block). To ensure that the plaintext file is encrypted correctly, <b class="name">bdes</b> will (internally) append from 1 to 8 bytes, the last byte containing an integer stating how many bytes of that final block are from the plaintext file, and encrypt the resulting block. Hence, when decrypting, the last block may contain from 0 to 7 characters present in the plaintext file, and the last byte tells how many. Note that if during decryption the last byte of the file does not contain an integer between 0 and 7, either the file has been corrupted or an incorrect key has been given. A similar mechanism is used for the OFB and CFB modes, except that those simply require the length of the input to be a multiple of the mode size, and the final byte contains an integer between 0 and one less than the number of bytes being used as the mode. (This was another reason that the mode size must be a multiple of 8 for those modes.)<p>
Unlike Sun's implementation, unused bytes of that last block are not filled with random data, but instead contain what was in those byte positions in the preceding block. This is quicker and more portable, and does not weaken the encryption significantly.<p>
If the key is entered in ASCII, the parity bits of the key characters are set so that each key character is of odd parity. Unlike Sun's implementation, it is possible to enter binary or hexadecimal keys on the command line, and if this is done, the parity bits are <span class="emph">not</span> reset. This allows testing using arbitrary bit patterns as keys.<p>
The Sun implementation always uses an initialization vector of 0 (that is, all zeroes). By default, <b class="name">bdes</b> does too, but this may be changed from the command line.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/crypt">crypt(3)</a>, <a class="link-man" href="../3/getpass">getpass(3)</a><p>
<span class="ref"><span class="ref-title">Data Encryption Standard</span>, <span class="ref-rep">Federal Information Processing Standard #46</span>, <span class="ref-corp">National Bureau of Standards, U.S. Department of Commerce</span>, <span class="ref-date">January 1977</span>, <span class="ref-opt">Washington DC</span>.</span><p>
<span class="ref"><span class="ref-title">DES Modes of Operation</span>, <span class="ref-rep">Federal Information Processing Standard #81</span>, <span class="ref-corp">National Bureau of Standards, U.S. Department of Commerce</span>, <span class="ref-date">December 1980</span>, <span class="ref-opt">Washington DC</span>.</span><p>
<span class="ref"><span class="ref-auth">Dorothy Denning</span>, <span class="ref-title">Cryptography and Data Security</span>, <i class="ref-issue">Addison-Wesley Publishing Co.</i>, <span class="ref-date">1982</span>, <span class="ref-opt">Reading, MA</span>.</span><p>
<span class="ref"><span class="ref-auth">Matt Bishop</span>, <span class="ref-title">Implementation Notes on bdes(1)</span>, <span class="ref-rep">Technical Report PCS-TR-91-158</span>, <span class="ref-corp">Department of Mathematics and Computer Science, Dartmouth College</span>, <span class="ref-date">April 1991</span>, <span class="ref-opt">Hanover, NH 03755</span>.</span><p>
<span class="ref"><span class="ref-auth">M.J. Wiener</span>, <span class="ref-title">Efficient DES Key Search</span>, <span class="ref-rep">Technical Report 244</span>, <span class="ref-corp">School of Computer Science, Carleton University</span>, <span class="ref-date">May 1994</span>.</span><p>
<span class="ref"><span class="ref-auth">Bruce Schneier</span>, <span class="ref-title">Applied Cryptography (2nd edition)</span>, <i class="ref-issue">John Wiley &amp; Sons, Inc.</i>, <span class="ref-date">1996</span>, <span class="ref-opt">New York, NY</span>.</span><p>
<span class="ref"><span class="ref-auth">M. Matsui</span>, <span class="ref-title">Linear Cryptanalysis Method for DES Cipher</span>, <i class="ref-issue">Springer-Verlag</i>, <span class="ref-rep">Advances in Cryptology -- Eurocrypt '93 Proceedings</span>, <span class="ref-date">1994</span>.</span><p>
<span class="ref"><span class="ref-auth">Blaze</span>, <span class="ref-auth">Diffie</span>, <span class="ref-auth">Rivest</span>, <span class="ref-auth">Schneier</span>, <span class="ref-auth">Shimomura</span>, <span class="ref-auth">Thompson</span>, and <span class="ref-auth">Wiener</span>, <span class="ref-title">Minimal Key Lengths for Symmetric Ciphers To Provide Adequate Commercial Security</span>, <i class="ref-issue">Business Software Alliance</i>, <a class="link-ref" href="http://www.bsa.org/policy/encryption/cryptographers">http://www.bsa.org/policy/encryption/cryptographers</a>, <span class="ref-date">January 1996</span>.</span></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> When this document was originally written, there was a controversy raging over whether the DES would still be secure in a few years. There is now near-universal consensus in the cryptographic community that the key length of the DES is far too short. The advent of special-purpose hardware could reduce the cost of any of the methods of attack named above so that they are no longer computationally infeasible; in addition, the explosive growth in the number and speed of modern microprocessors as well as advances in programmable logic devices has brought an attack using only commodity hardware into the realm of possibility. Schneier and others currently recommend using cryptosystems with keys of at least 90 bits when long-term security is needed.<p>
As the key or key schedule is stored in memory, the encryption can be compromised if memory is readable. Additionally, programs which display programs' arguments may compromise the key and initialization vector, if they are specified on the command line. To avoid this <b class="name">bdes</b> overwrites its arguments, however, the obvious race cannot currently be avoided.<p>
Certain specific keys should be avoided because they introduce potential weaknesses; these keys, called the <span class="emph">weak</span> and <span class="emph">semiweak</span> keys, are (in hex notation, where p is either 0 or 1, and P is either e or f):<p>
<pre style="margin-left: 5.00ex;" class="lit display">
0x0p0p0p0p0p0p0p0p	0x0p1P0p1P0p0P0p0P 
0x0pep0pep0pfp0pfp	0x0pfP0pfP0pfP0pfP 
0x1P0p1P0p0P0p0P0p	0x1P1P1P1P0P0P0P0P 
0x1Pep1Pep0Pfp0Pfp	0x1PfP1PfP0PfP0PfP 
0xep0pep0pfp0pfp0p	0xep1Pep1pfp0Pfp0P 
0xepepepepepepepep	0xepfPepfPfpfPfpfP 
0xfP0pfP0pfP0pfP0p	0xfP1PfP1PfP0PfP0P 
0xfPepfPepfPepfPep	0xfPfPfPfPfPfPfPfP</pre>
<p>
This is inherent in the DES algorithm (see Moore and Simmons, &#8220;Cycle structure of the DES with weak and semi-weak keys&#8221;, <span class="emph">Advances in Cryptology &#45; Crypto '86 Proceedings</span>, Springer-Verlag New York, &#169;1987, pp. 9-32.)</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 1, 2001</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

