<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
MKTEMP(1)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
MKTEMP(1)</td>
<td class="head-vol" align="center">
General Commands Manual</td>
<td class="head-rtitle" align="right">
MKTEMP(1)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">mktemp</b> &#8212; <span class="desc">make temporary file name (unique)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 6.00ex;">
<col>
<tbody>
<tr>
<td>
mktemp</td>
<td>
&#91;<span class="opt"><b class="flag">&#45;dqu</b></span>&#93; &#91;<span class="opt"><b class="flag">&#45;p</b> <i class="arg">tmpdir</i></span>&#93; &#123;<b class="flag">&#45;t</b> <i class="arg">prefix</i> | <i class="arg">template ...</i>&#125;</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">mktemp</b> utility is provided to allow shell scripts to safely use temporary files. It creates temporary files or directories using unique names, and prints the names.<p>
The name of each temporary file or directory is derived from a template that includes several trailing &#8216;<code class="lit">X</code>&#8217; characters, such as <i class="file">/tmp/prefix.XXXX</i>. The trailing &#8216;<code class="lit">X</code>&#8217; characters in the template are replaced by unique values derived from the current process number and additional letters or numbers. Any &#8216;<code class="lit">X</code>&#8217; characters other than at the end of the template are taken literally. The number of unique file names <b class="name">mktemp</b> can return depends on the number of trailing &#8216;<code class="lit">Xs</code>&#8217; in the template; six &#8216;<code class="lit">Xs</code>&#8217; will result in <b class="name">mktemp</b> testing roughly 26 ** 6 combinations.<p>
The templates used to create the unique names are derived from the <b class="flag">&#45;t</b> <i class="arg">prefix</i> option, or the <i class="arg">template</i> arguments, possibly modified by other options. Any number of temporary files or directories may be created in a single invocation using multiple <i class="arg">template</i> arguments. It is possible to specify both a <b class="flag">&#45;t</b> <i class="arg">prefix</i> option and one or more <i class="arg">template</i> arguments, but this is not usually done.<p>
If neither a <b class="flag">&#45;t</b> <i class="arg">prefix</i> option, nor any <i class="arg">template</i> arguments are specified, then the default is equivalent to <b class="flag">&#45;t</b> <code class="lit">mktemp</code>.<p>
If <b class="name">mktemp</b> can successfully generate a unique file name, the file is created with mode 0600 (unless the <b class="flag">&#45;u</b> flag is given) and the filename is printed to standard output.</div>
<div class="section">
<h1 id="x4f5054494f4e53">OPTIONS</h1> The available options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;d</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Make a directory instead of a file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;p</b> <i class="arg">tmpdir</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies a directory in which temporary files should be created. If this option is specified, then it applies to all temporary files, including those created as a result of a <b class="flag">&#45;t</b> <i class="arg">prefix</i> option, and those created as a result of a <i class="arg">template</i> argument.<p>
If the <b class="flag">&#45;p</b> <i class="arg">tmpdir</i> option is not specified, then temporary files created as a result of a <b class="flag">&#45;t</b> <i class="arg">prefix</i> option will use a default temporary directory (as described under the <b class="flag">&#45;t</b> option), but temporary files created as a result of a <i class="arg">template</i> argument will not use a default temporary directory (so they will be created relative to the current working directory, if the <i class="arg">template</i> does not begin with &#8216;<code class="lit">/</code>&#8217;).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;t</b> <i class="arg">prefix</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate a template using an appropriate directory name, followed by the supplied <i class="arg">prefix</i>, followed by &#8216;<code class="lit">.XXXXXXXX</code>&#8217;. Any &#8216;<code class="lit">X</code>&#8217; characters in the supplied <i class="arg">prefix</i> are taken literally, but the trailing &#8216;<code class="lit">X</code>&#8217; characters in the appended &#8216;<code class="lit">.XXXXXXXX</code>&#8217; are replaced by unique values.<p>
The directory name used for the template generated by the <b class="flag">&#45;t</b> <i class="arg">prefix</i> option is taken from the <b class="flag">&#45;p</b> <i class="arg">tmpdir</i> option, or from the <span class="env">TMPDIR</span> environment variable, or <i class="file">/tmp</i> as a default.<p>
If one or more <i class="arg">template</i> arguments are used in addition to the <b class="flag">&#45;t</b> <i class="arg">prefix</i> option, then the <i class="arg">prefix</i> does not apply to the <i class="arg">template</i> arguments.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;q</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Fail silently if an error occurs. This is useful if a script does not want error output to go to standard error.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">&#45;u</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Operate in &#8220;unsafe&#8221; mode. The temp file will be unlinked before <b class="name">mktemp</b> exits. This is slightly better than <a class="link-man" href="../3/mktemp">mktemp(3)</a> but still introduces a race condition. Use of this option is not encouraged.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1> <b class="name">mktemp</b> takes care to create the files or directories in a way that is safe from race conditions (provided the <b class="flag">&#45;u</b> option is not used).<p>
Traditionally, without <b class="name">mktemp</b>, many shell scripts created temporary files using the name of the program with the pid as a suffix. This kind of naming scheme is predictable and creates a race condition that allows an attacker to subvert the program by creating a different file, directory, or symbolic link under the same name. A safer, though still inferior, approach is to make a temporary directory using the same naming scheme While this does allow one to guarantee that a temporary file will not be subverted, it still allows a simple denial of service attack. For these reasons it is recommended that <b class="name">mktemp</b> be used instead of simpler schemes.<p>
Care should be taken to ensure that it is appropriate to use an environment variable potentially supplied by the user.</div>
<div class="section">
<h1 id="x4558495420535441545553">EXIT STATUS</h1> The <b class="name">mktemp</b> utility exits with a value of 0 on success, and 1 on any failure.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The following <a class="link-man" href="../1/sh">sh(1)</a> fragment illustrates a simple use of <b class="name">mktemp</b> where the script should quit if it cannot get a safe temporary file.<p>
<pre style="margin-left: 5.00ex;" class="lit display">
TMPFILE=`mktemp /tmp/${0##*/}.XXXXXX` || exit 1 
echo "program output" &gt;&gt; $TMPFILE</pre>
<p>
To allow the use of $TMPDIR:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
TMPFILE=`mktemp -t ${0##*/}` || exit 1 
echo "program output" &gt;&gt; $TMPFILE</pre>
<p>
In this case, we want the script to catch the error itself.<p>
<pre style="margin-left: 5.00ex;" class="lit display">
TMPFILE=`mktemp -q /tmp/${0##*/}.XXXXXX` 
if [ $? -ne 0 ]; then 
	echo "$0: Can't create temp file, exiting..." 
	exit 1 
fi</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/mkdtemp">mkdtemp(3)</a>, <a class="link-man" href="../3/mkstemp">mkstemp(3)</a>, <a class="link-man" href="../3/mktemp">mktemp(3)</a>, <a class="link-man" href="../7/environ">environ(7)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">mktemp</b> utility appeared in <span class="unix">NetBSD&#160;1.5</span>. It was imported from <span class="unix">FreeBSD</span>, and the idea and the manual page were taken from <span class="unix">OpenBSD</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
November 4, 2012</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

