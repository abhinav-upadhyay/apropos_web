<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
SQLITE(3lua)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
SQLITE(3lua)</td>
<td class="head-vol" align="center">
3lua</td>
<td class="head-rtitle" align="right">
SQLITE(3lua)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">sqlite</b> &#8212; <span class="desc">access SQLite3 files from Lua</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="config">local sqlite = require 'sqlite'</b><p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">err = sqlite.initialize()</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.shutdown()</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">db, err = sqlite.open(file [, flags])</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">version = sqlite.libversion()</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">version = sqlite.libversion_number()</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">id = sqlite.sourceid()</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">err = sqlite.close(db)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">stmt, err = sqlite.prepare(db, sql)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">err = sqlite.exec(db, sql)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">err = sqlite.errcode(db)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">msg = sqlite.errmsg(db)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">res = sqlite.get_autocommit(db)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">res = sqlite.changes(db)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">err = sqlite.bind(stmt, pidx, value)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">count = sqlite.bind_parameter_count(stmt)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">pidx = sqlite.bind_parameter_index(stmt, name)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">name = sqlite.bind_parameter_name(stmt, pidx)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">err = sqlite.step(stmt)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">value = sqlite.column(stmt, cidx)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.reset(stmt)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.clear_bindings(stmt)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.finalize(stmt)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">name = sqlite.column_name(stmt, cidx)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">count = sqlite.column_count(stmt)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
</dd>
</dl>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">sqlite</b> Lua binding provides access to SQLite3 files.</div>
<div class="section">
<h1 id="x47454e4552414c2046554e4354494f4e53">GENERAL FUNCTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">err = sqlite.initialize()</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Initialize the SQLite3 library. Workstation applications using SQLite normally do not need to invoke this function.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.shutdown()</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Deallocate any resources that were allocated by <b class="fname">sqlite.initialize</b>(). Workstation applications using SQLite normally do not need to invoke this function.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">db, err = sqlite.open(file [, flags])</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Open a database, optionally passing flags. When called without flags, the database will be opened for reading and writing and it will be created if it does not yet exist. The following flags are defined:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.OPEN_READONLY</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The database is opened in read-only mode. If the database does not already exist, an error is returned.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.OPEN_READWRITE</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The database is opened for reading and writing if possible, or reading only if the file is write protected by the operating system. In either case the database must already exist, otherwise an error is returned.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.OPEN_CREATE</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The database is opened for reading and writing, and is created if it does not already exist.</dd>
</dl>
<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">version = sqlite.libversion()</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return the SQLite3 library version number as a string.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">version = sqlite.libversion_number()</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return the SQLite3 library version number as a number.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">id = sqlite.sourceid()</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return the SQLite3 library source id as a string.</dd>
</dl>
</div>
<div class="section">
<h1 id="x44415441424153452046554e4354494f4e53">DATABASE FUNCTIONS</h1> Database functions operate on database objects returned by <b class="fname">sqlite.open</b>().<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">err = sqlite.close(db)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Close an open database. Like with all remaining database functions, this function can also be called using the Lua "colon" syntactic sugar as <span class="emph">db:close()</span>.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">stmt, err = sqlite.prepare(db, sql)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return a prepared statement.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">err = sqlite.exec(db, sql)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Directly execute an SQL statement. Be careful when creating SQL on the fly (SQL injection attacks).<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">err = sqlite.errcode(db)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return the numeric error code.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">msg = sqlite.errmsg(db)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return the error message as a string.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">res = sqlite.get_autocommit(db)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return the autocommit flag.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">res = sqlite.changes(db)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
This function returns the number of database rows that were changed or inserted or deleted by the most recently completed SQL statement on the database.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53544154454d454e542046554e4354494f4e53">STATEMENT FUNCTIONS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">err = sqlite.bind(stmt, pidx, value)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Bind <i class="arg">value</i> to the parameter <i class="arg">pidx</i> in the prepared statement <i class="arg">stmt</i>.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">count = sqlite.bind_parameter_count(stmt)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return the number of parameters in the prepared statement <i class="arg">stmt</i>.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">pidx = sqlite.bind_parameter_index(stmt, name)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return the parameter index for <i class="arg">name</i> in the prepared statement <i class="arg">stmt</i>.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">name = sqlite.bind_parameter_name(stmt, pidx)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return the parameter name for the parameter index <i class="arg">pidx</i> in the prepared statement <i class="arg">stmt</i>.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">err = sqlite.step(stmt)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Execute prepared statement <i class="arg">stmt</i>.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">value = sqlite.column(stmt, cidx)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return the value at column <i class="arg">cidx</i> in the prepared statement <i class="arg">stmt</i>.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.reset(stmt)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The <b class="fname">sqlite.reset</b>() function is called to reset a prepared statement object back to its initial state, ready to be re-executed.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.clear_bindings(stmt)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Contrary to the intuition of many, <b class="fname">sqlite.reset</b>() does not reset the bindings on a prepared statement. Use this routine to reset all host parameters to <span class="define">NULL</span>.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.finalize(stmt)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The <b class="fname">sqlite.finalize</b>() function is called to delete a prepared statement.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">name = sqlite.column_name(stmt, cidx)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return the name assigned to a particular column in the result set of a SELECT statement.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">count = sqlite.column_count(stmt)</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Return the number of columns in the result set returned by the prepared statement <i class="arg">stmt</i>. This routine returns 0 if <i class="arg">stmt</i> is an SQL statement that does not return data (for example an UPDATE).</dd>
</dl>
</div>
<div class="section">
<h1 id="x4552524f5220434f444553">ERROR CODES</h1> Most functions return an error code, the following error codes are defined:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.OK</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Successful result.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.ERROR</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
SQL error or missing database.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.INTERNAL</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Internal logic error in SQLite.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.PERM</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Access permission denied.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.ABORT</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Callback routine requested an abort.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.BUSY</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The database file is locked.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.LOCKED</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
A table in the database is locked.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.NOMEM</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Out of memory.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.READONLY</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Attempt to write a readonly database.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.INTERRUPT</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Operation terminated by <b class="fname">sqlite3_interrupt</b>().<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.IOERR</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Some kind of disk I/O error occurred.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.CORRUPT</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The database disk image is malformed.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.NOTFOUND</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Unknown opcode in <b class="fname">sqlite3_file_control</b>().<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.FULL</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Insertion failed because database is full.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.CANTOPEN</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Unable to open the database file.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.PROTOCOL</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Database lock protocol error.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.EMPTY</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Database is empty.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.SCHEMA</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
The database schema changed.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.TOOBIG</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
String or BLOB exceeds size limit.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.CONSTRAINT</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Abort due to constraint violation.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.MISMATCH</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Data type mismatch.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.MISUSE</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Library used incorrectly.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.NOLFS</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Uses OS features not supported on host.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.AUTH</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Authorization denied.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.FORMAT</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Auxiliary database format error.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.RANGE</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
2nd parameter to <b class="fname">sqlite.bind</b>() out of range.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.NOTADB</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
File opened that is not a database file.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.ROW</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
<b class="fname">sqlite.step</b>() has another row ready.<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">sqlite.DONE</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
<b class="fname">sqlite.step</b>() has finished executing.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/lua.html">lua(1)</a>, <a class="link-man" href="../html1/luac.html">luac(1)</a>, <a class="link-man" href="../html1/sqlite3.html">sqlite3(1)</a>, <a class="link-man" href="../html3lua/intro.html">intro(3lua)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> An <b class="name">sqlite</b> manual appeared in <span class="unix">NetBSD&#160;7.0</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author"></span>The <b class="name">sqlite</b> Lua binding was written by <span class="author">Marc Balmer</span> &#60;<a class="link-mail" href="mailto:mbalmer@NetBSD.org">mbalmer@NetBSD.org</a>&#62;.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
October 28, 2013</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

