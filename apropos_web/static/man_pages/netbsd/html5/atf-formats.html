<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
ATF-FORMATS(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
ATF-FORMATS(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
ATF-FORMATS(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">atf-formats</b> &#8212; <span class="desc">machine-parseable data formats used by ATF</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> This manual page describes the multiple data formats used in ATF. These formats affect configuration files, control files and any data that is externalized or internalized by the tools.<p>
Data files are always organized as follows:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
Header1: Value1            \ 
    ...                    | head 
HeaderN: ValueN            / 
                           mandatory blank line 
Free-form text contents    \ 
    ...                    | body 
    ...                    /</pre>
<p>
A file must always contain a &#8216;Content-Type&#8217; header and must always separate that header from the body with a blank line, even if the body is empty.<p>
The &#8216;Content-Type&#8217; is always of the form:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
Content-Type: application/X-atf-&lt;subtype&gt;; version="&lt;version&gt;"</pre>
<p>
where &#8216;subtype&#8217; indicates the specific file format and &#8216;version&#8217; its format version. This header must be the first one of the file.<p>
The main purpose of the &#8216;Content-Type&#8217; header, aside from determining the format used in the file, is to allow future changes to a given format. Whenever an incompatible change is made, the version is bumped by one. By keeping the header in the first line, future versions may even remove the need for such a header -- e.g. if some format was replaced by XML files, which have their own mandatory header.<p>
The rest of this document details the different format types.<div class="subsection">
<h2 id="x466f726d61743a206170706c69636174696f6e2f581e6174661e61746666696c652c2076657273696f6e3a2031">Format: application/X-atf-atffile, version: 1</h2> Atffiles are logically divided into three sections:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
Test programs: the list of test programs that define the test suite described by the Atffile.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Meta-data properties: these define some constant values applicable to all the test programs defined in the file. In some sense they define the properties that describe the test suite.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Configuration variables: defaults for configuration variables that can be overridden through configuration files or the command line.</li>
</ul>
<p>
The grammar for Atffiles is the following:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
DATA ::= ( ( CONF | PROP | TP )? COMMENT? NEWLINE )* EOF 
CONF ::= 'conf:' WORD EQUAL STRING 
PROP ::= 'prop:' WORD EQUAL STRING 
TP ::= TPFILE | TPGLOB 
TPFILE ::= 'tp: ' STRING 
TPGLOB ::= 'tp-glob: ' STRING 
STRING ::= WORD | '"' WORD* '"'</pre>
<p>
The meaning of the constructions above is:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
CONF</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Definition of a configuration variable.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
PROP</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Definition of a meta-data property.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
TPFILE</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Addition of a test program into the test suite. The string is taken literally as the program's name, and this program must exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
TPGLOB</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Addition of multiple test programs into the test suite. The string is taken as a glob pattern, which may have or not have any matches in the current directory.</dd>
</dl>
<p>
An example:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
prop: test-suite = utilities 
 
conf: unprivileged-user = nobody 
 
tp: t_cp 
tp: t_mv 
tp: t_df 
tp-glob: t_dir_*</pre>
</div>
<div class="subsection">
<h2 id="x466f726d61743a206170706c69636174696f6e2f581e6174661e636f6e6669672c2076657273696f6e3a2031">Format: application/X-atf-config, version: 1</h2> Configuration files are very simple: they only contain a list of variable name/variable value pairs. Their grammar is:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
DATA ::= ( VAR? COMMENT? NEWLINE )* EOF 
VAR ::= WORD EQUAL STRING 
COMMENT ::= HASH WORD* 
STRING ::= WORD | '"' WORD* '"'</pre>
<p>
An example:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
# This is the system-wide configuration file for ATF. 
# The above and this line are comments placed on their own line. 
 
var1 = this is a variable value 
var2 = this is another one      # Optional comment at the end.</pre>
</div>
<div class="subsection">
<h2 id="x466f726d61743a206170706c69636174696f6e2f581e6174661e7470732c2076657273696f6e3a2033">Format: application/X-atf-tps, version: 3</h2> The &#8216;application/X-atf-tps&#8217; format multiplexes the standard output, standard error and results output streams from multiple test programs into a single data file. This format is used by <a class="link-man" href="../1/atf-run">atf-run(1)</a> to report the execution of several test programs and is later parsed by <a class="link-man" href="../1/atf-report">atf-report(1)</a> to inform the user of this process. It has the following grammar:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
DATA ::= INFO* TPS-COUNT TP-STANZA* INFO* EOF 
INFO ::= 'info' COLON STRING COMMA STRING NEWLINE 
TPS-COUNT ::= 'tps-count' COLON POSITIVE-NUMBER NEWLINE 
TP-STANZA ::= TP-START TC-STANZA* TC-END 
TP-START ::= 'tp-start' COLON TIMESTAMP COMMA STRING COMMA 
             POSITIVE-NUMBER NEWLINE 
TP-END ::= 'tc-end' COLON TIMESTAMP COMMA STRING (COMMA STRING)? 
TC-STANZA ::= TC-START (TC-SO | TC-SE)* TC-END 
TC-START ::= 'tc-start' COLON TIMESTAMP COMMA STRING NEWLINE 
TC-SO ::= 'tc-so' COLON STRING NEWLINE 
TC-SE ::= 'tc-se' COLON STRING NEWLINE 
TC-END ::= 'tc-end' COLON TIMESTAMP COMMA STRING COMMA TCR NEWLINE 
TCR ::= 'passed' | ('failed' | 'skipped') COMMA STRING 
TIMESTAMP ::= [0-9]+.[0-9]+</pre>
<p>
The meaning of the constructions above is:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
TPS-COUNT</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Indicates the number of test programs that will be executed. There will be this exact amount of &#8216;TP-STANZA&#8217; constructions following it.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
TP-START</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Indicates the beginning of a test program. This includes the program's name and the amount of test cases that will follow.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
TP-END</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Indicates the completion of a test program. This is followed by the program's name and, if the program ended prematurely, an error message indicating the reason of its failure. A successful execution of a test program (regardless of the status of its test cases) must not be accompanied by any reason.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
TC-START</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Indicates the beginning of a test case. This is accompanied by the test case's name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
TC-SO</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Contains a text line sent to the standard output stream during the execution of the test case. Leading and trailing space is preserved.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
TC-SE</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Contains a text line sent to the standard error stream during the execution of the test case. Leading and trailing space is preserved.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
TC-END</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Indicates the completion of a test case. This is accompanied by the test case's name, its result and the reason associated with this result (if applicable).</dd>
</dl>
<p>
An example:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
tps-count: 2 
tp-start: calculator, 1324318951.838923, 2 
tc-start: add, 1324318951.839101 
tc-end: add, 1324318951.839500, passed 
tc-start: subtract, 1324318951.840001 
tc-so: 3-2 expected to return 1 but got 0 
tc-end: subtract, 1324318952.000123, failed, Calculated an unexpected value 
tp-end: calculator, 1324318952.002301 
tp-start: files, 1, 1324318952.502348 
tc-start: copy, 1324318952.508291 
tc-se: could not find the cp(1) utility 
tc-end: copy, 1324318953.203145, skipped 
tp-end: files, 1324318953.203800</pre>
</div>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../7/atf">atf(7)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 20, 2011</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

