<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
MODULI(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
MODULI(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
MODULI(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">moduli</b> &#8212; <span class="desc">system moduli file</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <i class="file">/etc/moduli</i> file contains the system-wide Diffie-Hellman prime moduli for <a class="link-man" href="../8/sshd">sshd(8)</a>.<p>
Each line in this file contains the following fields: Time, Type, Tests, Tries, Size, Generator, Modulus. The fields are separated by white space (tab or blank).<p>
<i class="farg">Time</i>: <i class="farg">yyyymmddhhmmss</i>. Specifies the system time that the line was appended to the file. The value 00000000000000 means unknown (historic).<p>
<i class="farg">Type</i>: <i class="farg">decimal</i>. Specifies the internal structure of the prime modulus.<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
0:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
unknown; often learned from peer during protocol operation, and saved for later analysis.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
1:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
unstructured; a common large number.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
2:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
safe (p = 2q + 1); meets basic structural requirements.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
3:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Schnorr.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
4:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Sophie-Germaine (q = (p-1)/2); usually generated in the process of testing safe or strong primes.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
5:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
strong; useful for RSA public key generation.</dd>
</dl>
<p>
<i class="farg">Tests</i>: <i class="farg">decimal (bit field)</i>. Specifies the methods used in checking for primality. Usually, more than one test is used.<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
0:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
not tested; often learned from peer during protocol operation, and saved for later analysis.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
1:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
composite; failed one or more tests. In this case, the highest bit specifies the test that failed.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
2:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
sieve; checked for division by a range of smaller primes.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
4:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Miller-Rabin.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
8:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Jacobi.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
16:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Elliptic Curve.</dd>
</dl>
<p>
<i class="farg">Tries</i>: <i class="farg">decimal</i>. Depends on the value of the highest valid Test bit, where the method specified is:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
0:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
not tested (always zero).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
1:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
composite (irrelevant).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
2:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
sieve; number of primes sieved. Commonly on the order of 32,000,000.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
4:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Miller-Rabin; number of M-R iterations. Commonly on the order of 32 to 64.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
8:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Jacobi; unknown (always zero).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
16:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Elliptic Curve; unused (always zero).</dd>
</dl>
<p>
<i class="farg">Size</i>: <i class="farg">decimal</i>. Specifies the number of the most significant bit (0 to M).<p>
<i class="farg">Generator</i>: <i class="farg">hex string</i>. Specifies the best generator for a Diffie-Hellman exchange. 0 = unknown or variable, 2, 3, 5, etc.<p>
<i class="farg">Modulus</i>: <i class="farg">hex string</i>. The prime modulus.<p>
The file should be searched for moduli that meet the appropriate Time, Size and Generator criteria. When more than one meet the criteria, the selection should be weighted toward newer moduli, without completely disqualifying older moduli.<p>
Note that <a class="link-man" href="../8/sshd">sshd(8)</a> uses only the Size criteria and then selects a modulus at random if more than one meet the Size criteria.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/moduli</i></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/qsieve">qsieve(1)</a>, <a class="link-man" href="../8/sshd">sshd(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">moduli</b> file appeared in <span class="unix">OpenBSD&#160;2.8</span> and <span class="unix">NetBSD&#160;1.6</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
February 7, 2005</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

