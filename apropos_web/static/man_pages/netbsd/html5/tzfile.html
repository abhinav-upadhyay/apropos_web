<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
TZFILE(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
TZFILE(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
TZFILE(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">tzfile</b> &#8212; <span class="desc">time zone information</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">tzfile.h</a>&gt;</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The time zone information files used by <a class="link-man" href="../html3/tzset.html">tzset(3)</a> begin with the magic characters &#8220;TZif&#8221; to identify them as time zone information files, followed by a character identifying the version of the file's format (as of 2013, either an ASCII NUL or a '2', or '3') followed by fifteen bytes containing zeroes reserved for future use, followed by six four-byte values of type <i class="farg">long</i>, followed by six four-byte integer values written in a standard byte order (the high-order byte of the value is written first). These values are, in order:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">tzh_ttisgmtcnt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The number of UT/local indicators stored in the file.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">tzh_ttisstdcnt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The number of standard/wall indicators stored in the file.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">tzh_leapcnt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The number of leap seconds for which data entries are stored in the file.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">tzh_timecnt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The number of transition times for which data entries are stored in the file.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">tzh_typecnt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The number of local time types for which data entries are stored in the file (must not be zero).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">tzh_charcnt</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The number of characters of time zone abbreviation strings stored in the file.</dd>
</dl>
<p>
The above header is followed by <b class="var">tzh_timecnt</b> four-byte signed integer values sorted in ascending order. These values are written in These values are written in standard byte order. Each is used as a transition time (as returned by <a class="link-man" href="../html3/time.html">time(3)</a>) at which the rules for computing local time change. Next come <b class="var">tzh_timecnt</b> one-byte unsigned integer values; each one tells which of the different types of local time types described in the file is associated with the same-indexed transition time. These values serve as indices into an array of <i class="farg">ttinfo</i> structures (with <b class="var">tzh_typecnt</b> entries) that appears next in the file; these structures are defined as follows:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
struct ttinfo { 
	int32_t		tt_gmtoff; 
	unsigned char	tt_isdst; 
	unsigned char	tt_abbrind; 
};</pre>
Each structure is written as a four-byte signed integer value for <b class="var">tt_gmtoff</b> in a standard byte order, followed by a one-byte value for <b class="var">tt_isdst</b> and a one-byte value for <b class="var">tt_abbrind</b>. In each structure, <b class="var">tt_gmtoff</b> gives the number of seconds to be added to UT, <b class="var">tt_isdst</b> tells whether <b class="var">tm_isdst</b> should be set by <a class="link-man" href="../html3/localtime.html">localtime(3)</a> and <b class="var">tt_abbrind</b> serves as an index into the array of time zone abbreviation characters that follow the <b class="var">ttinfo</b> structure(s) in the file.<p>
Then there are <b class="var">tzh_leapcnt</b> pairs of four-byte values, written in standard byte order; the first value of each pair gives the time (as returned by <a class="link-man" href="../html3/time.html">time(3)</a>) at which a leap second occurs; the second gives the <span class="emph">total</span> number of leap seconds to be applied after the given time. The pairs of values are sorted in ascending order by time.<p>
Then there are <b class="var">tzh_ttisstdcnt</b> standard/wall indicators, each stored as a one-byte value; they tell whether the transition times associated with local time types were specified as standard time or wall clock time, and are used when a time zone file is used in handling POSIX-style time zone environment variables.<p>
Finally there are <b class="var">tzh_ttisgmtcnt</b> UT/local indicators, each stored as a one-byte value; they tell whether the transition times associated with local time types were specified as UT or local time, and are used when a time zone file is used in handling POSIX-style time zone environment variables.<p>
<a class="link-man" href="../html3/localtime.html">localtime(3)</a> uses the first standard-time <i class="farg">ttinfo</i> structure in the file (or simply the first <i class="farg">ttinfo</i> structure in the absence of a standard-time structure) if either <b class="var">tzh_timecnt</b> is zero or the time argument is less than the first transition time recorded in the file.<p>
For version-2-format time zone files, the above header and data are followed by a second header and data, identical in format except that eight bytes are used for each transition time or leap second time. After the second header and data comes a newline-enclosed, POSIX-TZ-environment-variable-style string for use in handling instants after the last transition time stored in the file (with nothing between the newlines if there is no POSIX representation for such instants).<p>
For version-3-format time zone files, the POSIX-TZ-style string may use two minor extensions to the POSIX TZ format, as described in <a class="link-man" href="../html3/tzset.html">tzset(3)</a>. First, the hours part of its transition times may be signed and range from &#45;167 through 167 instead of the POSIX-required unsigned values from 0 through 24. Second, DST is in effect all year if it starts January 1 at 00:00 and ends December 31 at 24:00 plus the difference between daylight saving and standard time.<p>
Future changes to the format may append more data.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/ctime.html">ctime(3)</a>, <a class="link-man" href="../html3/localtime.html">localtime(3)</a>, <a class="link-man" href="../html3/time.html">time(3)</a>, <a class="link-man" href="../html3/tzset.html">tzset(3)</a>, <a class="link-man" href="../html8/zdump.html">zdump(8)</a> <a class="link-man" href="../html8/zic.html">zic(8)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
October 6, 2014</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

