<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
SYSLOG.CONF(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
SYSLOG.CONF(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
SYSLOG.CONF(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">syslog.conf</b> &#8212; <span class="desc"><a class="link-man" href="../8/syslogd">syslogd(8)</a> configuration file</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">syslog.conf</b> file is the configuration file for the <a class="link-man" href="../8/syslogd">syslogd(8)</a> program. It consists of extended options (lines with one key="value" assignment) and blocks of lines separated by <span class="emph">program</span> and <span class="emph">hostname</span> specifications, with each line containing two fields: the <span class="emph">selector</span> field which specifies the types of messages and priorities to which the line applies, and an <span class="emph">action</span> field which specifies the action to be taken if a message <a class="link-man" href="../8/syslogd">syslogd(8)</a> receives matches the selection criteria. The <span class="emph">selector</span> field is separated from the <span class="emph">action</span> field by one or more tab characters.<p>
The <span class="emph">Selectors</span> function are encoded as a <span class="emph">facility</span>, a period (&#8216;.&#8217;), an optional set of comparison flags (&#91;!&#93; &#91;&lt;=&gt;&#93;), and a <span class="emph">level</span>, with no intervening white-space. Both the <span class="emph">facility</span> and the <span class="emph">level</span> are case insensitive.<p>
The <span class="emph">facility</span> describes the part of the system generating the message, and is one of the following keywords: auth, authpriv, cron, ftp, daemon, kern, lpr, mail, mark, news, syslog, user, uucp and local0 through local7. These keywords (with the exception of mark) correspond to the similar &#8220;<span class="define">LOG_</span>&#8221; values specified to the <a class="link-man" href="../3/openlog">openlog(3)</a> and <a class="link-man" href="../3/syslog">syslog(3)</a> library routines.<p>
The <span class="emph">comparison flags</span> may be used to specify exactly what levels are logged. If unspecified, the default comparison is &#8216;&gt;=&#8217; (greater than or equal to), or, if the <b class="flag">&#45;U</b> option is passed to <a class="link-man" href="../8/syslogd">syslogd(8)</a>, &#8216;=&#8217; (equal to). Comparison flags beginning with &#8216;!&#8217; will have their logical sense inverted. Thus, &#8216;!=info&#8217; means all levels except info and &#8216;!notice&#8217; has the same meaning as &#8216;&lt;notice&#8217;.<p>
The <span class="emph">level</span> describes the severity of the message, and is a keyword from the following ordered list (higher to lower): emerg, alert, crit, err, warning, notice, info and debug. These keywords correspond to the similar (<span class="define">LOG_</span>) values specified to the <a class="link-man" href="../3/syslog">syslog(3)</a> library routine.<p>
Each block of lines is separated from the previous block by a <span class="emph">program</span> or <span class="emph">hostname</span> specification. A block will only log messages corresponding to the most recent <span class="emph">program</span> and <span class="emph">hostname</span> specifications given. Consider the case of a block that selects &#8216;<code class="lit">pppd</code>&#8217; as the <span class="emph">program</span>, directly followed by a block that selects messages from the <span class="emph">hostname</span> &#8216;<code class="lit">dialhost</code>&#8217;. The second block will log only messages from the <a class="link-man" href="../8/pppd">pppd(8)</a> program from the host &#8216;dialhost&#8217;.<p>
A <span class="emph">program</span> specification of the form &#8216;<code class="lit">#!+prog1,prog2</code>&#8217; or &#8216;<code class="lit">!+prog1,prog2</code>&#8217; will cause subsequent blocks to be applied to messages logged by the specified programs. A <span class="emph">program</span> specification of the form &#8216;<code class="lit">#!-prog1,prog2</code>&#8217; or &#8216;<code class="lit">!-prog1,prog2</code>&#8217; will cause subsequent blocks to be applied to messages logged by programs other than the ones specified. A <span class="emph">program</span> specification of the form &#8216;<code class="lit">#!prog1,prog2</code>&#8217; or &#8216;<code class="lit">!prog1,prog2</code>&#8217; is equivalent to &#8216;<code class="lit">!+prog1,prog2</code>&#8217;. Program selectors may also match kernel-generated messages. For example, a program specification of &#8216;<code class="lit">!+subsys</code>&#8217; will match kernel-generated messages of the form &#8216;<code class="lit">subsys: here is a message</code>&#8217;. The special specification &#8216;<code class="lit">!*</code>&#8217; will cause subsequent blocks to apply to all programs.<p>
A <span class="emph">hostname</span> specification of the form &#8216;<code class="lit">#+host1,host2</code>&#8217; or &#8216;<code class="lit">+host1,host2</code>&#8217; will cause subsequent blocks to be applied to messages received from the specified hosts. A <span class="emph">hostname</span> specification of the form &#8216;<code class="lit">#-host1,host2</code>&#8217; or &#8216;<code class="lit">-host1,host2</code>&#8217; will cause subsequent blocks to be applied to messages from hosts other than the ones specified. If the hostname is given as &#8216;<code class="lit">@</code>&#8217;, the local hostname will be used. The special specification &#8216;<code class="lit">+*</code>&#8217; will cause subsequent blocks to apply to all hosts.<p>
See <a class="link-man" href="../3/syslog">syslog(3)</a> for a further descriptions of both the <span class="emph">facility</span> and <span class="emph">level</span> keywords and their significance. It is preferred that selections be made based on <span class="emph">facility</span> rather than <span class="emph">program</span>, since the latter can vary in a networked environment. However, there are cases where a <span class="emph">facility</span> may be too broadly defined.<p>
If a received message matches the specified <span class="emph">facility</span>, and the specified <span class="emph">level</span> comparison is true, and the first word in the message after the date matches the <span class="emph">program</span>, the action specified in the <span class="emph">action</span> field will be taken.<p>
Multiple <span class="emph">selectors</span> may be specified for a single <span class="emph">action</span> by separating them with semicolon (&#8216;;&#8217;) characters. It is important to note, however, that each <span class="emph">selector</span> can modify the ones preceding it.<p>
Multiple <span class="emph">facilities</span> may be specified for a single <span class="emph">level</span> by separating them with comma (&#8216;,&#8217;) characters.<p>
An asterisk (&#8216;*&#8217;) can be used to specify all <span class="emph">facilities</span> or all <span class="emph">levels</span>.<p>
The special <span class="emph">facility</span> &#8220;mark&#8221; receives a message at priority &#8220;info&#8221; every 20 minutes (see <a class="link-man" href="../8/syslogd">syslogd(8)</a>). This is not enabled by a <span class="emph">facility</span> field containing an asterisk.<p>
The special <span class="emph">level</span> &#8220;none&#8221; disables a particular <span class="emph">facility</span>.<p>
The <span class="emph">action</span> field of each line specifies the action to be taken when the <span class="emph">selector</span> field selects a message. There are five forms:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
A pathname (beginning with a leading slash). Selected messages are appended to the file, unless pathname points to an existing FIFO special file. <a class="link-man" href="../8/syslogd">syslogd(8)</a> treats FIFO specially by opening them in non-blocking mode and discarding messages sent when no reader is listening on the other side.<p>
To ensure that kernel messages are written to disk promptly, <a class="link-man" href="../8/syslogd">syslogd(8)</a> calls <a class="link-man" href="../2/fsync">fsync(2)</a> after writing messages from the kernel. Other messages are not synced explcitly. You may disable syncing of files specified to receive kernel messages by prefixing the pathname with a minus sign &#8216;<code class="lit">-</code>&#8217;. Note that use of this option may cause the loss of log information in the event of a system crash immediately following the write attempt. However, using this option may prove to be useful if your system's kernel is logging many messages.<p>
Normally the priority and version is not written to file. In order to use syslog-sign you may prefix a pathname with the plus sign &#8216;<code class="lit">+</code>&#8217;. If both switches are used the order has to be &#8216;<code class="lit">+-</code>&#8217;.</li>
<li class="list-bul" style="margin-top: 1.00em;">
A hostname (preceded by an at (&#8216;@&#8217;) sign). Selected messages are forwarded to the <a class="link-man" href="../8/syslogd">syslogd(8)</a> program on the named host with UDP.</li>
<li class="list-bul" style="margin-top: 1.00em;">
A hostname preceded by an at (&#8216;@&#8217;) sign and enclosed in brackets (&#8216;[]&#8217;) Selected messages are forwarded with TLS to the <a class="link-man" href="../8/syslogd">syslogd(8)</a> program on the named host. After the closing bracket a colon (&#8216;:&#8217;) and a port or service name may be appended. Additional options are configured in parantheses in the form of key="value". Recognized keywords are <i class="arg">subject</i>, <i class="arg">fingerprint</i>, <i class="arg">cert</i>, and <i class="arg">verify</i>.</li>
<li class="list-bul" style="margin-top: 1.00em;">
A comma separated list of users. Selected messages are written to those users if they are logged in.</li>
<li class="list-bul" style="margin-top: 1.00em;">
An asterisk. Selected messages are written to all logged-in users.</li>
<li class="list-bul" style="margin-top: 1.00em;">
A vertical bar (&#8216;|&#8217;) followed by a command to which to pipe the selected messages. The command string is passed to <i class="file">/bin/sh</i> for evaluation, so the usual shell metacharacters or input/output redirection can occur. (Note that redirecting <a class="link-man" href="../3/stdio">stdio(3)</a> buffered output from the invoked command can cause additional delays, or even lost output data in case a logging subprocess exits with a signal.) The command itself runs with <span class="emph">stdout</span> and <span class="emph">stderr</span> redirected to <i class="file">/dev/null</i>. Upon receipt of a <span class="define">SIGHUP</span>, <a class="link-man" href="../8/syslogd">syslogd(8)</a> will close the pipe to the process. If the process does not exit voluntarily, it will be sent a <span class="define">SIGTERM</span> signal after a grace period of up to 60 seconds.<p>
The command will only be started once data arrives that should be piped to it. If the command exits, it will be restarted as necessary.<p>
If it is desired that the subprocess should receive exactly one line of input, this can be achieved by exiting after reading and processing the single line. A wrapper script can be used to achieve this effect, if necessary. Note that this method can be very resource-intensive if many log messages are being piped through the filter.<p>
Unless the command is a full pipeline, it may be useful to start the command with <span class="emph">exec</span> so that the invoking shell process does not wait for the command to complete. Note that the command is started with the UID of the <a class="link-man" href="../8/syslogd">syslogd(8)</a> process, normally the superuser.<p>
Just like with files a plus sign &#8216;<code class="lit">+</code>&#8217; will leave the priority and version information intact.</li>
</ul>
<p>
Blank lines and lines whose first non-blank character is a hash (&#8216;#&#8217;) character are ignored.</div>
<div class="section">
<h1 id="x544c53204f5054494f4e53">TLS OPTIONS</h1> Additional options are used for TLS configuration:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-ohang">
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_server</span></dt>
<dd class="list-ohang">
Enables TLS server mode.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_bindport</span></dt>
<dd class="list-ohang">
Service name or port number to bind to. Default is &#8216;syslog&#8217;. <span class="emph">As long as no official port is assigned this option is required</span> <span class="emph">for TLS servers.</span></dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_bindhost</span></dt>
<dd class="list-ohang">
Hostname or IP to bind to.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_gen_cert</span></dt>
<dd class="list-ohang">
Automatically generate a private key and certificate.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_key</span></dt>
<dd class="list-ohang">
File with private key. Default is &#8216;/etc/openssl/default.key&#8217;</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_cert</span></dt>
<dd class="list-ohang">
File with certificate to use. Default is &#8216;/etc/openssl/default.crt&#8217;</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_ca</span></dt>
<dd class="list-ohang">
File with CA certificate to use.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_cadir</span></dt>
<dd class="list-ohang">
Directory containing CA certificates.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_verify</span></dt>
<dd class="list-ohang">
If set to &#8216;off&#8217; then certificate authentication is skipped.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_allow_fingerprints</span></dt>
<dd class="list-ohang">
List of fingerprints of trusted client certificates.</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_allow_clientcerts</span></dt>
<dd class="list-ohang">
List of filenames with trusted client certificates.</dd>
</dl>
</div>
<div class="section">
<h1 id="x544c532041555448454e5449434154494f4e">TLS AUTHENTICATION</h1> One function of TLS is mutual authentication of client and server. Unless authentication is disabled by setting &#8216;tls_verify=off&#8217; the following rules are used:<div class="subsection">
<h2 id="x417320636c69656e743a">As client:</h2> A client can be configured not to check a server's certificate by setting the parameter <i class="arg">verify</i> to &#8216;off&#8217;. If the server's certificate is signed by a trusted CA then it is checked if its hostname or IP is given in its certificate (as a CommonName, as a DNS SubjectAltName, or as an IP SubjectAltName). If any match is found then the server is authenticated. If a <i class="arg">subject</i> parameter is given then it is can satisfy this test as well. This allows DNS-independent configurations using the server's IP address in the destination and adding its hostname as <i class="arg">subject</i> to authenticate the TLS connection without having to add the IP to the X.509 certificate.<p>
If no CA is used or no trust path between CA and server certificate exists, then hash value of the server's certificate is compared with the hash given in <i class="arg">fingerprint</i> and the hash of the certificate in <i class="arg">cert</i>. If the hashes are equal then the server is authenticated.</div>
<div class="subsection">
<h2 id="x4173207365727665723a">As server:</h2> If using a CA and the client's certificate is signed by it then the client is authenticated. Otherwise the hash of the client's certificate is compared with the hashes given in <i class="arg">tls_allow_fingerprints</i> and the hashes of the certificates given in <i class="arg">tls_allow_clientcerts</i>. On any match the client is authenticated.</div>
</div>
<div class="section">
<h1 id="x425546464552494e47">BUFFERING</h1> <a class="link-man" href="../8/syslogd">syslogd(8)</a> is able to buffer temporary not writeable messages in memory. To limit the memory consumed for this buffering the following optons may be given:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-ohang">
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">file_queue_length</span></dt>
<dd class="list-ohang">
</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">pipe_queue_length</span></dt>
<dd class="list-ohang">
</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_queue_length</span></dt>
<dd class="list-ohang">
The maximum number of messages buffered for one destination of type tls, file, or pipe respectively. Defaults are &#8216;1024&#8217;, &#8216;1024&#8217;, and &#8216;-1&#8217; (no limit).</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">file_queue_size</span></dt>
<dd class="list-ohang">
</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">pipe_queue_size</span></dt>
<dd class="list-ohang">
</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">tls_queue_size</span></dt>
<dd class="list-ohang">
The maximum memory usage in bytes of messages buffered for one destination. Defaults are &#8216;1M&#8217;, &#8216;1M&#8217;, and &#8216;16M&#8217;.</dd>
</dl>
</div>
<div class="section">
<h1 id="x5349474e494e47">SIGNING</h1> <a class="link-man" href="../8/syslogd">syslogd(8)</a> is able to digitally sign all processed messages. The used protocol is defined by RFC 5848 (syslog-sign): at the start of a session the signing sender sends so called certificate blocks containing its public key; after that it periodically sends a signed message containing hashes of previous messages.<p>
To detect later manipulation one has to keep a copy of the key used for signing (otherwise an attacker could alter the logs and sign them with his his own key). If TLS is used with a DSA key then the same key will be used for signing. This is the recommended setup because it makes it easy to have copies of the certificate (with the public key) in backups. Otherwise new keys are generated on every restart and for certain verification it is necessary to have copies of all used keys. So logging only to a local file is not secure; at least the used keys should be logged to another host.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-ohang">
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">sign_sg</span></dt>
<dd class="list-ohang">
Enables signing. Set this option to enable syslog-sign and select how to assign messages to signature groups (subsets of messages that are signed together). To enable later signature verification and detection of lost messages the assignment should be chosen such that all messages of one signature group are written to the same file. Four possible values for this option are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-hang">
<dt class="list-hang" style="margin-top: 1.00em;">
<span class="emph">0</span></dt>
<dd class="list-hang">
Use one global signature group for all messages.</dd>
<dt class="list-hang" style="margin-top: 1.00em;">
<span class="emph">1</span></dt>
<dd class="list-hang">
Use one signature group per priority.</dd>
<dt class="list-hang" style="margin-top: 1.00em;">
<span class="emph">2</span></dt>
<dd class="list-hang">
Use signature groups for ranges of priorities.</dd>
<dt class="list-hang" style="margin-top: 1.00em;">
<span class="emph">3</span></dt>
<dd class="list-hang">
Use one signature group per destination. This is a custom strategy not defined by the standard. With this setting one signature group is set up for every file and network action.</dd>
</dl>
</dd>
<dt class="list-ohang" style="margin-top: 1.00em;">
<span class="emph">sign_delim_sg2</span></dt>
<dd class="list-ohang">
This option is only evaluated with &#8216;sign_sg=2&#8217; and allows to configure the priority ranges for signature groups. The parameters are numerical values used as the maximum priority for one group. The default is to use one signature groups per facility, which is equal to setting &#8216;sign_delim_sg2=7 15 23 31 39 ...&#8217;.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/syslog.conf</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
The <a class="link-man" href="../8/syslogd">syslogd(8)</a> configuration file.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/usr/share/examples/syslogd/verify.pl</i></dt>
<dd class="list-tag" style="margin-left: 16.00ex;">
Example script to verify message signatures. (Requires Perl and modules not part of NetBSD.)</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> A configuration file might appear as follows:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
# Log all kernel messages, authentication messages of 
# level notice or higher and anything of level err or 
# higher to the console. 
# Don't log private authentication messages! 
*.err;kern.*;auth.notice;authpriv.none	/dev/console 
 
# Log anything (except mail) of level info or higher. 
# Don't log private authentication messages! 
*.info;mail.none;authpriv.none		/var/log/messages 
 
# Log daemon messages at debug level only 
daemon.=debug				/var/log/daemon.debug 
 
# The authpriv file has restricted access. 
# Write logs with priority for later verification with syslog-sign. 
authpriv.*				+/var/log/secure 
 
# Log all the mail messages in one place. 
mail.*					/var/log/maillog 
 
# Everybody gets emergency messages, plus log them on another 
# machine. 
*.emerg					* 
*.emerg					@arpa.berkeley.edu 
 
# Log all messages of level info or higher to another 
# machine using TLS with an alternative portname and a 
# fingerprint for athentication 
*.info			@[logserver]:1234(fingerprint="SHA1:01:02:...") 
 
# Root and Eric get alert and higher messages. 
*.alert					root,eric 
 
# Save mail and news errors of level err and higher in a 
# special file. 
mail,news.err				/var/log/spoolerr 
 
# Pipe all authentication messages to a filter. 
auth.*					|exec /usr/local/sbin/authfilter 
 
# Log kernel messages to a separate file without syncing each message. 
kern.*					-/var/log/kernlog 
 
# Save ftpd transactions along with mail and news. 
!ftpd 
*.*					/var/log/spoolerr 
 
# Send all error messages from a RAID array through a filter. 
!raid0 
kern.err				|exec /usr/local/sbin/raidfilter 
 
# Save pppd messages from dialhost to a separate file. 
!pppd 
+dialhost 
*.*					/var/log/dialhost-pppd 
 
# Save non-local log messages from all programs to a separate file. 
!* 
-@ 
*.*					/var/log/foreign 
 
# Generate digital signatures for all messages 
# to each file or network destination. 
sign_sg=3</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/syslog">syslog(3)</a>, <a class="link-man" href="../8/syslogd">syslogd(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">syslog.conf</b> file appeared in <span class="unix">4.3BSD</span>, along with <a class="link-man" href="../8/syslogd">syslogd(8)</a>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The effects of multiple selectors are sometimes not intuitive. For example &#8220;mail.crit;*.err&#8221; will select &#8220;mail&#8221; facility messages at the level of &#8220;err&#8221; or higher, not at the level of &#8220;crit&#8221; or higher.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
November 9, 2013</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

