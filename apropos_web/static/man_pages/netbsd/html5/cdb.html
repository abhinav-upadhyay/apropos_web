<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
CDB(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
CDB(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
CDB(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">cdb</b> &#8212; <span class="desc">format of the constant database</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">cdb</b> database format provides a space-efficient (key,value) database. The format doesn't allow updates in any convenient form. The file overhead is around 5 bytes per key and 5 bytes per entry. Keys are not stored and it is the responsibility of the caller to validate matches. The index structure is based on a minimal perfect hash table, so exactly one entry has to be checked for a match.<div class="subsection">
<h2 id="x47656e6572616c20466f726d6174">General Format</h2> The header record of a <b class="name">cdb</b> database consists of the following:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
struct header_cdb { 
	uint8_t magic[7]; 
	uint8_t version; 
	uint8_t description[16]; 
	uint32_t data_size; 
	uint32_t entries; 
	uint32_t entries_index; 
	uint32_t seed; 
};</pre>
<p>
All fields are in Little Endian byte order.<p>
This is followed by a description of the hash function of <b class="var">entries_index</b> records. The size of each index entry is the logarithm of <b class="var">entries</b> to base 256, rounded up.<p>
The index records are followed by the start offsets of the entries, followed by <b class="var">data_size</b>. The offsets are relative to the end of the offset record table and are monotonically increasing. The size of each offset record is the logarithm of <b class="var">data_size</b> to base 256, rounded up.<p>
The offset table is followed by the entries in order. No separation or padding is added.</div>
<div class="subsection">
<h2 id="x4c696d69746174696f6e73">Limitations</h2> The <b class="name">cdb</b> file format is by design intended for a database that can be mapped into memory. The hard limit for the number of entries and keys is 3435973836. The total size of all values must be smaller than 4GiB.</div>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/cdbr">cdbr(3)</a>, <a class="link-man" href="../3/cdbw">cdbw(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> Support for the <b class="name">cdb</b> format first appeared in <span class="unix">NetBSD&#160;6.0</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="name">cdbr</b> and <b class="name">cdbw</b> functions have been written by <span class="author">Joerg Sonnenberger</span> &#60;<a class="link-mail" href="mailto:joerg@NetBSD.org">joerg@NetBSD.org</a>&#62;.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 27, 2010</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

