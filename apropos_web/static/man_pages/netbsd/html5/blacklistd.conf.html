<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
BLACKLISTD.CONF(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
BLACKLISTD.CONF(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
BLACKLISTD.CONF(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">blacklistd.conf</b> &#8212; <span class="desc">configuration file format for blacklistd</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">blacklistd.conf</b> files contains configuration lines for <a class="link-man" href="../8/blacklistd">blacklistd(8)</a>. It contains one entry per line, and is similar to <a class="link-man" href="../5/inetd.conf">inetd.conf(5)</a>. There must be an entry for each field of the configuration file, with entries for each field separated by a tab or a space. Comments are denoted by a &#8220;#&#8221; at the beginning of a line.<p>
There are two kinds of configuration lines, <b class="var">local</b> and <b class="var">remote</b>. By default, configuration lines are <b class="var">local</b>, i.e. the address specified refers to the addresses on the local machine. To switch to between <b class="var">local</b> and <b class="var">remote</b> configuration lines you can specify the stanzas: &#8220;[local]&#8221; and &#8220;[remote]&#8221;.<p>
On <b class="var">local</b> and <b class="var">remote</b> lines &#8220;*&#8221; means use the default, or wildcard match. In addition, for <b class="var">remote</b> lines &#8220;=&#8221; means use the values from the matched <b class="var">local</b> configuration line.<p>
The first four fields, <b class="var">location</b>, <b class="var">type</b>, <b class="var">proto</b>, and <b class="var">owner</b> are used to match the <b class="var">local</b> or <b class="var">remote</b> addresses, whereas the last 3 fields <b class="var">name</b>, <b class="var">nfail</b>, and <b class="var">disable</b> are used to modify the filtering action.<p>
The first field denotes the <b class="var">location</b> as an address, mask, and port. The syntax for the <b class="var">location</b> is:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
	[&lt;address&gt;|&lt;interface&gt;][/&lt;mask&gt;][:&lt;port&gt;]</pre>
<p>
The <span class="define">address</span> can be an IPv4 address in numeric format, an IPv6 address in numeric format and enclosed by square brackets, or an interface name. Mask modifiers are not allowed on interfaces because interfaces have multiple address in different protocols where the mask has a different size.<p>
The <span class="define">mask</span> is always numeric, but the <span class="define">port</span> can be either numeric or symbolic.<p>
The second field is the socket <b class="var">type</b>: <span class="define">stream</span>, <span class="define">dgram</span>, or numeric. The third field is the <b class="var">prococol</b>: <span class="define">tcp</span>, <span class="define">udp</span>, <span class="define">tcp6</span>, <span class="define">udp6</span>, or numeric. The fourth file is the effective user (<b class="var">owner</b>) of the daemon process reporting the event, either as a username or a userid.<p>
The rest of the fields are controlling the behavior of the filter.<p>
The <b class="var">name</b> field, is the name of the packet filter rule to be used. If the <b class="var">name</b> starts with a &#8220;-&#8221;, then the default rulename is prepended to the given name. If the <span class="define">name</span> contains a &#8220;/&#8221;, the remaining portion of the name is interpreted as the mask to be applied to the address specified in the rule, so one can block whole subnets for a single rule violation.<p>
The <b class="var">nfail</b> field contains the number of failed attempts before access is blocked, defaulting to &#8220;*&#8221; meaning never, and the last field <b class="var">disable</b> specifies the amount of time since the last access that the blocking rule should be active, defaulting to &#8220;*&#8221; meaning forever. The default unit for <b class="var">disable</b> is seconds, but one can specify suffixes for different units, such as &#8220;m&#8221; for minutes &#8220;h&#8221; for hours and &#8220;d&#8221; for days.<p>
Matching is done first by checking the <b class="var">local</b> rules one by one, from the most specific to the least specific. If a match is found, then the <b class="var">remote</b> rules are applied, and if a match is found the <b class="var">name</b>, <b class="var">nfail</b>, and <b class="var">disable</b> fields can be altered by the <b class="var">remote</b> rule that matched.<p>
The <b class="var">remote</b> rules can be used for whitelisting specific addresses, changing the mask size, or the rule that the packet filter uses, the number of failed attempts, or the blocked duration.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/blacklistd.conf</i></dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
Configuration file.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1><pre style="margin-left: 0.00ex;" class="lit display">
# Block ssh, after 3 attempts for 6 hours on the bnx0 interface 
[local] 
# location	type	proto	owner	name	nfail	duration 
bnx0:ssh	*	*	*	*	3	6h 
[remote] 
# Never block 1.2.3.4 
1.2.3.4:ssh	*	*	*	*	*	* 
# For addresses coming from 8.8.0.0/16 block class C networks instead 
# individual hosts, but keep the rest of the blocking parameters the same. 
8.8.0.0/16:ssh	*	*	*	/24	=	=</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../8/blacklistctl">blacklistctl(8)</a>, <a class="link-man" href="../8/blacklistd">blacklistd(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> <b class="name">blacklistd.conf</b> appeared in <span class="unix">NetBSD&#160;7</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Christos Zoulas</span></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 29, 2015</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

