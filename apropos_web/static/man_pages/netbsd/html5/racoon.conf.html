<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
RACOON.CONF(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
RACOON.CONF(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
RACOON.CONF(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">racoon.conf</b> &#8212; <span class="desc">configuration file for racoon</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">racoon.conf</b> is the configuration file for the <a class="link-man" href="../8/racoon">racoon(8)</a> ISAKMP daemon. <a class="link-man" href="../8/racoon">racoon(8)</a> negotiates security associations for itself (ISAKMP SA, or phase 1 SA) and for kernel IPsec (IPsec SA, or phase 2 SA). The file consists of a sequence of directives and statements. Each directive is composed by a tag and statements, enclosed by &#8216;<code class="lit">{</code>&#8217; and &#8216;<code class="lit">}</code>&#8217;. Lines beginning with &#8216;<code class="lit">#</code>&#8217; are comments.<div class="subsection">
<h2 id="x4d6574612053796e746178">Meta Syntax</h2> Keywords and special characters that the parser expects exactly are displayed using <b class="cmd">this</b> font. Parameters are specified with <i class="arg">this</i> font. Square brackets (&#8216;<code class="lit">[</code>&#8217; and &#8216;<code class="lit">]</code>&#8217;) are used to show optional keywords and parameters. Note that you have to pay attention when this manual is describing <i class="arg">port</i> numbers. The <i class="arg">port</i> number is always enclosed by &#8216;<code class="lit">[</code>&#8217; and &#8216;<code class="lit">]</code>&#8217;. In this case, the port number is not an optional keyword. If it is possible to omit the <i class="arg">port</i> number, the expression becomes &#91;&#91;<i class="arg">port</i>&#93;&#93;. The vertical bar (&#8216;<code class="lit">|</code>&#8217;) is used to indicate a choice between optional parameters. Parentheses (&#8216;<code class="lit">(</code>&#8217; and &#8216;<code class="lit">)</code>&#8217;) are used to group keywords and parameters when necessary. Major parameters are listed below.<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">number</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
means a hexadecimal or a decimal number. The former must be prefixed with &#8216;<code class="lit"><code class="lit">0x</code></code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">string</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">path</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
means any string enclosed in &#8216;<code class="lit">"</code>&#8217; (double quotes).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">address</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
means IPv6 and/or IPv4 address.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">port</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
means a TCP/UDP port number. The port number is always enclosed by &#8216;<code class="lit">[</code>&#8217; and &#8216;<code class="lit">]</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">timeunit</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
is one of following: <b class="cmd">sec</b>, <b class="cmd">secs</b>, <b class="cmd">second</b>, <b class="cmd">seconds</b>, <b class="cmd">min</b>, <b class="cmd">mins</b>, <b class="cmd">minute</b>, <b class="cmd">minutes</b>, <b class="cmd">hour</b>, <b class="cmd">hours</b>.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x50726976696c6567652073657061726174696f6e">Privilege separation</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">privsep {</b> <i class="arg">statements</i> <b class="cmd">}</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies privilege separation parameters. When enabled, these enable <a class="link-man" href="../8/racoon">racoon(8)</a> to operate with an unprivileged instance doing most of the work, while a privileged instance takes care of performing the following operations as root: reading PSK and private keys, launching hook scripts, and validating passwords against system databases or against PAM. Please note that using privilege separation makes changes to the <i class="arg">listen</i> and <i class="arg">paths</i> sections ignored upon configuration reloads. A <a class="link-man" href="../8/racoon">racoon(8)</a> restart is required if you want such changes to be taken into account.<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">user</b> <i class="arg">user</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The user to which the unprivileged instance of <a class="link-man" href="../8/racoon">racoon(8)</a>, should switch. This can be a quoted user name or a numeric UID.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">group</b> <i class="arg">group</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The group the unprivileged instance of <a class="link-man" href="../8/racoon">racoon(8)</a>, should switch. This can be a quoted group name or a numeric GID.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">chroot</b> <i class="arg">path</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A directory to which the unprivileged instance of <a class="link-man" href="../8/racoon">racoon(8)</a> should <a class="link-man" href="../2/chroot">chroot(2)</a>. This directory should hold a tree where the following files must be reachable:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/random</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/dev/urandom</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
The certificates</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
The file containing the Xauth banner</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
</dl>
<p>
The PSK file, the private keys, and the hook scripts are accessed through the privileged instance of <a class="link-man" href="../8/racoon">racoon(8)</a> and do not need to be reachable in the <a class="link-man" href="../2/chroot">chroot(2)</a>&#39;ed tree.</dd>
</dl>
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x506174682053706563696669636174696f6e">Path Specification</h2> This section specifies various paths used by racoon. When running in privilege separation mode, <b class="cmd">certificate</b> and <b class="cmd">script</b> paths are mandatory. A <a class="link-man" href="../8/racoon">racoon(8)</a> restart is required if you want path changes to be taken into account.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">path include</b> <i class="arg">path</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies a path to include a file. See <i class="link-sec"><a class="link-sec" href="#x46696c6520496e636c7573696f6e">File Inclusion</a></i>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">path pre_shared_key</b> <i class="arg">file</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies a file containing pre-shared key(s) for various ID(s). See <i class="link-sec"><a class="link-sec" href="#x5072651e736861726564206b65792046696c65">Pre-shared key File</a></i>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">path certificate</b> <i class="arg">path</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<a class="link-man" href="../8/racoon">racoon(8)</a> will search this directory if a certificate or certificate request is received. If you run with privilege separation, <a class="link-man" href="../8/racoon">racoon(8)</a> will refuse to use a certificate stored outside of this directory.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">path backupsa</b> <i class="arg">file</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies a file to which SA information negotiated by racoon should be stored. <a class="link-man" href="../8/racoon">racoon(8)</a> will install SA(s) from the file when started with the <b class="flag">&#45;B</b> flag. The file is growing because <a class="link-man" href="../8/racoon">racoon(8)</a> simply adds SAs to it. You should maintain the file manually.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">path script</b> <i class="arg">path</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<a class="link-man" href="../8/racoon">racoon(8)</a> will search this directory for scripts hooks. If you run with privilege separation, <a class="link-man" href="../8/racoon">racoon(8)</a> will refuse to execute a script stored outside of this directory.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">path pidfile</b> <i class="arg">file</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies file where to store PID of process. If path starts with <i class="file">/</i> it is treated as an absolute path. Otherwise, it is treated as a relative path to the VARRUN directory specified at compilation time. Default is <i class="file">racoon.pid</i>.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x46696c6520496e636c7573696f6e">File Inclusion</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">include</b> <i class="arg">file</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies other configuration files to be included.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x54696d65722053706563696669636174696f6e">Timer Specification</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">timer {</b> <i class="arg">statements</i> <b class="cmd">}</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This section specifies various timer values used by racoon.<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">counter</b> <i class="arg">number</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The maximum number of retries to send. The default is 5.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">interval</b> <i class="arg">number</i> <i class="arg">timeunit</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The interval to resend, in seconds. The default time is 10 seconds.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">persend</b> <i class="arg">number</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The number of packets per send. The default is 1.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">phase1</b> <i class="arg">number</i> <i class="arg">timeunit</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The maximum time it should take to complete phase 1. The default time is 15 seconds.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">phase2</b> <i class="arg">number</i> <i class="arg">timeunit</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The maximum time it should take to complete phase 2. The default time is 10 seconds.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">natt_keepalive</b> <i class="arg">number</i> <i class="arg">timeunit</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The interval between sending NAT-Traversal keep-alive packets. The default time is 20 seconds. Set to 0s to disable keep-alive packets.</dd>
</dl>
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4c697374656e696e6720506f72742053706563696669636174696f6e">Listening Port Specification</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">listen {</b> <i class="arg">statements</i> <b class="cmd">}</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If no <i class="arg">listen</i> directive is specified, <a class="link-man" href="../8/racoon">racoon(8)</a> will listen on all available interface addresses. The following is the list of valid statements:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">isakmp</b> <i class="arg">address</i> &#91;&#91;<i class="arg">port</i>&#93;&#93;;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If this is specified, <a class="link-man" href="../8/racoon">racoon(8)</a> will only listen on the defined <i class="arg">address</i>. The default port is 500, which is specified by IANA. You can provide more than one address definition.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">isakmp_natt</b> <i class="arg">address</i> &#91;<i class="arg">port</i>&#93;;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Same as <b class="cmd">isakmp</b> but also sets the socket options to accept UDP-encapsulated ESP traffic for NAT-Traversal. If you plan to use NAT-T, you should provide at least one address with port 4500, which is specified by IANA. There is no default.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">strict_address</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Requires that all addresses for ISAKMP be bound. This statement will be ignored if you do not specify address definitions.</dd>
</dl>
When running in privilege separation mode, you need to restart <a class="link-man" href="../8/racoon">racoon(8)</a> to have changes to the <i class="arg">listen</i> section taken into account.<p>
The <i class="arg">listen</i> section can also be used to specify the admin socket mode and ownership if racoon was built with support for admin port.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">adminsock</b> <i class="arg">path</i> &#91;<span class="opt"><i class="arg">owner&#160;group&#160;mode</i></span>&#93;;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <i class="arg">path</i>, <i class="arg">owner</i>, and <i class="arg">group</i> values specify the socket path, owner, and group. They must be quoted. The defaults are <i class="file">/var/racoon/racoon.sock</i>, UID 0, and GID 0. <i class="arg">mode</i> is the access mode in octal. The default is 0600.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">adminsock disabled</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This directive tells racoon to not listen on the admin socket.</dd>
</dl>
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4d697363656c6c616e656f757320476c6f62616c20506172616d6574657273">Miscellaneous Global Parameters</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">gss_id_enc</b> <i class="arg">enctype</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Older versions of <a class="link-man" href="../8/racoon">racoon(8)</a> used ISO-Latin-1 as the encoding of the GSS-API identifier attribute. For interoperability with Microsoft Windows' GSS-API authentication scheme, the default encoding has been changed to UTF-16LE. The <b class="cmd">gss_id_enc</b> parameter allows <a class="link-man" href="../8/racoon">racoon(8)</a> to be configured to use the old encoding for compatibility with existing <a class="link-man" href="../8/racoon">racoon(8)</a> installations. The following are valid values for <i class="arg">enctype</i>:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">utf-16le</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use UTF-16LE to encode the GSS-API identifier attribute. This is the default encoding. This encoding is compatible with Microsoft Windows.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">latin1</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use ISO-Latin-1 to encode the GSS-API identifier attribute. This is the encoding used by older versions of <a class="link-man" href="../8/racoon">racoon(8)</a>.</dd>
</dl>
</dd>
</dl>
<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">pfkey_buffer</b> <i class="arg">kBytes</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the socket send/receive buffer size in kilobytes. Numerous kernel PF_KEY implementations have problems with dumping SAD/SDP with large amount of entries (this happens when 100s to 1000s of tunnels are configured).<p>
The default value of 0 leaves everything at the OS-specific default value. If the default buffer size is greater than what is specified here racoon will not decrease it.<p>
This problem is known to be fixed in Linux 2.6.25 and later.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x52656d6f7465204e6f6465732053706563696669636174696f6e73">Remote Nodes Specifications</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">remote</b> <i class="arg">name</i> &#91;<b class="cmd">inherit</b> <i class="arg">parent_name</i>&#93; <b class="cmd">{</b> <i class="arg">statements</i> <b class="cmd">}</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">remote</b> <i class="arg">name</i> <b class="cmd">inherit</b> <i class="arg">parent_name</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the IKE phase 1 parameters for each remote node.<p>
If connection is initiated using racoonctl, a unique match using the remote IP must be found or the remote block name has to be given. For received acquires (kernel notices traffic requiring a new SA) the remote IP and remoteid from matching sainfo block are used to decide the remoteblock. If no uniquely matching remoteblock is found using these criteria, no connection attempt is done.<p>
When acting as responder, racoon picks the first proposal that has one or more acceptable remote configurations. When determining if a remote specification is matching the following information is checked:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-bul">
<li class="list-bul" style="margin-top: 0.00em;">
The remote IP is checked against <b class="cmd">remote_address</b>.</li>
<li class="list-bul" style="margin-top: 0.00em;">
ISAKMP exchange type is checked against <b class="cmd">exchange_mode</b>.</li>
<li class="list-bul" style="margin-top: 0.00em;">
ISAKMP SA attributes must match a <b class="cmd">proposal</b> block.</li>
<li class="list-bul" style="margin-top: 0.00em;">
The remote identity is matched against <b class="cmd">peers_identifier</b> if <b class="cmd">verify_identifier</b> is on.</li>
<li class="list-bul" style="margin-top: 0.00em;">
If a certificate request was received, it must match the issuer of <b class="cmd">certificate_type x509</b> certificate. If certificate request without issuer name was sent, the <b class="cmd">match_empty_cr</b> parameter specifies whether or not remote block matches.</li>
</ul>
<p>
Similarly, NAT-T is enabled if any of the initial remote configuration candidates allow NAT-T.<p>
Sections with <b class="cmd">inherit</b> <i class="arg">parent</i> statements (where <i class="arg">parent</i> is either <i class="arg">address</i> or a keyword <b class="cmd">anonymous</b>) that have all values predefined to those of a given <i class="arg">parent</i>. In these sections it is enough to redefine only the changed parameters.<p>
The following are valid statements.<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">remote_address</b> <i class="arg">address</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines the IP address of the peer.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">exchange_mode</b> (<b class="cmd">main</b> | <b class="cmd">aggressive</b> | <b class="cmd">base</b>);</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines the exchange mode for phase 1 when racoon is the initiator. It also means the acceptable exchange mode when racoon is the responder. More than one mode can be specified by separating them with a comma. All of the modes are acceptable. The first exchange mode is what racoon uses when it is the initiator.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">doi</b> <b class="cmd">ipsec_doi</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Means to use IPsec DOI as specified in RFC 2407. You can omit this statement.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">situation</b> <b class="cmd">identity_only</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Means to use SIT_IDENTITY_ONLY as specified in RFC 2407. You can omit this statement.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">my_identifier</b> &#91;<i class="arg">qualifier</i>&#93; <i class="arg">idtype ...</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the identifier sent to the remote host and the type to use in the phase 1 negotiation. <b class="cmd">address, fqdn</b>, <b class="cmd">user_fqdn</b>, <b class="cmd">keyid</b>, and <b class="cmd">asn1dn</b> can be used as an <i class="arg">idtype</i>. The <i class="arg">qualifier</i> is currently only used for <b class="cmd">keyid</b>, and can be either <b class="cmd">file</b> or <b class="cmd">tag</b>. The possible values are :<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">my_identifier</b> <b class="cmd">address</b> &#91;<i class="arg">address</i>&#93;;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The type is the IP address. This is the default type if you do not specify an identifier to use.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">my_identifier</b> <b class="cmd">user_fqdn</b> <i class="arg">string</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The type is a USER_FQDN (user fully-qualified domain name).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">my_identifier</b> <b class="cmd">fqdn</b> <i class="arg">string</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The type is a FQDN (fully-qualified domain name).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">my_identifier</b> <b class="cmd">keyid</b> &#91;<b class="cmd">file</b>&#93; <i class="arg">file</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The type is a KEY_ID, read from the file.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">my_identifier</b> <b class="cmd">keyid</b> <b class="cmd">tag</b> <i class="arg">string</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The type is a KEY_ID, specified in the quoted string.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">my_identifier</b> <b class="cmd">asn1dn</b> &#91;<i class="arg">string</i>&#93;;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The type is an ASN.1 distinguished name. If <i class="arg">string</i> is omitted, <a class="link-man" href="../8/racoon">racoon(8)</a> will get the DN from the Subject field in the certificate.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">xauth_login</b> &#91;<i class="arg">string</i>&#93;;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the login to use in client-side Hybrid authentication. It is available only if <a class="link-man" href="../8/racoon">racoon(8)</a> has been built with this option. The associated password is looked up in the pre-shared key files, using the login <b class="cmd">string</b> as the key id.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">peers_identifier</b> <i class="arg">idtype ...</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the peer's identifier to be received. If it is not defined then <a class="link-man" href="../8/racoon">racoon(8)</a> will not verify the peer's identifier in ID payload transmitted from the peer. If it is defined, the behavior of the verification depends on the flag of <b class="cmd">verify_identifier</b>. The usage of <i class="arg">idtype</i> is the same as <b class="cmd">my_identifier</b> except that the individual component values of an <b class="cmd">asn1dn</b> identifier may specified as <b class="cmd">*</b> to match any value (e.g. "C=XX, O=MyOrg, OU=*, CN=Mine"). The format of the specification should correspond to RFC 2253; in particular, commas and certain other characters - <b class="cmd">,=+&lt;&gt;#;</b> - may be included in a name by preceeding them with a backslash "&#92;", and arbitrary characters may be inserted in a name with the "&#92;nn" escape, where nn is the hex representation of the ascii value of the desired character. Alternative acceptable peer identifiers may be specified by repeating the <b class="cmd">peers_identifier</b> statement.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">verify_identifier (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If you want to verify the peer's identifier, set this to on. In this case, if the value defined by <b class="cmd">peers_identifier</b> is not the same as the peer's identifier in the ID payload, the negotiation will fail. The default is off.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">certificate_type</b> <i class="arg">certspec</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies a certificate specification. <i class="arg">certspec</i> is one of followings:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">x509</b> <i class="arg">certfile</i> <i class="arg">privkeyfile</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<i class="arg">certfile</i> means a file name of a certificate. <i class="arg">privkeyfile</i> means a file name of a secret key.</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">plain_rsa</b> <i class="arg">privkeyfile</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<i class="arg">privkeyfile</i> means a file name of a private key generated by <a class="link-man" href="../8/plainrsa-gen">plainrsa-gen(8)</a>. Required for RSA authentication.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">ca_type</b> <i class="arg">cacertspec</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies a root certificate authority specification. <i class="arg">cacertspec</i> is one of followings:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">x509</b> <i class="arg">cacertfile</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<i class="arg">cacertfile</i> means a file name of the root certificate authority. Default is <i class="file">/etc/openssl/cert.pem</i></dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">mode_cfg (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Gather network information through ISAKMP mode configuration. Default is off.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">weak_phase1_check (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Tells racoon to act on unencrypted deletion messages during phase 1. This is a small security risk, so the default is off, meaning that racoon will keep on trying to establish a connection even if the user credentials are wrong, for instance.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">peers_certfile</b> (<b class="cmd">dnssec</b> | <i class="arg">certfile</i> | <b class="cmd">plain_rsa</b> <i class="arg">pubkeyfile</i>);</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If <b class="cmd">dnssec</b> is defined, <a class="link-man" href="../8/racoon">racoon(8)</a> will ignore the CERT payload from the peer, and try to get the peer's certificate from DNS instead. If <i class="arg">certfile</i> is defined, <a class="link-man" href="../8/racoon">racoon(8)</a> will ignore the CERT payload from the peer, and will use this certificate as the peer's certificate. If <b class="cmd">plain_rsa</b> is defined, <a class="link-man" href="../8/racoon">racoon(8)</a> will expect <i class="arg">pubkeyfile</i> to be the peer's public key that was generated by <a class="link-man" href="../8/plainrsa-gen">plainrsa-gen(8)</a>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">script</b> <i class="arg">script</i> <b class="cmd">phase1_up</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">script</b> <i class="arg">script</i> <b class="cmd">phase1_down</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">script</b> <i class="arg">script</i> <b class="cmd">phase1_dead</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Shell scripts that get executed when a phase 1 SA goes up or down, or when it is detected as dead by DPD. All scripts get either <b class="cmd">phase1_up</b> , <b class="cmd">phase1_down</b> or <b class="cmd">phase1_dead</b> as first argument, and the following variables are set in their environment:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="env">LOCAL_ADDR</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The local address of the phase 1 SA.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="env">LOCAL_PORT</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The local port used for IKE for the phase 1 SA.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="env">REMOTE_ADDR</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The remote address of the phase 1 SA.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="env">REMOTE_PORT</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The remote port used for IKE for the phase 1 SA.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="env">REMOTE_ID</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The remote identity received in IKE for the phase 1 SA.</dd>
</dl>
The following variables are only set if <b class="cmd">mode_cfg</b> was enabled:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
INTERNAL_ADDR4</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
An IPv4 internal address obtained by ISAKMP mode config.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
INTERNAL_NETMASK4</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
An IPv4 internal netmask obtained by ISAKMP mode config.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
INTERNAL_CIDR4</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
An IPv4 internal netmask obtained by ISAKMP mode config, in CIDR notation.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
INTERNAL_DNS4</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The first internal DNS server IPv4 address obtained by ISAKMP mode config.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
INTERNAL_DNS4_LIST</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A list of internal DNS servers IPv4 address obtained by ISAKMP mode config, separated by spaces.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
INTERNAL_WINS4</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The first internal WINS server IPv4 address obtained by ISAKMP mode config.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
INTERNAL_WINS4_LIST</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A list of internal WINS servers IPv4 address obtained by ISAKMP mode config, separated by spaces.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
SPLIT_INCLUDE</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The space separated list of IPv4 addresses and masks (address slash mask) that define the networks to be encrypted (as opposed to the default where all the traffic should be encrypted) ; obtained by ISAKMP mode config ; SPLIT_INCLUDE and SPLIT_LOCAL are mutually exclusive.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
SPLIT_LOCAL</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The space separated list of IPv4 addresses and masks (address slash mask) that define the networks to be considered local, and thus excluded from the tunnels ; obtained by ISAKMP mode config.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
SPLIT_INCLUDE_CIDR</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Same as SPLIT_INCLUDE, with netmasks in CIDR notation.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
SPLIT_LOCAL_CIDR</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Same as SPLIT_LOCAL, with netmasks in CIDR notation.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
DEFAULT_DOMAIN</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The DNS default domain name obtained by ISAKMP mode config.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">send_cert (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If you do not want to send a certificate, set this to off. The default is on.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">send_cr (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If you do not want to send a certificate request, set this to off. The default is on.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">match_empty_cr (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies whether this remote block is a valid match when a non-specific certificate request is received. The default is on.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">verify_cert (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
By default, the identifier sent by the remote host (as specified in its <b class="cmd">my_identifier</b> statement) is compared with the credentials in the certificate used to authenticate the remote host as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
Type <b class="cmd">asn1dn</b>:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The entire certificate subject name is compared with the identifier, e.g. "C=XX, O=YY, ...".</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
Type <b class="cmd">address, fqdn, or user_fqdn</b>:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The certificate's subjectAltName is compared with the identifier.</dd>
</dl>
If the two do not match the negotiation will fail. If you do not want to verify the identifier using the peer's certificate, set this to off.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">lifetime time</b> <i class="arg">number</i> <i class="arg">timeunit</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Define a lifetime of a certain time which will be proposed in the phase 1 negotiations. Any proposal will be accepted, and the attribute(s) will not be proposed to the peer if you do not specify it (them). They can be individually specified in each proposal.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">ike_frag (on</b> | <b class="cmd">off</b> | <b class="cmd">force)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable receiver-side IKE fragmentation if <a class="link-man" href="../8/racoon">racoon(8)</a> has been built with this feature. If set to on, racoon will advertise itself as being capable of receiving packets split by IKE fragmentation. This extension is there to work around broken firewalls that do not work with fragmented UDP packets. IKE fragmentation is always enabled on the sender-side, and it is used if the peer advertises itself as IKE fragmentation capable. By selecting force, IKE Fragmentation will be used when racoon is acting as the initiator even before the remote peer has advertised itself as IKE fragmentation capable.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">esp_frag</b> <i class="arg">fraglen</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option is only relevant if you use NAT traversal in tunnel mode. Its purpose is to work around broken DSL routers that reject UDP fragments, by fragmenting the IP packets before ESP encapsulation. The result is ESP over UDP of fragmented packets instead of fragmented ESP over UDP packets (i.e., IP:UDP:ESP:frag(IP) instead of frag(IP:UDP:ESP:IP)). <i class="arg">fraglen</i> is the maximum size of the fragments. 552 should work anywhere, but the higher <i class="arg">fraglen</i> is, the better the performance.<p>
Note that because PMTU discovery is broken on many sites, you will have to use MSS clamping if you want TCP to work correctly.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">initial_contact (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable this to send an INITIAL-CONTACT message. The default value is <b class="cmd">on</b>. This message is useful only when the responder implementation chooses an old SA when there are multiple SAs with different established time and the initiator reboots. If racoon did not send the message, the responder would use an old SA even when a new SA was established. For systems that use a KAME derived IPSEC stack, the <a class="link-man" href="../8/sysctl">sysctl(8)</a> variable net.key.preferred_oldsa can be used to control this preference. When the value is zero, the stack always uses a new SA.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">passive (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If you do not want to initiate the negotiation, set this to on. The default value is <b class="cmd">off</b>. It is useful for a server.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">proposal_check</b> <i class="arg">level</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the action of lifetime length, key length, and PFS of the phase 2 selection on the responder side, and the action of lifetime check in phase 1. The default level is <b class="cmd">strict</b>. If the <i class="arg">level</i> is:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">obey</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The responder will obey the initiator anytime.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">strict</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If the responder's lifetime length is longer than the initiator's or the responder's key length is shorter than the initiator's, the responder will use the initiator's value. Otherwise, the proposal will be rejected. If PFS is not required by the responder, the responder will obey the proposal. If PFS is required by both sides and the responder's group is not equal to the initiator's, then the responder will reject the proposal.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">claim</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If the responder's lifetime length is longer than the initiator's or the responder's key length is shorter than the initiator's, the responder will use the initiator's value. If the responder's lifetime length is shorter than the initiator's, the responder uses its own length AND sends a RESPONDER-LIFETIME notify message to an initiator in the case of lifetime (phase 2 only). For PFS, this directive behaves the same as <b class="cmd">strict</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">exact</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If the initiator's lifetime or key length is not equal to the responder's, the responder will reject the proposal. If PFS is required by both sides and the responder's group is not equal to the initiator's, then the responder will reject the proposal.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">support_proxy (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If this value is set to on, then both values of ID payloads in the phase 2 exchange are always used as the addresses of end-point of IPsec-SAs. The default is off.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">generate_policy (on</b> | <b class="cmd">off</b> | <b class="cmd">require</b> | <b class="cmd">unique)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This directive is for the responder. Therefore you should set <b class="cmd">passive</b> to on in order that <a class="link-man" href="../8/racoon">racoon(8)</a> only becomes a responder. If the responder does not have any policy in SPD during phase 2 negotiation, and the directive is set to on, then <a class="link-man" href="../8/racoon">racoon(8)</a> will choose the first proposal in the SA payload from the initiator, and generate policy entries from the proposal. It is useful to negotiate with clients whose IP address is allocated dynamically. Note that an inappropriate policy might be installed into the responder's SPD by the initiator, so other communications might fail if such policies are installed due to a policy mismatch between the initiator and the responder. <b class="cmd">on</b> and <b class="cmd">require</b> values mean the same thing (generate a require policy). <b class="cmd">unique</b> tells racoon to set up unique policies, with a monotoning increasing reqid number (between 1 and IPSEC_MANUAL_REQID_MAX). This directive is ignored in the initiator case. The default value is <b class="cmd">off</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">nat_traversal (on</b> | <b class="cmd">off</b> | <b class="cmd">force)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This directive enables use of the NAT-Traversal IPsec extension (NAT-T). NAT-T allows one or both peers to reside behind a NAT gateway (i.e., doing address- or port-translation). If a NAT gateway is detected during the phase 1 handshake, racoon will attempt to negotiate the use of NAT-T with the remote peer. If the negotiation succeeds, all ESP and AH packets for the given connection will be encapsulated into UDP datagrams (port 4500, by default). Possible values are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">on</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
NAT-T is used when a NAT gateway is detected between the peers.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">off</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
NAT-T is not proposed/accepted. This is the default.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">force</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
NAT-T is used regardless of whether a NAT gateway is detected between the peers or not.</dd>
</dl>
Please note that NAT-T support is a compile-time option. Although it is enabled in the source distribution by default, it may not be available in your particular build. In that case you will get a warning when using any NAT-T related config options.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">dpd_delay</b> <i class="arg">delay</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
This option activates the DPD and sets the time (in seconds) allowed between 2 proof of liveliness requests. The default value is <b class="cmd">0</b>, which disables DPD monitoring, but still negotiates DPD support.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">dpd_retry</b> <i class="arg">delay</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If <b class="cmd">dpd_delay</b> is set, this sets the delay (in seconds) to wait for a proof of liveliness before considering it as failed and send another request. The default value is <b class="cmd">5</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">dpd_maxfail</b> <i class="arg">number</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
If <b class="cmd">dpd_delay</b> is set, this sets the maximum number of liveliness proofs to request (without reply) before considering the peer is dead. The default value is <b class="cmd">5</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">rekey (on</b> | <b class="cmd">off</b> | <b class="cmd">force)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enable automatic renegotiation of expired phase1 when there are non-dying phase2 SAs. Possible values are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">force</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Rekeying is done unconditionally.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">on</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Rekeying is done only if DPD monitoring is active. This is the default.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">off</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
No automatic rekeying. Do note that turning off automatic rekeying will result in inaccurate DPD monitoring.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">nonce_size</b> <i class="arg">number</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
define the byte size of nonce value. Racoon can send any value although RFC2409 specifies that the value MUST be between 8 and 256 bytes. The default size is 16 bytes.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">ph1id</b> <i class="arg">number</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
An optional number to identify the remote proposal and to link it only with sainfos who have the same number. Defaults to 0.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">proposal {</b> <i class="arg">sub-substatements</i> <b class="cmd">}</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">encryption_algorithm</b> <i class="arg">algorithm</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the encryption algorithm used for the phase 1 negotiation. This directive must be defined. <i class="arg">algorithm</i> is one of following: <b class="cmd">des, 3des, blowfish, cast128, aes, camellia</b> for Oakley. For other transforms, this statement should not be used.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">hash_algorithm</b> <i class="arg">algorithm</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines the hash algorithm used for the phase 1 negotiation. This directive must be defined. <i class="arg">algorithm</i> is one of following: <b class="cmd">md5, sha1, sha256, sha384, sha512</b> for Oakley.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">authentication_method</b> <i class="arg">type</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines the authentication method used for the phase 1 negotiation. This directive must be defined. <i class="arg">type</i> is one of: <b class="cmd">pre_shared_key</b>, <b class="cmd">rsasig</b> (for plain RSA authentication), <b class="cmd">gssapi_krb</b>, <b class="cmd">hybrid_rsa_server</b>, <b class="cmd">hybrid_rsa_client</b>, <b class="cmd">xauth_rsa_server</b>, <b class="cmd">xauth_rsa_client</b>, <b class="cmd">xauth_psk_server</b> or <b class="cmd">xauth_psk_client</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">dh_group</b> <i class="arg">group</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines the group used for the Diffie-Hellman exponentiations. This directive must be defined. <i class="arg">group</i> is one of following: <b class="cmd">modp768</b>, <b class="cmd">modp1024</b>, <b class="cmd">modp1536</b>, <b class="cmd">modp2048</b>, <b class="cmd">modp3072</b>, <b class="cmd">modp4096</b>, <b class="cmd">modp6144</b>, <b class="cmd">modp8192</b>. Or you can define 1, 2, 5, 14, 15, 16, 17, or 18 as the DH group number. When you want to use aggressive mode, you must define the same DH group in each proposal.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">lifetime time</b> <i class="arg">number</i> <i class="arg">timeunit</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines the lifetime of the phase 1 SA proposal. Refer to the description of the <b class="cmd">lifetime</b> directive defined in the <b class="cmd">remote</b> directive.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">gss_id</b> <i class="arg">string</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines the GSS-API endpoint name, to be included as an attribute in the SA, if the <b class="cmd">gssapi_krb</b> authentication method is used. If this is not defined, the default value of &#8216;<code class="lit">host/hostname</code>&#8217; is used, where hostname is the value returned by the <a class="link-man" href="../1/hostname">hostname(1)</a> command.</dd>
</dl>
</dd>
</dl>
<p>
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">remote</b> (<i class="arg">address</i> | <b class="cmd">anonymous</b>) &#91;&#91;<i class="arg">port</i>&#93;&#93; &#91;<b class="cmd">inherit</b> <i class="arg">parent</i>&#93; <b class="cmd">{</b> <i class="arg">statements</i> <b class="cmd">}</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Deprecated format of specifying a remote block. This will be removed in future. It is a remnant from time when remote block was decided solely based on the peers IP address.<p>
This is equivalent to:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
remote "address" [inherit "parent-address"] { 
	remote_address address; 
}</pre>
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x5361696e666f2053706563696669636174696f6e73">Sainfo Specifications</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">sainfo</b> (<i class="arg">local_id</i> | <b class="cmd">anonymous</b>) (<i class="arg">remote_id</i> | <b class="cmd">clientaddr</b> | <b class="cmd">anonymous</b>) &#91;<b class="cmd">from</b> <i class="arg">idtype</i> &#91;<i class="arg">string</i>&#93;&#93; &#91;<b class="cmd">group</b> <i class="arg">string</i>&#93; <b class="cmd">{</b> <i class="arg">statements</i> <b class="cmd">}</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines the parameters of the IKE phase 2 (IPsec-SA establishment).<p>
The <i class="arg">local_id</i> and <i class="arg">remote_id</i> strings are constructed like:<p>
<b class="cmd">address</b> <i class="arg">address</i> &#91;<b class="cmd">/</b> <i class="arg">prefix</i>&#93; &#91;[<i class="arg">port</i>&#93;] <i class="arg">ul_proto</i><p>
or<p>
<b class="cmd">subnet</b> <i class="arg">address</i> &#91;<b class="cmd">/</b> <i class="arg">prefix</i>&#93; &#91;[<i class="arg">port</i>&#93;] <i class="arg">ul_proto</i><p>
An id string should be expressed to match the exact value of an ID payload. This is not like a filter rule. For example, if you define 3ffe:501:4819::/48 as <i class="arg">local_id</i>. 3ffe:501:4819:1000:/64 will not match. In the case of a longest prefix (selecting a single host), <i class="arg">address</i> instructs to send ID type of ADDRESS while <i class="arg">subnet</i> instructs to send ID type of SUBNET. Otherwise, these instructions are identical.<p>
The <b class="cmd">anonymous</b> keyword can be used to match any id. The <b class="cmd">clientaddr</b> keyword can be used to match a remote id that is equal to either the peer ip address or the mode_cfg ip address (if assigned). This can be useful to restrict policy generation when racoon is acting as a client gateway for peers with dynamic ip addresses.<p>
The <b class="cmd">from</b> keyword allows an sainfo to only match for peers that use a specific phase1 id value during authentication. The <b class="cmd">group</b> keyword allows an XAuth group membership check to be performed for this sainfo section. When the mode_cfg auth source is set to <b class="cmd">system</b> or <b class="cmd">ldap</b>, the XAuth user is verified to be a member of the specified group before allowing a matching SA to be negotiated.<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">pfs_group</b> <i class="arg">group</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
define the group of Diffie-Hellman exponentiations. If you do not require PFS then you can omit this directive. Any proposal will be accepted if you do not specify one. <i class="arg">group</i> is one of following: <b class="cmd">modp768</b>, <b class="cmd">modp1024</b>, <b class="cmd">modp1536</b>, <b class="cmd">modp2048</b>, <b class="cmd">modp3072</b>, <b class="cmd">modp4096</b>, <b class="cmd">modp6144</b>, <b class="cmd">modp8192</b>. Or you can define 1, 2, 5, 14, 15, 16, 17, or 18 as the DH group number.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">lifetime time</b> <i class="arg">number</i> <i class="arg">timeunit</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
define how long an IPsec-SA will be used, in timeunits. Any proposal will be accepted, and no attribute(s) will be proposed to the peer if you do not specify it(them). See the <b class="cmd">proposal_check</b> directive.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">remoteid</b> <i class="arg">number</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Sainfos will only be used if their remoteid matches the ph1id of the remote section used for phase 1. Defaults to 0, which is also the default for ph1id.</dd>
</dl>
<p>
<a class="link-man" href="../8/racoon">racoon(8)</a> does not have a list of security protocols to be negotiated. The list of security protocols are passed by SPD in the kernel. Therefore you have to define all of the potential algorithms in the phase 2 proposals even if there are algorithms which will not be used. These algorithms are define by using the following three directives, with a single comma as the separator. For algorithms that can take variable-length keys, algorithm names can be followed by a key length, like &#8220;<code class="lit">blowfish 448</code>&#8221;. <a class="link-man" href="../8/racoon">racoon(8)</a> will compute the actual phase 2 proposals by computing the permutation of the specified algorithms, and then combining them with the security protocol specified by the SPD. For example, if <b class="cmd">des</b>, <b class="cmd">3des</b>, <b class="cmd">hmac_md5</b>, and <b class="cmd">hmac_sha1</b> are specified as algorithms, we have four combinations for use with ESP, and two for AH. Then, based on the SPD settings, <a class="link-man" href="../8/racoon">racoon(8)</a> will construct the actual proposals. If the SPD entry asks for ESP only, there will be 4 proposals. If it asks for both AH and ESP, there will be 8 proposals. Note that the kernel may not support the algorithm you have specified.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">encryption_algorithm</b> <i class="arg">algorithms</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<b class="cmd">des</b>, <b class="cmd">3des</b>, <b class="cmd">des_iv64</b>, <b class="cmd">des_iv32</b>, <b class="cmd">rc5</b>, <b class="cmd">rc4</b>, <b class="cmd">idea</b>, <b class="cmd">3idea</b>, <b class="cmd">cast128</b>, <b class="cmd">blowfish</b>, <b class="cmd">null_enc</b>, <b class="cmd">twofish</b>, <b class="cmd">rijndael</b>, <b class="cmd">aes</b>, <b class="cmd">camellia</b>, <b class="cmd">aes_gcm_16</b> (used with ESP)</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">authentication_algorithm</b> <i class="arg">algorithms</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<b class="cmd">des</b>, <b class="cmd">3des</b>, <b class="cmd">des_iv64</b>, <b class="cmd">des_iv32</b>, <b class="cmd">hmac_md5</b>, <b class="cmd">hmac_sha1</b>, <b class="cmd">hmac_sha256, hmac_sha384, hmac_sha512, non_auth</b> (used with ESP authentication and AH)</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">compression_algorithm</b> <i class="arg">algorithms</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<b class="cmd">deflate</b> (used with IPComp)</dd>
</dl>
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4c6f6767696e67206c6576656c">Logging level</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">log</b> <i class="arg">level</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines the logging level. <i class="arg">level</i> is one of following: <b class="cmd">error</b>, <b class="cmd">warning</b>, <b class="cmd">notify</b>, <b class="cmd">info</b>, <b class="cmd">debug</b> or <b class="cmd">debug2</b>. The default is <b class="cmd">info</b>. If you set the logging level too high on slower machines, IKE negotiation can fail due to timing constraint changes.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x537065636966696573207468652077617920746f20706164">Specifies the way to pad</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">padding {</b> <i class="arg">statements</i> <b class="cmd">}</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
specifies the padding format. The following are valid statements:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">randomize (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enables the use of a randomized value for padding. The default is on.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">randomize_length (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The pad length will be random. The default is off.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">maximum_length</b> <i class="arg">number</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines a maximum padding length. If <b class="cmd">randomize_length</b> is off, this is ignored. The default is 20 bytes.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">exclusive_tail (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Means to put the number of pad bytes minus one into the last part of the padding. The default is on.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">strict_check (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Means to constrain the peer to set the number of pad bytes. The default is off.</dd>
</dl>
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4953414b4d50206d6f646520636f6e66696775726174696f6e2073657474696e6773">ISAKMP mode configuration settings</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">mode_cfg {</b> <i class="arg">statements</i> <b class="cmd">}</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines the information to return for remote hosts' ISAKMP mode config requests. Also defines the authentication source for remote peers authenticating through Xauth.<p>
The following are valid statements:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">auth_source (system</b> | <b class="cmd">radius</b> | <b class="cmd">pam</b> | <b class="cmd">ldap)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the source for authentication of users through Xauth. <i class="arg">system</i> means to use the Unix user database. This is the default. <i class="arg">radius</i> means to use a RADIUS server. It works only if <a class="link-man" href="../8/racoon">racoon(8)</a> was built with libradius support. Radius configuration is handled by statements in the <b class="cmd">radiuscfg</b> section. <i class="arg">pam</i> means to use PAM. It works only if <a class="link-man" href="../8/racoon">racoon(8)</a> was built with libpam support. <i class="arg">ldap</i> means to use LDAP. It works only if <a class="link-man" href="../8/racoon">racoon(8)</a> was built with libldap support. LDAP configuration is handled by statements in the <b class="cmd">ldapcfg</b> section.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">auth_groups</b> <i class="arg">group1</i>, <i class="arg">...</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the group memberships for Xauth in quoted group name strings. When defined, the authenticating user must be a member of at least one group for Xauth to succeed.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">group_source (system</b> | <b class="cmd">ldap)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the source for group validation of users through Xauth. <i class="arg">system</i> means to use the Unix user database. This is the default. <i class="arg">ldap</i> means to use LDAP. It works only if <a class="link-man" href="../8/racoon">racoon(8)</a> was built with libldap support and requires LDAP authentication. LDAP configuration is handled by statements in the <b class="cmd">ldapcfg</b> section.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">conf_source (local</b> | <b class="cmd">radius</b> | <b class="cmd">ldap)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specifies the source for IP addresses and netmask allocated through ISAKMP mode config. <i class="arg">local</i> means to use the local IP pool defined by the <b class="cmd">network4</b> and <b class="cmd">pool_size</b> statements. This is the default. <i class="arg">radius</i> means to use a RADIUS server. It works only if <a class="link-man" href="../8/racoon">racoon(8)</a> was built with libradius support and requires RADIUS authentication. RADIUS configuration is handled by statements in the <b class="cmd">radiuscfg</b> section. <i class="arg">ldap</i> means to use an LDAP server. It works only if <a class="link-man" href="../8/racoon">racoon(8)</a> was built with libldap support and requires LDAP authentication. LDAP configuration is handled by statements in the <b class="cmd">ldapcfg</b> section.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">accounting (none</b> | <b class="cmd">system</b> | <b class="cmd">radius</b> | <b class="cmd">pam)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Enables or disables accounting for Xauth logins and logouts. The default is <i class="arg">none</i> which disable accounting. Specifying <i class="arg">system</i> enables system accounting through <a class="link-man" href="../5/utmp">utmp(5)</a>. Specifying <i class="arg">radius</i> enables RADIUS accounting. It works only if <a class="link-man" href="../8/racoon">racoon(8)</a> was built with libradius support and requires RADIUS authentication. RADIUS configuration is handled by statements in the <b class="cmd">radiuscfg</b> section. Specifying <i class="arg">pam</i> enables PAM accounting. It works only if <a class="link-man" href="../8/racoon">racoon(8)</a> was build with libpam support and requires PAM authentication.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">pool_size</b> <i class="arg">size</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Specify the size of the IP address pool, either local or allocated through RADIUS. <b class="cmd">conf_source</b> selects the local pool or the RADIUS configuration, but in both configurations, you cannot have more than <i class="arg">size</i> users connected at the same time. The default is 255.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">network4</b> <i class="arg">address</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">netmask4</b> <i class="arg">address</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The local IP pool base address and network mask from which dynamically allocated IPv4 addresses should be taken. This is used if <b class="cmd">conf_source</b> is set to <i class="arg">local</i> or if the RADIUS server returned <i class="arg">255.255.255.254</i>. Default is <i class="arg">0.0.0.0/0.0.0.0</i>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">dns4</b> <i class="arg">addresses</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A list of IPv4 addresses for DNS servers, separated by commas, or on multiple <b class="cmd">dns4</b> lines.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">wins4</b> <i class="arg">addresses</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
A list of IPv4 address for WINS servers. The keyword</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
nbns4</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
can also be used as an alias for</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
wins4.</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">split_network (include</b> | <b class="cmd">local_lan)</b> <i class="arg">network/mask, ...</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The network configuration to send, in CIDR notation (e.g. 192.168.1.0/24). If <b class="cmd">include</b> is specified, the tunnel should be only used to encrypt the indicated destinations ; otherwise, if <b class="cmd">local_lan</b> is used, everything will pass through the tunnel but those destinations.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">default_domain</b> <i class="arg">domain</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The default DNS domain to send.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">split_dns</b> <i class="arg">domain</i>, <i class="arg">...</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The split dns configuration to send, in quoted domain name strings. This list can be used to describe a list of domain names for which a peer should query a modecfg assigned dns server. DNS queries for all other domains would be handled locally. (Cisco VPN client only).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">banner</b> <i class="arg">path</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The path of a file displayed on the client at connection time. Default is <i class="arg">/etc/motd</i>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">auth_throttle</b> <i class="arg">delay</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
On each failed Xauth authentication attempt, refuse new attempts for a set <i class="arg">delay</i> of seconds. This is to avoid dictionary attacks on Xauth passwords. Default is one second. Set to zero to disable authentication delay.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">pfs_group</b> <i class="arg">group</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Sets the PFS group used in the client proposal (Cisco VPN client only). Default is 0.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">save_passwd (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Allow the client to save the Xauth password (Cisco VPN client only). Default is off.</dd>
</dl>
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4c64617020636f6e66696775726174696f6e2073657474696e6773">Ldap configuration settings</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">ldapcfg {</b> <i class="arg">statements</i> <b class="cmd">}</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines the parameters that will be used to communicate with an ldap server for <b class="cmd">xauth</b> authentication.<p>
The following are valid statements:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">version (2</b> | <b class="cmd">3)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The ldap protocol version used to communicate with the server. The default is <b class="cmd">3</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">host</b> <i class="arg">(hostname</i> | <i class="arg">address)</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The host name or ip address of the ldap server. The default is <b class="cmd">localhost</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">port</b> <i class="arg">number</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The port that the ldap server is configured to listen on. The default is <b class="cmd">389</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">tls (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use TLS with the ldap server. The default is <b class="cmd">off</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">base</b> <i class="arg">distinguished name</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The ldap search base. This option has no default value.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">subtree (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Use the subtree ldap search scope. Otherwise, use the one level search scope. The default is <b class="cmd">off</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">bind_dn</b> <i class="arg">distinguished name</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The user dn used to optionally bind as before performing ldap search operations. If this option is not specified, anonymous binds are used.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">bind_pw</b> <i class="arg">string</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The password used when binding as <b class="cmd">bind_dn</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">attr_user</b> <i class="arg">attribute name</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The attribute used to specify a users name in an ldap directory. For example, if a user dn is "cn=jdoe,dc=my,dc=net" then the attribute would be "cn". The default value is <b class="cmd">cn</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">attr_addr</b> <i class="arg">attribute name</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">attr_mask</b> <i class="arg">attribute name</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The attributes used to specify a users network address and subnet mask in an ldap directory. These values are forwarded during mode_cfg negotiation when the conf_source is set to ldap. The default values are <b class="cmd">racoon-address</b> and <b class="cmd">racoon-netmask</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">attr_group</b> <i class="arg">attribute name</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The attribute used to specify a group name in an ldap directory. For example, if a group dn is "cn=users,dc=my,dc=net" then the attribute would be "cn". The default value is <b class="cmd">cn</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">attr_member</b> <i class="arg">attribute name</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The attribute used to specify group membership in an ldap directory. The default value is <b class="cmd">member</b>.</dd>
</dl>
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x52616469757320636f6e66696775726174696f6e2073657474696e6773">Radius configuration settings</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">radiuscfg {</b> <i class="arg">statements</i> <b class="cmd">}</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Defines the parameters that will be used to communicate with radius servers for <b class="cmd">xauth</b> authentication. If radius is selected as the xauth authentication or accounting source and no servers are defined in this section, settings from the system <a class="link-man" href="../5/radius.conf">radius.conf(5)</a> configuration file will be used instead.<p>
The following are valid statements:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">auth</b> <i class="arg">(hostname</i> | <i class="arg">address) [port] sharedsecret</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The host name or ip address, optional port value and shared secret value of a radius authentication server. Up to 5 radius authentication servers may be specified using multiple lines.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">acct</b> <i class="arg">(hostname</i> | <i class="arg">address) [port] sharedsecret</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The host name or ip address, optional port value and shared secret value of a radius accounting server. Up to 5 radius accounting servers may be specified using multiple lines.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">timeout</b> <i class="arg">seconds</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The timeout for receiving replies from radius servers. The default is <b class="cmd">3</b>.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">retries</b> <i class="arg">count</i>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The maximum number of repeated requests to make before giving up on a radius server. The default is <b class="cmd">3</b>.</dd>
</dl>
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x5370656369616c2064697265637469766573">Special directives</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="cmd">complex_bundle (on</b> | <b class="cmd">off)</b>;</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
defines the interpretation of proposal in the case of SA bundle. Normally &#8220;IP AH ESP IP payload&#8221; is proposed as &#8220;AH tunnel and ESP tunnel&#8221;. The interpretation is more common to other IKE implementations, however, it allows very limited set of combinations for proposals. With the option enabled, it will be proposed as &#8220;AH transport and ESP tunnel&#8221;. The default value is <b class="cmd">off</b>.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x5072651e736861726564206b65792046696c65">Pre-shared key File</h2> The pre-shared key file defines pairs of identifiers and corresponding shared secret keys which are used in the pre-shared key authentication method in phase 1. The pair in each line is separated by some number of blanks and/or tab characters like in the <a class="link-man" href="../5/hosts">hosts(5)</a> file. Key can include blanks because everything after the first blanks is interpreted as the secret key. Lines starting with &#8216;<code class="lit">#</code>&#8217; are ignored. Keys which start with &#8216;<code class="lit">0x</code>&#8217; are interpreted as hexadecimal strings. Note that the file must be owned by the user ID running <a class="link-man" href="../8/racoon">racoon(8)</a> (usually the privileged user), and must not be accessible by others.<p>
If configured with <span class="define">ENABLE_WILDCARD_MATCH</span>, this implementation allows a wildcard key &#8220;*&#8221;. This is allowed for the special case of a single user connecting to a gateway using an iPhone. On an iPhone, L2TP over IPSEC only supports main mode with pre-shared keys (no certificates). Unfortunately racoon only supports pre-shared-key lookup by address when identity protection is used, and since the iPhone does not have a specific IP address, we don't know what key to put in the pre-shared key file.<p>
Sharing the connection with more than one user is strongly discouraged because any user can pretend to be the server since they know the pre-shared key. This means that any user can steal the traffic of any other user, by spoofing DNS which is not trivial but easy. Even worse, the malicious user will be able to then steal any other authentication data (CHAP/XAUTH etc.) that another user will supply to the compromised server, because it assumes that phase 1 is secured by the pre-shared key.<p>
In summary, never use wildcard keys if your gateway is hosting more than one user.</div>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The following shows how the remote directive should be configured.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
path pre_shared_key "/usr/local/v6/etc/psk.txt" ; 
remote anonymous 
{ 
	exchange_mode aggressive,main,base; 
	lifetime time 24 hour; 
	proposal { 
		encryption_algorithm 3des; 
		hash_algorithm sha1; 
		authentication_method pre_shared_key; 
		dh_group 2; 
	} 
} 
 
sainfo anonymous 
{ 
	pfs_group 2; 
	lifetime time 12 hour ; 
	encryption_algorithm 3des, blowfish 448, twofish, rijndael ; 
	authentication_algorithm hmac_sha1, hmac_md5 ; 
	compression_algorithm deflate ; 
}</pre>
<p>
If you are configuring plain RSA authentication, the remote directive should look like the following:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
path certificate "/usr/local/v6/etc" ; 
remote anonymous 
{ 
        exchange_mode main,base ; 
        lifetime time 12 hour ; 
        certificate_type plain_rsa "/usr/local/v6/etc/myrsakey.priv"; 
        peers_certfile plain_rsa "/usr/local/v6/etc/yourrsakey.pub"; 
        proposal { 
                        encryption_algorithm aes ; 
                        hash_algorithm sha1 ; 
                        authentication_method rsasig ; 
                        dh_group 2 ; 
        } 
}</pre>
<p>
The following is a sample for the pre-shared key file.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
10.160.94.3     mekmitasdigoat 
172.16.1.133    0x12345678 
194.100.55.1    whatcertificatereally 
3ffe:501:410:ffff:200:86ff:fe05:80fa    mekmitasdigoat 
3ffe:501:410:ffff:210:4bff:fea2:8baa    mekmitasdigoat 
foo@kame.net    mekmitasdigoat 
foo.kame.net    hoge</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../8/racoon">racoon(8)</a>, <a class="link-man" href="../8/racoonctl">racoonctl(8)</a>, <a class="link-man" href="../8/setkey">setkey(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">racoon.conf</b> configuration file first appeared in the &#8220;YIPS&#8221; Yokogawa IPsec implementation.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Some statements may not be handled by <a class="link-man" href="../8/racoon">racoon(8)</a> yet.<p>
Diffie-Hellman computation can take a very long time, and may cause unwanted timeouts, specifically when a large D-H group is used.</div>
<div class="section">
<h1 id="x534543555249545920434f4e53494445524154494f4e53">SECURITY CONSIDERATIONS</h1> The use of IKE phase 1 aggressive mode is not recommended, as described in <code class="lit">http://www.kb.cert.org/vuls/id/886601</code>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
June 17, 2013</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

