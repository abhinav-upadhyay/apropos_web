<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
PF.OS(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
PF.OS(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
PF.OS(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">pf.os</b> &#8212; <span class="desc">format of the operating system fingerprints file</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <a class="link-man" href="../4/pf">pf(4)</a> firewall and the <a class="link-man" href="../8/tcpdump">tcpdump(8)</a> program can both fingerprint the operating system of hosts that originate an IPv4 TCP connection. The file consists of newline-separated records, one per fingerprint, containing nine colon (&#8216;<code class="lit">:</code>&#8217;) separated fields. These fields are as follows:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
window</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The TCP window size.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
TTL</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The IP time to live.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
df</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The presence of the IPv4 don't fragment bit.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
packet size</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The size of the initial TCP packet.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
TCP options</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
An ordered list of the TCP options.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
class</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The class of operating system.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
version</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The version of the operating system.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
subtype</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The subtype of patchlevel of the operating system.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
description</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
The overall textual description of the operating system, version and subtype.</dd>
</dl>
<p>
The <i class="arg">window</i> field corresponds to the th-&gt;th_win field in the TCP header and is the source host's advertised TCP window size. It may be between zero and 65,535 inclusive. The window size may be given as a multiple of a constant by prepending the size with a percent sign &#8216;%&#8217; and the value will be used as a modulus. Three special values may be used for the window size:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
*</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
An asterisk will wildcard the value so any window size will match.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
S</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Allow any window size which is a multiple of the maximum segment size (MSS).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
T</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Allow any window size which is a multiple of the maximum transmission unit (MTU).</dd>
</dl>
<p>
The <i class="arg">ttl</i> value is the initial time to live in the IP header. The fingerprint code will account for the volatility of the packet's TTL as it traverses a network.<p>
The <i class="arg">df</i> bit corresponds to the Don't Fragment bit in an IPv4 header. It tells intermediate routers not to fragment the packet and is used for path MTU discovery. It may be either a zero or a one.<p>
The <i class="arg">packet size</i> is the literal size of the full IP packet and is a function of all of the IP and TCP options.<p>
The <i class="arg">TCP options</i> field is an ordered list of the individual TCP options that appear in the SYN packet. Each option is described by a single character separated by a comma and certain ones may include a value. The options are:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
Mnnn</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
maximum segment size (MSS) option. The value is the maximum packet size of the network link which may include the &#8216;%&#8217; modulus or match all MSSes with the &#8216;*&#8217; value.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
N</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
the NOP option (NO Operation).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
T[0]</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
the timestamp option. Certain operating systems always start with a zero timestamp in which case a zero value is added to the option; otherwise no value is appended.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
S</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
the Selective ACKnowledgement OK (SACKOK) option.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
Wnnn</dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
window scaling option. The value is the size of the window scaling which may include the &#8216;%&#8217; modulus or match all window scalings with the &#8216;*&#8217; value.</dd>
</dl>
<p>
No TCP options in the fingerprint may be given with a single dot &#8216;.&#8217;.<p>
An example of OpenBSD's TCP options are:<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">M*,N,N,S,N,W0,N,N,T</code></div>
</blockquote>
<p>
The first option <i class="arg">M*</i> is the MSS option and will match all values. The second and third options <i class="arg">N</i> will match two NOPs. The fourth option <i class="arg">S</i> will match the SACKOK option. The fifth <i class="arg">N</i> will match another NOP. The sixth <i class="arg">W0</i> will match a window scaling option with a zero scaling size. The seventh and eighth <i class="arg">N</i> options will match two NOPs. And the ninth and final option <i class="arg">T</i> will match the timestamp option with any time value.<p>
The TCP options in a fingerprint will only match packets with the exact same TCP options in the same order.<p>
The <i class="arg">class</i> field is the class, genre or vendor of the operating system.<p>
The <i class="arg">version</i> is the version of the operating system. It is used to distinguish between different fingerprints of operating systems of the same class but different versions.<p>
The <i class="arg">subtype</i> is the subtype or patch level of the operating system version. It is used to distinguish between different fingerprints of operating systems of the same class and same version but slightly different patches or tweaking.<p>
The <i class="arg">description</i> is a general description of the operating system, its version, patchlevel and any further useful details.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The fingerprint of a plain <span class="unix">OpenBSD&#160;3.3</span> host is:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
  16384:64:1:64:M*,N,N,S,N,W0,N,N,T:OpenBSD:3.3::OpenBSD 3.3</pre>
<p>
The fingerprint of an <span class="unix">OpenBSD&#160;3.3</span> host behind a PF scrubbing firewall with a no-df rule would be:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
  16384:64:0:64:M*,N,N,S,N,W0,N,N,T:OpenBSD:3.3:!df:OpenBSD 3.3 scrub no-df</pre>
<p>
An absolutely braindead embedded operating system fingerprint could be:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
  65535:255:0:40:.:DUMMY:1.1:p3:Dummy embedded OS v1.1p3</pre>
<p>
The <a class="link-man" href="../8/tcpdump">tcpdump(8)</a> output of<p>
<pre style="margin-left: 0.00ex;" class="lit display">
  # tcpdump -s128 -c1 -nv 'tcp[13] == 2' 
  03:13:48.118526 10.0.0.1.3377 &gt; 10.0.0.2.80: S [tcp sum ok] &#92; 
      534596083:534596083(0) win 57344 &lt;mss 1460&gt; (DF) [tos 0x10] &#92; 
      (ttl 64, id 11315, len 44)</pre>
<p>
almost translates into the following fingerprint<p>
<pre style="margin-left: 0.00ex;" class="lit display">
  57344:64:1:44:M1460:	exampleOS:1.0::exampleOS 1.0</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../4/pf">pf(4)</a>, <a class="link-man" href="../5/pf.conf">pf.conf(5)</a>, <a class="link-man" href="../8/pfctl">pfctl(8)</a>, <a class="link-man" href="../8/tcpdump">tcpdump(8)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 31, 2007</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

