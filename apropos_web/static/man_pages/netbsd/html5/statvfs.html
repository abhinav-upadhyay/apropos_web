<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
STATVFS(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
STATVFS(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
STATVFS(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">statvfs</b> &#8212; <span class="desc">file system statistics</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/types.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">sys/statvfs.h</a>&gt;</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="includes">&lt;<a class="link-includes">sys/statvfs.h</a>&gt;</b> header defines the structures and functions that return information about a mounted file system. The <b class="name">statvfs</b> structure is defined as follows:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
typedef struct { int32_t val[2]; } fsid_t;	/* file system id type */ 
 
#define VFS_NAMELEN  32 	/* length of fs type name, including nul */ 
#define VFS_MNAMELEN 1024	/* length of buffer for returned name */ 
 
struct statvfs { 
	unsigned long	f_flag;	  /* copy of mount exported flags */ 
	unsigned long	f_bsize;  /* system block size */ 
	unsigned long	f_frsize; /* system fragment size */ 
	unsigned long	f_iosize; /* optimal file system block size */ 
 
	/* The following are in units of f_frsize */ 
	fsblkcnt_t	f_blocks; /* number of blocks in file system */ 
	fsblkcnt_t	f_bfree;  /* free blocks avail in file system */ 
	fsblkcnt_t	f_bavail; /* free blocks avail to non-root */ 
	fsblkcnt_t	f_bresvd; /* blocks reserved for root */ 
 
	fsfilcnt_t	f_files;  /* total file nodes in file system */ 
	fsfilcnt_t	f_ffree;  /* free file nodes in file system */ 
	fsfilcnt_t	f_favail; /* free file nodes avail to non-root */ 
	fsfilcnt_t	f_fresvd; /* file nodes reserved for root */ 
 
	uint64_t  f_syncreads;	  /* count of sync reads since mount */ 
	uint64_t  f_syncwrites;	  /* count of sync writes since mount */ 
 
	uint64_t  f_asyncreads;	  /* count of async reads since mount */ 
	uint64_t  f_asyncwrites;  /* count of async writes since mount */ 
 
	unsigned long	f_fsid;   /* POSIX compliant file system id */ 
	fsid_t          f_fsidx;  /* NetBSD compatible file system id */ 
 
	unsigned long	f_namemax;/* maximum filename length */ 
	uid_t		f_owner; /* user that mounted the file system */ 
 
	uint32_t	f_spare[4]; /* spare space */ 
 
	char	f_fstypename[VFS_NAMELEN]; /* fs type name */ 
	char	f_mntonname[VFS_MNAMELEN]; /* directory on which mounted */ 
	char	f_mntfromname[VFS_MNAMELEN]; /* mounted file system */ 
};</pre>
<p>
The <i class="farg">f_flag</i> argument can have the following bits set:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_RDONLY</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The filesystem is mounted read-only; Even the super-user may not write on it.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_NOEXEC</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Files may not be executed from the filesystem.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_NOSUID</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Setuid and setgid bits on files are not honored when they are executed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_NODEV</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Special files in the filesystem may not be opened.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_UNION</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Union with underlying filesystem instead of obscuring it.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_SYNCHRONOUS</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
All I/O to the filesystem is done synchronously.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_ASYNC</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
No filesystem I/O is done synchronously.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_NOCOREDUMP</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Don't write core dumps to this file system.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_NOATIME</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Never update access times.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_SYMPERM</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Recognize symbolic link permission.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_NODEVMTIME</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Never update modification times for device files.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_LOG</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Use logging (journalling).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_LOCAL</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The filesystem resides locally.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_QUOTA</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The filesystem has quotas enabled on it.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_ROOTFS</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Identifies the root filesystem.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_EXRDONLY</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The filesystem is exported read-only.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_EXPORTED</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The filesystem is exported for both reading and writing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_DEFEXPORTED</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The filesystem is exported for both reading and writing to any Internet host.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_EXPORTANON</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The filesystem maps all remote accesses to the anonymous user.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_EXKERB</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The filesystem is exported with Kerberos uid mapping.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_EXNORESPORT</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Don't enforce reserved ports (NFS).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">ST_EXPUBLIC</span></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
Public export (WebNFS).</dd>
</dl>
<p>
Fields that are undefined for a particular file system are set to &#45;1.</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
f_flag</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The <i class="farg">f_flag</i> field is the same as the <i class="farg">f_flags</i> field in the <span class="unix">4.3BSD</span> <a class="link-man" href="../2/statfs">statfs(2)</a> system call.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
f_fsid</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Is defined to be <i class="ftype">unsigned long</i> by the X/Open standard. Unfortunately this is not enough space to store our <i class="ftype">fsid_t</i>, so we define an additional <i class="farg">f_fsidx</i> field.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
f_bavail</dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Could historically be negative (in the <a class="link-man" href="../2/statfs">statfs(2)</a> system call) when the used space has exceeded the non-superuser free space. In order to comply with the X/Open standard, we have to define <i class="ftype">fsblkcnt_t</i> as an unsigned type, so in all cases where <i class="farg">f_bavail</i> would have been negative, we set it to 0. In addition we provide <i class="farg">f_bresvd</i> which contains the amount of reserved blocks for the superuser, so the old value of <i class="farg">f_bavail</i> can be easily computed as:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
	old_bavail = f_bfree - f_bresvd;</pre>
</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/statvfs">statvfs(2)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="includes">&lt;<a class="link-includes">sys/statvfs.h</a>&gt;</b> header first appeared in <span class="unix">NetBSD&#160;3.0</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 5, 2013</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

