<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
ALTQ.CONF(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
ALTQ.CONF(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
ALTQ.CONF(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">altq.conf</b> &#8212; <span class="desc">ALTQ configuration file</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">altq.conf</b> file contains a number of lines specifying the behavior of queueing disciplines. Comments start with a # and extend to the end of the line.<p>
The <a class="link-man" href="../8/altqd">altqd(8)</a> program reads <i class="file">/etc/altq.conf</i> at startup and sets up queueing disciplines. BLUE, CBQ (Class-Based Queueing), FIFOQ (First-In First-Out Queue), HFSC (Hierarchical Fair Service Curve), PRIQ (Priority Queueing), RED (Random Early Detection), RIO (RED with IN/OUT), WFQ (Weighted Fair Queueing), JoBS (Joint Buffer Management and Scheduling) and CDNR (Diffserv Traffic Conditioner) can be configured in this file.<div class="subsection">
<h2 id="x496e7465726661636520436f6d6d616e6473">Interface Commands</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">interface</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<i class="arg">if_name</i> &#91;<span class="opt"><b class="flag">bandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">tbrsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><i class="arg">sched_type</i></span>&#93; &#91;<span class="opt"><i class="arg">discipline-specific-options</i></span>&#93;</dd>
</dl>
<p>
The <b class="flag">interface</b> command specifies a network interface to be under control of ALTQ. One interface specification is provided for each network interface under control of ALTQ. A system configured as a router may have multiple interface specifications.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the name of a network interface (e.g., fxp0).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">bandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the interface bandwidth in bits per second. This is the maximum rate that the queueing discipline will allow on this interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tbrsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the bucket size of a token bucket regulator in bytes. When <b class="flag">tbrsize</b> is omitted, the system automatically sets the bucket size using heuristics. The token rate is set to the interface bandwidth specified by the <b class="flag">interface</b> command.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Type of a queueing discipline. It must be either <b class="flag">blue</b>, <b class="flag">cbq</b>, <b class="flag">fifoq</b>, <b class="flag">hfsc</b>, <b class="flag">jobs</b>, <b class="flag">priq</b>, <b class="flag">red</b>, <b class="flag">rio</b>, or <b class="flag">wfq</b>. If the interface has only traffic conditioners and no queueing discipline, <i class="arg">sched_type</i> can be omitted.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x436c61737320436f6d6d616e64">Class Command</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">class</b></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
<i class="arg">sched_type</i> <i class="arg">if_name</i> <i class="arg">class_name</i> <i class="arg">parent_name</i> &#91;<span class="opt"><b class="flag">red|rio</b></span>&#93; &#91;<span class="opt"><b class="flag">ecn</b></span>&#93; &#91;<span class="opt"><b class="flag">cleardscp</b></span>&#93; &#91;<span class="opt"><i class="arg">discipline-specific-options</i></span>&#93;</dd>
</dl>
<p>
The <b class="flag">class</b> command specifies a packet scheduling class for CBQ, HFSC, JoBS or PRIQ. A class specifier must be provided for each packet scheduling class.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Type of queueing discipline. Must correspond to the discipline name in interface specification.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Interface name. Must correspond to name in interface specification.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">class_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Arbitrary name for this class. Must be unique for this interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">parent_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The name of the parent class for this class (for CBQ or HFSC). Parent class must have been previously defined. PRIQ and JoBS do not have class hierarchy and parent_name must be <span class="define">NULL</span> for PRIQ and JoBS classes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">red</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Use RED (Random Early Detection) on this class queue. RED drops packets with the probability proportional to the average queue length.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rio</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Use RIO (RED with In/Out bit) on this class queue. RIO runs triple RED algorithms at the same time.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ecn</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Use RED/ECN (Explicit Congestion Notification) on this class queue (experimental implementation). ECN implies RED.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">cleardscp</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Clear diffserv codepoint in the IP header.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x46696c74657220436f6d6d616e6473">Filter Commands</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">filter</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<i class="arg">if_name</i> <i class="arg">class_name</i> &#91;<span class="opt"><b class="flag">name</b> <i class="arg">fltr_name</i></span>&#93; &#91;<span class="opt"><b class="flag">ruleno</b> <i class="arg">num</i></span>&#93; <i class="arg">filter_values</i></dd>
</dl>
<p>
The <b class="flag">filter</b> command specifies a filter to classify packets into a scheduling class. A filter specifier determines any statically-defined packet classification rules.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Name of a network interface (e.g., fxp0).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">class_name</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Name of a class or a conditioner to which matching packets are directed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">name</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Add an arbitrary name to the filter for a future reference.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ruleno</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Specifies explicit order of filter matching. Filter matching is performed from a filter with a larger ruleno. Default is 0.</dd>
</dl>
<p>
<i class="arg">filter_values</i> should be in the following format:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">filter_values</i>:</dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<i class="addr">dst_addr</i> &#91;<span class="opt"><b class="flag">netmask</b> <i class="arg">mask</i></span>&#93; <i class="arg">dport</i> <i class="addr">src_addr</i> &#91;<span class="opt"><b class="flag">netmask</b> <i class="arg">mask</i></span>&#93; <i class="arg">sport</i> <i class="arg">proto</i> &#91;<span class="opt"><b class="flag">tos</b> <i class="arg">value</i> &#91;<span class="opt"><b class="flag">tosmask</b> <i class="arg">value</i></span>&#93;</span>&#93; &#91;<span class="opt"><b class="flag">gpi</b> <i class="arg">value</i></span>&#93;</dd>
</dl>
<p>
Here <i class="addr">dst_addr</i> and <i class="addr">src_addr</i> are dotted-decimal addresses of the destination and the source respectively. An address may be followed by <b class="flag">netmask</b> keyword. <i class="arg">dport</i> and <i class="arg">sport</i> are port numbers of the destination and the source respectively. <i class="arg">proto</i> is a protocol number defined for IP packets (e.g. 6 for TCP). <b class="flag">tos</b> keyword can be used to specify the type of service field value. <b class="flag">gpi</b> keyword can be used to specify the Security Parameter Index value for IPsec.<p>
When filter value 0 is used, it is taken as a wildcard.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">filter6</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
<i class="arg">if_name</i> <i class="arg">class_name</i> &#91;<span class="opt"><b class="flag">name</b> <i class="arg">fltr_name</i></span>&#93; &#91;<span class="opt"><b class="flag">ruleno</b> <i class="arg">num</i></span>&#93; <i class="arg">filter6_values</i></dd>
</dl>
<p>
The <b class="flag">filter6</b> command is for IPv6. <i class="arg">filter6_value</i> should be in the following format:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
filter6_values:</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
<i class="addr">dst_addr</i>&#91;<span class="opt">/prefix_len</span>&#93; <i class="arg">dport</i> <i class="addr">src_addr</i>&#91;<span class="opt">/prefix_len</span>&#93; <i class="arg">sport</i> <i class="arg">proto</i> &#91;<span class="opt"><b class="flag">flowlabel</b> <i class="arg">value</i></span>&#93; &#91;<span class="opt"><b class="flag">tclass</b> <i class="arg">value</i> &#91;<span class="opt"><b class="flag">tclassmask</b> <i class="arg">value</i></span>&#93;</span>&#93; &#91;<span class="opt"><b class="flag">gpi</b> <i class="arg">value</i></span>&#93;</dd>
</dl>
<p>
Here <i class="addr">dst_addr</i> and <i class="addr">src_addr</i> are IPv6 addresses of the destination and the source respectively. An address may be followed by an optional address prefix length. <i class="arg">dport</i> and <i class="arg">sport</i> are port numbers of the destination and the source respectively. <i class="arg">proto</i> is a protocol number defined for IPv6 packets (e.g. 6 for TCP). <b class="flag">flowlabel</b> keyword can be used to specify the flowlabel field value. <b class="flag">tclass</b> keyword can be used to specify the traffic class field value. <b class="flag">gpi</b> keyword can be used to specify the Security Parameter Index value for IPsec.<p>
When filter value 0 is used, it is taken as a wildcard.</div>
<div class="subsection">
<h2 id="x43425120436f6d6d616e6473">CBQ Commands</h2> CBQ (Class Based Queueing) achieves both partitioning and sharing of link bandwidth by hierarchically structured classes. Each class has its own queue and is assigned its share of bandwidth. A child class can borrow bandwidth from its parent class as long as excess bandwidth is available.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">interface</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<i class="arg">if_name</i> &#91;<span class="opt"><b class="flag">bandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">tbrsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><i class="arg">sched_type</i></span>&#93; &#91;<span class="opt"><b class="flag">efficient</b></span>&#93;</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the name of a network interface (e.g., fxp0).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">bandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the interface bandwidth in bits per second.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tbrsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the bucket size of a token bucket regulator in bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be either <b class="flag">cbq</b>, <b class="flag">cbq-wrr</b> (weighted-round robin) or <b class="flag">cbq-prr</b> (packet-by-packet round robin). <b class="flag">cbq</b> is equivalent to <b class="flag">cbq-wrr</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">efficient</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Enables CBQ's link efficiency mode. This means that the scheduler will send a packet from the first overlimit class it encounters of all classes of the link-sharing structure when all classes are overlimit. This will also cause the scheduler to use greater than its assigned bandwidth, if the link is capable of more than the assigned bandwidth. By default, this mode is turned off. By adding the keyword <b class="flag">efficient</b> to the interface specification line, enables this mode.</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">class</b></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
<i class="arg">sched_type</i> <i class="arg">if_name</i> <i class="arg">class_name</i> <i class="arg">parent_name</i> &#91;<span class="opt"><b class="flag">admission cntlload|none</b></span>&#93; &#91;<span class="opt"><b class="flag">priority</b> <i class="arg">pri</i></span>&#93; &#91;<span class="opt"><b class="flag">pbandwidth</b> <i class="arg">percent</i></span>&#93; &#91;<span class="opt"><b class="flag">exactbandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">borrow</b></span>&#93; &#91;<span class="opt"><b class="flag">default</b></span>&#93; &#91;<span class="opt"><b class="flag">control</b></span>&#93; &#91;<span class="opt"><b class="flag">maxburst</b> <i class="arg">count</i></span>&#93; &#91;<span class="opt"><b class="flag">minburst</b> <i class="arg">count</i></span>&#93; &#91;<span class="opt"><b class="flag">maxdelay</b>&#160;<i class="arg">msec</i></span>&#93; &#91;<span class="opt"><b class="flag">packetsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><b class="flag">maxpacketsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><b class="flag">red|rio</b></span>&#93; &#91;<span class="opt"><b class="flag">ecn</b></span>&#93; &#91;<span class="opt"><b class="flag">flowvalve</b></span>&#93; &#91;<span class="opt"><b class="flag">cleardscp</b></span>&#93;</dd>
</dl>
<p>
The <b class="flag">class</b> command specifies a CBQ class. The classes are organized as a hierarchy, and every class, except for the root class, has a parent.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be <b class="flag">cbq</b> for a CBQ class.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Interface name. Must correspond to name in interface specification.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">class_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Arbitrary name for this class. Must be unique within the class hierarchy for this interface. The name <b class="flag">ctl_class</b> is a reserved class name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">parent_name</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The name of the parent class for this class or <span class="define">NULL</span> if this is the root class. Parent class must have been previously defined.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">admission</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The type of admission control and QoS type. <b class="flag">cntlload</b> is controlled load service for RSVP, otherwise, it should be <b class="flag">none</b>. The default is <b class="flag">none</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">priority</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
High numbers are higher priority. Max value is 7 and Min value is 0. Default is 1.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">pbandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The percentage of the interface bandwidth allocated to this class. Generally should add up to 100 percent at each level of the class hierarchy, although other amounts can be specified for purposes of experimentation.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">exactbandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Specify the bandwidth in bits-per-second instead of <b class="flag">pbandwidth</b>. Note that the bandwidth allocation of CBQ is not so precise but this is just a way to pass a parameter to CBQ; the user is supposed to know the detailed internals of CBQ. <b class="flag">pbandwidth</b> is a preferred way to specify the bandwidth of a class.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">borrow</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The class can borrow bandwidth from its parent class when this class is overlimit. If this keyword is not present, then no borrowing is done, and the packet is delayed or dropped when the class is overlimit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">default</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Specify the default class. When this keyword is present, all packets that do not match some classification criteria are assigned to this class. Must be exactly one class on each interface defined as the default class.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">control</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Specify the control class. When this keyword is present, the predefined control class packets (RSVP, IGMP, and ICMP) are assigned to this class. Note that when the control class is not specified by the time the default class is created, one is automatically created with default parameters. Thus, if the control class is specified, it must be listed before the default class. Must be exactly one class on each interface defined as the control class.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">maxburst</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maximum burst of back-to-back packets allowed in this class. Default is 16 but the default value is automatically reduced to 4 when the class bandwidth is small (about less than 1Mbps).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">minburst</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The minimum burst is used to obtain the steady state burst size. It's the parameter to help compute offtime for the class. Offtime is the amount of time a class is to wait between packets. Default is 2.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">maxdelay</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maxdelay is specified in milliseconds and used to obtain the max queue size of the class. If not specified, the default max queue size (30 packets) is used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">packetsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The average packet size in bytes to be used in CBQ over-/under-limit computations. Default value is MTU of the interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">maxpacketsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maximum packet size in bytes for the class. Default value is MTU of the interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">red</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables RED on this class queue.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rio</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables RIO on this class queue.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ecn</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables RED/ECN on this class queue.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">flowvalve</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables RED/flow-valve (a.k.a. red-penalty-box) on this class queue.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">cleardscp</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
clears diffserv codepoint in the IP header.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4846534320436f6d6d616e6473">HFSC Commands</h2> HFSC (Hierarchical Fair Service Curve) supports both link-sharing and guaranteed real-time services. H-FSC employs a service curve based QoS model, and its unique feature is an ability to decouple delay and bandwidth allocation. HFSC has 2 independent scheduling mechanisms. Real-time scheduling is used to guarantee the delay and the bandwidth allocation at the same time. Hierarchical link-sharing is used to distribute the excess bandwidth. When dequeueing a packet, HFSC always tries real-time scheduling first. If no packet is eligible for real-time scheduling, link-sharing scheduling is performed. HFSC does not use class hierarchy for real-time scheduling. Additionally, an upper-limit service curve can be specified for link-sharing to set the upper limit allowed for the class.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">interface</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<i class="arg">if_name</i> &#91;<span class="opt"><b class="flag">bandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">tbrsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><i class="arg">sched_type</i></span>&#93;</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the name of a network interface (e.g., fxp0).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">bandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the interface bandwidth in bits per second.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tbrsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the bucket size of a token bucket regulator in bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be <b class="flag">hfsc</b> for HFSC.</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">class</b></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
<i class="arg">sched_type</i> <i class="arg">if_name</i> <i class="arg">class_name</i> <i class="arg">parent_name</i> &#91;<span class="opt"><b class="flag">admission cntlload|none</b></span>&#93; &#91;<span class="opt">&#91;<b class="flag">sc</b> <i class="arg">m1 d m2</i>&#93;</span>&#93; &#91;<span class="opt">&#91;<b class="flag">rt</b> <i class="arg">m1 d m2</i>&#93;</span>&#93; &#91;<span class="opt">&#91;<b class="flag">ls</b> <i class="arg">m1 d m2</i>&#93;</span>&#93; &#91;<span class="opt">&#91;<b class="flag">ul</b> <i class="arg">m1 d m2</i>&#93;</span>&#93; &#91;<span class="opt"><b class="flag">pshare</b> <i class="arg">percent</i></span>&#93; &#91;<span class="opt"><b class="flag">grate</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">bandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">ulimit</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">default</b></span>&#93; &#91;<span class="opt"><b class="flag">qlimit</b> <i class="arg">count</i></span>&#93; &#91;<span class="opt"><b class="flag">red|rio</b></span>&#93; &#91;<span class="opt"><b class="flag">ecn</b></span>&#93; &#91;<span class="opt"><b class="flag">cleardscp</b></span>&#93;</dd>
</dl>
<p>
The <b class="flag">class</b> command specifies a HFSC class. The classes are organized as a hierarchy, and every class, except for the root class, has a parent.<p>
Each HFSC class has 2 service curves, the real-time service curve and the link-sharing service curve. Service curves are specified by &#91;<i class="arg">type</i> <i class="arg">m1 d m2</i>&#93;. <i class="arg">type</i> should be either <b class="flag">sc</b>, <b class="flag">rt</b>, <b class="flag">ls</b>, or <b class="flag">ul</b>. <b class="flag">sc</b> (service curve) is used to set the same values to both real-time and link-sharing service curves. <b class="flag">rt</b> (real-time) is used to specify the real-time service curve. <b class="flag">ls</b> (link-sharing) is used to specify the link-sharing service curve. <b class="flag">ul</b> (upper-limit) is used to specify the upper-limit service curve for link-sharing. <i class="arg">m1</i> is the slope of the first segment specified in bits-per-second. <i class="arg">d</i> is the x-projection of the intersection point of the 2 segments specified in milliseconds. <i class="arg">m2</i> is the slope of the second segment specified in bits-per-second.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be <b class="flag">hfsc</b> for a HFSC class.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Interface name. Must correspond to name in interface specification.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">class_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Arbitrary name for this class. Must be unique within the class hierarchy for this interface. The name <b class="flag">root</b> is a reserved class name for the root class. The root class for the interface is automatically created by the <b class="flag">interface</b> command.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">parent_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The name of the parent class for this class. Keyword <b class="flag">root</b> is used when the parent is the root class. Parent class must have been previously defined.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">admission</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The type of admission control and QoS type. <b class="flag">cntlload</b> is controlled load service for RSVP, otherwise, it should be <b class="flag">none</b>. The default is <b class="flag">none</b>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">pshare</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Percent of the link share. This specifies a linear link-sharing service curve as a fraction of the link bandwidth. It is a short hand of <code class="lit">[ls 0 0 (link-bandwidth * percent / 100)]</code>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">grate</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Guaranteed rate. This specifies a linear real-time service curve. It is a short hand of <code class="lit">[rt 0 0 bps]</code>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">bandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
This is a short hand of <code class="lit">[sc 0 0 bps]</code>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ulimit</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Upper limit rate. This specifies a upper-limit service curve. It is a short hand of <code class="lit">[ul 0 0 bps]</code>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">default</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Specify the default class. When this keyword is present, all packets that do not match some classification criteria are assigned to this class. Must be exactly one class on each interface defined as the default class.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">qlimit</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maximum queue size in number of packets. Default value is 50.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">red</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables RED on this class queue.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rio</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables RIO on this class queue.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ecn</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables RED/ECN on this class queue.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">cleardscp</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
clears diffserv codepoint in the IP header.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x5052495120436f6d6d616e6473">PRIQ Commands</h2> PRIQ (Priority Queueing) implements a simple priority-based queueing. A higher priority class is always served first. Up to 16 priorities can be used with PRIQ.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">interface</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<i class="arg">if_name</i> &#91;<span class="opt"><b class="flag">bandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">tbrsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><i class="arg">sched_type</i></span>&#93;</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the name of a network interface (e.g., fxp0).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">bandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the interface bandwidth in bits per second.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tbrsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the bucket size of a token bucket regulator in bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be <b class="flag">priq</b> for PRIQ.</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">class</b></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
<i class="arg">sched_type</i> <i class="arg">if_name</i> <i class="arg">class_name</i> <i class="arg">parent_name</i> &#91;<span class="opt"><b class="flag">priority</b> <i class="arg">pri</i></span>&#93; &#91;<span class="opt"><b class="flag">default</b></span>&#93; &#91;<span class="opt"><b class="flag">qlimit</b> <i class="arg">count</i></span>&#93; &#91;<span class="opt"><b class="flag">red|rio</b></span>&#93; &#91;<span class="opt"><b class="flag">ecn</b></span>&#93; &#91;<span class="opt"><b class="flag">cleardscp</b></span>&#93;</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be <b class="flag">priq</b> for a PRIQ class.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Interface name. Must correspond to name in interface specification.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">class_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Arbitrary name for this class. Must be unique for this interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">parent_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Parent class must be <span class="define">NULL</span> for PRIQ.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">priority</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
High numbers are higher priority. Max value is 15 and Min value is 0. Default is 0. A higher priority class is always served first in PRIQ. Priority must be unique for the interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">default</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Specify the default class. When this keyword is present, all packets that do not match some classification criteria are assigned to this class. Must be exactly one class on each interface defined as the default class.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">qlimit</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maximum queue size in number of packets. Default value is 50.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">red</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables RED on this class queue.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rio</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables RIO on this class queue.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ecn</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables RED/ECN on this class queue.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">cleardscp</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
clears diffserv codepoint in the IP header.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x57465120436f6d6d616e6473">WFQ Commands</h2> WFQ (Weighted Fair Queueing) implements a weighted-round robin scheduler for a set of queue. A weight can be assigned to each queue to give a different proportion of the link capacity. A hash function is used to map a flow to one of a set of queues, and thus, it is possible for two different flows to be mapped into the same queue.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">interface</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<i class="arg">if_name</i> &#91;<span class="opt"><b class="flag">bandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">tbrsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><i class="arg">sched_type</i></span>&#93; &#91;<span class="opt"><b class="flag">nqueues</b> <i class="arg">count</i></span>&#93; &#91;<span class="opt"><b class="flag">qsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><b class="flag">hash</b> <i class="arg">policy</i></span>&#93;</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">if_name</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the name of a network interface (e.g., fxp0).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">bandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the interface bandwidth in bits per second.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tbrsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the bucket size of a token bucket regulator in bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be <b class="flag">wfq</b> for WFQ.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">nqueues</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The number of queues in WFQ. Default value is 256.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">qsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The size of each queue in number of bytes. Default value is 64K bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">hash</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Type of hash policy to select a queue. <b class="flag">dstaddr</b> specifies a hashing policy by IP destination address. <b class="flag">full</b> specifies a hashing policy by IP addresses and ports. <b class="flag">srcport</b> specifies a hashing policy by IP source port number. <b class="flag">srcaddr</b> specifies a hashing policy by IP source address. Default is <b class="flag">dstaddr</b></dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4649464f5120436f6d6d616e6473">FIFOQ Commands</h2> FIFOQ (First-In First-Out Queueing) is a simple tail-drop FIFO queue. FIFOQ is the simplest possible implementation of a queueing discipline in ALTQ, and can be used to compare with other queueing disciplines. FIFOQ can be also used as a template for those who want to write their own queueing disciplines.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">interface</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<i class="arg">if_name</i> &#91;<span class="opt"><b class="flag">bandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">tbrsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><i class="arg">sched_type</i></span>&#93; &#91;<span class="opt"><b class="flag">qlimit</b> <i class="arg">count</i></span>&#93;</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the name of a network interface (e.g., fxp0).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">bandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the interface bandwidth in bits per second.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tbrsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the bucket size of a token bucket regulator in bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be <b class="flag">fifoq</b> for FIFOQ.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">qlimit</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maximum queue size in number of packets. Default value is 50.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x52454420436f6d6d616e6473">RED Commands</h2> RED (Random Early Detection) is an implicit congestion notification mechanism that exercises packet dropping or packet marking stochastically according to the average queue length. RED can be viewed as a buffer management mechanism and can be integrated into other packet scheduling schemes.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">red</b></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
<i class="arg">min_th</i> <i class="arg">max_th</i> <i class="arg">inv_pmax</i></dd>
</dl>
<p>
The <b class="flag">red</b> command sets the default RED parameters. <i class="arg">min_th</i> and <i class="arg">max_th</i> are the minimum and the maximum threshold values. <i class="arg">inv_pmax</i> is the inverse (reciprocal) of the maximum drop probability. For example, 10 means the maximum drop probability of 1/10.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">interface</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<i class="arg">if_name</i> &#91;<span class="opt"><b class="flag">bandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">tbrsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><i class="arg">sched_type</i></span>&#93; &#91;<span class="opt"><b class="flag">qlimit</b> <i class="arg">count</i></span>&#93; &#91;<span class="opt"><b class="flag">packetsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><b class="flag">weight</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">thmin</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">thmax</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">invpmax</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">ecn</b></span>&#93; &#91;<span class="opt"><b class="flag">flowvalve</b></span>&#93;</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the name of a network interface (e.g., fxp0).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">bandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the interface bandwidth in bits per second.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tbrsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the bucket size of a token bucket regulator in bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be <b class="flag">red</b> for RED.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">qlimit</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maximum queue size in number of packets. Default value is 60.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">packetsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The average packet size in number of bytes. This parameter is used to calibrate the idle period. Default value is 1000.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">weight</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The inverse of the weight of EWMA (exponentially weighted moving average).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">thmin</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The minimum threshold.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">thmax</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maximum threshold.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">invpmax</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The inverse of the maximum drop probability.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ecn</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables ECN.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">flowvalve</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables flowvalve.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x52494f20436f6d6d616e6473">RIO Commands</h2> ALTQ/RIO has 3 drop precedence levels defined for the Assured Forwarding of DiffServ (RFC2597). Since adaptive flows are likely to stay under the medium drop precedence level under congestion, the medium drop precedence would protect adaptive flows from unadaptive flows.<p>
The original RIO has 2 sets of RED parameters; one for in-profile packets and the other for out-of-profile packets. At the ingress of the network, profile meters tag packets as IN or OUT based on contracted profiles for customers. Inside the network, IN packets receive preferential treatment by the RIO dropper. It is possible to provision the network not to drop IN packets at all by providing enough capacity for the total volume of IN packets. Thus, RIO can be used to provide a service that statistically assures capacity allocated for users. This mechanism can be extended to support an arbitrary number of drop precedence levels. ALTQ supports 3 drop precedence levels.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rio</b></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
<i class="arg">low_min_th</i> <i class="arg">low_max_th</i> <i class="arg">low_inv_pmax</i> <i class="arg">medium_min_th</i> <i class="arg">medium_max_th</i> <i class="arg">medium_inv_pmax</i> <i class="arg">high_min_th</i> <i class="arg">high_max_th</i> <i class="arg">high_inv_pmax</i></dd>
</dl>
<p>
The <b class="flag">rio</b> command sets the default RIO parameters. The parameters are RED parameters for 3 (low, medium, high) drop precedence.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">interface</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<i class="arg">if_name</i> &#91;<span class="opt"><b class="flag">bandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">tbrsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><i class="arg">sched_type</i></span>&#93; &#91;<span class="opt"><b class="flag">qlimit</b> <i class="arg">count</i></span>&#93; &#91;<span class="opt"><b class="flag">packetsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><b class="flag">weight</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">lo_thmin</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">lo_thmax</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">lo_invpmax</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">med_thmin</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">med_thmax</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">med_invpmax</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">hi_thmin</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">hi_thmax</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">hi_invpmax</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">ecn</b></span>&#93;</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the name of a network interface (e.g., fxp0).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">bandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the interface bandwidth in bits per second.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tbrsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the bucket size of a token bucket regulator in bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be <b class="flag">rio</b> for RIO.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">qlimit</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maximum queue size in number of packets. Default value is 60.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">packetsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The average packet size in number of bytes. This parameter is used to calibrate the idle period. Default value is 1000.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">weight</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The inverse of the weight of EWMA (exponentially weighted moving average).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">lo_thmin</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The minimum threshold for low drop precedence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">lo_thmax</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maximum threshold for low drop precedence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">lo_invpmax</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The inverse of the maximum drop probability for low drop precedence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">med_thmin</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The minimum threshold for medium drop precedence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">med_thmax</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maximum threshold for medium drop precedence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">med_invpmax</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The inverse of the maximum drop probability for medium drop precedence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">hi_thmin</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The minimum threshold for high drop precedence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">hi_thmax</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maximum threshold for high drop precedence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">hi_invpmax</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The inverse of the maximum drop probability for high drop precedence.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ecn</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables ECN.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x424c554520436f6d6d616e6473">BLUE Commands</h2><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">interface</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<i class="arg">if_name</i> &#91;<span class="opt"><b class="flag">bandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">tbrsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><i class="arg">sched_type</i></span>&#93; &#91;<span class="opt"><b class="flag">qlimit</b> <i class="arg">count</i></span>&#93; &#91;<span class="opt"><b class="flag">packetsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><b class="flag">maxpmark</b> <i class="arg">n</i></span>&#93; &#91;<span class="opt"><b class="flag">holdtime</b> <i class="arg">usec</i></span>&#93; &#91;<span class="opt"><b class="flag">ecn</b></span>&#93;</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the name of a network interface (e.g., fxp0).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">bandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the interface bandwidth in bits per second.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tbrsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the bucket size of a token bucket regulator in bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be <b class="flag">blue</b> for BLUE.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">qlimit</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The maximum queue size in number of packets. Default value is 60.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">packetsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
The average packet size in number of bytes. Default value is 1000.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">maxpmark</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the precision of marking probability.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">holdtime</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the hold time in usec.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">ecn</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
enables ECN.</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x43444e5220436f6d6d616e6473">CDNR Commands</h2> The <b class="flag">conditioner</b> command specifies a diffserv traffic conditioner. A traffic conditioner is not a queueing discipline but a component to meter, mark or drop incoming packets according to some rules.<p>
As opposed to a queueing discipline, a traffic conditioner handles incoming packets at an input interface. If no queueing discipline (e.g., CBQ) is used for the interface, a null interface command should be used to specify an input network interface.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">interface</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<i class="arg">if_name</i> &#91;<span class="opt"><b class="flag">bandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">tbrsize</b> <i class="arg">bytes</i></span>&#93;</dd>
</dl>
<p>
The <b class="flag">conditioner</b> command has the following syntax.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">conditioner</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
<i class="arg">if_name</i> <i class="arg">cdnr_name</i> &#60;action&#62;</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Interface name. Must correspond to name in interface specification.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">cdnr_name</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Arbitrary name for this conditioner. Must be unique for this interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">action</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Action of the conditioner.</dd>
</dl>
<p>
An action can be a recursively defined action. The following actions are defined.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">pass</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-inset">
<dt class="list-inset" style="margin-top: 1.00em;">
<b class="flag">pass</b></dt>
<dd class="list-inset">
allows the packet to go through without any modification to the packet.</dd>
</dl>
</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">drop</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-inset">
<dt class="list-inset" style="margin-top: 1.00em;">
<b class="flag">drop</b></dt>
<dd class="list-inset">
rejects the packet. The packet is immediately discarded.</dd>
</dl>
</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">mark</b></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
<i class="arg">value</i><dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-inset">
<dt class="list-inset" style="margin-top: 1.00em;">
<b class="flag">mark</b></dt>
<dd class="list-inset">
sets the specified value to the ds field in the IP header. Then, the packet is allowed to go through.</dd>
</dl>
</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tbmeter</b></dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
<i class="arg">rate depth</i> &#60;in_action&#62; &#60;out_action&#62;<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-inset">
<dt class="list-inset" style="margin-top: 1.00em;">
<b class="flag">tbmeter</b></dt>
<dd class="list-inset">
is a token bucket meter configured with rate and depth parameters. Rate is token rate in bits-per-second. Depth is bucket depth in KB. When an incoming packet is in profile (available token is more than the packet size), tbmeter takes in_action. Otherwise, tbmeter takes out_action.</dd>
</dl>
</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">trtcm</b></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
<i class="arg">cmtd_rate cmtd_depth peak_rate peak_depth</i> &#60;green_action&#62; &#60;yellow_action&#62; &#60;red_action&#62; &#91;<span class="opt"><b class="flag">coloraware|colorblind</b></span>&#93;<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-inset">
<dt class="list-inset" style="margin-top: 1.00em;">
<b class="flag">trtcm</b></dt>
<dd class="list-inset">
is a 2-rate 3 color marker for Assured Forwarding. A trtcm consists of 2 token buckets, one for a committed rate and the other for a peak rate. When an incoming packet is in the committed profile, trtcm takes green_action. When the packet is out of the committed profile but in the peak profile, trtcm takes yellow_action. Otherwise, tbtcm takes red_action. A trtcm is either color-aware or color-blind. A color-aware trtcm do not raise the color (ds field value), that is, a yellow packet can be yellow or red but can not be blue. Default is color-blind.</dd>
</dl>
</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tswtcm</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
<i class="arg">cmtd_rate peak_rate avg_interval</i> &#60;green_action&#62; &#60;yellow_action&#62; &#60;red_action&#62;<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-inset">
<dt class="list-inset" style="margin-top: 1.00em;">
<b class="flag">tswtcm</b></dt>
<dd class="list-inset">
is a time sliding window 3 color marker for Assured Forwarding. A tswtcm differs from trtcm in that a tswtcm probabilistically marks packets. A tswtcm consists of 2 rates, one for a committed rate and the other for a peak rate. When an incoming packet is in the committed profile, tswtcm takes green_action. When the packet is out of the committed profile but in the peak profile, tswtcm takes yellow_action. Otherwise, tswtcm takes red_action. cmtd_rate and peak_rate are specified in bits per second. avg_interval provides the size of time window for averaging incoming rate, and is specified in milliseconds. 500 msec is ok for normal settings.</dd>
</dl>
</dd>
</dl>
</div>
<div class="subsection">
<h2 id="x4a6f425320436f6d6d616e6473">JoBS Commands</h2> JoBS (Joint Buffer Management and Scheduling) is a queuing discipline that can enforce any feasible mix of absolute and proportional guarantees on packet losses, packet delays, and throughput, for classes of traffic, on a per-hop basis. No admission control is performed, thus if the set of service guarantees becomes infeasible, some service guarantees may be relaxed.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">interface</b></dt>
<dd class="list-tag" style="margin-left: 9.00ex;">
<i class="arg">if_name</i> &#91;<span class="opt"><b class="flag">bandwidth</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">qlimit</b> <i class="arg">count</i></span>&#93; &#91;<span class="opt"><b class="flag">separate</b></span>&#93; &#91;<span class="opt"><b class="flag">tbrsize</b> <i class="arg">bytes</i></span>&#93; &#91;<span class="opt"><i class="arg">sched_type</i></span>&#93;</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the name of a network interface (e.g., fxp0).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">bandwidth</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the interface bandwidth in bits per second.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">qlimit</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the maximum queue size in number of packets.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">separate</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies that classes have independent buffers. The default is to have a shared buffer for all classes. If this option is specified, qlimit applies to each independent buffer.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">tbrsize</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
specifies the bucket size of a token bucket regulator in bytes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be <b class="flag">jobs</b> for JoBS.</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">class</b></dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
<i class="arg">sched_type</i> <i class="arg">if_name</i> <i class="arg">class_name</i> <i class="arg">parent_name</i> &#91;<span class="opt"><b class="flag">priority</b> <i class="arg">pri</i></span>&#93; &#91;<span class="opt"><b class="flag">default</b></span>&#93; &#91;<span class="opt"><b class="flag">adc</b> <i class="arg">microsecs</i></span>&#93; &#91;<span class="opt"><b class="flag">alc</b> <i class="arg">fraction</i></span>&#93; &#91;<span class="opt"><b class="flag">arc</b> <i class="arg">bps</i></span>&#93; &#91;<span class="opt"><b class="flag">rdc</b> <i class="arg">prop</i></span>&#93; &#91;<span class="opt"><b class="flag">rlc</b> <i class="arg">prop</i></span>&#93;</dd>
</dl>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">sched_type</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
must be <b class="flag">jobs</b> for a JoBS class.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">if_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Interface name. Must correspond to name in interface specification.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">class_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Arbitrary name for this class. Must be unique for this interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="arg">parent_name</i></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Parent class must be <span class="define">NULL</span> for JoBS.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">priority</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Priority index used for proportional differentiation. Max value is 15 and Min value is 0. Default is 0. Priority must be unique for the interface.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">default</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Specify the default class. When this keyword is present, all packets that do not match some classification criteria are assigned to this class. Must be exactly one class on each interface defined as the default class.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">adc</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Specifies an upper bound on delays for that class (in microseconds). A value of &#45;1 will indicate the absence of delay bound. By default, no delay bound is offered.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">alc</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Specifies a upper bound on loss rate for that class (in fraction of 1, for instance a 1% loss rate bound will be expressed as 0.01). A value of &#45;1 will indicate the absence of loss rate bound. By default, no loss rate bound is offered.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">arc</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Specifies a lower bound on the throughput received by that class (in bits per second). A value of &#45;1 will indicate the absence of throughput bound. By default, no throughput bound is offered.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rdc</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Specifies a proportional delay differentiation factor between that class and the class with the successive priority index. For instance, for priority 1, an rdc of 2 specifies that the delays of packets marked as class 2 will roughly be twice the delays of packets marked as class 1. A value of &#45;1 indicates the absence of proportional differentiation on that class. Note that class N if N is the maximum priority should have a dummy coefficient different from &#45;1 if proportional delay differentiation is desired on Class N. By default, no proportional delay differentiation is offered.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">rlc</b></dt>
<dd class="list-tag" style="margin-left: 8.00ex;">
Specifies a proportional loss differentiation factor between that class and the class with the successive priority index. For instance, for priority 1, an rlc of 2 specifies that the loss rate of packets marked as class 2 will roughly be twice the loss rate of packets marked as class 1. A value of &#45;1 indicates the absence of proportional differentiation on that class. Note that class N if N is the maximum priority should have a dummy coefficient different from &#45;1 if proportional loss differentiation is desired on Class N. By default, no proportional loss differentiation is offered.</dd>
</dl>
</div>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1><div class="subsection">
<h2 id="x434251204578616d706c65">CBQ Example</h2><pre style="margin-left: 0.00ex;" class="lit display">
# 
# cbq configuration for vx0 (10Mbps ether) 
# give at least 40% to TCP 
# limit HTTP from network 133.138.1.0 up to 10%, use RED. 
# other traffic goes into default class 
# 
interface vx0 bandwidth 10M cbq 
# 
class cbq vx0 root_class NULL priority 0 pbandwidth 100 
class cbq vx0 def_class root_class borrow pbandwidth 95 default 
class cbq vx0 tcp_class def_class borrow pbandwidth  40 
        filter vx0 tcp_class 0 0 0 0 6 
class cbq vx0 csl_class tcp_class pbandwidth  10   red 
        filter vx0 csl_class 0 0 133.138.1.0 netmask 0xffffff00 80 6 
        filter vx0 csl_class 133.138.1.0 netmask 0xffffff00 0 0 80 6 
# 
# sample filter6 command 
# 
                filter6 vx0 csl_class ::0 0 2001:db8:0:123::/64 80 6</pre>
</div>
<div class="subsection">
<h2 id="x48465343204578616d706c65">HFSC Example</h2><pre style="margin-left: 0.00ex;" class="lit display">
# 
# hfsc configuration for hierarchical sharing 
# 
interface pvc0 bandwidth 45M hfsc 
# 
# (10% of the bandwidth share goes to the default class) 
class hfsc pvc0 def_class root pshare 10 default 
# 
#          bandwidth share    guaranteed rate 
#    CMU:       45%             15Mbps 
#    PITT:      45%             15Mbps 
# 
class hfsc pvc0 cmu  root pshare 45 grate 15M 
class hfsc pvc0 pitt root pshare 45 grate 15M 
# 
# CMU      bandwidth share    guaranteed rate 
#    CS:        20%             10Mbps 
#    other:     20%              5Mbps 
# 
class hfsc pvc0 cmu_other cmu  pshare 20 grate 10M 
        filter pvc0 cmu_other   0 0 128.2.0.0   netmask 0xffff0000 0 0 
class hfsc pvc0 cmu_cs    cmu  pshare 20 grate  5M 
        filter pvc0 cmu_cs      0 0 128.2.242.0 netmask 0xffffff00 0 0 
# 
# PITT     bandwidth share    guaranteed rate 
#    CS:        20%             10Mbps 
#    other:     20%              5Mbps 
# 
class hfsc pvc0 pitt_other pitt  pshare 20 grate 10M 
        filter pvc0 pitt_other  0 0 136.142.0.0  netmask 0xffff0000 0 0 
class hfsc pvc0 pitt_cs    pitt  pshare 20 grate  5M 
        filter pvc0 pitt_cs     0 0 136.142.79.0 netmask 0xffffff00 0 0</pre>
</div>
<div class="subsection">
<h2 id="x48465343204578616d706c65202873696d706c6572206f6e65207769746820756c696d697429">HFSC Example (simpler one with ulimit)</h2><pre style="margin-left: 0.00ex;" class="lit display">
# 
interface fxp0 bandwidth 90M hfsc 
# reserve 20% for default class 
class hfsc fxp0 def_class root pshare 20 default 
# shared class for TCP and UDP 
class hfsc fxp0 shared_class root bandwidth 72M 
# shared class for all TCP 
class hfsc fxp0 tcp_shared shared_class bandwidth 40M ulimit 60M 
# generic tcp 
class hfsc fxp0 tcp_class tcp_shared bandwidth 15M ulimit 50M 
	filter fxp0 tcp_class 0 0 0 0 6 
# http 
class hfsc fxp0 http_class tcp_shared bandwidth 25M ulimit 40M 
	filter fxp0 http_class 0 80 0 0 6 
	filter fxp0 http_class 0 0 0 80 6 
# udp 
class hfsc fxp0 udp_class shared_class bandwidth 15M ulimit 20M 
	filter fxp0 udp_class 0 0 0 0 17</pre>
</div>
<div class="subsection">
<h2 id="x50524951204578616d706c65">PRIQ Example</h2><pre style="margin-left: 0.00ex;" class="lit display">
# 
# priq configuration for fxp0 (100Mbps ether) 
#     icmp: high priority 
#     tcp:  medium priority 
#     others: low priority 
# 
interface fxp0 bandwidth 100M priq 
# 
class priq fxp0 high_class NULL priority 2 
        filter fxp0 high_class 0 0 0 0 1 
class priq fxp0 med_class NULL priority 1 
        filter fxp0 med_class 0 0 0 0 6 
class priq fxp0 low_class NULL priority 0 default</pre>
</div>
<div class="subsection">
<h2 id="x574651204578616d706c65">WFQ Example</h2><pre style="margin-left: 0.00ex;" class="lit display">
interface pvc0 bandwidth 134000000 wfq</pre>
</div>
<div class="subsection">
<h2 id="x4649464f51204578616d706c65">FIFOQ Example</h2><pre style="margin-left: 0.00ex;" class="lit display">
interface rl0 bandwidth 10M fifoq</pre>
</div>
<div class="subsection">
<h2 id="x436f6e646974696f6e6572204578616d706c65">Conditioner Example</h2><pre style="margin-left: 0.00ex;" class="lit display">
# 
interface fxp0 
# 
# a simple dropper 
# discard all packets from 192.168.0.83 
# 
conditioner fxp0 dropper &lt;drop&gt; 
        filter fxp0 dropper 0 0 192.168.0.83 0 0 
 
# 
# EF conditioner 
# mark EF to all packets from 192.168.0.117 
# 
conditioner pvc1 ef_cdnr &lt;tbmeter 6M 64K &lt;mark 0xb8&gt;&lt;drop&gt;&gt; 
        filter fxp0 ef_cdnr 0 0 192.168.0.117 0 0 
 
# 
# AF1x conditioner 
# mark AF1x to packets from 192.168.0.178 
#       AF11 (low drop precedence):    less than 3Mbps 
#       AF12 (medium drop precedence): more than 3Mbps and less than 10Mbps 
#       AF13 (high drop precedence):   more than 10Mbps 
# 
conditioner fxp0 af1x_cdnr &lt;trtcm 3M 32K 10M 64K &lt;mark 0x28&gt;&lt;mark 0x30&gt;&lt;mark 0x38&gt;&gt; 
        filter fxp0 af1x_cdnr 0 0 192.168.0.178 0 0</pre>
</div>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../8/altqd">altqd(8)</a></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> This man page is incomplete. For more information read the source.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
September 10, 2008</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

