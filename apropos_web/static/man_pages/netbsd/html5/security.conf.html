<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
SECURITY.CONF(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
SECURITY.CONF(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
SECURITY.CONF(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">security.conf</b> &#8212; <span class="desc">daily security check configuration file</span></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">security.conf</b> file specifies which of the standard <i class="file">/etc/security</i> services are performed. The <i class="file">/etc/security</i> script is run, by default, every night from <i class="file">/etc/daily</i>, on a <span class="unix">NetBSD</span> system, if configured do to so from <i class="file">/etc/daily.conf</i>.<p>
The variables described below can be set to "NO" to disable the test:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_passwd</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This checks the <i class="file">/etc/master.passwd</i> file for inconsistencies.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_group</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This checks the <i class="file">/etc/group</i> file for inconsistencies.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_rootdotfiles</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This checks the root users startup files for sane settings of $PATH and umask. This test is not fail safe and any warning generated from this should be checked for correctness.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_ftpusers</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This checks that the correct users are in the <i class="file">/etc/ftpusers</i> file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_aliases</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This checks for security problems in the <i class="file">/etc/mail/aliases</i> file. For backward compatibility, <i class="file">/etc/aliases</i> will be checked as well if exists.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_rhosts</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This checks for system and user rhosts files with "+" in them.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_homes</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This checks that home directories are owned by the correct user, and have appropriate permissions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_varmail</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This checks that the correct user owns mail in <i class="file">/var/mail</i>, and that the mail box has the right permissions.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_nfs</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This checks that the <i class="file">/etc/exports</i> file does not export filesystems to the world.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_devices</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This checks for changes to devices and setuid files.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_mtree</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This runs <a class="link-man" href="../8/mtree">mtree(8)</a> to ensure that the system is installed correctly. The following configuration files are checked:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="file">/etc/mtree/special</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Default files to check.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="file">/etc/mtree/special.local</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Local site additions and overrides.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="file">/etc/mtree/DIR.secure</i></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
Specification for the directory <i class="file">DIR</i>.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_disklabels</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Backup text copies of the disklabels of available disk drives into <i class="file">/var/backups/work/disklabel.XXX</i>, and display any differences in those and the previous copies as per <span class="symb">check_changelist</span> below. If <a class="link-man" href="../8/fdisk">fdisk(8)</a> is available on the current platform, the output of <i class="file">/sbin/fdisk</i> for each available disk drive is stored in <i class="file">/var/backups/work/fdisk.XXX</i>, and any differences displayed as per the disklabels.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_pkgs</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This stores a list of all installed pkgs into <i class="file">/var/backups/work/pkgs</i> and checks it for any changes.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_changelist</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
This determines a list of files from the contents of <i class="file">/etc/changelist</i>, and the output of <b class="cmd">mtree -D</b> for <i class="file">/etc/mtree/special</i> and <i class="file">/etc/mtree/special.local</i>. For each file in the list it compares the files with their backups in <i class="file">/var/backups/file.current</i> and <i class="file">/var/backups/file.backup</i>, and displays any differences found. The following <a class="link-man" href="../8/mtree">mtree(8)</a> <span class="symb">tags</span> modify how files are determined from <i class="file">/etc/mtree/special</i> and <i class="file">/etc/mtree/special.local</i>:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
exclude</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The entry is ignored; no backups are made and the differences are not displayed. This includes dynamic or binary files such as <i class="file">/var/run/utmp</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
nodiff</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
The entry is backed up but the differences are not displayed because the contents of the file are sensitive. This includes files such as <i class="file">/etc/master.passwd</i>.</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_pkg_vulnerabilities</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Checks the currently installed packages against a database of known vulnerabilities and reports those that are vulnerable. Check the <span class="symb">fetch_pkg_vulnerabilities</span> setting in <a class="link-man" href="../5/daily.conf">daily.conf(5)</a> to keep the database up to date.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_pkg_signatures</span></dt>
<dd class="list-tag" style="margin-left: 25.00ex;">
Checks the digital signature of all files installed by packages against the expected values stored in the packages database.</dd>
</dl>
<p>
The variables described below can be set to modify the tests:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_homes_permit_usergroups</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
During the <span class="symb">check_homes</span> phase, allow the checked files to be group-writable if the group name is the same as the username.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_homes_permit_other_owner</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
During the <span class="symb">check_homes</span> phase, allow the home directory and files of the listed users to be owned by a different user.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_devices_ignore_fstypes</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Lists filesystem types to ignore during the <span class="symb">check_devices</span> phase. Prefixing the type with a &#8216;!&#8217; inverts the match. For example, &#8216;<code class="lit">procfs !local</code>&#8217; will ignore &#8216;<code class="lit">procfs</code>&#8217; type filesystems and filesystems that are not &#8216;<code class="lit">local</code>&#8217;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_devices_ignore_paths</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Lists pathnames to ignore during the <span class="symb">check_devices</span> phase. Prefixing the path with a &#8216;!&#8217; inverts the match. For example, &#8216;<code class="lit">/tftp</code>&#8217; will ignore paths under <i class="file">/tftp</i> while &#8216;<code class="lit">!/home</code>&#8217; will ignore paths that are not under <i class="file">/home</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_mtree_follow_symlinks</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
During the <span class="symb">check_mtree</span> phase, instruct mtree to follow symbolic links. Please note, this may cause the <span class="symb">check_mtree</span> phase to report errors for entries for these symbolic links (i.e. of type=link in the mtree specification) as they will always appear to be plain files for the purposes of the check. <i class="file">/etc/mtree/special.local</i> may be used to override the checks for the affected links.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_passwd_nowarn_shells</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
If <span class="symb">check_passwd</span> is enabled, most warnings will be suppressed for entries whose shells are listed in this space-separated list. This is of particular value when those shells are not in <i class="file">/etc/shells</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_passwd_nowarn_users</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
If <span class="symb">check_passwd</span> is enabled, suppress warnings for these users.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_passwd_permit_dups</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
If <span class="symb">check_passwd</span> is enabled, do not warn about duplicate uids for the listed login names.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_passwd_permit_nonalpha</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
If <span class="symb">check_passwd</span> is enabled, do not warn about login names which use non-alphanumeric characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">check_passwd_permit_star</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
If <span class="symb">check_passwd</span> is enabled, do not warn about password fields set to &#8220;*&#8221;. Note that the use of password fields such as &#8220;*ssh&#8221; is encouraged, instead.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">max_grouplen</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
If <span class="symb">check_group</span> is enabled, this determines the maximum permitted length of group names.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">max_loginlen</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
If <span class="symb">check_passwd</span> is enabled, this determines the maximum permitted length of login names.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">backup_dir</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Change the backup directory from <i class="file">/var/backup</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">diff_options</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Specify the options passed to <a class="link-man" href="../1/diff">diff(1)</a> when it is invoked to show changes made to system files. Defaults to &#8220;-u&#8221;, for unified-format context-diffs.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">pkgdb_dir</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
<span class="emph">DEPRECATED</span>. Please set <span class="define">PKGDB_DIR</span> in <a class="link-man" href="../5/pkg_install.conf">pkg_install.conf(5)</a> instead.<p>
If defined, points to the location of the packages database. Defaults to <i class="file">/var/db/pkg</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="symb">backup_uses_rcs</span></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
Use <a class="link-man" href="../1/rcs">rcs(1)</a> for maintaining backup copies of files noted in <span class="symb">check_devices</span>, <span class="symb">check_disklabels</span>, <span class="symb">check_pkgs</span>, and <span class="symb">check_changelist</span> instead of just keeping a current copy and a backup copy.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/defaults/security.conf</i></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
defaults for /etc/security.conf</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/security</i></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
daily security check script</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/security.conf</i></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
daily security check configuration</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/security.local</i></dt>
<dd class="list-tag" style="margin-left: 27.00ex;">
local site additions to <i class="file">/etc/security</i></dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../5/daily.conf">daily.conf(5)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">security.conf</b> file appeared in <span class="unix">NetBSD&#160;1.3</span>. The <span class="symb">check_disklabels</span> functionality was added in <span class="unix">NetBSD&#160;1.4</span>. The <span class="symb">backup_uses_rcs</span> and <span class="symb">check_pkgs</span> features were added in <span class="unix">NetBSD&#160;1.6</span>. <span class="symb">diff_options</span> appeared in <span class="unix">NetBSD&#160;2.0</span>; prior to that, traditional-format (context free) diffs were generated.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 5, 2012</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

