<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
IPSEND(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
IPSEND(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
IPSEND(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> ipsend &#45; IP packet description language</div>
<div class="section">
<h1>DESCRIPTION</h1> The  <b>ipsend</b> program expects, with the <b>-L</b> option, input to be a text file which fits the grammar described below.  The purpose of this grammar is to allow IP packets to be described in an arbitary way which also allows encapsulation to be so done to an arbitary level.</div>
<div class="section">
<h1>GRAMMAR</h1><br>
line ::= iface | arp | send | defrouter | ipv4line .<p>
<br>
iface ::= ifhdr "{" ifaceopts "}" ";" .<br>
ifhdr ::= "interface" | "iface" .<br>
ifaceopts ::= "ifname" name | "mtu" mtu | "v4addr" ipaddr |<br>
	      "eaddr" eaddr .<p>
<br>
send ::= "send" ";" | "send" "{" sendbodyopts "}" ";" .<br>
sendbodyopts ::= sendbody [ sendbodyopts ] .<br>
sendbody ::= "ifname" name | "via" ipaddr .<p>
<br>
defrouter ::= "router" ipaddr .<p>
<br>
arp ::= "arp" "{" arpbodyopts "}" ";" .<br>
arpbodyopts ::= arpbody [ arpbodyopts ] .<br>
arpbody ::= "v4addr" ipaddr | "eaddr" eaddr .<p>
<br>
bodyline ::= ipv4line | tcpline | udpline | icmpline | dataline .<p>
<br>
ipv4line ::= "ipv4" "{" ipv4bodyopts "}" ";" .<br>
ipv4bodyopts ::= ipv4body [ ipv4bodyopts ] | bodyline .<br>
ipv4body ::= "proto" protocol | "src" ipaddr | "dst" ipaddr |<br>
	     "off" number | "v" number | "hl" number| "id" number |<br>
	     "ttl" number | "tos" number | "sum" number | "len" number |<br>
	     "opt" "{" ipv4optlist "}" ";" .<br>
ipv4optlist ::= ipv4option [ ipv4optlist ] .<br>
ipv4optlist = "nop" | "rr" | "zsu" | "mtup" | "mtur" | "encode" | "ts" |<br>
	      "tr" | "sec" | "lsrr" | "e-sec" | "cipso" | "satid" |<br>
	      "ssrr" | "addext" | "visa" | "imitd" | "eip" | "finn" |<br>
	      "secclass" ipv4secclass.<br>
ipv4secclass := "unclass" | "confid" | "reserv-1" | "reserv-2" |<br>
		"reserv-3" | "reserv-4" | "secret" | "topsecret" .<p>
<br>
tcpline ::= "tcp" "{" tcpbodyopts "}" ";" .<br>
tcpbodyopts ::= tcpbody [ tcpbodyopts ] | bodyline .<br>
tcpbody ::= "sport" port | "dport" port | "seq" number | "ack" number |<br>
	    "off" number | "urp" number | "win" number | "sum" number |<br>
	    "flags" tcpflags | data .<p>
<br>
udpline ::= "udp" "{" udpbodyopts "}" ";" .<br>
udpbodyopts ::= udpbody [ udpbodyopts ] | bodyline .<br>
udpbody ::= "sport" port | "dport" port | "len" number | "sum" number |<br>
	    data .<p>
<br>
icmpline ::= "icmp" "{" icmpbodyopts "}" ";" .<br>
icmpbodyopts ::= icmpbody [ icmpbodyopts ] | bodyline .<br>
icmpbody ::= "type" icmptype [ "code" icmpcode ] .<br>
icmptype ::= "echorep" | "echorep" "{" echoopts "}" ";" | "unreach" |<br>
	     "unreach" "{" unreachtype "}" ";" | "squench" | "redir" |<br>
	     "redir" "{" redirtype "}" ";" | "echo" "{" echoopts "}" ";" |<br>
	     "echo" | "routerad" | "routersol" | "timex" |<br>
	     "timex" "{" timextype "}" ";" | "paramprob" |<br>
	     "paramprob" "{" parapptype "}" ";" | "timest" | "timestrep" |<br>
	     "inforeq" | "inforep" | "maskreq" | "maskrep" .<p>
<br>
echoopts ::= echoopts [ icmpechoopts ] .<br>
unreachtype ::= "net-unr" | "host-unr" | "proto-unr" | "port-unr" |<br>
	     "needfrag" | "srcfail" | "net-unk" | "host-unk" | "isolate" |<br>
	     "net-prohib" | "host-prohib" | "net-tos" | "host-tos" |<br>
	     "filter-prohib" | "host-preced" | "cutoff-preced" .<br>
redirtype ::= "net-redir" | "host-redir" | "tos-net-redir" |<br>
	      "tos-host-redir" .<br>
timextype ::= "intrans" | "reass" .<br>
paramptype ::= "optabsent" .<p>
<br>
data	::= "data" "{" databodyopts "}" ";" .<br>
databodyopts ::= "len" number | "value" string | "file" filename .<p>
<br>
icmpechoopts ::= "icmpseq" number | "icmpid" number .<br>
</div>
<div class="section">
<h1>COMMANDS</h1> Before sending any packets or defining any packets, it is necessary to describe the interface(s) which will be used to send packets out.<dl>
<dt>
<b>interface</b></dt>
<dd>
is used to describe a network interface.  The description included need not match the actual configuration currently employed by the operating system.</dd>
</dl>
<dl>
<dt>
<b>send</b></dt>
<dd>
is used to actually send out a packet across the network.  If the destination is not specified, it will attempt to send the packet directly out on the network to the destination without routing it.</dd>
</dl>
<dl>
<dt>
<b>router</b></dt>
<dd>
configures the default router for ipsend, as distinct from the default route installed in the kernel.</dd>
</dl>
<dl>
<dt>
<b>ipv4</b></dt>
<dd>
is used to describe an IP (version 4) packet.  IP header fields can be specified, including options, followed by a data section which may contain further protocol headers.</dd>
</dl>
</div>
<div class="section">
<h1>IPv4</h1><dl>
<dt>
<b>hl &lt;number&gt;</b></dt>
<dd>
manually specifies the IP header length (automatically adjusts with the presence of IP options and defaults to 5);</dd>
</dl>
<dl>
<dt>
<b>v &lt;number&gt;</b></dt>
<dd>
set the IP version.  Default is 4.</dd>
</dl>
<dl>
<dt>
<b>tos &lt;number&gt;</b></dt>
<dd>
set the type of service (TOS) field in the IP header.  Default is 0.</dd>
</dl>
<dl>
<dt>
<b>len &lt;number&gt;</b></dt>
<dd>
manually specifies the length of the IP packet.  The length will automatically be adjusted to accommodate data or further protocol headers.</dd>
</dl>
<dl>
<dt>
<b>off &lt;number&gt;</b></dt>
<dd>
sets the fragment offset field of the IP packet.  Default is 0.</dd>
</dl>
<dl>
<dt>
<b>ttl &lt;number&gt;</b></dt>
<dd>
sets the time to live (TTL) field of the IP header.  Default is 60.</dd>
</dl>
<dl>
<dt>
<b>proto &lt;protocol&gt;</b></dt>
<dd>
sets the protocol field of the IP header.  The protocol can either be a number or a name found in  <b>/etc/protocols</b>.</dd>
</dl>
<dl>
<dt>
<b>sum</b></dt>
<dd>
manually specifies the checksum for the IP header.  If left unset (0), it will be calculated prior to being sent.</dd>
</dl>
<dl>
<dt>
<b>src</b></dt>
<dd>
manually specifies the source address of the IP header.  If left unset, it will default to the host's IP address.</dd>
</dl>
<dl>
<dt>
<b>dst</b></dt>
<dd>
sets the destination of the IP packet.  The default is 0.0.0.0.</dd>
</dl>
<dl>
<dt>
<b>opt</b></dt>
<dd>
is used to include IP options in the IP header.</dd>
</dl>
<dl>
<dt>
<b>tcp</b></dt>
<dd>
is used to indicate the a TCP protocol header is to follow.  See the <b>TCP</b> section for TCP header options.</dd>
</dl>
<dl>
<dt>
<b>udp</b></dt>
<dd>
is used to indicate the a UDP protocol header is to follow.  See the <b>UDP</b> section for UDP header options.</dd>
</dl>
<dl>
<dt>
<b>icmp</b></dt>
<dd>
is used to indicate the a ICMP protocol header is to follow.  See the  <b>ICMP</b> section for ICMP header options.</dd>
</dl>
<dl>
<dt>
<b>data</b></dt>
<dd>
is used to indicate that raw data is to be included in the IP packet.  See the  <b>DATA</b> section for details on options available.</dd>
</dl>
</div>
<div class="section">
<h1>IPv4 Options</h1> these keywords indicate that the relevant IP option should be added to the IP header (the header length field will be adjusted appropriately).<dl>
<dt>
<b>nop</b></dt>
<dd>
No Operation [RFC 791] (space filler).</dd>
</dl>
<dl>
<dt>
<b>rr &lt;number&gt;</b></dt>
<dd>
Record Router [RFC 791].  The number given specifies the number of  <b>bytes</b> to be used for storage.  This should be a multiple of 4 for proper operation.</dd>
</dl>
<dl>
<dt>
<b>zsu</b></dt>
<dd>
Experimental Measurement.</dd>
</dl>
<dl>
<dt>
<b>mtup [RFC 1191].</b></dt>
<dd>
MTU Probe.</dd>
</dl>
<dl>
<dt>
<b>mtur [RFC 1191].</b></dt>
<dd>
MTU Ready.</dd>
</dl>
<dl>
<dt>
<b>encode</b></dt>
<dd>
</dd>
</dl>
<dl>
<dt>
<b>ts</b></dt>
<dd>
Timestamp [RFC 791].</dd>
</dl>
<dl>
<dt>
<b>tr</b></dt>
<dd>
Traceroute [RFC 1393].</dd>
</dl>
<dl>
<dt>
<b>sec-class &lt;security-level&gt;, sec</b></dt>
<dd>
Security [RFC 1108].  This option specifies the security label for the packet. Using  <b>sec</b> sets up the framework of the security option but unless  <b>sec-class</b> is given, the level may not be set.</dd>
</dl>
<dl>
<dt>
<b>lsrr &lt;ip-address&gt;</b></dt>
<dd>
Loose Source Route [RFC 791].</dd>
</dl>
<dl>
<dt>
<b>e-sec</b></dt>
<dd>
Extended Security [RFC 1108].</dd>
</dl>
<dl>
<dt>
<b>cipso</b></dt>
<dd>
Commercial Security.</dd>
</dl>
<dl>
<dt>
<b>satid</b></dt>
<dd>
Stream ID [RFC 791].</dd>
</dl>
<dl>
<dt>
<b>ssrr &lt;ip-address&gt;</b></dt>
<dd>
Strict Source Route [RFC 791].</dd>
</dl>
<dl>
<dt>
<b>addext</b></dt>
<dd>
Address Extension</dd>
</dl>
<dl>
<dt>
<b>visa</b></dt>
<dd>
Experimental Access Control.</dd>
</dl>
<dl>
<dt>
<b>imitd</b></dt>
<dd>
IMI Traffic Descriptor.</dd>
</dl>
<dl>
<dt>
<b>eip</b></dt>
<dd>
[RFC 1358].</dd>
</dl>
<dl>
<dt>
<b>finn</b></dt>
<dd>
Experimental Flow Control.</dd>
</dl>
</div>
<div class="section">
<h1>TCP</h1><dl>
<dt>
<b>sport &lt;port&gt;</b></dt>
<dd>
sets the source port to the number/name given.  Default is 0.</dd>
</dl>
<dl>
<dt>
<b>dport &lt;port&gt;</b></dt>
<dd>
sets the destination port to the number/name given.  Default is 0.</dd>
</dl>
<dl>
<dt>
<b>seq &lt;number&gt;</b></dt>
<dd>
sets the sequence number to the number specified.  Default is 0.</dd>
</dl>
<dl>
<dt>
<b>ack &lt;number&gt;</b></dt>
<dd>
sets the acknowledge number to the number specified.  Default is 0.</dd>
</dl>
<dl>
<dt>
<b>off &lt;number&gt;</b></dt>
<dd>
sets the offset value for the start of data to the number specified.  This implies the size of the TCP header.  It is automatically adjusted if TCP options are included and defaults to 5.</dd>
</dl>
<dl>
<dt>
<b>urp &lt;number&gt;</b></dt>
<dd>
sets the value of the urgent data pointer to the number specified.  Default is 0.</dd>
</dl>
<dl>
<dt>
<b>win &lt;number&gt;</b></dt>
<dd>
sets the size of the TCP window to the number specified.  Default is 4096.</dd>
</dl>
<dl>
<dt>
<b>sum &lt;number&gt;</b></dt>
<dd>
manually specifies the checksum for the TCP pseudo-header and data.  If left unset, it defaults to 0 and is automatically calculated.</dd>
</dl>
<dl>
<dt>
<b>flags &lt;tcp-flags&gt;</b></dt>
<dd>
sets the TCP flags field to match the flags specified.  Valid flags are "S" (SYN), "A" (ACK), "R" (RST), "F" (FIN), "U" (URG), "P" (PUSH).</dd>
</dl>
<dl>
<dt>
<b>opt</b></dt>
<dd>
indicates that TCP header options follow.  As TCP options are added to the TCP header, the  <b>off</b> field is updated to match.</dd>
</dl>
<dl>
<dt>
<b>data</b></dt>
<dd>
indicates that a data section is to follow and is to be included as raw data, being appended to the header.</dd>
</dl>
</div>
<div class="section">
<h1>TCP options</h1> With a TCP header, it is possible to append a number of header options. The TCP header offset will be updated automatically to reflect the change in size.  The valid options are:  <b>nop</b> No Operation,  <b>eol</b> End Of (option) List, <b>mss [ size ]</b> Maximum Segment Size - this sets the maximum receivable size of a packet containing data,  <b>wscale</b> Window Scale, <b>ts</b> Timestamp.</div>
<div class="section">
<h1>UDP</h1><dl>
<dt>
<b>sport &lt;port&gt;</b></dt>
<dd>
sets the source port to the number/name given.  Default is 0.</dd>
</dl>
<dl>
<dt>
<b>dport &lt;port&gt;</b></dt>
<dd>
sets the destination port to the number/name given.  Default is 0.</dd>
</dl>
<dl>
<dt>
<b>len &lt;number&gt;</b></dt>
<dd>
manually specifies the length of the UDP header and data.  If left unset, it is automatically adjusted to match the header presence and any data if present.</dd>
</dl>
<dl>
<dt>
<b>sum &lt;number&gt;</b></dt>
<dd>
manually specifies the checksum for the UDP pseudo-header and data.  If left unset, it defaults to 0 and is automatically calculated.</dd>
</dl>
<dl>
<dt>
<b>data</b></dt>
<dd>
indicates that a data section is to follow and is to be included as raw data, being appended to the header.</dd>
</dl>
</div>
<div class="section">
<h1>ICMP</h1><dl>
<dt>
<b>type &lt;icmptype&gt;</b></dt>
<dd>
sets the ICMP type according the to the icmptype tag.  This may either be a number or one of the recognised tags (see the  <b>ICMP TYPES</b> section for a list of names recognised).</dd>
</dl>
<dl>
<dt>
<b>code &lt;icmpcode&gt;</b></dt>
<dd>
sets the ICMP code.</dd>
</dl>
<dl>
<dt>
<b>data</b></dt>
<dd>
indicates that a data section is to follow and is to be included as raw data, being appended to the header.</dd>
</dl>
</div>
<div class="section">
<h1>DATA</h1> Each of the following extend the packet in a different way.   <b>Len</b> just increases the length (without adding any content),  <b>value</b> uses a string and  <b>file</b> a file.<dl>
<dt>
<b>len &lt;number&gt;</b></dt>
<dd>
extend the length of the packet by <b>number</b> bytes (without filling those bytes with any particular data).</dd>
</dl>
<dl>
<dt>
<b>value &lt;string&gt;</b></dt>
<dd>
indicates that the string provided should be added to the current packet as data.  A string may be a consecutive list of characters and numbers (with no white spaces) or bounded by "'s (may not contain them, even if \'d). The \ character is recognised with the appropriate C escaped values, including octal numbers.</dd>
</dl>
<dl>
<dt>
<b>file &lt;filename&gt;</b></dt>
<dd>
reads data in from the specified file and appends it to the current packet. If the new total length would exceed 64k, an error will be reported.</dd>
</dl>
</div>
<div class="section">
<h1>ICMP TYPES</h1><dl>
<dt>
<b>echorep</b></dt>
<dd>
Echo Reply.</dd>
</dl>
<dl>
<dt>
<b>unreach [ unreachable-code ]</b></dt>
<dd>
Generic Unreachable error.  This is used to indicate that an error has occurred whilst trying to send the packet across the network and that the destination cannot be reached.  The unreachable code names are:  <b>net-unr</b> network unreachable, <b>host-unr</b> host unreachable,  <b>proto-unr</b> protocol unreachable, <b>port-unr</b> port unreachable,  <b>needfrag</b>, <b>srcfail</b> source route failed,  <b>net-unk</b> network unknown, <b>host-unk</b> host unknown,  <b>isolate</b>, <b>net-prohib</b> administratively prohibited contact with network,  <b>host-prohib</b> administratively prohibited contact with host,  <b>net-tos</b> network unreachable with given TOS,  <b>host-tos</b> host unreachable with given TOS,  <b>filter-prohib</b> packet prohibited by packet filter,  <b>host-preced</b>,  <b>cutoff-preced</b>.</dd>
</dl>
<dl>
<dt>
<b>squench</b></dt>
<dd>
Source Quence.</dd>
</dl>
<dl>
<dt>
<b>redir [ redirect-code ]</b></dt>
<dd>
Redirect (routing).  This is used to indicate that the route being chosen for forwarding the packet is suboptimal and that the sender of the packet should be routing packets via another route.  The redirect code names are:  <b>net-redir</b> redirect packets for a network,  <b>host-redir</b> redirect packets for a host,  <b>tos-net-redir</b> redirect packets for a network with a given TOS,  <b>tos-host-redir</b> redirect packets for a host with a given TOS.</dd>
</dl>
<dl>
<dt>
<b>echo</b></dt>
<dd>
Echo.</dd>
</dl>
<dl>
<dt>
<b>routerad</b></dt>
<dd>
Router Advertisement.</dd>
</dl>
<dl>
<dt>
<b>routersol</b></dt>
<dd>
Router solicitation.</dd>
</dl>
<dl>
<dt>
<b>timex [ timexceed-code ]</b></dt>
<dd>
Time Exceeded.  This is used to indicate that the packet failed to reach the destination because it was in transit too long (i.e. ttl reached 0).  The valid code names are:  <b>intrans</b>,  <b>reass</b> could not reassemble packet from fragments within a given time.</dd>
</dl>
<dl>
<dt>
<b>paramprob [ paramprob-code ]</b></dt>
<dd>
Parameter problem.  There is only one available parameter problem code name:  <b>optabsent</b>.</dd>
</dl>
<dl>
<dt>
<b>timest</b></dt>
<dd>
Time stamp request.</dd>
</dl>
<dl>
<dt>
<b>timestrep [ { timestamp-code } ]</b></dt>
<dd>
Time stamp reply.  In a timestamp reply, it is possible to supply the following values:  <b>rtime</b>, <b>otime</b>, <b>ttime</b>.</dd>
</dl>
<dl>
<dt>
<b>inforeq</b></dt>
<dd>
Information request.</dd>
</dl>
<dl>
<dt>
<b>inforep</b></dt>
<dd>
Information reply.</dd>
</dl>
<dl>
<dt>
<b>maskreq</b></dt>
<dd>
Address mask request.</dd>
</dl>
<dl>
<dt>
<b>maskrep</b></dt>
<dd>
Address mask reply.</dd>
</dl>
</div>
<div class="section">
<h1>FILES</h1> /etc/hosts<div style="height: 0.00em;">
&#160;</div>
/etc/protocols<div style="height: 0.00em;">
&#160;</div>
/etc/services</div>
<div class="section">
<h1>SEE ALSO</h1> ipsend(1), iptest(1), hosts(5), protocols(5), services(5)</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
</td>
<td class="foot-os" align="right">
</td>
</tr>
</table>
</div>
</body>
</html>

