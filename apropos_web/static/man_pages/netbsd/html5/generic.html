<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
GENERIC(5)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
GENERIC(5)</td>
<td class="head-vol" align="center">
File Formats Manual</td>
<td class="head-rtitle" align="right">
GENERIC(5)</td>
</tr>
</tbody>
</table>
<br>
<div class="section">
<h1>NAME</h1> generic &#45; Postfix generic table format</div>
<div class="section">
<h1>SYNOPSIS</h1><br>
<b>postmap /etc/postfix/generic</b><p>
<br>
<b>postmap -q "</b><i>string</i><b>" /etc/postfix/generic</b><p>
<br>
<b>postmap -q - /etc/postfix/generic &lt;</b><i>inputfile</i></div>
<div class="section">
<h1>DESCRIPTION</h1><br>
The optional <b>generic</b>(5) table specifies an address mapping that applies when mail is delivered. This is the opposite of  <b>canonical</b>(5) mapping, which applies when mail is received.<div style="height: 1.00em;">
&#160;</div>
Typically, one would use the <b>generic</b>(5) table on a system that does not have a valid Internet domain name and that uses something like  <i>localdomain.local</i> instead. The  <b>generic</b>(5) table is then used by the <b>smtp</b>(8) client to transform local mail addresses into valid Internet mail addresses when mail has to be sent across the Internet. See the EXAMPLE section at the end of this document.<div style="height: 1.00em;">
&#160;</div>
The <b>generic</b>(5) mapping affects both message header addresses (i.e. addresses that appear inside messages) and message envelope addresses (for example, the addresses that are used in SMTP protocol commands).<div style="height: 1.00em;">
&#160;</div>
Normally, the <b>generic</b>(5) table is specified as a text file that serves as input to the  <b>postmap</b>(1) command.  The result, an indexed file in  <b>dbm</b> or  <b>db</b> format, is used for fast searching by the mail system. Execute the command " <b>postmap /etc/postfix/generic</b>" to rebuild an indexed file after changing the corresponding text file.<div style="height: 1.00em;">
&#160;</div>
When the table is provided via other means such as NIS, LDAP or SQL, the same lookups are done as for ordinary indexed files.<div style="height: 1.00em;">
&#160;</div>
Alternatively, the table can be provided as a regular-expression map where patterns are given as regular expressions, or lookups can be directed to TCP-based server. In those case, the lookups are done in a slightly different way as described below under "REGULAR EXPRESSION TABLES" or "TCP-BASED TABLES".</div>
<div class="section">
<h1>CASE FOLDING</h1><br>
The search string is folded to lowercase before database lookup. As of Postfix 2.3, the search string is not case folded with database types such as regexp: or pcre: whose lookup fields can match both upper and lower case.</div>
<div class="section">
<h1>TABLE FORMAT</h1><br>
The input format for the <b>postmap</b>(1) command is as follows:<dl>
<dt>
<i>pattern result</i></dt>
<dd>
When <i>pattern</i> matches a mail address, replace it by the corresponding  <i>result</i>.</dd>
</dl>
<dl>
<dt>
blank lines and comments</dt>
<dd>
Empty lines and whitespace-only lines are ignored, as are lines whose first non-whitespace character is a `#'.</dd>
</dl>
<dl>
<dt>
multi-line text</dt>
<dd>
A logical line starts with non-whitespace text. A line that starts with whitespace continues a logical line.</dd>
</dl>
</div>
<div class="section">
<h1>TABLE SEARCH ORDER</h1><br>
With lookups from indexed files such as DB or DBM, or from networked tables such as NIS, LDAP or SQL, patterns are tried in the order as listed below:<dl>
<dt>
<i>user</i>@<i>domain address</i></dt>
<dd>
Replace <i>user</i>@<i>domain</i> by <i>address</i>. This form has the highest precedence.</dd>
</dl>
<dl>
<dt>
<i>user address</i></dt>
<dd>
Replace <i>user</i>@<i>site</i> by <i>address</i> when <i>site</i> is equal to $ <b>myorigin</b>, when <i>site</i> is listed in $ <b>mydestination</b>, or when it is listed in $<b>inet_interfaces</b> or $ <b>proxy_interfaces</b>.</dd>
</dl>
<dl>
<dt>
@<i>domain address</i></dt>
<dd>
Replace other addresses in <i>domain</i> by <i>address</i>. This form has the lowest precedence.</dd>
</dl>
</div>
<div class="section">
<h1>RESULT ADDRESS REWRITING</h1><br>
The lookup result is subject to address rewriting:<dl>
<dt>
&#8226;</dt>
<dd>
When the result has the form @<i>otherdomain</i>, the result becomes the same  <i>user</i> in <i>otherdomain</i>.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
When "<b>append_at_myorigin=yes</b>", append "<b>@$myorigin</b>" to addresses without "@domain".</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
When "<b>append_dot_mydomain=yes</b>", append " <b>.$mydomain</b>" to addresses without ".domain".</dd>
</dl>
</div>
<div class="section">
<h1>ADDRESS EXTENSION</h1><br>
When a mail address localpart contains the optional recipient delimiter (e.g.,  <i>user+foo</i>@<i>domain</i>), the lookup order becomes:  <i>user+foo</i>@<i>domain</i>, <i>user</i>@<i>domain</i>, <i>user+foo</i>,  <i>user</i>, and @<i>domain</i>.<div style="height: 1.00em;">
&#160;</div>
The <b>propagate_unmatched_extensions</b> parameter controls whether an unmatched address extension ( <i>+foo</i>) is propagated to the result of table lookup.</div>
<div class="section">
<h1>REGULAR EXPRESSION TABLES</h1><br>
This section describes how the table lookups change when the table is given in the form of regular expressions. For a description of regular expression lookup table syntax, see  <b>regexp_table</b>(5) or  <b>pcre_table</b>(5).<div style="height: 1.00em;">
&#160;</div>
Each pattern is a regular expression that is applied to the entire address being looked up. Thus,  <i>user@domain</i> mail addresses are not broken up into their  <i>user</i> and <i>@domain</i> constituent parts, nor is  <i>user+foo</i> broken up into <i>user</i> and <i>foo</i>.<div style="height: 1.00em;">
&#160;</div>
Patterns are applied in the order as specified in the table, until a pattern is found that matches the search string.<div style="height: 1.00em;">
&#160;</div>
Results are the same as with indexed file lookups, with the additional feature that parenthesized substrings from the pattern can be interpolated as  <b>$1</b>, <b>$2</b> and so on.</div>
<div class="section">
<h1>TCP-BASED TABLES</h1><br>
This section describes how the table lookups change when lookups are directed to a TCP-based server. For a description of the TCP client/server lookup protocol, see  <b>tcp_table</b>(5). This feature is not available up to and including Postfix version 2.4.<div style="height: 1.00em;">
&#160;</div>
Each lookup operation uses the entire address once.  Thus,  <i>user@domain</i> mail addresses are not broken up into their  <i>user</i> and <i>@domain</i> constituent parts, nor is  <i>user+foo</i> broken up into <i>user</i> and <i>foo</i>.<div style="height: 1.00em;">
&#160;</div>
Results are the same as with indexed file lookups.</div>
<div class="section">
<h1>EXAMPLE</h1><br>
The following shows a generic mapping with an indexed file. When mail is sent to a remote host via SMTP, this replaces  <i>his@localdomain.local</i> by his ISP mail address, replaces  <i>her@localdomain.local</i> by her ISP mail address, and replaces other local addresses by his ISP account, with an address extension of  <i>+local</i> (this example assumes that the ISP supports "+" style address extensions).<div style="height: 1.00em;">
&#160;</div>
<br>
/etc/postfix/main.cf:<br>
    smtp_generic_maps = hash:/etc/postfix/generic<p>
<br>
/etc/postfix/generic:<br>
    his@localdomain.local   hisaccount@hisisp.example<br>
    her@localdomain.local   heraccount@herisp.example<br>
    @localdomain.local      hisaccount+local@hisisp.example<p>
<br>
Execute the command "<b>postmap /etc/postfix/generic</b>" whenever the table is changed.  Instead of  <b>hash</b>, some systems use  <b>dbm</b> database files. To find out what tables your system supports use the command " <b>postconf</b>  <b>-m</b>".</div>
<div class="section">
<h1>BUGS</h1><br>
The table format does not understand quoting conventions.</div>
<div class="section">
<h1>CONFIGURATION PARAMETERS</h1><br>
The following <b>main.cf</b> parameters are especially relevant. The text below provides only a parameter summary. See  <b>postconf</b>(5) for more details including examples.<dl>
<dt>
<b>smtp_generic_maps</b></dt>
<dd>
Address mapping lookup table for envelope and header sender and recipient addresses while delivering mail via SMTP.</dd>
</dl>
<dl>
<dt>
<b>propagate_unmatched_extensions</b></dt>
<dd>
A list of address rewriting or forwarding mechanisms that propagate an address extension from the original address to the result. Specify zero or more of  <b>canonical</b>, <b>virtual</b>, <b>alias</b>,  <b>forward</b>, <b>include</b>, or <b>generic</b>.</dd>
</dl>
<p>
Other parameters of interest:<dl>
<dt>
<b>inet_interfaces</b></dt>
<dd>
The network interface addresses that this system receives mail on. You need to stop and start Postfix when this parameter changes.</dd>
</dl>
<dl>
<dt>
<b>proxy_interfaces</b></dt>
<dd>
Other interfaces that this machine receives mail on by way of a proxy agent or network address translator.</dd>
</dl>
<dl>
<dt>
<b>mydestination</b></dt>
<dd>
List of domains that this mail system considers local.</dd>
</dl>
<dl>
<dt>
<b>myorigin</b></dt>
<dd>
The domain that is appended to locally-posted mail.</dd>
</dl>
<dl>
<dt>
<b>owner_request_special</b></dt>
<dd>
Give special treatment to <b>owner-</b><i>xxx</i> and <i>xxx</i><b>-request</b> addresses.</dd>
</dl>
</div>
<div class="section">
<h1>SEE ALSO</h1><br>
postmap(1), Postfix lookup table manager<br>
postconf(5), configuration parameters<br>
smtp(8), Postfix SMTP client</div>
<div class="section">
<h1>README FILES</h1><br>
Use "<b>postconf readme_directory</b>" or " <b>postconf html_directory</b>" to locate this information.<br>
ADDRESS_REWRITING_README, address rewriting guide<br>
DATABASE_README, Postfix lookup table overview<br>
STANDARD_CONFIGURATION_README, configuration examples</div>
<div class="section">
<h1>LICENSE</h1><br>
The Secure Mailer license must be distributed with this software.</div>
<div class="section">
<h1>HISTORY</h1><br>
A genericstable feature appears in the Sendmail MTA.<p>
<br>
This feature is available in Postfix 2.2 and later.</div>
<div class="section">
<h1>AUTHOR(S)</h1><br>
Wietse Venema<br>
IBM T.J. Watson Research<br>
P.O. Box 704<br>
Yorktown Heights, NY 10598, USA</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
</td>
<td class="foot-os" align="right">
</td>
</tr>
</table>
</div>
</body>
</html>

