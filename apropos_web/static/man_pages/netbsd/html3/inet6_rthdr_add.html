<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
INET6_RTHDR_SPACE(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
INET6_RTHDR_SPACE(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
INET6_RTHDR_SPACE(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">inet6_rthdr_space</b>, <b class="name">inet6_rthdr_init</b>, <b class="name">inet6_rthdr_add</b>, <b class="name">inet6_rthdr_lasthop</b>, <b class="name">inet6_rthdr_reverse</b>, <b class="name">inet6_rthdr_segments</b>, <b class="name">inet6_rthdr_getaddr</b>, <b class="name">inet6_rthdr_getflags</b> &#8212; <span class="desc">IPv6 Routing Header Options manipulation</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">netinet/in.h</a>&gt;</b><p>
<i class="ftype">size_t</i><br>
<b class="fname">inet6_rthdr_space</b>(<i class="farg" style="white-space:nowrap;">int type</i>, <i class="farg" style="white-space:nowrap;">int segments</i>);<p>
<i class="ftype">struct cmsghdr *</i><br>
<b class="fname">inet6_rthdr_init</b>(<i class="farg" style="white-space:nowrap;">void *bp</i>, <i class="farg" style="white-space:nowrap;">int type</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">inet6_rthdr_add</b>(<i class="farg" style="white-space:nowrap;">struct cmsghdr *cmsg</i>, <i class="farg" style="white-space:nowrap;">const struct in6_addr *addr</i>, <i class="farg" style="white-space:nowrap;">unsigned int flags</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">inet6_rthdr_lasthop</b>(<i class="farg" style="white-space:nowrap;">struct cmsghdr *cmsg</i>, <i class="farg" style="white-space:nowrap;">unsigned int flags</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">inet6_rthdr_reverse</b>(<i class="farg" style="white-space:nowrap;">const struct cmsghdr *in</i>, <i class="farg" style="white-space:nowrap;">struct cmsghdr *out</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">inet6_rthdr_segments</b>(<i class="farg" style="white-space:nowrap;">const struct cmsghdr *cmsg</i>);<p>
<i class="ftype">struct in6_addr *</i><br>
<b class="fname">inet6_rthdr_getaddr</b>(<i class="farg" style="white-space:nowrap;">struct cmsghdr *cmsg</i>, <i class="farg" style="white-space:nowrap;">int index</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">inet6_rthdr_getflags</b>(<i class="farg" style="white-space:nowrap;">const struct cmsghdr *cmsg</i>, <i class="farg" style="white-space:nowrap;">int index</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> RFC 2292 IPv6 advanced API defines eight functions that the application calls to build and examine a Routing header. Four functions build a Routing header:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-hang">
<dt class="list-hang" style="margin-top: 1.00em;">
<b class="fname">inet6_rthdr_space</b>()</dt>
<dd class="list-hang">
return #bytes required for ancillary data</dd>
<dt class="list-hang" style="margin-top: 1.00em;">
<b class="fname">inet6_rthdr_init</b>()</dt>
<dd class="list-hang">
initialize ancillary data for Routing header</dd>
<dt class="list-hang" style="margin-top: 1.00em;">
<b class="fname">inet6_rthdr_add</b>()</dt>
<dd class="list-hang">
add IPv6 address &amp; flags to Routing header</dd>
<dt class="list-hang" style="margin-top: 1.00em;">
<b class="fname">inet6_rthdr_lasthop</b>()</dt>
<dd class="list-hang">
specify the flags for the final hop</dd>
</dl>
<p>
Four functions deal with a returned Routing header:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-hang">
<dt class="list-hang" style="margin-top: 1.00em;">
<b class="fname">inet6_rthdr_reverse</b>()</dt>
<dd class="list-hang">
reverse a Routing header</dd>
<dt class="list-hang" style="margin-top: 1.00em;">
<b class="fname">inet6_rthdr_segments</b>()</dt>
<dd class="list-hang">
return #segments in a Routing header</dd>
<dt class="list-hang" style="margin-top: 1.00em;">
<b class="fname">inet6_rthdr_getaddr</b>()</dt>
<dd class="list-hang">
fetch one address from a Routing header</dd>
<dt class="list-hang" style="margin-top: 1.00em;">
<b class="fname">inet6_rthdr_getflags</b>()</dt>
<dd class="list-hang">
fetch one flag from a Routing header</dd>
</dl>
<p>
The function prototypes for these functions are all in the <b class="includes">&lt;<a class="link-includes">netinet/in.h</a>&gt;</b> header.<div class="subsection">
<h2 id="x696e6574365f72746864725f7370616365">inet6_rthdr_space</h2> This function returns the number of bytes required to hold a Routing header of the specified <i class="farg">type</i> containing the specified number of <i class="farg">segments</i> (addresses). For an IPv6 Type 0 Routing header, the number of segments must be between 1 and 23, inclusive. The return value includes the size of the cmsghdr structure that precedes the Routing header, and any required padding.<p>
If the return value is 0, then either the type of the Routing header is not supported by this implementation or the number of segments is invalid for this type of Routing header.<p>
Note: This function returns the size but does not allocate the space required for the ancillary data. This allows an application to allocate a larger buffer, if other ancillary data objects are desired, since all the ancillary data objects must be specified to <a class="link-man" href="../html2/sendmsg.html">sendmsg(2)</a> as a single <code class="lit">msg_control</code> buffer.</div>
<div class="subsection">
<h2 id="x696e6574365f72746864725f696e6974">inet6_rthdr_init</h2> This function initializes the buffer pointed to by <i class="farg">bp</i> to contain a <code class="lit">cmsghdr</code> structure followed by a Routing header of the specified <i class="farg">type</i>. The <code class="lit">cmsg_len</code> member of the <code class="lit">cmsghdr</code> structure is initialized to the size of the structure plus the amount of space required by the Routing header. The <code class="lit">cmsg_level</code> and <code class="lit">cmsg_type</code> members are also initialized as required.<p>
The caller must allocate the buffer and its size can be determined by calling <b class="fname">inet6_rthdr_space</b>().<p>
Upon success the return value is the pointer to the <code class="lit">cmsghdr</code> structure, and this is then used as the first argument to the next two functions. Upon an error the return value is <span class="define">NULL</span>.</div>
<div class="subsection">
<h2 id="x696e6574365f72746864725f616464">inet6_rthdr_add</h2> This function adds the address pointed to by <i class="farg">addr</i> to the end of the Routing header being constructed and sets the type of this hop to the value of <i class="farg">flags</i>. For an IPv6 Type 0 Routing header, <i class="farg">flags</i> must be either <span class="define">IPV6_RTHDR_LOOSE</span> or <span class="define">IPV6_RTHDR_STRICT</span>.<p>
If successful, the <code class="lit">cmsg_len</code> member of the <code class="lit">cmsghdr</code> structure is updated to account for the new address in the Routing header and the return value of the function is 0. Upon an error the return value of the function is -1.</div>
<div class="subsection">
<h2 id="x696e6574365f72746864725f6c617374686f70">inet6_rthdr_lasthop</h2> This function specifies the Strict/Loose flag for the final hop of a Routing header. For an IPv6 Type 0 Routing header, <i class="farg">flags</i> must be either <span class="define">IPV6_RTHDR_LOOSE</span> or <span class="define">IPV6_RTHDR_STRICT</span>.<p>
The return value of the function is 0 upon success, or -1 upon an error.<p>
Notice that a Routing header specifying <code class="lit">N</code> intermediate nodes requires <code class="lit">N+1</code> Strict/Loose flags. This requires <code class="lit">N</code> calls to <b class="fname">inet6_rthdr_add</b>() followed by one call to <b class="fname">inet6_rthdr_lasthop</b>().</div>
<div class="subsection">
<h2 id="x696e6574365f72746864725f72657665727365">inet6_rthdr_reverse</h2> This function takes a Routing header that was received as ancillary data (pointed to by the first argument, <i class="farg">in</i>) and writes a new Routing header that sends datagrams along the reverse of that route. Both arguments are allowed to point to the same buffer (that is, the reversal can occur in place).<p>
The return value of the function is 0 on success, or -1 upon an error.</div>
<div class="subsection">
<h2 id="x696e6574365f72746864725f7365676d656e7473">inet6_rthdr_segments</h2> This function returns the number of segments (addresses) contained in the Routing header described by <i class="farg">cmsg</i>. On success the return value is between 1 and 23, inclusive. The return value of the function is -1 upon an error.</div>
<div class="subsection">
<h2 id="x696e6574365f72746864725f67657461646472">inet6_rthdr_getaddr</h2> This function returns a pointer to the IPv6 address specified by <i class="farg">index</i> (which must have a value between 1 and the value returned by <b class="fname">inet6_rthdr_segments</b>()) in the Routing header described by <i class="farg">cmsg</i>. An application should first call <b class="fname">inet6_rthdr_segments</b>() to obtain the number of segments in the Routing header.<p>
Upon an error the return value of the function is <span class="define">NULL</span>.</div>
<div class="subsection">
<h2 id="x696e6574365f72746864725f676574666c616773">inet6_rthdr_getflags</h2> This function returns the flags value specified by <i class="farg">index</i> (which must have a value between 0 and the value returned by <b class="fname">inet6_rthdr_segments</b>()) in the Routing header described by <i class="farg">cmsg</i>. For an IPv6 Type 0 Routing header the return value will be either <span class="define">IPV6_RTHDR_LOOSE</span> or <span class="define">IPV6_RTHDR_STRICT</span>.<p>
Upon an error the return value of the function is -1.<p>
Note: Addresses are indexed starting at 1, and flags starting at 0, to maintain consistency with the terminology and figures in RFC 2460.</div>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> RFC 2292 gives comprehensive examples in chapter 8.</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> <b class="fname">inet6_rthdr_space</b>() returns 0 on errors.<p>
<b class="fname">inet6_rthdr_add</b>(), <b class="fname">inet6_rthdr_lasthop</b>() and <b class="fname">inet6_rthdr_reverse</b>() return 0 on success, and returns -1 on error.<p>
<b class="fname">inet6_rthdr_init</b>() and <b class="fname">inet6_rthdr_getaddr</b>() return <span class="define">NULL</span> on error.<p>
<b class="fname">inet6_rthdr_segments</b>() and <b class="fname">inet6_rthdr_getflags</b>() return -1 on error.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <span class="ref"><span class="ref-auth">W. Stevens</span> and <span class="ref-auth">M. Thomas</span>, <span class="ref-title">Advanced Sockets API for IPv6</span>, <span class="ref-num">RFC 2292</span>, <span class="ref-date">February 1998</span>.</span><p>
<span class="ref"><span class="ref-auth">S. Deering</span> and <span class="ref-auth">R. Hinden</span>, <span class="ref-title">Internet Protocol, Version 6 (IPv6) Specification</span>, <span class="ref-num">RFC 2460</span>, <span class="ref-date">December 1998</span>.</span></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The functions are documented in &#8220;Advanced Sockets API for IPv6&#8221; (RFC 2292).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The implementation first appeared in KAME advanced networking kit.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The text was shamelessly copied from RFC 2292.<p>
<b class="fname">inet6_rthdr_reverse</b>() is not implemented yet.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 10, 1999</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

