<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
X509_STORE_CTX_new(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
X509_STORE_CTX_new(3)</td>
<td class="head-vol" align="center">
OpenSSL</td>
<td class="head-rtitle" align="right">
X509_STORE_CTX_new(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> X509_STORE_CTX_new, X509_STORE_CTX_cleanup, X509_STORE_CTX_free, X509_STORE_CTX_init, X509_STORE_CTX_trusted_stack, X509_STORE_CTX_set_cert, X509_STORE_CTX_set_chain, X509_STORE_CTX_set0_crls, X509_STORE_CTX_get0_param, X509_STORE_CTX_set0_param, X509_STORE_CTX_set_default &#45; X509_STORE_CTX initialisation</div>
<div class="section">
<h1>LIBRARY</h1> libcrypto, -lcrypto</div>
<div class="section">
<h1>SYNOPSIS</h1><br>
 #include &lt;openssl/x509_vfy.h&gt;<br>
<br>
 X509_STORE_CTX *X509_STORE_CTX_new(void);<br>
 void X509_STORE_CTX_cleanup(X509_STORE_CTX *ctx);<br>
 void X509_STORE_CTX_free(X509_STORE_CTX *ctx);<br>
<br>
 int X509_STORE_CTX_init(X509_STORE_CTX *ctx, X509_STORE *store,<br>
                         X509 *x509, STACK_OF(X509) *chain);<br>
<br>
 void X509_STORE_CTX_trusted_stack(X509_STORE_CTX *ctx, STACK_OF(X509) *sk);<br>
<br>
 void   X509_STORE_CTX_set_cert(X509_STORE_CTX *ctx,X509 *x);<br>
 void   X509_STORE_CTX_set_chain(X509_STORE_CTX *ctx,STACK_OF(X509) *sk);<br>
 void   X509_STORE_CTX_set0_crls(X509_STORE_CTX *ctx, STACK_OF(X509_CRL) *sk);<br>
<br>
 X509_VERIFY_PARAM *X509_STORE_CTX_get0_param(X509_STORE_CTX *ctx);<br>
 void X509_STORE_CTX_set0_param(X509_STORE_CTX *ctx, X509_VERIFY_PARAM *param);<br>
 int X509_STORE_CTX_set_default(X509_STORE_CTX *ctx, const char *name);<br>
</div>
<div class="section">
<h1>DESCRIPTION</h1> These functions initialise an  <b>X509_STORE_CTX</b> structure for subsequent use by  <i>X509_verify_cert()</i>.<p>
<i>X509_STORE_CTX_new()</i> returns a newly initialised <b>X509_STORE_CTX</b> structure.<p>
<i>X509_STORE_CTX_cleanup()</i> internally cleans up an <b>X509_STORE_CTX</b> structure. The context can then be reused with an new call to  <i>X509_STORE_CTX_init()</i>.<p>
<i>X509_STORE_CTX_free()</i> completely frees up <b>ctx</b>. After this call <b>ctx</b> is no longer valid.<p>
<i>X509_STORE_CTX_init()</i> sets up <b>ctx</b> for a subsequent verification operation. The trusted certificate store is set to  <b>store</b>, the end entity certificate to be verified is set to  <b>x509</b> and a set of additional certificates (which will be untrusted but may be used to build the chain) in  <b>chain</b>. Any or all of the  <b>store</b>, <b>x509</b> and <b>chain</b> parameters can be <b>NULL</b>.<p>
<i>X509_STORE_CTX_trusted_stack()</i> sets the set of trusted certificates of <b>ctx</b> to  <b>sk</b>. This is an alternative way of specifying trusted certificates instead of using an  <b>X509_STORE</b>.<p>
<i>X509_STORE_CTX_set_cert()</i> sets the certificate to be vertified in <b>ctx</b> to  <b>x</b>.<p>
<i>X509_STORE_CTX_set_chain()</i> sets the additional certificate chain used by <b>ctx</b> to  <b>sk</b>.<p>
<i>X509_STORE_CTX_set0_crls()</i> sets a set of CRLs to use to aid certificate verification to  <b>sk</b>. These CRLs will only be used if CRL verification is enabled in the associated  <b>X509_VERIFY_PARAM</b> structure. This might be used where additional "useful" CRLs are supplied as part of a protocol, for example in a PKCS#7 structure.<p>
X509_VERIFY_PARAM *<i>X509_STORE_CTX_get0_param()</i> retrieves an intenal pointer to the verification parameters associated with  <b>ctx</b>.<p>
<i>X509_STORE_CTX_set0_param()</i> sets the intenal verification parameter pointer to  <b>param</b>. After this call <b>param</b> should not be used.<p>
<i>X509_STORE_CTX_set_default()</i> looks up and sets the default verification method to  <b>name</b>. This uses the function <i>X509_VERIFY_PARAM_lookup()</i> to find an appropriate set of parameters from  <b>name</b>.</div>
<div class="section">
<h1>NOTES</h1> The certificates and CRLs in a store are used internally and should  <b>not</b> be freed up until after the associated  <b>X509_STORE_CTX</b> is freed. Legacy applications might implicitly use an  <b>X509_STORE_CTX</b> like this:<p>
<br>
  X509_STORE_CTX ctx;<br>
  X509_STORE_CTX_init(&amp;ctx, store, cert, chain);<br>
<p>
this is <b>not</b> recommended in new applications they should instead do:<p>
<br>
  X509_STORE_CTX *ctx;<br>
  ctx = X509_STORE_CTX_new();<br>
  if (ctx == NULL)<br>
        /* Bad error */<br>
  X509_STORE_CTX_init(ctx, store, cert, chain);<br>
</div>
<div class="section">
<h1>BUGS</h1> The certificates and CRLs in a context are used internally and should  <b>not</b> be freed up until after the associated  <b>X509_STORE_CTX</b> is freed. Copies should be made or reference counts increased instead.</div>
<div class="section">
<h1>RETURN VALUES</h1>  <i>X509_STORE_CTX_new()</i> returns an newly allocates context or <b>NULL</b> is an error occurred.<p>
<i>X509_STORE_CTX_init()</i> returns 1 for success or 0 if an error occurred.<p>
<i>X509_STORE_CTX_get0_param()</i> returns a pointer to an <b>X509_VERIFY_PARAM</b> structure or  <b>NULL</b> if an error occurred.<p>
<i>X509_STORE_CTX_cleanup()</i>, <i>X509_STORE_CTX_free()</i>, <i>X509_STORE_CTX_trusted_stack()</i>,  <i>X509_STORE_CTX_set_cert()</i>, <i>X509_STORE_CTX_set_chain()</i>,  <i>X509_STORE_CTX_set0_crls()</i> and <i>X509_STORE_CTX_set0_param()</i> do not return values.<p>
<i>X509_STORE_CTX_set_default()</i> returns 1 for success or 0 if an error occurred.</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>X509_verify_cert</i>(3)  <i>X509_VERIFY_PARAM_set_flags</i>(3)</div>
<div class="section">
<h1>HISTORY</h1>  <i>X509_STORE_CTX_set0_crls()</i> was first added to OpenSSL 1.0.0</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
2009-12-26</td>
<td class="foot-os" align="right">
1.0.1n</td>
</tr>
</table>
</div>
</body>
<>

