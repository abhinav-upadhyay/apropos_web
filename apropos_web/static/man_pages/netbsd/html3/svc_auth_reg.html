<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
RPC_SVC_REG(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
RPC_SVC_REG(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
RPC_SVC_REG(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">rpc_svc_reg</b>, <b class="name">rpc_reg</b>, <b class="name">svc_reg</b>, <b class="name">svc_unreg</b>, <b class="name">svc_auth_reg</b>, <b class="name">xprt_register</b>, <b class="name">xprt_unregister</b> &#8212; <span class="desc">library routines for registering servers</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">rpc/rpc.h</a>&gt;</b><p>
<i class="ftype">bool_t</i><br>
<b class="fname">rpc_reg</b>(<i class="farg" style="white-space:nowrap;">const rpcprog_t prognum</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t versnum</i>, <i class="farg" style="white-space:nowrap;">const rpcproc_t procnum</i>, <i class="farg" style="white-space:nowrap;">const char *(*procname)()</i>, <i class="farg" style="white-space:nowrap;">const xdrproc_t inproc</i>, <i class="farg" style="white-space:nowrap;">const xdrproc_t outproc</i>, <i class="farg" style="white-space:nowrap;">const char *nettype</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">svc_reg</b>(<i class="farg" style="white-space:nowrap;">const SVCXPRT *xprt</i>, <i class="farg" style="white-space:nowrap;">const rpcprog_t prognum</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t versnum</i>, <i class="farg" style="white-space:nowrap;">const void (*dispatch(struct svc_req *, SVCXPRT *)</i>, <i class="farg" style="white-space:nowrap;">const struct netconfig *netconf</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">svc_unreg</b>(<i class="farg" style="white-space:nowrap;">const rpcprog_t prognum</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t versnum</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">svc_auth_reg</b>(<i class="farg" style="white-space:nowrap;">const int cred_flavor</i>, <i class="farg" style="white-space:nowrap;">const enum auth_stat (*handler(struct svc_req *, struct rpc_msg *))</i>);<p>
<i class="ftype">bool_t</i><br>
<b class="fname">xprt_register</b>(<i class="farg" style="white-space:nowrap;">const SVCXPRT *xprt</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">xprt_unregister</b>(<i class="farg" style="white-space:nowrap;">const SVCXPRT *xprt</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> These routines are a part of the RPC library which allows the RPC servers to register themselves with rpcbind (see <a class="link-man" href="../html8/rpcbind.html">rpcbind(8)</a>), and associate the given program and version number with the dispatch function. When the RPC server receives a RPC request, the library invokes the dispatch routine with the appropriate arguments.</div>
<div class="section">
<h1 id="x524f5554494e4553">ROUTINES</h1> See <a class="link-man" href="../html3/rpc.html">rpc(3)</a> for the definition of the <span class="type">SVCXPRT</span> data structure.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">rpc_reg</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
Register program <i class="farg">prognum</i>, procedure <i class="farg">procname</i>, and version <i class="farg">versnum</i> with the RPC service package. If a request arrives for program <i class="farg">prognum</i>, version <i class="farg">versnum</i>, and procedure <i class="farg">procnum</i>, <i class="farg">procname</i> is called with a pointer to its parameter(s); <i class="farg">procname</i> should return a pointer to its static result(s); <i class="farg">inproc</i> is the XDR function used to decode the parameters while <i class="farg">outproc</i> is the XDR function used to encode the results. Procedures are registered on all available transports of the class <i class="farg">nettype</i>. See <a class="link-man" href="../html3/rpc.html">rpc(3)</a>. This routine returns 0 if the registration succeeded, -1 otherwise.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">svc_reg</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
Associates <i class="farg">prognum</i> and <i class="farg">versnum</i> with the service dispatch procedure, <i class="farg">dispatch</i>. If <i class="farg">netconf</i> is <span class="define">NULL</span>, the service is not registered with the <a class="link-man" href="../html8/rpcbind.html">rpcbind(8)</a> service. If <i class="farg">netconf</i> is non-zero, then a mapping of the triple [ <i class="farg">prognum</i>, <i class="farg">versnum</i>, <i class="farg">netconf-&gt;nc_netid</i>] to <i class="farg">xprt-&gt;xp_ltaddr</i> is established with the local rpcbind service.<p>
The <b class="fname">svc_reg</b>() routine returns 1 if it succeeds, and 0 otherwise.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">svc_unreg</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
Remove from the rpcbind service, all mappings of the triple [ <i class="farg">prognum</i>, <i class="farg">versnum</i>, all-transports ] to network address and all mappings within the RPC service package of the double [ <i class="farg">prognum</i>, <i class="farg">versnum</i>] to dispatch routines.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">svc_auth_reg</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
Registers the service authentication routine <i class="farg">handler</i> with the dispatch mechanism so that it can be invoked to authenticate RPC requests received with authentication type <i class="farg">cred_flavor</i>. This interface allows developers to add new authentication types to their RPC applications without needing to modify the libraries. Service implementors usually do not need this routine.<p>
Typical service application would call <b class="fname">svc_auth_reg</b>() after registering the service and prior to calling <b class="fname">svc_run</b>(). When needed to process an RPC credential of type <i class="farg">cred_flavor</i>, the <i class="farg">handler</i> procedure will be called with two parameters <i class="farg">struct svc_req *rqst</i>, and <i class="farg">struct rpc_msg * msg</i>, and is expected to return a valid <span class="type">enum auth_stat</span> value. There is no provision to change or delete an authentication handler once registered.<p>
The <b class="fname">svc_auth_reg</b>() routine returns 0 if the registration is successful, 1 if <i class="farg">cred_flavor</i> already has an authentication handler registered for it, and -1 otherwise.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">xprt_register</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
After RPC service transport handle <i class="farg">xprt</i> is created, it is registered with the RPC service package. This routine modifies the global variable <b class="var">svc_fdset</b> (see <a class="link-man" href="../html3/rpc_svc_calls.html">rpc_svc_calls(3)</a>). Service implementors usually do not need this routine.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">xprt_unregister</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
Before an RPC service transport handle <i class="farg">xprt</i> is destroyed, it unregisters itself with the RPC service package. This routine modifies the global variable <b class="var">svc_fdset</b> (see <a class="link-man" href="../html3/rpc_svc_calls.html">rpc_svc_calls(3)</a>). Service implementors usually do not need this routine.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html2/select.html">select(2)</a>, <a class="link-man" href="../html3/rpc.html">rpc(3)</a>, <a class="link-man" href="../html3/rpc_svc_calls.html">rpc_svc_calls(3)</a>, <a class="link-man" href="../html3/rpc_svc_create.html">rpc_svc_create(3)</a>, <a class="link-man" href="../html3/rpc_svc_err.html">rpc_svc_err(3)</a>, <a class="link-man" href="../html3/rpcbind.html">rpcbind(3)</a>, <a class="link-man" href="../html8/rpcbind.html">rpcbind(8)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 3, 1993</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

