<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
LIBNETPGP(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
LIBNETPGP(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
LIBNETPGP(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">libnetpgp</b> &#8212; <span class="desc">digital signing and verification, encryption and decryption</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Netpgp Signing, Verification, Encryption and Decryption (libnetpgp, &#45;lnetpgp)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">netpgp.h</a>&gt;</b><p>
The following functions relate to initialisations and finalisations:<br>
<i class="ftype">int</i><br>
<b class="fname">netpgp_init</b>(<i class="farg">netpgp_t *netpgp</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_end</b>(<i class="farg">netpgp_t *netpgp</i>);<p>
The following functions are for debugging, reflection and information:<br>
<i class="ftype">int</i><br>
<b class="fname">netpgp_set_debug</b>(<i class="farg">const char *filename</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_get_debug</b>(<i class="farg">const char *filename</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_get_info</b>(<i class="farg">const char *type</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_list_packets</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">char *filename</i>, <i class="farg">int armour</i>, <i class="farg">char *pubringname</i>);<p>
The following functions are for variable management:<br>
<i class="ftype">int</i><br>
<b class="fname">netpgp_setvar</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">const char *name</i>, <i class="farg">const char *value</i>);<p>
<i class="ftype">char *</i><br>
<b class="fname">netpgp_getvar</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">const char *name</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_incvar</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">const char *name</i>, <i class="farg">const int delta</i>);<p>
The following function sets the home directory:<br>
<i class="ftype">int</i><br>
<b class="fname">netpgp_set_homedir</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">char *homedir</i>, <i class="farg">char *subdir</i>, <i class="farg">const int quiet</i>);<p>
The following functions are used for key management:<br>
<i class="ftype">int</i><br>
<b class="fname">netpgp_list_keys</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">const int printsigs</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_match_list_keys</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">char *pattern</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_find_key</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">char *userid</i>);<p>
<i class="ftype">char *</i><br>
<b class="fname">netpgp_get_key</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">const char *id</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_export_key</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">char *userid</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_import_key</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">char *file</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_generate_key</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">char *userid</i>, <i class="farg">int numbits</i>);<p>
The following functions are used for file management:<br>
<i class="ftype">int</i><br>
<b class="fname">netpgp_encrypt_file</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">char *userid</i>, <i class="farg">char *filename</i>, <i class="farg">char *out</i>, <i class="farg">int armored</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_decrypt_file</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">char *filename</i>, <i class="farg">char *out</i>, <i class="farg">int armored</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_sign_file</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">char *userid</i>, <i class="farg">char *filename</i>, <i class="farg">char *out</i>, <i class="farg">int armored</i>, <i class="farg">int cleartext</i>, <i class="farg">int detached</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_verify_file</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">char *f</i>, <i class="farg">int armored</i>);<p>
The following functions are used for memory signing and encryption:<br>
<i class="ftype">int</i><br>
<b class="fname">netpgp_encrypt_memory</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">char *userid</i>, <i class="farg">void *in</i>, <i class="farg">const size_t insize</i>, <i class="farg">char *out</i>, <i class="farg">size_t outsize</i>, <i class="farg">int armored</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_decrypt_memory</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">const void *input</i>, <i class="farg">const size_t insize</i>, <i class="farg">char *out</i>, <i class="farg">size_t outsize</i>, <i class="farg">const int armored</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_sign_memory</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">const char *userid</i>, <i class="farg">char *mem</i>, <i class="farg">size_t size</i>, <i class="farg">char *out</i>, <i class="farg">size_t outsize</i>, <i class="farg">const unsigned armored</i>, <i class="farg">const unsigned cleartext</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">netpgp_verify_memory</b>(<i class="farg">netpgp_t *netpgp</i>, <i class="farg">const void *in</i>, <i class="farg">const size_t insize</i>, <i class="farg">void *out</i>, <i class="farg">size_t outsize</i>, <i class="farg">const int armored</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">libnetpgp</b> is a library interface to enable digital signatures to be created and verified, and also for files and memory to be encrypted and decrypted. Functions are also provided for management of user keys.<p>
The library uses functions from the openssl library for multi-precision integer arithmetic, and for RSA and DSA key signing and verification, encryption and decryption.<p>
Normal operation sees the <b class="name">libnetpgp</b> process be initialised using the <b class="fname">netpgp_init</b>() function, which will set up the public and private keyrings, and set the user identity to the <i class="arg">userid</i> argument passed stored in the <span class="define">netpgp_t</span> structure, and set using the <b class="fname">netpgp_setvar</b>() function. If no public key ring file is set, initial values will be taken from those in the <i class="file">.gnupg/pubring.gpg</i> file in the user's home directory. Similarly, if no secret key ring file is set, initial values will be taken from those in the <i class="file">.gnupg/secring.gpg</i> file in the user's home directory. The <b class="fname">netpgp_init</b>() function returns 1 on success, 0 on failure.<p>
To list all the keys in a keyring, the <b class="fname">netpgp_list_keys</b>() function is used. The signature subkey fields can also be displayed using this function. The <b class="fname">netpgp_match_list_keys</b>() function is used to match (via regular expression) a subset of the keys in the keyring. If the expression to match is NULL, the search will degenerate into a listing of all keys in the keyring.<p>
The home directory is specified as an internal variable, and its existence is checked using the <b class="fname">netpgp_set_homedir</b>() function. This function can operate in a verbose or quiet manner, depending on the value of the argument provided. If the subdirectory argument is provided, this subdirectory is appended to the home directory in order to search for the keyrings.<p>
To export a key, the <b class="fname">netpgp_export_key</b>() function is used. Output is sent to the standard output.<p>
To import a key onto the public keyring, the <b class="fname">netpgp_import_key</b>() is used. The name of the file containing the key to be imported is provided as the filename argument.<p>
To generate a key, the <b class="fname">netpgp_generate_key</b>() is used. It takes an argument of the number of bits to use in the key. At the time that this manual page was created (April 2009), the recommendations are that the bare minimum key size of at least 2048 bits is used, and it would be much better to use at least 4096 or 8192 bits. This situation should be monitored to ensure that it does not go out of date.<p>
Encryption, decryption, signing and verification of files are the lifeblood of the <b class="name">libnetpgp</b> library. To encrypt a file, the <b class="fname">netpgp_encrypt_file</b>() function is used, and the <b class="fname">netpgp_decrypt_file</b>() function is used to decrypt the results of the encryption. To sign a file, the <b class="fname">netpgp_sign_file</b>() function is used, and the resulting signed file can be verified using the <b class="fname">netpgp_verify_file</b>() function.<p>
<b class="fname">netpgp_sign_memory</b>() is a function which can sign an area of memory, and <b class="fname">netpgp_verify_memory</b>() verifies the digital signature produced.<p>
Internally, an encrypted or signed file is made up of &#8220;packets&#8221; which hold information pertaining to the signature, encryption method, and the data which is being protected. This information can be displayed in a verbose manner using the <b class="fname">netpgp_list_packets</b>() function.<p>
The <b class="fname">netpgp_setvar</b>() and <b class="fname">netpgp_getvar</b>() functions are used to manage the hash algorithm that is used with RSA signatures. These functions are general purpose functions, and are used to set and retrieve values for internal variables. For example, they can be used to set and to retrieve the value of the user id which has been set, the home directory from which to find the keyrings, the verbosity settings, and many more. The <b class="fname">netpgp_incvar</b>() function is used to add a numeric increment to the internal variable. This incremental value can be negative. It is primarily used to increase the verbosity settings.<p>
In <b class="name">libnetpgp</b> files are encrypted using the public key of the userid. The secret key is used to decrypt the results of that encryption. Files are signed using the secret key of the userid. The public key is used to verify that the file was signed, who signed the file, and the date and time at which it was signed.<p>
Some utility functions are also provided for debugging, and for finding out version and maintainer information from calling programs. These are the <b class="fname">netpgp_set_debug</b>() and the <b class="fname">netpgp_get_debug</b>() functions (for getting verbose debugging information on a per-source file basis).<p>
The <b class="fname">netpgp_get_info</b>() function returns the version or maintainer information depending upon the <i class="arg">type</i> argument. At the present time, two types are defined: &#8220;version&#8221; and &#8220;maintainer&#8221;. A failure to present a known <i class="arg">type</i> argument to <b class="fname">netpgp_get_info</b>() will result in the string &#8220;[unknown]&#8221; being returned.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/netpgp.html">netpgp(1)</a>, <a class="link-man" href="../html3/ssl.html">ssl(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">libnetpgp</b> library first appeared in <span class="unix">NetBSD&#160;6.0</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author"></span><span class="author">Ben Laurie</span>, <span class="author">Rachel Willmer</span>. <span class="author">Alistair Crooks</span> &#60;<a class="link-mail" href="mailto:agc@NetBSD.org">agc@NetBSD.org</a>&#62; wrote this high-level interface.<p>
This manual page was written by <span class="author">Alistair Crooks</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
February 16, 2014</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

