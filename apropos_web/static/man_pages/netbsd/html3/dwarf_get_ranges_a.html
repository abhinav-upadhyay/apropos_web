<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
DWARF_GET_RANGES(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
DWARF_GET_RANGES(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
DWARF_GET_RANGES(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">dwarf_get_ranges</b> &#8212; <span class="desc">retrieve non-contiguous address ranges</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">DWARF Access Library (libdwarf, &#45;ldwarf)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">libdwarf.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">dwarf_get_ranges</b>(<i class="farg">Dwarf_Debug dbg</i>, <i class="farg">Dwarf_Off offset</i>, <i class="farg">Dwarf_Ranges **ranges</i>, <i class="farg">Dwarf_Signed *cnt</i>, <i class="farg">Dwarf_Unsigned *byte_cnt</i>, <i class="farg">Dwarf_Error *err</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">dwarf_get_ranges_a</b>(<i class="farg">Dwarf_Debug dbg</i>, <i class="farg">Dwarf_Off offset</i>, <i class="farg">Dwarf_Die die</i>, <i class="farg">Dwarf_Ranges **ranges</i>, <i class="farg">Dwarf_Signed *cnt</i>, <i class="farg">Dwarf_Unsigned *byte_cnt</i>, <i class="farg">Dwarf_Error *err</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> Function <b class="fname">dwarf_get_ranges</b>() retrieves information about the non-contiguous address ranges associated with a DWARF debugging information entry. Information about address ranges is returned as an array of descriptors of type <span class="type">Dwarf_Ranges</span>, with each <span class="type">Dwarf_Ranges</span> descriptor describing one address range entry.<p>
Argument <i class="arg">dbg</i> should reference a DWARF debug context allocated using <a class="link-man" href="../3/dwarf_init">dwarf_init(3)</a>.<p>
Argument <i class="arg">offset</i> is an offset, relative to the &#8220;.debug_ranges&#8221; section, to the start of the desired list of address ranges. The offset of an address ranges list is indicated by the <span class="define">DW_AT_ranges</span> attribute of a debugging information entry.<p>
Argument <i class="arg">die</i> (function <b class="fname">dwarf_get_ranges_a</b>() only) is ignored in this implementation; see the section <i class="link-sec"><a class="link-sec" href="#x436f6d7061746962696c697479204e6f746573">Compatibility Notes</a></i> below.<p>
Argument <i class="arg">ranges</i> should point to a location that will be set to a pointer to an array of <span class="type">Dwarf_Ranges</span> descriptors.<p>
Argument <i class="arg">cnt</i> should point to a location that will be set to the number of entries returned. If argument <i class="arg">byte_cnt</i> is not NULL, it will be set to the number of bytes occupied by the returned entries in the &#8220;.debug_ranges&#8221; section.<p>
If argument <i class="arg">err</i> is not NULL, it will be used to store error information in case of an error.<p>
<span class="type">Dwarf_Ranges</span> descriptors are defined in the header file <b class="includes">&lt;<a class="link-includes">libdwarf.h</a>&gt;</b>, and consists of the following fields:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">dwr_addr1</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The first address offset, whose meaning depends on the type of the entry.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">dwr_addr2</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The second address offset, whose meaning depends on the type of the entry.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">dwr_type</b></dt>
<dd class="list-tag" style="margin-left: 13.00ex;">
The type of this address range entry:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">DW_RANGES_ENTRY</span></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
A range list entry. For this type of entry, the fields <b class="var">dwr_addr1</b> and <b class="var">dwr_addr2</b> hold the beginning and ending offsets of the address range, respectively.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">DW_RANGES_ADDRESS_SELECTION</span></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
A base address selection entry. For this type of entry, the field <b class="var">dwr_addr1</b> is the value of the largest representable address offset, and <b class="var">dwr_addr2</b> is a base address for the begining and ending address offsets of subsequent address range entries in the list.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="define">DW_RANGES_END</span></dt>
<dd class="list-tag" style="margin-left: 19.00ex;">
An end of list mark. Both <b class="var">dwr_addr1</b> and <b class="var">dwr_addr2</b> are set to 0.</dd>
</dl>
</dd>
</dl>
<div class="subsection">
<h2 id="x4d656d6f7279204d616e6167656d656e74">Memory Management</h2> The memory area used for the array of <span class="type">Dwarf_Ranges</span> descriptors returned in argument <i class="arg">ranges</i> is owned by the <span class="lib">DWARF Access Library (libdwarf, &#45;ldwarf)</span>. The application should not attempt to directly free this pointer. Portable code should instead use <b class="fname">dwarf_ranges_dealloc</b>() to indicate that the memory may be freed.</div>
</div>
<div class="section">
<h1 id="x434f4d5041544942494c495459">COMPATIBILITY</h1> Function <b class="fname">dwarf_get_ranges_a</b>() is identical to <b class="fname">dwarf_get_ranges</b>(), except that it requires one additional argument <i class="arg">die</i> denoting the debugging information entry associated with the address range list. In this implementation of the <span class="lib">DWARF Access Library (libdwarf, &#45;ldwarf)</span>, the argument <i class="arg">die</i> is ignored, and function <b class="fname">dwarf_get_ranges_a</b>() is only provided for compatibility with other implementations of the DWARF(3) API.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> These functions return <span class="define">DW_DLV_OK</span> when they succeed. They return <span class="define">DW_DLV_NO_ENTRY</span> if there is no address range list at the specified offset <i class="arg">offset</i>. In case of an error, they return <span class="define">DW_DLV_ERROR</span> and set the argument <i class="arg">err</i>.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> These function can fail with:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_ARGUMENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
One of the arguments <i class="arg">dbg</i>, <i class="arg">ranges</i> or <i class="arg">cnt</i> was NULL.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_NO_ENTRY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
There is no address range list at the specified offset <i class="arg">offset</i>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c45">EXAMPLE</h1> To retrieve the address range list associated with a debugging information entry, use:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
Dwarf_Debug dbg; 
Dwarf_Die die; 
Dwarf_Error de; 
Dwarf_Addr base; 
Dwarf_Attribute *attr_list; 
Dwarf_Ranges *ranges; 
Dwarf_Signed cnt; 
Dwarf_Unsigned off, attr_count, bytecnt; 
int i, j; 
 
if ((ret = dwarf_attrlist(die, &amp;attr_list, &amp;attr_count, &amp;de)) != 
    DW_DLV_OK) 
	errx(EXIT_FAILURE, "dwarf_attrlist failed: %s", 
	    dwarf_errmsg(de)); 
 
for (i = 0; (Dwarf_Unsigned) i &lt; attr_count; i++) { 
	if (dwarf_whatattr(attr_list[i], &amp;attr, &amp;de) != DW_DLV_OK) { 
		warnx("dwarf_whatattr failed: %s", 
		    dwarf_errmsg(de)); 
		continue; 
	} 
	if (attr != DW_AT_ranges) 
		continue; 
	if (dwarf_formudata(attr_list[i], &amp;off, &amp;de) != DW_DLV_OK) { 
		warnx("dwarf_formudata failed: %s", 
		    dwarf_errmsg(de)); 
		continue; 
	} 
	if (dwarf_get_ranges(dbg, (Dwarf_Off) off, &amp;ranges, &amp;cnt, 
	    &amp;bytecnt, &amp;de) != DW_DLV_OK) 
		continue; 
	for (j = 0; j &lt; cnt; j++) { 
		if (ranges[j].dwr_type == DW_RANGES_END) 
			break; 
		else if (ranges[j].dwr_type == 
		    DW_RANGES_ADDRESS_SELECTION) 
			base = ranges[j].dwr_addr2; 
		else { 
			/* 
			 * DW_RANGES_ENTRY entry. 
			 * .. Use dwr_addr1 and dwr_addr2 .. 
			 */ 
		} 
	} 
}</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/dwarf">dwarf(3)</a>, <a class="link-man" href="../3/dwarf_ranges_dealloc">dwarf_ranges_dealloc(3)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
November 9, 2011</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

