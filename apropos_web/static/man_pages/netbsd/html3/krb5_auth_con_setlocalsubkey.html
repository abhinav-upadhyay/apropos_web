<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
KRB5_AUTH_CONTEXT(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
KRB5_AUTH_CONTEXT(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
KRB5_AUTH_CONTEXT(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">krb5_auth_con_addflags</b>, <b class="name">krb5_auth_con_free</b>, <b class="name">krb5_auth_con_genaddrs</b>, <b class="name">krb5_auth_con_generatelocalsubkey</b>, <b class="name">krb5_auth_con_getaddrs</b>, <b class="name">krb5_auth_con_getauthenticator</b>, <b class="name">krb5_auth_con_getflags</b>, <b class="name">krb5_auth_con_getkey</b>, <b class="name">krb5_auth_con_getlocalsubkey</b>, <b class="name">krb5_auth_con_getrcache</b>, <b class="name">krb5_auth_con_getremotesubkey</b>, <b class="name">krb5_auth_con_getuserkey</b>, <b class="name">krb5_auth_con_init</b>, <b class="name">krb5_auth_con_initivector</b>, <b class="name">krb5_auth_con_removeflags</b>, <b class="name">krb5_auth_con_setaddrs</b>, <b class="name">krb5_auth_con_setaddrs_from_fd</b>, <b class="name">krb5_auth_con_setflags</b>, <b class="name">krb5_auth_con_setivector</b>, <b class="name">krb5_auth_con_setkey</b>, <b class="name">krb5_auth_con_setlocalsubkey</b>, <b class="name">krb5_auth_con_setrcache</b>, <b class="name">krb5_auth_con_setremotesubkey</b>, <b class="name">krb5_auth_con_setuserkey</b>, <b class="name">krb5_auth_context</b>, <b class="name">krb5_auth_getcksumtype</b>, <b class="name">krb5_auth_getkeytype</b>, <b class="name">krb5_auth_getlocalseqnumber</b>, <b class="name">krb5_auth_getremoteseqnumber</b>, <b class="name">krb5_auth_setcksumtype</b>, <b class="name">krb5_auth_setkeytype</b>, <b class="name">krb5_auth_setlocalseqnumber</b>, <b class="name">krb5_auth_setremoteseqnumber</b>, <b class="name">krb5_free_authenticator</b> &#8212; <span class="desc">manage authentication on connection level</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> Kerberos 5 Library (libkrb5, -lkrb5)</div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">krb5/krb5.h</a>&gt;</b><p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_init</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context *auth_context</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">krb5_auth_con_free</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_setflags</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>, <i class="farg">int32_t flags</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_getflags</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>, <i class="farg">int32_t *flags</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_addflags</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>, <i class="farg">int32_t addflags</i>, <i class="farg">int32_t *flags</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_removeflags</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>, <i class="farg">int32_t removelags</i>, <i class="farg">int32_t *flags</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_setaddrs</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>, <i class="farg">krb5_address *local_addr</i>, <i class="farg">krb5_address *remote_addr</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_getaddrs</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>, <i class="farg">krb5_address **local_addr</i>, <i class="farg">krb5_address **remote_addr</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_genaddrs</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>, <i class="farg">int fd</i>, <i class="farg">int flags</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_setaddrs_from_fd</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>, <i class="farg">void *p_fd</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_getkey</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>, <i class="farg">krb5_keyblock **keyblock</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_getlocalsubkey</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>, <i class="farg">krb5_keyblock **keyblock</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_getremotesubkey</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>, <i class="farg">krb5_keyblock **keyblock</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_generatelocalsubkey</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>, <i class="farg">krb5_keyblock</i>, <i class="farg">*key"</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_initivector</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context auth_context</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_auth_con_setivector</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_auth_context *auth_context</i>, <i class="farg">krb5_pointer ivector</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">krb5_free_authenticator</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_authenticator *authenticator</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">krb5_auth_context</b> structure holds all context related to an authenticated connection, in a similar way to <b class="name">krb5_context</b> that holds the context for the thread or process. <b class="name">krb5_auth_context</b> is used by various functions that are directly related to authentication between the server/client. Example of data that this structure contains are various flags, addresses of client and server, port numbers, keyblocks (and subkeys), sequence numbers, replay cache, and checksum-type.<p>
<b class="fname">krb5_auth_con_init</b>() allocates and initializes the <b class="name">krb5_auth_context</b> structure. Default values can be changed with <b class="fname">krb5_auth_con_setcksumtype</b>() and <b class="fname">krb5_auth_con_setflags</b>(). The <b class="name">auth_context</b> structure must be freed by <b class="fname">krb5_auth_con_free</b>().<p>
<b class="fname">krb5_auth_con_getflags</b>(), <b class="fname">krb5_auth_con_setflags</b>(), <b class="fname">krb5_auth_con_addflags</b>() and <b class="fname">krb5_auth_con_removeflags</b>() gets and modifies the flags for a <b class="name">krb5_auth_context</b> structure. Possible flags to set are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">KRB5_AUTH_CONTEXT_DO_SEQUENCE</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Generate and check sequence-number on each packet.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">KRB5_AUTH_CONTEXT_DO_TIME</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Check timestamp on incoming packets.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">KRB5_AUTH_CONTEXT_RET_SEQUENCE</span>, <span class="define">KRB5_AUTH_CONTEXT_RET_TIME</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
Return sequence numbers and time stamps in the outdata parameters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">KRB5_AUTH_CONTEXT_CLEAR_FORWARDED_CRED</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
will force <b class="fname">krb5_get_forwarded_creds</b>() and <b class="fname">krb5_fwd_tgt_creds</b>() to create unencrypted ) <span class="define">ENCTYPE_NULL</span>) credentials. This is for use with old MIT server and JAVA based servers as they can't handle encrypted <span class="define">KRB-CRED</span>. Note that sending such <span class="define">KRB-CRED</span> is clear exposes crypto keys and tickets and is insecure, make sure the packet is encrypted in the protocol. <a class="link-man" href="../3/krb5_rd_cred">krb5_rd_cred(3)</a>, <a class="link-man" href="../3/krb5_rd_priv">krb5_rd_priv(3)</a>, <a class="link-man" href="../3/krb5_rd_safe">krb5_rd_safe(3)</a>, <a class="link-man" href="../3/krb5_mk_priv">krb5_mk_priv(3)</a> and <a class="link-man" href="../3/krb5_mk_safe">krb5_mk_safe(3)</a>. Setting this flag requires that parameter to be passed to these functions.<p>
The flags <span class="define">KRB5_AUTH_CONTEXT_DO_TIME</span> also modifies the behavior the function <b class="fname">krb5_get_forwarded_creds</b>() by removing the timestamp in the forward credential message, this have backward compatibility problems since not all versions of the heimdal supports timeless credentional messages. Is very useful since it always the sender of the message to cache forward message and thus avoiding a round trip to the KDC for each time a credential is forwarded. The same functionality can be obtained by using address-less tickets.</dd>
</dl>
<p>
<b class="fname">krb5_auth_con_setaddrs</b>(), <b class="fname">krb5_auth_con_setaddrs_from_fd</b>() and <b class="fname">krb5_auth_con_getaddrs</b>() gets and sets the addresses that are checked when a packet is received. It is mandatory to set an address for the remote host. If the local address is not set, it iss deduced from the underlaying operating system. <b class="fname">krb5_auth_con_getaddrs</b>() will call <b class="fname">krb5_free_address</b>() on any address that is passed in <i class="farg">local_addr</i> or <i class="farg">remote_addr</i>. <b class="fname">krb5_auth_con_setaddr</b>() allows passing in a <span class="define">NULL</span> pointer as <i class="farg">local_addr</i> and <i class="farg">remote_addr</i>, in that case it will just not set that address.<p>
<b class="fname">krb5_auth_con_setaddrs_from_fd</b>() fetches the addresses from a file descriptor.<p>
<b class="fname">krb5_auth_con_genaddrs</b>() fetches the address information from the given file descriptor <i class="farg">fd</i> depending on the bitmap argument <i class="farg">flags</i>.<p>
Possible values on <i class="farg">flags</i> are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">KRB5_AUTH_CONTEXT_GENERATE_LOCAL_ADDR</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
fetches the local address from <i class="farg">fd</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="var">KRB5_AUTH_CONTEXT_GENERATE_REMOTE_ADDR</b></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
fetches the remote address from <i class="farg">fd</i>.</dd>
</dl>
<p>
<b class="fname">krb5_auth_con_setkey</b>(), <b class="fname">krb5_auth_con_setuserkey</b>() and <b class="fname">krb5_auth_con_getkey</b>() gets and sets the key used for this auth context. The keyblock returned by <b class="fname">krb5_auth_con_getkey</b>() should be freed with <b class="fname">krb5_free_keyblock</b>(). The keyblock send into <b class="fname">krb5_auth_con_setkey</b>() is copied into the <b class="name">krb5_auth_context</b>, and thus no special handling is needed. <span class="define">NULL</span> is not a valid keyblock to <b class="fname">krb5_auth_con_setkey</b>().<p>
<b class="fname">krb5_auth_con_setuserkey</b>() is only useful when doing user to user authentication. <b class="fname">krb5_auth_con_setkey</b>() is equivalent to <b class="fname">krb5_auth_con_setuserkey</b>().<p>
<b class="fname">krb5_auth_con_getlocalsubkey</b>(), <b class="fname">krb5_auth_con_setlocalsubkey</b>(), <b class="fname">krb5_auth_con_getremotesubkey</b>() and <b class="fname">krb5_auth_con_setremotesubkey</b>() gets and sets the keyblock for the local and remote subkey. The keyblock returned by <b class="fname">krb5_auth_con_getlocalsubkey</b>() and <b class="fname">krb5_auth_con_getremotesubkey</b>() must be freed with <b class="fname">krb5_free_keyblock</b>().<p>
<b class="fname">krb5_auth_setcksumtype</b>() and <b class="fname">krb5_auth_getcksumtype</b>() sets and gets the checksum type that should be used for this connection.<p>
<b class="fname">krb5_auth_con_generatelocalsubkey</b>() generates a local subkey that have the same encryption type as <i class="farg">key</i>.<p>
<b class="fname">krb5_auth_getremoteseqnumber</b>() <b class="fname">krb5_auth_setremoteseqnumber</b>(), <b class="fname">krb5_auth_getlocalseqnumber</b>() and <b class="fname">krb5_auth_setlocalseqnumber</b>() gets and sets the sequence-number for the local and remote sequence-number counter.<p>
<b class="fname">krb5_auth_setkeytype</b>() and <b class="fname">krb5_auth_getkeytype</b>() gets and gets the keytype of the keyblock in <b class="name">krb5_auth_context</b>.<p>
<b class="fname">krb5_auth_con_getauthenticator</b>() Retrieves the authenticator that was used during mutual authentication. The <span class="define">authenticator</span> returned should be freed by calling <b class="fname">krb5_free_authenticator</b>().<p>
<b class="fname">krb5_auth_con_getrcache</b>() and <b class="fname">krb5_auth_con_setrcache</b>() gets and sets the replay-cache.<p>
<b class="fname">krb5_auth_con_initivector</b>() allocates memory for and zeros the initial vector in the <i class="farg">auth_context</i> keyblock.<p>
<b class="fname">krb5_auth_con_setivector</b>() sets the i_vector portion of <i class="farg">auth_context</i> to <i class="farg">ivector</i>.<p>
<b class="fname">krb5_free_authenticator</b>() free the content of <i class="farg">authenticator</i> and <i class="farg">authenticator</i> itself.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/krb5_context">krb5_context(3)</a>, <a class="link-man" href="../8/kerberos">kerberos(8)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 17, 2005</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

