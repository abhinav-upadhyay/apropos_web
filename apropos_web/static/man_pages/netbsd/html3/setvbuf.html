<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
SETBUF(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
SETBUF(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
SETBUF(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">setbuf</b>, <b class="name">setbuffer</b>, <b class="name">setlinebuf</b>, <b class="name">setvbuf</b> &#8212; <span class="desc">stream buffering operations</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">stdio.h</a>&gt;</b><p>
<i class="ftype">void</i><br>
<b class="fname">setbuf</b>(<i class="farg" style="white-space:nowrap;">FILE * restrict stream</i>, <i class="farg" style="white-space:nowrap;">char * restrict buf</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">setbuffer</b>(<i class="farg" style="white-space:nowrap;">FILE *stream</i>, <i class="farg" style="white-space:nowrap;">char *buf</i>, <i class="farg" style="white-space:nowrap;">size_t size</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">setlinebuf</b>(<i class="farg" style="white-space:nowrap;">FILE *stream</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">setvbuf</b>(<i class="farg" style="white-space:nowrap;">FILE * restrict stream</i>, <i class="farg" style="white-space:nowrap;">char * restrict buf</i>, <i class="farg" style="white-space:nowrap;">int mode</i>, <i class="farg" style="white-space:nowrap;">size_t size</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The three types of buffering available are unbuffered, block buffered, and line buffered. When an output stream is unbuffered, information appears on the destination file or terminal as soon as written; when it is block buffered many characters are saved up and written as a block; when it is line buffered characters are saved up until a newline is output or input is read from any stream attached to a terminal device (typically stdin). The function <a class="link-man" href="../3/fflush">fflush(3)</a> may be used to force the block out early. (See <a class="link-man" href="../3/fclose">fclose(3)</a>.)<p>
Normally all files are block buffered. When the first I/O operation occurs on a file, <a class="link-man" href="../3/malloc">malloc(3)</a> is called, and an optimally-sized buffer is obtained. If a stream refers to a terminal (as <span class="emph">stdout</span> normally does) it is line buffered. The standard error stream <span class="emph">stderr</span> is initially unbuffered.<p>
The <b class="fname">setvbuf</b>() function may be used to alter the buffering behavior of a stream. The <i class="farg">mode</i> parameter must be one of the following three macros:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">_IONBF</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
unbuffered</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">_IOLBF</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
line buffered</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">_IOFBF</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
fully buffered</dd>
</dl>
<p>
The <i class="farg">size</i> parameter may be given as zero to obtain deferred optimal-size buffer allocation as usual. If it is not zero, then except for unbuffered files, the <i class="farg">buf</i> argument should point to a buffer at least <i class="farg">size</i> bytes long; this buffer will be used instead of the current buffer. (If the <i class="farg">size</i> argument is not zero but <i class="farg">buf</i> is <span class="define">NULL</span>, a buffer of the given size will be allocated immediately, and released on close. This is an extension to ANSI C; portable code should use a size of 0 with any <span class="define">NULL</span> buffer.)<p>
The <b class="fname">setvbuf</b>() function may be used at any time, but may have peculiar side effects (such as discarding input or flushing output) if the stream is ``active''. Portable applications should call it only once on any given stream, and before any I/O is performed.<p>
The other three calls are, in effect, simply aliases for calls to <b class="fname">setvbuf</b>(). Except for the lack of a return value, the <b class="fname">setbuf</b>() function is exactly equivalent to the call<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">setvbuf(stream, buf, buf ? _IOFBF : _IONBF, BUFSIZ);</code></div>
</blockquote>
<p>
The <b class="fname">setbuffer</b>() function is the same, except that the size of the buffer is up to the caller, rather than being determined by the default <span class="define">BUFSIZ</span>. The <b class="fname">setlinebuf</b>() function is exactly equivalent to the call:<p>
<blockquote style="margin-top: 0.00em;margin-bottom: 0.00em;">
<div class="display">
<code class="lit">setvbuf(stream, (char *)NULL, _IOLBF, 0);</code></div>
</blockquote>
</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> The <b class="fname">setvbuf</b>() function returns 0 on success, or <span class="define">EOF</span> if the request cannot be honored (note that the stream is still functional in this case).<p>
The <b class="fname">setlinebuf</b>() function returns what the equivalent <b class="fname">setvbuf</b>() would have returned.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/fclose">fclose(3)</a>, <a class="link-man" href="../3/fopen">fopen(3)</a>, <a class="link-man" href="../3/fread">fread(3)</a>, <a class="link-man" href="../3/malloc">malloc(3)</a>, <a class="link-man" href="../3/printf">printf(3)</a>, <a class="link-man" href="../3/puts">puts(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">setbuf</b>() and <b class="fname">setvbuf</b>() functions conform to ANSI X3.159-1989 (&#8220;ANSI&#160;C89&#8221;).</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The <b class="fname">setbuffer</b>() and <b class="fname">setlinebuf</b>() functions are not portable to versions of <span class="unix">BSD</span> before <span class="unix">4.2BSD</span>. On <span class="unix">4.2BSD</span> and <span class="unix">4.3BSD</span> systems, <b class="fname">setbuf</b>() always uses a suboptimal buffer size and should be avoided.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
June 4, 1993</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

