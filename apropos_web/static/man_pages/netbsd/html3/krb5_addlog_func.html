<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
KRB5_OPENLOG(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
KRB5_OPENLOG(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
KRB5_OPENLOG(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">krb5_initlog</b>, <b class="name">krb5_openlog</b>, <b class="name">krb5_closelog</b>, <b class="name">krb5_addlog_dest</b>, <b class="name">krb5_addlog_func</b>, <b class="name">krb5_log</b>, <b class="name">krb5_vlog</b>, <b class="name">krb5_log_msg</b>, <b class="name">krb5_vlog_msg</b> &#8212; <span class="desc">Heimdal logging functions</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> Kerberos 5 Library (libkrb5, -lkrb5)</div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">krb5/krb5.h</a>&gt;</b><p>
<i class="ftype">typedef void</i><br>
<b class="fname">(*krb5_log_log_func_t)</b>(<i class="farg" style="white-space:nowrap;">const char *time</i>, <i class="farg" style="white-space:nowrap;">const char *message</i>, <i class="farg" style="white-space:nowrap;">void *data</i>);<p>
<i class="ftype">typedef void</i><br>
<b class="fname">(*krb5_log_close_func_t)</b>(<i class="farg" style="white-space:nowrap;">void *data</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_addlog_dest</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_log_facility *facility</i>, <i class="farg" style="white-space:nowrap;">const char *destination</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_addlog_func</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_log_facility *facility</i>, <i class="farg" style="white-space:nowrap;">int min</i>, <i class="farg" style="white-space:nowrap;">int max</i>, <i class="farg" style="white-space:nowrap;">krb5_log_log_func_t log</i>, <i class="farg" style="white-space:nowrap;">krb5_log_close_func_t close</i>, <i class="farg" style="white-space:nowrap;">void *data</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_closelog</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_log_facility *facility</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_initlog</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">const char *program</i>, <i class="farg" style="white-space:nowrap;">krb5_log_facility **facility</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_log</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_log_facility *facility</i>, <i class="farg" style="white-space:nowrap;">int level</i>, <i class="farg" style="white-space:nowrap;">const char *format</i>, <i class="farg" style="white-space:nowrap;">...</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_log_msg</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_log_facility *facility</i>, <i class="farg" style="white-space:nowrap;">char **reply</i>, <i class="farg" style="white-space:nowrap;">int level</i>, <i class="farg" style="white-space:nowrap;">const char *format</i>, <i class="farg" style="white-space:nowrap;">...</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_openlog</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">const char *program</i>, <i class="farg" style="white-space:nowrap;">krb5_log_facility **facility</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_vlog</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_log_facility *facility</i>, <i class="farg" style="white-space:nowrap;">int level</i>, <i class="farg" style="white-space:nowrap;">const char *format</i>, <i class="farg" style="white-space:nowrap;">va_list arglist</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_vlog_msg</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_log_facility *facility</i>, <i class="farg" style="white-space:nowrap;">char **reply</i>, <i class="farg" style="white-space:nowrap;">int level</i>, <i class="farg" style="white-space:nowrap;">const char *format</i>, <i class="farg" style="white-space:nowrap;">va_list arglist</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> These functions logs messages to one or more destinations.<p>
The <b class="fname">krb5_openlog</b>() function creates a logging <i class="farg">facility</i>, that is used to log messages. A facility consists of one or more destinations (which can be files or syslog or some other device). The <i class="farg">program</i> parameter should be the generic name of the program that is doing the logging. This name is used to lookup which destinations to use. This information is contained in the <code class="lit">logging</code> section of the <i class="file">krb5.conf</i> configuration file.  If no entry is found for <i class="farg">program</i>, the entry for <code class="lit">default</code> is used, or if that is missing too, <code class="lit">SYSLOG</code> will be used as destination.<p>
To close a logging facility, use the <b class="fname">krb5_closelog</b>() function.<p>
To log a message to a facility use one of the functions <b class="fname">krb5_log</b>(), <b class="fname">krb5_log_msg</b>(), <b class="fname">krb5_vlog</b>(), or <b class="fname">krb5_vlog_msg</b>(). The functions ending in <code class="lit">_msg</code> return in <i class="farg">reply</i> a pointer to the message that just got logged. This string is allocated, and should be freed with <b class="fname">free</b>(). The <i class="farg">format</i> is a standard <b class="fname">printf</b>() style format string (but see the BUGS section).<p>
If you want better control of where things gets logged, you can instead of using <b class="fname">krb5_openlog</b>() call <b class="fname">krb5_initlog</b>(), which just initializes a facility, but doesn't define any actual logging destinations. You can then add destinations with the <b class="fname">krb5_addlog_dest</b>() and <b class="fname">krb5_addlog_func</b>() functions.  The first of these takes a string specifying a logging destination, and adds this to the facility. If you want to do some non-standard logging you can use the <b class="fname">krb5_addlog_func</b>() function, which takes a function to use when logging. The <i class="farg">log</i> function is called for each message with <i class="farg">time</i> being a string specifying the current time, and <i class="farg">message</i> the message to log. <i class="farg">close</i> is called when the facility is closed. You can pass application specific data in the <i class="farg">data</i> parameter. The <i class="farg">min</i> and <i class="farg">max</i> parameter are the same as in a destination (defined below). To specify a max of infinity, pass -1.<p>
<b class="fname">krb5_openlog</b>() calls <b class="fname">krb5_initlog</b>() and then calls <b class="fname">krb5_addlog_dest</b>() for each destination found.<div class="subsection">
<h2 id="x44657374696e6174696f6e73">Destinations</h2> The defined destinations (as specified in <i class="file">krb5.conf</i>) follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">STDERR</code></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
This logs to the program's stderr.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">FILE:</code><i class="file">/file</i></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">FILE=</code><i class="file">/file</i></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Log to the specified file. The form using a colon appends to the file, the form with an equal truncates the file. The truncating form keeps the file open, while the appending form closes it after each log message (which makes it possible to rotate logs). The truncating form is mainly for compatibility with the MIT libkrb5.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">DEVICE=</code><i class="file">/device</i></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
This logs to the specified device, at present this is the same as <code class="lit">FILE:/device</code>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">CONSOLE</code></dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Log to the console, this is the same as <code class="lit">DEVICE=/dev/console</code>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">SYSLOG</code>&#91;<span class="opt">:priority&#91;<span class="opt">:facility</span>&#93;</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 3.00ex;">
Send messages to the syslog system, using priority, and facility. To get the name for one of these, you take the name of the macro passed to <a class="link-man" href="../3/syslog">syslog(3)</a>, and remove the leading <code class="lit">LOG_</code> (<code class="lit">LOG_NOTICE</code> becomes <code class="lit">NOTICE</code>). The default values (as well as the values used for unrecognised values), are <code class="lit">ERR</code>, and <code class="lit">AUTH</code>, respectively.  See <a class="link-man" href="../3/syslog">syslog(3)</a> for a list of priorities and facilities.</dd>
</dl>
<p>
Each destination may optionally be prepended with a range of logging levels, specified as <code class="lit">min-max/</code>. If the <i class="farg">level</i> parameter to <b class="fname">krb5_log</b>() is within this range (inclusive) the message gets logged to this destination, otherwise not. Either of the min and max valued may be omitted, in this case min is assumed to be zero, and max is assumed to be infinity.  If you don't include a dash, both min and max gets set to the specified value. If no range is specified, all messages gets logged.</div>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1><pre style="margin-left: 5.00ex;" class="lit display">
[logging] 
	kdc = 0/FILE:/var/log/kdc.log 
	kdc = 1-/SYSLOG:INFO:USER 
	default = STDERR</pre>
<p>
This will log all messages from the <b class="name">kdc</b> program with level 0 to <i class="file">/var/log/kdc.log</i>, other messages will be logged to syslog with priority <code class="lit">LOG_INFO</code>, and facility <code class="lit">LOG_USER</code>. All other programs will log all messages to their stderr.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/syslog">syslog(3)</a>, <a class="link-man" href="../5/krb5.conf">krb5.conf(5)</a></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> These functions use <b class="fname">asprintf</b>() to format the message. If your operating system does not have a working <b class="fname">asprintf</b>(), a replacement will be used. At present this replacement does not handle some correct conversion specifications (like floating point numbers). Until this is fixed, the use of these conversions should be avoided.<p>
If logging is done to the syslog facility, these functions might not be thread-safe, depending on the implementation of <b class="fname">openlog</b>(), and <b class="fname">syslog</b>().</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
August 6, 1997</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

