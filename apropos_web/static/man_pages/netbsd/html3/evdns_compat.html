<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
evdns_compat(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
evdns_compat(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
evdns_compat(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> evdns_compat &#45;<p>
Potentially non-threadsafe versions of the functions in <b>dns.h</b>: provided only for backwards compatibility.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>SYNOPSIS</h1> #include &lt;event2/dns_compat.h&gt;<div style="height: 0.00em;">
&#160;</div>
#include &lt;event2/event-config.h&gt;<div style="height: 0.00em;">
&#160;</div>
#include &lt;event2/util.h&gt;<div style="height: 0.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
<div class="subsection">
<h2>Functions</h2><br>
struct evdns_server_port * <b>evdns_add_server_port</b> (<b>evutil_socket_t</b> socket, int flags, <b>evdns_request_callback_fn_type</b> callback, void *user_data)<div style="height: 0.00em;">
&#160;</div>
<i>As evdns_server_new_with_base. </i> int  <b>evdns_clear_nameservers_and_suspend</b> (void)<div style="height: 0.00em;">
&#160;</div>
<i>Remove all configured nameservers, and suspend all pending resolves. </i> int  <b>evdns_count_nameservers</b> (void)<div style="height: 0.00em;">
&#160;</div>
<i>Get the number of configured nameservers. </i> struct evdns_base *  <b>evdns_get_global_base</b> (void)<div style="height: 0.00em;">
&#160;</div>
<i>Return the global evdns_base created by </i><b>event_init()</b><i> and used by the other deprecated functions. </i><b></b> int  <b>evdns_init</b> (void)<div style="height: 0.00em;">
&#160;</div>
<i>Initialize the asynchronous DNS library. </i> int  <b>evdns_nameserver_add</b> (unsigned long int address)<div style="height: 0.00em;">
&#160;</div>
<i>Add a nameserver. </i> int  <b>evdns_nameserver_ip_add</b> (const char *ip_as_string)<div style="height: 0.00em;">
&#160;</div>
<i>Add a nameserver. </i> int  <b>evdns_resolv_conf_parse</b> (int flags, const char *const filename)<div style="height: 0.00em;">
&#160;</div>
<i>Parse a resolv.conf file. </i> int  <b>evdns_resolve_ipv4</b> (const char *name, int flags, <b>evdns_callback_type</b> callback, void *ptr)<div style="height: 0.00em;">
&#160;</div>
<i>Lookup an A record for a given name. </i> int  <b>evdns_resolve_ipv6</b> (const char *name, int flags, <b>evdns_callback_type</b> callback, void *ptr)<div style="height: 0.00em;">
&#160;</div>
<i>Lookup an AAAA record for a given name. </i> int  <b>evdns_resolve_reverse</b> (const struct in_addr *in, int flags, <b>evdns_callback_type</b> callback, void *ptr)<div style="height: 0.00em;">
&#160;</div>
<i>Lookup a PTR record for a given IP address. </i> int  <b>evdns_resolve_reverse_ipv6</b> (const struct in6_addr *in, int flags, <b>evdns_callback_type</b> callback, void *ptr)<div style="height: 0.00em;">
&#160;</div>
<i>Lookup a PTR record for a given IPv6 address. </i> int  <b>evdns_resume</b> (void)<div style="height: 0.00em;">
&#160;</div>
<i>Resume normal operation and continue any suspended resolve requests. </i> void  <b>evdns_search_add</b> (const char *domain)<div style="height: 0.00em;">
&#160;</div>
<i>Add a domain to the list of search domains. </i> void  <b>evdns_search_clear</b> (void)<div style="height: 0.00em;">
&#160;</div>
<i>Clear the list of search domains. </i> void  <b>evdns_search_ndots_set</b> (const int ndots)<div style="height: 0.00em;">
&#160;</div>
<i>Set the 'ndots' parameter for searches. </i> int  <b>evdns_set_option</b> (const char *option, const char *val, int flags)<div style="height: 0.00em;">
&#160;</div>
<i>Set the value of a configuration option. </i> void  <b>evdns_shutdown</b> (int fail_requests)<div style="height: 0.00em;">
&#160;</div>
<i>Shut down the asynchronous DNS resolver and terminate all active requests. </i><br>
</div>
</div>
<div class="section">
<h1>Detailed Description</h1> Potentially non-threadsafe versions of the functions in  <b>dns.h</b>: provided only for backwards compatibility.<div style="height: 1.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>Function Documentation</h1><div class="subsection">
<h2>struct evdns_server_port* evdns_add_server_port (<b>evutil_socket_t</b>socket, intflags, <b>evdns_request_callback_fn_type</b>callback, void *user_data)</h2> As evdns_server_new_with_base.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which even_base it uses. The recommended function is <b>evdns_add_server_port_with_base()</b>.</div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>int evdns_clear_nameservers_and_suspend (void)</h2> Remove all configured nameservers, and suspend all pending resolves. Resolves will not necessarily be re-attempted until  <b>evdns_resume()</b> is called.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_clear_nameservers_and_suspend()</b>.</div>
<p>
<b>Returns:</b><div style="margin-left: 4.00ex;">
0 if successful, or -1 if an error occurred</div>
<p>
<b>See also:</b><div style="margin-left: 4.00ex;">
<b>evdns_resume()</b></div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>int evdns_count_nameservers (void)</h2> Get the number of configured nameservers. This returns the number of configured nameservers (not necessarily the number of running nameservers). This is useful for double-checking whether our calls to the various nameserver configuration functions have been successful.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_count_nameservers()</b>.</div>
<p>
<b>Returns:</b><div style="margin-left: 4.00ex;">
the number of configured nameservers</div>
<p>
<b>See also:</b><div style="margin-left: 4.00ex;">
<b>evdns_nameserver_add()</b></div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>struct evdns_base* evdns_get_global_base (void)</h2> Return the global evdns_base created by  <b>event_init()</b> and used by the other deprecated functions.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because use of the global evdns_base is error-prone.</div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>int evdns_init (void)</h2> Initialize the asynchronous DNS library. This function initializes support for non-blocking name resolution by calling  <b>evdns_resolv_conf_parse()</b> on UNIX and evdns_config_windows_nameservers() on Windows.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it always uses the current event base, and is easily confused by multiple calls to <b>event_init()</b>, and so is not safe for multithreaded use. Additionally, it allocates a global structure that only one thread can use. The replacement is <b>evdns_base_new()</b>.</div>
<p>
<b>Returns:</b><div style="margin-left: 4.00ex;">
0 if successful, or -1 if an error occurred</div>
<p>
<b>See also:</b><div style="margin-left: 4.00ex;">
<b>evdns_shutdown()</b></div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>int evdns_nameserver_add (unsigned long intaddress)</h2> Add a nameserver. The address should be an IPv4 address in network byte order. The type of address is chosen so that it matches in_addr.s_addr.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_nameserver_add()</b>.</div>
<p>
<b>Parameters:</b><div style="margin-left: 4.00ex;">
<i>address</i> an IP address in network byte order</div>
<p>
<b>Returns:</b><div style="margin-left: 4.00ex;">
0 if successful, or -1 if an error occurred</div>
<p>
<b>See also:</b><div style="margin-left: 4.00ex;">
<b>evdns_nameserver_ip_add()</b></div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>int evdns_nameserver_ip_add (const char *ip_as_string)</h2> Add a nameserver. This wraps the  <b>evdns_nameserver_add()</b> function by parsing a string as an IP address and adds it as a nameserver.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_nameserver_ip_add()</b>.</div>
<p>
<b>Returns:</b><div style="margin-left: 4.00ex;">
0 if successful, or -1 if an error occurred</div>
<p>
<b>See also:</b><div style="margin-left: 4.00ex;">
<b>evdns_nameserver_add()</b></div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>int evdns_resolv_conf_parse (intflags, const char *constfilename)</h2> Parse a resolv.conf file. The 'flags' parameter determines what information is parsed from the resolv.conf file. See the man page for resolv.conf for the format of this file.<p>
The following directives are not parsed from the file: sortlist, rotate, no-check-names, inet6, debug.<p>
If this function encounters an error, the possible return values are: 1 = failed to open file, 2 = failed to stat file, 3 = file too large, 4 = out of memory, 5 = short read from file, 6 = no nameservers listed in the file<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_resolv_conf_parse()</b>.</div>
<p>
<b>Parameters:</b><div style="margin-left: 4.00ex;">
<i>flags</i> any of DNS_OPTION_NAMESERVERS|DNS_OPTION_SEARCH|DNS_OPTION_MISC| DNS_OPTIONS_ALL<div style="height: 0.00em;">
&#160;</div>
<i>filename</i> the path to the resolv.conf file</div>
<p>
<b>Returns:</b><div style="margin-left: 4.00ex;">
0 if successful, or various positive error codes if an error occurred (see above)</div>
<p>
<b>See also:</b><div style="margin-left: 4.00ex;">
resolv.conf(3), evdns_config_windows_nameservers()</div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>int evdns_resolve_ipv4 (const char *name, intflags, <b>evdns_callback_type</b>callback, void *ptr)</h2> Lookup an A record for a given name.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_resolve_ipv4()</b>.</div>
<p>
<b>Parameters:</b><div style="margin-left: 4.00ex;">
<i>name</i> a DNS hostname<div style="height: 0.00em;">
&#160;</div>
<i>flags</i> either 0, or DNS_QUERY_NO_SEARCH to disable searching for this query.<div style="height: 0.00em;">
&#160;</div>
<i>callback</i> a callback function to invoke when the request is completed<div style="height: 0.00em;">
&#160;</div>
<i>ptr</i> an argument to pass to the callback function</div>
<p>
<b>Returns:</b><div style="margin-left: 4.00ex;">
0 if successful, or -1 if an error occurred</div>
<p>
<b>See also:</b><div style="margin-left: 4.00ex;">
<b>evdns_resolve_ipv6()</b>, <b>evdns_resolve_reverse()</b>, <b>evdns_resolve_reverse_ipv6()</b></div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>int evdns_resolve_ipv6 (const char *name, intflags, <b>evdns_callback_type</b>callback, void *ptr)</h2> Lookup an AAAA record for a given name.<p>
<b>Parameters:</b><div style="margin-left: 4.00ex;">
<i>name</i> a DNS hostname<div style="height: 0.00em;">
&#160;</div>
<i>flags</i> either 0, or DNS_QUERY_NO_SEARCH to disable searching for this query.<div style="height: 0.00em;">
&#160;</div>
<i>callback</i> a callback function to invoke when the request is completed<div style="height: 0.00em;">
&#160;</div>
<i>ptr</i> an argument to pass to the callback function</div>
<p>
<b>Returns:</b><div style="margin-left: 4.00ex;">
0 if successful, or -1 if an error occurred</div>
<p>
<b>See also:</b><div style="margin-left: 4.00ex;">
<b>evdns_resolve_ipv4()</b>, <b>evdns_resolve_reverse()</b>, <b>evdns_resolve_reverse_ipv6()</b></div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>int evdns_resolve_reverse (const struct in_addr *in, intflags, <b>evdns_callback_type</b>callback, void *ptr)</h2> Lookup a PTR record for a given IP address.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_resolve_reverse()</b>.</div>
<p>
<b>Parameters:</b><div style="margin-left: 4.00ex;">
<i>in</i> an IPv4 address<div style="height: 0.00em;">
&#160;</div>
<i>flags</i> either 0, or DNS_QUERY_NO_SEARCH to disable searching for this query.<div style="height: 0.00em;">
&#160;</div>
<i>callback</i> a callback function to invoke when the request is completed<div style="height: 0.00em;">
&#160;</div>
<i>ptr</i> an argument to pass to the callback function</div>
<p>
<b>Returns:</b><div style="margin-left: 4.00ex;">
0 if successful, or -1 if an error occurred</div>
<p>
<b>See also:</b><div style="margin-left: 4.00ex;">
<b>evdns_resolve_reverse_ipv6()</b></div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>int evdns_resolve_reverse_ipv6 (const struct in6_addr *in, intflags, <b>evdns_callback_type</b>callback, void *ptr)</h2> Lookup a PTR record for a given IPv6 address.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_resolve_reverse_ipv6()</b>.</div>
<p>
<b>Parameters:</b><div style="margin-left: 4.00ex;">
<i>in</i> an IPv6 address<div style="height: 0.00em;">
&#160;</div>
<i>flags</i> either 0, or DNS_QUERY_NO_SEARCH to disable searching for this query.<div style="height: 0.00em;">
&#160;</div>
<i>callback</i> a callback function to invoke when the request is completed<div style="height: 0.00em;">
&#160;</div>
<i>ptr</i> an argument to pass to the callback function</div>
<p>
<b>Returns:</b><div style="margin-left: 4.00ex;">
0 if successful, or -1 if an error occurred</div>
<p>
<b>See also:</b><div style="margin-left: 4.00ex;">
<b>evdns_resolve_reverse_ipv6()</b></div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>int evdns_resume (void)</h2> Resume normal operation and continue any suspended resolve requests. Re-attempt resolves left in limbo after an earlier call to  <b>evdns_clear_nameservers_and_suspend()</b>.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_resume()</b>.</div>
<p>
<b>Returns:</b><div style="margin-left: 4.00ex;">
0 if successful, or -1 if an error occurred</div>
<p>
<b>See also:</b><div style="margin-left: 4.00ex;">
<b>evdns_clear_nameservers_and_suspend()</b></div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>void evdns_search_add (const char *domain)</h2> Add a domain to the list of search domains.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_search_add()</b>.</div>
<p>
<b>Parameters:</b><div style="margin-left: 4.00ex;">
<i>domain</i> the domain to be added to the search list</div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>void evdns_search_clear (void)</h2> Clear the list of search domains.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_search_clear()</b>.</div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>void evdns_search_ndots_set (const intndots)</h2> Set the 'ndots' parameter for searches. Sets the number of dots which, when found in a name, causes the first query to be without any search domain.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_search_ndots_set()</b>.</div>
<p>
<b>Parameters:</b><div style="margin-left: 4.00ex;">
<i>ndots</i> the new ndots parameter</div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>int evdns_set_option (const char *option, const char *val, intflags)</h2> Set the value of a configuration option. The currently available configuration options are:<p>
ndots, timeout, max-timeouts, max-inflight, and attempts<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is <b>evdns_base_set_option()</b>.</div>
<p>
<b>Parameters:</b><div style="margin-left: 4.00ex;">
<i>option</i> the name of the configuration option to be modified<div style="height: 0.00em;">
&#160;</div>
<i>val</i> the value to be set<div style="height: 0.00em;">
&#160;</div>
<i>flags</i> Ignored.</div>
<p>
<b>Returns:</b><div style="margin-left: 4.00ex;">
0 if successful, or -1 if an error occurred</div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="subsection">
<h2>void evdns_shutdown (intfail_requests)</h2> Shut down the asynchronous DNS resolver and terminate all active requests. If the 'fail_requests' option is enabled, all active requests will return an empty result with the error flag set to DNS_ERR_SHUTDOWN. Otherwise, the requests will be silently discarded.<p>
<b>Deprecated</b><div style="margin-left: 4.00ex;">
This function is deprecated because it does not allow the caller to specify which evdns_base it applies to. The recommended function is evdns_base_shutdown().</div>
<p>
<b>Parameters:</b><div style="margin-left: 4.00ex;">
<i>fail_requests</i> if zero, active requests will be aborted; if non-zero, active requests will return DNS_ERR_SHUTDOWN.</div>
<p>
<b>See also:</b><div style="margin-left: 4.00ex;">
<b>evdns_init()</b></div>
<p>
<div style="height: 1.00em;">
&#160;</div>
</div>
</div>
<div class="section">
<h1>Author</h1> Generated automatically by Doxygen for libevent from the source code.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
Tue Jan 27 2015</td>
<td class="foot-os" align="right">
libevent</td>
</tr>
</table>
</div>
</body>
</html>

