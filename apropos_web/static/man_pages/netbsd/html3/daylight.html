<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
TZSET(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
TZSET(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
TZSET(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">tzset</b>, <b class="name">tzalloc</b>, <b class="name">tzgetname</b>, <b class="name">tzfree</b> &#8212; <span class="desc">initialize time conversion information</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">time.h</a>&gt;</b><p>
<i class="ftype">timezone_t</i><br>
<b class="fname">tzalloc</b>(<i class="farg" style="white-space:nowrap;">const char *zone</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">tzfree</b>(<i class="farg" style="white-space:nowrap;">timezone_t restrict tz</i>);<p>
<i class="ftype">const char *</i><br>
<b class="fname">tzgetname</b>(<i class="farg" style="white-space:nowrap;">timezone_t restrict tz</i>, <i class="farg" style="white-space:nowrap;">int isdst</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">tzset</b>(<i class="farg" style="white-space:nowrap;">void</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">tzalloc</b>() function takes as an argument a timezone name and returns a <i class="ftype">timezone_t</i> object suitable to be used in the <b class="fname">ctime_rz</b>(), <b class="fname">localtime_rz</b>(), and <b class="fname">mktime_z</b>() functions.<p>
If <i class="arg">tz</i> is not a valid time zone description, or if the object cannot be allocated, <b class="fname">tzalloc</b>() returns a <span class="define">NULL</span> pointer and sets <b class="var">errno</b>.<p>
A <span class="define">NULL</span> pointer may be passed to <b class="fname">tzalloc</b>() instead of a timezone name, to refer to the current system timezone. An empty timezone string indicates Coordinated Universal Time (UTC).<p>
Note that instead of setting the environment variable <b class="var">TZ</b>, and globally changing the behavior of the calling program, one can use multiple timezones at the same time by using separate <i class="ftype">timezone_t</i> objects allocated by <b class="fname">tzalloc</b>() and calling the &#8220;z&#8221; variants of the functions. The <b class="fname">tzfree</b>() function deallocates <i class="farg">tz</i>, which was previously allocated by <b class="fname">tzalloc</b>(). This invalidates any <i class="ftype">tm_zone</i> pointers that <i class="farg">tz</i> was used to set. Finally, <b class="fname">tzgetname</b>() returns the name for the given <i class="farg">tz</i>. If <i class="farg">isdst</i> is <b class="var">0</b>, the call is equivalent to <b class="var">tzname[0]</b>. If <i class="farg">isdst</i> is set to <b class="var">1</b> the call is equivalent to <b class="var">tzname[1]</b>. The <b class="fname">tzset</b>() function acts like <span class="define">tzalloc(getenv("TZ"))</span>, except it saves any resulting time zone object into internal storage that is accessed by <b class="fname">localtime</b>(), <b class="fname">localtime_r</b>(), and <b class="fname">mktime</b>(). The anonymous shared time zone object is freed by the next call to <b class="fname">tzset</b>(). If the implied call to <b class="fname">tzalloc</b>() fails, <b class="fname">tzset</b>() falls back on UTC. If <span class="env">TZ</span> is <span class="define">NULL</span>, the best available approximation to local wall clock time, as specified by the <a class="link-man" href="../5/tzfile">tzfile(5)</a> format file <i class="file">/etc/localtime</i> is used by <a class="link-man" href="../3/localtime">localtime(3)</a>. If <span class="env">TZ</span> appears in the environment but its value is the empty string, Universal Time (UT) is used, with the abbreviation &#8220;UTC&#8221; and without leap second correction; please see <a class="link-man" href="../3/ctime">ctime(3)</a>. If <span class="env">TZ</span> is nonnull and nonempty:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-dash">
<li class="list-dash" style="margin-top: 1.00em;">
if the value begins with a colon, it is used as a pathname of a file from which to read the time conversion information;</li>
<li class="list-dash" style="margin-top: 1.00em;">
if the value does not begin with a colon, it is first used as the pathname of a file from which to read the time conversion information, and, if that file cannot be read, is used directly as a specification of the time conversion information.</li>
</ul>
<p>
When <span class="env">TZ</span> is used as a pathname, if it begins with a slash, it is used as an absolute pathname; otherwise, it is used as a pathname relative to <i class="file">/usr/share/zoneinfo</i>. The file must be in the format specified in <a class="link-man" href="../5/tzfile">tzfile(5)</a>.<p>
When <span class="env">TZ</span> is used directly as a specification of the time conversion information, it must have the following syntax (spaces inserted for clarity):<p>
<pre style="margin-left: 5.00ex;" class="lit display">
<b class="flag">std</b><b class="flag">offset</b>&#91;<span class="opt"><b class="flag">dst</b>&#91;<span class="opt"><b class="flag">offset</b></span>&#93;&#91;<span class="opt">,<b class="flag">rule</b></span>&#93;</span>&#93;</pre>
<p>
where:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">std</b> and <b class="flag">dst</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Three or more bytes that are the designation for the standard (<b class="flag">std</b>) or summer (<b class="flag">dst</b>) time zone. Only <b class="flag">std</b> is required; if <b class="flag">dst</b> is missing, then summer time does not apply in this locale. Upper- and lowercase letters are explicitly allowed. Any characters except a leading colon (:), digits, comma (,), minus (-), plus (+), and NUL bytes are allowed.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">offset</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Indicates the value one must add to the local time to arrive at Coordinated Universal Time. The <b class="flag">offset</b> has the form:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
<b class="flag">hh</b>&#91;<span class="opt"><b class="flag">:mm</b>&#91;<span class="opt"><b class="flag">:ss</b></span>&#93;</span>&#93;</pre>
<p>
The minutes (<b class="flag">mm</b>) and seconds (<b class="flag">ss</b>) are optional. The hour (<b class="flag">hh</b>) is required and may be a single digit. The <b class="flag">offset</b> following <b class="flag">std</b> is required. If no <b class="flag">offset</b> follows <b class="flag">dst</b>, summer time is assumed to be one hour ahead of standard time. One or more digits may be used; the value is always interpreted as a decimal number. The hour must be between zero and 24, and the minutes (and seconds)  if present  between zero and 59. If preceded by a &#8220;-&#8221; the time zone shall be east of the Prime Meridian; otherwise it shall be west (which may be indicated by an optional preceding &#8220;+&#8221;).</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">rule</b></dt>
<dd class="list-tag" style="margin-left: 11.00ex;">
Indicates when to change to and back from summer time. The <b class="flag">rule</b> has the form:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
<b class="flag">date</b>/<b class="flag">time</b>,<b class="flag">date</b>/<b class="flag">time</b></pre>
<p>
where the first <b class="flag">date</b> describes when the change from standard to summer time occurs and the second <b class="flag">date</b> describes when the change back happens. Each <b class="flag">time</b> field describes when, in current local time, the change to the other time is made. As an extension to POSIX, daylight saving is assumed to be in effect all year if it begins January 1 at 00:00 and ends December 31 at 24:00 plus the difference between daylight saving and standard time, leaving no room for standard time in the calendar. The format of <i class="farg">date</i> is one of the following:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">J</b><i class="arg">n</i></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The Julian day <i class="arg">n</i> (1 &#8804; <i class="arg">n</i> &#8804; 365). Leap days are not counted; that is, in all years  including leap years  February 28 is day 59 and March 1 is day 60. It is impossible to explicitly refer to the occasional February 29.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">n</i></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
The zero-based Julian day (0&#160;&#8804; <i class="arg">n</i> &#8804;&#160;365). Leap days are counted, and it is possible to refer to February 29.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="flag">M</b><i class="arg">m</i>.<i class="arg">n</i>.<i class="arg">d</i></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
 The <i class="arg">d</i>'th day (0 &#8804; <i class="arg">d</i> &#8804;&#160;6) of week <i class="arg">n</i> of month <i class="arg">m</i> of the year (1 &#8804; <i class="arg">n</i> &#8804;&#160;5, 1 &#8804; <i class="arg">m</i> &#8804;&#160;12, where week 5 means &#8220;the&#160;last <i class="arg">d</i> day&#160;in&#160;month <i class="arg">m</i>&#8221; which may occur in either the fourth or the fifth week). Week 1 is the first week in which the <i class="arg">d</i>'th day occurs. Day zero is Sunday.</dd>
</dl>
The <b class="flag">time</b> has the same format as <b class="flag">offset</b> except that POSIX does not allow a leading sign &#8220;-&#8221; or &#8220;+&#8221; is allowed. As an extension to POSIX, the hours part of <b class="flag">time</b> can range from &#45;167 through 167; this allows for unusual rules such as &#8220;the Saturday before the first Sunday of March&#8221;. The default, if <b class="flag">time</b> is not given, is <b class="flag">02:00:00</b>.</dd>
</dl>
<p>
Here are some examples of <b class="var">TZ</b> values that directly specify the time zone rules; they use some of the extensions to POSIX.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
EST5</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
stands for US Eastern Standard Time (EST), 5 hours behind UTC, without daylight saving.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
FJT&#45;12FJST,M11.1.0,M1.3.4/75</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
stands for Fiji Time (FJT) and Fiji Summer Time (FJST), 12 hours ahead of UTC, springing forward on November's first Sunday at 02:00, and falling back on January's third Thursday at 75:00 (i.e., 03:00 on the first Sunday on or after January 18).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
IST&#45;2IDT,M3.4.4/26,M10.5.0</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
stands for Israel Standard Time (IST) and Israel Daylight Time (IDT), 2 hours ahead of UTC, springing forward on March's fourth Thursday at 26:00 (i.e., 02:00 on the first Friday on or after March 23), and falling back on October's last Sunday at 02:00.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
WART4WARST,J1/0,J365/25</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
stands for Western Argentina Summer Time (WARST), 3 hours behind UTC. There is a dummy fall-back transition on December 31 at 25:00 daylight saving time (i.e., 24:00 standard time, equivalent to January 1 at 00:00 standard time), and a simultaneous spring-forward transition on January 1 at 00:00 standard time, so daylight saving time is in effect all year and the initial <span class="emph">WART</span> is a placeholder.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
WGT3WGST,M3.5.0/&#45;2,M10.5.0/&#45;1</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
stands for Western Greenland Time (WGT) and Western Greenland Summer Time (WGST), 3 hours behind UTC, where clocks follow the EU rules of springing forward on March's last Sunday at 01:00 UTC (&#45;02:00 local time) and falling back on October's last Sunday at 01:00 UTC (&#45;01:00 local time).</dd>
</dl>
<p>
If no <b class="flag">rule</b> is present in <span class="env">TZ</span>, the rules specified by the <a class="link-man" href="../5/tzfile">tzfile(5)</a> format file <i class="file">posixrules</i> in <i class="file">/usr/share/zoneinfo</i> are used, with the standard and summer time offsets from UTC replaced by those specified by the <b class="flag">offset</b> values in <span class="env">TZ</span>.<p>
For compatibility with System V Release 3.1, a semicolon (;) may be used to separate the <b class="flag">rule</b> from the rest of the specification.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/localtime</i></dt>
<dd class="list-tag" style="margin-left: 30.00ex;">
local time zone file</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/usr/share/zoneinfo</i></dt>
<dd class="list-tag" style="margin-left: 30.00ex;">
time zone information directory</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/usr/share/zoneinfo/posixrules</i></dt>
<dd class="list-tag" style="margin-left: 30.00ex;">
used with POSIX-style TZ's</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/usr/share/zoneinfo/GMT</i></dt>
<dd class="list-tag" style="margin-left: 30.00ex;">
for UTC leap seconds</dd>
</dl>
<p>
If <i class="file">/usr/share/zoneinfo/GMT</i> is absent, UTC leap seconds are loaded from <i class="file">/usr/share/zoneinfo/posixrules</i>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/ctime">ctime(3)</a>, <a class="link-man" href="../3/getenv">getenv(3)</a>, <a class="link-man" href="../3/strftime">strftime(3)</a>, <a class="link-man" href="../3/time">time(3)</a>, <a class="link-man" href="../5/tzfile">tzfile(5)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">tzset</b>() function conforms to IEEE Std 1003.1-1988 (&#8220;POSIX.1&#8221;).</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
October 23, 2014</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

