<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
POSIX_SPAWN_FILE_ACTIONS_ADDOPEN(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
POSIX_SPAWN_FILE_ACTIONS_ADDOPEN(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
POSIX_SPAWN_FILE_ACTIONS_ADDOPEN(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">posix_spawn_file_actions_addopen</b>, <b class="name">posix_spawn_file_actions_adddup2</b>, <b class="name">posix_spawn_file_actions_addclose</b> &#8212; <span class="desc">add open, dup2 or close action to spawn file actions object</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">spawn.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">posix_spawn_file_actions_addopen</b>(<i class="farg" style="white-space:nowrap;">posix_spawn_file_actions_t * file_actions</i>, <i class="farg" style="white-space:nowrap;">int fildes</i>, <i class="farg" style="white-space:nowrap;">const char *restrict path</i>, <i class="farg" style="white-space:nowrap;">int oflag</i>, <i class="farg" style="white-space:nowrap;">mode_t mode</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">posix_spawn_file_actions_adddup2</b>(<i class="farg" style="white-space:nowrap;">posix_spawn_file_actions_t * file_actions</i>, <i class="farg" style="white-space:nowrap;">int fildes</i>, <i class="farg" style="white-space:nowrap;">int newfildes</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">posix_spawn_file_actions_addclose</b>(<i class="farg" style="white-space:nowrap;">posix_spawn_file_actions_t * file_actions</i>, <i class="farg" style="white-space:nowrap;">int fildes</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> These functions add an open, dup2 or close action to a spawn file actions object.<p>
A spawn file actions object is of type <span class="type">posix_spawn_file_actions_t</span> (defined in <b class="includes">&lt;<a class="link-includes">spawn.h</a>&gt;</b>) and is used to specify a series of actions to be performed by a <b class="fname">posix_spawn</b>() or <b class="fname">posix_spawnp</b>() operation in order to arrive at the set of open file descriptors for the child process given the set of open file descriptors of the parent.<p>
A spawn file actions object, when passed to <b class="fname">posix_spawn</b>() or <b class="fname">posix_spawnp</b>(), specify how the set of open file descriptors in the calling process is transformed into a set of potentially open file descriptors for the spawned process. This transformation is as if the specified sequence of actions was performed exactly once, in the context of the spawned process (prior to execution of the new process image), in the order in which the actions were added to the object; additionally, when the new process image is executed, any file descriptor (from this new set) which has its <span class="define">FD_CLOEXEC</span> flag set is closed (see <b class="fname">posix_spawn</b>()).<p>
The <b class="fname">posix_spawn_file_actions_addopen</b>() function adds an open action to the object referenced by <i class="farg">file_actions</i> that causes the file named by <i class="farg">path</i> to be opened (as if<p>
<pre style="margin-left: 5.00ex;" class="lit display">
open(path, oflag, mode)</pre>
<p>
had been called, and the returned file descriptor, if not <i class="farg">fildes</i>, had been changed to <i class="farg">fildes</i>) when a new process is spawned using this file actions object. If <i class="farg">fildes</i> was already an open file descriptor, it is closed before the new file is opened.<p>
The string described by <i class="farg">path</i> is copied by the <b class="fname">posix_spawn_file_actions_addopen</b>() function.<p>
The <b class="fname">posix_spawn_file_actions_adddup2</b>() function adds a dup2 action to the object referenced by <i class="farg">file_actions</i> that causes the file descriptor <i class="farg">fildes</i> to be duplicated as <i class="farg">newfildes</i> (as if<p>
<pre style="margin-left: 5.00ex;" class="lit display">
dup2(fildes, newfildes)</pre>
<p>
had been called) when a new process is spawned using this file actions object.<p>
The <b class="fname">posix_spawn_file_actions_addclose</b>() function adds a close action to the object referenced by <i class="farg">file_actions</i> that causes the file descriptor <i class="farg">fildes</i> to be closed (as if<p>
<pre style="margin-left: 5.00ex;" class="lit display">
close(fildes)</pre>
<p>
had been called) when a new process is spawned using this file actions object.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, these functions return zero; otherwise, an error number is returned to indicate the error.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> These functions fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBADF</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The value specified by <i class="farg">fildes</i> or <i class="farg">newfildes</i> is negative.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The value specified by <i class="farg">file_actions</i> is invalid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOMEM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Insufficient memory exists to add to the spawn file actions object.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/close">close(2)</a>, <a class="link-man" href="../2/dup2">dup2(2)</a>, <a class="link-man" href="../2/open">open(2)</a>, <a class="link-man" href="../3/posix_spawn">posix_spawn(3)</a>, <a class="link-man" href="../3/posix_spawn_file_actions_destroy">posix_spawn_file_actions_destroy(3)</a>, <a class="link-man" href="../3/posix_spawn_file_actions_init">posix_spawn_file_actions_init(3)</a>, <a class="link-man" href="../3/posix_spawnp">posix_spawnp(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">posix_spawn_file_actions_addopen</b>(), <b class="fname">posix_spawn_file_actions_adddup2</b>() and <b class="fname">posix_spawn_file_actions_addclose</b>() functions conform to IEEE Std 1003.1-2001 (&#8220;POSIX.1&#8221;).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">posix_spawn_file_actions_addopen</b>(), <b class="fname">posix_spawn_file_actions_adddup2</b>() and <b class="fname">posix_spawn_file_actions_addclose</b>() functions first appeared in <span class="unix">FreeBSD&#160;8.0</span> and imported for <span class="unix">NetBSD&#160;6.0</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Ed Schouten</span> &#60;<a class="link-mail" href="mailto:ed@FreeBSD.org">ed@FreeBSD.org</a>&#62;</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
February 2, 2014</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

