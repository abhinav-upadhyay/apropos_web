<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
PTHREAD_RWLOCK(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
PTHREAD_RWLOCK(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
PTHREAD_RWLOCK(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">pthread_rwlock</b> &#8212; <span class="desc">read/write lock interface</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">POSIX Threads Library (libpthread, &#45;lpthread)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">pthread.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">pthread_rwlock_init</b>(<i class="farg" style="white-space:nowrap;">pthread_rwlock_t * restrict lock</i>, <i class="farg" style="white-space:nowrap;">const pthread_rwlockattr_t * restrict attr</i>);<p>
<span class="type">pthread_rwlock_t lock = <span class="define">PTHREAD_RWLOCK_INITIALIZER;</span></span><p>
<i class="ftype">int</i><br>
<b class="fname">pthread_rwlock_destroy</b>(<i class="farg" style="white-space:nowrap;">pthread_rwlock_t *lock</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">pthread_rwlock_rdlock</b>(<i class="farg" style="white-space:nowrap;">pthread_rwlock_t *lock</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">pthread_rwlock_timedrdlock</b>(<i class="farg" style="white-space:nowrap;">pthread_rwlock_t * restrict lock</i>, <i class="farg" style="white-space:nowrap;">const struct timespec * restrict abstime</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">pthread_rwlock_tryrdlock</b>(<i class="farg" style="white-space:nowrap;">pthread_rwlock_t *lock</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">pthread_rwlock_wrlock</b>(<i class="farg" style="white-space:nowrap;">pthread_rwlock_t *lock</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">pthread_rwlock_timedwrlock</b>(<i class="farg" style="white-space:nowrap;">pthread_rwlock_t * restrict lock</i>, <i class="farg" style="white-space:nowrap;">const struct timespec * restrict abstime</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">pthread_rwlock_trywrlock</b>(<i class="farg" style="white-space:nowrap;">pthread_rwlock_t *lock</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">pthread_rwlock_unlock</b>(<i class="farg" style="white-space:nowrap;">pthread_rwlock_t *lock</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">pthread_rwlock_init</b>() function is used to initialize a read/write lock, with attributes specified by <i class="farg">attr</i>. If <i class="farg">attr</i> is <span class="define">NULL</span>, the default read/write lock attributes are used.<p>
The results of calling <b class="fname">pthread_rwlock_init</b>() with an already initialized lock are undefined.<p>
The macro <span class="define">PTHREAD_RWLOCK_INITIALIZER</span> can be used to initialize a read/write lock when the allocation can be done statically, no error checking is required, and the default attributes are appropriate. The behavior is similar to calling <b class="fname">pthread_rwlock_init</b>() with <i class="farg">attr</i> specified as <span class="define">NULL</span>.<p>
The <b class="fname">pthread_rwlock_destroy</b>() function is used to destroy a read/write lock previously created with <b class="fname">pthread_rwlock_init</b>().<p>
The <b class="fname">pthread_rwlock_rdlock</b>() function acquires a read lock on <i class="farg">lock</i> provided that <i class="farg">lock</i> is not presently held for writing and no writer threads are presently blocked on the lock. If the read lock cannot be immediately acquired, the calling thread blocks until it can acquire the lock.<p>
The <b class="fname">pthread_rwlock_timedrdlock</b>() performs the same action, but will not wait beyond <i class="farg">abstime</i> to obtain the lock before returning.<p>
The <b class="fname">pthread_rwlock_tryrdlock</b>() function performs the same action as <b class="fname">pthread_rwlock_rdlock</b>(), but does not block if the lock cannot be immediately obtained (i.e., the lock is held for writing or there are waiting writers).<p>
A thread may hold multiple concurrent read locks. If so, <b class="fname">pthread_rwlock_unlock</b>() must be called once for each lock obtained.<p>
The results of acquiring a read lock while the calling thread holds a write lock are undefined.<p>
The <b class="fname">pthread_rwlock_wrlock</b>() function blocks until a write lock can be acquired against <i class="farg">lock</i>.<p>
The <b class="fname">pthread_rwlock_timedwrlock</b>() performs the same action, but will not wait beyond <i class="farg">abstime</i> to obtain the lock before returning.<p>
The <b class="fname">pthread_rwlock_trywrlock</b>() function performs the same action as <b class="fname">pthread_rwlock_wrlock</b>(), but does not block if the lock cannot be immediately obtained.<p>
The results are undefined if the calling thread already holds the lock at the time the call is made.<p>
The <b class="fname">pthread_rwlock_unlock</b>() function is used to release the read/write lock previously obtained by <b class="fname">pthread_rwlock_rdlock</b>(), <b class="fname">pthread_rwlock_wrlock</b>(), <b class="fname">pthread_rwlock_tryrdlock</b>(), or <b class="fname">pthread_rwlock_trywrlock</b>().</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> If successful, the <b class="fname">pthread_rwlock_init</b>() function will return zero. Otherwise an error number will be returned to indicate the error.<p>
If successful, the <b class="fname">pthread_rwlock_destroy</b>(), <b class="fname">pthread_rwlock_rdlock</b>(), <b class="fname">pthread_rwlock_timedrdlock</b>(), <b class="fname">pthread_rwlock_tryrdlock</b>(), <b class="fname">pthread_rwlock_wrlock</b>(), <b class="fname">pthread_rwlock_timedwrlock</b>(), <b class="fname">pthread_rwlock_trywrlock</b>(), and <b class="fname">pthread_rwlock_unlock</b>() will return zero. Otherwise an error number will be returned to indicate the error.<p>
The results are undefined if <i class="farg">lock</i> is not held by the calling thread.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> The <b class="fname">pthread_rwlock_init</b>() function may fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EAGAIN</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The system lacks the resources to initialize another read-write lock.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBUSY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The system has detected an attempt to re-initialize the object referenced by <i class="farg">lock</i>, a previously initialized but not yet destroyed read/write lock.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The value specified by <i class="farg">attr</i> is invalid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOMEM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Insufficient memory exists to initialize the read-write lock.</dd>
</dl>
<p>
The <b class="fname">pthread_rwlock_destroy</b>() function may fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBUSY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The system has detected an attempt to destroy the object referenced by <i class="farg">lock</i> while it is locked.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The value specified by <i class="farg">lock</i> is invalid.</dd>
</dl>
<p>
The <b class="fname">pthread_rwlock_tryrdlock</b>() function shall fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBUSY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The lock could not be acquired because a writer holds the lock or was blocked on it.</dd>
</dl>
<p>
The <b class="fname">pthread_rwlock_timedrdlock</b>() function shall fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ETIMEDOUT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The time specified by <i class="farg">abstime</i> was reached before the lock could be obtained.</dd>
</dl>
<p>
The <b class="fname">pthread_rwlock_rdlock</b>(), <b class="fname">pthread_rwlock_timedrdlock</b>(), and <b class="fname">pthread_rwlock_tryrdlock</b>() functions may fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EAGAIN</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The lock could not be acquired because the maximum number of read locks against <i class="farg">lock</i> has been exceeded.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EDEADLK</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The current thread already owns <i class="farg">lock</i> for writing.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The value specified by <i class="farg">lock</i> is invalid.</dd>
</dl>
<p>
The <b class="fname">pthread_rwlock_trywrlock</b>() function shall fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBUSY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The calling thread is not able to acquire the lock without blocking.</dd>
</dl>
<p>
The <b class="fname">pthread_rwlock_timedrdlock</b>() function shall fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ETIMEDOUT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The time specified by <i class="farg">abstime</i> was reached before the lock could be obtained.</dd>
</dl>
<p>
The <b class="fname">pthread_rwlock_wrlock</b>(), <b class="fname">pthread_rwlock_timedwrlock</b>(), and <b class="fname">pthread_rwlock_trywrlock</b>() functions may fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EDEADLK</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The calling thread already owns the read/write lock (for reading or writing).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The value specified by <i class="farg">lock</i> is invalid.</dd>
</dl>
<p>
The <b class="fname">pthread_rwlock_unlock</b>() function may fail if:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The value specified by <i class="farg">lock</i> is invalid.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EPERM</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The current thread does not own the read/write lock.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/pthread">pthread(3)</a>, <a class="link-man" href="../3/pthread_barrier">pthread_barrier(3)</a>, <a class="link-man" href="../3/pthread_cond">pthread_cond(3)</a>, <a class="link-man" href="../3/pthread_mutex">pthread_mutex(3)</a>, <a class="link-man" href="../3/pthread_rwlockattr">pthread_rwlockattr(3)</a>, <a class="link-man" href="../3/pthread_spin">pthread_spin(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> These functions conform to IEEE Std 1003.1-2001 (&#8220;POSIX.1&#8221;).</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The <span class="define">PTHREAD_PROCESS_SHARED</span> attribute is not supported.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
July 8, 2010</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

