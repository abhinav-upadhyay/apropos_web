<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
RPC_CLNT_CREATE(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
RPC_CLNT_CREATE(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
RPC_CLNT_CREATE(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">rpc_clnt_create</b>, <b class="name">clnt_control</b>, <b class="name">clnt_create</b>, <b class="name">clnt_create_vers</b>, <b class="name">clnt_destroy</b>, <b class="name">clnt_dg_create</b>, <b class="name">clnt_pcreateerror</b>, <b class="name">clnt_raw_create</b>, <b class="name">clnt_spcreateerror</b>, <b class="name">clnt_tli_create</b>, <b class="name">clnt_tp_create</b>, <b class="name">clnt_vc_create</b>, <b class="name">rpc_createerr</b> &#8212; <span class="desc">library routines for dealing with creation and manipulation of CLIENT handles</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">rpc/rpc.h</a>&gt;</b><p>
<i class="ftype">bool_t</i><br>
<b class="fname">clnt_control</b>(<i class="farg" style="white-space:nowrap;">CLIENT *clnt</i>, <i class="farg" style="white-space:nowrap;">const u_int req</i>, <i class="farg" style="white-space:nowrap;">char *info</i>);<p>
<i class="ftype">CLIENT *</i><br>
<b class="fname">clnt_create</b>(<i class="farg" style="white-space:nowrap;">const char * host</i>, <i class="farg" style="white-space:nowrap;">const rpcprog_t prognum</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t versnum</i>, <i class="farg" style="white-space:nowrap;">const char *nettype</i>);<p>
<i class="ftype">CLIENT *</i><br>
<b class="fname">clnt_create_vers</b>(<i class="farg" style="white-space:nowrap;">const char * host</i>, <i class="farg" style="white-space:nowrap;">const rpcprog_t prognum</i>, <i class="farg" style="white-space:nowrap;">rpcvers_t *vers_outp</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t vers_low</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t vers_high</i>, <i class="farg" style="white-space:nowrap;">char *nettype</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">clnt_destroy</b>(<i class="farg" style="white-space:nowrap;">CLIENT * clnt</i>);<p>
<i class="ftype">CLIENT *</i><br>
<b class="fname">clnt_dg_create</b>(<i class="farg" style="white-space:nowrap;">const int fildes</i>, <i class="farg" style="white-space:nowrap;">const struct netbuf *svcaddr</i>, <i class="farg" style="white-space:nowrap;">const rpcprog_t prognum</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t versnum</i>, <i class="farg" style="white-space:nowrap;">const u_int sendsz</i>, <i class="farg" style="white-space:nowrap;">const u_int recvsz</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">clnt_pcreateerror</b>(<i class="farg" style="white-space:nowrap;">const char *s</i>);<p>
<i class="ftype">char *</i><br>
<b class="fname">clnt_spcreateerror</b>(<i class="farg" style="white-space:nowrap;">const char *s</i>);<p>
<i class="ftype">CLIENT *</i><br>
<b class="fname">clnt_raw_create</b>(<i class="farg" style="white-space:nowrap;">const rpcprog_t prognum</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t versnum</i>);<p>
<i class="ftype">CLIENT *</i><br>
<b class="fname">clnt_tli_create</b>(<i class="farg" style="white-space:nowrap;">const int fildes</i>, <i class="farg" style="white-space:nowrap;">const struct netconfig *netconf</i>, <i class="farg" style="white-space:nowrap;">const struct netbuf *svcaddr</i>, <i class="farg" style="white-space:nowrap;">const rpcprog_t prognum</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t versnum</i>, <i class="farg" style="white-space:nowrap;">const u_int sendsz</i>, <i class="farg" style="white-space:nowrap;">const u_int recvsz</i>);<p>
<i class="ftype">CLIENT *</i><br>
<b class="fname">clnt_tp_create</b>(<i class="farg" style="white-space:nowrap;">const char * host</i>, <i class="farg" style="white-space:nowrap;">const rpcprog_t prognum</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t versnum</i>, <i class="farg" style="white-space:nowrap;">const struct netconfig *netconf</i>);<p>
<i class="ftype">CLIENT *</i><br>
<b class="fname">clnt_vc_create</b>(<i class="farg" style="white-space:nowrap;">const int fildes</i>, <i class="farg" style="white-space:nowrap;">const struct netbuf *svcaddr</i>, <i class="farg" style="white-space:nowrap;">const rpcprog_t prognum</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t versnum</i>, <i class="farg" style="white-space:nowrap;">const u_int sendsz</i>, <i class="farg" style="white-space:nowrap;">const u_int recvsz</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> RPC library routines allow C language programs to make procedure calls on other machines across the network. First a <span class="define">CLIENT</span> handle is created and then the client calls a procedure to send a request to the server. On receipt of the request, the server calls a dispatch routine to perform the requested service, and then sends a reply.</div>
<div class="section">
<h1 id="x524f5554494e4553">ROUTINES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">clnt_control</b>()</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
A function macro to change or retrieve various information about a client object. <i class="farg">req</i> indicates the type of operation, and <i class="farg">info</i> is a pointer to the information. For both connectionless and connection-oriented transports, the supported values of <i class="farg">req</i> and their argument types and what they do are:<table style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-col">
<col style="width: 15.00ex;">
<col style="width: 16.00ex;">
<col style="min-width: 17.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">CLSET_TIMEOUT</span></td>
<td class="list-col" style="margin-top: 1.00em;">
struct timeval *</td>
<td class="list-col" style="margin-top: 1.00em;">
set total timeout</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">CLGET_TIMEOUT</span></td>
<td class="list-col" style="margin-top: 1.00em;">
struct timeval *</td>
<td class="list-col" style="margin-top: 1.00em;">
get total timeout</td>
</tr>
</tbody>
</table>
<p>
Note: if you set the timeout using <b class="fname">clnt_control</b>(), the timeout argument passed by <b class="fname">clnt_call</b>() is ignored in all subsequent calls.<p>
Note: If you set the timeout value to 0 <b class="fname">clnt_control</b>() immediately returns an error (<span class="define">RPC_TIMEDOUT</span>). Set the timeout parameter to 0 for batching calls.<table style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-col">
<col style="width: 15.00ex;">
<col style="width: 16.00ex;">
<col style="min-width: 26.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">CLGET_SVC_ADDR</span></td>
<td class="list-col" style="margin-top: 1.00em;">
struct netbuf *</td>
<td class="list-col" style="margin-top: 1.00em;">
get servers address</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">CLGET_FD</span></td>
<td class="list-col" style="margin-top: 1.00em;">
int *</td>
<td class="list-col" style="margin-top: 1.00em;">
get fd from handle</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">CLSET_FD_CLOSE</span></td>
<td class="list-col" style="margin-top: 1.00em;">
void</td>
<td class="list-col" style="margin-top: 1.00em;">
close fd on destroy</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">CLSET_FD_NCLOSE</span></td>
<td class="list-col" style="margin-top: 1.00em;">
void</td>
<td class="list-col" style="margin-top: 1.00em;">
don't close fd on destroy</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">CLGET_VERS</span></td>
<td class="list-col" style="margin-top: 1.00em;">
unsigned long *</td>
<td class="list-col" style="margin-top: 1.00em;">
get RPC program version</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">CLSET_VERS</span></td>
<td class="list-col" style="margin-top: 1.00em;">
unsigned long *</td>
<td class="list-col" style="margin-top: 1.00em;">
set RPC program version</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">CLGET_XID</span></td>
<td class="list-col" style="margin-top: 1.00em;">
unsigned long *</td>
<td class="list-col" style="margin-top: 1.00em;">
get XID of previous call</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">CLSET_XID</span></td>
<td class="list-col" style="margin-top: 1.00em;">
unsigned long *</td>
<td class="list-col" style="margin-top: 1.00em;">
set XID of next call</td>
</tr>
</tbody>
</table>
<p>
The following operations are valid for connectionless transports only:<table style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-col">
<col style="width: 19.00ex;">
<col style="width: 16.00ex;">
<col style="min-width: 17.00ex;">
<tbody>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">CLSET_RETRY_TIMEOUT</span></td>
<td class="list-col" style="margin-top: 1.00em;">
struct timeval *</td>
<td class="list-col" style="margin-top: 1.00em;">
set the retry timeout</td>
</tr>
<tr class="list-col">
<td class="list-col" style="margin-top: 1.00em;">
<span class="define">CLGET_RETRY_TIMEOUT</span></td>
<td class="list-col" style="margin-top: 1.00em;">
struct timeval *</td>
<td class="list-col" style="margin-top: 1.00em;">
get the retry timeout</td>
</tr>
</tbody>
</table>
<p>
The retry timeout is the time that RPC waits for the server to reply before retransmitting the request. <b class="fname">clnt_control</b>() returns <span class="define">TRUE</span> on success and <span class="define">FALSE</span> on failure.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">clnt_create</b>()</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Generic client creation routine for program <i class="farg">prognum</i> and version <i class="farg">versnum</i>. <i class="farg">host</i> identifies the name of the remote host where the server is located. <i class="farg">nettype</i> indicates the class of transport protocol to use. The transports are tried in left to right order in <span class="env">NETPATH</span> environment variable or in top to bottom order in the netconfig database. <b class="fname">clnt_create</b>() tries all the transports of the <i class="farg">nettype</i> class available from the <span class="env">NETPATH</span> environment variable and the netconfig database, and chooses the first successful one. A default timeout is set and can be modified using <b class="fname">clnt_control</b>(). This routine returns <span class="define">NULL</span> if it fails. The <b class="fname">clnt_pcreateerror</b>() routine can be used to print the reason for failure.<p>
Note: <b class="fname">clnt_create</b>() returns a valid client handle even if the particular version number supplied to <b class="fname">clnt_create</b>() is not registered with the <a class="link-man" href="../8/rpcbind">rpcbind(8)</a> service. This mismatch will be discovered by a <b class="fname">clnt_call</b>() later (see <a class="link-man" href="../3/rpc_clnt_calls">rpc_clnt_calls(3)</a>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">clnt_create_vers</b>()</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Generic client creation routine which is similar to <b class="fname">clnt_create</b>() but which also checks for the version availability. <i class="farg">host</i> identifies the name of the remote host where the server is located. <i class="farg">nettype</i> indicates the class transport protocols to be used. If the routine is successful it returns a client handle created for the highest version between <i class="farg">vers_low</i> and <i class="farg">vers_high</i> that is supported by the server. <i class="farg">vers_outp</i> is set to this value. That is, after a successful return <i class="farg">vers_low</i> &#8804; <i class="farg">*vers_outp</i> &#8804; <i class="farg">vers_high</i>. If no version between <i class="farg">vers_low</i> and <i class="farg">vers_high</i> is supported by the server then the routine fails and returns <span class="define">NULL</span>. A default timeout is set and can be modified using <b class="fname">clnt_control</b>(). This routine returns <span class="define">NULL</span> if it fails. The <b class="fname">clnt_pcreateerror</b>() routine can be used to print the reason for failure. Note: <b class="fname">clnt_create</b>() returns a valid client handle even if the particular version number supplied to <b class="fname">clnt_create</b>() is not registered with the <a class="link-man" href="../8/rpcbind">rpcbind(8)</a> service. This mismatch will be discovered by a <b class="fname">clnt_call</b>() later (see <a class="link-man" href="../3/rpc_clnt_calls">rpc_clnt_calls(3)</a>). However, <b class="fname">clnt_create_vers</b>() does this for you and returns a valid handle only if a version within the range supplied is supported by the server.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">clnt_destroy</b>()</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
A function macro that destroys the client's RPC handle. Destruction usually involves deallocation of private data structures, including <i class="farg">clnt</i> itself. Use of <i class="farg">clnt</i> is undefined after calling <b class="fname">clnt_destroy</b>(). If the RPC library opened the associated file descriptor, or <span class="define">CLSET_FD_CLOSE</span> was set using <b class="fname">clnt_control</b>(), the file descriptor will be closed. The caller should call <b class="fname">auth_destroy</b>(<i class="farg">clnt-&gt;cl_auth</i>) (before calling <b class="fname">clnt_destroy</b>()) to destroy the associated <span class="define">AUTH</span> structure (see <a class="link-man" href="../3/rpc_clnt_auth">rpc_clnt_auth(3)</a>).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">clnt_dg_create</b>()</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
This routine creates an RPC client for the remote program <i class="farg">prognum</i> and version <i class="farg">versnum</i>; the client uses a connectionless transport. The remote program is located at address <i class="farg">svcaddr</i>. The parameter <i class="farg">fildes</i> is an open and bound file descriptor. This routine will resend the call message in intervals of 15 seconds until a response is received or until the call times out. The total time for the call to time out is specified by <b class="fname">clnt_call</b>() (see <b class="fname">clnt_call</b>() in <a class="link-man" href="../3/rpc_clnt_calls">rpc_clnt_calls(3)</a>). The retry time out and the total time out periods can be changed using <b class="fname">clnt_control</b>(). The user may set the size of the send and receive buffers with the parameters <i class="farg">sendsz</i> and <i class="farg">recvsz</i>; values of 0 choose suitable defaults. This routine returns <span class="define">NULL</span> if it fails.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">clnt_pcreateerror</b>()</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Print a message to standard error indicating why a client RPC handle could not be created. The message is prepended with the string <i class="farg">s</i> and a colon, and appended with a newline.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">clnt_spcreateerror</b>()</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Like <b class="fname">clnt_pcreateerror</b>(), except that it returns a string instead of printing to the standard error. A newline is not appended to the message in this case. Warning: returns a pointer to a buffer that is overwritten on each call.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">clnt_raw_create</b>()</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
This routine creates an RPC client handle for the remote program <i class="farg">prognum</i> and version <i class="farg">versnum</i>. The transport used to pass messages to the service is a buffer within the process's address space, so the corresponding RPC server should live in the same address space; (see <b class="fname">svc_raw_create</b>() in <a class="link-man" href="../3/rpc_svc_create">rpc_svc_create(3)</a>). This allows simulation of RPC and measurement of RPC overheads, such as round trip times, without any kernel or networking interference. This routine returns <span class="define">NULL</span> if it fails. <b class="fname">clnt_raw_create</b>() should be called after <b class="fname">svc_raw_create</b>().</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">clnt_tli_create</b>()</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
This routine creates an RPC client handle for the remote program <i class="farg">prognum</i> and version <i class="farg">versnum</i>. The remote program is located at address <i class="farg">svcaddr</i>. If <i class="farg">svcaddr</i> is <span class="define">NULL</span> and it is connection-oriented, it is assumed that the file descriptor is connected. For connectionless transports, if <i class="farg">svcaddr</i> is <span class="define">NULL</span>, <span class="define">RPC_UNKNOWNADDR</span> error is set. <i class="farg">fildes</i> is a file descriptor which may be open, bound and connected. If it is <span class="define">RPC_ANYFD</span>, it opens a file descriptor on the transport specified by <i class="farg">netconf</i>. If <i class="farg">fildes</i> is <span class="define">RPC_ANYFD</span> and <i class="farg">netconf</i> is <span class="define">NULL</span>, a <span class="define">RPC_UNKNOWNPROTO</span> error is set. If <i class="farg">fildes</i> is unbound, then it will attempt to bind the descriptor. The user may specify the size of the buffers with the parameters <i class="farg">sendsz</i> and <i class="farg">recvsz</i>; values of 0 choose suitable defaults. Depending upon the type of the transport (connection-oriented or connectionless), <b class="fname">clnt_tli_create</b>() calls appropriate client creation routines. This routine returns <span class="define">NULL</span> if it fails. The <b class="fname">clnt_pcreateerror</b>() routine can be used to print the reason for failure. The remote rpcbind service (see <a class="link-man" href="../8/rpcbind">rpcbind(8)</a>) is not consulted for the address of the remote service.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">clnt_tp_create</b>()</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
Like <b class="fname">clnt_create</b>() except <b class="fname">clnt_tp_create</b>() tries only one transport specified through <i class="farg">netconf</i>. <b class="fname">clnt_tp_create</b>() creates a client handle for the program <i class="farg">prognum</i>, the version <i class="farg">versnum</i>, and for the transport specified by <i class="farg">netconf</i>. Default options are set, which can be changed using <b class="fname">clnt_control</b>() calls. The remote rpcbind service on the host <i class="farg">host</i> is consulted for the address of the remote service. This routine returns <span class="define">NULL</span> if it fails. The <b class="fname">clnt_pcreateerror</b>() routine can be used to print the reason for failure.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">clnt_vc_create</b>()</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
This routine creates an RPC client for the remote program <i class="farg">prognum</i> and version <i class="farg">versnum</i>; the client uses a connection-oriented transport. The remote program is located at address <i class="farg">svcaddr</i>. The parameter <i class="farg">fildes</i> is an open and bound file descriptor. The user may specify the size of the send and receive buffers with the parameters <i class="farg">sendsz</i> and <i class="farg">recvsz</i>; values of 0 choose suitable defaults. This routine returns <span class="define">NULL</span> if it fails. The address <i class="farg">svcaddr</i> should not be <span class="define">NULL</span> and should point to the actual address of the remote program. <b class="fname">clnt_vc_create</b>() does not consult the remote rpcbind service for this information.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
struct rpc_createerr rpc_createerr;</dt>
<dd class="list-tag" style="margin-left: 7.00ex;">
A global variable whose value is set by any RPC client handle creation routine that fails. It is used by the routine <b class="fname">clnt_pcreateerror</b>() to print the reason for the failure.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/rpc">rpc(3)</a>, <a class="link-man" href="../3/rpc_clnt_auth">rpc_clnt_auth(3)</a>, <a class="link-man" href="../3/rpc_clnt_calls">rpc_clnt_calls(3)</a>, <a class="link-man" href="../8/rpcbind">rpcbind(8)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 23, 2009</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

