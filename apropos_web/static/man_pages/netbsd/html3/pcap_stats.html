<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
PCAP_STATS(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
PCAP_STATS(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
PCAP_STATS(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> pcap_stats &#45; get capture statistics</div>
<div class="section">
<h1>SYNOPSIS</h1><br>
#include &lt;pcap/pcap.h&gt;<p>
<br>
int pcap_stats(pcap_t *p, struct pcap_stat *ps);<br>
</div>
<div class="section">
<h1>DESCRIPTION</h1> <b>pcap_stats()</b> fills in the <b>struct pcap_stat</b> pointed to by its second argument.  The values represent packet statistics from the start of the run to the time of the call.<p>
<b>pcap_stats()</b> is supported only on live captures, not on ``savefiles''; no statistics are stored in ``savefiles'', so no statistics are available when reading from a ``savefile''.<p>
A <b>struct pcap_stat</b> has the following members:<div style="margin-left: 5.00ex;">
<dl>
<dt>
<b>ps_recv</b></dt>
<dd>
number of packets received;</dd>
</dl>
<dl>
<dt>
<b>ps_drop</b></dt>
<dd>
number of packets dropped because there was no room in the operating system's buffer when they arrived, because packets weren't being read fast enough;</dd>
</dl>
<dl>
<dt>
<b>ps_ifdrop</b></dt>
<dd>
number of packets dropped by the network interface or its driver.</dd>
</dl>
</div>
<p>
The statistics do not behave the same way on all platforms. <b>ps_recv</b> might count packets whether they passed any filter set with <b>pcap_setfilter</b>(3) or not, or it might count only packets that pass the filter. It also might, or might not, count packets dropped because there was no room in the operating system's buffer when they arrived. <b>ps_drop</b> is not available on all platforms; it is zero on platforms where it's not available.  If packet filtering is done in libpcap, rather than in the operating system, it would count packets that don't pass the filter. Both <b>ps_recv</b> and <b>ps_drop</b> might, or might not, count packets not yet read from the operating system and thus not yet seen by the application. <b>ps_ifdrop</b> might, or might not, be implemented; if it's zero, that might mean that no packets were dropped by the interface, or it might mean that the statistic is unavailable, so it should not be treated as an indication that the interface did not drop any packets.</div>
<div class="section">
<h1>RETURN VALUE</h1> <b>pcap_stats()</b> returns 0 on success and returns &#45;1 if there is an error or if <i>p</i> doesn't support packet statistics. If &#45;1 is returned, <b>pcap_geterr()</b> or <b>pcap_perror()</b> may be called with <i>p</i> as an argument to fetch or display the error text.</div>
<div class="section">
<h1>SEE ALSO</h1> pcap(3), pcap_geterr(3)</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
7 September 2009</td>
<td class="foot-os" align="right">
</td>
</tr>
</table>
</div>
</body>
</html>

