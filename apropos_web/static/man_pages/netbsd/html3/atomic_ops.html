<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
ATOMIC_OPS(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
ATOMIC_OPS(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
ATOMIC_OPS(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">atomic_ops</b> &#8212; <span class="desc">atomic memory operations</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/atomic.h</a>&gt;</b></div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">atomic_ops</b> family of functions provide atomic memory operations. There are 7 classes of atomic memory operations available:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<a class="link-man" href="../3/atomic_add">atomic_add(3)</a></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
These functions perform atomic addition.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<a class="link-man" href="../3/atomic_and">atomic_and(3)</a></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
These functions perform atomic logical &#8220;and&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<a class="link-man" href="../3/atomic_cas">atomic_cas(3)</a></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
These functions perform atomic compare-and-swap.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<a class="link-man" href="../3/atomic_dec">atomic_dec(3)</a></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
These functions perform atomic decrement.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<a class="link-man" href="../3/atomic_inc">atomic_inc(3)</a></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
These functions perform atomic increment.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<a class="link-man" href="../3/atomic_or">atomic_or(3)</a></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
These functions perform atomic logical &#8220;or&#8221;.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<a class="link-man" href="../3/atomic_swap">atomic_swap(3)</a></dt>
<dd class="list-tag" style="margin-left: 14.00ex;">
These functions perform atomic swap.</dd>
</dl>
<div class="subsection">
<h2 id="x53796e6368726f6e697a6174696f6e204d656368616e69736d73">Synchronization Mechanisms</h2> Where the architecture does not provide hardware support for atomic compare and swap (CAS), atomicity is provided by a restartable sequence or by a spinlock. The chosen method is not ordinarily distinguishable by or visible to users of the interface. The following architectures can be assumed to provide CAS in hardware: alpha, amd64, i386, powerpc, powerpc64, sparc64.</div>
<div class="subsection">
<h2 id="x53636f706520616e64205265737472696374696f6e73">Scope and Restrictions</h2> If hardware CAS is available, the atomic operations are globally atomic: operations within a memory region shared between processes are guaranteed to be performed atomically. If hardware CAS is not available, it may only be assumed that the operations are atomic with respect to threads in the same process. Additionally, if hardware CAS is not available, the atomic operations must not be used within a signal handler.<p>
Users of atomic memory operations should not make assumptions about how the memory access is performed (specifically, the width of the memory access). For this reason, applications making use of atomic memory operations should limit their use to regular memory. The results of using atomic memory operations on anything other than regular memory are undefined.<p>
Users of atomic memory operations should take care to modify any given memory location either entirely with atomic operations or entirely with some other synchronization mechanism. Intermixing of atomic operations with other synchronization mechanisms for the same memory location results in undefined behavior.</div>
<div class="subsection">
<h2 id="x5669736962696c69747920616e64204f72646572696e67206f66204d656d6f7279204163636573736573">Visibility and Ordering of Memory Accesses</h2> If hardware CAS is available, stores to the target memory location by an atomic operation will reach global visibility before the operation completes. If hardware CAS is not available, the store may not reach global visibility until some time after the atomic operation has completed. However, in all cases a subsequent atomic operation on the same memory cell will be delayed until the result of any preceeding operation has reached global visibility.<p>
Atomic operations are strongly ordered with respect to each other. The global visibility of other loads and stores before and after an atomic operation is undefined. Applications that require synchronization of loads and stores with respect to an atomic operation must use memory barriers. See <a class="link-man" href="../3/membar_ops">membar_ops(3)</a>.</div>
<div class="subsection">
<h2 id="x506572666f726d616e6365">Performance</h2> Because atomic memory operations require expensive synchronization at the hardware level, applications should take care to minimize their use. In certain cases, it may be more appropriate to use a mutex, especially if more than one memory location will be modified.</div>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/atomic_add">atomic_add(3)</a>, <a class="link-man" href="../3/atomic_and">atomic_and(3)</a>, <a class="link-man" href="../3/atomic_cas">atomic_cas(3)</a>, <a class="link-man" href="../3/atomic_dec">atomic_dec(3)</a>, <a class="link-man" href="../3/atomic_inc">atomic_inc(3)</a>, <a class="link-man" href="../3/atomic_or">atomic_or(3)</a>, <a class="link-man" href="../3/atomic_swap">atomic_swap(3)</a>, <a class="link-man" href="../3/membar_ops">membar_ops(3)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">atomic_ops</b> functions first appeared in <span class="unix">NetBSD&#160;5.0</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 14, 2010</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

