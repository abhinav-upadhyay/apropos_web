<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
KRB5_VERIFY_USER(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
KRB5_VERIFY_USER(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
KRB5_VERIFY_USER(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">krb5_verify_user</b>, <b class="name">krb5_verify_user_lrealm</b>, <b class="name">krb5_verify_user_opt</b>, <b class="name">krb5_verify_opt_init</b>, <b class="name">krb5_verify_opt_alloc</b>, <b class="name">krb5_verify_opt_free</b>, <b class="name">krb5_verify_opt_set_ccache</b>, <b class="name">krb5_verify_opt_set_flags</b>, <b class="name">krb5_verify_opt_set_service</b>, <b class="name">krb5_verify_opt_set_secure</b>, <b class="name">krb5_verify_opt_set_keytab</b> &#8212; <span class="desc">Heimdal password verifying functions</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> Kerberos 5 Library (libkrb5, -lkrb5)</div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">krb5/krb5.h</a>&gt;</b><p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_verify_user</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;"> krb5_principal principal</i>, <i class="farg" style="white-space:nowrap;">krb5_ccache ccache</i>, <i class="farg" style="white-space:nowrap;">const char *password</i>, <i class="farg" style="white-space:nowrap;">krb5_boolean secure</i>, <i class="farg" style="white-space:nowrap;">const char *service</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_verify_user_lrealm</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_principal principal</i>, <i class="farg" style="white-space:nowrap;">krb5_ccache ccache</i>, <i class="farg" style="white-space:nowrap;">const char *password</i>, <i class="farg" style="white-space:nowrap;">krb5_boolean secure</i>, <i class="farg" style="white-space:nowrap;">const char *service</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">krb5_verify_opt_init</b>(<i class="farg" style="white-space:nowrap;">krb5_verify_opt *opt</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">krb5_verify_opt_alloc</b>(<i class="farg" style="white-space:nowrap;">krb5_verify_opt **opt</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">krb5_verify_opt_free</b>(<i class="farg" style="white-space:nowrap;">krb5_verify_opt *opt</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">krb5_verify_opt_set_ccache</b>(<i class="farg" style="white-space:nowrap;">krb5_verify_opt *opt</i>, <i class="farg" style="white-space:nowrap;">krb5_ccache ccache</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">krb5_verify_opt_set_keytab</b>(<i class="farg" style="white-space:nowrap;">krb5_verify_opt *opt</i>, <i class="farg" style="white-space:nowrap;">krb5_keytab keytab</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">krb5_verify_opt_set_secure</b>(<i class="farg" style="white-space:nowrap;">krb5_verify_opt *opt</i>, <i class="farg" style="white-space:nowrap;">krb5_boolean secure</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">krb5_verify_opt_set_service</b>(<i class="farg" style="white-space:nowrap;">krb5_verify_opt *opt</i>, <i class="farg" style="white-space:nowrap;">const char *service</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">krb5_verify_opt_set_flags</b>(<i class="farg" style="white-space:nowrap;">krb5_verify_opt *opt</i>, <i class="farg" style="white-space:nowrap;">unsigned int flags</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_verify_user_opt</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_principal principal</i>, <i class="farg">const char *password</i>, <i class="farg">krb5_verify_opt *opt</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">krb5_verify_user</b> function verifies the password supplied by a user. The principal whose password will be verified is specified in <i class="farg">principal</i>. New tickets will be obtained as a side-effect and stored in <i class="farg">ccache</i> (if <span class="define">NULL</span>, the default ccache is used). <b class="fname">krb5_verify_user</b>() will call <b class="fname">krb5_cc_initialize</b>() on the given <i class="farg">ccache</i>, so <i class="farg">ccache</i> must only initialized with <b class="fname">krb5_cc_resolve</b>() or <b class="fname">krb5_cc_gen_new</b>(). If the password is not supplied in <i class="farg">password</i> (and is given as <span class="define">NULL</span>) the user will be prompted for it. If <i class="farg">secure</i> the ticket will be verified against the locally stored service key <i class="farg">service</i> (by default &#8216;<code class="lit">host</code>&#8217; if given as <span class="define">NULL</span> ).<p>
The <b class="fname">krb5_verify_user_lrealm</b>() function does the same, except that it ignores the realm in <i class="farg">principal</i> and tries all the local realms (see <a class="link-man" href="../html5/krb5.conf.html">krb5.conf(5)</a>). After a successful return, the principal is set to the authenticated realm. If the call fails, the principal will not be meaningful, and should only be freed with <a class="link-man" href="../html3/krb5_free_principal.html">krb5_free_principal(3)</a>.<p>
<b class="fname">krb5_verify_opt_alloc</b>() and <b class="fname">krb5_verify_opt_free</b>() allocates and frees a <code class="lit">krb5_verify_opt</code>. You should use the the alloc and free function instead of allocation the structure yourself, this is because in a future release the structure wont be exported.<p>
<b class="fname">krb5_verify_opt_init</b>() resets all opt to default values.<p>
None of the krb5_verify_opt_set function makes a copy of the data structure that they are called with. It's up the caller to free them after the <b class="fname">krb5_verify_user_opt</b>() is called.<p>
<b class="fname">krb5_verify_opt_set_ccache</b>() sets the <i class="farg">ccache</i> that user of <i class="farg">opt</i> will use. If not set, the default credential cache will be used.<p>
<b class="fname">krb5_verify_opt_set_keytab</b>() sets the <i class="farg">keytab</i> that user of <i class="farg">opt</i> will use. If not set, the default keytab will be used.<p>
<b class="fname">krb5_verify_opt_set_secure</b>() if <i class="farg">secure</i> if true, the password verification will require that the ticket will be verified against the locally stored service key. If not set, default value is true.<p>
<b class="fname">krb5_verify_opt_set_service</b>() sets the <i class="farg">service</i> principal that user of <i class="farg">opt</i> will use. If not set, the &#8216;<code class="lit">host</code>&#8217; service will be used.<p>
<b class="fname">krb5_verify_opt_set_flags</b>() sets <i class="farg">flags</i> that user of <i class="farg">opt</i> will use. If the flag <span class="define">KRB5_VERIFY_LREALMS</span> is used, the <i class="farg">principal</i> will be modified like <b class="fname">krb5_verify_user_lrealm</b>() modifies it.<p>
<b class="fname">krb5_verify_user_opt</b>() function verifies the <i class="farg">password</i> supplied by a user. The principal whose password will be verified is specified in <i class="farg">principal</i>. Options the to the verification process is pass in in <i class="farg">opt</i>.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Here is a example program that verifies a password. it uses the &#8216;<code class="lit">host/`hostname`</code>&#8217; service principal in <i class="file">krb5.keytab</i>.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
#include &lt;krb5/krb5.h&gt; 
 
int 
main(int argc, char **argv) 
{ 
    char *user; 
    krb5_error_code error; 
    krb5_principal princ; 
    krb5_context context; 
 
    if (argc != 2) 
	errx(1, "usage: verify_passwd &lt;principal-name&gt;"); 
 
    user = argv[1]; 
 
    if (krb5_init_context(&amp;context) &lt; 0) 
	errx(1, "krb5_init_context"); 
 
    if ((error = krb5_parse_name(context, user, &amp;princ)) != 0) 
	krb5_err(context, 1, error, "krb5_parse_name"); 
 
    error = krb5_verify_user(context, princ, NULL, NULL, TRUE, NULL); 
    if (error) 
        krb5_err(context, 1, error, "krb5_verify_user"); 
 
    return 0; 
}</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/krb5_cc_gen_new.html">krb5_cc_gen_new(3)</a>, <a class="link-man" href="../html3/krb5_cc_initialize.html">krb5_cc_initialize(3)</a>, <a class="link-man" href="../html3/krb5_cc_resolve.html">krb5_cc_resolve(3)</a>, <a class="link-man" href="../html3/krb5_err.html">krb5_err(3)</a>, <a class="link-man" href="../html3/krb5_free_principal.html">krb5_free_principal(3)</a>, <a class="link-man" href="../html3/krb5_init_context.html">krb5_init_context(3)</a>, <a class="link-man" href="../html3/krb5_kt_default.html">krb5_kt_default(3)</a>, <a class="link-man" href="../html5/krb5.conf.html">krb5.conf(5)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 1, 2006</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

