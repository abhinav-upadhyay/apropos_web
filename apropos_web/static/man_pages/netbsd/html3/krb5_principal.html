<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
KRB5_PRINCIPAL(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
KRB5_PRINCIPAL(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
KRB5_PRINCIPAL(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">krb5_get_default_principal</b>, <b class="name">krb5_principal</b>, <b class="name">krb5_build_principal</b>, <b class="name">krb5_build_principal_ext</b>, <b class="name">krb5_build_principal_va</b>, <b class="name">krb5_build_principal_va_ext</b>, <b class="name">krb5_copy_principal</b>, <b class="name">krb5_free_principal</b>, <b class="name">krb5_make_principal</b>, <b class="name">krb5_parse_name</b>, <b class="name">krb5_parse_name_flags</b>, <b class="name">krb5_parse_nametype</b>, <b class="name">krb5_princ_set_realm</b>, <b class="name">krb5_principal_compare</b>, <b class="name">krb5_principal_compare_any_realm</b>, <b class="name">krb5_principal_get_comp_string</b>, <b class="name">krb5_principal_get_realm</b>, <b class="name">krb5_principal_get_type</b>, <b class="name">krb5_principal_match</b>, <b class="name">krb5_principal_set_type</b>, <b class="name">krb5_realm_compare</b>, <b class="name">krb5_sname_to_principal</b>, <b class="name">krb5_sock_to_principal</b>, <b class="name">krb5_unparse_name</b>, <b class="name">krb5_unparse_name_flags</b>, <b class="name">krb5_unparse_name_fixed</b>, <b class="name">krb5_unparse_name_fixed_flags</b>, <b class="name">krb5_unparse_name_fixed_short</b>, <b class="name">krb5_unparse_name_short</b> &#8212; <span class="desc">Kerberos 5 principal handling functions</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> Kerberos 5 Library (libkrb5, -lkrb5)</div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">krb5/krb5.h</a>&gt;</b><p>
<code class="lit">krb5_principal</code>;<br>
<i class="ftype">void</i><br>
<b class="fname">krb5_free_principal</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_principal principal</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_parse_name</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">const char *name</i>, <i class="farg" style="white-space:nowrap;">krb5_principal *principal</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_parse_name_flags</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">const char *name</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">krb5_principal *principal</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_unparse_name</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal principal</i>, <i class="farg" style="white-space:nowrap;">char **name</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_unparse_name_flags</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal principal</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">char **name</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_unparse_name_fixed</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal principal</i>, <i class="farg" style="white-space:nowrap;">char *name</i>, <i class="farg" style="white-space:nowrap;">size_t len</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_unparse_name_fixed_flags</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal principal</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">char *name</i>, <i class="farg" style="white-space:nowrap;">size_t len</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_unparse_name_short</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal principal</i>, <i class="farg" style="white-space:nowrap;">char **name</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_unparse_name_fixed_short</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal principal</i>, <i class="farg" style="white-space:nowrap;">char *name</i>, <i class="farg" style="white-space:nowrap;">size_t len</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">krb5_princ_set_realm</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_principal principal</i>, <i class="farg" style="white-space:nowrap;">krb5_realm *realm</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_build_principal</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_principal *principal</i>, <i class="farg" style="white-space:nowrap;">int rlen</i>, <i class="farg" style="white-space:nowrap;">krb5_const_realm realm</i>, <i class="farg" style="white-space:nowrap;">...</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_build_principal_va</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_principal *principal</i>, <i class="farg" style="white-space:nowrap;">int rlen</i>, <i class="farg" style="white-space:nowrap;">krb5_const_realm realm</i>, <i class="farg" style="white-space:nowrap;">va_list ap</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_build_principal_ext</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_principal *principal</i>, <i class="farg" style="white-space:nowrap;">int rlen</i>, <i class="farg" style="white-space:nowrap;">krb5_const_realm realm</i>, <i class="farg" style="white-space:nowrap;">...</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_build_principal_va_ext</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_principal *principal</i>, <i class="farg" style="white-space:nowrap;">int rlen</i>, <i class="farg" style="white-space:nowrap;">krb5_const_realm realm</i>, <i class="farg" style="white-space:nowrap;">va_list ap</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_make_principal</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_principal *principal</i>, <i class="farg" style="white-space:nowrap;">krb5_const_realm realm</i>, <i class="farg" style="white-space:nowrap;">...</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_copy_principal</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal inprinc</i>, <i class="farg" style="white-space:nowrap;">krb5_principal *outprinc</i>);<p>
<i class="ftype">krb5_boolean</i><br>
<b class="fname">krb5_principal_compare</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal princ1</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal princ2</i>);<p>
<i class="ftype">krb5_boolean</i><br>
<b class="fname">krb5_principal_compare_any_realm</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal princ1</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal princ2</i>);<p>
<i class="ftype">const char *</i><br>
<b class="fname">krb5_principal_get_comp_string</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal principal</i>, <i class="farg" style="white-space:nowrap;">unsigned int component</i>);<p>
<i class="ftype">const char *</i><br>
<b class="fname">krb5_principal_get_realm</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal principal</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">krb5_principal_get_type</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal principal</i>);<p>
<i class="ftype">krb5_boolean</i><br>
<b class="fname">krb5_principal_match</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal principal</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal pattern</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">krb5_principal_set_type</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_principal principal</i>, <i class="farg" style="white-space:nowrap;">int type</i>);<p>
<i class="ftype">krb5_boolean</i><br>
<b class="fname">krb5_realm_compare</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal princ1</i>, <i class="farg" style="white-space:nowrap;">krb5_const_principal princ2</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_sname_to_principal</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">const char *hostname</i>, <i class="farg" style="white-space:nowrap;">const char *sname</i>, <i class="farg" style="white-space:nowrap;">int32_t type</i>, <i class="farg" style="white-space:nowrap;">krb5_principal *ret_princ</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_sock_to_principal</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">int socket</i>, <i class="farg" style="white-space:nowrap;">const char *sname</i>, <i class="farg" style="white-space:nowrap;">int32_t type</i>, <i class="farg" style="white-space:nowrap;">krb5_principal *principal</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_get_default_principal</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">krb5_principal *princ</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">krb5_parse_nametype</b>(<i class="farg" style="white-space:nowrap;">krb5_context context</i>, <i class="farg" style="white-space:nowrap;">const char *str</i>, <i class="farg" style="white-space:nowrap;">int32_t *type</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <code class="lit">krb5_principal</code> holds the name of a user or service in Kerberos.<p>
A principal has two parts, a <code class="lit">PrincipalName</code> and a <code class="lit">realm</code>. The PrincipalName consists of one or more components. In printed form, the components are separated by /. The PrincipalName also has a name-type.<p>
Examples of a principal are <code class="lit">nisse/root@EXAMPLE.COM</code> and <code class="lit">host/datan.kth.se@KTH.SE</code>. <b class="fname">krb5_parse_name</b>() and <b class="fname">krb5_parse_name_flags</b>() passes a principal name in <i class="farg">name</i> to the kerberos principal structure. <b class="fname">krb5_parse_name_flags</b>() takes an extra <i class="farg">flags</i> argument the following flags can be passed in<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">KRB5_PRINCIPAL_PARSE_NO_REALM</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
requires the input string to be without a realm, and no realm is stored in the <i class="farg">principal</i> return argument.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">KRB5_PRINCIPAL_PARSE_REQUIRE_REALM</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
requires the input string to with a realm.</dd>
</dl>
<p>
<b class="fname">krb5_unparse_name</b>() and <b class="fname">krb5_unparse_name_flags</b>() prints the principal <i class="farg">princ</i> to the string <i class="farg">name</i>. <i class="farg">name</i> should be freed with <a class="link-man" href="../3/free">free(3)</a>. To the <i class="farg">flags</i> argument the following flags can be passed in<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">KRB5_PRINCIPAL_UNPARSE_SHORT</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
no realm if the realm is one of the local realms.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">KRB5_PRINCIPAL_UNPARSE_NO_REALM</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
never include any realm in the principal name.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">KRB5_PRINCIPAL_UNPARSE_DISPLAY</span></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
don't quote</dd>
</dl>
On failure <i class="farg">name</i> is set to <span class="define">NULL</span>. <b class="fname">krb5_unparse_name_fixed</b>() and <b class="fname">krb5_unparse_name_fixed_flags</b>() behaves just like <b class="fname">krb5_unparse</b>(), but instead unparses the principal into a fixed size buffer.<p>
<b class="fname">krb5_unparse_name_short</b>() just returns the principal without the realm if the principal is in the default realm. If the principal isn't, the full name is returned. <b class="fname">krb5_unparse_name_fixed_short</b>() works just like <b class="fname">krb5_unparse_name_short</b>() but on a fixed size buffer.<p>
<b class="fname">krb5_build_principal</b>() builds a principal from the realm <i class="farg">realm</i> that has the length <i class="farg">rlen</i>. The following arguments form the components of the principal. The list of components is terminated with <span class="define">NULL</span>.<p>
<b class="fname">krb5_build_principal_va</b>() works like <b class="fname">krb5_build_principal</b>() using vargs.<p>
<b class="fname">krb5_build_principal_ext</b>() and <b class="fname">krb5_build_principal_va_ext</b>() take a list of length-value pairs, the list is terminated with a zero length.<p>
<b class="fname">krb5_make_principal</b>() works the same way as <b class="fname">krb5_build_principal</b>(), except it figures out the length of the realm itself.<p>
<b class="fname">krb5_copy_principal</b>() makes a copy of a principal. The copy needs to be freed with <b class="fname">krb5_free_principal</b>().<p>
<b class="fname">krb5_principal_compare</b>() compares the two principals, including realm of the principals and returns <span class="define">TRUE</span> if they are the same and <span class="define">FALSE</span> if not.<p>
<b class="fname">krb5_principal_compare_any_realm</b>() works the same way as <b class="fname">krb5_principal_compare</b>() but doesn't compare the realm component of the principal.<p>
<b class="fname">krb5_realm_compare</b>() compares the realms of the two principals and returns <span class="define">TRUE</span> is they are the same, and <span class="define">FALSE</span> if not.<p>
<b class="fname">krb5_principal_match</b>() matches a <i class="farg">principal</i> against a <i class="farg">pattern</i>. The pattern is a globbing expression, where each component (separated by /) is matched against the corresponding component of the principal.<p>
The <b class="fname">krb5_principal_get_realm</b>() and <b class="fname">krb5_principal_get_comp_string</b>() functions return parts of the <i class="farg">principal</i>, either the realm or a specific component. Both functions return string pointers to data inside the principal, so they are valid only as long as the principal exists.<p>
The <i class="farg">component</i> argument to <b class="fname">krb5_principal_get_comp_string</b>() is the index of the component to return, from zero to the total number of components minus one. If the index is out of range <span class="define">NULL</span> is returned.<p>
<b class="fname">krb5_principal_get_realm</b>() and <b class="fname">krb5_principal_get_comp_string</b>() are replacements for <b class="fname">krb5_princ_component</b>() and related macros, described as internal in the MIT API specification. Unlike the macros, these functions return strings, not <span class="define">krb5_data</span>. A reason to return <span class="define">krb5_data</span> was that it was believed that principal components could contain binary data, but this belief was unfounded, and it has been decided that principal components are infact UTF8, so it's safe to use zero terminated strings.<p>
It's generally not necessary to look at the components of a principal.<p>
<b class="fname">krb5_principal_get_type</b>() and <b class="fname">krb5_principal_set_type</b>() get and sets the name type for a principal. Name type handling is tricky and not often needed, don't use this unless you know what you do.<p>
<b class="fname">krb5_sname_to_principal</b>() and <b class="fname">krb5_sock_to_principal</b>() are for easy creation of &#8220;service&#8221; principals that can, for instance, be used to lookup a key in a keytab. For both functions the <i class="farg">sname</i> parameter will be used for the first component of the created principal. If <i class="farg">sname</i> is <span class="define">NULL</span>, &#8220;host&#8221; will be used instead.<p>
<b class="fname">krb5_sname_to_principal</b>() will use the passed <i class="farg">hostname</i> for the second component. If <i class="farg">type</i> is <span class="define">KRB5_NT_SRV_HST</span> this name will be looked up with <b class="fname">gethostbyname</b>(). If <i class="farg">hostname</i> is <span class="define">NULL</span>, the local hostname will be used.<p>
<b class="fname">krb5_sock_to_principal</b>() will use the &#8220;sockname&#8221; of the passed <i class="farg">socket</i>, which should be a bound <span class="define">AF_INET</span> or <span class="define">AF_INET6</span> socket. There must be a mapping between the address and &#8220;sockname&#8221;. The function may try to resolve the name in DNS.<p>
<b class="fname">krb5_get_default_principal</b>() tries to find out what's a reasonable default principal by looking at the environment it is running in.<p>
<b class="fname">krb5_parse_nametype</b>() parses and returns the name type integer value in <i class="farg">type</i>. On failure the function returns an error code and set the error string.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/krb5_425_conv_principal">krb5_425_conv_principal(3)</a>, <a class="link-man" href="../3/krb5_config">krb5_config(3)</a>, <a class="link-man" href="../5/krb5.conf">krb5.conf(5)</a></div>
<div class="section">
<h1 id="x42554753">BUGS</h1> You can not have a NUL in a component in some of the variable argument functions above. Until someone can give a good example of where it would be a good idea to have NUL's in a component, this will not be fixed.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 1, 2006</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

