<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
BN_generate_prime(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
BN_generate_prime(3)</td>
<td class="head-vol" align="center">
OpenSSL</td>
<td class="head-rtitle" align="right">
BN_generate_prime(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> BN_generate_prime, BN_is_prime, BN_is_prime_fasttest &#45; generate primes and test for primality</div>
<div class="section">
<h1>LIBRARY</h1> libcrypto, -lcrypto</div>
<div class="section">
<h1>SYNOPSIS</h1><br>
 #include &lt;openssl/bn.h&gt;<br>
<br>
 BIGNUM *BN_generate_prime(BIGNUM *ret, int num, int safe, BIGNUM *add,<br>
     BIGNUM *rem, void (*callback)(int, int, void *), void *cb_arg);<br>
<br>
 int BN_is_prime(const BIGNUM *a, int checks, void (*callback)(int, int,<br>
     void *), BN_CTX *ctx, void *cb_arg);<br>
<br>
 int BN_is_prime_fasttest(const BIGNUM *a, int checks,<br>
     void (*callback)(int, int, void *), BN_CTX *ctx, void *cb_arg,<br>
     int do_trial_division);<br>
</div>
<div class="section">
<h1>DESCRIPTION</h1>  <i>BN_generate_prime()</i> generates a pseudo-random prime number of <b>num</b> bits. If  <b>ret</b> is not <b>NULL</b>, it will be used to store the number.<p>
If <b>callback</b> is not <b>NULL</b>, it is called as follows:<dl>
<dt>
&#8226;</dt>
<dd>
<b>callback(0, i, cb_arg)</b> is called after generating the i&#45;th potential prime number.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
While the number is being tested for primality, <b>callback(1, j,</b>  <b>cb_arg)</b> is called as described below.</dd>
</dl>
<dl>
<dt>
&#8226;</dt>
<dd>
When a prime has been found, <b>callback(2, i, cb_arg)</b> is called.</dd>
</dl>
<p>
The prime may have to fulfill additional requirements for use in Diffie-Hellman key exchange:<p>
If <b>add</b> is not <b>NULL</b>, the prime will fulfill the condition p % <b>add</b> ==  <b>rem</b> (p % <b>add</b> == 1 if <b>rem</b> == <b>NULL</b>) in order to suit a given generator.<p>
If <b>safe</b> is true, it will be a safe prime (i.e. a prime p so that (p&#45;1)/2 is also prime).<p>
The PRNG must be seeded prior to calling <i>BN_generate_prime()</i>. The prime number generation has a negligible error probability.<p>
<i>BN_is_prime()</i> and <i>BN_is_prime_fasttest()</i> test if the number <b>a</b> is prime.  The following tests are performed until one of them shows that  <b>a</b> is composite; if <b>a</b> passes all these tests, it is considered prime.<p>
<i>BN_is_prime_fasttest()</i>, when called with <b>do_trial_division == 1</b>, first attempts trial division by a number of small primes; if no divisors are found by this test and  <b>callback</b> is not <b>NULL</b>,  <b>callback(1, &#45;1, cb_arg)</b> is called. If  <b>do_trial_division == 0</b>, this test is skipped.<p>
Both <i>BN_is_prime()</i> and <i>BN_is_prime_fasttest()</i> perform a Miller-Rabin probabilistic primality test with  <b>checks</b> iterations. If  <b>checks == BN_prime_checks</b>, a number of iterations is used that yields a false positive rate of at most 2^&#45;80 for random input.<p>
If <b>callback</b> is not <b>NULL</b>, <b>callback(1, j, cb_arg)</b> is called after the j&#45;th iteration (j = 0, 1, ...).  <b>ctx</b> is a pre-allocated  <b>BN_CTX</b> (to save the overhead of allocating and freeing the structure in a loop), or  <b>NULL</b>.</div>
<div class="section">
<h1>RETURN VALUES</h1>  <i>BN_generate_prime()</i> returns the prime number on success, <b>NULL</b> otherwise.<p>
<i>BN_is_prime()</i> returns 0 if the number is composite, 1 if it is prime with an error probability of less than 0.25^ <b>checks</b>, and &#45;1 on error.<p>
The error codes can be obtained by <i>ERR_get_error</i>(3).</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>openssl_bn</i>(3), <i>ERR_get_error</i>(3), <i>openssl_rand</i>(3)</div>
<div class="section">
<h1>HISTORY</h1> The  <b>cb_arg</b> arguments to <i>BN_generate_prime()</i> and to <i>BN_is_prime()</i> were added in SSLeay 0.9.0. The  <b>ret</b> argument to <i>BN_generate_prime()</i> was added in SSLeay 0.9.1.  <i>BN_is_prime_fasttest()</i> was added in OpenSSL 0.9.5.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
2009-07-19</td>
<td class="foot-os" align="right">
1.0.1n</td>
</tr>
</table>
</div>
</body>
</html>

