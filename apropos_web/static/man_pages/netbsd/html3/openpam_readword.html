<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
OPENPAM_READWORD(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
OPENPAM_READWORD(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
OPENPAM_READWORD(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">openpam_readword</b> &#8212; <span class="desc">read a word from a file, respecting shell quoting rules</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Pluggable Authentication Module Library (libpam, &#45;lpam)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/types.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">stdio.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">security/pam_appl.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">security/openpam.h</a>&gt;</b><p>
<i class="ftype">char *</i><br>
<b class="fname">openpam_readword</b>(<i class="farg" style="white-space:nowrap;">FILE *f</i>, <i class="farg" style="white-space:nowrap;">int *lineno</i>, <i class="farg" style="white-space:nowrap;">size_t *lenp</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">openpam_readword</b>() function reads the next word from a file, and returns it in a NUL-terminated buffer allocated with <a class="link-man" href="../html3/malloc.html">malloc(3)</a>.<p>
A word is a sequence of non-whitespace characters. However, whitespace characters can be included in a word if quoted or escaped according to the following rules:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
An unescaped single or double quote introduces a quoted string, which ends when the same quote character is encountered a second time. The quotes themselves are stripped.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Within a single- or double-quoted string, all whitespace characters, including the newline character, are preserved as-is.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Outside a quoted string, a backslash escapes the next character, which is preserved as-is, unless that character is a newline, in which case it is discarded and reading continues at the beginning of the next line as if the backslash and newline had not been there. In all cases, the backslash itself is discarded.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Within a single-quoted string, double quotes and backslashes are preserved as-is.</li>
<li class="list-bul" style="margin-top: 1.00em;">
Within a double-quoted string, a single quote is preserved as-is, and a backslash is preserved as-is unless used to escape a double quote.</li>
</ul>
<p>
In addition, if the first non-whitespace character on the line is a hash character (#), the rest of the line is discarded. If a hash character occurs within a word, however, it is preserved as-is. A backslash at the end of a comment does cause line continuation.<p>
If <i class="farg">lineno</i> is not <span class="define">NULL</span>, the integer variable it points to is incremented every time a quoted or escaped newline character is read.<p>
If <i class="farg">lenp</i> is not <span class="define">NULL</span>, the length of the word (after quotes and backslashes have been removed) is stored in the variable it points to.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> If successful, the <b class="fname">openpam_readword</b>() function returns a pointer to a dynamically allocated NUL-terminated string containing the first word encountered on the line.<p>
The caller is responsible for releasing the returned buffer by passing it to <a class="link-man" href="../html3/free.html">free(3)</a>.<p>
If <b class="fname">openpam_readword</b>() reaches the end of the line or file before any characters are copied to the word, it returns <span class="define">NULL</span>. In the former case, the newline is pushed back to the file.<p>
If <b class="fname">openpam_readword</b>() reaches the end of the file while a quote or backslash escape is in effect, it sets <b class="var">errno</b> to <span class="define">EINVAL</span> and returns <span class="define">NULL</span>.</div>
<div class="section">
<h1 id="x494d504c454d454e544154494f4e204e4f544553">IMPLEMENTATION NOTES</h1> The parsing rules are intended to be equivalent to the normal POSIX shell quoting rules. Any discrepancy is a bug and should be reported to the author along with sample input that can be used to reproduce the error.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/openpam_readline.html">openpam_readline(3)</a>, <a class="link-man" href="../html3/openpam_readlinev.html">openpam_readlinev(3)</a>, <a class="link-man" href="../html3/pam.html">pam(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">openpam_readword</b>() function is an OpenPAM extension.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> The <b class="fname">openpam_readword</b>() function and this manual page were developed by <span class="author">Dag-Erling Sm&#248;rgrav</span> &#60;<a class="link-mail" href="mailto:des@des.no">des@des.no</a>&#62;.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
September 12, 2014</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

