<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
PCAP_DUMP_OPEN(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
PCAP_DUMP_OPEN(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
PCAP_DUMP_OPEN(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> pcap_dump_open, pcap_dump_fopen &#45; open a file to which to write packets</div>
<div class="section">
<h1>SYNOPSIS</h1><br>
#include &lt;pcap/pcap.h&gt;<p>
<br>
pcap_dumper_t *pcap_dump_open(pcap_t *p, const char *fname);<br>
pcap_dumper_t *pcap_dump_open_append(pcap_t *p, const char *fname);<br>
pcap_dumper_t *pcap_dump_fopen(pcap_t *p, FILE *fp);<br>
</div>
<div class="section">
<h1>DESCRIPTION</h1> <b>pcap_dump_open()</b> is called to open a ``savefile'' for writing. <i>fname</i> specifies the name of the file to open. The file will have the same format as those used by <b>tcpdump</b>(8) and <b>tcpslice</b>(1). The name "-" is a synonym for <b>stdout</b>.<p>
<b>pcap_dump_fopen()</b> is called to write data to an existing open stream <i>fp</i>. Note that on Windows, that stream should be opened in binary mode.<p>
<i>p</i> is a capture or ``savefile'' handle returned by an earlier call to <b>pcap_create()</b> and activated by an earlier call to <b>pcap_activate()</b>, or returned by an earlier call to <b>pcap_open_offline()</b>, <b>pcap_open_live()</b>, or <b>pcap_open_dead()</b>. The time stamp precision, link-layer type, and snapshot length from <i>p</i> are used as the link-layer type and snapshot length of the output file.<p>
<b>pcap_dump_open_append()</b> is like <b>pcap_dump_open</b> but does not create the file if it does not exist and, if it does already exist, and is a pcap file with the same byte order as the host opening the file, and has the same time stamp precision, link-layer header type, and snapshot length as <i>p</i>, it will write new packets at the end of the file.</div>
<div class="section">
<h1>RETURN VALUES</h1> A pointer to a <b>pcap_dumper_t</b> structure to use in subsequent <b>pcap_dump()</b> and <b>pcap_dump_close()</b> calls is returned on success. <b>NULL</b> is returned on failure. If <b>NULL</b> is returned, <b>pcap_geterr(<i>p</i><b>)</b></b>  <b>can be used to get the error text.</b></div>
<div class="section">
<h1>SEE ALSO</h1> pcap(3), pcap_create(3), pcap_activate(3), pcap_open_offline(3), pcap_open_live(3), pcap_open_dead(3), pcap_dump(3), pcap_dump_close(3), pcap_geterr(3), pcap-savefile(5)</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
5 April 2008</td>
<td class="foot-os" align="right">
</td>
</tr>
</table>
</div>
</body>
</html>

