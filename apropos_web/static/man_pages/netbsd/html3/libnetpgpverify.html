<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
LIBNETPGPVERIFY(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
LIBNETPGPVERIFY(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
LIBNETPGPVERIFY(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">libnetpgpverify</b> &#8212; <span class="desc">library to verify digital signatures</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Netpgp Verification (libnetpgpverify, &#45;lnetpgpverify)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">netpgp/verify.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">pgpv_read_pubring</b>(<i class="farg">pgpv_t *pgp</i>, <i class="farg">const void *keyring</i>, <i class="farg">ssize_t size</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">pgpv_read_ssh_pubkeys</b>(<i class="farg">pgpv_t *pgp</i>, <i class="farg">const void *keyring</i>, <i class="farg">ssize_t size</i>);<p>
<i class="ftype">size_t</i><br>
<b class="fname">pgpv_verify</b>(<i class="farg">pgpv_cursor_t *cursor</i>, <i class="farg">pgpv_t *pgp</i>, <i class="farg">const void *ptr</i>, <i class="farg">ssize_t size</i>);<p>
<i class="ftype">size_t</i><br>
<b class="fname">pgpv_get_verified</b>(<i class="farg">pgpv_cursor_t *cursor</i>, <i class="farg">size_t cookie</i>, <i class="farg">char **ret</i>);<p>
<i class="ftype">size_t</i><br>
<b class="fname">pgpv_get_cursor_element</b>(<i class="farg">pgpv_cursor_t *cursor</i>, <i class="farg">size_t element</i>);<p>
<i class="ftype">size_t</i><br>
<b class="fname">pgpv_dump</b>(<i class="farg">pgpv_t *pgp</i>, <i class="farg">char **data</i>);<p>
<i class="ftype">size_t</i><br>
<b class="fname">pgpv_get_entry</b>(<i class="farg">pgpv_t *pgp</i>, <i class="farg">unsigned ent</i>, <i class="farg">char **ret</i>, <i class="farg">const char *modifiers</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">pgpv_close</b>(<i class="farg">pgpv_t *pgp</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">libnetpgpverify</b> is a small library which will verify a digital signature on a text or binary document. It has been kept deliberately small and only uses compression libraries to function.<p>
PGP messages, including key rings, are made up of PGP packets, defined in RFC 4880. To match a digital signature, the public key of the signer must be located in a public key ring. This library has enough functionality to parse a pubkey keyring, using <b class="fname">pgpv_read_pubring</b>() to read the public keys of trusted identities, and to read files or memory which has already been signed. SSH public keys can also be used for signature verification by using the <b class="fname">pgpv_read_ssh_pubkeys</b>() function. Please note that the creation date of the signature key will show up as January 1st 1970, due to the fact that the creation date of the key is not encoded anywhere for an ssh key, whilst it is an inherent part of the PGP fingerprint. In order that the correct fingerprint is used, the key creation date is forced to 0.<p>
The <b class="fname">pgpv_verify</b>() function is used to verify the signature, either on data, or on memory. To signal to <b class="fname">pgpv_verify</b>() to read a file and verify it, the <span class="define">size</span> argument should be set to <span class="define">-1</span> whilst a positive size signals that the pointer value should be that of signed memory. <b class="fname">pgpv_verify</b>() returns a cookie if the ignature was verified, or 0 if it did not. This cookie can subsequently be used to retrieve the data which was verified.<p>
If the signature does match, then the file or memory can be considered as being verified as being unmodified and unchanged, integrally sound.<p>
Signatures have validity dates on them, and it is possible for a signature to have expired when it is being checked. If for any reason the signature does not match, then the reason for not verifying the signature will be stored in the <span class="define">why</span> buffer in the <span class="define">pgpv_cursor_t</span> structure.<p>
Occasionally, the memory or contents of the file which matched the signature will be needed, rather than a boolean value of whether it was verified. To do this, the <b class="fname">pgpv_get_verified</b>() function is used. Arguments to <b class="fname">pgpv_get_verified</b>() are the cookie returned from the verification, and a buffer allocated for the returned data and its size. If an error occurs, or the signature is not verified, a zero value is returned for the size. <b class="name">libnetpgpverify</b> stores the starts of the data of all verified matches, and so the entry number argument is the index of the occurrence of verification. The first match will have an entry number of 0, the second 1, and so on.<p>
The <b class="fname">pgpv_close</b>() function is used to clean up after all matching and verification has taken place. It frees and de-allocates all resources used in the verification of the signature.<p>
The program used for signing may encode into base64 encoding, and it may also use embedded compression to make the output smaller than it would otherwise be. This is handled automatically by <b class="name">libnetpgpverify</b></div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/bn">bn(3)</a>, <a class="link-man" href="../3/zlib">zlib(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="name">libnetpgpverify</b> utility is designed to conform to IETF RFC 4880.</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">libnetpgpverify</b> library first appeared in <span class="unix">NetBSD&#160;7.0</span>.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> <span class="author">Alistair Crooks</span> &#60;<a class="link-mail" href="mailto:agc@NetBSD.org">agc@NetBSD.org</a>&#62;</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
January 15, 2015</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

