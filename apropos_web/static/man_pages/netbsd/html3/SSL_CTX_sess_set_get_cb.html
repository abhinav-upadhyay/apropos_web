<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
SSL_CTX_sess_set_get_cb(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
SSL_CTX_sess_set_get_cb(3)</td>
<td class="head-vol" align="center">
OpenSSL</td>
<td class="head-rtitle" align="right">
SSL_CTX_sess_set_get_cb(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> SSL_CTX_sess_set_new_cb, SSL_CTX_sess_set_remove_cb, SSL_CTX_sess_set_get_cb, SSL_CTX_sess_get_new_cb, SSL_CTX_sess_get_remove_cb, SSL_CTX_sess_get_get_cb &#45; provide callback functions for server side external session caching</div>
<div class="section">
<h1>LIBRARY</h1> libcrypto, -lcrypto</div>
<div class="section">
<h1>SYNOPSIS</h1><br>
 #include &lt;openssl/ssl.h&gt;<br>
<br>
 void SSL_CTX_sess_set_new_cb(SSL_CTX *ctx,<br>
                              int (*new_session_cb)(SSL *, SSL_SESSION *));<br>
 void SSL_CTX_sess_set_remove_cb(SSL_CTX *ctx,<br>
           void (*remove_session_cb)(SSL_CTX *ctx, SSL_SESSION *));<br>
 void SSL_CTX_sess_set_get_cb(SSL_CTX *ctx,<br>
           SSL_SESSION (*get_session_cb)(SSL *, unsigned char *, int, int *));<br>
<br>
 int (*SSL_CTX_sess_get_new_cb(SSL_CTX *ctx))(struct ssl_st *ssl, SSL_SESSION *sess);<br>
 void (*SSL_CTX_sess_get_remove_cb(SSL_CTX *ctx))(struct ssl_ctx_st *ctx, SSL_SESSION *sess);<br>
 SSL_SESSION *(*SSL_CTX_sess_get_get_cb(SSL_CTX *ctx))(struct ssl_st *ssl, unsigned char *data, int len, int *copy);<br>
<br>
 int (*new_session_cb)(struct ssl_st *ssl, SSL_SESSION *sess);<br>
 void (*remove_session_cb)(struct ssl_ctx_st *ctx, SSL_SESSION *sess);<br>
 SSL_SESSION *(*get_session_cb)(struct ssl_st *ssl, unsigned char *data,<br>
               int len, int *copy);<br>
</div>
<div class="section">
<h1>DESCRIPTION</h1>  <i>SSL_CTX_sess_set_new_cb()</i> sets the callback function, which is automatically called whenever a new session was negotiated.<p>
<i>SSL_CTX_sess_set_remove_cb()</i> sets the callback function, which is automatically called whenever a session is removed by the SSL engine, because it is considered faulty or the session has become obsolete because of exceeding the timeout value.<p>
<i>SSL_CTX_sess_set_get_cb()</i> sets the callback function which is called, whenever a SSL/TLS client proposed to resume a session but the session could not be found in the internal session cache (see  <i>SSL_CTX_set_session_cache_mode</i>(3)). (SSL/TLS server only.)<p>
<i>SSL_CTX_sess_get_new_cb()</i>, <i>SSL_CTX_sess_get_remove_cb()</i>, and  <i>SSL_CTX_sess_get_get_cb()</i> allow to retrieve the function pointers of the provided callback functions. If a callback function has not been set, the NULL pointer is returned.</div>
<div class="section">
<h1>NOTES</h1> In order to allow external session caching, synchronization with the internal session cache is realized via callback functions. Inside these callback functions, session can be saved to disk or put into a database using the  <i>d2i_SSL_SESSION</i>(3) interface.<p>
The <i>new_session_cb()</i> is called, whenever a new session has been negotiated and session caching is enabled (see  <i>SSL_CTX_set_session_cache_mode</i>(3)). The  <i>new_session_cb()</i> is passed the <b>ssl</b> connection and the ssl session  <b>sess</b>. If the callback returns <b>0</b>, the session will be immediately removed again.<p>
The <i>remove_session_cb()</i> is called, whenever the SSL engine removes a session from the internal cache. This happens when the session is removed because it is expired or when a connection was not shutdown cleanly. It also happens for all sessions in the internal session cache when  <i>SSL_CTX_free</i>(3) is called. The <i>remove_session_cb()</i> is passed the  <b>ctx</b> and the ssl session <b>sess</b>. It does not provide any feedback.<p>
The <i>get_session_cb()</i> is only called on SSL/TLS servers with the session id proposed by the client. The  <i>get_session_cb()</i> is always called, also when session caching was disabled. The  <i>get_session_cb()</i> is passed the  <b>ssl</b> connection, the session id of length <b>length</b> at the memory location  <b>data</b>. With the parameter <b>copy</b> the callback can require the SSL engine to increment the reference count of the SSL_SESSION object, Normally the reference count is not incremented and therefore the session must not be explicitly freed with  <i>SSL_SESSION_free</i>(3).</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>ssl</i>(3), <i>d2i_SSL_SESSION</i>(3),  <i>SSL_CTX_set_session_cache_mode</i>(3),  <i>SSL_CTX_flush_sessions</i>(3),  <i>SSL_SESSION_free</i>(3),  <i>SSL_CTX_free</i>(3)</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
2009-07-19</td>
<td class="foot-os" align="right">
1.0.1n</td>
</tr>
</table>
</div>
</body>
</html>

