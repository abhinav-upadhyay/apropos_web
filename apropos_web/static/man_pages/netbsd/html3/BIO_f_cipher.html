<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
BIO_f_cipher(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
BIO_f_cipher(3)</td>
<td class="head-vol" align="center">
OpenSSL</td>
<td class="head-rtitle" align="right">
BIO_f_cipher(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> BIO_f_cipher, BIO_set_cipher, BIO_get_cipher_status, BIO_get_cipher_ctx &#45; cipher BIO filter</div>
<div class="section">
<h1>LIBRARY</h1> libcrypto, -lcrypto</div>
<div class="section">
<h1>SYNOPSIS</h1><br>
 #include &lt;openssl/bio.h&gt;<br>
 #include &lt;openssl/evp.h&gt;<br>
<br>
 BIO_METHOD *   BIO_f_cipher(void);<br>
 void BIO_set_cipher(BIO *b,const EVP_CIPHER *cipher,<br>
                unsigned char *key, unsigned char *iv, int enc);<br>
 int BIO_get_cipher_status(BIO *b)<br>
 int BIO_get_cipher_ctx(BIO *b, EVP_CIPHER_CTX **pctx)<br>
</div>
<div class="section">
<h1>DESCRIPTION</h1>  <i>BIO_f_cipher()</i> returns the cipher BIO method. This is a filter BIO that encrypts any data written through it, and decrypts any data read from it. It is a BIO wrapper for the cipher routines  <i>EVP_CipherInit()</i>, <i>EVP_CipherUpdate()</i> and <i>EVP_CipherFinal()</i>.<p>
Cipher BIOs do not support <i>BIO_gets()</i> or <i>BIO_puts()</i>.<p>
<i>BIO_flush()</i> on an encryption BIO that is being written through is used to signal that no more data is to be encrypted: this is used to flush and possibly pad the final block through the BIO.<p>
<i>BIO_set_cipher()</i> sets the cipher of BIO <b>b</b> to <b>cipher</b> using key <b>key</b> and IV  <b>iv</b>. <b>enc</b> should be set to 1 for encryption and zero for decryption.<p>
When reading from an encryption BIO the final block is automatically decrypted and checked when EOF is detected.  <i>BIO_get_cipher_status()</i> is a  <i>BIO_ctrl()</i> macro which can be called to determine whether the decryption operation was successful.<p>
<i>BIO_get_cipher_ctx()</i> is a <i>BIO_ctrl()</i> macro which retrieves the internal BIO cipher context. The retrieved context can be used in conjunction with the standard cipher routines to set it up. This is useful when  <i>BIO_set_cipher()</i> is not flexible enough for the applications needs.</div>
<div class="section">
<h1>NOTES</h1> When encrypting  <i>BIO_flush()</i> <b>must</b> be called to flush the final block through the BIO. If it is not then the final block will fail a subsequent decrypt.<p>
When decrypting an error on the final block is signalled by a zero return value from the read operation. A successful decrypt followed by EOF will also return zero for the final read.  <i>BIO_get_cipher_status()</i> should be called to determine if the decrypt was successful.<p>
As always, if <i>BIO_gets()</i> or <i>BIO_puts()</i> support is needed then it can be achieved by preceding the cipher BIO with a buffering BIO.</div>
<div class="section">
<h1>RETURN VALUES</h1>  <i>BIO_f_cipher()</i> returns the cipher BIO method.<p>
<i>BIO_set_cipher()</i> does not return a value.<p>
<i>BIO_get_cipher_status()</i> returns 1 for a successful decrypt and 0 for failure.<p>
<i>BIO_get_cipher_ctx()</i> currently always returns 1.</div>
<div class="section">
<h1>EXAMPLES</h1> TBA</div>
<div class="section">
<h1>SEE ALSO</h1> TBA</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
2009-07-19</td>
<td class="foot-os" align="right">
1.0.1n</td>
</tr>
</table>
</div>
</body>
<>

