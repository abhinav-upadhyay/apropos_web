<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
DWARF_PRODUCER_INIT(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
DWARF_PRODUCER_INIT(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
DWARF_PRODUCER_INIT(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">dwarf_producer_init</b> <b class="name">dwarf_producer_init_b</b> &#8212; <span class="desc">allocate a DWARF producer descriptor</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">DWARF Access Library (libdwarf, &#45;ldwarf)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">libdwarf.h</a>&gt;</b><p>
<i class="ftype">Dwarf_P_Debug</i><br>
<b class="fname">dwarf_producer_init</b>(<i class="farg">Dwarf_Unsigned flags</i>, <i class="farg">Dwarf_Callback_Func func</i>, <i class="farg">Dwarf_Handler errhand</i>, <i class="farg">Dwarf_Ptr errarg</i>, <i class="farg">Dwarf_Error *err</i>);<p>
<i class="ftype">Dwarf_P_Debug</i><br>
<b class="fname">dwarf_producer_init_b</b>(<i class="farg">Dwarf_Unsigned flags</i>, <i class="farg">Dwarf_Callback_Func_b func</i>, <i class="farg">Dwarf_Handler errhand</i>, <i class="farg">Dwarf_Ptr errarg</i>, <i class="farg">Dwarf_Error *error</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> These functions allocate and return a <span class="type">Dwarf_P_Debug</span> descriptor representing a DWARF producer instance.<p>
The argument <i class="arg">errhand</i> should contain the adddress of a function to be called in case of an error. If this argument is <span class="define">NULL</span>, the default error handling scheme is used, see <a class="link-man" href="../html3/dwarf.html">dwarf(3)</a>.<p>
The argument <i class="arg">errarg</i> will be passed to the error handler function when it is invoked.<p>
The argument <i class="arg">err</i> references a memory location that would hold a <span class="type">Dwarf_Error</span> descriptor in case of an error.<p>
The argument <i class="arg">flags</i> specifies additional characteristics of the DWARF producer instance. The following flags are recognized:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DW_DLC_ISA_IA64</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
(Deprecated) The target instruction set architecture is IA64. This flag is deprecated. Application code should use the <a class="link-man" href="../html3/dwarf_producer_set_isa.html">dwarf_producer_set_isa(3)</a> function to specify target instruction set architecture.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DW_DLC_ISA_MIPS</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
(Deprecated) The target instruction set architecture is MIPS. This flag is deprecated. Application code should use the <a class="link-man" href="../html3/dwarf_producer_set_isa.html">dwarf_producer_set_isa(3)</a> function to specify target instruction set architecture.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DW_DLC_SIZE_32</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
(Default) The target address size is 32-bit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DW_DLC_SIZE_64</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
The target address size is 64-bit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DW_DLC_STREAM_RELOCATIONS</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
(Default) Generate stream relocations.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DW_DLC_SYMBOLIC_RELOCATIONS</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
Generate symbolic relocations.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DW_DLC_TARGET_BIGENDIAN</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
The target is big endian.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DW_DLC_TARGET_LITTLEENDIAN</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
The target is little endian.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">DW_DLC_WRITE</span></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
(Required) Permit writing of DWARF information.</dd>
</dl>
<p>
The following flags are mutually exclusive.<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-bul">
<li class="list-bul" style="margin-top: 0.00em;">
Flags <span class="define">DW_DLC_ISA_IA64</span> and <span class="define">DW_DLC_ISA_MIPS</span>.</li>
<li class="list-bul" style="margin-top: 0.00em;">
Flags <span class="define">DW_DLC_SIZE_32</span> and <span class="define">DW_DLC_SIZE_64</span>.</li>
<li class="list-bul" style="margin-top: 0.00em;">
Flags <span class="define">DW_DLC_STREAM_RELOCATIONS</span> and <span class="define">DW_DLC_SYMBOLIC_RELOCATIONS</span>.</li>
<li class="list-bul" style="margin-top: 0.00em;">
Flags <span class="define">DW_DLC_TARGET_BIGENDIAN</span> and <span class="define">DW_DLC_TARGET_LITTLEENDIAN</span>.</li>
</ul>
If neither of the flags <span class="define">DW_DLC_TARGET_BIGENDIAN</span> and <span class="define">DW_DLC_TARGET_LITTLEENDIAN</span> is set, the target's endianness is assumed to be the same as the host's endianness.<p>
Argument <i class="arg">func</i> should point to an application-provided callback function of type <span class="type">Dwarf_Callback_Func_b</span>. The type <span class="type">Dwarf_Callback_Func_b</span> is defined in the header file <b class="includes">&lt;<a class="link-includes">libdwarf.h</a>&gt;</b> as:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
typedef int (*Dwarf_Callback_Func_b)(char *name, int size, 
    Dwarf_Unsigned type, Dwarf_Unsigned flags, Dwarf_Unsigned link, 
    Dwarf_Unsigned info, Dwarf_Unsigned *index, int *error);</pre>
<p>
This function is called by the <span class="lib">DWARF Access Library (libdwarf, &#45;ldwarf)</span> once for each section in the object file that the library needs to create. The arguments to this callback function specify the values in the ELF section header for the section being created:<p>
<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">name</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The name of the section being created.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">size</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <b class="var">sh_size</b> value in the section header.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">type</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <b class="var">sh_type</b> value in the section header.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">flags</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <b class="var">sh_flags</b> value in the section header.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">link</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <b class="var">sh_link</b> value in the section header.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="arg">info</i></dt>
<dd class="list-tag" style="margin-left: 6.00ex;">
The <b class="var">sh_info</b> value in the section header.</dd>
</dl>
<p>
On success, the callback function should return the section index value of the created section, and set the location pointed to by argument <i class="arg">index</i> to the symbol table index of the symbol that associated with the newly created section. This symbol table index will be used in relocation entries referring to the created section.<p>
In case of failure, the callback function should return -1 and set the location pointed to by argument <i class="arg">error</i> to an application-defined error code. This application returned error code is currently ignored by the library.<p>
Function <b class="fname">dwarf_producer_init</b>() is deprecated. Function <b class="fname">dwarf_producer_init</b>() is identical to function <b class="fname">dwarf_producer_init_b</b>() except that the callback function it expects can not properly handle arbitrary section symbol index values.<div class="subsection">
<h2 id="x4d656d6f7279204d616e6167656d656e74">Memory Management</h2> The <span class="type">Dwarf_P_Debug</span> instance returned by these functions should be freed using the function <b class="fname">dwarf_producer_finish</b>().</div>
</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> On success, these functions return the created DWARF producer descriptor. In case of an error, they return <span class="define">DW_DLV_BADADDR</span> and set the argument <i class="arg">err</i>.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> These functions can fail with:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_ARGUMENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
Argument <i class="arg">func</i> was NULL.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_ARGUMENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
The flag <span class="define">DW_DLC_WRITE</span> was not set in argument <i class="arg">flags</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_ARGUMENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
The flags <span class="define">DW_DLC_SIZE_32</span> and <span class="define">DW_DLC_SIZE_64</span> were both set in argument <i class="arg">flags</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_ARGUMENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
The flags <span class="define">DW_DLC_ISA_IA64</span> and <span class="define">DW_DLC_ISA_MIPS</span> were both set in argument <i class="arg">flags</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_ARGUMENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
The flags <span class="define">DW_DLC_TARGET_BIGENDIAN</span> and <span class="define">DW_DLC_TARGET_LITTLEENDIAN</span> were both set in argument <i class="arg">flags</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_ARGUMENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
The flags <span class="define">DW_DLC_STREAM_RELOCATIONS</span> and <span class="define">DW_DLC_SYMBOLIC_RELOCATIONS</span> were both set in argument <i class="arg">flags</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_MEMORY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
An out of memory condition was encountered.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> To initialize a <span class="type">Dwarf_P_Debug</span> instance for a MIPS32 big endian object, use:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
Dwarf_P_Debug dbg; 
Dwarf_Unsigned flags; 
Dwarf_Error de; 
 
/* ... assume cb_func points to the callback function ... */ 
 
flags = DW_DLC_WRITE | DW_DLC_SIZE_32 | DW_DLC_ISA_MIPS | 
    DW_DLC_STREAM_RELOCATIONS | DW_DLC_TARGET_BIGENDIAN; 
if ((dbg = dwarf_producer_init(flags, cb_func, NULL, NULL, &amp;de)) == 
    DW_DLV_BADADDR) 
	warnx("dwarf_producer_init failed: %s", dwarf_errmsg(-1));</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/dwarf.html">dwarf(3)</a>, <a class="link-man" href="../html3/dwarf_errmsg.html">dwarf_errmsg(3)</a>, <a class="link-man" href="../html3/dwarf_producer_finish.html">dwarf_producer_finish(3)</a>, <a class="link-man" href="../html3/dwarf_producer_set_isa.html">dwarf_producer_set_isa(3)</a>, <a class="link-man" href="../html3/dwarf_transform_to_disk_form.html">dwarf_transform_to_disk_form(3)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
August 20, 2011</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

