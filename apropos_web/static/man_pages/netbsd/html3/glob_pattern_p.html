<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
GLOB(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
GLOB(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
GLOB(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">glob</b>, <b class="name">globfree</b>, <b class="name">glob_pattern_p</b> &#8212; <span class="desc">generate pathnames matching a pattern</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">glob.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">glob</b>(<i class="farg" style="white-space:nowrap;">const char * restrict pattern</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">int (*errfunc)(const char *, int)</i>, <i class="farg" style="white-space:nowrap;">glob_t * restrict pglob</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">globfree</b>(<i class="farg" style="white-space:nowrap;">glob_t *pglob</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">glob_pattern_p</b>(<i class="farg" style="white-space:nowrap;">const char *pattern</i>, <i class="farg" style="white-space:nowrap;">int quote</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">glob</b>() function is a pathname generator that implements the rules for file name pattern matching used by the shell.<p>
The include file <i class="file">glob.h</i> defines the structure type <i class="farg">glob_t</i>, which contains at least the following fields:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
typedef struct { 
	size_t gl_pathc;	/* count of total paths so far */ 
	size_t gl_matchc;	/* count of paths matching pattern */ 
	size_t gl_offs;		/* reserved at beginning of gl_pathv */ 
	int gl_flags;		/* returned flags */ 
	char **gl_pathv;	/* list of paths matching pattern */ 
} glob_t;</pre>
<p>
The argument <i class="farg">pattern</i> is a pointer to a pathname pattern to be expanded. The <b class="fname">glob</b>() argument matches all accessible pathnames against the pattern and creates a list of the pathnames that match. In order to have access to a pathname, <b class="fname">glob</b>() requires search permission on every component of a path except the last and read permission on each directory of any filename component of <i class="farg">pattern</i> that contains any of the special characters &#8216;<code class="lit">*</code>&#8217;, &#8216;<code class="lit">?</code>&#8217; or &#8216;<code class="lit">[</code>&#8217;.<p>
The <b class="fname">glob</b>() argument stores the number of matched pathnames into the <i class="farg">gl_pathc</i> field, and a pointer to a list of pointers to pathnames into the <i class="farg">gl_pathv</i> field. The first pointer after the last pathname is <span class="define">NULL</span>. If the pattern does not match any pathnames, the returned number of matched paths is set to zero.<p>
It is the caller's responsibility to create the structure pointed to by <i class="farg">pglob</i>. The <b class="fname">glob</b>() function allocates other space as needed, including the memory pointed to by <i class="farg">gl_pathv</i>.<p>
The argument <i class="farg">flags</i> is used to modify the behavior of <b class="fname">glob</b>(). The value of <i class="farg">flags</i> is the bitwise inclusive OR of any of the following values defined in <i class="file">glob.h</i>:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_APPEND</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Append pathnames generated to the ones from a previous call (or calls) to <b class="fname">glob</b>(). The value of <i class="farg">gl_pathc</i> will be the total matches found by this call and the previous call(s). The pathnames are appended to, not merged with the pathnames returned by the previous call(s). Between calls, the caller must not change the setting of the <span class="define">GLOB_DOOFFS</span> flag, nor change the value of <i class="farg">gl_offs</i> when <span class="define">GLOB_DOOFFS</span> is set, nor (obviously) call <b class="fname">globfree</b>() for <i class="farg">pglob</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_DOOFFS</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Make use of the <i class="farg">gl_offs</i> field. If this flag is set, <i class="farg">gl_offs</i> is used to specify how many <span class="define">NULL</span> pointers to prepend to the beginning of the <i class="farg">gl_pathv</i> field. In other words, <i class="farg">gl_pathv</i> will point to <i class="farg">gl_offs</i> <span class="define">NULL</span> pointers, followed by <i class="farg">gl_pathc</i> pathname pointers, followed by a <span class="define">NULL</span> pointer.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_ERR</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Causes <b class="fname">glob</b>() to return when it encounters a directory that it cannot open or read. Ordinarily, <b class="fname">glob</b>() continues to find matches.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_MARK</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Each pathname that is a directory that matches <i class="farg">pattern</i> has a slash appended.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_NOCHECK</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
If <i class="farg">pattern</i> does not match any pathname, then <b class="fname">glob</b>() returns a list consisting of only <i class="farg">pattern</i>, with one level of backslash escapes removed, the number of total pathnames set to 1, and the number of matched pathnames set to 0.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_NOSORT</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
By default, the pathnames are sorted in ascending ASCII order; this flag prevents that sorting (speeding up <b class="fname">glob</b>()).</dd>
</dl>
<p>
The following values may also be included in <i class="farg">flags</i>, however, they are non-standard extensions to IEEE Std 1003.2 (&#8220;POSIX.2&#8221;).<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_ALTDIRFUNC</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
The following additional fields in the pglob structure have been initialized with alternate functions for glob to use to open, read, and close directories and to get stat information on names found in those directories.<p>
<pre style="margin-left: 0.00ex;" class="lit display">
	void *(*gl_opendir)(const char * name); 
	struct dirent *(*gl_readdir)(void *); 
	void (*gl_closedir)(void *); 
	int (*gl_lstat)(const char *name, struct stat *st); 
	int (*gl_stat)(const char *name, struct stat *st);</pre>
<p>
This extension is provided to allow programs such as <a class="link-man" href="../8/restore">restore(8)</a> to provide globbing from directories stored on tape.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_BRACE</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Pre-process the pattern string to expand &#8216;<code class="lit">{pat,pat,...}</code>&#8217; strings like <a class="link-man" href="../1/csh">csh(1)</a>. The pattern &#8216;<code class="lit">{}</code>&#8217; is left unexpanded for historical reasons (<a class="link-man" href="../1/csh">csh(1)</a> does the same thing to ease typing of <a class="link-man" href="../1/find">find(1)</a> patterns).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_LIMIT</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Limit the amount of memory used to store matched strings to <code class="lit">64K</code>, the number of <a class="link-man" href="../2/stat">stat(2)</a> calls to 128, and the number of <a class="link-man" href="../3/readdir">readdir(3)</a> calls to 16K. This option should be set for programs that can be coerced to a denial of service attack via patterns that expand to a very large number of matches, such as a long string of <code class="lit">*/../*/..</code></dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_MAGCHAR</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Set by the <b class="fname">glob</b>() function if the pattern included globbing characters. See the description of the usage of the <i class="farg">gl_matchc</i> structure member for more details.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_NOESCAPE</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Disable the use of the backslash (&#8216;<code class="lit">&#92;</code>&#8217;) character for quoting.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_NOMAGIC</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Is the same as <span class="define">GLOB_NOCHECK</span> but it only appends the <i class="farg">pattern</i> if it does not contain any of the special characters ``*'', ``?'' or ``[''. <span class="define">GLOB_NOMAGIC</span> is provided to simplify implementing the historic <a class="link-man" href="../1/csh">csh(1)</a> globbing behavior and should probably not be used anywhere else.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_NO_DOTDIRS</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Hide &#8216;<code class="lit">.</code>&#8217; and &#8216;<code class="lit">..</code>&#8217; from metacharacter matches, regardless of whether <span class="define">GLOB_PERIOD</span> is set and whether the pattern component begins with a literal period.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_PERIOD</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Allow metacharacters to match a leading period in a filename.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_STAR</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Indicates that two adjacent <code class="lit">*</code> characters will do a recursive match in all subdirs, without following symbolic links and three adjacent <code class="lit">*</code> characters will also follow symbolic links.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_TILDE</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Expand patterns that start with &#8216;<code class="lit">~</code>&#8217; to user name home directories.</dd>
</dl>
<p>
If, during the search, a directory is encountered that cannot be opened or read and <i class="farg">errfunc</i> is non-<span class="define">NULL</span>, <b class="fname">glob</b>() calls <i class="farg">(*errfunc)(path, errno)</i>. This may be unintuitive: a pattern like &#8216;<code class="lit">*/Makefile</code>&#8217; will try to <a class="link-man" href="../2/stat">stat(2)</a> &#8216;<code class="lit">foo/Makefile</code>&#8217; even if &#8216;<code class="lit">foo</code>&#8217; is not a directory, resulting in a call to <i class="farg">errfunc</i>. The error routine can suppress this action by testing for <span class="define">ENOENT</span> and <span class="define">ENOTDIR</span>; however, the <span class="define">GLOB_ERR</span> flag will still cause an immediate return when this happens.<p>
If <i class="farg">errfunc</i> returns non-zero, <b class="fname">glob</b>() stops the scan and returns <span class="define">GLOB_ABORTED</span> after setting <i class="farg">gl_pathc</i> and <i class="farg">gl_pathv</i> to reflect any paths already matched. This also happens if an error is encountered and <span class="define">GLOB_ERR</span> is set in <i class="farg">flags</i>, regardless of the return value of <i class="farg">errfunc</i>, if called. If <span class="define">GLOB_ERR</span> is not set and either <i class="farg">errfunc</i> is <span class="define">NULL</span> or <i class="farg">errfunc</i> returns zero, the error is ignored.<p>
The <b class="fname">globfree</b>() function frees any space associated with <i class="farg">pglob</i> from a previous call(s) to <b class="fname">glob</b>().<p>
The <b class="fname">glob_pattern_p</b>() returns <span class="define">1</span> if the <i class="farg">pattern</i> has any special characters that <b class="fname">glob</b>() will interpret and <span class="define">0</span> otherwise. If the <i class="farg">quote</i> argument is non-zero, then backslash quoted characters are ignored.<p>
The historical <span class="define">GLOB_QUOTE</span> flag is no longer supported. Per IEEE Std 1003.2-1992 (&#8220;POSIX.2&#8221;), backslash escaping of special characters is the default behaviour; it may be disabled by specifying the <span class="define">GLOB_NOESCAPE</span> flag.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> On successful completion, <b class="fname">glob</b>() returns zero. In addition the fields of <i class="farg">pglob</i> contain the values described below:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">gl_pathc</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
contains the total number of matched pathnames so far. This includes other matches from previous invocations of <b class="fname">glob</b>() if <span class="define">GLOB_APPEND</span> was specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">gl_matchc</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
contains the number of matched pathnames in the current invocation of <b class="fname">glob</b>().</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">gl_flags</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
contains a copy of the <i class="farg">flags</i> parameter with the bit <span class="define">GLOB_MAGCHAR</span> set if <i class="farg">pattern</i> contained any of the special characters ``*'', ``?'' or ``['', cleared if not.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="farg">gl_pathv</i></dt>
<dd class="list-tag" style="margin-left: 12.00ex;">
contains a pointer to a <span class="define">NULL</span>-terminated list of matched pathnames. However, if <i class="farg">gl_pathc</i> is zero, the contents of <i class="farg">gl_pathv</i> are undefined.</dd>
</dl>
<p>
If <b class="fname">glob</b>() terminates due to an error, it sets <b class="var">errno</b> and returns one of the following non-zero constants, which are defined in the include file <b class="includes">&lt;<a class="link-includes">glob.h</a>&gt;</b>:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_ABORTED</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
The scan was stopped because an error was encountered and either <span class="define">GLOB_ERR</span> was set or <i class="farg">(*errfunc)()</i> returned non-zero.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_NOMATCH</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
The pattern does not match any existing pathname, and <span class="define">GLOB_NOCHECK</span> was not set in <span class="define">flags</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">GLOB_NOSPACE</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
An attempt to allocate memory failed, or if <b class="var">errno</b> was 0 <code class="lit">GLOB_LIMIT</code> was specified in the flags and <code class="lit">ARG_MAX</code> patterns were matched.</dd>
</dl>
<p>
The historical <span class="define">GLOB_ABEND</span> return constant is no longer supported. Portable applications should use the <span class="define">GLOB_ABORTED</span> constant instead.<p>
The arguments <i class="farg">pglob&#45;&gt;gl_pathc</i> and <i class="farg">pglob&#45;&gt;gl_pathv</i> are still set as specified above.</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<span class="env">HOME</span></dt>
<dd class="list-tag" style="margin-left: 4.00ex;">
If defined, used as the home directory of the current user in tilde expansions.</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> A rough equivalent of &#8216;<code class="lit">ls -l *.c *.h</code>&#8217; can be obtained with the following code:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
glob_t g; 
 
g.gl_offs = 2; 
glob("*.c", GLOB_DOOFFS, NULL, &amp;g); 
glob("*.h", GLOB_DOOFFS | GLOB_APPEND, NULL, &amp;g); 
g.gl_pathv[0] = "ls"; 
g.gl_pathv[1] = "-l"; 
execvp("ls", g.gl_pathv);</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/sh">sh(1)</a>, <a class="link-man" href="../3/fnmatch">fnmatch(3)</a>, <a class="link-man" href="../3/regexp">regexp(3)</a>, <a class="link-man" href="../7/glob">glob(7)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">glob</b>() function is expected to be IEEE Std 1003.2 (&#8220;POSIX.2&#8221;) compatible with the exception that the flags <span class="define">GLOB_ALTDIRFUNC</span>, <span class="define">GLOB_BRACE</span>, <span class="define">GLOB_LIMIT</span>, <span class="define">GLOB_MAGCHAR</span>, <span class="define">GLOB_NOESCAPE</span>, <span class="define">GLOB_NOMAGIC</span>, <span class="define">GLOB_NO_DOTDIRS</span>, <span class="define">GLOB_PERIOD</span>, <span class="define">GLOB_STAR</span>, <span class="define">GLOB_TILDE</span>, and the fields <i class="farg">gl_matchc</i> and <i class="farg">gl_flags</i> should not be used by applications striving for strict POSIX conformance.</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="fname">glob</b>() and <b class="fname">globfree</b>() functions first appeared in <span class="unix">4.4BSD</span>. The <b class="fname">glob_pattern_p</b>() function is modelled after the one found in glibc.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> Patterns longer than <span class="define">MAXPATHLEN</span> may cause unchecked errors.<p>
The <b class="fname">glob</b>() function may fail and set <b class="var">errno</b> for any of the errors specified for the library routines <a class="link-man" href="../2/stat">stat(2)</a>, <a class="link-man" href="../3/closedir">closedir(3)</a>, <a class="link-man" href="../3/opendir">opendir(3)</a>, <a class="link-man" href="../3/readdir">readdir(3)</a>, <a class="link-man" href="../3/malloc">malloc(3)</a>, and <a class="link-man" href="../3/free">free(3)</a>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 27, 2012</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

