<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
GETPWENT(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
GETPWENT(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
GETPWENT(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">getpwent</b>, <b class="name">getpwent_r</b>, <b class="name">getpwnam</b>, <b class="name">getpwnam_r</b>, <b class="name">getpwuid</b>, <b class="name">getpwuid_r</b>, <b class="name">setpassent</b>, <b class="name">setpwent</b>, <b class="name">endpwent</b> &#8212; <span class="desc">password database operations</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">pwd.h</a>&gt;</b><p>
<i class="ftype">struct passwd *</i><br>
<b class="fname">getpwent</b>(<i class="farg" style="white-space:nowrap;">void</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">getpwent_r</b>(<i class="farg">struct passwd *pw</i>, <i class="farg">char *buffer</i>, <i class="farg">size_t buflen</i>, <i class="farg">struct passwd **result</i>);<p>
<i class="ftype">struct passwd *</i><br>
<b class="fname">getpwnam</b>(<i class="farg" style="white-space:nowrap;">const char *name</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">getpwnam_r</b>(<i class="farg">const char *name</i>, <i class="farg">struct passwd *pw</i>, <i class="farg">char *buffer</i>, <i class="farg">size_t buflen</i>, <i class="farg">struct passwd **result</i>);<p>
<i class="ftype">struct passwd *</i><br>
<b class="fname">getpwuid</b>(<i class="farg" style="white-space:nowrap;">uid_t uid</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">getpwuid_r</b>(<i class="farg">uid_t uid</i>, <i class="farg">struct passwd *pw</i>, <i class="farg">char *buffer</i>, <i class="farg">size_t buflen</i>, <i class="farg">struct passwd **result</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">setpassent</b>(<i class="farg" style="white-space:nowrap;">int stayopen</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">setpwent</b>(<i class="farg" style="white-space:nowrap;">void</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">endpwent</b>(<i class="farg" style="white-space:nowrap;">void</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> These functions operate on the password database which is described in <a class="link-man" href="../5/passwd">passwd(5)</a>. Each entry in the database is defined by the structure <i class="arg">passwd</i> found in the include file <b class="includes">&lt;<a class="link-includes">pwd.h</a>&gt;</b>:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
struct passwd { 
	char	*pw_name;	/* user name */ 
	char	*pw_passwd;	/* encrypted password */ 
	uid_t	pw_uid;		/* user uid */ 
	gid_t	pw_gid;		/* user gid */ 
	time_t	pw_change;	/* password change time */ 
	char	*pw_class;	/* user login class */ 
	char	*pw_gecos;	/* general information */ 
	char	*pw_dir;	/* home directory */ 
	char	*pw_shell;	/* default shell */ 
	time_t	pw_expire;	/* account expiration */ 
};</pre>
<p>
The functions <b class="fname">getpwnam</b>() and <b class="fname">getpwuid</b>() search the password database for the given user name pointed to by <i class="arg">name</i> or user id pointed to by <i class="arg">uid</i> respectively, always returning the first one encountered. Identical user names or user ids may result in undefined behavior.<p>
The <b class="fname">getpwent</b>() function sequentially reads the password database and is intended for programs that wish to process the complete list of users.<p>
The functions <b class="fname">getpwnam_r</b>(), <b class="fname">getpwuid_r</b>(), and <b class="fname">getpwent_r</b>() act like their non re-entrant counterparts, updating the contents of <i class="arg">pw</i> and storing a pointer to that in <i class="arg">result</i>, and returning <span class="define">0</span>. Storage used by <i class="arg">pw</i> is allocated from <i class="arg">buffer</i>, which is <i class="arg">buflen</i> bytes in size. If the requested entry cannot be found, <i class="arg">result</i> will point to <span class="define">NULL</span> and <span class="define">0</span> will be returned. If an error occurs, a non-zero error number will be returned and <i class="arg">result</i> will point to <span class="define">NULL</span>. Calling <b class="fname">getpwent_r</b>() from multiple threads will result in each thread reading a disjoint portion of the password database.<p>
The <b class="fname">setpassent</b>() function accomplishes two purposes. First, it causes <b class="fname">getpwent</b>() to &#8220;rewind&#8221; to the beginning of the database. Additionally, if <i class="farg">stayopen</i> is non-zero, file descriptors are left open, significantly speeding up subsequent accesses for all of the functions. (This latter functionality is unnecessary for <b class="fname">getpwent</b>() as it doesn't close its file descriptors by default.)<p>
It is dangerous for long-running programs to keep the file descriptors open as the database will become out of date if it is updated while the program is running.<p>
The <b class="fname">setpwent</b>() function is equivalent to <b class="fname">setpassent</b>() with an argument of zero.<p>
The <b class="fname">endpwent</b>() function closes any open files.<p>
These functions have been written to &#8220;shadow&#8221; the password file, e.g. allow only certain programs to have access to the encrypted password. If the process which calls them has an effective uid of 0, the encrypted password will be returned, otherwise, the password field of the returned structure will point to the string &#8216;<code class="lit">*</code>&#8217;.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> The functions <b class="fname">getpwent</b>(), <b class="fname">getpwnam</b>(), and <b class="fname">getpwuid</b>(), return a valid pointer to a passwd structure on success and a <span class="define">NULL</span> pointer if the entry was not found or an error occured. If an error occured, the global variable <span class="define">errno</span> is set to indicate the nature of the failure. The <b class="fname">setpassent</b>() function returns 0 on failure, setting the global variable <span class="define">errno</span> to indicate the nature of the failure, and 1 on success. The <b class="fname">endpwent</b>() and <b class="fname">setpwent</b>() functions have no return value. The functions <b class="fname">getpwnam_r</b>(), <b class="fname">getpwuid_r</b>(), and <b class="fname">getpwent_r</b>() return <span class="define">0</span> on success or entry not found, and non-zero on failure, setting the global variable <span class="define">errno</span> to indicate the nature of the failure.</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/pwd.db</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
The insecure password database file</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/spwd.db</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
The secure password database file</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/master.passwd</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
The current password file</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<i class="file">/etc/passwd</i></dt>
<dd class="list-tag" style="margin-left: 18.00ex;">
A Version 7 format password file</dd>
</dl>
</div>
<div class="section">
<h1 id="x434f4d5041544942494c495459">COMPATIBILITY</h1> The historic function <b class="fname">setpwfile</b>() which allowed the specification of alternative password databases, has been deprecated and is no longer available.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> The following error codes may be set in <b class="var">errno</b> for <b class="name">getpwent</b>, <b class="name">getpwent_r</b>, <b class="name">getpwnam</b>, <b class="name">getpwnam_r</b>, <b class="name">getpwuid</b>, <b class="name">getpwuid_r</b>, and <b class="name">setpassent</b>:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINTR</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A signal was caught during the database search.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EIO</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An I/O error has occurred.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EMFILE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The limit on open files for this process has been reached.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENFILE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The system limit on open files has been reached.</dd>
</dl>
<p>
The following error code may be set in <b class="var">errno</b> for <b class="name">getpwent_r</b>, <b class="name">getpwnam_r</b>, and <b class="name">getpwuid_r</b>:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ERANGE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The resulting <i class="ftype">struct passwd</i> does not fit in the space defined by <span class="define">buffer</span> and <span class="define">buflen</span></dd>
</dl>
<p>
Other <span class="define">errno</span> values may be set depending on the specific database backends.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/getlogin">getlogin(2)</a>, <a class="link-man" href="../3/getgrent">getgrent(3)</a>, <a class="link-man" href="../5/nsswitch.conf">nsswitch.conf(5)</a>, <a class="link-man" href="../5/passwd">passwd(5)</a>, <a class="link-man" href="../5/passwd.conf">passwd.conf(5)</a>, <a class="link-man" href="../8/pwd_mkdb">pwd_mkdb(8)</a>, <a class="link-man" href="../8/vipw">vipw(8)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">getpwnam</b>() and <b class="fname">getpwuid</b>(), functions conform to IEEE Std 1003.1-1990 (&#8220;POSIX.1&#8221;). The <b class="fname">getpwnam_r</b>() and <b class="fname">getpwuid_r</b>() functions conform to IEEE Std 1003.1c-1995 (&#8220;POSIX.1c&#8221;). The <b class="fname">endpwent</b>(), <b class="fname">getpwent</b>(), and <b class="fname">setpwent</b>() functions conform to X/Open Portability Guide Issue&#160;4, Version&#160;2 (&#8220;XPG4.2&#8221;) and IEEE Std 1003.1-2004 (&#8220;POSIX.1&#8221;) (XSI extension).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">getpwent</b>, <b class="name">getpwnam</b>, <b class="name">getpwuid</b>, <b class="name">setpwent</b>, and <b class="name">endpwent</b> functions appeared in Version&#160;7 AT&amp;T UNIX. The <b class="name">setpassent</b> function appeared in <span class="unix">4.3BSD-Reno</span>. The functions <b class="fname">getpwnam_r</b>() and <b class="fname">getpwuid_r</b>() appeared in <span class="unix">NetBSD&#160;3.0</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> The functions <b class="fname">getpwent</b>(), <b class="fname">getpwnam</b>(), and <b class="fname">getpwuid</b>(), leave their results in an internal static object and return a pointer to that object. Subsequent calls to any of these functions will modify the same object.<p>
The functions <b class="fname">getpwent</b>(), <b class="fname">endpwent</b>(), <b class="fname">setpassent</b>(), and <b class="fname">setpwent</b>() are fairly useless in a networked environment and should be avoided, if possible. <b class="fname">getpwent</b>() makes no attempt to suppress duplicate information if multiple sources are specified in <a class="link-man" href="../5/nsswitch.conf">nsswitch.conf(5)</a>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 30, 2008</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

