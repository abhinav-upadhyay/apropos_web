<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
hmac(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
hmac(3)</td>
<td class="head-vol" align="center">
OpenSSL</td>
<td class="head-rtitle" align="right">
hmac(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> HMAC, HMAC_Init, HMAC_Update, HMAC_Final, HMAC_cleanup &#45; HMAC message authentication code</div>
<div class="section">
<h1>LIBRARY</h1> libcrypto, -lcrypto</div>
<div class="section">
<h1>SYNOPSIS</h1><br>
 #include &lt;openssl/hmac.h&gt;<br>
<br>
 unsigned char *HMAC(const EVP_MD *evp_md, const void *key,<br>
               int key_len, const unsigned char *d, int n,<br>
               unsigned char *md, unsigned int *md_len);<br>
<br>
 void HMAC_CTX_init(HMAC_CTX *ctx);<br>
<br>
 int HMAC_Init(HMAC_CTX *ctx, const void *key, int key_len,<br>
               const EVP_MD *md);<br>
 int HMAC_Init_ex(HMAC_CTX *ctx, const void *key, int key_len,<br>
                   const EVP_MD *md, ENGINE *impl);<br>
 int HMAC_Update(HMAC_CTX *ctx, const unsigned char *data, int len);<br>
 int HMAC_Final(HMAC_CTX *ctx, unsigned char *md, unsigned int *len);<br>
<br>
 void HMAC_CTX_cleanup(HMAC_CTX *ctx);<br>
 void HMAC_cleanup(HMAC_CTX *ctx);<br>
</div>
<div class="section">
<h1>DESCRIPTION</h1> HMAC is a MAC (message authentication code), i.e. a keyed hash function used for message authentication, which is based on a hash function.<p>
<i>HMAC()</i> computes the message authentication code of the <b>n</b> bytes at  <b>d</b> using the hash function <b>evp_md</b> and the key <b>key</b> which is  <b>key_len</b> bytes long.<p>
It places the result in <b>md</b> (which must have space for the output of the hash function, which is no more than  <b>EVP_MAX_MD_SIZE</b> bytes). If  <b>md</b> is NULL, the digest is placed in a static array.  The size of the output is placed in  <b>md_len</b>, unless it is <b>NULL</b>.<p>
<b>evp_md</b> can be <i>EVP_sha1()</i>, <i>EVP_ripemd160()</i> etc.<p>
<i>HMAC_CTX_init()</i> initialises a <b>HMAC_CTX</b> before first use. It must be called.<p>
<i>HMAC_CTX_cleanup()</i> erases the key and other data from the <b>HMAC_CTX</b> and releases any associated resources. It must be called when an  <b>HMAC_CTX</b> is no longer required.<p>
<i>HMAC_cleanup()</i> is an alias for <i>HMAC_CTX_cleanup()</i> included for back compatibility with 0.9.6b, it is deprecated.<p>
The following functions may be used if the message is not completely stored in memory:<p>
<i>HMAC_Init()</i> initializes a <b>HMAC_CTX</b> structure to use the hash function  <b>evp_md</b> and the key <b>key</b> which is <b>key_len</b> bytes long. It is deprecated and only included for backward compatibility with OpenSSL 0.9.6b.<p>
<i>HMAC_Init_ex()</i> initializes or reuses a <b>HMAC_CTX</b> structure to use the function  <b>evp_md</b> and key <b>key</b>. Either can be NULL, in which case the existing one will be reused.  <i>HMAC_CTX_init()</i> must have been called before the first use of an  <b>HMAC_CTX</b> in this function.  <b>N.B. </b><b><i>HMAC_Init()</i></b><b> had this undocumented behaviour in</b>  <b>previous versions of OpenSSL &#45; failure to switch to </b><b><i>HMAC_Init_ex()</i></b><b> in</b>  <b>programs that expect it will cause them to stop working</b>.<p>
<i>HMAC_Update()</i> can be called repeatedly with chunks of the message to be authenticated ( <b>len</b> bytes at <b>data</b>).<p>
<i>HMAC_Final()</i> places the message authentication code in <b>md</b>, which must have space for the hash function output.</div>
<div class="section">
<h1>RETURN VALUES</h1>  <i>HMAC()</i> returns a pointer to the message authentication code or NULL if an error occurred.<p>
<i>HMAC_Init_ex()</i>, <i>HMAC_Update()</i> and <i>HMAC_Final()</i> return 1 for success or 0 if an error occurred.<p>
<i>HMAC_CTX_init()</i> and <i>HMAC_CTX_cleanup()</i> do not return values.</div>
<div class="section">
<h1>CONFORMING TO</h1> RFC 2104</div>
<div class="section">
<h1>SEE ALSO</h1>  <i>openssl_sha</i>(3), <i>openssl_evp</i>(3)</div>
<div class="section">
<h1>HISTORY</h1>  <i>HMAC()</i>, <i>HMAC_Init()</i>, <i>HMAC_Update()</i>, <i>HMAC_Final()</i> and <i>HMAC_cleanup()</i> are available since SSLeay 0.9.0.<p>
<i>HMAC_CTX_init()</i>, <i>HMAC_Init_ex()</i> and <i>HMAC_CTX_cleanup()</i> are available since OpenSSL 0.9.7.<p>
<i>HMAC_Init_ex()</i>, <i>HMAC_Update()</i> and <i>HMAC_Final()</i> did not return values in versions of OpenSSL before 1.0.0.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
2009-12-26</td>
<td class="foot-os" align="right">
1.0.1n</td>
</tr>
</table>
</div>
</body>
</html>

