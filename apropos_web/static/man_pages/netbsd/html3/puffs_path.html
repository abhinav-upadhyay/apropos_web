<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
PUFFS_PATH(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
PUFFS_PATH(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
PUFFS_PATH(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">puffs_path</b> &#8212; <span class="desc">puffs pathbuilding routines</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">puffs Convenience Library (libpuffs, &#45;lpuffs)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">puffs.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">pu_pathbuild_fn</b>(<i class="farg">struct puffs_usermount *pu</i>, <i class="farg">const struct puffs_pathobj *po_dir</i>, <i class="farg">const struct puffs_pathobj *po_comp</i>, <i class="farg">size_t offset</i>, <i class="farg">struct puffs_pathobj *po_new</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">pu_pathtransform_fn</b>(<i class="farg">struct puffs_usermount *pu</i>, <i class="farg">const struct puffs_pathobj *po_base</i>, <i class="farg">const struct puffs_cn *pcn</i>, <i class="farg">struct puffs_pathobj *po_new</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">pu_pathcmp_fn</b>(<i class="farg">struct puffs_usermount *pu</i>, <i class="farg">struct puffs_pathobj *po1</i>, <i class="farg">struct puffs_pathobj *po2</i>, <i class="farg">size_t checklen</i>, <i class="farg">int checkprefix</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">pu_pathfree_fn</b>(<i class="farg" style="white-space:nowrap;">struct puffs_usermount *pu</i>, <i class="farg" style="white-space:nowrap;">struct puffs_pathobj *po</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">pu_namemod_fn</b>(<i class="farg">struct puffs_usermount *pu</i>, <i class="farg">struct puffs_pathobj *po_dir</i>, <i class="farg">struct puffs_cn *pcn</i>);<p>
<i class="ftype">struct puffs_pathobj *</i><br>
<b class="fname">puffs_getrootpathobj</b>(<i class="farg" style="white-space:nowrap;">struct puffs_usermount *pu</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The puffs library has the ability to provide full pathnames for backends which require them. Normal file systems should be constructed without the file system node tied to a file name and should not used routines described herein. An example of a file system where the backend requires filenames is <a class="link-man" href="../8/mount_psshfs">mount_psshfs(8)</a>.<p>
The features described here are enabled by passing <span class="define">PUFFS_FLAG_BUILDPATH</span> to <b class="fname">puffs_init</b>(). This facility requires to use puffs nodes to store the contents of the pathname. Either the address of the operation cookie must directly be that of the puffs node, or <b class="fname">puffs_set_cmap</b>() must be used to set a mapping function from the cookie to the puffs node associated with the cookie. Finally, the root node for the file system must be set using <b class="fname">puffs_setroot</b>() and the root path object retrieved using <b class="fname">puffs_getrootpathobj</b>() and initialized.<p>
There are two different places a filename can be retrieved from. It is available for each puffs node after the node has been registered with the framework, i.e. <span class="emph">after</span> the routine creating the node returns. In other words, there is a window between the node is created and when the pathname is available and multithreaded file systems must take this into account. The second place where a pathname is available is from the componentname <span class="type">struct puffs_pcn</span> in operations which are passed one. These can be retrieved using the convenience macros <b class="fname">PNPATH</b>() and <b class="fname">PCNPATH</b>() for node and componentname, respectively. The type of object they return is <span class="type">void *</span>.<p>
By default the framework manages "regular" filenames, which consist of directory names separated by "/" and a final component. If the file system wishes to use pathnames of this format, all it has to do it enable the feature. Everything else, including bookkeeping for node and directory renames, is done by the library. The callback routines described next provide the ability to build non-standard pathnames. A <b class="fname">pu_foo_fn</b>() callback is set using the <b class="fname">puffs_set_foo</b>() routine.<p>
This manual page is still unfinished. Please take a number and wait in line.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/puffs">puffs(3)</a>, <a class="link-man" href="../3/puffs_node">puffs_node(3)</a>, <a class="link-man" href="../8/mount_psshfs">mount_psshfs(8)</a>, <a class="link-man" href="../8/mount_sysctlfs">mount_sysctlfs(8)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 27, 2007</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

