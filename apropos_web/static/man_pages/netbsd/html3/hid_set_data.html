<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
USBHID(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
USBHID(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
USBHID(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">usbhid</b>, <b class="name">hid_get_report_desc</b>, <b class="name">hid_use_report_desc</b>, <b class="name">hid_dispose_report_desc</b>, <b class="name">hid_start_parse</b>, <b class="name">hid_end_parse</b>, <b class="name">hid_get_item</b>, <b class="name">hid_report_size</b>, <b class="name">hid_locate</b>, <b class="name">hid_usage_page</b>, <b class="name">hid_usage_in_page</b>, <b class="name">hid_init</b>, <b class="name">hid_get_data</b>, <b class="name">hid_set_data</b> &#8212; <span class="desc">USB HID access routines</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">USB Human Interface Devices Library (libusbhid, &#45;lusbhid)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">usbhid.h</a>&gt;</b><p>
<i class="ftype">report_desc_t</i><br>
<b class="fname">hid_get_report_desc</b>(<i class="farg" style="white-space:nowrap;">int file</i>);<p>
<i class="ftype">report_desc_t</i><br>
<b class="fname">hid_use_report_desc</b>(<i class="farg" style="white-space:nowrap;">const uint8_t *data</i>, <i class="farg" style="white-space:nowrap;">unsigned int size</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">hid_dispose_report_desc</b>(<i class="farg" style="white-space:nowrap;">report_desc_t d</i>);<p>
<i class="ftype">hid_data_t</i><br>
<b class="fname">hid_start_parse</b>(<i class="farg" style="white-space:nowrap;">report_desc_t d</i>, <i class="farg" style="white-space:nowrap;">int kindset</i>, <i class="farg" style="white-space:nowrap;">int id</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">hid_end_parse</b>(<i class="farg" style="white-space:nowrap;">hid_data_t s</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">hid_get_item</b>(<i class="farg" style="white-space:nowrap;">hid_data_t s</i>, <i class="farg" style="white-space:nowrap;">hid_item_t *h</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">hid_report_size</b>(<i class="farg" style="white-space:nowrap;">report_desc_t d</i>, <i class="farg" style="white-space:nowrap;">hid_kind_t k</i>, <i class="farg" style="white-space:nowrap;">int id</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">hid_locate</b>(<i class="farg" style="white-space:nowrap;">report_desc_t d</i>, <i class="farg" style="white-space:nowrap;">u_int usage</i>, <i class="farg" style="white-space:nowrap;">hid_kind_t k</i>, <i class="farg" style="white-space:nowrap;">hid_item_t *h</i>, <i class="farg" style="white-space:nowrap;">int id</i>);<p>
<i class="ftype">char *</i><br>
<b class="fname">hid_usage_page</b>(<i class="farg" style="white-space:nowrap;">int i</i>);<p>
<i class="ftype">char *</i><br>
<b class="fname">hid_usage_in_page</b>(<i class="farg" style="white-space:nowrap;">u_int u</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">hid_parse_usage_page</b>(<i class="farg" style="white-space:nowrap;">const char *</i>);<p>
<i class="ftype">char *</i><br>
<b class="fname">hid_parse_usage_in_page</b>(<i class="farg" style="white-space:nowrap;">const char *</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">hid_init</b>(<i class="farg" style="white-space:nowrap;">const char *file</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">hid_get_data</b>(<i class="farg" style="white-space:nowrap;">const void *data</i>, <i class="farg" style="white-space:nowrap;">const hid_item_t *h</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">hid_set_data</b>(<i class="farg" style="white-space:nowrap;">void *data</i>, <i class="farg" style="white-space:nowrap;">const hid_item_t *h</i>, <i class="farg" style="white-space:nowrap;">u_int data</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="name">usbhid</b> library provides routines to extract data from USB Human Interface Devices.<div class="subsection">
<h2 id="x494e54524f44554354494f4e">INTRODUCTION</h2> USB HID devices send and receive data laid out in a device dependent way. The <b class="name">usbhid</b> library contains routines to extract the <span class="emph">report descriptor</span> which contains the data layout information and then use this information.<p>
The routines can be divided into four parts: extraction of the descriptor, parsing of the descriptor, translating to/from symbolic names, and data manipulation.</div>
<div class="subsection">
<h2 id="x44455343524950544f522046554e4354494f4e53">DESCRIPTOR FUNCTIONS</h2> A report descriptor can be obtained by calling <b class="fname">hid_get_report_desc</b>() with a file descriptor obtained by opening a <a class="link-man" href="../4/uhid">uhid(4)</a> device. Alternatively a data buffer containing the report descriptor can be passed into <b class="fname">hid_use_report_desc</b>(). The data is copied into an internal structure. When the report descriptor is no longer needed it should be freed by calling <b class="fname">hid_dispose_report_desc</b>(). The type <i class="farg">report_desc_t</i> is opaque and should be used when calling the parsing functions. If <b class="fname">hid_dispose_report_desc</b>() fails it will return <i class="farg">NULL</i>.</div>
<div class="subsection">
<h2 id="x44455343524950544f522050415253494e472046554e4354494f4e53">DESCRIPTOR PARSING FUNCTIONS</h2> To parse the report descriptor the <b class="fname">hid_start_parse</b>() function should be called with a report descriptor and a set that describes which items that are interesting. The set is obtained by or-ing together values <i class="farg">(1 &lt;&lt; k)</i> where <i class="farg">k</i> is an item of type <i class="farg">hid_kind_t</i>. The report ID (if present) is given by <i class="farg">id</i>. The function returns <i class="farg">NULL</i> if the initialization fails, otherwise an opaque value to be used in subsequent calls. After parsing the <b class="fname">hid_end_parse</b>() function should be called to free internal data structures.<p>
To iterate through all the items in the report descriptor, <b class="fname">hid_get_item</b>() should be called while it returns a value greater than 0. When the report descriptor ends it will return 0; a syntax error within the report descriptor will cause a return value less than 0. The struct pointed to by <i class="farg">h</i> will be filled with the relevant data for the item. The definition of <i class="farg">hid_item_t</i> can be found in <b class="includes">&lt;<a class="link-includes">usbhid.h</a>&gt;</b> and the meaning of the components in the USB HID documentation.<p>
Data should be read/written to the device in the size of the report. The size of a report (of a certain kind) can be computed by the <b class="fname">hid_report_size</b>() function. If the report is prefixed by an ID byte it is given by <i class="farg">id</i>.<p>
To locate a single item the <b class="fname">hid_locate</b>() function can be used. It should be given the usage code of the item and its kind and it will fill the item and return non-zero if the item was found.</div>
<div class="subsection">
<h2 id="x4e414d45205452414e534c4154494f4e2046554e4354494f4e53">NAME TRANSLATION FUNCTIONS</h2> The function <b class="fname">hid_usage_page</b>() will return the symbolic name of a usage page, and the function <b class="fname">hid_usage_in_page</b>() will return the symbolic name of the usage within the page. Both these functions may return a pointer to static data.<p>
The functions <b class="fname">hid_parse_usage_page</b>() and <b class="fname">hid_parse_usage_in_page</b>() are the inverses of <b class="fname">hid_usage_page</b>() and <b class="fname">hid_usage_in_page</b>(). They take a usage string and return the number of the usage, or -1 if it cannot be found.<p>
Before any of these functions can be called the usage table must be parsed, this is done by calling <b class="fname">hid_init</b>() with the name of the table. Passing <i class="farg">NULL</i> to this function will cause it to use the default table.</div>
<div class="subsection">
<h2 id="x444154412045585452414354494f4e2046554e4354494f4e53">DATA EXTRACTION FUNCTIONS</h2> Given the data obtained from a HID device and an item in the report descriptor the <b class="fname">hid_get_data</b>() function extracts the value of the item. Conversely <b class="fname">hid_set_data</b>() can be used to put data into a report (which must be zeroed first).</div>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1> <i class="file">/usr/share/misc/usb_hid_usages</i> The default HID usage table.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../4/uhid">uhid(4)</a>, <a class="link-man" href="../4/usb">usb(4)</a><p>
<a class="link-ext" href="http://www.usb.org/developers/docs/">USB Specifications</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The <b class="name">usbhid</b> library first appeared in <span class="unix">NetBSD&#160;1.5</span> as <b class="name">usb</b> library and was renamed to <b class="name">usbhid</b> for <span class="unix">NetBSD&#160;1.6</span>.</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> This man page is woefully incomplete.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 12, 2010</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

