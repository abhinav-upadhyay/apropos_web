<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
DWARF_GET_RELOCATION_INFO(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
DWARF_GET_RELOCATION_INFO(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
DWARF_GET_RELOCATION_INFO(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">dwarf_get_relocation_info</b> &#8212; <span class="desc">retrieve generated relocation arrays</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">DWARF Access Library (libdwarf, &#45;ldwarf)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">libdwarf.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">dwarf_get_relocation_info</b>(<i class="farg">Dwarf_P_Debug dbg</i>, <i class="farg">Dwarf_Signed *elf_section_index</i>, <i class="farg">Dwarf_Signed *elf_section_link</i>, <i class="farg">Dwarf_Unsigned *reloc_entry_count</i>, <i class="farg">Dwarf_Relocation_Data *reloc_buf</i>, <i class="farg">Dwarf_Error *err</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The function <b class="fname">dwarf_get_relocation_info</b>() is used to retrieve the relocation arrays generated by a prior call to <a class="link-man" href="../html3/dwarf_transform_to_disk_form.html">dwarf_transform_to_disk_form(3)</a>.<p>
Each call to this function retrieves the next available relocation array. Application code should call this function repeatly to retrieve all the relocation arrays. The total number of generated relocation arrays retrievable by this function may be obtained by calling function <a class="link-man" href="../html3/dwarf_get_relocation_info_count.html">dwarf_get_relocation_info_count(3)</a>.<p>
Argument <i class="arg">dbg</i> should reference a DWARF producer instance allocated using <a class="link-man" href="../html3/dwarf_producer_init.html">dwarf_producer_init(3)</a> in sequence. or <a class="link-man" href="../html3/dwarf_producer_init_b.html">dwarf_producer_init_b(3)</a>. The <span class="define">DW_DLC_SYMBOLIC_RELOCATIONS</span> flag should have been set on the DWARF producer instance.<p>
Argument <i class="arg">elf_section_index</i> should point to a location which will be set to the ELF section index of the relocation section to which the retrieved relocation array belongs.<p>
Argument <i class="arg">elf_section_link</i> should point to a location which will be set to the section index of the ELF section to which the retrieved relocation array applies.<p>
Argument <i class="arg">reloc_entry_count</i> should point to a location which will be set to the total number of relocation entries contained in the relocation array.<p>
Argument <i class="arg">reloc_buf</i> should point to a location which will be set to a pointer to the retrieved array of relocation entries.<p>
If argument <i class="arg">err</i> is not NULL, it will be used to store error information in case of an error.<p>
The retrieved relocation entries are described using structure <span class="type">Dwarf_Relocation_Data_s</span>, defined in the header file <b class="includes">&lt;<a class="link-includes">libdwarf.h</a>&gt;</b>:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
typedef struct Dwarf_Relocation_Data_s { 
	unsigned char drd_type; 
	unsigned char drd_length; 
	Dwarf_Unsigned drd_offset; 
	Dwarf_Unsigned drd_symbol_index; 
} *Dwarf_Relocation_Data;</pre>
<p>
Struct <span class="type">Dwarf_Relocation_Data_s</span> consists of following fields:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-tag">
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">drd_type</b></dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
The type code of the relocation entry. The <span class="type">Dwarf_Rel_Type</span> enumeration defined in the header file <b class="includes">&lt;<a class="link-includes">libdwarf.h</a>&gt;</b> specifies legal values for this field.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">drd_length</b></dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
The size in bytes of the field to be relocated.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">drd_offset</b></dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
The section-relative offset of the field to be relocated.</dd>
<dt class="list-tag" style="margin-top: 0.00em;">
<b class="var">drd_symbol_index</b></dt>
<dd class="list-tag" style="margin-left: 20.00ex;">
The symbol index associated with the relocation entry.</dd>
</dl>
<div class="subsection">
<h2 id="x4d656d6f7279204d616e6167656d656e74">Memory Management</h2> The memory area used for the relocation arrays is managed by the <span class="lib">DWARF Access Library (libdwarf, &#45;ldwarf)</span>. The function <b class="fname">dwarf_producer_finish</b>() may be used to release it, along with other resources associated with the producer instance.</div>
</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> On success, function <b class="fname">dwarf_get_relocation_info</b>() returns <span class="define">DW_DLV_OK</span>. It returns <span class="define">DW_DLV_NO_ENTRY</span> if there were no more relocation arrays to retrieve, or if the flag <span class="define">DW_DLC_SYMBOLIC_RELOCATIONS</span> was not set on the producer instance. In case of an error, function <b class="fname">dwarf_get_relocation_info</b>() returns <span class="define">DW_DLV_ERROR</span> and sets the argument <i class="arg">err</i>.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> Function <b class="fname">dwarf_get_relocation_info</b>() can fail with:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_ARGUMENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
One of the arguments <i class="arg">dbg</i>, <i class="arg">elf_section_index</i>, <i class="arg">elf_section_link</i>, <i class="arg">reloc_entry_count</i> or <i class="arg">reloc_buf</i> was NULL.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_NO_ENTRY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
There were no more ELF relocation arrays to retrieve.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_NO_ENTRY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
The flag <span class="define">DW_DLC_SYMBOLIC_RELOCATIONS</span> was not set on the producer instance.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">DW_DLE_NO_ENTRY</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 22.00ex;">
Function <a class="link-man" href="../html3/dwarf_transform_to_disk_form.html">dwarf_transform_to_disk_form(3)</a> was not called prior to calling function <b class="fname">dwarf_get_relocation_info</b>().</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> To generate relocation entries and retrieve them, use:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
Dwarf_P_Debug dbg; 
Dwarf_Relocation_Data buf; 
Dwarf_Signed count, index, link; 
Dwarf_Unsigned reloc_cnt, entry_cnt; 
Dwarf_Error de; 
int version, i, j; 
 
/* 
 * Assume that dbg refers to a DWARF producer instance created 
 * created with DW_DLC_SYMBOLIC_RELOCATIONS flag set and that 
 * application code has added DWARF debugging information 
 * to the producer instance. 
 */ 
if ((count = dwarf_transform_to_disk_form(dbg, &amp;de)) == 
    DW_DLV_NOCOUNT) { 
	warnx("dwarf_transform_to_disk_form failed: %s", 
	    dwarf_errmsg(-1)); 
	return; 
} 
 
/* ... process generated section byte streams ... */ 
if (dwarf_get_relocation_info_count(dbg, &amp;reloc_cnt, &amp;version, &amp;de) != 
    DW_DLV_OK) { 
	warnx("dwarf_get_relocation_info_count failed: %s", 
	    dwarf_errmsg(-1)); 
	return; 
} 
 
for (i = 0; (Dwarf_Unsigned) i &lt; reloc_cnt; i++) { 
	if (dwarf_get_relocation_info(dbg, &amp;index, &amp;link, &amp;entry_cnt, 
	    &amp;buf, &amp;de) != DW_DLV_OK) { 
		warnx("dwarf_get_relocation_info failed: %s", 
		    dwarf_errmsg(-1)); 
		continue; 
	} 
	for (j = 0; (Dwarf_Unsigned) j &lt; entry_cnt; j++) { 
		/* ...use each reloc data in buf[j]... */ 
	} 
} 
 
dwarf_producer_finish(dbg, &amp;de);</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html3/dwarf.html">dwarf(3)</a>, <a class="link-man" href="../html3/dwarf_get_relocation_info_count.html">dwarf_get_relocation_info_count(3)</a>, <a class="link-man" href="../html3/dwarf_reset_section_bytes.html">dwarf_reset_section_bytes(3)</a>, <a class="link-man" href="../html3/dwarf_producer_finish.html">dwarf_producer_finish(3)</a>, <a class="link-man" href="../html3/dwarf_producer_init.html">dwarf_producer_init(3)</a>, <a class="link-man" href="../html3/dwarf_producer_init_b.html">dwarf_producer_init_b(3)</a>, <a class="link-man" href="../html3/dwarf_transform_to_disk_form.html">dwarf_transform_to_disk_form(3)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
September 3, 2011</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

