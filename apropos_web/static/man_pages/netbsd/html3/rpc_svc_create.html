<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
RPC_SVC_CREATE(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
RPC_SVC_CREATE(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
RPC_SVC_CREATE(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">rpc_svc_create</b>, <b class="name">svc_control</b>, <b class="name">svc_create</b>, <b class="name">svc_destroy</b>, <b class="name">svc_dg_create</b>, <b class="name">svc_fd_create</b>, <b class="name">svc_raw_create</b>, <b class="name">svc_tli_create</b>, <b class="name">svc_tp_create</b>, <b class="name">svc_vc_create</b> &#8212; <span class="desc">library routines for the creation of server handles</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">rpc/rpc.h</a>&gt;</b><p>
<i class="ftype">bool_t</i><br>
<b class="fname">svc_control</b>(<i class="farg" style="white-space:nowrap;">SVCXPRT *svc</i>, <i class="farg" style="white-space:nowrap;">const u_int req</i>, <i class="farg" style="white-space:nowrap;">void *info</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">svc_create</b>(<i class="farg" style="white-space:nowrap;">const void (*dispatch)(struct svc_req *, SVCXPRT *)</i>, <i class="farg" style="white-space:nowrap;">const rpcprog_t prognum</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t versnum</i>, <i class="farg" style="white-space:nowrap;">const char *nettype</i>);<p>
<i class="ftype">SVCXPRT *"</i><br>
<b class="fname">svc_dg_create</b>(<i class="farg" style="white-space:nowrap;">const int fildes</i>, <i class="farg" style="white-space:nowrap;">const u_int sendsz</i>, <i class="farg" style="white-space:nowrap;">const u_int recvsz</i>);<p>
<i class="ftype">void</i><br>
<b class="fname">svc_destroy</b>(<i class="farg" style="white-space:nowrap;">SVCXPRT *xprt</i>);<p>
<i class="ftype">SVCXPRT *</i><br>
<b class="fname">svc_fd_create</b>(<i class="farg" style="white-space:nowrap;">const int fildes</i>, <i class="farg" style="white-space:nowrap;">const u_int sendsz</i>, <i class="farg" style="white-space:nowrap;">const u_int recvsz</i>);<p>
<i class="ftype">SVCXPRT *</i><br>
<b class="fname">svc_raw_create</b>(<i class="farg" style="white-space:nowrap;">void</i>);<p>
<i class="ftype">SVCXPRT *</i><br>
<b class="fname">svc_tli_create</b>(<i class="farg" style="white-space:nowrap;">const int fildes</i>, <i class="farg" style="white-space:nowrap;">const struct netconfig *netconf</i>, <i class="farg" style="white-space:nowrap;">const struct t_bind *bindaddr</i>, <i class="farg" style="white-space:nowrap;">const u_int sendsz</i>, <i class="farg" style="white-space:nowrap;">const u_int recvsz</i>);<p>
<i class="ftype">SVCXPRT *</i><br>
<b class="fname">svc_tp_create</b>(<i class="farg" style="white-space:nowrap;">const void (*dispatch)(const struct svc_reg *, const SVCXPRT  *)</i>, <i class="farg" style="white-space:nowrap;">const rpcprog_t prognum</i>, <i class="farg" style="white-space:nowrap;">const rpcvers_t versnum</i>, <i class="farg" style="white-space:nowrap;">const struct netconfig *netconf</i>);<p>
<i class="ftype">SVCXPRT *</i><br>
<b class="fname">svc_vc_create</b>(<i class="farg" style="white-space:nowrap;">const int fildes</i>, <i class="farg" style="white-space:nowrap;">const u_int sendsz</i>, <i class="farg" style="white-space:nowrap;">const u_int recvsz</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> These routines are part of the RPC library which allows C language programs to make procedure calls on servers across the network. These routines deal with the creation of service handles. Once the handle is created, the server can be invoked by calling <b class="fname">svc_run</b>().</div>
<div class="section">
<h1 id="x524f5554494e4553">ROUTINES</h1> See <a class="link-man" href="../3/rpc">rpc(3)</a> for the definition of the <span class="define">SVCXPRT</span> data structure.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">svc_control</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
A function to change or retrieve various information about a service object. <i class="farg">req</i> indicates the type of operation and <i class="farg">info</i> is a pointer to the information. The supported values of <i class="farg">req</i>, their argument types, and what they do are:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SVCGET_VERSQUIET</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
If a request is received for a program number served by this server but the version number is outside the range registered with the server, an <span class="define">RPC_PROGVERSMISMATCH</span> error will normally be returned. <i class="farg">info</i> should be a pointer to an integer. Upon successful completion of the <span class="define">SVCGET_VERSQUIET</span> request, <i class="farg">*info</i> contains an integer which describes the server's current behavior:  0 indicates normal server behavior (that is, an <span class="define">RPC_PROGVERSMISMATCH</span> error will be returned); 1 indicates that the out of range request will be silently ignored.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="define">SVCSET_VERSQUIET</span></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
If a request is received for a program number served by this server but the version number is outside the range registered with the server, an <span class="define">RPC_PROGVERSMISMATCH</span> error will normally be returned. It is sometimes desirable to change this behavior. <i class="farg">info</i> should be a pointer to an integer which is either 0 (indicating normal server behavior - an <span class="define">RPC_PROGVERSMISMATCH</span> error will be returned), or 1 (indicating that the out of range request should be silently ignored).</dd>
</dl>
</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">svc_create</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
<b class="fname">svc_create</b>() creates server handles for all the transports belonging to the class <i class="farg">nettype</i>. <i class="farg">nettype</i> defines a class of transports which can be used for a particular application. The transports are tried in left to right order in <span class="env">NETPATH</span> variable or in top to bottom order in the netconfig database. If <i class="farg">nettype</i> is <span class="define">NULL</span>, it defaults to <span class="define">netpath</span>.<p>
<b class="fname">svc_create</b>() registers itself with the rpcbind service (see <a class="link-man" href="../8/rpcbind">rpcbind(8)</a>). <i class="farg">dispatch</i> is called when there is a remote procedure call for the given <i class="farg">prognum</i> and <i class="farg">versnum</i>; this requires calling <b class="fname">svc_run</b>() (see <b class="fname">svc_run</b>() in <a class="link-man" href="../3/rpc_svc_reg">rpc_svc_reg(3)</a>). If <b class="fname">svc_create</b>() succeeds, it returns the number of server handles it created, otherwise it returns 0 and an error message is logged.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">svc_destroy</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
A function macro that destroys the RPC service handle <i class="farg">xprt</i>. Destruction usually involves deallocation of private data structures, including <i class="farg">xprt</i> itself. Use of <i class="farg">xprt</i> is undefined after calling this routine.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">svc_dg_create</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
This routine creates a connectionless RPC service handle, and returns a pointer to it. This routine returns <span class="define">NULL</span> if it fails, and an error message is logged. <i class="farg">sendsz</i> and <i class="farg">recvsz</i> are parameters used to specify the size of the buffers. If they are 0, suitable defaults are chosen. The file descriptor <i class="farg">fildes</i> should be open and bound. The server is not registered with <a class="link-man" href="../8/rpcbind">rpcbind(8)</a>. <span class="emph">Warning</span>: since connectionless-based RPC messages can only hold limited amount of encoded data, this transport cannot be used for procedures that take large arguments or return huge results.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">svc_fd_create</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
This routine creates a service on top of an open and bound file descriptor, and returns the handle to it. Typically, this descriptor is a connected file descriptor for a connection-oriented transport. <i class="farg">sendsz</i> and <i class="farg">recvsz</i> indicate sizes for the send and receive buffers. If they are 0, reasonable defaults are chosen. This routine returns <span class="define">NULL</span> if it fails, and an error message is logged.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">svc_raw_create</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
This routine creates an RPC service handle and returns a pointer to it. The transport is really a buffer within the process's address space, so the corresponding RPC client should live in the same address space; (see <b class="fname">clnt_raw_create</b>() in <a class="link-man" href="../3/rpc_clnt_create">rpc_clnt_create(3)</a>). This routine allows simulation of RPC and acquisition of RPC overheads (such as round trip times), without any kernel and networking interference. This routine returns <span class="define">NULL</span> if it fails, and an error message is logged. <span class="emph">Note</span>: <b class="fname">svc_run</b>() should not be called when the raw interface is being used.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">svc_tli_create</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
This routine creates an RPC server handle, and returns a pointer to it. <i class="farg">fildes</i> is the file descriptor on which the service is listening. If <i class="farg">fildes</i> is <span class="define">RPC_ANYFD</span>, it opens a file descriptor on the transport specified by <i class="farg">netconf</i>. If the file descriptor is unbound and <i class="farg">bindaddr</i> is non-null <i class="farg">fildes</i> is bound to the address specified by <i class="farg">bindaddr</i>, otherwise <i class="farg">fildes</i> is bound to a default address chosen by the transport.<p>
Note: the <span class="type">t_bind</span> structure comes from the TLI/XTI SysV interface, which <span class="unix">NetBSD</span> does not use. The structure is defined in <b class="includes">&lt;<a class="link-includes">rpc/types.h</a>&gt;</b> for compatibility as:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
struct t_bind { 
    struct netbuf addr;	/* network address, see rpc(3) */ 
    unsigned int  qlen;	/* queue length (for listen(2)) */ 
};</pre>
<p>
In the case where the default address is chosen, the number of outstanding connect requests is set to 8 for connection-oriented transports. The user may specify the size of the send and receive buffers with the parameters <i class="farg">sendsz</i> and <i class="farg">recvsz</i>; values of 0 choose suitable defaults. This routine returns <span class="define">NULL</span> if it fails, and an error message is logged. The server is not registered with the <a class="link-man" href="../8/rpcbind">rpcbind(8)</a> service.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">svc_tp_create</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
<b class="fname">svc_tp_create</b>() creates a server handle for the network specified by <i class="farg">netconf</i>, and registers itself with the rpcbind service. <i class="farg">dispatch</i> is called when there is a remote procedure call for the given <i class="farg">prognum</i> and <i class="farg">versnum</i>; this requires calling <b class="fname">svc_run</b>(). <b class="fname">svc_tp_create</b>() returns the service handle if it succeeds, otherwise a <span class="define">NULL</span> is returned and an error message is logged.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="fname">svc_vc_create</b>()</dt>
<dd class="list-tag" style="margin-left: 5.00ex;">
This routine creates a connection-oriented RPC service and returns a pointer to it. This routine returns <span class="define">NULL</span> if it fails, and an error message is logged. The users may specify the size of the send and receive buffers with the parameters <i class="farg">sendsz</i> and <i class="farg">recvsz</i>; values of 0 choose suitable defaults. The file descriptor <i class="farg">fildes</i> should be open and bound. The server is not registered with the <a class="link-man" href="../8/rpcbind">rpcbind(8)</a> service.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/rpc">rpc(3)</a>, <a class="link-man" href="../3/rpc_svc_calls">rpc_svc_calls(3)</a>, <a class="link-man" href="../3/rpc_svc_err">rpc_svc_err(3)</a>, <a class="link-man" href="../3/rpc_svc_reg">rpc_svc_reg(3)</a>, <a class="link-man" href="../8/rpcbind">rpcbind(8)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 3, 1993</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

