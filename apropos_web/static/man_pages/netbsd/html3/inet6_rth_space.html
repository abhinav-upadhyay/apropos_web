<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
INET6_RTH_SPACE(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
INET6_RTH_SPACE(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
INET6_RTH_SPACE(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">inet6_rth_space</b>, <b class="name">inet6_rth_init</b>, <b class="name">inet6_rth_add</b>, <b class="name">inet6_rth_reverse</b>, <b class="name">inet6_rth_segments</b>, <b class="name">inet6_rth_getaddr</b> &#8212; <span class="desc">IPv6 Routing Header Options manipulation</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">netinet/in.h</a>&gt;</b><p>
<i class="ftype">socklen_t</i><br>
<b class="fname">inet6_rth_space</b>(<i class="farg" style="white-space:nowrap;">int</i>, <i class="farg" style="white-space:nowrap;">int</i>);<p>
<i class="ftype">void *</i><br>
<b class="fname">inet6_rth_init</b>(<i class="farg" style="white-space:nowrap;">void *</i>, <i class="farg" style="white-space:nowrap;">socklen_t</i>, <i class="farg" style="white-space:nowrap;">int</i>, <i class="farg" style="white-space:nowrap;">int</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">inet6_rth_add</b>(<i class="farg" style="white-space:nowrap;">void *</i>, <i class="farg" style="white-space:nowrap;">const struct in6_addr *</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">inet6_rth_reverse</b>(<i class="farg" style="white-space:nowrap;">const void *</i>, <i class="farg" style="white-space:nowrap;">void *</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">inet6_rth_segments</b>(<i class="farg" style="white-space:nowrap;">const void *</i>);<p>
<i class="ftype">struct in6_addr *</i><br>
<b class="fname">inet6_rth_getaddr</b>(<i class="farg" style="white-space:nowrap;">const void *</i>, <i class="farg" style="white-space:nowrap;">int</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The IPv6 Advanced API, RFC 3542, defines the functions that an application calls to build and examine IPv6 Routing headers. Routing headers are used to perform source routing in IPv6 networks. The RFC uses the word &#8220;segments&#8221; to describe addresses and that is the term used here as well. All of the functions are defined in the <b class="includes">&lt;<a class="link-includes">netinet/in.h</a>&gt;</b> header file. The functions described in this manual page all operate on routing header structures which are defined in <b class="includes">&lt;<a class="link-includes">netinet/ip6.h</a>&gt;</b> but which should not need to be modified outside the use of this API. The size and shape of the route header structures may change, so using the APIs is a more portable, long term, solution.<p>
The functions in the API are split into two groups, those that build a routing header and those that parse a received routing header. We will describe the builder functions followed by the parser functions.<div class="subsection">
<h2 id="x696e6574365f7274685f7370616365">inet6_rth_space</h2> The <b class="fname">inet6_rth_space</b>() function returns the number of bytes required to hold a Routing Header of the type, specified in the <i class="farg">type</i> argument and containing the number of addresses specified in the <i class="farg">segments</i> argumment. When the type is <span class="define">IPV6_RTHDR_TYPE_0</span> the number of segments must be from 0 through 127. Routing headers of type <span class="define">IPV6_RTHDR_TYPE_2</span> contain only one segment, and are only used with Mobile IPv6. The return value from this function is the number of bytes required to store the routing header. If the value 0 is returned then either the route header type was not recognized or another error occurred.</div>
<div class="subsection">
<h2 id="x696e6574365f7274685f696e6974">inet6_rth_init</h2> The <b class="fname">inet6_rth_init</b>() function initializes the pre-allocated buffer pointed to by <i class="farg">bp</i> to contain a routing header of the specified type The <i class="farg">bp_len</i> argument is used to verify that the buffer is large enough. The caller must allocate the buffer pointed to by bp. The necessary buffer size should be determined by calling <b class="fname">inet6_rth_space</b>() described in the previous sections.<p>
The <b class="fname">inet6_rth_init</b>() function returns a pointer to <i class="farg">bp</i> on success and <span class="define">NULL</span> when there is an error.</div>
<div class="subsection">
<h2 id="x696e6574365f7274685f616464">inet6_rth_add</h2> The <b class="fname">inet6_rth_add</b>() function adds the IPv6 address pointed to by <i class="farg">addr</i> to the end of the routing header being constructed.<p>
A successful addition results in the function returning 0, otherwise &#45;1 is returned.</div>
<div class="subsection">
<h2 id="x696e6574365f7274685f72657665727365">inet6_rth_reverse</h2> The <b class="fname">inet6_rth_reverse</b>() function takes a routing header, pointed to by the argument <i class="farg">in</i>, and writes a new routing header into the argument pointed to by <i class="farg">out</i>. The routing header at that sends datagrams along the reverse of that route. Both arguments are allowed to point to the same buffer meaning that the reversal can occur in place.<p>
The return value of the function is 0 on success, or &#45;1 when there is an error.<p>
The next set of functions operate on a routing header that the application wants to parse. In the usual case such a routing header is received from the network, although these functions can also be used with routing headers that the application itself created.</div>
<div class="subsection">
<h2 id="x696e6574365f7274685f7365676d656e7473">inet6_rth_segments</h2> The <b class="fname">inet6_rth_segments</b>() function returns the number of segments contained in the routing header pointed to by <i class="farg">bp</i>. The return value is the number of segments contained in the routing header, or &#45;1 if an error occurred. It is not an error for 0 to be returned as a routing header may contain 0 segments.</div>
<div class="subsection">
<h2 id="x696e6574365f7274685f67657461646472">inet6_rth_getaddr</h2> The <b class="fname">inet6_rth_getaddr</b>() function is used to retrieve a single address from a routing header. The <i class="farg">index</i> is the location in the routing header from which the application wants to retrieve an address. The <i class="farg">index</i> parameter must have a value between 0 and one less than the number of segments present in the routing header. The <b class="fname">inet6_rth_segments</b>() function, described in the last section, should be used to determine the total number of segments in the routing header. The <b class="fname">inet6_rth_getaddr</b>() function returns a pointer to an IPv6 address on success or <span class="define">NULL</span> when an error has occurred.</div>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> RFC 3542 gives extensive examples in Section 21, Appendix B.<p>
KAME also provides examples in the advapitest directory of its kit.</div>
<div class="section">
<h1 id="x444941474e4f5354494353">DIAGNOSTICS</h1> The <b class="fname">inet6_rth_space</b>() and <b class="fname">inet6_rth_getaddr</b>() functions return 0 on errors.<p>
The <b class="fname">inet6_rthdr_init</b>() function returns <span class="define">NULL</span> on error. The <b class="fname">inet6_rth_add</b>() and <b class="fname">inet6_rth_reverse</b>() functions return 0 on success, or &#45;1 upon an error.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <span class="ref"><span class="ref-auth">W. Stevens</span>, <span class="ref-auth">M. Thomas</span>, <span class="ref-auth">E. Nordmark</span>, and <span class="ref-auth">T. Jinmei</span>, <span class="ref-title">Advanced Sockets API for IPv6</span>, <span class="ref-num">RFC 3542</span>, <span class="ref-date">May 2003</span>.</span><p>
<span class="ref"><span class="ref-auth">S. Deering</span> and <span class="ref-auth">R. Hinden</span>, <span class="ref-title">Internet Protocol, Version 6 (IPv6) Specification</span>, <span class="ref-num">RFC2460</span>, <span class="ref-date">December 1998</span>.</span></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> The implementation first appeared in KAME advanced networking kit.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 24, 2004</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

