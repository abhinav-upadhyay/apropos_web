<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
SHM_OPEN(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
SHM_OPEN(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
SHM_OPEN(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">shm_open</b>, <b class="name">shm_unlink</b> &#8212; <span class="desc">shared memory object operations</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">POSIX Real&#45;time Library (librt, &#45;lrt)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">sys/types.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">sys/mman.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">fcntl.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">shm_open</b>(<i class="farg" style="white-space:nowrap;">const char *name</i>, <i class="farg" style="white-space:nowrap;">int flags</i>, <i class="farg" style="white-space:nowrap;">mode_t mode</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">shm_unlink</b>(<i class="farg" style="white-space:nowrap;">const char *name</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">shm_open</b>() function creates or opens a POSIX shared memory object named <i class="farg">name</i>. The <i class="farg">flags</i> argument contains a subset of the flags used by <a class="link-man" href="../2/open">open(2)</a>. An access mode of either <span class="define">O_RDONLY</span> or <span class="define">O_RDWR</span> must be included in <i class="farg">flags</i>. The optional flags <span class="define">O_CREAT</span>, <span class="define">O_EXCL</span>, and <span class="define">O_TRUNC</span> may also be specified.<p>
If <span class="define">O_CREAT</span> is specified, then a new shared memory object named <i class="farg">name</i> will be created if it does not exist. In this case, the shared memory object is created with mode <i class="farg">mode</i> subject to the process' umask value. If both the <span class="define">O_CREAT</span> and <span class="define">O_EXCL</span> flags are specified and a shared memory object named <i class="farg">path</i> already exists, then <b class="fname">shm_open</b>() will fail with <span class="errno">EEXIST</span>.<p>
Newly created objects start off with a size of zero. If an existing shared memory object is opened with <span class="define">O_RDWR</span> and the <span class="define">O_TRUNC</span> flag is specified, then the shared memory object will be truncated to a size of zero. The size of the object can be adjusted via <a class="link-man" href="../2/ftruncate">ftruncate(2)</a> and queried via <a class="link-man" href="../2/fstat">fstat(2)</a>.<p>
The new descriptor is set to close during <a class="link-man" href="../2/execve">execve(2)</a> system calls; see <a class="link-man" href="../2/close">close(2)</a> and <a class="link-man" href="../2/fcntl">fcntl(2)</a>.<p>
The <b class="fname">shm_unlink</b>() system call removes a shared memory object named <i class="farg">path</i>.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> If successful, <b class="fname">shm_open</b>() returns a non-negative integer, and <b class="fname">shm_unlink</b>() returns zero. Both functions return -1 on failure, and set <b class="var">errno</b> to indicate the error.</div>
<div class="section">
<h1 id="x434f4d5041544942494c495459">COMPATIBILITY</h1> The <i class="farg">path</i> argument does not necessarily represent a pathname (although it does in most other implementations). Two processes opening the same <i class="farg">path</i> are guaranteed to access the same shared memory object if and only if <i class="farg">path</i> begins with a slash (&#8216;<code class="lit">/</code>&#8217;) character.<p>
Only the <span class="define">O_RDONLY</span>, <span class="define">O_RDWR</span>, <span class="define">O_CREAT</span>, <span class="define">O_EXCL</span>, and <span class="define">O_TRUNC</span> flags may be used in portable programs.<p>
The result of using <a class="link-man" href="../2/open">open(2)</a>, <a class="link-man" href="../2/read">read(2)</a>, or <a class="link-man" href="../2/write">write(2)</a> on a shared memory object, or on the descriptor returned by <b class="fname">shm_open</b>(), is undefined. It is also undefined whether the shared memory object itself, or its contents, persist across reboots.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> The following errors are defined for <b class="fname">shm_open</b>():<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EACCES</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The required permissions (for reading or reading and writing) are denied.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EEXIST</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> and <span class="define">O_EXCL</span> are specified and the named shared memory object does exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument points outside the process' allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
A flag other than <span class="define">O_RDONLY</span>, <span class="define">O_RDWR</span>, <span class="define">O_CREAT</span>, <span class="define">O_EXCL</span>, or <span class="define">O_TRUNC</span> was included in <i class="farg">flags</i>; or the <i class="farg">path</i> does not begin with a slash (&#8216;<code class="lit">/</code>&#8217;) character.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EMFILE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The process has already reached its limit for open file descriptors.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENAMETOOLONG</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The entire pathname exceeded &#123;<span class="define">PATH_MAX</span>&#125; characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENFILE</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The system file table is full.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<span class="define">O_CREAT</span> is specified and the named shared memory object does not exist.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOTSUP</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Not supported, most likely due to missing or incorrect <i class="file">/var/shm</i> mount.</dd>
</dl>
<p>
The following errors are defined for <b class="fname">shm_unlink</b>():<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EACCES</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The required permissions are denied. <b class="fname">shm_unlink</b>() requires write permission to the shared memory object.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The <i class="farg">path</i> argument points outside the process' allocated address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENAMETOOLONG</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The entire pathname exceeded &#123;<span class="define">PATH_MAX</span>&#125; characters.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">ENOENT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The named shared memory object does not exist.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../2/close">close(2)</a>, <a class="link-man" href="../2/fstat">fstat(2)</a>, <a class="link-man" href="../2/ftruncate">ftruncate(2)</a>, <a class="link-man" href="../2/mmap">mmap(2)</a>, <a class="link-man" href="../2/munmap">munmap(2)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The <b class="fname">shm_open</b>() and <b class="fname">shm_unlink</b>() functions are expected to conform to IEEE Std 1003.1b-1993 (&#8220;POSIX.1b&#8221;).</div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> These functions first appeared in <span class="unix">NetBSD&#160;7.0</span>.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 19, 2013</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

