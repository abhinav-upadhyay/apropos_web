<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
KADM5_PWCHECK(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
KADM5_PWCHECK(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
KADM5_PWCHECK(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">krb5_pwcheck</b>, <b class="name">kadm5_setup_passwd_quality_check</b>, <b class="name">kadm5_add_passwd_quality_verifier</b>, <b class="name">kadm5_check_password_quality</b> &#8212; <span class="desc">Heimdal warning and error functions</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> Kerberos 5 Library (libkadm5srv, -lkadm5srv)</div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">kadm5-protos.h</a>&gt;</b><br>
<b class="includes">#include &lt;<a class="link-includes">kadm5-pwcheck.h</a>&gt;</b><p>
<i class="ftype">void</i><br>
<b class="fname">kadm5_setup_passwd_quality_check</b>(<i class="farg">krb5_context context</i>, <i class="farg">const char *check_library</i>, <i class="farg">const char *check_function</i>);<p>
<i class="ftype">krb5_error_code</i><br>
<b class="fname">kadm5_add_passwd_quality_verifier</b>(<i class="farg">krb5_context context</i>, <i class="farg">const char *check_library</i>);<p>
<i class="ftype">const char *</i><br>
<b class="fname">kadm5_check_password_quality</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_principal principal</i>, <i class="farg">krb5_data *pwd_data</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">(*kadm5_passwd_quality_check_func)</b>(<i class="farg">krb5_context context</i>, <i class="farg">krb5_principal principal</i>, <i class="farg">krb5_data *password</i>, <i class="farg">const char *tuning</i>, <i class="farg">char *message</i>, <i class="farg">size_t length</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> These functions perform the quality check for the heimdal database library.<p>
There are two versions of the shared object API; the old version (0) is deprecated, but still supported.  The new version (1) supports multiple password quality checking policies in the same shared object. See below for details.<p>
The password quality checker will run all policies that are configured by the user.  If any policy rejects the password, the password will be rejected.<p>
Policy names are of the form &#8216;<code class="lit">module-name:policy-name</code>&#8217; or, if the the policy name is unique enough, just &#8216;<code class="lit">policy-name</code>&#8217;.</div>
<div class="section">
<h1 id="x494d504c454d454e54494e4720412050415353574f5244205155414c49545920434845434b494e4720534841524544204f424a454354">IMPLEMENTING A PASSWORD QUALITY CHECKING SHARED OBJECT</h1> (This refers to the version 1 API only.)<p>
Module shared objects may conveniently be compiled and linked with <a class="link-man" href="../1/libtool">libtool(1)</a>. An object needs to export a symbol called &#8216;<code class="lit">kadm5_password_verifier</code>&#8217; of the type <i class="ftype">struct kadm5_pw_policy_verifier</i>.<p>
Its <i class="ftype">name</i> and <i class="ftype">vendor</i> fields should contain the obvious information. <i class="ftype">name</i> must match the &#8216;<code class="lit">module-name</code>&#8217; portion of the policy name (the part before the colon), if the policy name contains a colon, or the policy will not be run. <i class="ftype">version</i> should be <span class="define">KADM5_PASSWD_VERSION_V1</span>.<p>
<i class="ftype">funcs</i> contains an array of <i class="ftype">struct kadm5_pw_policy_check_func</i> structures that is terminated with an entry whose <i class="ftype">name</i> component is <span class="define">NULL</span>. The <i class="ftype">name</i> field of the array must match the &#8216;<code class="lit">policy-name</code>&#8217; portion of a policy name (the part after the colon, or the complete policy name if there is no colon) specified by the user or the policy will not be run.  The <i class="ftype">func</i> fields of the array elements are functions that are exported by the module to be called to check the password.  They get the following arguments:  the Kerberos context, principal, password, a tuning parameter, and a pointer to a message buffer and its length.  The tuning parameter for the quality check function is currently always <span class="define">NULL</span>. If the password is acceptable, the function returns zero.  Otherwise it returns non-zero and fills in the message buffer with an appropriate explanation.</div>
<div class="section">
<h1 id="x52554e4e494e472054484520434845434b53">RUNNING THE CHECKS</h1> <b class="name">kadm5_setup_passwd_quality_check</b> sets up type 0 checks.  It sets up all type 0 checks defined in <a class="link-man" href="../5/krb5.conf">krb5.conf(5)</a> if called with the last two arguments null.<p>
<b class="name">kadm5_add_passwd_quality_verifier</b> sets up type 1 checks.  It sets up all type 1 tests defined in <a class="link-man" href="../5/krb5.conf">krb5.conf(5)</a> if called with a null second argument. <b class="name">kadm5_check_password_quality</b> runs the checks in the order in which they are defined in <a class="link-man" href="../5/krb5.conf">krb5.conf(5)</a> and the order in which they occur in a module's <i class="ftype">funcs</i> array until one returns non-zero.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../1/libtool">libtool(1)</a>, <a class="link-man" href="../3/krb5">krb5(3)</a>, <a class="link-man" href="../5/krb5.conf">krb5.conf(5)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
February 29, 2004</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

