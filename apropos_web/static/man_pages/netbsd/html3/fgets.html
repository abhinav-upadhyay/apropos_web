<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
FGETS(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
FGETS(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
FGETS(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">fgets</b>, <b class="name">gets</b> &#8212; <span class="desc">get a line from a stream</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">stdio.h</a>&gt;</b><p>
<i class="ftype">char *</i><br>
<b class="fname">fgets</b>(<i class="farg" style="white-space:nowrap;">char * restrict str</i>, <i class="farg" style="white-space:nowrap;">int size</i>, <i class="farg" style="white-space:nowrap;">FILE * restrict stream</i>);<p>
<i class="ftype">char *</i><br>
<b class="fname">gets</b>(<i class="farg" style="white-space:nowrap;">char *str</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> The <b class="fname">fgets</b>() function reads at most one less than the number of characters specified by <i class="farg">size</i> from the given <i class="farg">stream</i> and stores them in the string <i class="farg">str</i>. Reading stops when a newline character is found, at end-of-file or error. The newline, if any, is retained, and a &#8216;<code class="lit">&#92;0</code>&#8217; character is appended to end the string.<p>
The <b class="fname">gets</b>() function is equivalent to <b class="fname">fgets</b>() with an infinite <i class="farg">size</i> and a <i class="farg">stream</i> of <span class="emph">stdin</span>, except that the newline character (if any) is not stored in the string. It is the caller's responsibility to ensure that the input line, if any, is sufficiently short to fit in the string.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> Upon successful completion, <b class="fname">fgets</b>() and <b class="fname">gets</b>() return a pointer to the string. If end-of-file or an error occurs before any characters are read, they return <span class="define">NULL</span>. The <b class="fname">fgets</b>() and <b class="fname">gets</b>() functions do not distinguish between end-of-file and error, and callers must use <a class="link-man" href="../3/feof">feof(3)</a> and <a class="link-man" href="../3/ferror">ferror(3)</a> to determine which occurred.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EBADF</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
The given <i class="farg">stream</i> is not a readable stream.</dd>
</dl>
<p>
The function <b class="fname">fgets</b>() may also fail and set <b class="var">errno</b> for any of the errors specified for the routines <a class="link-man" href="../3/fflush">fflush(3)</a>, <a class="link-man" href="../2/fstat">fstat(2)</a>, <a class="link-man" href="../2/read">read(2)</a>, or <a class="link-man" href="../3/malloc">malloc(3)</a>.<p>
The function <b class="fname">gets</b>() may also fail and set <b class="var">errno</b> for any of the errors specified for the routine <a class="link-man" href="../3/getchar">getchar(3)</a>.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/feof">feof(3)</a>, <a class="link-man" href="../3/ferror">ferror(3)</a>, <a class="link-man" href="../3/fgetln">fgetln(3)</a></div>
<div class="section">
<h1 id="x5354414e4441524453">STANDARDS</h1> The functions <b class="fname">fgets</b>() and <b class="fname">gets</b>() conform to ANSI X3.159-1989 (&#8220;ANSI&#160;C89&#8221;) and IEEE Std 1003.1-2001 (&#8220;POSIX.1&#8221;). The IEEE Std 1003.1-2008 (&#8220;POSIX.1&#8221;) revision marked <b class="fname">gets</b>() as obsolescent.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> The following bit of code illustrates a case where the programmer assumes a string is too long if it does not contain a newline:<p>
<pre style="margin-left: 0.00ex;" class="lit display">
	char buf[1024], *p; 
 
	while (fgets(buf, sizeof(buf), fp) != NULL) { 
		if ((p = strchr(buf, '&#92;n')) == NULL) { 
			fprintf(stderr, "input line too long.&#92;n"); 
			exit(1); 
		} 
		*p = '&#92;0'; 
		printf("%s&#92;n", buf); 
	}</pre>
<p>
While the error would be true if a line longer than 1023 characters were read, it would be false in two other cases:<ol style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 5.00ex;" class="list list-enum">
<li class="list-enum" style="margin-top: 1.00em;">
If the last line in a file does not contain a newline, the string returned by <b class="fname">fgets</b>() will not contain a newline either. Thus <b class="fname">strchr</b>() will return <span class="define">NULL</span> and the program will terminate, even if the line was valid.</li>
<li class="list-enum" style="margin-top: 1.00em;">
All C string functions, including <b class="fname">strchr</b>(), correctly assume the end of the string is represented by a null (&#8216;&#92;0&#8217;) character. If the first character of a line returned by <b class="fname">fgets</b>() were null, <b class="fname">strchr</b>() would immediately return without considering the rest of the returned text which may indeed include a newline.</li>
</ol>
<p>
Consider using <a class="link-man" href="../3/fgetln">fgetln(3)</a> instead when dealing with untrusted input.</div>
<div class="section">
<h1 id="x534543555249545920434f4e53494445524154494f4e53">SECURITY CONSIDERATIONS</h1> Since it is usually impossible to ensure that the next input line is less than some arbitrary length, and because overflowing the input buffer is almost invariably a security violation, programs should <span class="emph">NEVER</span> use <b class="fname">gets</b>(). The <b class="fname">gets</b>() function exists purely to conform to ANSI X3.159-1989 (&#8220;ANSI&#160;C89&#8221;).</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
May 13, 2010</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

