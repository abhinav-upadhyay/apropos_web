<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
SIGVEC(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
SIGVEC(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
SIGVEC(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">sigvec</b> &#8212; <span class="desc">software signal facilities</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">Standard C Library (libc, &#45;lc)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">signal.h</a>&gt;</b><p>
<pre style="margin-left: 0.00ex;" class="lit display">
struct sigvec { 
	void	(*sv_handler)(); 
	int	sv_mask; 
	int	sv_flags; 
};</pre>
<br>
<i class="ftype">int</i><br>
<b class="fname">sigvec</b>(<i class="farg" style="white-space:nowrap;">int sig</i>, <i class="farg" style="white-space:nowrap;">struct sigvec *vec</i>, <i class="farg" style="white-space:nowrap;">struct sigvec *ovec</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1><div class="symb" style="display:inline;margin-left: 1.00ex;">
This interface is made obsolete by <a class="link-man" href="../html2/sigaction.html">sigaction(2)</a>. The structure, flags, and function declaration have been removed from the header files but the function is kept in the c library for binary compatibility.</div>
<p>
The system defines a set of signals that may be delivered to a process. Signal delivery resembles the occurrence of a hardware interrupt: the signal is blocked from further occurrence, the current process context is saved, and a new one is built. A process may specify a <span class="emph">handler</span> to which a signal is delivered, or specify that a signal is to be <span class="emph">ignored</span>. A process may also specify that a default action is to be taken by the system when a signal occurs. A signal may also be <span class="emph">blocked</span>, in which case its delivery is postponed until it is <span class="emph">unblocked</span>. The action to be taken on delivery is determined at the time of delivery. Normally, signal handlers execute on the current stack of the process. This may be changed, on a per-handler basis, so that signals are taken on a special <span class="emph">signal stack</span>.<p>
Signal routines execute with the signal that caused their invocation <span class="emph">blocked</span>, but other signals may yet occur. A global <span class="emph">signal mask</span> defines the set of signals currently blocked from delivery to a process. The signal mask for a process is initialized from that of its parent (normally 0). It may be changed with a <a class="link-man" href="../html3/sigblock.html">sigblock(3)</a> or <a class="link-man" href="../html3/sigsetmask.html">sigsetmask(3)</a> call, or when a signal is delivered to the process.<p>
When a signal condition arises for a process, the signal is added to a set of signals pending for the process. If the signal is not currently <span class="emph">blocked</span> by the process then it is delivered to the process. When a caught signal is delivered, the current state of the process is saved, a new signal mask is calculated (as described below), and the signal handler is invoked. The call to the handler is arranged so that if the signal handling routine returns normally the process will resume execution in the context from before the signal's delivery. If the process wishes to resume in a different context, then it must arrange to restore the previous context itself.<p>
When a signal is delivered to a process a new signal mask is installed for the duration of the process' signal handler (or until a <a class="link-man" href="../html3/sigblock.html">sigblock(3)</a> or <a class="link-man" href="../html3/sigsetmask.html">sigsetmask(3)</a> call is made). This mask is formed by taking the union of the current signal mask, the signal to be delivered, and the signal mask associated with the handler to be invoked.<p>
<b class="fname">sigvec</b>() assigns a handler for a specific signal. If <i class="farg">vec</i> is non-zero, it specifies an action (<span class="define">SIG_DFL</span>, <span class="define">SIG_IGN</span>, or a handler routine) and mask to be used when delivering the specified signal. Further, if the <span class="define">SV_ONSTACK</span> bit is set in <i class="farg">sv_flags</i>, the system will deliver the signal to the process on a <span class="emph">signal stack</span>, specified with <a class="link-man" href="../html2/sigaltstack.html">sigaltstack(2)</a>. If <i class="farg">ovec</i> is non-zero, the previous handling information for the signal is returned to the user.<p>
Once a signal handler is installed, it remains installed until another <b class="fname">sigvec</b>() call is made, or an <a class="link-man" href="../html2/execve.html">execve(2)</a> is performed. A signal-specific default action may be reset by setting <i class="farg">sv_handler</i> to <span class="define">SIG_DFL</span>. The defaults are process termination, possibly with core dump; no action; stopping the process; or continuing the process. See the signal list below for each signal's default action. If <i class="farg">sv_handler</i> is set to <span class="define">SIG_DFL</span>, the default action for the signal is to discard the signal, and if a signal is pending, the pending signal is discarded even if the signal is masked. If <i class="farg">sv_handler</i> is set to <span class="define">SIG_IGN</span>, current and pending instances of the signal are ignored and discarded.<p>
Options may be specified by setting <span class="emph">sv_flags</span>. If the <span class="define">SV_ONSTACK</span> bit is set in <i class="farg">sv_flags</i>, the system will deliver the signal to the process on a <span class="emph">signal stack</span>, specified with <a class="link-man" href="../html2/sigstack.html">sigstack(2)</a>.<p>
If a signal is caught during the system calls listed below, the call may be restarted, the call may return with a data transfer shorter than requested, or the call may be forced to terminate with the error <span class="define">EINTR</span>. Interrupting of pending calls is requested by setting the <span class="define">SV_INTERRUPT</span> bit in <i class="arg">sv_flags</i>. The affected system calls include <a class="link-man" href="../html2/open.html">open(2)</a>, <a class="link-man" href="../html2/read.html">read(2)</a>, <a class="link-man" href="../html2/write.html">write(2)</a>, <a class="link-man" href="../html2/sendto.html">sendto(2)</a>, <a class="link-man" href="../html2/recvfrom.html">recvfrom(2)</a>, <a class="link-man" href="../html2/sendmsg.html">sendmsg(2)</a> and <a class="link-man" href="../html2/recvmsg.html">recvmsg(2)</a> on a communications channel or a slow device (such as a terminal, but not a regular file) and during a <a class="link-man" href="../html2/wait.html">wait(2)</a> or <a class="link-man" href="../html2/ioctl.html">ioctl(2)</a>. However, calls that have already committed are not restarted, but instead return a partial success (for example, a short read count).<p>
After a <a class="link-man" href="../html2/fork.html">fork(2)</a> or <a class="link-man" href="../html2/vfork.html">vfork(2)</a> all signals, the signal mask, the signal stack, and the interrupt/restart flags are inherited by the child.<p>
The <a class="link-man" href="../html2/execve.html">execve(2)</a> system call reinstates the default action for all signals which were caught and resets all signals to be caught on the user stack. Ignored signals remain ignored; the signal mask remains the same; signals that interrupt pending system calls continue to do so.<p>
See <a class="link-man" href="../html7/signal.html">signal(7)</a> for comprehensive list of supported signals.</div>
<div class="section">
<h1 id="x4e4f544553">NOTES</h1> The mask specified in <i class="farg">vec</i> is not allowed to block <span class="define">SIGKILL</span> or <span class="define">SIGSTOP</span>. This is enforced silently by the system.<p>
The <span class="define">SV_INTERRUPT</span> flag is not available in <span class="unix">4.2BSD</span>, hence it should not be used if backward compatibility is needed.</div>
<div class="section">
<h1 id="x52455455524e2056414c554553">RETURN VALUES</h1> A 0 value indicated that the call succeeded. A &#45;1 return value indicates an error occurred and <b class="var">errno</b> is set to indicated the reason.</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> The handler routine can be declared:<p>
<pre style="margin-left: 5.00ex;" class="lit display">
void 
handler(sig, code, scp) 
	int sig, code; 
	struct sigcontext *scp;</pre>
<p>
Here <i class="farg">sig</i> is the signal number, into which the hardware faults and traps are mapped as defined below. <i class="farg">code</i> is a parameter that is either a constant or the code provided by the hardware. <i class="farg">scp</i> is a pointer to the <i class="farg">sigcontext</i> structure (defined in <b class="includes">&lt;<a class="link-includes">signal.h</a>&gt;</b>), used to restore the context from before the signal.</div>
<div class="section">
<h1 id="x4552524f5253">ERRORS</h1> <b class="fname">sigvec</b>() will fail and no new signal handler will be installed if one of the following occurs:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EFAULT</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
Either <i class="farg">vec</i> or <i class="farg">ovec</i> points to memory that is not a valid part of the process address space.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
<i class="farg">sig</i> is not a valid signal number.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
&#91;<span class="errno">EINVAL</span>&#93;</dt>
<dd class="list-tag" style="margin-left: 17.00ex;">
An attempt is made to ignore or supply a handler for <span class="define">SIGKILL</span> or <span class="define">SIGSTOP</span>.</dd>
</dl>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../html1/kill.html">kill(1)</a>, <a class="link-man" href="../html2/kill.html">kill(2)</a>, <a class="link-man" href="../html2/ptrace.html">ptrace(2)</a>, <a class="link-man" href="../html2/sigaction.html">sigaction(2)</a>, <a class="link-man" href="../html2/sigaltstack.html">sigaltstack(2)</a>, <a class="link-man" href="../html2/sigprocmask.html">sigprocmask(2)</a>, <a class="link-man" href="../html2/sigstack.html">sigstack(2)</a>, <a class="link-man" href="../html2/sigsuspend.html">sigsuspend(2)</a>, <a class="link-man" href="../html3/setjmp.html">setjmp(3)</a>, <a class="link-man" href="../html3/sigblock.html">sigblock(3)</a>, <a class="link-man" href="../html3/siginterrupt.html">siginterrupt(3)</a>, <a class="link-man" href="../html3/signal.html">signal(3)</a>, <a class="link-man" href="../html3/sigpause.html">sigpause(3)</a>, <a class="link-man" href="../html3/sigsetmask.html">sigsetmask(3)</a>, <a class="link-man" href="../html3/sigsetops.html">sigsetops(3)</a>, <a class="link-man" href="../html4/tty.html">tty(4)</a>, <a class="link-man" href="../html7/signal.html">signal(7)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
December 3, 2005</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
</html>

