<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="/static/man_pages/netbsd/style.css" type="text/css" media="all">
<title>
LDAP_OPEN(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
LDAP_OPEN(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
LDAP_OPEN(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> ldap_dup, ldap_destroy, &#45; Duplicate and destroy LDAP session handles</div>
<div class="section">
<h1>LIBRARY</h1> OpenLDAP LDAP (libldap, &#45;lldap)</div>
<div class="section">
<h1>SYNOPSIS</h1><br>
#include &lt;ldap.h&gt;<p>
<br>
LDAP *ldap_dup(<div style="margin-left: 5.00ex;">
<br>
LDAP *<i>old</i><b> );</b></div>
<p>
<br>
int ldap_destroy(<div style="margin-left: 5.00ex;">
<br>
LDAP *<i>old</i><b> );</b></div>
</div>
<div class="section">
<h1>DESCRIPTION</h1> <b>ldap_dup()</b> duplicates an existing LDAP (<b>LDAP *</b>) session handle. The new session handle may be used concurrently with the original session handle. In a threaded environment, different threads may execute concurrent requests on the same connection/session without fear of contamination. Each session handle manages its own private error results.<p>
<b>ldap_destroy()</b> destroys an existing session handle.<p>
The <b>ldap_dup()</b> and <b>ldap_destroy()</b> functions are used in conjunction with a "thread safe" version of <b>libldap</b> (<b>libldap_r</b>) to enable operation thread safe API calls, so that a single session may be simultaneously used across multiple threads with consistent error handling.<p>
When a session is created through the use of one of the session creation functions including <b>ldap_open</b>(3), <b>ldap_init</b>(3), <b>ldap_initialize</b>(3) or <b>ldap_init_fd</b>(3) an <b>LDAP *</b> session handle is returned to the application. The session handle may be shared amongst threads, however the error codes are unique to a session handle. Multiple threads performing different operations using the same session handle will result in inconsistent error codes and return values.<p>
To prevent this confusion, <b>ldap_dup()</b> is used duplicate an existing session handle so that multiple threads can share the session, and maintain consistent error information and results.<p>
The message queues for a session are shared between sibling session handles. Results of operations on a sibling session handles are accessible to all the sibling session handles. Applications desiring results associated with a specific operation should provide the appropriate msgid to <b>ldap_result()</b>. Applications should avoid calling <b>ldap_result()</b> with <b>LDAP_RES_ANY</b> as that may "steal" and return results in the calling thread that another operation in a different thread, using a different session handle, may require to complete.<p>
When <b>ldap_unbind()</b> is called on a session handle with siblings, all the siblings become invalid.<p>
Siblings must be destroyed using <b>ldap_destroy()</b>. Session handle resources associated with the original (<b>LDAP *</b>) will be freed when the last session handle is destroyed or when <b>ldap_unbind()</b> is called, if no other session handles currently exist.</div>
<div class="section">
<h1>ERRORS</h1> If an error occurs, <b>ldap_dup()</b> will return NULL and <i>errno</i> should be set appropriately. <b>ldap_destroy()</b> will directly return the LDAP code associated to the error (or <i>LDAP_SUCCESS</i> in case of success); <i>errno</i> should be set as well whenever appropriate.</div>
<div class="section">
<h1>SEE ALSO</h1> <b>ldap_open</b>(3), <b>ldap_init</b>(3), <b>ldap_initialize</b>(3), <b>ldap_init_fd</b>(3), <b>errno</b>(3)</div>
<div class="section">
<h1>ACKNOWLEDGEMENTS</h1> This work is based on the previously proposed <b>LDAP C API Concurrency Extensions</b> draft <b>(</b>draft-zeilenga-ldap-c-api-concurrency-00.txt<b>)</b> effort. <b>OpenLDAP Software</b> is developed and maintained by The OpenLDAP Project &lt;http://www.openldap.org/&gt;. <b>OpenLDAP Software</b> is derived from University of Michigan LDAP 3.3 Release.</div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tr>
<td class="foot-date">
2014/01/26</td>
<td class="foot-os" align="right">
OpenLDAP 2.4.39</td>
</tr>
</table>
</div>
</body>
</html>

