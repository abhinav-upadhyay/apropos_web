<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/../4/strict.dtd">
>
<head>
<meta http-equiv="Content-Type" content="te../; charset=utf-8">
<meta name="resource-type" content="document">
<link rel="stylesheet" href="../style.css" type="text/css" media="all">
<title>
PUFFS_FLUSH(3)</title>
</head>
<body>
<div class="mandoc">
<table summary="Document Header" class="head" width="100%">
<col width="30%">
<col width="30%">
<col width="30%">
<tbody>
<tr>
<td class="head-ltitle">
PUFFS_FLUSH(3)</td>
<td class="head-vol" align="center">
Library Functions Manual</td>
<td class="head-rtitle" align="right">
PUFFS_FLUSH(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">puffs_flush</b> &#8212; <span class="desc">puffs kernel cache flushing and invalidation routines</span></div>
<div class="section">
<h1 id="x4c494252415259">LIBRARY</h1> <span class="lib">puffs Convenience Library (libpuffs, &#45;lpuffs)</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1> <b class="includes">#include &lt;<a class="link-includes">puffs.h</a>&gt;</b><p>
<i class="ftype">int</i><br>
<b class="fname">puffs_inval_namecache_dir</b>(<i class="farg">struct puffs_usermount *pu</i>, <i class="farg">puffs_cookie_t cookie</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">puffs_inval_namecache_all</b>(<i class="farg" style="white-space:nowrap;">struct puffs_usermount *pu</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">puffs_inval_pagecache_node</b>(<i class="farg">struct puffs_usermount *pu</i>, <i class="farg">puffs_cookie_t cookie</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">puffs_inval_pagecache_node_range</b>(<i class="farg">struct puffs_usermount *pu</i>, <i class="farg">puffs_cookie_t cookie</i>, <i class="farg">off_t start</i>, <i class="farg">off_t end</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">puffs_flush_pagecache_node</b>(<i class="farg">struct puffs_usermount *pu</i>, <i class="farg">puffs_cookie_t cookie</i>);<p>
<i class="ftype">int</i><br>
<b class="fname">puffs_flush_pagecache_node_range</b>(<i class="farg">struct puffs_usermount *pu</i>, <i class="farg">puffs_cookie_t cookie</i>, <i class="farg">off_t start</i>, <i class="farg">off_t end</i>);</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> These routines are used inform the kernel that any information it might have cached is no longer valid. <b class="fname">puffs_inval_namecache_dir</b>() invalidates the name cache for a given directory. The argument <b class="var">cookie</b> should describe an existing and valid directory cookie for the file system. Similarly, <b class="fname">puffs_inval_namecache_all</b>() invalidates the name cache for the entire file system (this routine might go away).<p>
The cached pages (file contents) for a regular file described by <b class="var">cookie</b> are invalidated using <b class="fname">puffs_inval_pagecache_node</b>(). A specific range can be invalidated using <b class="fname">puffs_inval_pagecache_node_range</b>() for a platform specific page level granularity. The offset <b class="var">start</b> will be <span class="emph">truncated</span> to a page boundary while <b class="var">end</b> will be <span class="emph">rounded up</span> to the next page boundary. As a special case, specifying 0 as <b class="var">end</b> will invalidate all contents from <b class="var">start</b> to the end of the file.<p>
It is especially important to note that these routines will not only invalidate data in the "read cache", but also data in the "write back" cache (conceptually speaking; in reality they are the same cache), which has not yet been flushed to the file server. Therefore any unflushed data will be lost.<p>
The counterparts of the invalidation routines are the flushing routines <b class="fname">puffs_flush_pagecache_node</b>() and <b class="fname">puffs_flush_pagecache_node_range</b>(), which force unwritten data from the kernel page cache to be written. For the flush range version, the same range rules as with the invalidation routine apply. The data is flushed asynchronously, i.e. if the routine returns successfully, all the caller knows is that the data has been queued for writing.</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man" href="../3/puffs">puffs(3)</a></div>
<table summary="Document Footer" class="foot" width="100%">
<col width="50%">
<col width="50%">
<tbody>
<tr>
<td class="foot-date">
April 7, 2007</td>
<td class="foot-os" align="right">
NetBSD 7.99</td>
</tr>
</tbody>
</table>
</div>
</body>
<>

